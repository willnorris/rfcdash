<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc2571 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Aug 2018 14:27:51 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.127" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="rfc2271" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:2571" name="DC.Identifier"/>
<meta content="April, 1999" name="DC.Date.Issued"/>
<meta content="Wijnen, Bert" name="DC.Creator"/>
<meta content="Presuhn, Randy" name="DC.Creator"/>
<meta content="Harrington, Dave" name="DC.Creator"/>
<meta content="This document describes an architecture for describing SNMP Management
Frameworks. [STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="An Architecture for Describing SNMP Management Frameworks" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 2571 - An Architecture for Describing SNMP Management Frameworks</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgbrown" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc2571.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc2571" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-snmpv3-arch" title="draft-ietf-snmpv3-arch">draft-ietf-snmp...</a>] [<a href="https://datatracker.ietf.org/doc/rfc2571" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc2571" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc2571" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">Obsoleted by: <a href="rfc3411.html">3411</a>                                        DRAFT STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                      D. Harrington
Request for Comments: 2571                       Cabletron Systems, Inc.
Obsoletes: <a href="rfc2271.html">2271</a>                                               R. Presuhn
Category: Standards Track                             BMC Software, Inc.
                                                               B. Wijnen
                                               IBM T. J. Watson Research
                                                              April 1999


                     <span class="h1">An Architecture for Describing</span>
                       <span class="h1">SNMP Management Frameworks</span>

Status of this Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (1999).  All Rights Reserved.

Abstract

   This document describes an architecture for describing SNMP
   Management Frameworks.  The architecture is designed to be modular to
   allow the evolution of the SNMP protocol standards over time.  The
   major portions of the architecture are an SNMP engine containing a
   Message Processing Subsystem, a Security Subsystem and an Access
   Control Subsystem, and possibly multiple SNMP applications which
   provide specific functional processing of management data.

Table of Contents

   <a href="#section-1">1</a>. Introduction ................................................    <a href="#page-4">4</a>
   <a href="#section-1.1">1.1</a>. Overview ..................................................    <a href="#page-4">4</a>
   <a href="#section-1.2">1.2</a>. SNMP ......................................................    <a href="#page-4">4</a>
   <a href="#section-1.3">1.3</a>. Goals of this Architecture ................................    <a href="#page-5">5</a>
   <a href="#section-1.4">1.4</a>. Security Requirements of this Architecture ................    <a href="#page-6">6</a>
   <a href="#section-1.5">1.5</a>. Design Decisions ..........................................    <a href="#page-7">7</a>
   <a href="#section-2">2</a>. Documentation Overview ......................................    <a href="#page-9">9</a>
   <a href="#section-2.1">2.1</a>. Document Roadmap ..........................................   <a href="#page-10">10</a>
   <a href="#section-2.2">2.2</a>. Applicability Statement ...................................   <a href="#page-10">10</a>
   <a href="#section-2.3">2.3</a>. Coexistence and Transition ................................   <a href="#page-10">10</a>
   <a href="#section-2.4">2.4</a>. Transport Mappings ........................................   <a href="#page-11">11</a>
   <a href="#section-2.5">2.5</a>. Message Processing ........................................   <a href="#page-11">11</a>



<span class="grey">SNMPv3 Working Group        Standards Track                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   <a href="#section-2.6">2.6</a>. Security ..................................................   <a href="#page-11">11</a>
   <a href="#section-2.7">2.7</a>. Access Control ............................................   <a href="#page-12">12</a>
   <a href="#section-2.8">2.8</a>. Protocol Operations .......................................   <a href="#page-12">12</a>
   <a href="#section-2.9">2.9</a>. Applications ..............................................   <a href="#page-13">13</a>
   <a href="#section-2.10">2.10</a>. Structure of Management Information ......................   <a href="#page-14">14</a>
   <a href="#section-2.11">2.11</a>. Textual Conventions ......................................   <a href="#page-14">14</a>
   <a href="#section-2.12">2.12</a>. Conformance Statements ...................................   <a href="#page-14">14</a>
   <a href="#section-2.13">2.13</a>. Management Information Base Modules ......................   <a href="#page-14">14</a>
   <a href="#section-2.13.1">2.13.1</a>. SNMP Instrumentation MIBs ..............................   <a href="#page-14">14</a>
   <a href="#section-2.14">2.14</a>. SNMP Framework Documents .................................   <a href="#page-14">14</a>
   <a href="#section-3">3</a>. Elements of the Architecture ................................   <a href="#page-15">15</a>
   <a href="#section-3.1">3.1</a>. The Naming of Entities ....................................   <a href="#page-16">16</a>
   <a href="#section-3.1.1">3.1.1</a>. SNMP engine .............................................   <a href="#page-17">17</a>
   <a href="#section-3.1.1.1">3.1.1.1</a>. snmpEngineID ..........................................   <a href="#page-17">17</a>
   <a href="#section-3.1.1.2">3.1.1.2</a>. Dispatcher ............................................   <a href="#page-17">17</a>
   <a href="#section-3.1.1.3">3.1.1.3</a>. Message Processing Subsystem ..........................   <a href="#page-18">18</a>
   <a href="#section-3.1.1.3.1">3.1.1.3.1</a>. Message Processing Model ............................   <a href="#page-18">18</a>
   <a href="#section-3.1.1.4">3.1.1.4</a>. Security Subsystem ....................................   <a href="#page-18">18</a>
   <a href="#section-3.1.1.4.1">3.1.1.4.1</a>. Security Model ......................................   <a href="#page-19">19</a>
   <a href="#section-3.1.1.4.2">3.1.1.4.2</a>. Security Protocol ...................................   <a href="#page-19">19</a>
   <a href="#section-3.1.2">3.1.2</a>. Access Control Subsystem ................................   <a href="#page-19">19</a>
   <a href="#section-3.1.2.1">3.1.2.1</a>. Access Control Model ..................................   <a href="#page-20">20</a>
   <a href="#section-3.1.3">3.1.3</a>. Applications ............................................   <a href="#page-20">20</a>
   <a href="#section-3.1.3.1">3.1.3.1</a>. SNMP Manager ..........................................   <a href="#page-20">20</a>
   <a href="#section-3.1.3.2">3.1.3.2</a>. SNMP Agent ............................................   <a href="#page-22">22</a>
   <a href="#section-3.2">3.2</a>. The Naming of Identities ..................................   <a href="#page-23">23</a>
   <a href="#section-3.2.1">3.2.1</a>. Principal ...............................................   <a href="#page-23">23</a>
   <a href="#section-3.2.2">3.2.2</a>. securityName ............................................   <a href="#page-23">23</a>
   <a href="#section-3.2.3">3.2.3</a>. Model-dependent security ID .............................   <a href="#page-24">24</a>
   <a href="#section-3.3">3.3</a>. The Naming of Management Information ......................   <a href="#page-25">25</a>
   <a href="#section-3.3.1">3.3.1</a>. An SNMP Context .........................................   <a href="#page-26">26</a>
   <a href="#section-3.3.2">3.3.2</a>. contextEngineID .........................................   <a href="#page-26">26</a>
   <a href="#section-3.3.3">3.3.3</a>. contextName .............................................   <a href="#page-27">27</a>
   <a href="#section-3.3.4">3.3.4</a>. scopedPDU ...............................................   <a href="#page-27">27</a>
   <a href="#section-3.4">3.4</a>. Other Constructs ..........................................   <a href="#page-27">27</a>
   <a href="#section-3.4.1">3.4.1</a>. maxSizeResponseScopedPDU ................................   <a href="#page-27">27</a>
   <a href="#section-3.4.2">3.4.2</a>. Local Configuration Datastore ...........................   <a href="#page-27">27</a>
   <a href="#section-3.4.3">3.4.3</a>. securityLevel ...........................................   <a href="#page-27">27</a>
   <a href="#section-4">4</a>. Abstract Service Interfaces .................................   <a href="#page-28">28</a>
   <a href="#section-4.1">4.1</a>. Dispatcher Primitives .....................................   <a href="#page-28">28</a>
   <a href="#section-4.1.1">4.1.1</a>. Generate Outgoing Request or Notification ...............   <a href="#page-28">28</a>
   <a href="#section-4.1.2">4.1.2</a>. Process Incoming Request or Notification PDU ............   <a href="#page-29">29</a>
   <a href="#section-4.1.3">4.1.3</a>. Generate Outgoing Response ..............................   <a href="#page-29">29</a>
   <a href="#section-4.1.4">4.1.4</a>. Process Incoming Response PDU ...........................   <a href="#page-29">29</a>
   <a href="#section-4.1.5">4.1.5</a>. Registering Responsibility for Handling SNMP PDUs .......   <a href="#page-30">30</a>
   <a href="#section-4.2">4.2</a>. Message Processing Subsystem Primitives ...................   <a href="#page-30">30</a>
   <a href="#section-4.2.1">4.2.1</a>. Prepare Outgoing SNMP Request or Notification Message ...   <a href="#page-31">31</a>
   <a href="#section-4.2.2">4.2.2</a>. Prepare an Outgoing SNMP Response Message ...............   <a href="#page-31">31</a>



<span class="grey">SNMPv3 Working Group        Standards Track                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   <a href="#section-4.2.3">4.2.3</a>. Prepare Data Elements from an Incoming SNMP Message .....   <a href="#page-32">32</a>
   <a href="#section-4.3">4.3</a>. Access Control Subsystem Primitives .......................   <a href="#page-32">32</a>
   <a href="#section-4.4">4.4</a>. Security Subsystem Primitives .............................   <a href="#page-33">33</a>
   <a href="#section-4.4.1">4.4.1</a>. Generate a Request or Notification Message ..............   <a href="#page-33">33</a>
   <a href="#section-4.4.2">4.4.2</a>. Process Incoming Message ................................   <a href="#page-33">33</a>
   <a href="#section-4.4.3">4.4.3</a>. Generate a Response Message .............................   <a href="#page-34">34</a>
   <a href="#section-4.5">4.5</a>. Common Primitives .........................................   <a href="#page-34">34</a>
   <a href="#section-4.5.1">4.5.1</a>. Release State Reference Information .....................   <a href="#page-35">35</a>
   <a href="#section-4.6">4.6</a>. Scenario Diagrams .........................................   <a href="#page-36">36</a>
   <a href="#section-4.6.1">4.6.1</a>. Command Generator or Notification Originator ............   <a href="#page-36">36</a>
   <a href="#section-4.6.2">4.6.2</a>. Scenario Diagram for a Command Responder Application ....   <a href="#page-37">37</a>
   <a href="#section-5">5</a>. Managed Object Definitions for SNMP Management Frameworks ...   <a href="#page-38">38</a>
   <a href="#section-6">6</a>. IANA Considerations .........................................   <a href="#page-48">48</a>
   <a href="#section-6.1">6.1</a>. Security Models ...........................................   <a href="#page-48">48</a>
   <a href="#section-6.2">6.2</a>. Message Processing Models .................................   <a href="#page-48">48</a>
   <a href="#section-6.3">6.3</a>. SnmpEngineID Formats ......................................   <a href="#page-49">49</a>
   <a href="#section-7">7</a>. Intellectual Property .......................................   <a href="#page-49">49</a>
   <a href="#section-8">8</a>. Acknowledgements ............................................   <a href="#page-49">49</a>
   <a href="#section-9">9</a>. Security Considerations .....................................   <a href="#page-51">51</a>
   <a href="#section-10">10</a>. References .................................................   <a href="#page-52">52</a>
   <a href="#section-11">11</a>. Editor's Addresses .........................................   <a href="#page-54">54</a>
   <a href="#appendix-A">A</a>. Guidelines for Model Designers ..............................   <a href="#page-55">55</a>
   <a href="#appendix-A.1">A.1</a>. Security Model Design Requirements ........................   <a href="#page-55">55</a>
   <a href="#appendix-A.1.1">A.1.1</a>. Threats .................................................   <a href="#page-55">55</a>
   <a href="#appendix-A.1.2">A.1.2</a>. Security Processing .....................................   <a href="#page-56">56</a>
   <a href="#appendix-A.1.3">A.1.3</a>. Validate the security-stamp in a received message .......   <a href="#page-56">56</a>
   <a href="#appendix-A.1.4">A.1.4</a>. Security MIBs ...........................................   <a href="#page-57">57</a>
   <a href="#appendix-A.1.5">A.1.5</a>. Cached Security Data ....................................   <a href="#page-57">57</a>
   <a href="#appendix-A.2">A.2</a>. Message Processing Model Design Requirements ..............   <a href="#page-57">57</a>
   <a href="#appendix-A.2.1">A.2.1</a>. Receiving an SNMP Message from the Network ..............   <a href="#page-58">58</a>
   <a href="#appendix-A.2.2">A.2.2</a>. Sending an SNMP Message to the Network ..................   <a href="#page-58">58</a>
   <a href="#appendix-A.3">A.3</a>. Application Design Requirements ...........................   <a href="#page-59">59</a>
   <a href="#appendix-A.3.1">A.3.1</a>. Applications that Initiate Messages .....................   <a href="#page-59">59</a>
   <a href="#appendix-A.3.2">A.3.2</a>. Applications that Receive Responses .....................   <a href="#page-59">59</a>
   <a href="#appendix-A.3.3">A.3.3</a>. Applications that Receive Asynchronous Messages .........   <a href="#page-60">60</a>
   <a href="#appendix-A.3.4">A.3.4</a>. Applications that Send Responses ........................   <a href="#page-60">60</a>
   <a href="#appendix-A.4">A.4</a>. Access Control Model Design Requirements ..................   <a href="#page-60">60</a>
   <a href="#appendix-B">B</a>. Full Copyright Statement ....................................   <a href="#page-62">62</a>













<span class="grey">SNMPv3 Working Group        Standards Track                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Overview"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Overview</span>

   This document defines a vocabulary for describing SNMP Management
   Frameworks, and an architecture for describing the major portions of
   SNMP Management Frameworks.

   This document does not provide a general introduction to SNMP. Other
   documents and books can provide a much better introduction to SNMP.
   Nor does this document provide a history of SNMP. That also can be
   found in books and other documents.

   <a href="#section-1">Section 1</a> describes the purpose, goals, and design decisions of this
   architecture.

   <a href="#section-2">Section 2</a> describes various types of documents which define (elements
   of) SNMP Frameworks, and how they fit into this architecture. It also
   provides a minimal road map to the documents which have previously
   defined SNMP frameworks.

   <a href="#section-3">Section 3</a> details the vocabulary of this architecture and its pieces.
   This section is important for understanding the remaining sections,
   and for understanding documents which are written to fit within this
   architecture.

   <a href="#section-4">Section 4</a> describes the primitives used for the abstract service
   interfaces between the various subsystems, models and applications
   within this architecture.

   <a href="#section-5">Section 5</a> defines a collection of managed objects used to instrument
   SNMP entities within this architecture.

   Sections <a href="#section-6">6</a>, <a href="#section-7">7</a>, <a href="#section-8">8</a>, <a href="#section-9">9</a>, <a href="#section-10">10</a> and <a href="#section-11">11</a> are administrative in nature.

   <a href="#appendix-A">Appendix A</a> contains guidelines for designers of Models which are
   expected to fit within this architecture.

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20SNMP"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  SNMP</span>

   An SNMP management system contains:

      -  several (potentially many) nodes, each with an SNMP entity
         containing command responder and notification originator



<span class="grey">SNMPv3 Working Group        Standards Track                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


         applications, which have access to management instrumentation
         (traditionally called agents);

      -  at least one SNMP entity containing command generator and/or
         notification receiver applications (traditionally called a
         manager) and,

      -  a management protocol, used to convey management information
         between the SNMP entities.

   SNMP entities executing command generator and notification receiver
   applications monitor and control managed elements.  Managed elements
   are devices such as hosts, routers, terminal servers, etc., which are
   monitored and controlled via access to their management information.

   It is the purpose of this document to define an architecture which
   can evolve to realize effective management in a variety of
   configurations and environments. The architecture has been designed
   to meet the needs of implementations of:

      -  minimal SNMP entities with command responder and/or
         notification originator applications (traditionally called SNMP
         agents),

      -  SNMP entities with proxy forwarder applications (traditionally
         called SNMP proxy agents),

      -  command line driven SNMP entities with command generator and/or
         notification receiver applications (traditionally called SNMP
         command line managers),

      -  SNMP entities with  command generator and/or notification
         receiver, plus command responder and/or notification originator
         applications (traditionally called SNMP mid-level managers or
         dual-role entities),

      -  SNMP entities with command generator and/or notification
         receiver and possibly other types of applications for managing
         a potentially very large number of managed nodes (traditionally
         called (network) management stations).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20Goals%20of%20this%20Architecture"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  Goals of this Architecture</span>

   This architecture was driven by the following goals:

      -  Use existing materials as much as possible. It is heavily based
         on previous work, informally known as SNMPv2u and SNMPv2*,
         based in turn on SNMPv2p.



<span class="grey">SNMPv3 Working Group        Standards Track                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


      -  Address the need for secure SET support, which is considered
         the most important deficiency in SNMPv1 and SNMPv2c.

      -  Make it possible to move portions of the architecture forward
         in the standards track, even if consensus has not been reached
         on all pieces.

      -  Define an architecture that allows for longevity of the SNMP
         Frameworks that have been and will be defined.

      -  Keep SNMP as simple as possible.

      -  Make it relatively inexpensive to deploy a minimal conforming
         implementation.

      -  Make it possible to upgrade portions of SNMP as new approaches
         become available, without disrupting an entire SNMP framework.

      -  Make it possible to support features required in large
         networks, but make the expense of supporting a feature directly
         related to the support of the feature.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.4.%20%20Security%20Requirements%20of%20this%20Architecture"></a><a class="selflink" href="#section-1.4" name="section-1.4">1.4</a>.  Security Requirements of this Architecture</span>

   Several of the classical threats to network protocols are applicable
   to the management problem and therefore would be applicable to any
   Security Model used in an SNMP Management Framework. Other threats
   are not applicable to the management problem.  This section discusses
   principal threats, secondary threats, and threats which are of lesser
   importance.

   The principal threats against which any Security Model used within
   this architecture SHOULD provide protection are:

      Modification of Information
         The modification threat is the danger that some unauthorized
         entity may alter in-transit SNMP messages generated on behalf
         of an authorized principal in such a way as to effect
         unauthorized management operations, including falsifying the
         value of an object.

      Masquerade
         The masquerade threat is the danger that management operations
         not authorized for some principal may be attempted by assuming
         the identity of another principal that has the appropriate
         authorizations.





<span class="grey">SNMPv3 Working Group        Standards Track                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   Secondary threats against which any Security Model used within this
   architecture SHOULD provide protection are:

      Message Stream Modification
         The SNMP protocol is typically based upon a connectionless
         transport service which may operate over any subnetwork
         service.  The re-ordering, delay or replay of messages can and
         does occur through the natural operation of many such
         subnetwork services.  The message stream modification threat is
         the danger that messages may be maliciously re-ordered, delayed
         or replayed to an extent which is greater than can occur
         through the natural operation of a subnetwork service, in order
         to effect unauthorized management operations.

      Disclosure
         The disclosure threat is the danger of eavesdropping on the
         exchanges between SNMP engines.  Protecting against this threat
         may be required as a matter of local policy.

   There are at least two threats against which a Security Model within
   this architecture need not protect, since they are deemed to be of
   lesser importance in this context:

      Denial of Service
         A Security Model need not attempt to address the broad range of
         attacks by which service on behalf of authorized users is
         denied.  Indeed, such denial-of-service attacks are in many
         cases indistinguishable from the type of network failures with
         which any viable management protocol must cope as a matter of
         course.

      Traffic Analysis
         A Security Model need not attempt to address traffic analysis
         attacks.  Many traffic patterns are predictable - entities may
         be managed on a regular basis by a relatively small number of
         management stations - and therefore there is no significant
         advantage afforded by protecting against traffic analysis.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.5.%20%20Design%20Decisions"></a><a class="selflink" href="#section-1.5" name="section-1.5">1.5</a>.  Design Decisions</span>

   Various design decisions were made in support of the goals of the
   architecture and the security requirements:

      - Architecture
         An architecture should be defined which identifies the
         conceptual boundaries between the documents. Subsystems should
         be defined which describe the abstract services provided by
         specific portions of an SNMP framework. Abstract service



<span class="grey">SNMPv3 Working Group        Standards Track                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


         interfaces, as described by service primitives, define the
         abstract boundaries between documents, and the abstract
         services that are provided by the conceptual subsystems of an
         SNMP framework.

      - Self-contained Documents
         Elements of procedure plus the MIB objects which are needed for
         processing for a specific portion of an SNMP framework should
         be defined in the same document, and as much as possible,
         should not be referenced in other documents. This allows pieces
         to be designed and documented as independent and self-contained
         parts, which is consistent with the general SNMP MIB module
         approach.  As portions of SNMP change over time, the documents
         describing other portions of SNMP are not directly impacted.
         This modularity allows, for example, Security Models,
         authentication and privacy mechanisms, and message formats to
         be upgraded and supplemented as the need arises. The self-
         contained documents can move along the standards track on
         different time-lines.

      This modularity of specification is not meant to be interpreted as
      imposing any specific requirements on implementation.

      - Threats
         The Security Models in the Security Subsystem SHOULD protect
         against the principal and secondary threats: modification of
         information, masquerade, message stream modification and
         disclosure.  They do not need to protect against denial of
         service and traffic analysis.

      - Remote Configuration
         The Security and Access Control Subsystems add a whole new set
         of SNMP configuration parameters.  The Security Subsystem also
         requires frequent changes of secrets at the various SNMP
         entities. To make this deployable in a large operational
         environment, these SNMP parameters must be remotely
         configurable.

      - Controlled Complexity
         It is recognized that producers of simple managed devices want
         to keep the resources used by SNMP to a minimum.  At the same
         time, there is a need for more complex configurations which can
         spend more resources for SNMP and thus provide more
         functionality.  The design tries to keep the competing
         requirements of these two environments in balance and allows
         the more complex environments to logically extend the simple
         environment.




<span class="grey">SNMPv3 Working Group        Standards Track                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Documentation%20Overview"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Documentation Overview</span>

   The following figure shows the set of documents that fit within the
   SNMP Architecture.
   +------------------------- Document Set ----------------------------+
   |                                                                   |
   | +----------+              +-----------------+  +----------------+ |
   | | Document |              | Applicability * |  | Coexistence    | |
   | | Roadmap  |              | Statement       |  | &amp; Transition   | |
   | +----------+              +-----------------+  +----------------+ |
   |                                                                   |
   | +---------------------------------------------------------------+ |
   | | Message Handling                                              | |
   | | +----------------+  +-----------------+  +-----------------+  | |
   | | | Transport      |  | Message         |  | Security        |  | |
   | | | Mappings       |  | Processing and  |  |                 |  | |
   | | |                |  | Dispatcher      |  |                 |  | |
   | | +----------------+  +-----------------+  +-----------------+  | |
   | +---------------------------------------------------------------+ |
   |                                                                   |
   | +---------------------------------------------------------------+ |
   | | PDU Handling                                                  | |
   | | +----------------+  +-----------------+  +-----------------+  | |
   | | | Protocol       |  | Applications    |  | Access          |  | |
   | | | Operations     |  |                 |  | Control         |  | |
   | | +----------------+  +-----------------+  +-----------------+  | |
   | +---------------------------------------------------------------+ |
   |                                                                   |
   | +---------------------------------------------------------------+ |
   | | Information Model                                             | |
   | | +--------------+   +--------------+    +---------------+      | |
   | | | Structure of |   | Textual      |    | Conformance   |      | |
   | | | Management   |   | Conventions  |    | Statements    |      | |
   | | | Information  |   |              |    |               |      | |
   | | +--------------+   +--------------+    +---------------+      | |
   | +---------------------------------------------------------------+ |
   |                                                                   |
   | +---------------------------------------------------------------+ |
   | | MIB Modules written in various formats, e.g.:                 | |
   | | +-------------+ +-------------+ +----------+ +----------+     | |
   | | | Standard v1 | | Standard v1 | | Historic | | Draft v2 |     | |
   | | | <a href="rfc1157.html">RFC 1157</a>    | | <a href="rfc1212.html">RFC 1212</a>    | | RFC 14xx | | RFC 19xx |     | |
   | | | format      | | format      | | format   | | format   |     | |
   | | +-------------+ +-------------+ +----------+ +----------+     | |
   | +---------------------------------------------------------------+ |
   |                                                                   |
   +-------------------------------------------------------------------+




<span class="grey">SNMPv3 Working Group        Standards Track                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   Those marked with an asterisk (*) are expected to be written in the
   future. Each of these documents may be replaced or supplemented.
   This Architecture document specifically describes how new documents
   fit into the set of documents in the area of Message and PDU
   handling.


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Document%20Roadmap"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Document Roadmap</span>

   One or more documents may be written to describe how sets of
   documents taken together form specific Frameworks. The configuration
   of document sets might change over time, so the "road map" should be
   maintained in a document separate from the standards documents
   themselves.

   An example of such a roadmap is "Introduction to Version 3 of the
   Internet-standard Network Management Framework" [<a href="rfc2570.html" title='"Introduction to Version 3 of the Internet-standard Network Management Framework"'>RFC2570</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Applicability%20Statement"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Applicability Statement</span>

   SNMP is used in networks that vary widely in size and complexity, by
   organizations that vary widely in their requirements of management.
   Some models will be designed to address specific problems of
   management, such as message security.

   One or more documents may be written to describe the environments to
   which certain versions of SNMP or models within SNMP would be
   appropriately applied, and those to which a given model might be
   inappropriately applied.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20Coexistence%20and%20Transition"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  Coexistence and Transition</span>

   The purpose of an evolutionary architecture is to permit new models
   to replace or supplement existing models. The interactions between
   models could result in incompatibilities, security "holes", and other
   undesirable effects.

   The purpose of Coexistence documents is to detail recognized
   anomalies and to describe required and recommended behaviors for
   resolving the interactions between models within the architecture.

   Coexistence documents may be prepared separately from model
   definition documents, to describe and resolve interaction anomalies
   between a model definition and one or more other model definitions.

   Additionally, recommendations for transitions between models may also
   be described, either in a coexistence document or in a separate
   document.



<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   One such coexistance document is [<a href="#ref-SNMP-COEX" title='"Coexistence between Version 1, Version 2, and Version 3 of the Internet- standard Network Management Framework"'>SNMP-COEX</a>], "Coexistence between
   Version 1, Version 2, and Version 3 of the Internet-standard Network
   Management Framework".

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.4.%20%20Transport%20Mappings"></a><a class="selflink" href="#section-2.4" name="section-2.4">2.4</a>.  Transport Mappings</span>

   SNMP messages are sent over various transports. It is the purpose of
   Transport Mapping documents to define how the mapping between SNMP
   and the transport is done.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.5.%20%20Message%20Processing"></a><a class="selflink" href="#section-2.5" name="section-2.5">2.5</a>.  Message Processing</span>

   A Message Processing Model document defines a message format, which
   is typically identified by a version field in an SNMP message header.
   The document may also define a MIB module for use in message
   processing and for instrumentation of version-specific interactions.

   An SNMP engine includes one or more Message Processing Models, and
   thus may support sending and receiving multiple versions of SNMP
   messages.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.6.%20%20Security"></a><a class="selflink" href="#section-2.6" name="section-2.6">2.6</a>.  Security</span>

   Some environments require secure protocol interactions. Security is
   normally applied at two different stages:

      -  in the transmission/receipt of messages, and

      -  in the processing of the contents of messages.

   For purposes of this document, "security" refers to message-level
   security; "access control" refers to the security applied to protocol
   operations.

   Authentication, encryption, and timeliness checking are common
   functions of message level security.

   A security document describes a Security Model, the threats against
   which the model protects, the goals of the Security Model, the
   protocols which it uses to meet those goals, and it may define a MIB
   module to describe the data used during processing, and to allow the
   remote configuration of message-level security parameters, such as
   keys.

   An SNMP engine may support multiple Security Models concurrently.






<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.7.%20%20Access%20Control"></a><a class="selflink" href="#section-2.7" name="section-2.7">2.7</a>.  Access Control</span>

   During processing, it may be required to control access to managed
   objects for operations.

   An Access Control Model defines mechanisms to determine whether
   access to a managed object should be allowed.  An Access Control
   Model may define a MIB module used during processing and to allow the
   remote configuration of access control policies.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.8.%20%20Protocol%20Operations"></a><a class="selflink" href="#section-2.8" name="section-2.8">2.8</a>.  Protocol Operations</span>

   SNMP messages encapsulate an SNMP Protocol Data Unit (PDU).  SNMP
   PDUs define the operations performed by the receiving SNMP engine.
   It is the purpose of a Protocol Operations document to define the
   operations of the protocol with respect to the processing of the
   PDUs.  Every PDU belongs to one or more of the PDU classes defined
   below:

      1) Read Class:

         The Read Class contains protocol operations that retrieve
         management information.  For example, <a href="rfc1905.html">RFC 1905</a> defines the
         following protocol operations for the Read Class:  GetRequest-
         PDU, GetNextRequest-PDU, and GetBulkRequest-PDU.

      2) Write Class:

         The Write Class contains protocol operations which attempt to
         modify management information.  For example, <a href="rfc1905.html">RFC 1905</a> defines
         the following protocol operation for the Write Class:
         SetRequest-PDU.

      3) Response Class:

         The Response Class contains protocol operations which are sent
         in response to a previous request.  For example, <a href="rfc1905.html">RFC 1905</a>
         defines the following for the Response Class: Response-PDU,
         Report-PDU.

      4) Notification Class:

         The Notification Class contains protocol operations which send
         a notification to a notification receiver application.  For
         example, <a href="rfc1905.html">RFC 1905</a> defines the following operations for the
         Notification Class:  Trapv2-PDU, InformRequest-PDU.





<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


      5) Internal Class:

         The Internal Class contains protocol operations which are
         exchanged internally between SNMP engines.  For example, <a href="rfc1905.html">RFC</a>
         <a href="rfc1905.html">1905</a> defines the following operations for the Internal Class:
         Report-PDU.

   The preceding five classifications are based on the functional
   properties of a PDU. It is also useful to classify PDUs based on
   whether a response is expected:

      6) Confirmed Class:

         The Confirmed Class contains all protocol operations which
         cause the receiving SNMP engine to send back a response.  For
         example, <a href="rfc1905.html">RFC 1905</a> defines the following operations for the
         Confirmed Class:  GetRequest-PDU, GetNextRequest-PDU,
         GetBulkRequest-PDU, SetRequest-PDU, and InformRequest-PDU.

      7) Unconfirmed Class:

         The Unconfirmed Class contains all protocol operations which
         are not acknowledged. For example, <a href="rfc1905.html">RFC 1905</a> defines the
         following operations for the Unconfirmed Class:  Report-PDU,
         Trapv2-PDU, and GetResponse-PDU.

   An application document defines which Protocol Operations are
   supported by the application.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.9.%20%20Applications"></a><a class="selflink" href="#section-2.9" name="section-2.9">2.9</a>.  Applications</span>

   An SNMP entity normally includes a number of applications.
   Applications use the services of an SNMP engine to accomplish
   specific tasks. They coordinate the processing of management
   information operations, and may use SNMP messages to communicate with
   other SNMP entities.

   Applications documents describe the purpose of an application, the
   services required of the associated SNMP engine, and the protocol
   operations and informational model that the application uses to
   perform management operations.

   An application document defines which set of documents are used to
   specifically define the structure of management information, textual
   conventions, conformance requirements, and operations supported by
   the application.





<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.10.%20%20Structure%20of%20Management%20Information"></a><a class="selflink" href="#section-2.10" name="section-2.10">2.10</a>.  Structure of Management Information</span>

   Management information is viewed as a collection of managed objects,
   residing in a virtual information store, termed the Management
   Information Base (MIB). Collections of related objects are defined in
   MIB modules.

   It is the purpose of a Structure of Management Information document
   to establish the notation for defining objects, modules, and other
   elements of managed information.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.11.%20%20Textual%20Conventions"></a><a class="selflink" href="#section-2.11" name="section-2.11">2.11</a>.  Textual Conventions</span>

   When designing a MIB module, it is often useful to define new types
   similar to those defined in the SMI, but with more precise semantics,
   or which have special semantics associated with them. These newly
   defined types are termed textual conventions, and may be defined in
   separate documents, or within a MIB module.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.12.%20%20Conformance%20Statements"></a><a class="selflink" href="#section-2.12" name="section-2.12">2.12</a>.  Conformance Statements</span>

   It may be useful to define the acceptable lower-bounds of
   implementation, along with the actual level of implementation
   achieved. It is the purpose of the Conformance Statements document to
   define the notation used for these purposes.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.13.%20%20Management%20Information%20Base%20Modules"></a><a class="selflink" href="#section-2.13" name="section-2.13">2.13</a>.  Management Information Base Modules</span>

   MIB documents describe collections of managed objects which
   instrument some aspect of a managed node.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.13.1.%20%20SNMP%20Instrumentation%20MIBs"></a><a class="selflink" href="#section-2.13.1" name="section-2.13.1">2.13.1</a>.  SNMP Instrumentation MIBs</span>

   An SNMP MIB document may define a collection of managed objects which
   instrument the SNMP protocol itself. In addition, MIB modules may be
   defined within the documents which describe portions of the SNMP
   architecture, such as the documents for Message processing Models,
   Security Models, etc. for the purpose of instrumenting those Models,
   and for the purpose of allowing remote configuration of the Model.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.14.%20%20SNMP%20Framework%20Documents"></a><a class="selflink" href="#section-2.14" name="section-2.14">2.14</a>.  SNMP Framework Documents</span>

   This architecture is designed to allow an orderly evolution of
   portions of SNMP Frameworks.

   Throughout the rest of this document, the term "subsystem" refers to
   an abstract and incomplete specification of a portion of a Framework,
   that is further refined by a model specification.



<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   A "model" describes a specific design of a subsystem, defining
   additional constraints and rules for conformance to the model.  A
   model is sufficiently detailed to make it possible to implement the
   specification.

   An "implementation" is an instantiation of a subsystem, conforming to
   one or more specific models.

   SNMP version 1 (SNMPv1), is the original Internet-standard Network
   Management Framework, as described in RFCs 1155, 1157, and 1212.

   SNMP version 2 (SNMPv2), is the SNMPv2 Framework as derived from the
   SNMPv1 Framework. It is described in STD 58, RFCs 2578, 2579, 2580,
   and RFCs 1905-1907. SNMPv2 has no message definition.

   The Community-based SNMP version 2 (SNMPv2c), is an experimental SNMP
   Framework which supplements the SNMPv2 Framework, as described in <a href="rfc1901.html">RFC</a>
   <a href="rfc1901.html">1901</a>. It adds the SNMPv2c message format, which is similar to the
   SNMPv1 message format.

   SNMP version 3 (SNMPv3), is an extensible SNMP Framework which
   supplements the SNMPv2 Framework, by supporting the following:

      -  a new SNMP message format,

      -  Security for Messages,

      -  Access Control, and

      -  Remote configuration of SNMP parameters.

   Other SNMP Frameworks, i.e., other configurations of implemented
   subsystems, are expected to also be consistent with this
   architecture.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Elements%20of%20the%20Architecture"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Elements of the Architecture</span>

   This section describes the various elements of the architecture and
   how they are named. There are three kinds of naming:

      1) the naming of entities,

      2) the naming of identities, and

      3) the naming of management information.






<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   This architecture also defines some names for other constructs that
   are used in the documentation.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20The%20Naming%20of%20Entities"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  The Naming of Entities</span>

   An SNMP entity is an implementation of this architecture. Each such
   SNMP entity consists of an SNMP engine and one or more associated
   applications.

   The following figure shows details about an SNMP entity and the
   components within it.

   +-------------------------------------------------------------------+
   |  SNMP entity                                                      |
   |                                                                   |
   |  +-------------------------------------------------------------+  |
   |  |  SNMP engine (identified by snmpEngineID)                   |  |
   |  |                                                             |  |
   |  |  +------------+ +------------+ +-----------+ +-----------+  |  |
   |  |  |            | |            | |           | |           |  |  |
   |  |  | Dispatcher | | Message    | | Security  | | Access    |  |  |
   |  |  |            | | Processing | | Subsystem | | Control   |  |  |
   |  |  |            | | Subsystem  | |           | | Subsystem |  |  |
   |  |  |            | |            | |           | |           |  |  |
   |  |  +------------+ +------------+ +-----------+ +-----------+  |  |
   |  |                                                             |  |
   |  +-------------------------------------------------------------+  |
   |                                                                   |
   |  +-------------------------------------------------------------+  |
   |  |  Application(s)                                             |  |
   |  |                                                             |  |
   |  |  +-------------+  +--------------+  +--------------+        |  |
   |  |  | Command     |  | Notification |  | Proxy        |        |  |
   |  |  | Generator   |  | Receiver     |  | Forwarder    |        |  |
   |  |  +-------------+  +--------------+  +--------------+        |  |
   |  |                                                             |  |
   |  |  +-------------+  +--------------+  +--------------+        |  |
   |  |  | Command     |  | Notification |  | Other        |        |  |
   |  |  | Responder   |  | Originator   |  |              |        |  |
   |  |  +-------------+  +--------------+  +--------------+        |  |
   |  |                                                             |  |
   |  +-------------------------------------------------------------+  |
   |                                                                   |
   +-------------------------------------------------------------------+







<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.1.%20%20SNMP%20engine"></a><a class="selflink" href="#section-3.1.1" name="section-3.1.1">3.1.1</a>.  SNMP engine</span>

   An SNMP engine provides services for sending and receiving messages,
   authenticating and encrypting messages, and controlling access to
   managed objects. There is a one-to-one association between an SNMP
   engine and the SNMP entity which contains it.

   The engine contains:

      1) a Dispatcher,

      2) a Message Processing Subsystem,

      3) a Security Subsystem, and

      4) an Access Control Subsystem.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.1.1.1.%20%20snmpEngineID"></a><a class="selflink" href="#section-3.1.1.1" name="section-3.1.1.1">3.1.1.1</a>.  snmpEngineID</span>

   Within an administrative domain, an snmpEngineID is the unique and
   unambiguous identifier of an SNMP engine. Since there is a one-to-one
   association between SNMP engines and SNMP entities, it also uniquely
   and unambiguously identifies the SNMP entity within that
   administrative domain.  Note that it is possible for SNMP entities in
   different administrative domains to have the same value for
   snmpEngineID.  Federation of administrative domains may necessitate
   assignment of new values.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.1.1.2.%20%20Dispatcher"></a><a class="selflink" href="#section-3.1.1.2" name="section-3.1.1.2">3.1.1.2</a>.  Dispatcher</span>

   There is only one Dispatcher in an SNMP engine. It allows for
   concurrent support of multiple versions of SNMP messages in the SNMP
   engine. It does so by:

      -  sending and receiving SNMP messages to/from the network,

      -  determining the version of an SNMP message and interacting with
         the corresponding Message Processing Model,

      -  providing an abstract interface to SNMP applications for
         delivery of a PDU to an application.

      -  providing an abstract interface for SNMP applications that
         allows them to send a PDU to a remote SNMP entity.







<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.1.1.3.%20%20Message%20Processing%20Subsystem"></a><a class="selflink" href="#section-3.1.1.3" name="section-3.1.1.3">3.1.1.3</a>.  Message Processing Subsystem</span>

   The Message Processing Subsystem is responsible for preparing
   messages for sending, and extracting data from received messages.

   The Message Processing Subsystem potentially contains multiple
   Message Processing Models as shown in the next figure.

   * One or more Message Processing Models may be present.

   +------------------------------------------------------------------+
   |                                                                  |
   |  Message Processing Subsystem                                    |
   |                                                                  |
   |  +------------+  +------------+  +------------+  +------------+  |
   |  |          * |  |          * |  |          * |  |          * |  |
   |  | SNMPv3     |  | SNMPv1     |  | SNMPv2c    |  | Other      |  |
   |  | Message    |  | Message    |  | Message    |  | Message    |  |
   |  | Processing |  | Processing |  | Processing |  | Processing |  |
   |  | Model      |  | Model      |  | Model      |  | Model      |  |
   |  |            |  |            |  |            |  |            |  |
   |  +------------+  +------------+  +------------+  +------------+  |
   |                                                                  |
   +------------------------------------------------------------------+

<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/3.1.1.3.1.%20%20Message%20Processing%20Model"></a><a class="selflink" href="#section-3.1.1.3.1" name="section-3.1.1.3.1">3.1.1.3.1</a>.  Message Processing Model</span>

   Each Message Processing Model defines the format of a particular
   version of an SNMP message and coordinates the preparation and
   extraction of each such version-specific message format.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.1.1.4.%20%20Security%20Subsystem"></a><a class="selflink" href="#section-3.1.1.4" name="section-3.1.1.4">3.1.1.4</a>.  Security Subsystem</span>

   The Security Subsystem provides security services such as the
   authentication and privacy of messages and potentially contains
   multiple Security Models as shown in the following figure















<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   * One or more Security Models may be present.

   +------------------------------------------------------------------+
   |                                                                  |
   |  Security Subsystem                                              |
   |                                                                  |
   |  +----------------+  +-----------------+  +-------------------+  |
   |  |              * |  |               * |  |                 * |  |
   |  | User-Based     |  | Other           |  | Other             |  |
   |  | Security       |  | Security        |  | Security          |  |
   |  | Model          |  | Model           |  | Model             |  |
   |  |                |  |                 |  |                   |  |
   |  +----------------+  +-----------------+  +-------------------+  |
   |                                                                  |
   +------------------------------------------------------------------+

<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/3.1.1.4.1.%20%20Security%20Model"></a><a class="selflink" href="#section-3.1.1.4.1" name="section-3.1.1.4.1">3.1.1.4.1</a>.  Security Model</span>

   A Security Model specifies the threats against which it protects, the
   goals of its services, and the security protocols used to provide
   security services such as authentication and privacy.

<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/3.1.1.4.2.%20%20Security%20Protocol"></a><a class="selflink" href="#section-3.1.1.4.2" name="section-3.1.1.4.2">3.1.1.4.2</a>.  Security Protocol</span>

   A Security Protocol specifies the mechanisms, procedures, and MIB
   objects used to provide a security service such as authentication or
   privacy.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.2.%20%20Access%20Control%20Subsystem"></a><a class="selflink" href="#section-3.1.2" name="section-3.1.2">3.1.2</a>.  Access Control Subsystem</span>

   The Access Control Subsystem provides authorization services by means
   of one or more (*) Access Control Models.

   +------------------------------------------------------------------+
   |                                                                  |
   |  Access Control Subsystem                                        |
   |                                                                  |
   |  +---------------+   +-----------------+   +------------------+  |
   |  |             * |   |               * |   |                * |  |
   |  | View-Based    |   | Other           |   | Other            |  |
   |  | Access        |   | Access          |   | Access           |  |
   |  | Control       |   | Control         |   | Control          |  |
   |  | Model         |   | Model           |   | Model            |  |
   |  |               |   |                 |   |                  |  |
   |  +---------------+   +-----------------+   +------------------+  |
   |                                                                  |
   +------------------------------------------------------------------+




<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.1.2.1.%20%20Access%20Control%20Model"></a><a class="selflink" href="#section-3.1.2.1" name="section-3.1.2.1">3.1.2.1</a>.  Access Control Model</span>

   An Access Control Model defines a particular access decision function
   in order to support decisions regarding access rights.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.3.%20%20Applications"></a><a class="selflink" href="#section-3.1.3" name="section-3.1.3">3.1.3</a>.  Applications</span>

   There are several types of applications, including:

      -  command generators, which monitor and manipulate management
         data,

      -  command responders, which provide access to management data,

      -  notification originators, which initiate asynchronous messages,

      -  notification receivers, which process asynchronous messages,
         and

      -  proxy forwarders, which forward messages between entities.

   These applications make use of the services provided by the SNMP
   engine.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.1.3.1.%20%20SNMP%20Manager"></a><a class="selflink" href="#section-3.1.3.1" name="section-3.1.3.1">3.1.3.1</a>.  SNMP Manager</span>

   An SNMP entity containing one or more command generator and/or
   notification receiver applications (along with their associated SNMP
   engine) has traditionally been called an SNMP manager.






















<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   * One or more models may be present.

                       (traditional SNMP manager)
   +-------------------------------------------------------------------+
   | +--------------+  +--------------+  +--------------+  SNMP entity |
   | | NOTIFICATION |  | NOTIFICATION |  |   COMMAND    |              |
   | |  ORIGINATOR  |  |   RECEIVER   |  |  GENERATOR   |              |
   | | applications |  | applications |  | applications |              |
   | +--------------+  +--------------+  +--------------+              |
   |         ^                ^                 ^                      |
   |         |                |                 |                      |
   |         v                v                 v                      |
   |         +-------+--------+-----------------+                      |
   |                 ^                                                 |
   |                 |     +---------------------+  +----------------+ |
   |                 |     | Message Processing  |  | Security       | |
   | Dispatcher      v     | Subsystem           |  | Subsystem      | |
   | +-------------------+ |     +------------+  |  |                | |
   | | PDU Dispatcher    | |  +-&gt;| v1MP     * |&lt;---&gt;| +------------+ | |
   | |                   | |  |  +------------+  |  | | Other      | | |
   | |                   | |  |  +------------+  |  | | Security   | | |
   | |                   | |  +-&gt;| v2cMP    * |&lt;---&gt;| | Model      | | |
   | | Message           | |  |  +------------+  |  | +------------+ | |
   | | Dispatcher  &lt;---------&gt;+                  |  |                | |
   | |                   | |  |  +------------+  |  | +------------+ | |
   | |                   | |  +-&gt;| v3MP     * |&lt;---&gt;| | User-based | | |
   | | Transport         | |  |  +------------+  |  | | Security   | | |
   | | Mapping           | |  |  +------------+  |  | | Model      | | |
   | | (e.g <a href="rfc1906.html">RFC1906</a>)     | |  +-&gt;| otherMP  * |&lt;---&gt;| +------------+ | |
   | +-------------------+ |     +------------+  |  |                | |
   |          ^            +---------------------+  +----------------+ |
   |          |                                                        |
   |          v                                                        |
   +-------------------------------------------------------------------+
   +-----+ +-----+       +-------+
   | UDP | | IPX | . . . | other |
   +-----+ +-----+       +-------+
      ^       ^              ^
      |       |              |
      v       v              v
   +------------------------------+
   |           Network            |
   +------------------------------+








<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.1.3.2.%20%20SNMP%20Agent"></a><a class="selflink" href="#section-3.1.3.2" name="section-3.1.3.2">3.1.3.2</a>.  SNMP Agent</span>

   An SNMP entity containing one or more command responder and/or
   notification originator applications (along with their associated
   SNMP engine) has traditionally been called an SNMP agent.
   +------------------------------+
   |           Network            |
   +------------------------------+
      ^       ^              ^
      |       |              |
      v       v              v
   +-----+ +-----+       +-------+
   | UDP | | IPX | . . . | other |
   +-----+ +-----+       +-------+              (traditional SNMP agent)
   +-------------------------------------------------------------------+
   |              ^                                                    |
   |              |        +---------------------+  +----------------+ |
   |              |        | Message Processing  |  | Security       | |
   | Dispatcher   v        | Subsystem           |  | Subsystem      | |
   | +-------------------+ |     +------------+  |  |                | |
   | | Transport         | |  +-&gt;| v1MP     * |&lt;---&gt;| +------------+ | |
   | | Mapping           | |  |  +------------+  |  | | Other      | | |
   | | (e.g. <a href="rfc1906.html">RFC1906</a>)    | |  |  +------------+  |  | | Security   | | |
   | |                   | |  +-&gt;| v2cMP    * |&lt;---&gt;| | Model      | | |
   | | Message           | |  |  +------------+  |  | +------------+ | |
   | | Dispatcher  &lt;---------&gt;|  +------------+  |  | +------------+ | |
   | |                   | |  +-&gt;| v3MP     * |&lt;---&gt;| | User-based | | |
   | |                   | |  |  +------------+  |  | | Security   | | |
   | | PDU Dispatcher    | |  |  +------------+  |  | | Model      | | |
   | +-------------------+ |  +-&gt;| otherMP  * |&lt;---&gt;| +------------+ | |
   |              ^        |     +------------+  |  |                | |
   |              |        +---------------------+  +----------------+ |
   |              v                                                    |
   |      +-------+-------------------------+---------------+          |
   |      ^                                 ^               ^          |
   |      |                                 |               |          |
   |      v                                 v               v          |
   | +-------------+   +---------+   +--------------+  +-------------+ |
   | |   COMMAND   |   | ACCESS  |   | NOTIFICATION |  |    PROXY  * | |
   | |  RESPONDER  |&lt;-&gt;| CONTROL |&lt;-&gt;|  ORIGINATOR  |  |  FORWARDER  | |
   | | application |   |         |   | applications |  | application | |
   | +-------------+   +---------+   +--------------+  +-------------+ |
   |      ^                                 ^                          |
   |      |                                 |                          |
   |      v                                 v                          |
   | +----------------------------------------------+                  |
   | |             MIB instrumentation              |      SNMP entity |
   +-------------------------------------------------------------------+



<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20The%20Naming%20of%20Identities"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  The Naming of Identities</span>

                            principal
                                ^
                                |
                                |
   +----------------------------|-------------+
   | SNMP engine                v             |
   |                    +--------------+      |
   |                    |              |      |
   |  +-----------------| securityName |---+  |
   |  | Security Model  |              |   |  |
   |  |                 +--------------+   |  |
   |  |                         ^          |  |
   |  |                         |          |  |
   |  |                         v          |  |
   |  |  +------------------------------+  |  |
   |  |  |                              |  |  |
   |  |  | Model                        |  |  |
   |  |  | Dependent                    |  |  |
   |  |  | Security ID                  |  |  |
   |  |  |                              |  |  |
   |  |  +------------------------------+  |  |
   |  |                         ^          |  |
   |  |                         |          |  |
   |  +-------------------------|----------+  |
   |                            |             |
   |                            |             |
   +----------------------------|-------------+
                                |
                                v
                             network

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.1.%20%20Principal"></a><a class="selflink" href="#section-3.2.1" name="section-3.2.1">3.2.1</a>.  Principal</span>

   A principal is the "who" on whose behalf services are provided or
   processing takes place.

   A principal can be, among other things, an individual acting in a
   particular role; a set of individuals, with each acting in a
   particular role; an application or a set of applications; and
   combinations thereof.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.2.%20%20securityName"></a><a class="selflink" href="#section-3.2.2" name="section-3.2.2">3.2.2</a>.  securityName</span>

   A securityName is a human readable string representing a principal.
   It has a model-independent format, and can be used outside a
   particular Security Model.



<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.3.%20%20Model-dependent%20security%20ID"></a><a class="selflink" href="#section-3.2.3" name="section-3.2.3">3.2.3</a>.  Model-dependent security ID</span>

   A model-dependent security ID is the model-specific representation of
   a securityName within a particular Security Model.

   Model-dependent security IDs may or may not be human readable, and
   have a model-dependent syntax. Examples include community names, and
   user names.

   The transformation of model-dependent security IDs into securityNames
   and vice versa is the responsibility of the relevant Security Model.








































<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20The%20Naming%20of%20Management%20Information"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  The Naming of Management Information</span>

   Management information resides at an SNMP entity where a Command
   Responder Application has local access to potentially multiple
   contexts.  This application uses a contextEngineID equal to the
   snmpEngineID of its associated SNMP engine.

   +-----------------------------------------------------------------+
   |  SNMP entity (identified by snmpEngineID, example: abcd)        |
   |                                                                 |
   |  +------------------------------------------------------------+ |
   |  | SNMP engine (identified by snmpEngineID)                   | |
   |  |                                                            | |
   |  | +-------------+ +------------+ +-----------+ +-----------+ | |
   |  | |             | |            | |           | |           | | |
   |  | | Dispatcher  | | Message    | | Security  | | Access    | | |
   |  | |             | | Processing | | Subsystem | | Control   | | |
   |  | |             | | Subsystem  | |           | | Subsystem | | |
   |  | |             | |            | |           | |           | | |
   |  | +-------------+ +------------+ +-----------+ +-----------+ | |
   |  |                                                            | |
   |  +------------------------------------------------------------+ |
   |                                                                 |
   |  +------------------------------------------------------------+ |
   |  |  Command Responder Application                             | |
   |  |  (contextEngineID, example: abcd)                          | |
   |  |                                                            | |
   |  |  example contextNames:                                     | |
   |  |                                                            | |
   |  |  "bridge1"          "bridge2"            "" (default)      | |
   |  |  ---------          ---------            ------------      | |
   |  |      |                  |                   |              | |
   |  +------|------------------|-------------------|--------------+ |
   |         |                  |                   |                |
   |  +------|------------------|-------------------|--------------+ |
   |  |  MIB | instrumentation  |                   |              | |
   |  |  +---v------------+ +---v------------+ +----v-----------+  | |
   |  |  | context        | | context        | | context        |  | |
   |  |  |                | |                | |                |  | |
   |  |  | +------------+ | | +------------+ | | +------------+ |  | |
   |  |  | | bridge MIB | | | | bridge MIB | | | | some  MIB  | |  | |
   |  |  | +------------+ | | +------------+ | | +------------+ |  | |
   |  |  |                | |                | |                |  | |
   |  |  |                | |                | | +------------+ |  | |
   |  |  |                | |                | | | other MIB  | |  | |
   |  |  |                | |                | | +------------+ |  | |
   |  |  |                | |                | |                |  | |
   +-----------------------------------------------------------------+



<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.1.%20%20An%20SNMP%20Context"></a><a class="selflink" href="#section-3.3.1" name="section-3.3.1">3.3.1</a>.  An SNMP Context</span>

   An SNMP context, or just "context" for short, is a collection of
   management information accessible by an SNMP entity. An item of
   management information may exist in more than one context. An SNMP
   entity potentially has access to many contexts.

   Typically, there are many instances of each managed object type
   within a management domain. For simplicity, the method for
   identifying instances specified by the MIB module does not allow each
   instance to be distinguished amongst the set of all instances within
   a management domain; rather, it allows each instance to be identified
   only within some scope or "context", where there are multiple such
   contexts within the management domain.  Often, a context is a
   physical device, or perhaps, a logical device, although a context can
   also encompass multiple devices, or a subset of a single device, or
   even a subset of multiple devices, but a context is always defined as
   a subset of a single SNMP entity.  Thus, in order to identify an
   individual item of management information within the management
   domain, its contextName and contextEngineID must be identified in
   addition to its object type and its instance.

   For example, the managed object type ifDescr [<a href="rfc2233.html" title='"The Interfaces Group MIB using SMIv2"'>RFC2233</a>], is defined as
   the description of a network interface.  To identify the description
   of device-X's first network interface, four pieces of information are
   needed: the snmpEngineID of the SNMP entity which provides access to
   the management information at device-X, the contextName (device-X),
   the managed object type (ifDescr), and the instance ("1").

   Each context has (at least) one unique identification within the
   management domain. The same item of management information can exist
   in multiple contexts. An item of management information may have
   multiple unique identifications.  This occurs when an item of
   management information exists in multiple contexts, and this also
   occurs when a context has multiple unique identifications.

   The combination of a contextEngineID and a contextName unambiguously
   identifies a context within an administrative domain; note that there
   may be multiple unique combinations of contextEngineID and
   contextName that unambiguously identify the same context.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.2.%20%20contextEngineID"></a><a class="selflink" href="#section-3.3.2" name="section-3.3.2">3.3.2</a>.  contextEngineID</span>

   Within an administrative domain, a contextEngineID uniquely
   identifies an SNMP entity that may realize an instance of a context
   with a particular contextName.





<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.3.%20%20contextName"></a><a class="selflink" href="#section-3.3.3" name="section-3.3.3">3.3.3</a>.  contextName</span>

   A contextName is used to name a context. Each contextName MUST be
   unique within an SNMP entity.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.4.%20%20scopedPDU"></a><a class="selflink" href="#section-3.3.4" name="section-3.3.4">3.3.4</a>.  scopedPDU</span>

   A scopedPDU is a block of data containing a contextEngineID, a
   contextName, and a PDU.

   The PDU is an SNMP Protocol Data Unit containing information named in
   the context which is unambiguously identified within an
   administrative domain by the combination of the contextEngineID and
   the contextName. See, for example, <a href="rfc1905.html">RFC1905</a> for more information about
   SNMP PDUs.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Other%20Constructs"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Other Constructs</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.1.%20%20maxSizeResponseScopedPDU"></a><a class="selflink" href="#section-3.4.1" name="section-3.4.1">3.4.1</a>.  maxSizeResponseScopedPDU</span>

   The maxSizeResponseScopedPDU is the maximum size of a scopedPDU that
   a PDU's sender would be willing to accept.  Note that the size of a
   scopedPDU does not include the size of the SNMP message header.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.2.%20%20Local%20Configuration%20Datastore"></a><a class="selflink" href="#section-3.4.2" name="section-3.4.2">3.4.2</a>.  Local Configuration Datastore</span>

   The subsystems, models, and applications within an SNMP entity may
   need to retain their own sets of configuration information.

   Portions of the configuration information may be accessible as
   managed objects.

   The collection of these sets of information is referred to as an
   entity's Local Configuration Datastore (LCD).

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.3.%20%20securityLevel"></a><a class="selflink" href="#section-3.4.3" name="section-3.4.3">3.4.3</a>.  securityLevel</span>

   This architecture recognizes three levels of security:

      -  without authentication and without privacy (noAuthNoPriv)

      -  with authentication but without privacy (authNoPriv)

      -  with authentication and with privacy (authPriv)

   These three values are ordered such that noAuthNoPriv is less than
   authNoPriv and authNoPriv is less than authPriv.




<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   Every message has an associated securityLevel. All Subsystems
   (Message Processing, Security, Access Control) and applications are
   REQUIRED to either supply a value of securityLevel or to abide by the
   supplied value of securityLevel while processing the message and its
   contents.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Abstract%20Service%20Interfaces"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Abstract Service Interfaces</span>

   Abstract service interfaces have been defined to describe the
   conceptual interfaces between the various subsystems within an SNMP
   entity.  The abstract service interfaces are intended to help clarify
   the externally observable behavior of SNMP entities, and are not
   intended to constrain the structure or organization of
   implementations in any way.  Most specifically, they should not be
   interpreted as APIs or as requirements statements for APIs.

   These abstract service interfaces are defined by a set of primitives
   that define the services provided and the abstract data elements that
   are to be passed when the services are invoked.  This section lists
   the primitives that have been defined for the various subsystems.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Dispatcher%20Primitives"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Dispatcher Primitives</span>

   The Dispatcher typically provides services to the SNMP applications
   via its PDU Dispatcher.  This section describes the primitives
   provided by the PDU Dispatcher.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.1.%20%20Generate%20Outgoing%20Request%20or%20Notification"></a><a class="selflink" href="#section-4.1.1" name="section-4.1.1">4.1.1</a>.  Generate Outgoing Request or Notification</span>

   The PDU Dispatcher provides the following primitive for an
   application to send an SNMP Request or Notification to another SNMP
   entity:

   statusInformation =              -- sendPduHandle if success
                                    -- errorIndication if failure
     sendPdu(
     IN   transportDomain           -- transport domain to be used
     IN   transportAddress          -- transport address to be used
     IN   messageProcessingModel    -- typically, SNMP version
     IN   securityModel             -- Security Model to use
     IN   securityName              -- on behalf of this principal
     IN   securityLevel             -- Level of Security requested
     IN   contextEngineID           -- data from/at this entity
     IN   contextName               -- data from/in this context
     IN   pduVersion                -- the version of the PDU
     IN   PDU                       -- SNMP Protocol Data Unit
     IN   expectResponse            -- TRUE or FALSE
          )



<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.2.%20%20Process%20Incoming%20Request%20or%20Notification%20PDU"></a><a class="selflink" href="#section-4.1.2" name="section-4.1.2">4.1.2</a>.  Process Incoming Request or Notification PDU</span>

   The PDU Dispatcher provides the following primitive to pass an
   incoming SNMP PDU to an application:

   processPdu(                      -- process Request/Notification PDU
     IN   messageProcessingModel    -- typically, SNMP version
     IN   securityModel             -- Security Model in use
     IN   securityName              -- on behalf of this principal
     IN   securityLevel             -- Level of Security
     IN   contextEngineID           -- data from/at this SNMP entity
     IN   contextName               -- data from/in this context
     IN   pduVersion                -- the version of the PDU
     IN   PDU                       -- SNMP Protocol Data Unit
     IN   maxSizeResponseScopedPDU  -- maximum size of the Response PDU
     IN   stateReference            -- reference to state information
          )                         -- needed when sending a response

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.3.%20%20Generate%20Outgoing%20Response"></a><a class="selflink" href="#section-4.1.3" name="section-4.1.3">4.1.3</a>.  Generate Outgoing Response</span>

   The PDU Dispatcher provides the following primitive for an
   application to return an SNMP Response PDU to the PDU Dispatcher:

   result =                         -- SUCCESS or FAILURE
   returnResponsePdu(
     IN   messageProcessingModel    -- typically, SNMP version
     IN   securityModel             -- Security Model in use
     IN   securityName              -- on behalf of this principal
     IN   securityLevel             -- same as on incoming request
     IN   contextEngineID           -- data from/at this SNMP entity
     IN   contextName               -- data from/in this context
     IN   pduVersion                -- the version of the PDU
     IN   PDU                       -- SNMP Protocol Data Unit
     IN   maxSizeResponseScopedPDU  -- maximum size sender can accept
     IN   stateReference            -- reference to state information
                                    -- as presented with the request
     IN   statusInformation         -- success or errorIndication
          )                         -- error counter OID/value if error

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.4.%20%20Process%20Incoming%20Response%20PDU"></a><a class="selflink" href="#section-4.1.4" name="section-4.1.4">4.1.4</a>.  Process Incoming Response PDU</span>

   The PDU Dispatcher provides the following primitive to pass an
   incoming SNMP Response PDU to an application:








<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 29]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   processResponsePdu(              -- process Response PDU
     IN   messageProcessingModel    -- typically, SNMP version
     IN   securityModel             -- Security Model in use
     IN   securityName              -- on behalf of this principal
     IN   securityLevel             -- Level of Security
     IN   contextEngineID           -- data from/at this SNMP entity
     IN   contextName               -- data from/in this context
     IN   pduVersion                -- the version of the PDU
     IN   PDU                       -- SNMP Protocol Data Unit
     IN   statusInformation         -- success or errorIndication
     IN   sendPduHandle             -- handle from sendPdu
          )

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.5.%20%20Registering%20Responsibility%20for%20Handling%20SNMP%20PDUs"></a><a class="selflink" href="#section-4.1.5" name="section-4.1.5">4.1.5</a>.  Registering Responsibility for Handling SNMP PDUs</span>

   Applications can register/unregister responsibility for a specific
   contextEngineID, for specific pduTypes, with the PDU Dispatcher
   according to the following primitives.  The list of particular
   pduTypes that an application can register for is determined by the
   Message Processing Model(s) supported by the SNMP entity that
   contains the PDU Dispatcher.

   statusInformation =            -- success or errorIndication
     registerContextEngineID(
     IN   contextEngineID         -- take responsibility for this one
     IN   pduType                 -- the pduType(s) to be registered
          )

   unregisterContextEngineID(
     IN   contextEngineID         -- give up responsibility for this one
     IN   pduType                 -- the pduType(s) to be unregistered
          )

   Note that realizations of the registerContextEngineID and
   unregisterContextEngineID abstract service interfaces may provide
   implementation-specific ways for applications to register/deregister
   responsibility for all possible values of the contextEngineID or
   pduType parameters.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Message%20Processing%20Subsystem%20Primitives"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Message Processing Subsystem Primitives</span>

   The Dispatcher interacts with a Message Processing Model to process a
   specific version of an SNMP Message. This section describes the
   primitives provided by the Message Processing Subsystem.







<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 30]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.1.%20%20Prepare%20Outgoing%20SNMP%20Request%20or%20Notification%20Message"></a><a class="selflink" href="#section-4.2.1" name="section-4.2.1">4.2.1</a>.  Prepare Outgoing SNMP Request or Notification Message</span>

   The Message Processing Subsystem provides this service primitive for
   preparing an outgoing SNMP Request or Notification Message:

   statusInformation =              -- success or errorIndication
     prepareOutgoingMessage(
     IN   transportDomain           -- transport domain to be used
     IN   transportAddress          -- transport address to be used
     IN   messageProcessingModel    -- typically, SNMP version
     IN   securityModel             -- Security Model to use
     IN   securityName              -- on behalf of this principal
     IN   securityLevel             -- Level of Security requested
     IN   contextEngineID           -- data from/at this entity
     IN   contextName               -- data from/in this context
     IN   pduVersion                -- the version of the PDU
     IN   PDU                       -- SNMP Protocol Data Unit
     IN   expectResponse            -- TRUE or FALSE
     IN   sendPduHandle             -- the handle for matching
                                    -- incoming responses
     OUT  destTransportDomain       -- destination transport domain
     OUT  destTransportAddress      -- destination transport address
     OUT  outgoingMessage           -- the message to send
     OUT  outgoingMessageLength     -- its length
          )

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.2.%20%20Prepare%20an%20Outgoing%20SNMP%20Response%20Message"></a><a class="selflink" href="#section-4.2.2" name="section-4.2.2">4.2.2</a>.  Prepare an Outgoing SNMP Response Message</span>

   The Message Processing Subsystem provides this service primitive for
   preparing an outgoing SNMP Response Message:

   result =                         -- SUCCESS or FAILURE
     prepareResponseMessage(
     IN   messageProcessingModel    -- typically, SNMP version
     IN   securityModel             -- same as on incoming request
     IN   securityName              -- same as on incoming request
     IN   securityLevel             -- same as on incoming request
     IN   contextEngineID           -- data from/at this SNMP entity
     IN   contextName               -- data from/in this context
     IN   pduVersion                -- the version of the PDU
     IN   PDU                       -- SNMP Protocol Data Unit
     IN   maxSizeResponseScopedPDU  -- maximum size able to accept
     IN   stateReference            -- reference to state information
                                    -- as presented with the request
     IN   statusInformation         -- success or errorIndication
                                    -- error counter OID/value if error
     OUT  destTransportDomain       -- destination transport domain
     OUT  destTransportAddress      -- destination transport address



<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 31]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


     OUT  outgoingMessage           -- the message to send
     OUT  outgoingMessageLength     -- its length
          )

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.3.%20%20Prepare%20Data%20Elements%20from%20an%20Incoming%20SNMP%20Message"></a><a class="selflink" href="#section-4.2.3" name="section-4.2.3">4.2.3</a>.  Prepare Data Elements from an Incoming SNMP Message</span>

   The Message Processing Subsystem provides this service primitive for
   preparing the abstract data elements from an incoming SNMP message:

   result =                         -- SUCCESS or errorIndication
     prepareDataElements(
     IN   transportDomain           -- origin transport domain
     IN   transportAddress          -- origin transport address
     IN   wholeMsg                  -- as received from the network
     IN   wholeMsgLength            -- as received from the network
     OUT  messageProcessingModel    -- typically, SNMP version
     OUT  securityModel             -- Security Model to use
     OUT  securityName              -- on behalf of this principal
     OUT  securityLevel             -- Level of Security requested
     OUT  contextEngineID           -- data from/at this entity
     OUT  contextName               -- data from/in this context
     OUT  pduVersion                -- the version of the PDU
     OUT  PDU                       -- SNMP Protocol Data Unit
     OUT  pduType                   -- SNMP PDU type
     OUT  sendPduHandle             -- handle for matched request
     OUT  maxSizeResponseScopedPDU  -- maximum size sender can accept
     OUT  statusInformation         -- success or errorIndication
                                    -- error counter OID/value if error
     OUT  stateReference            -- reference to state information
                                    -- to be used for possible Response
          )

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Access%20Control%20Subsystem%20Primitives"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Access Control Subsystem Primitives</span>

   Applications are the typical clients of the service(s) of the Access
   Control Subsystem.

   The following primitive is provided by the Access Control Subsystem
   to check if access is allowed:












<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 32]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   statusInformation =              -- success or errorIndication
     isAccessAllowed(
     IN   securityModel             -- Security Model in use
     IN   securityName              -- principal who wants to access
     IN   securityLevel             -- Level of Security
     IN   viewType                  -- read, write, or notify view
     IN   contextName               -- context containing variableName
     IN   variableName              -- OID for the managed object
          )

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.4.%20%20Security%20Subsystem%20Primitives"></a><a class="selflink" href="#section-4.4" name="section-4.4">4.4</a>.  Security Subsystem Primitives</span>

   The Message Processing Subsystem is the typical client of the
   services of the Security Subsystem.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.4.1.%20%20Generate%20a%20Request%20or%20Notification%20Message"></a><a class="selflink" href="#section-4.4.1" name="section-4.4.1">4.4.1</a>.  Generate a Request or Notification Message</span>

   The Security Subsystem provides the following primitive to generate a
   Request or Notification message:

   statusInformation =
     generateRequestMsg(
     IN   messageProcessingModel    -- typically, SNMP version
     IN   globalData                -- message header, admin data
     IN   maxMessageSize            -- of the sending SNMP entity
     IN   securityModel             -- for the outgoing message
     IN   securityEngineID          -- authoritative SNMP entity
     IN   securityName              -- on behalf of this principal
     IN   securityLevel             -- Level of Security requested
     IN   scopedPDU                 -- message (plaintext) payload
     OUT  securityParameters        -- filled in by Security Module
     OUT  wholeMsg                  -- complete generated message
     OUT  wholeMsgLength            -- length of the generated message
          )

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.4.2.%20%20Process%20Incoming%20Message"></a><a class="selflink" href="#section-4.4.2" name="section-4.4.2">4.4.2</a>.  Process Incoming Message</span>

   The Security Subsystem provides the following primitive to process an
   incoming message:












<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 33]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-34" id="page-34" name="page-34"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   statusInformation =              -- errorIndication or success
                                    -- error counter OID/value if error
     processIncomingMsg(
     IN   messageProcessingModel    -- typically, SNMP version
     IN   maxMessageSize            -- of the sending SNMP entity
     IN   securityParameters        -- for the received message
     IN   securityModel             -- for the received message
     IN   securityLevel             -- Level of Security
     IN   wholeMsg                  -- as received on the wire
     IN   wholeMsgLength            -- length as received on the wire
     OUT  securityEngineID          -- identification of the principal
     OUT  securityName              -- identification of the principal
     OUT  scopedPDU,                -- message (plaintext) payload
     OUT  maxSizeResponseScopedPDU  -- maximum size sender can handle
     OUT  securityStateReference    -- reference to security state
          )                         -- information, needed for response

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.4.3.%20%20Generate%20a%20Response%20Message"></a><a class="selflink" href="#section-4.4.3" name="section-4.4.3">4.4.3</a>.  Generate a Response Message</span>

   The Security Subsystem provides the following primitive to generate a
   Response message:

   statusInformation =
     generateResponseMsg(
     IN   messageProcessingModel    -- typically, SNMP version
     IN   globalData                -- message header, admin data
     IN   maxMessageSize            -- of the sending SNMP entity
     IN   securityModel             -- for the outgoing message
     IN   securityEngineID          -- authoritative SNMP entity
     IN   securityName              -- on behalf of this principal
     IN   securityLevel             -- for the outgoing message
     IN   scopedPDU                 -- message (plaintext) payload
     IN   securityStateReference    -- reference to security state
                                    -- information from original request
     OUT  securityParameters        -- filled in by Security Module
     OUT  wholeMsg                  -- complete generated message
     OUT  wholeMsgLength            -- length of the generated message
          )

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.5.%20%20Common%20Primitives"></a><a class="selflink" href="#section-4.5" name="section-4.5">4.5</a>.  Common Primitives</span>

   These primitive(s) are provided by multiple Subsystems.









<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 34]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-35" id="page-35" name="page-35"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.5.1.%20%20Release%20State%20Reference%20Information"></a><a class="selflink" href="#section-4.5.1" name="section-4.5.1">4.5.1</a>.  Release State Reference Information</span>

   All Subsystems which pass stateReference information also provide a
   primitive to release the memory that holds the referenced state
   information:

   stateRelease(
     IN   stateReference       -- handle of reference to be released
          )










































<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 35]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-36" id="page-36" name="page-36"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.6.%20%20Scenario%20Diagrams"></a><a class="selflink" href="#section-4.6" name="section-4.6">4.6</a>.  Scenario Diagrams</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.6.1.%20%20Command%20Generator%20or%20Notification%20Originator"></a><a class="selflink" href="#section-4.6.1" name="section-4.6.1">4.6.1</a>.  Command Generator or Notification Originator</span>

   This diagram shows how a Command Generator or Notification Originator
   application requests that a PDU be sent, and how the response is
   returned (asynchronously) to that application.

   Command           Dispatcher               Message           Security
   Generator            |                     Processing           Model
   |                    |                     Model                    |
   |      sendPdu       |                        |                     |
   |-------------------&gt;|                        |                     |
   |                    | prepareOutgoingMessage |                     |
   :                    |-----------------------&gt;|                     |
   :                    |                        | generateRequestMsg  |
   :                    |                        |--------------------&gt;|
   :                    |                        |                     |
   :                    |                        |&lt;--------------------|
   :                    |                        |                     |
   :                    |&lt;-----------------------|                     |
   :                    |                        |                     |
   :                    |------------------+     |                     |
   :                    | Send SNMP        |     |                     |
   :                    | Request Message  |     |                     |
   :                    | to Network       |     |                     |
   :                    |                  v     |                     |
   :                    :                  :     :                     :
   :                    :                  :     :                     :
   :                    :                  :     :                     :
   :                    |                  |     |                     |
   :                    | Receive SNMP     |     |                     |
   :                    | Response Message |     |                     |
   :                    | from Network     |     |                     |
   :                    |&lt;-----------------+     |                     |
   :                    |                        |                     |
   :                    |   prepareDataElements  |                     |
   :                    |-----------------------&gt;|                     |
   :                    |                        | processIncomingMsg  |
   :                    |                        |--------------------&gt;|
   :                    |                        |                     |
   :                    |                        |&lt;--------------------|
   :                    |                        |                     |
   :                    |&lt;-----------------------|                     |
   | processResponsePdu |                        |                     |
   |&lt;-------------------|                        |                     |
   |                    |                        |                     |




<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 36]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-37" id="page-37" name="page-37"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.6.2.%20%20Scenario%20Diagram%20for%20a%20Command%20Responder%20Application"></a><a class="selflink" href="#section-4.6.2" name="section-4.6.2">4.6.2</a>.  Scenario Diagram for a Command Responder Application</span>

   This diagram shows how a Command Responder or Notification Receiver
   application registers for handling a pduType, how a PDU is dispatched
   to the application after a SNMP message is received, and how the
   Response is (asynchronously) send back to the network.

   Command               Dispatcher            Message          Security
   Responder                 |                 Processing          Model
   |                         |                 Model                   |
   |                         |                    |                    |
   | registerContextEngineID |                    |                    |
   |------------------------&gt;|                    |                    |
   |&lt;------------------------|              |     |                    |
   |                         | Receive SNMP |     |                    |
   :                         | Message      |     |                    |
   :                         | from Network |     |                    |
   :                         |&lt;-------------+     |                    |
   :                         |                    |                    |
   :                         |prepareDataElements |                    |
   :                         |-------------------&gt;|                    |
   :                         |                    | processIncomingMsg |
   :                         |                    |-------------------&gt;|
   :                         |                    |                    |
   :                         |                    |&lt;-------------------|
   :                         |                    |                    |
   :                         |&lt;-------------------|                    |
   |     processPdu          |                    |                    |
   |&lt;------------------------|                    |                    |
   |                         |                    |                    |
   :                         :                    :                    :
   :                         :                    :                    :
   |    returnResponsePdu    |                    |                    |
   |------------------------&gt;|                    |                    |
   :                         | prepareResponseMsg |                    |
   :                         |-------------------&gt;|                    |
   :                         |                    |generateResponseMsg |
   :                         |                    |-------------------&gt;|
   :                         |                    |                    |
   :                         |                    |&lt;-------------------|
   :                         |                    |                    |
   :                         |&lt;-------------------|                    |
   :                         |                    |                    |
   :                         |--------------+     |                    |
   :                         | Send SNMP    |     |                    |
   :                         | Message      |     |                    |
   :                         | to Network   |     |                    |
   :                         |              v     |                    |



<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 37]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-38" id="page-38" name="page-38"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Managed%20Object%20Definitions%20for%20SNMP%20Management%20Frameworks"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Managed Object Definitions for SNMP Management Frameworks</span>

   SNMP-FRAMEWORK-MIB DEFINITIONS ::= BEGIN

   IMPORTS
       MODULE-IDENTITY, OBJECT-TYPE,
       OBJECT-IDENTITY,
       snmpModules                           FROM SNMPv2-SMI
       TEXTUAL-CONVENTION                    FROM SNMPv2-TC
       MODULE-COMPLIANCE, OBJECT-GROUP       FROM SNMPv2-CONF;

   snmpFrameworkMIB MODULE-IDENTITY
       LAST-UPDATED "9901190000Z"            -- 19 January 1999
       ORGANIZATION "SNMPv3 Working Group"
       CONTACT-INFO "WG-EMail:   snmpv3@tis.com
                     Subscribe:  majordomo@tis.com
                                 In message body:  subscribe snmpv3

                     Chair:      Russ Mundy
                                 TIS Labs at Network Associates
                     postal:     3060 Washington Rd
                                 Glenwood MD 21738
                                 USA
                     EMail:      mundy@tis.com
                     phone:      +1 301-854-6889

                     Co-editor   Dave Harrington
                                 Cabletron Systems, Inc.
                     postal:     Post Office Box 5005
                                 Mail Stop: Durham
                                 35 Industrial Way
                                 Rochester, NH 03867-5005
                                 USA
                     EMail:      dbh@ctron.com
                     phone:      +1 603-337-7357

                     Co-editor   Randy Presuhn
                                 BMC Software, Inc.
                     postal:     965 Stewart Drive
                                 Sunnyvale, CA 94086
                                 USA
                     EMail:      randy_presuhn@bmc.com
                     phone:      +1 408-616-3100

                     Co-editor:  Bert Wijnen
                                 IBM T.J. Watson Research
                     postal:     Schagen 33
                                 3461 GL Linschoten



<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 38]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-39" id="page-39" name="page-39"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


                                 Netherlands
                     EMail:      wijnen@vnet.ibm.com
                     phone:      +31 348-432-794
                    "
       DESCRIPTION  "The SNMP Management Architecture MIB"
   -- Revision History

       REVISION     "9901190000Z"            -- 19 January 1999
       DESCRIPTION  "Updated editors' addresses, fixed typos.
                     Published as <a href="rfc2571.html">RFC2571</a>.
                    "
       REVISION     "9711200000Z"            -- 20 November 1997
       DESCRIPTION  "The initial version, published in <a href="rfc2271.html">RFC 2271</a>.
                    "
       ::= { snmpModules 10 }

   -- Textual Conventions used in the SNMP Management Architecture ***

   SnmpEngineID ::= TEXTUAL-CONVENTION
       STATUS       current
       DESCRIPTION "An SNMP engine's administratively-unique identifier.
                    Objects of this type are for identification, not for
                    addressing, even though it is possible that an
                    address may have been used in the generation of
                    a specific value.

                    The value for this object may not be all zeros or
                    all 'ff'H or the empty (zero length) string.

                    The initial value for this object may be configured
                    via an operator console entry or via an algorithmic
                    function.  In the latter case, the following
                    example algorithm is recommended.

                    In cases where there are multiple engines on the
                    same system, the use of this algorithm is NOT
                    appropriate, as it would result in all of those
                    engines ending up with the same ID value.

                    1) The very first bit is used to indicate how the
                       rest of the data is composed.

                       0 - as defined by enterprise using former methods
                           that existed before SNMPv3. See item 2 below.

                       1 - as defined by this architecture, see item 3
                           below.




<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 39]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-40" id="page-40" name="page-40"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


                       Note that this allows existing uses of the
                       engineID (also known as AgentID [<a href="rfc1910.html" title='"User-based Security Model for SNMPv2"'>RFC1910</a>]) to
                       co-exist with any new uses.

                    2) The snmpEngineID has a length of 12 octets.

                       The first four octets are set to the binary
                       equivalent of the agent's SNMP management
                       private enterprise number as assigned by the
                       Internet Assigned Numbers Authority (IANA).
                       For example, if Acme Networks has been assigned
                       { enterprises 696 }, the first four octets would
                       be assigned '000002b8'H.

                       The remaining eight octets are determined via
                       one or more enterprise-specific methods. Such
                       methods must be designed so as to maximize the
                       possibility that the value of this object will
                       be unique in the agent's administrative domain.
                       For example, it may be the IP address of the SNMP
                       entity, or the MAC address of one of the
                       interfaces, with each address suitably padded
                       with random octets.  If multiple methods are
                       defined, then it is recommended that the first
                       octet indicate the method being used and the
                       remaining octets be a function of the method.

                    3) The length of the octet strings varies.

                       The first four octets are set to the binary
                       equivalent of the agent's SNMP management
                       private enterprise number as assigned by the
                       Internet Assigned Numbers Authority (IANA).
                       For example, if Acme Networks has been assigned
                       { enterprises 696 }, the first four octets would
                       be assigned '000002b8'H.

                       The very first bit is set to 1. For example, the
                       above value for Acme Networks now changes to be
                       '800002b8'H.

                       The fifth octet indicates how the rest (6th and
                       following octets) are formatted. The values for
                       the fifth octet are:

                         0     - reserved, unused.

                         1     - IPv4 address (4 octets)



<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 40]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-41" id="page-41" name="page-41"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


                                 lowest non-special IP address

                         2     - IPv6 address (16 octets)
                                 lowest non-special IP address

                         3     - MAC address (6 octets)
                                 lowest IEEE MAC address, canonical
                                 order

                         4     - Text, administratively assigned
                                 Maximum remaining length 27

                         5     - Octets, administratively assigned
                                 Maximum remaining length 27

                         6-127 - reserved, unused

                       127-255 - as defined by the enterprise
                                 Maximum remaining length 27
                   "
       SYNTAX       OCTET STRING (SIZE(5..32))

   SnmpSecurityModel ::= TEXTUAL-CONVENTION
       STATUS       current
       DESCRIPTION "An identifier that uniquely identifies a
                    securityModel of the Security Subsystem within the
                    SNMP Management Architecture.

                    The values for securityModel are allocated as
                    follows:

                    - The zero value is reserved.
                    - Values between 1 and 255, inclusive, are reserved
                      for standards-track Security Models and are
                      managed by the Internet Assigned Numbers Authority
                      (IANA).
                    - Values greater than 255 are allocated to
                      enterprise-specific Security Models.  An
                      enterprise-specific securityModel value is defined
                      to be:

                      enterpriseID * 256 + security model within
                      enterprise

                      For example, the fourth Security Model defined by
                      the enterprise whose enterpriseID is 1 would be
                      260.




<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 41]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-42" id="page-42" name="page-42"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


                    This scheme for allocation of securityModel
                    values allows for a maximum of 255 standards-
                    based Security Models, and for a maximum of
                    255 Security Models per enterprise.

                    It is believed that the assignment of new
                    securityModel values will be rare in practice
                    because the larger the number of simultaneously
                    utilized Security Models, the larger the
                    chance that interoperability will suffer.
                    Consequently, it is believed that such a range
                    will be sufficient.  In the unlikely event that
                    the standards committee finds this number to be
                    insufficient over time, an enterprise number
                    can be allocated to obtain an additional 255
                    possible values.

                    Note that the most significant bit must be zero;
                    hence, there are 23 bits allocated for various
                    organizations to design and define non-standard
                    securityModels.  This limits the ability to
                    define new proprietary implementations of Security
                    Models to the first 8,388,608 enterprises.

                    It is worthwhile to note that, in its encoded
                    form, the securityModel value will normally
                    require only a single byte since, in practice,
                    the leftmost bits will be zero for most messages
                    and sign extension is suppressed by the encoding
                    rules.

                    As of this writing, there are several values
                    of securityModel defined for use with SNMP or
                    reserved for use with supporting MIB objects.
                    They are as follows:

                        0  reserved for 'any'
                        1  reserved for SNMPv1
                        2  reserved for SNMPv2c
                        3  User-Based Security Model (USM)
                   "
       SYNTAX       INTEGER(0 .. 2147483647)

   SnmpMessageProcessingModel ::= TEXTUAL-CONVENTION
       STATUS       current
       DESCRIPTION "An identifier that uniquely identifies a Message
                    Processing Model of the Message Processing
                    Subsystem within a SNMP Management Architecture.



<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 42]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-43" id="page-43" name="page-43"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


                    The values for messageProcessingModel are
                    allocated as follows:

                    - Values between 0 and 255, inclusive, are
                      reserved for standards-track Message Processing
                      Models and are managed by the Internet Assigned
                      Numbers Authority (IANA).

                    - Values greater than 255 are allocated to
                      enterprise-specific Message Processing Models.
                      An enterprise messageProcessingModel value is
                      defined to be:

                      enterpriseID * 256 +
                           messageProcessingModel within enterprise

                      For example, the fourth Message Processing Model
                      defined by the enterprise whose enterpriseID
                      is 1 would be 260.

                    This scheme for allocating messageProcessingModel
                    values allows for a maximum of 255 standards-
                    based Message Processing Models, and for a
                    maximum of 255 Message Processing Models per
                    enterprise.

                    It is believed that the assignment of new
                    messageProcessingModel values will be rare
                    in practice because the larger the number of
                    simultaneously utilized Message Processing Models,
                    the larger the chance that interoperability
                    will suffer. It is believed that such a range
                    will be sufficient.  In the unlikely event that
                    the standards committee finds this number to be
                    insufficient over time, an enterprise number
                    can be allocated to obtain an additional 256
                    possible values.

                    Note that the most significant bit must be zero;
                    hence, there are 23 bits allocated for various
                    organizations to design and define non-standard
                    messageProcessingModels.  This limits the ability
                    to define new proprietary implementations of
                    Message Processing Models to the first 8,388,608
                    enterprises.

                    It is worthwhile to note that, in its encoded
                    form, the messageProcessingModel value will



<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 43]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-44" id="page-44" name="page-44"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


                    normally require only a single byte since, in
                    practice, the leftmost bits will be zero for
                    most messages and sign extension is suppressed
                    by the encoding rules.

                    As of this writing, there are several values of
                    messageProcessingModel defined for use with SNMP.
                    They are as follows:

                        0  reserved for SNMPv1
                        1  reserved for SNMPv2c
                        2  reserved for SNMPv2u and SNMPv2*
                        3  reserved for SNMPv3
                   "
       SYNTAX       INTEGER(0 .. 2147483647)

   SnmpSecurityLevel ::= TEXTUAL-CONVENTION
       STATUS       current
       DESCRIPTION "A Level of Security at which SNMP messages can be
                    sent or with which operations are being processed;
                    in particular, one of:

                      noAuthNoPriv - without authentication and
                                     without privacy,
                      authNoPriv   - with authentication but
                                     without privacy,
                      authPriv     - with authentication and
                                     with privacy.

                    These three values are ordered such that
                    noAuthNoPriv is less than authNoPriv and
                    authNoPriv is less than authPriv.
                   "
       SYNTAX       INTEGER { noAuthNoPriv(1),
                              authNoPriv(2),
                              authPriv(3)
                            }

   SnmpAdminString ::= TEXTUAL-CONVENTION
       DISPLAY-HINT "255a"
       STATUS       current
       DESCRIPTION "An octet string containing administrative
                    information, preferably in human-readable form.

                    To facilitate internationalization, this
                    information is represented using the ISO/IEC
                    IS 10646-1 character set, encoded as an octet
                    string using the UTF-8 transformation format



<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 44]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-45" id="page-45" name="page-45"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


                    described in [<a href="rfc2279.html" title='"UTF-8, a transformation format of ISO 10646"'>RFC2279</a>].

                    Since additional code points are added by
                    amendments to the 10646 standard from time
                    to time, implementations must be prepared to
                    encounter any code point from 0x00000000 to
                    0x7fffffff.  Byte sequences that do not
                    correspond to the valid UTF-8 encoding of a
                    code point or are outside this range are
                    prohibited.

                    The use of control codes should be avoided.

                    When it is necessary to represent a newline,
                    the control code sequence CR LF should be used.

                    The use of leading or trailing white space should
                    be avoided.

                    For code points not directly supported by user
                    interface hardware or software, an alternative
                    means of entry and display, such as hexadecimal,
                    may be provided.

                    For information encoded in 7-bit US-ASCII,
                    the UTF-8 encoding is identical to the
                    US-ASCII encoding.

                    UTF-8 may require multiple bytes to represent a
                    single character / code point; thus the length
                    of this object in octets may be different from
                    the number of characters encoded.  Similarly,
                    size constraints refer to the number of encoded
                    octets, not the number of characters represented
                    by an encoding.

                    Note that when this TC is used for an object that
                    is used or envisioned to be used as an index, then
                    a SIZE restriction MUST be specified so that the
                    number of sub-identifiers for any object instance
                    does not exceed the limit of 128, as defined by
                    [<a href="rfc1905.html" title='"Protocol Operations for Version 2 of the Simple Network Management Protocol (SNMPv2)"'>RFC1905</a>].

                    Note that the size of an SnmpAdminString object is
                    measured in octets, not characters.
                   "
       SYNTAX       OCTET STRING (SIZE (0..255))




<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 45]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-46" id="page-46" name="page-46"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   -- Administrative assignments ***************************************

   snmpFrameworkAdmin
       OBJECT IDENTIFIER ::= { snmpFrameworkMIB 1 }
   snmpFrameworkMIBObjects
       OBJECT IDENTIFIER ::= { snmpFrameworkMIB 2 }
   snmpFrameworkMIBConformance
       OBJECT IDENTIFIER ::= { snmpFrameworkMIB 3 }

   -- the snmpEngine Group ********************************************

   snmpEngine OBJECT IDENTIFIER ::= { snmpFrameworkMIBObjects 1 }

   snmpEngineID     OBJECT-TYPE
       SYNTAX       SnmpEngineID
       MAX-ACCESS   read-only
       STATUS       current
       DESCRIPTION "An SNMP engine's administratively-unique identifier.
                   "
       ::= { snmpEngine 1 }

   snmpEngineBoots  OBJECT-TYPE
       SYNTAX       INTEGER (1..2147483647)
       MAX-ACCESS   read-only
       STATUS       current
       DESCRIPTION "The number of times that the SNMP engine has
                    (re-)initialized itself since snmpEngineID
                    was last configured.
                   "
       ::= { snmpEngine 2 }

   snmpEngineTime   OBJECT-TYPE
       SYNTAX       INTEGER (0..2147483647)
       UNITS        "seconds"
       MAX-ACCESS   read-only
       STATUS       current
       DESCRIPTION "The number of seconds since the value of
                    the snmpEngineBoots object last changed.
                    When incrementing this object's value would
                    cause it to exceed its maximum,
                    snmpEngineBoots is incremented as if a
                    re-initialization had occurred, and this
                    object's value consequently reverts to zero.
                   "
       ::= { snmpEngine 3 }

   snmpEngineMaxMessageSize OBJECT-TYPE
       SYNTAX       INTEGER (484..2147483647)



<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 46]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-47" id="page-47" name="page-47"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


       MAX-ACCESS   read-only
       STATUS       current
       DESCRIPTION "The maximum length in octets of an SNMP message
                    which this SNMP engine can send or receive and
                    process, determined as the minimum of the maximum
                    message size values supported among all of the
                    transports available to and supported by the engine.
                   "
       ::= { snmpEngine 4 }


   -- Registration Points for Authentication and Privacy Protocols **

   snmpAuthProtocols OBJECT-IDENTITY
       STATUS        current
       DESCRIPTION  "Registration point for standards-track
                     authentication protocols used in SNMP Management
                     Frameworks.
                    "
       ::= { snmpFrameworkAdmin 1 }

   snmpPrivProtocols OBJECT-IDENTITY
       STATUS        current
       DESCRIPTION  "Registration point for standards-track privacy
                     protocols used in SNMP Management Frameworks.
                    "
       ::= { snmpFrameworkAdmin 2 }

   -- Conformance information ******************************************

   snmpFrameworkMIBCompliances
                  OBJECT IDENTIFIER ::= {snmpFrameworkMIBConformance 1}
   snmpFrameworkMIBGroups
                  OBJECT IDENTIFIER ::= {snmpFrameworkMIBConformance 2}

   -- compliance statements

   snmpFrameworkMIBCompliance MODULE-COMPLIANCE
       STATUS       current
       DESCRIPTION "The compliance statement for SNMP engines which
                    implement the SNMP Management Framework MIB.
                   "
       MODULE    -- this module
           MANDATORY-GROUPS { snmpEngineGroup }

       ::= { snmpFrameworkMIBCompliances 1 }

   -- units of conformance



<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 47]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-48" id="page-48" name="page-48"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   snmpEngineGroup OBJECT-GROUP
       OBJECTS {
                 snmpEngineID,
                 snmpEngineBoots,
                 snmpEngineTime,
                 snmpEngineMaxMessageSize
               }
       STATUS       current
       DESCRIPTION "A collection of objects for identifying and
                    determining the configuration and current timeliness
                    values of an SNMP engine.
                   "
       ::= { snmpFrameworkMIBGroups 1 }

   END


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  IANA Considerations</span>

   This document defines three number spaces administered by IANA, one
   for security models, another for message processing models, and a
   third for SnmpEngineID formats.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Security%20Models"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Security Models</span>

   The SnmpSecurityModel TEXTUAL-CONVENTION values managed by IANA are
   in the range from 0 to 255 inclusive, and are reserved for
   standards-track Security Models.  If this range should in the future
   prove insufficient, an enterprise number can be allocated to obtain
   an additional 255 possible values.

   As of this writing, there are several values of securityModel defined
   for use with SNMP or reserved for use with supporting MIB objects.
   They are as follows:
                        0  reserved for 'any'
                        1  reserved for SNMPv1
                        2  reserved for SNMPv2c
                        3  User-Based Security Model (USM)

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Message%20Processing%20Models"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Message Processing Models</span>

   The SnmpMessageProcessingModel TEXTUAL-CONVENTION values managed by
   IANA are in the range 0 to 255, inclusive.  Each value uniquely
   identifies a standards-track Message Processing Model of the Message
   Processing Subsystem within a SNMP Management Architecture.

   Should this range prove insufficient in the future, an enterprise
   number may be obtained for the standards committee to get an



<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 48]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-49" id="page-49" name="page-49"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   additional 256 possible values.

   As of this writing, there are several values of
   messageProcessingModel defined for use with SNMP.  They are as
   follows:
                        0  reserved for SNMPv1
                        1  reserved for SNMPv2c
                        2  reserved for SNMPv2u and SNMPv2*
                        3  reserved for SNMPv3

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20SnmpEngineID%20Formats"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  SnmpEngineID Formats</span>

   The SnmpEngineID TEXTUAL-CONVENTION's  fifth octet contains a format
   identifier.  The values managed by IANA are in the range 6 to 127,
   inclusive.  Each value uniquely identifies a standards-track
   SnmpEngineID format.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Intellectual%20Property"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Intellectual Property</span>

   The IETF takes no position regarding the validity or scope of any
   intellectual property or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; neither does it represent that it
   has made any effort to identify any such rights.  Information on the
   IETF's procedures with respect to rights in standards-track and
   standards-related documentation can be found in <a href="https://tools.ietf.org/html/bcp11">BCP-11</a>.  Copies of
   claims of rights made available for publication and any assurances of
   licenses to be made available, or the result of an attempt made to
   obtain a general license or permission for the use of such
   proprietary rights by implementors or users of this specification can
   be obtained from the IETF Secretariat.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights which may cover technology that may be required to practice
   this standard.  Please address the information to the IETF Executive
   Director.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Acknowledgements"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Acknowledgements</span>

   This document is the result of the efforts of the SNMPv3 Working
   Group.  Some special thanks are in order to the following SNMPv3 WG
   members:

       Harald Tveit Alvestrand (Maxware)
       Dave Battle (SNMP Research, Inc.)
       Alan Beard (Disney Worldwide Services)



<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 49]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-50" id="page-50" name="page-50"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


       Paul Berrevoets (SWI Systemware/Halcyon Inc.)
       Martin Bjorklund (Ericsson)
       Uri Blumenthal (IBM T.J. Watson Research Center)
       Jeff Case (SNMP Research, Inc.)
       John Curran (BBN)
       Mike Daniele (Compaq Computer Corporation)
       T. Max Devlin (Eltrax Systems)
       John Flick (Hewlett Packard)
       Rob Frye (MCI)
       Wes Hardaker (U.C.Davis, Information Technology - D.C.A.S.)
       David Harrington (Cabletron Systems Inc.)
       Lauren Heintz (BMC Software, Inc.)
       N.C. Hien (IBM T.J. Watson Research Center)
       Michael Kirkham (InterWorking Labs, Inc.)
       Dave Levi (SNMP Research, Inc.)
       Louis A Mamakos (UUNET Technologies Inc.)
       Joe Marzot (Nortel Networks)
       Paul Meyer (Secure Computing Corporation)
       Keith McCloghrie (Cisco Systems)
       Bob Moore (IBM)
       Russ Mundy (TIS Labs at Network Associates)
       Bob Natale (ACE*COMM Corporation)
       Mike O'Dell (UUNET Technologies Inc.)
       Dave Perkins (DeskTalk)
       Peter Polkinghorne (Brunel University)
       Randy Presuhn (BMC Software, Inc.)
       David Reeder (TIS Labs at Network Associates)
       David Reid (SNMP Research, Inc.)
       Aleksey Romanov (Quality Quorum)
       Shawn Routhier (Epilogue)
       Juergen Schoenwaelder (TU Braunschweig)
       Bob Stewart (Cisco Systems)
       Mike Thatcher (Independent Consultant)
       Bert Wijnen (IBM T.J. Watson Research Center)

   The document is based on recommendations of the IETF Security and
   Administrative Framework Evolution for SNMP Advisory Team.  Members
   of that Advisory Team were:

       David Harrington (Cabletron Systems Inc.)
       Jeff Johnson (Cisco Systems)
       David Levi (SNMP Research Inc.)
       John Linn (Openvision)
       Russ Mundy (Trusted Information Systems) chair
       Shawn Routhier (Epilogue)
       Glenn Waters (Nortel)
       Bert Wijnen (IBM T. J. Watson Research Center)




<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 50]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-51" id="page-51" name="page-51"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   As recommended by the Advisory Team and the SNMPv3 Working Group
   Charter, the design incorporates as much as practical from previous
   RFCs and drafts. As a result, special thanks are due to the authors
   of previous designs known as SNMPv2u and SNMPv2*:

       Jeff Case (SNMP Research, Inc.)
       David Harrington (Cabletron Systems Inc.)
       David Levi (SNMP Research, Inc.)
       Keith McCloghrie (Cisco Systems)
       Brian O'Keefe (Hewlett Packard)
       Marshall T. Rose (Dover Beach Consulting)
       Jon Saperia (BGS Systems Inc.)
       Steve Waldbusser (International Network Services)
       Glenn W. Waters (Bell-Northern Research Ltd.)

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Security%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Security Considerations</span>

   This document describes how an implementation can include a Security
   Model to protect management messages and an Access Control Model to
   control access to management information.

   The level of security provided is determined by the specific Security
   Model implementation(s) and the specific Access Control Model
   implementation(s) used.

   Applications have access to data which is not secured.  Applications
   SHOULD take reasonable steps to protect the data from disclosure.

   It is the responsibility of the purchaser of an implementation to
   ensure that:

      1) an implementation complies with the rules defined by this
         architecture,

      2) the Security and Access Control Models utilized satisfy the
         security and access control needs of the organization,

      3) the implementations of the Models and Applications comply with
         the model and application specifications,

      4) and the implementation protects configuration secrets from
         inadvertent disclosure.

   This document also contains a MIB definition module.  None of the
   objects defined is writable, and the information they represent is
   not deemed to be particularly sensitive.  However, if they are deemed





<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 51]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-52" id="page-52" name="page-52"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   sensitive in a particular environment, access to them should be
   restricted through the use of appropriately configured Security and
   Access Control models.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20References"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  References</span>

   [<a id="ref-RFC1155" name="ref-RFC1155">RFC1155</a>]    Rose, M. and K. McCloghrie, "Structure and
                Identification of Management Information for TCP/IP-
                based internets", STD 16, <a href="rfc1155.html">RFC 1155</a>, May 1990.

   [<a id="ref-RFC1157" name="ref-RFC1157">RFC1157</a>]    Case, J., M. Fedor, M. Schoffstall and J. Davin, "The
                Simple Network Management Protocol", STD 15, <a href="rfc1157.html">RFC 1157</a>,
                May 1990.

   [<a id="ref-RFC1212" name="ref-RFC1212">RFC1212</a>]    Rose, M. and K. McCloghrie, "Concise MIB Definitions",
                STD 16, <a href="rfc1212.html">RFC 1212</a>, March 1991.

   [<a id="ref-RFC1901" name="ref-RFC1901">RFC1901</a>]    The SNMPv2 Working Group, Case, J., McCloghrie, K.,
                Rose, M.  and S. Waldbusser, "Introduction to
                Community-based SNMPv2", <a href="rfc1901.html">RFC 1901</a>, January 1996.

   [<a id="ref-RFC2578" name="ref-RFC2578">RFC2578</a>]    McCloghrie, K., Perkins, D. and J. Schoenwaelder,
                "Structure of Management Information Version 2 (SMIv2)",
                STD 58, <a href="rfc2578.html">RFC 2578</a>, April 1999.

   [<a id="ref-RFC2579" name="ref-RFC2579">RFC2579</a>]    McCloghrie, K., Perkins, D. and J. Schoenwaelder,,
                "Textual Conventions for SMIv2", STD 58, <a href="rfc2579.html">RFC 2579</a>, April
                1999.

   [<a id="ref-RFC2580" name="ref-RFC2580">RFC2580</a>]    McCloghrie, K., Perkins, D. and J. Schoenwaelder,
                "Conformance Statements for SMIv2", STD 58, <a href="rfc2580.html">RFC 2580</a>,
                April 1999.

   [<a id="ref-RFC1905" name="ref-RFC1905">RFC1905</a>]    The SNMPv2 Working Group, Case, J., McCloghrie, K.,
                Rose, M. and S. Waldbusser, "Protocol Operations for
                Version 2 of the Simple Network Management Protocol
                (SNMPv2)", <a href="rfc1905.html">RFC 1905</a>, January 1996.

   [<a id="ref-RFC1906" name="ref-RFC1906">RFC1906</a>]    The SNMPv2 Working Group, Case, J., McCloghrie, K.,
                Rose, M. and S. Waldbusser, "Transport Mappings for
                Version 2 of the Simple Network Management Protocol
                (SNMPv2)", <a href="rfc1906.html">RFC 1906</a>, January 1996.

   [<a id="ref-RFC1907" name="ref-RFC1907">RFC1907</a>]    The SNMPv2 Working Group, Case, J., McCloghrie, K.,
                Rose, M. and S. Waldbusser, "Management Information Base
                for Version 2 of the Simple Network Management Protocol
                (SNMPv2)", <a href="rfc1907.html">RFC 1907</a> January 1996.




<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 52]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-53" id="page-53" name="page-53"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   [<a id="ref-RFC1908" name="ref-RFC1908">RFC1908</a>]    The SNMPv2 Working Group, Case, J., McCloghrie, K.,
                Rose, M. and S. Waldbusser, "Coexistence between Version
                1 and Version 2 of the SNMP-standard Network Management
                Framework", <a href="rfc1908.html">RFC 1908</a>, January 1996.

   [<a id="ref-RFC1909" name="ref-RFC1909">RFC1909</a>]    McCloghrie, K., Editor, "An Administrative
                Infrastructure for SNMPv2", <a href="rfc1909.html">RFC 1909</a>, February 1996.

   [<a id="ref-RFC1910" name="ref-RFC1910">RFC1910</a>]    Waters, G., Editor, "User-based Security Model for
                SNMPv2", <a href="rfc1910.html">RFC 1910</a>, February 1996.

   [<a id="ref-RFC2279" name="ref-RFC2279">RFC2279</a>]    Yergeau, F., "UTF-8, a transformation format of ISO
                10646", <a href="rfc2279.html">RFC 2279</a>, January, 1998.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]    Bradner, S., "Key words for use in RFCs to Indicate
                Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-BCP-11" name="ref-BCP-11">BCP-11</a>]     Hovey, R. and S. Bradner, "The Organizations Involved in
                the IETF Standards Process", <a href="https://tools.ietf.org/html/bcp11">BCP 11</a>, <a href="rfc2028.html">RFC 2028</a>, October
                1996.

   [<a id="ref-RFC2233" name="ref-RFC2233">RFC2233</a>]    McCloghrie, K. and F. Kastenholz.  "The Interfaces Group
                MIB using SMIv2", <a href="rfc2233.html">RFC 2233</a>, November 1997.

   [<a id="ref-RFC2572" name="ref-RFC2572">RFC2572</a>]    Case, J., Harrington, D., Presuhn, R.  and B. Wijnen,
                "Message Processing and Dispatching for the Simple
                Network Management Protocol (SNMP)", <a href="rfc2572.html">RFC 2572</a>, April
                1999.

   [<a id="ref-RFC2574" name="ref-RFC2574">RFC2574</a>]    Blumenthal, U.  and B. Wijnen, "The User-Based Security
                Model for Version 3 of the Simple Network Management
                Protocol (SNMPv3)", <a href="rfc2574.html">RFC 2574</a>, April 1999.

   [<a id="ref-RFC2575" name="ref-RFC2575">RFC2575</a>]    Wijnen, B., Presuhn, R.  and K. McCloghrie, "View-based
                Access Control Model for the Simple Network Management
                Protocol (SNMP)", <a href="rfc2575.html">RFC 2575</a>, April 1999.

   [<a id="ref-RFC2573" name="ref-RFC2573">RFC2573</a>]    Levi, D. B., Meyer, P.  and B. Stewart, "SNMP
                Applications", <a href="rfc2573.html">RFC 2573</a>, April 1999.

   [<a id="ref-RFC2570" name="ref-RFC2570">RFC2570</a>]    Case, J., Mundy, R., Partain, D. and B. Stewart,
                "Introduction to Version 3 of the Internet-standard
                Network Management Framework", <a href="rfc2570.html">RFC 2570</a>, April 1999.

   [<a id="ref-SNMP-COEX" name="ref-SNMP-COEX">SNMP-COEX</a>]  Frye, R., Levi, D. and B. Wijnen, "Coexistence between
                Version 1, Version 2, and Version 3 of the Internet-
                standard Network Management Framework", Work in
                Progress.



<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 53]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-54" id="page-54" name="page-54"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20Editor%27s%20Addresses"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  Editor's Addresses</span>

   Bert Wijnen
   IBM T.J. Watson Research
   Schagen 33
   3461 GL Linschoten
   Netherlands

   Phone:      +31 348-432-794
   EMail:      wijnen@vnet.ibm.com


   Dave Harrington
   Cabletron Systems, Inc
   Post Office Box 5005
   Mail Stop: Durham
   35 Industrial Way
   Rochester, NH 03867-5005
   USA

   Phone:      +1 603-337-7357
   EMail:      dbh@ctron.com


   Randy Presuhn
   BMC Software, Inc.
   965 Stewart Drive
   Sunnyvale, CA 94086
   USA

   Phone:      +1 408-616-3100
   Fax:        +1 408-616-3101
   EMail:      randy_presuhn@bmc.com


















<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 54]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-55" id="page-55" name="page-55"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


APPENDIX A


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/A.%20%20Guidelines%20for%20Model%20Designers"></a><a class="selflink" href="#appendix-A" name="appendix-A">A</a>.  Guidelines for Model Designers</span>

   This appendix describes guidelines for designers of models which are
   expected to fit into the architecture defined in this document.

   SNMPv1 and SNMPv2c are two SNMP frameworks which use communities to
   provide trivial authentication and access control. SNMPv1 and SNMPv2c
   Frameworks can coexist with Frameworks designed according to this
   architecture, and modified versions of SNMPv1 and SNMPv2c Frameworks
   could be designed to meet the requirements of this architecture, but
   this document does not provide guidelines for that coexistence.

   Within any subsystem model, there should be no reference to any
   specific model of another subsystem, or to data defined by a specific
   model of another subsystem.

   Transfer of data between the subsystems is deliberately described as
   a fixed set of abstract data elements and primitive functions which
   can be overloaded to satisfy the needs of multiple model definitions.

   Documents which define models to be used within this architecture
   SHOULD use the standard primitives between subsystems, possibly
   defining specific mechanisms for converting the abstract data
   elements into model-usable formats. This constraint exists to allow
   subsystem and model documents to be written recognizing common
   borders of the subsystem and model. Vendors are not constrained to
   recognize these borders in their implementations.

   The architecture defines certain standard services to be provided
   between subsystems, and the architecture defines abstract service
   interfaces to request these services.

   Each model definition for a subsystem SHOULD support the standard
   service interfaces, but whether, or how, or how well, it performs the
   service is dependent on the model definition.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.1.%20%20Security%20Model%20Design%20Requirements"></a><a class="selflink" href="#appendix-A.1" name="appendix-A.1">A.1</a>.  Security Model Design Requirements</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/A.1.1.%20%20Threats"></a><a class="selflink" href="#appendix-A.1.1" name="appendix-A.1.1">A.1.1</a>.  Threats</span>

   A document describing a Security Model MUST describe how the model
   protects against the threats described under "Security Requirements
   of this Architecture", <a href="#section-1.4">section 1.4</a>.





<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 55]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-56" id="page-56" name="page-56"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/A.1.2.%20%20Security%20Processing"></a><a class="selflink" href="#appendix-A.1.2" name="appendix-A.1.2">A.1.2</a>.  Security Processing</span>

   Received messages MUST be validated by a Model of the Security
   Subsystem.  Validation includes authentication and privacy processing
   if needed, but it is explicitly allowed to send messages which do not
   require authentication or privacy.

   A received message contains a specified securityLevel to be used
   during processing.  All messages requiring privacy MUST also require
   authentication.

   A Security Model specifies rules by which authentication and privacy
   are to be done.  A model may define mechanisms to provide additional
   security features, but the model definition is constrained to using
   (possibly a subset of) the abstract data elements defined in this
   document for transferring data between subsystems.

   Each Security Model may allow multiple security protocols to be used
   concurrently within an implementation of the model. Each Security
   Model defines how to determine which protocol to use, given the
   securityLevel and the security parameters relevant to the message.
   Each Security Model, with its associated protocol(s) defines how the
   sending/receiving entities are identified, and how secrets are
   configured.

   Authentication and Privacy protocols supported by Security Models are
   uniquely identified using Object Identifiers. IETF standard protocols
   for authentication or privacy should have an identifier defined
   within the snmpAuthProtocols or the snmpPrivProtocols subtrees.
   Enterprise specific protocol identifiers should be defined within the
   enterprise subtree.

   For privacy, the Security Model defines what portion of the message
   is encrypted.

   The persistent data used for security should be SNMP-manageable, but
   the Security Model defines whether an instantiation of the MIB is a
   conformance requirement.

   Security Models are replaceable within the Security Subsystem.
   Multiple Security Model implementations may exist concurrently within
   an SNMP engine.  The number of Security Models defined by the SNMP
   community should remain small to promote interoperability.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/A.1.3.%20%20Validate%20the%20security-stamp%20in%20a%20received%20message"></a><a class="selflink" href="#appendix-A.1.3" name="appendix-A.1.3">A.1.3</a>.  Validate the security-stamp in a received message</span>

   A Message Processing Model requests that a Security Model:
     - verifies that the message has not been altered,



<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 56]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-57" id="page-57" name="page-57"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


     - authenticates the identification of the principal for whom the
       message was generated.
     - decrypts the message if it was encrypted.

   Additional requirements may be defined by the model, and additional
   services may be provided by the model, but the model is constrained
   to use the following primitives for transferring data between
   subsystems. Implementations are not so constrained.

   A Message Processing Model uses the processIncomingMsg primitive as
   described in <a href="#section-4.4.2">section 4.4.2</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/A.1.4.%20%20Security%20MIBs"></a><a class="selflink" href="#appendix-A.1.4" name="appendix-A.1.4">A.1.4</a>.  Security MIBs</span>

   Each Security Model defines the MIB module(s) required for security
   processing, including any MIB module(s) required for the security
   protocol(s) supported.  The MIB module(s) SHOULD be defined
   concurrently with the procedures which use the MIB module(s).  The
   MIB module(s) are subject to normal access control rules.

   The mapping between the model-dependent security ID and the
   securityName MUST be able to be determined using SNMP, if the model-
   dependent MIB is instantiated and if access control policy allows
   access.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/A.1.5.%20%20Cached%20Security%20Data"></a><a class="selflink" href="#appendix-A.1.5" name="appendix-A.1.5">A.1.5</a>.  Cached Security Data</span>

   For each message received, the Security Model caches the state
   information such that a Response message can be generated using the
   same security information, even if the Local Configuration Datastore
   is altered between the time of the incoming request and the outgoing
   response.

   A Message Processing Model has the responsibility for explicitly
   releasing the cached data if such data is no longer needed. To enable
   this, an abstract securityStateReference data element is passed from
   the Security Model to the Message Processing Model.

   The cached security data may be implicitly released via the
   generation of a response, or explicitly released by using the
   stateRelease primitive, as described in <a href="#section-4.5.1">section 4.5.1</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.2.%20%20Message%20Processing%20Model%20Design%20Requirements"></a><a class="selflink" href="#appendix-A.2" name="appendix-A.2">A.2</a>.  Message Processing Model Design Requirements</span>

   An SNMP engine contains a Message Processing Subsystem which may
   contain multiple Message Processing Models.





<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 57]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-58" id="page-58" name="page-58"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   The Message Processing Model MUST always (conceptually) pass the
   complete PDU, i.e., it never forwards less than the complete list of
   varBinds.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/A.2.1.%20%20Receiving%20an%20SNMP%20Message%20from%20the%20Network"></a><a class="selflink" href="#appendix-A.2.1" name="appendix-A.2.1">A.2.1</a>.  Receiving an SNMP Message from the Network</span>

   Upon receipt of a message from the network, the Dispatcher in the
   SNMP engine determines the version of the SNMP message and interacts
   with the corresponding Message Processing Model to determine the
   abstract data elements.

   A Message Processing Model specifies the SNMP Message format it
   supports and describes how to determine the values of the abstract
   data elements (like msgID, msgMaxSize, msgFlags,
   msgSecurityParameters, securityModel, securityLevel etc). A Message
   Processing Model interacts with a Security Model to provide security
   processing for the message using the processIncomingMsg primitive, as
   described in <a href="#section-4.4.2">section 4.4.2</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/A.2.2.%20%20Sending%20an%20SNMP%20Message%20to%20the%20Network"></a><a class="selflink" href="#appendix-A.2.2" name="appendix-A.2.2">A.2.2</a>.  Sending an SNMP Message to the Network</span>

   The Dispatcher in the SNMP engine interacts with a Message Processing
   Model to prepare an outgoing message. For that it uses the following
   primitives:

      -  for requests and notifications:  prepareOutgoingMessage, as
         described in <a href="#section-4.2.1">section 4.2.1</a>.

      -  for response messages:  prepareResponseMessage, as described in
         <a href="#section-4.2.2">section 4.2.2</a>.

   A Message Processing Model, when preparing an Outgoing SNMP Message,
   interacts with a Security Model to secure the message. For that it
   uses the following primitives:

      -  for requests and notifications:  generateRequestMsg, as
         described in <a href="#section-4.4.1">section 4.4.1</a>.

      -  for response messages:  generateResponseMsg as described in
         <a href="#section-4.4.3">section 4.4.3</a>.

      Once the SNMP message is prepared by a Message Processing Model,
      the Dispatcher sends the message to the desired address using the
      appropriate transport.







<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 58]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-59" id="page-59" name="page-59"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.3.%20%20Application%20Design%20Requirements"></a><a class="selflink" href="#appendix-A.3" name="appendix-A.3">A.3</a>.  Application Design Requirements</span>

   Within an application, there may be an explicit binding to a specific
   SNMP message version, i.e., a specific Message Processing Model, and
   to a specific Access Control Model, but there should be no reference
   to any data defined by a specific Message Processing Model or Access
   Control Model.

   Within an application, there should be no reference to any specific
   Security Model, or any data defined by a specific Security Model.

   An application determines whether explicit or implicit access control
   should be applied to the operation, and, if access control is needed,
   which Access Control Model should be used.

   An application has the responsibility to define any MIB module(s)
   used to provide application-specific services.

   Applications interact with the SNMP engine to initiate messages,
   receive responses, receive asynchronous messages, and send responses.


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/A.3.1.%20%20Applications%20that%20Initiate%20Messages"></a><a class="selflink" href="#appendix-A.3.1" name="appendix-A.3.1">A.3.1</a>.  Applications that Initiate Messages</span>

   Applications may request that the SNMP engine send messages
   containing SNMP commands or notifications using the sendPdu primitive
   as described in <a href="#section-4.1.1">section 4.1.1</a>.

   If it is desired that a message be sent to multiple targets, it is
   the responsibility of the application to provide the iteration.

   The SNMP engine assumes necessary access control has been applied to
   the PDU, and provides no access control services.

   The SNMP engine looks at the "expectResponse" parameter, and if a
   response is expected, then the appropriate information is cached such
   that a later response can be associated to this message, and can then
   be returned to the application. A sendPduHandle is returned to the
   application so it can later correspond the response with this message
   as well.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/A.3.2.%20%20Applications%20that%20Receive%20Responses"></a><a class="selflink" href="#appendix-A.3.2" name="appendix-A.3.2">A.3.2</a>.  Applications that Receive Responses</span>

   The SNMP engine matches the incoming response messages to outstanding
   messages sent by this SNMP engine, and forwards the response to the
   associated application using the processResponsePdu primitive, as
   described in <a href="#section-4.1.4">section 4.1.4</a>.




<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 59]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-60" id="page-60" name="page-60"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/A.3.3.%20%20Applications%20that%20Receive%20Asynchronous%20Messages"></a><a class="selflink" href="#appendix-A.3.3" name="appendix-A.3.3">A.3.3</a>.  Applications that Receive Asynchronous Messages</span>

   When an SNMP engine receives a message that is not the response to a
   request from this SNMP engine, it must determine to which application
   the message should be given.

   An Application that wishes to receive asynchronous messages registers
   itself with the engine using the primitive registerContextEngineID as
   described in <a href="#section-4.1.5">section 4.1.5</a>.

   An Application that wishes to stop receiving asynchronous messages
   should unregister itself with the SNMP engine using the primitive
   unregisterContextEngineID as described in <a href="#section-4.1.5">section 4.1.5</a>.

   Only one registration per combination of PDU type and contextEngineID
   is permitted at the same time. Duplicate registrations are ignored.
   An errorIndication will be returned to the application that attempts
   to duplicate a registration.

   All asynchronously received messages containing a registered
   combination of PDU type and contextEngineID are sent to the
   application which registered to support that combination.

   The engine forwards the PDU to the registered application, using the
   processPdu primitive, as described in <a href="#section-4.1.2">section 4.1.2</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/A.3.4.%20%20Applications%20that%20Send%20Responses"></a><a class="selflink" href="#appendix-A.3.4" name="appendix-A.3.4">A.3.4</a>.  Applications that Send Responses</span>

   Request operations require responses.  An application sends a
   response via the returnResponsePdu primitive, as described in <a href="#section-4.1.3">section</a>
   <a href="#section-4.1.3">4.1.3</a>.

   The contextEngineID, contextName, securityModel, securityName,
   securityLevel, and stateReference parameters are from the initial
   processPdu primitive. The PDU and statusInformation are the results
   of processing.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.4.%20%20Access%20Control%20Model%20Design%20Requirements"></a><a class="selflink" href="#appendix-A.4" name="appendix-A.4">A.4</a>.  Access Control Model Design Requirements</span>

   An Access Control Model determines whether the specified securityName
   is allowed to perform the requested operation on a specified managed
   object. The Access Control Model specifies the rules by which access
   control is determined.

   The persistent data used for access control should be manageable
   using SNMP, but the Access Control Model defines whether an
   instantiation of the MIB is a conformance requirement.




<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 60]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-61" id="page-61" name="page-61"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


   The Access Control Model must provide the primitive isAccessAllowed.


















































<span class="grey">SNMPv3 Working Group        Standards Track                    [Page 61]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-62" id="page-62" name="page-62"> </a>
<span class="grey"><a href="rfc2571.html">RFC 2571</a>           Architecture for SNMP Frameworks             April 1999</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/B.%20%20Full%20Copyright%20Statement"></a><a class="selflink" href="#appendix-B" name="appendix-B">B</a>.  Full Copyright Statement</span>

   Copyright (C) The Internet Society (1999).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Acknowledgement

   Funding for the RFC Editor function is currently provided by
   the Internet Society.
























SNMPv3 Working Group        Standards Track                    [Page 62]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.127, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc2571 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Aug 2018 14:27:51 GMT --></html>