<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc8230 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:15 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:8230" name="DC.Identifier"/>
<meta content="The CBOR Object Signing and Encryption (COSE) specification defines
cryptographic message encodings using Concise Binary Object
Representation (CBOR). This specification defines algorithm encodings
and representations enabling RSA algorithms to be used for COSE
messages. Encodings are specified for the use of RSA Probabilistic
Signature Scheme (RSASSA-PSS) signatures, RSA Encryption Scheme -
Optimal Asymmetric Encryption Padding (RSAES-OAEP) encryption, and RSA
keys." name="DC.Description.Abstract"/>
<meta content="Michael Jones &lt;mbj@microsoft.com&gt;" name="DC.Creator"/>
<meta content="September, 2017" name="DC.Date.Issued"/>
<meta content="Using RSA Algorithms with CBOR Object Signing and Encryption (COSE) Messages" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 8230 - Using RSA Algorithms with CBOR Object Signing and Encryption (COSE) Messages</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc8230.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc8230" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-jones-cose-rsa" title="draft-jones-cose-rsa">draft-jones-cos...</a>] [<a href="https://datatracker.ietf.org/doc/rfc8230" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc8230" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc8230" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                          M. Jones
Request for Comments: 8230                                     Microsoft
Category: Standards Track                                 September 2017
ISSN: 2070-1721


                       <span class="h1">Using RSA Algorithms with</span>
           <span class="h1">CBOR Object Signing and Encryption (COSE) Messages</span>

Abstract

   The CBOR Object Signing and Encryption (COSE) specification defines
   cryptographic message encodings using Concise Binary Object
   Representation (CBOR).  This specification defines algorithm
   encodings and representations enabling RSA algorithms to be used for
   COSE messages.  Encodings are specified for the use of RSA
   Probabilistic Signature Scheme (RSASSA-PSS) signatures, RSA
   Encryption Scheme - Optimal Asymmetric Encryption Padding (RSAES-
   OAEP) encryption, and RSA keys.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc7841.html#section-2">Section 2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc8230">http://www.rfc-editor.org/info/rfc8230</a>.

Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



<span class="grey">Jones                        Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc8230.html">RFC 8230</a>         Using RSA Algorithms with COSE Messages  September 2017</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-1.1">1.1</a>.  Requirements Notation and Conventions . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  RSASSA-PSS Signature Algorithm  . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  RSAES-OAEP Key Encryption Algorithm . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-4">4</a>.  RSA Keys  . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-5">5</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-5.1">5.1</a>.  COSE Algorithms Registrations . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-5.2">5.2</a>.  COSE Key Type Registrations . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-5.3">5.3</a>.  COSE Key Type Parameters Registrations  . . . . . . . . .   <a href="#page-7">7</a>
   <a href="#section-6">6</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
     <a href="#section-6.1">6.1</a>.  Key Size Security Considerations  . . . . . . . . . . . .   <a href="#page-9">9</a>
     <a href="#section-6.2">6.2</a>.  RSASSA-PSS Security Considerations  . . . . . . . . . . .  <a href="#page-10">10</a>
     <a href="#section-6.3">6.3</a>.  RSAES-OAEP Security Considerations  . . . . . . . . . . .  <a href="#page-10">10</a>
   <a href="#section-7">7</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
     <a href="#section-7.1">7.1</a>.  Normative References  . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
     <a href="#section-7.2">7.2</a>.  Informative References  . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>































<span class="grey">Jones                        Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc8230.html">RFC 8230</a>         Using RSA Algorithms with COSE Messages  September 2017</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The CBOR Object Signing and Encryption (COSE) [<a href="rfc8152.html" title='"CBOR Object Signing and Encryption (COSE)"'>RFC8152</a>] specification
   defines cryptographic message encodings using Concise Binary Object
   Representation (CBOR) [<a href="rfc7049.html" title='"Concise Binary Object Representation (CBOR)"'>RFC7049</a>].  This specification defines
   algorithm encodings and representations enabling RSA algorithms to be
   used for COSE messages.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Requirements%20Notation%20and%20Conventions"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Requirements Notation and Conventions</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in <a href="https://tools.ietf.org/html/bcp14">BCP</a>
   <a href="https://tools.ietf.org/html/bcp14">14</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>] [<a href="rfc8174.html" title='"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"'>RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20RSASSA-PSS%20Signature%20Algorithm"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  RSASSA-PSS Signature Algorithm</span>

   The RSASSA-PSS signature algorithm is defined in [<a href="rfc8017.html" title='"PKCS #1: RSA Cryptography Specifications Version 2.2"'>RFC8017</a>].

   The RSASSA-PSS signature algorithm is parameterized with a hash
   function (h), a mask generation function (mgf), and a salt length
   (sLen).  For this specification, the mask generation function is
   fixed to be MGF1 as defined in [<a href="rfc8017.html" title='"PKCS #1: RSA Cryptography Specifications Version 2.2"'>RFC8017</a>].  It has been recommended
   that the same hash function be used for hashing the data as well as
   in the mask generation function.  This specification follows this
   recommendation.  The salt length is the same length as the hash
   function output.

   Implementations need to check that the key type is 'RSA' when
   creating or verifying a signature.

   The RSASSA-PSS algorithms specified in this document are in the
   following table.

     +-------+-------+---------+-------------+-----------------------+
     | Name  | Value | Hash    | Salt Length | Description           |
     +-------+-------+---------+-------------+-----------------------+
     | PS256 | -37   | SHA-256 | 32          | RSASSA-PSS w/ SHA-256 |
     | PS384 | -38   | SHA-384 | 48          | RSASSA-PSS w/ SHA-384 |
     | PS512 | -39   | SHA-512 | 64          | RSASSA-PSS w/ SHA-512 |
     +-------+-------+---------+-------------+-----------------------+

                   Table 1: RSASSA-PSS Algorithm Values







<span class="grey">Jones                        Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc8230.html">RFC 8230</a>         Using RSA Algorithms with COSE Messages  September 2017</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20RSAES-OAEP%20Key%20Encryption%20Algorithm"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  RSAES-OAEP Key Encryption Algorithm</span>

   RSAES-OAEP is an asymmetric key encryption algorithm.  The definition
   of RSAEA-OAEP can be found in <a href="rfc8017.html#section-7.1">Section 7.1 of [RFC8017]</a>.  The
   algorithm is parameterized using a mask generation function (mgf), a
   hash function (h), and encoding parameters (P).  For the algorithm
   identifiers defined in this section:

   o  mgf is always set to MGF1 as defined in [<a href="rfc8017.html" title='"PKCS #1: RSA Cryptography Specifications Version 2.2"'>RFC8017</a>] and uses the
      same hash function as h.

   o  P is always set to the empty octet string.

   The following table summarizes the rest of the values.

   +-------------------------------+-------+---------+-----------------+
   | Name                          | Value | Hash    | Description     |
   +-------------------------------+-------+---------+-----------------+
   | RSAES-OAEP w/ <a href="rfc8017.html">RFC 8017</a>        | -40   | SHA-1   | RSAES-OAEP w/   |
   | default parameters            |       |         | SHA-1           |
   | RSAES-OAEP w/ SHA-256         | -41   | SHA-256 | RSAES-OAEP w/   |
   |                               |       |         | SHA-256         |
   | RSAES-OAEP w/ SHA-512         | -42   | SHA-512 | RSAES-OAEP w/   |
   |                               |       |         | SHA-512         |
   +-------------------------------+-------+---------+-----------------+

                   Table 2: RSAES-OAEP Algorithm Values

   The key type MUST be 'RSA'.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20RSA%20Keys"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  RSA Keys</span>

   Key types are identified by the 'kty' member of the COSE_Key object.
   This specification defines one value for this member in the following
   table.

                      +------+-------+-------------+
                      | Name | Value | Description |
                      +------+-------+-------------+
                      | RSA  | 3     | RSA Key     |
                      +------+-------+-------------+

                         Table 3: Key Type Values








<span class="grey">Jones                        Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc8230.html">RFC 8230</a>         Using RSA Algorithms with COSE Messages  September 2017</span>


   This document defines a key structure for both the public and private
   parts of RSA keys.  Together, an RSA public key and an RSA private
   key form an RSA key pair.

   The document also provides support for the so-called "multi-prime"
   RSA keys, in which the modulus may have more than two prime factors.
   The benefit of multi-prime RSA is lower computational cost for the
   decryption and signature primitives.  For a discussion on how multi-
   prime affects the security of RSA cryptosystems, the reader is
   referred to [<a href="#ref-MultiPrimeRSA">MultiPrimeRSA</a>].

   This document follows the naming convention of [<a href="rfc8017.html" title='"PKCS #1: RSA Cryptography Specifications Version 2.2"'>RFC8017</a>] for the
   naming of the fields of an RSA public or private key, and the
   corresponding fields have identical semantics.  The requirements for
   fields for RSA keys are as follows:

   o  For all keys, 'kty' MUST be present and MUST have a value of 3.

   o  For public keys, the fields 'n' and 'e' MUST be present.  All
      other fields defined in the following table below MUST be absent.

   o  For private keys with two primes, the fields 'other', 'r_i',
      'd_i', and 't_i' MUST be absent; all other fields MUST be present.

   o  For private keys with more than two primes, all fields MUST be
      present.  For the third to nth primes, each of the primes is
      represented as a map containing the fields 'r_i', 'd_i', and
      't_i'.  The field 'other' is an array of those maps.

   o  All numeric key parameters are encoded in an unsigned big-endian
      representation as an octet sequence using the CBOR byte string
      type (major type 2).  The octet sequence MUST utilize the minimum
      number of octets needed to represent the value.  For instance, the
      value 32,768 is represented as the CBOR byte sequence 0b010_00010,
      0x80 0x00 (major type 2, additional information 2 for the length).
















<span class="grey">Jones                        Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc8230.html">RFC 8230</a>         Using RSA Algorithms with COSE Messages  September 2017</span>


   The following table provides a summary of the label values and the
   types associated with each of those labels.

   +-------+-------+-------+-------+-----------------------------------+
   | Key   | Name  | Label | CBOR  | Description                       |
   | Type  |       |       | Type  |                                   |
   +-------+-------+-------+-------+-----------------------------------+
   | 3     | n     | -1    | bstr  | the RSA modulus n                 |
   | 3     | e     | -2    | bstr  | the RSA public exponent e         |
   | 3     | d     | -3    | bstr  | the RSA private exponent d        |
   | 3     | p     | -4    | bstr  | the prime factor p of n           |
   | 3     | q     | -5    | bstr  | the prime factor q of n           |
   | 3     | dP    | -6    | bstr  | dP is d mod (p - 1)               |
   | 3     | dQ    | -7    | bstr  | dQ is d mod (q - 1)               |
   | 3     | qInv  | -8    | bstr  | qInv is the CRT coefficient       |
   |       |       |       |       | q^(-1) mod p                      |
   | 3     | other | -9    | array | other prime infos, an array       |
   | 3     | r_i   | -10   | bstr  | a prime factor r_i of n, where i  |
   |       |       |       |       | &gt;= 3                              |
   | 3     | d_i   | -11   | bstr  | d_i = d mod (r_i - 1)             |
   | 3     | t_i   | -12   | bstr  | the CRT coefficient t_i = (r_1 *  |
   |       |       |       |       | r_2 * ... * r_(i-1))^(-1) mod r_i |
   +-------+-------+-------+-------+-----------------------------------+

                        Table 4: RSA Key Parameters

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  IANA Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20COSE%20Algorithms%20Registrations"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  COSE Algorithms Registrations</span>

   IANA has registered the following values in the IANA "COSE
   Algorithms" registry [<a href="#ref-IANA.COSE" title='"CBOR Object Signing and Encryption (COSE)"'>IANA.COSE</a>].

   o  Name: PS256
   o  Value: -37
   o  Description: RSASSA-PSS w/ SHA-256
   o  Reference: <a href="#section-2">Section 2</a> of this document
   o  Recommended: Yes

   o  Name: PS384
   o  Value: -38
   o  Description: RSASSA-PSS w/ SHA-384
   o  Reference: <a href="#section-2">Section 2</a> of this document
   o  Recommended: Yes







<span class="grey">Jones                        Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc8230.html">RFC 8230</a>         Using RSA Algorithms with COSE Messages  September 2017</span>


   o  Name: PS512
   o  Value: -39
   o  Description: RSASSA-PSS w/ SHA-512
   o  Reference: <a href="#section-2">Section 2</a> of this document
   o  Recommended: Yes

   o  Name: RSAES-OAEP w/ <a href="rfc8017.html">RFC 8017</a> default parameters
   o  Value: -40
   o  Description: RSAES-OAEP w/ SHA-1
   o  Reference: <a href="#section-3">Section 3</a> of this document
   o  Recommended: Yes

   o  Name: RSAES-OAEP w/ SHA-256
   o  Value: -41
   o  Description: RSAES-OAEP w/ SHA-256
   o  Reference: <a href="#section-3">Section 3</a> of this document
   o  Recommended: Yes

   o  Name: RSAES-OAEP w/ SHA-512
   o  Value: -42
   o  Description: RSAES-OAEP w/ SHA-512
   o  Reference: <a href="#section-3">Section 3</a> of this document
   o  Recommended: Yes

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20COSE%20Key%20Type%20Registrations"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  COSE Key Type Registrations</span>

   IANA has registered the following value in the IANA "COSE Key Types"
   registry [<a href="#ref-IANA.COSE" title='"CBOR Object Signing and Encryption (COSE)"'>IANA.COSE</a>].

   o  Name: RSA
   o  Value: 3
   o  Description: RSA Key
   o  Reference: <a href="#section-4">Section 4</a> of this document

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20COSE%20Key%20Type%20Parameters%20Registrations"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  COSE Key Type Parameters Registrations</span>

   IANA has registered the following values in the IANA "COSE Key Type
   Parameters" registry [<a href="#ref-IANA.COSE" title='"CBOR Object Signing and Encryption (COSE)"'>IANA.COSE</a>].

   o  Key Type: 3
   o  Name: n
   o  Label: -1
   o  CBOR Type: bstr
   o  Description: the RSA modulus n
   o  Reference: <a href="#section-4">Section 4</a> of this document






<span class="grey">Jones                        Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc8230.html">RFC 8230</a>         Using RSA Algorithms with COSE Messages  September 2017</span>


   o  Key Type: 3
   o  Name: e
   o  Label: -2
   o  CBOR Type: bstr
   o  Description: the RSA public exponent e
   o  Reference: <a href="#section-4">Section 4</a> of this document

   o  Key Type: 3
   o  Name: d
   o  Label: -3
   o  CBOR Type: bstr
   o  Description: the RSA private exponent d
   o  Reference: <a href="#section-4">Section 4</a> of this document

   o  Key Type: 3
   o  Name: p
   o  Label: -4
   o  CBOR Type: bstr
   o  Description: the prime factor p of n
   o  Reference: <a href="#section-4">Section 4</a> of this document

   o  Key Type: 3
   o  Name: q
   o  Label: -5
   o  CBOR Type: bstr
   o  Description: the prime factor q of n
   o  Reference: <a href="#section-4">Section 4</a> of this document

   o  Key Type: 3
   o  Name: dP
   o  Label: -6
   o  CBOR Type: bstr
   o  Description: dP is d mod (p - 1)
   o  Reference: <a href="#section-4">Section 4</a> of this document

   o  Key Type: 3
   o  Name: dQ
   o  Label: -7
   o  CBOR Type: bstr
   o  Description: dQ is d mod (q - 1)
   o  Reference: <a href="#section-4">Section 4</a> of this document

   o  Key Type: 3
   o  Name: qInv
   o  Label: -8
   o  CBOR Type: bstr
   o  Description: qInv is the CRT coefficient q^(-1) mod p
   o  Reference: <a href="#section-4">Section 4</a> of this document



<span class="grey">Jones                        Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc8230.html">RFC 8230</a>         Using RSA Algorithms with COSE Messages  September 2017</span>


   o  Key Type: 3
   o  Name: other
   o  Label: -9
   o  CBOR Type: array
   o  Description: other prime infos, an array
   o  Reference: <a href="#section-4">Section 4</a> of this document

   o  Key Type: 3
   o  Name: r_i
   o  Label: -10
   o  CBOR Type: bstr
   o  Description: a prime factor r_i of n, where i &gt;= 3
   o  Reference: <a href="#section-4">Section 4</a> of this document

   o  Key Type: 3
   o  Name: d_i
   o  Label: -11
   o  CBOR Type: bstr
   o  Description: d_i = d mod (r_i - 1)
   o  Reference: <a href="#section-4">Section 4</a> of this document

   o  Key Type: 3
   o  Name: t_i
   o  Label: -12
   o  CBOR Type: bstr
   o  Description: the CRT coefficient t_i = (r_1 * r_2 * ... *
      r_(i-1))^(-1) mod r_i
   o  Reference: <a href="#section-4">Section 4</a> of this document

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Security Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Key%20Size%20Security%20Considerations"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Key Size Security Considerations</span>

   A key size of 2048 bits or larger MUST be used with these algorithms.
   This key size corresponds roughly to the same strength as provided by
   a 128-bit symmetric encryption algorithm.  Implementations SHOULD be
   able to encrypt and decrypt with modulus between 2048 and 16K bits in
   length.  Applications can impose additional restrictions on the
   length of the modulus.

   In addition to needing to worry about keys that are too small to
   provide the required security, there are issues with keys that are
   too large.  Denial-of-service attacks have been mounted with overly
   large keys or oddly sized keys.  This has the potential to consume
   resources with these keys.  It is highly recommended that checks on
   the key length be done before starting a cryptographic operation.





<span class="grey">Jones                        Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc8230.html">RFC 8230</a>         Using RSA Algorithms with COSE Messages  September 2017</span>


   There are two reasonable ways to address this attack.  First, a key
   should not be used for a cryptographic operation until it has been
   verified that it is controlled by a party trusted by the recipient.
   This approach means that no cryptography will be done until a trust
   decision about the key has been made, a process described in
   <a href="#appendix-D">Appendix D</a>, Item 4 of [<a href="rfc7515.html" title='"JSON Web Signature (JWS)"'>RFC7515</a>].  Second, applications can impose
   maximum- as well as minimum-length requirements on keys.  This limits
   the resources that would otherwise be consumed by the use of overly
   large keys.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20RSASSA-PSS%20Security%20Considerations"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  RSASSA-PSS Security Considerations</span>

   There is a theoretical hash substitution attack that can be mounted
   against RSASSA-PSS [<a href="#ref-HASHID" title='"On Hash Function Firewalls in Signature Schemes"'>HASHID</a>].  However, the requirement that the same
   hash function be used consistently for all operations is an effective
   mitigation against it.  Unlike an Elliptic Curve Digital Signature
   Algorithm (ECDSA), hash function outputs are not truncated so that
   the full hash value is always signed.  The internal padding structure
   of RSASSA-PSS means that one needs to have multiple collisions
   between the two hash functions to be successful in producing a
   forgery based on changing the hash function.  This is highly
   unlikely.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20RSAES-OAEP%20Security%20Considerations"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  RSAES-OAEP Security Considerations</span>

   A version of RSAES-OAEP using the default parameters specified in
   <a href="rfc8017.html#appendix-A.2.1">Appendix A.2.1 of [RFC8017]</a> is included because this is the most
   widely implemented set of OAEP parameter choices.  (Those default
   parameters are the SHA-1 hash function and the MGF1 with SHA-1 mask
   generation function.)

   Keys used with RSAES-OAEP MUST follow the constraints in <a href="rfc8017.html#section-7.1">Section 7.1
   of [RFC8017]</a>.  Also, keys with a low private key exponent value, as
   described in <a href="#section-3">Section 3</a> of "Twenty Years of Attacks on the RSA
   Cryptosystem" [<a href="#ref-Boneh99" title='"Twenty Years of Attacks on the RSA Cryptosystem"'>Boneh99</a>], MUST NOT be used.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20References"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Normative%20References"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-Boneh99" name="ref-Boneh99">Boneh99</a>]   Boneh, D., "Twenty Years of Attacks on the RSA
               Cryptosystem", Notices of the American Mathematical
               Society (AMS), Vol. 46, No. 2, pp. 203-213, 1999,
               &lt;<a href="http://www.ams.org/notices/199902/boneh.pdf">http://www.ams.org/notices/199902/boneh.pdf</a>&gt;.







<span class="grey">Jones                        Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc8230.html">RFC 8230</a>         Using RSA Algorithms with COSE Messages  September 2017</span>


   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]   Bradner, S., "Key words for use in RFCs to Indicate
               Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>,
               DOI 10.17487/RFC2119, March 1997,
               &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC7049" name="ref-RFC7049">RFC7049</a>]   Bormann, C. and P. Hoffman, "Concise Binary Object
               Representation (CBOR)", <a href="rfc7049.html">RFC 7049</a>, DOI 10.17487/RFC7049,
               October 2013, &lt;<a href="https://www.rfc-editor.org/info/rfc7049">https://www.rfc-editor.org/info/rfc7049</a>&gt;.

   [<a id="ref-RFC7515" name="ref-RFC7515">RFC7515</a>]   Jones, M., Bradley, J., and N. Sakimura, "JSON Web
               Signature (JWS)", <a href="rfc7515.html">RFC 7515</a>, DOI 10.17487/RFC7515, May
               2015, &lt;<a href="https://www.rfc-editor.org/info/rfc7515">https://www.rfc-editor.org/info/rfc7515</a>&gt;.

   [<a id="ref-RFC8017" name="ref-RFC8017">RFC8017</a>]   Moriarty, K., Ed., Kaliski, B., Jonsson, J., and A.
               Rusch, "PKCS #1: RSA Cryptography Specifications Version
               2.2", <a href="rfc8017.html">RFC 8017</a>, DOI 10.17487/RFC8017, November 2016,
               &lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;.

   [<a id="ref-RFC8152" name="ref-RFC8152">RFC8152</a>]   Schaad, J., "CBOR Object Signing and Encryption (COSE)",
               <a href="rfc8152.html">RFC 8152</a>, DOI 10.17487/RFC8152, July 2017,
               &lt;<a href="https://www.rfc-editor.org/info/rfc8152">https://www.rfc-editor.org/info/rfc8152</a>&gt;.

   [<a id="ref-RFC8174" name="ref-RFC8174">RFC8174</a>]   Leiba, B., "Ambiguity of Uppercase vs Lowercase in <a href="rfc2119.html">RFC</a>
               <a href="rfc2119.html">2119</a> Key Words", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc8174.html">RFC 8174</a>, DOI 10.17487/RFC8174,
               May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Informative%20References"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-HASHID" name="ref-HASHID">HASHID</a>]    Kaliski, B., "On Hash Function Firewalls in Signature
               Schemes", Lecture Notes in Computer Science (LNCS),
               Volume 2271, pp. 1-16, DOI 10.1007/3-540-45760-7_1,
               February 2002, &lt;<a href="https://rd.springer.com/chapter/10.1007/3-540-45760-7_1">https://rd.springer.com/chapter/</a>
               <a href="https://rd.springer.com/chapter/10.1007/3-540-45760-7_1">10.1007/3-540-45760-7_1</a>&gt;.

   [<a id="ref-IANA.COSE" name="ref-IANA.COSE">IANA.COSE</a>] IANA, "CBOR Object Signing and Encryption (COSE)",
               &lt;<a href="http://www.iana.org/assignments/cose">http://www.iana.org/assignments/cose</a>&gt;.

   [<a id="ref-MultiPrimeRSA" name="ref-MultiPrimeRSA">MultiPrimeRSA</a>]
               Hinek, M. and D. Cheriton, "On the Security of
               Multi-prime RSA", June 2006,
               &lt;<a href="http://cacr.uwaterloo.ca/techreports/2006/cacr2006-16.pdf">http://cacr.uwaterloo.ca/techreports/</a>
               <a href="http://cacr.uwaterloo.ca/techreports/2006/cacr2006-16.pdf">2006/cacr2006-16.pdf</a>&gt;.









<span class="grey">Jones                        Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc8230.html">RFC 8230</a>         Using RSA Algorithms with COSE Messages  September 2017</span>


Acknowledgements

   This specification incorporates text from "CBOR Encoded Message
   Syntax" (September 2015) authored by Jim Schaad and Brian Campbell.
   Thanks are due to Ben Campbell, Roni Even, Steve Kent, Kathleen
   Moriarty, Eric Rescorla, Adam Roach, Rich Salz, and Jim Schaad for
   their reviews of the specification.

Author's Address

   Michael B. Jones
   Microsoft

   Email: mbj@microsoft.com
   URI:   <a href="http://self-issued.info/">http://self-issued.info/</a>




































Jones                        Standards Track                   [Page 12]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc8230 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:15 GMT --></html>