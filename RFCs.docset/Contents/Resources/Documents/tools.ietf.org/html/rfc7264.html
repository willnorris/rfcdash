<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7264 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:23 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-zong-p2psip-rpr" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:7264" name="DC.Identifier"/>
<meta content="June, 2014" name="DC.Date.Issued"/>
<meta content="Even, Roni" name="DC.Creator"/>
<meta content="Jiang, XingFeng" name="DC.Creator"/>
<meta content="Zhang, Yunfei" name="DC.Creator"/>
<meta content="Zong, Ning" name="DC.Creator"/>
<meta content="This document defines an optional extension to the REsource LOcation
And Discovery (RELOAD) protocol to support the relay peer routing
mode. RELOAD recommends symmetric recursive routing for routing
messages. The new optional extension provides a shorter route for
responses, thereby reducing overhead on intermediate peers. This
document also describes potential cases where this extension can be
used." name="DC.Description.Abstract"/>
<meta content="An Extension to the REsource LOcation And Discovery (RELOAD) Protocol to Support Relay Peer Routing" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7264 - An Extension to the REsource LOcation And Discovery (RELOAD) Protocol to Support Relay Peer Routing</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7264.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7264" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-p2psip-rpr" title="draft-ietf-p2psip-rpr">draft-ietf-p2ps...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7264" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7264" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7264" title="Side-by-side diff">Diff2</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=7264&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>]   </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                           N. Zong
Request for Comments: 7264                                      X. Jiang
Category: Standards Track                                        R. Even
ISSN: 2070-1721                                      Huawei Technologies
                                                                Y. Zhang
                                                  CoolPad / China Mobile
                                                               June 2014


 <span class="h1">An Extension to the REsource LOcation And Discovery (RELOAD) Protocol</span>
                     <span class="h1">to Support Relay Peer Routing</span>

Abstract

   This document defines an optional extension to the REsource LOcation
   And Discovery (RELOAD) protocol to support the relay peer routing
   mode.  RELOAD recommends symmetric recursive routing for routing
   messages.  The new optional extension provides a shorter route for
   responses, thereby reducing overhead on intermediate peers.  This
   document also describes potential cases where this extension can be
   used.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7264">http://www.rfc-editor.org/info/rfc7264</a>.
















<span class="grey">Zong, et al.                 Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7264.html">RFC 7264</a>                       P2PSIP RPR                      June 2014</span>


Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





































<span class="grey">Zong, et al.                 Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7264.html">RFC 7264</a>                       P2PSIP RPR                      June 2014</span>


Table of Contents
   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Terminology .....................................................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. Overview ........................................................<a href="#page-5">5</a>
      <a href="#section-3.1">3.1</a>. RPR ........................................................<a href="#page-5">5</a>
      <a href="#section-3.2">3.2</a>. Scenarios Where RPR Can Be Used ............................<a href="#page-6">6</a>
           <a href="#section-3.2.1">3.2.1</a>. Managed or Closed P2P Systems .......................<a href="#page-6">6</a>
           <a href="#section-3.2.2">3.2.2</a>. Using Bootstrap Nodes as Relay Peers ................<a href="#page-7">7</a>
           <a href="#section-3.2.3">3.2.3</a>. Wireless Scenarios ..................................<a href="#page-7">7</a>
   <a href="#section-4">4</a>. Relationship between SRR and RPR ................................<a href="#page-7">7</a>
      <a href="#section-4.1">4.1</a>. How RPR Works ..............................................<a href="#page-7">7</a>
      <a href="#section-4.2">4.2</a>. How SRR and RPR Work Together ..............................<a href="#page-7">7</a>
   <a href="#section-5">5</a>. RPR Extensions to RELOAD ........................................<a href="#page-8">8</a>
      <a href="#section-5.1">5.1</a>. Basic Requirements .........................................<a href="#page-8">8</a>
      <a href="#section-5.2">5.2</a>. Modification to RELOAD Message Structure ...................<a href="#page-8">8</a>
           <a href="#section-5.2.1">5.2.1</a>. Extensive Routing Mode ..............................<a href="#page-8">8</a>
      <a href="#section-5.3">5.3</a>. Creating a Request .........................................<a href="#page-9">9</a>
           <a href="#section-5.3.1">5.3.1</a>. Creating a Request for RPR ..........................<a href="#page-9">9</a>
      <a href="#section-5.4">5.4</a>. Request and Response Processing ............................<a href="#page-9">9</a>
           5.4.1. Destination Peer: Receiving a Request and
                  Sending a Response ..................................<a href="#page-9">9</a>
           <a href="#section-5.4.2">5.4.2</a>. Sending Peer: Receiving a Response .................<a href="#page-10">10</a>
           <a href="#section-5.4.3">5.4.3</a>. Relay Peer Processing ..............................<a href="#page-10">10</a>
   <a href="#section-6">6</a>. Overlay Configuration Extension ................................<a href="#page-10">10</a>
   <a href="#section-7">7</a>. Discovery of Relay Peers .......................................<a href="#page-11">11</a>
   <a href="#section-8">8</a>. Security Considerations ........................................<a href="#page-11">11</a>
   <a href="#section-9">9</a>. IANA Considerations ............................................<a href="#page-11">11</a>
      <a href="#section-9.1">9.1</a>. A New RELOAD Forwarding Option ............................<a href="#page-11">11</a>
   <a href="#section-10">10</a>. Acknowledgments ...............................................<a href="#page-11">11</a>
   <a href="#section-11">11</a>. References ....................................................<a href="#page-12">12</a>
      <a href="#section-11.1">11.1</a>. Normative References .....................................<a href="#page-12">12</a>
      <a href="#section-11.2">11.2</a>. Informative References ...................................<a href="#page-12">12</a>
   <a href="#appendix-A">Appendix A</a>. Optional Methods to Investigate Peer Connectivity .....<a href="#page-13">13</a>
   <a href="#appendix-B">Appendix B</a>. Comparison of Cost of SRR and RPR .....................<a href="#page-14">14</a>
     <a href="#appendix-B.1">B.1</a>. Closed or Managed Networks .................................<a href="#page-14">14</a>
     <a href="#appendix-B.2">B.2</a>. Open Networks ..............................................<a href="#page-15">15</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The REsource LOcation And Discovery (RELOAD) protocol [<a href="rfc6940.html" title='"REsource LOcation And Discovery (RELOAD) Base Protocol"'>RFC6940</a>]
   recommends symmetric recursive routing (SRR) for routing messages and
   describes the extensions that would be required to support additional
   routing algorithms.  In addition to SRR, two other routing options --
   direct response routing (DRR) and relay peer routing (RPR) -- are
   also discussed in <a href="rfc6940.html#appendix-A">Appendix A of [RFC6940]</a>.  As we show in <a href="#section-3">Section 3</a>,
   RPR is advantageous over SRR in some scenarios in that RPR can reduce
   load (CPU and link bandwidth) on intermediate peers.  RPR works
   better in a network where relay peers are provisioned in advance so



<span class="grey">Zong, et al.                 Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7264.html">RFC 7264</a>                       P2PSIP RPR                      June 2014</span>


   that relay peers are publicly reachable in the P2P system.  In other
   scenarios, using a combination of RPR and SRR together is more likely
   to provide benefits than if SRR is used alone.

   Note that in this document we focus on the RPR mode and its
   extensions to RELOAD to produce a standalone solution.  Please refer
   to [<a href="rfc7263.html" title='"An Extension to the REsource LOcation And Discovery (RELOAD) Protocol to Support Direct Response Routing"'>RFC7263</a>] for details on the DRR mode.

   We first discuss the problem statement in <a href="#section-3">Section 3</a>.  How to combine
   RPR and SRR is presented in <a href="#section-4">Section 4</a>.  An extension to RELOAD to
   support RPR is defined in <a href="#section-5">Section 5</a>.  Discovery of relay peers is
   introduced in <a href="#section-7">Section 7</a>.  Some optional methods to check peer
   connectivity are introduced in <a href="#appendix-A">Appendix A</a>.  In <a href="#appendix-B">Appendix B</a>, we give a
   comparison of the cost of SRR and RPR in both managed and open
   networks.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

   We use terminology and definitions from the base RELOAD specification
   [<a href="rfc6940.html" title='"REsource LOcation And Discovery (RELOAD) Base Protocol"'>RFC6940</a>] extensively in this document.  We also use terms defined in
   the NAT behavior discovery document [<a href="rfc5780.html" title='"NAT Behavior Discovery Using Session Traversal Utilities for NAT (STUN)"'>RFC5780</a>].  Other terms used in
   this document are defined inline when used and are also defined below
   for reference.

      Publicly Reachable: A peer is publicly reachable if it can receive
      unsolicited messages from any other peer in the same overlay.
      Note: "Publicly" does not mean that the peers must be on the
      public Internet, because the RELOAD protocol may be used in a
      closed network.

      Relay Peer: A relay peer is a type of publicly reachable peer that
      can receive unsolicited messages from all other peers in the
      overlay and forward the responses from destination peers towards
      the sender of the request.

      Relay Peer Routing (RPR): "RPR" refers to a routing mode in which
      responses to Peer-to-Peer SIP (P2PSIP) requests are sent by the
      destination peer to a relay peer transport address that will
      forward the responses towards the sending peer.  For simplicity,
      the abbreviation "RPR" is used in the rest of this document.







<span class="grey">Zong, et al.                 Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7264.html">RFC 7264</a>                       P2PSIP RPR                      June 2014</span>


      Symmetric Recursive Routing (SRR): "SRR" refers to a routing mode
      in which responses follow the reverse path of the request to get
      to the sending peer.  For simplicity, the abbreviation "SRR" is
      used in the rest of this document.

      Direct Response Routing (DRR): "DRR" refers to a routing mode in
      which responses to P2PSIP requests are returned to the sending
      peer directly from the destination peer based on the sending
      peer's own local transport address(es).  For simplicity, the
      abbreviation "DRR" is used in the rest of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Overview"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Overview</span>

   RELOAD is expected to work under a great number of application
   scenarios.  The situations where RELOAD is to be deployed differ
   greatly.  For instance, some deployments are global, such as a
   Skype-like system intended to provide public service, while others
   run in small-scale closed networks.  SRR works in any situation, but
   RPR may work better in some specific scenarios.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20RPR"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  RPR</span>

   RELOAD is a simple request-response protocol.  After sending a
   request, a peer waits for a response from a destination peer.  There
   are several ways for the destination peer to send a response back to
   the source peer.  In this section, we will provide detailed
   information on RPR.  Note that the same types of illustrative
   settings can be found in <a href="rfc7263.html#appendix-B.1">Appendix B.1 of [RFC7263]</a>.

   If peer A knows it is behind a NAT or NATs and knows one or more
   relay peers with whom they have had prior connections, peer A can try
   RPR.  Assume that peer A is associated with relay peer R.  When
   sending the request, peer A includes information describing peer R's
   transport address in the request.  When peer X receives the request,
   peer X sends the response to peer R, which forwards it directly to
   peer A on the existing connection.  Figure 1 illustrates RPR.  Note
   that RPR also allows a shorter route for responses compared to SRR;
   this means less overhead on intermediate peers.  Establishing a
   connection to the relay with Transport Layer Security (TLS) requires
   multiple round trips.  Please refer to <a href="#appendix-B">Appendix B</a> for a cost
   comparison between SRR and RPR.










<span class="grey">Zong, et al.                 Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7264.html">RFC 7264</a>                       P2PSIP RPR                      June 2014</span>


     A            B            C             D           X           R
     |  Request   |            |            |            |           |
     |-----------&gt;|            |            |            |           |
     |            | Request    |            |            |           |
     |            |-----------&gt;|            |            |           |
     |            |            | Request    |            |           |
     |            |            |-----------&gt;|            |           |
     |            |            |            | Request    |           |
     |            |            |            |-----------&gt;|           |
     |            |            |            |            | Response  |
     |            |            |            |            |----------&gt;|
     |            |            |            |  Response  |           |
     |&lt;-----------+------------+------------+------------+-----------|
     |            |            |            |            |           |

                            Figure 1: RPR Mode

   This technique relies on the relative population of peers such as
   peer A that require relay peers, and peers such as peer R that are
   capable of serving as relay peers.  It also requires a mechanism to
   enable peers to know which peers can be used as their relays.  This
   mechanism may be based on configuration -- for example, as part of
   the overlay configuration, an initial list of relay peers can be
   supplied.  Another option is a response message in which the
   responding peer can announce that it can serve as a relay peer.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Scenarios%20Where%20RPR%20Can%20Be%20Used"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Scenarios Where RPR Can Be Used</span>

   In this section, we will list several scenarios where using RPR would
   improve performance.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.1.%20%20Managed%20or%20Closed%20P2P%20Systems"></a><a class="selflink" href="#section-3.2.1" name="section-3.2.1">3.2.1</a>.  Managed or Closed P2P Systems</span>

   As described in <a href="rfc7263.html#section-3.2.1">Section 3.2.1 of [RFC7263]</a>, many P2P systems run in a
   closed or managed environment so that network administrators can
   better manage their system.  For example, the network administrator
   can deploy several relay peers that are publicly reachable in the
   system and indicate their presence in the configuration file.  After
   learning where these relay peers are, peers behind NATs can use RPR
   with help from these relay peers.  Peers MUST also support SRR in
   case RPR fails.

   Another usage is to install relay peers on the managed network
   boundary, allowing external peers to send responses to peers inside
   the managed network.






<span class="grey">Zong, et al.                 Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7264.html">RFC 7264</a>                       P2PSIP RPR                      June 2014</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.2.%20%20Using%20Bootstrap%20Nodes%20as%20Relay%20Peers"></a><a class="selflink" href="#section-3.2.2" name="section-3.2.2">3.2.2</a>.  Using Bootstrap Nodes as Relay Peers</span>

   Bootstrap nodes are typically publicly reachable in a RELOAD
   architecture.  As a result, one possible scenario would be to use the
   bootstrap nodes as relay peers for use with RPR.  A relay peer SHOULD
   be publicly accessible and maintain a direct connection with its
   client.  As such, bootstrap nodes are well suited to play the role of
   relay peers.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.3.%20%20Wireless%20Scenarios"></a><a class="selflink" href="#section-3.2.3" name="section-3.2.3">3.2.3</a>.  Wireless Scenarios</span>

   In some mobile deployments, using RPR may help reduce radio battery
   usage and bandwidth by the intermediate peers.  The service provider
   may recommend using RPR based on his knowledge of the topology.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Relationship%20between%20SRR%20and%20RPR"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Relationship between SRR and RPR</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20How%20RPR%20Works"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  How RPR Works</span>

   Peers using RPR MUST maintain a connection with their relay peer(s).
   This can be done in the same way as establishing a neighbor
   connection between peers using the Attach method [<a href="rfc6940.html" title='"REsource LOcation And Discovery (RELOAD) Base Protocol"'>RFC6940</a>].

   A requirement for RPR is that the source peer convey its relay peer's
   (or peers') transport address(es) in the request so the destination
   peer knows where the relay peers are and will send the response to a
   relay peer first.  The request MUST also include the requesting
   peer's Node-ID or IP address, which enables the relay peer to route
   the response back to the right peer.

   Note that being a relay peer does not require that the relay peer
   have more functionality than an ordinary peer.  Relay peers comply
   with the same procedure as an ordinary peer to forward messages.  The
   only difference is that there may be a larger traffic burden on relay
   peers.  Relay peers can decide whether to accept a new connection
   based on their current burden.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20How%20SRR%20and%20RPR%20Work%20Together"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  How SRR and RPR Work Together</span>

   RPR is not intended to replace SRR.  It is better to use these two
   modes together to adapt to each peer's specific situation.  Note that
   the informative suggestions for how to transition between SRR and RPR
   are the same as those for DRR.  Please refer to <a href="rfc7263.html#section-4.2">Section 4.2 of
   [RFC7263]</a> for more details.  If a relay peer is provided by the
   service provider, peers SHOULD prefer RPR over SRR.  However, RPR
   SHOULD NOT be used in the open Internet or if the administrator does





<span class="grey">Zong, et al.                 Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7264.html">RFC 7264</a>                       P2PSIP RPR                      June 2014</span>


   not feel he has enough information about the overlay network
   topology.  A new overlay configuration element specifying the usage
   of RPR is defined in <a href="#section-6">Section 6</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20RPR%20Extensions%20to%20RELOAD"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  RPR Extensions to RELOAD</span>

   Adding support for RPR requires extensions to the current RELOAD
   protocol.  In this section, we define the required extensions,
   including extensions to message structure and message processing.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Basic%20Requirements"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Basic Requirements</span>

   All peers MUST be able to process requests for routing in SRR and MAY
   support RPR routing requests.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Modification%20to%20RELOAD%20Message%20Structure"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Modification to RELOAD Message Structure</span>

   RELOAD provides an extensible framework to accommodate future
   extensions.  In this section, we define an RPR routing option for the
   extensive routing mode specified in [<a href="rfc7263.html" title='"An Extension to the REsource LOcation And Discovery (RELOAD) Protocol to Support Direct Response Routing"'>RFC7263</a>].  The state-keeping
   flag [<a href="rfc7263.html" title='"An Extension to the REsource LOcation And Discovery (RELOAD) Protocol to Support Direct Response Routing"'>RFC7263</a>] is needed to support the RPR mode.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.1.%20%20Extensive%20Routing%20Mode"></a><a class="selflink" href="#section-5.2.1" name="section-5.2.1">5.2.1</a>.  Extensive Routing Mode</span>

   The new RouteMode value for RPR is defined below for the
   ExtensiveRoutingModeOption structure:

   enum {(0),DRR(1),RPR(2),(255)} RouteMode;
   struct {
           RouteMode               routemode;
           OverlayLinkType         transport;
           IpAddressPort           ipaddressport;
           Destination             destinations&lt;1..2^8-1&gt;;
   } ExtensiveRoutingModeOption;

   Note that the DRR value in RouteMode is defined in [<a href="rfc7263.html" title='"An Extension to the REsource LOcation And Discovery (RELOAD) Protocol to Support Direct Response Routing"'>RFC7263</a>].

   RouteMode: refers to which type of routing mode is indicated to the
   destination peer.

   OverlayLinkType: refers to the transport type that is used to deliver
   responses from the destination peer to the relay peer.

   IpAddressPort: refers to the transport address that the destination
   peer should use for sending responses.  This will be a relay peer
   address for RPR.





<span class="grey">Zong, et al.                 Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7264.html">RFC 7264</a>                       P2PSIP RPR                      June 2014</span>


   Destination: refers to the relay peer itself.  If the routing mode is
   RPR, then the destination contains two items: the relay peer's
   Node-ID and the sending peer's Node-ID.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Creating%20a%20Request"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Creating a Request</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.1.%20%20Creating%20a%20Request%20for%20RPR"></a><a class="selflink" href="#section-5.3.1" name="section-5.3.1">5.3.1</a>.  Creating a Request for RPR</span>

   When using RPR for a transaction, the sending peer MUST set the
   IGNORE-STATE-KEEPING flag in the ForwardingHeader.  Additionally, the
   peer MUST construct and include a ForwardingOption structure in the
   ForwardingHeader.  When constructing the ForwardingOption structure,
   the fields MUST be set as follows:

   1)  The type MUST be set to extensive_routing_mode.

   2)  The ExtensiveRoutingModeOption structure MUST be used for the
       option field within the ForwardingOption structure.  The fields
       MUST be defined as follows:

       2.1)  routemode set to 0x02 (RPR).

       2.2)  transport set as appropriate for the relay peer.

       2.3)  ipaddressport set to the transport address of the relay
             peer through which the sender wishes the message relayed.

       2.4)  The destination structure MUST contain two values.  The
             first MUST be defined as type "node" and set with the
             values for the relay peer.  The second MUST be defined as
             type "node" and set with the sending peer's own values.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20Request%20and%20Response%20Processing"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  Request and Response Processing</span>

   This section gives normative text for message processing after RPR is
   introduced.  Here, we only describe the additional procedures for
   supporting RPR.  Please refer to [<a href="rfc6940.html" title='"REsource LOcation And Discovery (RELOAD) Base Protocol"'>RFC6940</a>] for RELOAD base
   procedures.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.4.1.%20%20Destination%20Peer%3A%20Receiving%20a%20Request%20and%20Sending%20a%20Response"></a><a class="selflink" href="#section-5.4.1" name="section-5.4.1">5.4.1</a>.  Destination Peer: Receiving a Request and Sending a Response</span>

   When the destination peer receives a request, it will check the
   options in the forwarding header.  If the destination peer cannot
   understand the extensive_routing_mode option in the request, it MUST
   attempt to use SRR to return an "Error_Unknown_Extension" response
   (defined in Sections <a href="#section-6.3.3.1">6.3.3.1</a> and <a href="#section-14.9">14.9</a> of [<a href="rfc6940.html" title='"REsource LOcation And Discovery (RELOAD) Base Protocol"'>RFC6940</a>]) to the sending
   peer.




<span class="grey">Zong, et al.                 Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7264.html">RFC 7264</a>                       P2PSIP RPR                      June 2014</span>


   If the routing mode is RPR, the destination peer MUST construct a
   destination_list for the response with two entries as defined in
   [<a href="rfc6940.html" title='"REsource LOcation And Discovery (RELOAD) Base Protocol"'>RFC6940</a>].  The first entry MUST be set to the relay peer's Node-ID
   from the option in the request, and the second entry MUST be the
   sending peer's Node-ID from the option in the request.

   In the event that the routing mode is set to RPR and there are not
   exactly two destinations, the destination peer MUST try to send an
   "Error_Unknown_Extension" response (defined in Sections <a href="#section-6.3.3.1">6.3.3.1</a> and
   14.9 of [<a href="rfc6940.html" title='"REsource LOcation And Discovery (RELOAD) Base Protocol"'>RFC6940</a>]) to the sending peer using SRR.

   After the peer constructs the destination_list for the response, it
   sends the response to the transport address, which is indicated in
   the ipaddressport field in the option using the specific transport
   mode in the ForwardingOption.  If the destination peer receives a
   retransmit with SRR preference on the message it is trying to respond
   to now, the responding peer SHOULD abort the RPR response and
   use SRR.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.4.2.%20%20Sending%20Peer%3A%20Receiving%20a%20Response"></a><a class="selflink" href="#section-5.4.2" name="section-5.4.2">5.4.2</a>.  Sending Peer: Receiving a Response</span>

   Upon receiving a response, the peer follows the rules in [<a href="rfc6940.html" title='"REsource LOcation And Discovery (RELOAD) Base Protocol"'>RFC6940</a>].
   If the sender used RPR and did not get a response until the timeout,
   it MAY resend the message using either RPR (but with a different
   relay peer, if available) or SRR.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.4.3.%20%20Relay%20Peer%20Processing"></a><a class="selflink" href="#section-5.4.3" name="section-5.4.3">5.4.3</a>.  Relay Peer Processing</span>

   Relay peers are designed to forward responses to peers who are not
   publicly reachable.  For the routing of the response, this document
   still uses the destination_list.  The only difference from SRR is
   that the destination_list is not the reverse of the via_list.
   Instead, it is constructed from the forwarding option as described
   below.

   When a relay peer receives a response, it MUST follow the rules in
   [<a href="rfc6940.html" title='"REsource LOcation And Discovery (RELOAD) Base Protocol"'>RFC6940</a>].  It receives the response, validates the message,
   readjusts the destination_list, and forwards the response to the next
   hop in the destination_list based on the connection table.  There is
   no added requirement for the relay peer.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Overlay%20Configuration%20Extension"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Overlay Configuration Extension</span>

   This document uses the new RELOAD overlay configuration element,
   "route-mode", inside each "configuration" element, as defined in
   <a href="rfc7263.html#section-6">Section 6 of [RFC7263]</a>.  The route mode MUST be "RPR".





<span class="grey">Zong, et al.                 Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7264.html">RFC 7264</a>                       P2PSIP RPR                      June 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Discovery%20of%20Relay%20Peers"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Discovery of Relay Peers</span>

   There are several ways to distribute information about relay peers
   throughout the overlay.  P2P network providers can deploy some relay
   peers and advertise them in the configuration file.  With the
   configuration file at hand, peers can get relay peers to try RPR.
   Another way is to consider the relay peer as a service; some service
   advertisement and discovery mechanism can then also be used for
   discovering relay peers -- for example, using the same mechanism as
   that used in Traversal Using Relays around NAT (TURN) server
   discovery as discussed in [<a href="rfc6940.html" title='"REsource LOcation And Discovery (RELOAD) Base Protocol"'>RFC6940</a>].  Another option is to let a peer
   advertise its capability to be a relay in the response to an Attach
   or Join [<a href="rfc6940.html" title='"REsource LOcation And Discovery (RELOAD) Base Protocol"'>RFC6940</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Security%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Security Considerations</span>

   The normative security recommendations of <a href="rfc6940.html#section-13">Section 13 of [RFC6940]</a> are
   applicable to this document.  As a routing alternative, the security
   part of RPR conforms to <a href="rfc6940.html#section-13.6">Section 13.6 of [RFC6940]</a>, which describes
   routing security.  RPR behaves like a DRR requesting node towards the
   destination node.  The RPR relay peer is not necessarily an arbitrary
   node -- for example, a managed network, a bootstrap node, or a
   configured relay peer; it should be a trusted node, because a trusted
   node will be less of a risk, as outlined in <a href="rfc6940.html#section-13">Section 13 of [RFC6940]</a>.

   In order to address possible DoS attacks, the relay peer SHOULD also
   limit the number of maximum connections; this is required in order to
   also reduce load on the relay peer, as explained in <a href="#section-4.1">Section 4.1</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  IANA Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20A%20New%20RELOAD%20Forwarding%20Option"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  A New RELOAD Forwarding Option</span>

   A new RELOAD Forwarding Option type has been added to the "RELOAD
   Forwarding Option Registry" defined in [<a href="rfc6940.html" title='"REsource LOcation And Discovery (RELOAD) Base Protocol"'>RFC6940</a>].

   Code: 2
   Forwarding Option: extensive_routing_mode

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Acknowledgments"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Acknowledgments</span>

   David Bryan helped extensively with this document and helped provide
   some of the text, analysis, and ideas contained here.  The authors
   would like to thank Ted Hardie, Narayanan Vidya, Dondeti Lakshminath,
   Bruce Lowekamp, Stephane Bryant, Marc Petit-Huguenin, and Carlos
   Jesus Bernardos Cano for their constructive comments.





<span class="grey">Zong, et al.                 Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7264.html">RFC 7264</a>                       P2PSIP RPR                      June 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20References"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.1.%20%20Normative%20References"></a><a class="selflink" href="#section-11.1" name="section-11.1">11.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC6940" name="ref-RFC6940">RFC6940</a>]  Jennings, C., Lowekamp, B., Rescorla, E., Baset, S., and
              H. Schulzrinne, "REsource LOcation And Discovery (RELOAD)
              Base Protocol", <a href="rfc6940.html">RFC 6940</a>, January 2014.

   [<a id="ref-RFC7263" name="ref-RFC7263">RFC7263</a>]  Zong, N., Jiang, X., Even, R., and Y. Zhang, "An Extension
              to the REsource LOcation And Discovery (RELOAD) Protocol
              to Support Direct Response Routing", <a href="rfc7263.html">RFC 7263</a>, June 2014.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.2.%20%20Informative%20References"></a><a class="selflink" href="#section-11.2" name="section-11.2">11.2</a>.  Informative References</span>

   [<a id="ref-RFC3424" name="ref-RFC3424">RFC3424</a>]  Daigle, L. and IAB, "IAB Considerations for UNilateral
              Self-Address Fixing (UNSAF) Across Network Address
              Translation", <a href="rfc3424.html">RFC 3424</a>, November 2002.

   [<a id="ref-RFC5780" name="ref-RFC5780">RFC5780</a>]  MacDonald, D. and B. Lowekamp, "NAT Behavior Discovery
              Using Session Traversal Utilities for NAT (STUN)",
              <a href="rfc5780.html">RFC 5780</a>, May 2010.



























<span class="grey">Zong, et al.                 Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc7264.html">RFC 7264</a>                       P2PSIP RPR                      June 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Optional%20Methods%20to%20Investigate%20Peer%20Connectivity"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Optional Methods to Investigate Peer Connectivity</span>

   This section is for informational purposes only and provides some
   mechanisms that can be used when the configuration information does
   not specify if RPR can be used.  It summarizes some methods that can
   be used by a peer to determine its own network location compared with
   NAT.  These methods may help a peer to decide which routing mode it
   may wish to try.  Note that there is no foolproof way to determine
   whether a peer is publicly reachable, other than via out-of-band
   mechanisms.  This document addresses UNilateral Self-Address Fixing
   (UNSAF) [<a href="rfc3424.html" title='"IAB Considerations for UNilateral Self-Address Fixing (UNSAF) Across Network Address Translation"'>RFC3424</a>] considerations by specifying a fallback plan to SRR
   [<a href="rfc6940.html" title='"REsource LOcation And Discovery (RELOAD) Base Protocol"'>RFC6940</a>].  SRR is not an UNSAF mechanism.  This document does not
   define any new UNSAF mechanisms.

   For RPR to function correctly, a peer may attempt to determine
   whether it is publicly reachable.  If it is not, RPR may be chosen to
   route the response with help from relay peers, or the peers should
   fall back to SRR.  NATs and firewalls are two major contributors to
   preventing RPR from functioning properly.  There are a number of
   techniques by which a peer can get its reflexive address on the
   public side of the NAT.  After obtaining the reflexive address, a
   peer can perform further tests to learn whether the reflexive address
   is publicly reachable.  If the address appears to be publicly
   reachable, the peer to which the address belongs can be a candidate
   to serve as a relay peer.  Peers that are not publicly reachable may
   still use RPR to shorten the response path, with help from relay
   peers.

   Some conditions that are unique in P2PSIP architecture could be
   leveraged to facilitate the tests.  In a P2P overlay network, each
   peer has only a partial view of the whole network and knows of a few
   peers in the overlay.  P2P routing algorithms can easily deliver a
   request from a sending peer to a peer with whom the sending peer has
   no direct connection.  This makes it easy for a peer to ask other
   peers to send unsolicited messages back to the requester.

   The approaches for a peer to get the addresses needed for further
   tests, as well as the test for learning whether a peer may be
   publicly reachable, are the same as those for DRR.  Please refer to
   <a href="rfc7263.html#appendix-A">Appendix A of [RFC7263]</a> for more details.











<span class="grey">Zong, et al.                 Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc7264.html">RFC 7264</a>                       P2PSIP RPR                      June 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20B.%20%20Comparison%20of%20Cost%20of%20SRR%20and%20RPR"></a><a class="selflink" href="#appendix-B" name="appendix-B">Appendix B</a>.  Comparison of Cost of SRR and RPR</span>

   The major advantage of using RPR is that it reduces the number of
   intermediate peers traversed by the response.  This reduces the load,
   such as processing and communication bandwidth, on those peers'
   resources.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.1.%20%20Closed%20or%20Managed%20Networks"></a><a class="selflink" href="#appendix-B.1" name="appendix-B.1">B.1</a>.  Closed or Managed Networks</span>

   As described in <a href="#section-3">Section 3</a>, many P2P systems run in a closed or
   managed environment (e.g., carrier networks), so network
   administrators would know that they could safely use RPR.

   The number of hops for a response in SRR and in RPR are listed in the
   following table.  Note that the same types of illustrative settings
   can be found in <a href="rfc7263.html#appendix-B.1">Appendix B.1 of [RFC7263]</a>.

           Mode       | Success | No. of Hops | No. of Msgs
           ------------------------------------------------
           SRR        |  Yes    |     log(N)  |    log(N)
           RPR        |  Yes    |     2       |    2
           RPR (DTLS) |  Yes    |     2       |    7+2

        Table 1: Comparison of SRR and RPR in Closed Networks

   From the above comparison, it is clear that:

   1)  In most cases when the number of peers (N) &gt; 4 (2^2), RPR uses
       fewer hops than SRR.  Using a shorter route means less overhead
       and resource usage on intermediate peers, which is an important
       consideration for adopting RPR in the cases where such resources
       as CPU and bandwidth are limited, e.g., the case of mobile,
       wireless networks.

   2)  In the cases when N &gt; 512 (2^9), RPR also uses fewer messages
       than SRR.

   3)  In the cases when N &lt; 512, RPR uses more messages than SRR (but
       still uses fewer hops than SRR), so the consideration of whether
       to use RPR or SRR depends on other factors such as using less
       resources (bandwidth and processing) from the intermediate peers.
       <a href="#section-4">Section 4</a> provides use cases where RPR has a better chance of
       working or where the considerations of intermediary resources are
       important.







<span class="grey">Zong, et al.                 Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc7264.html">RFC 7264</a>                       P2PSIP RPR                      June 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.2.%20%20Open%20Networks"></a><a class="selflink" href="#appendix-B.2" name="appendix-B.2">B.2</a>.  Open Networks</span>

   In open networks (e.g., the Internet) where RPR is not guaranteed to
   work, RPR can fall back to SRR if it fails after trial, as described
   in <a href="#section-4.2">Section 4.2</a>.  Based on the same settings as those listed in
   <a href="#appendix-B.1">Appendix B.1</a>, the number of hops, as well as the number of messages
   for a response in SRR and RPR, are listed in the following table:

    Mode       |          Success        | No. of Hops | No. of Msgs
    ----------------------------------------------------------------
    SRR        |         Yes             |   log(N)    |   log(N)
    RPR        |         Yes             |   2         |   2
               | Fail &amp; fall back to SRR |   2+log(N)  |   2+log(N)
    RPR (DTLS) |         Yes             |   2         |   7+2
               | Fail &amp; fall back to SRR |   2+log(N)  |   9+log(N)

          Table 2: Comparison of SRR and RPR in Open Networks

   From the above comparison, it can be observed that trying to first
   use RPR could still provide an overall number of hops lower than
   directly using SRR.  The detailed analysis is the same as that for
   DRR and can be found in [<a href="rfc7263.html" title='"An Extension to the REsource LOcation And Discovery (RELOAD) Protocol to Support Direct Response Routing"'>RFC7263</a>].

Authors' Addresses

   Ning Zong
   Huawei Technologies

   EMail: zongning@huawei.com


   Xingfeng Jiang
   Huawei Technologies

   EMail: jiang.x.f@huawei.com


   Roni Even
   Huawei Technologies

   EMail: roni.even@mail01.huawei.com


   Yunfei Zhang
   CoolPad / China Mobile

   EMail: hishigh@gmail.com




Zong, et al.                 Standards Track                   [Page 15]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7264 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:23 GMT --></html>