<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7171 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:23 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-hanna-nea-pt-eap" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:7171" name="DC.Identifier"/>
<meta content="May, 2014" name="DC.Date.Issued"/>
<meta content="Cam-Winget, Nancy" name="DC.Creator"/>
<meta content="Sangster, Paul" name="DC.Creator"/>
<meta content="This document specifies PT-EAP, a Posture Transport (PT) protocol
based on the Extensible Authentication Protocol (EAP) and designed to
be used only inside an EAP tunnel method protected by Transport Layer
Security (TLS). The document also describes the intended applicability
of PT-EAP." name="DC.Description.Abstract"/>
<meta content="PT-EAP: Posture Transport (PT) Protocol for Extensible Authentication Protocol (EAP) Tunnel Methods" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7171 - PT-EAP: Posture Transport (PT) Protocol for Extensible Authentication Protocol (EAP) Tunnel Methods</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7171.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7171" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-nea-pt-eap" title="draft-ietf-nea-pt-eap">draft-ietf-nea-...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7171" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7171" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7171" title="Side-by-side diff">Diff2</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=7171&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>]   </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                     N. Cam-Winget
Request for Comments: 7171                                 Cisco Systems
Category: Standards Track                                    P. Sangster
ISSN: 2070-1721                                     Symantec Corporation
                                                                May 2014


                <span class="h1">PT-EAP: Posture Transport (PT) Protocol</span>
      <span class="h1">for Extensible Authentication Protocol (EAP) Tunnel Methods</span>

Abstract

   This document specifies PT-EAP, a Posture Transport (PT) protocol
   based on the Extensible Authentication Protocol (EAP) and designed to
   be used only inside an EAP tunnel method protected by Transport Layer
   Security (TLS).  The document also describes the intended
   applicability of PT-EAP.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7171">http://www.rfc-editor.org/info/rfc7171</a>.

Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





<span class="grey">Cam-Winget &amp; Sangster        Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7171.html">RFC 7171</a>                       NEA PT-EAP                       May 2014</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
     <a href="#section-1.1">1.1</a>.  Prerequisites . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-1.2">1.2</a>.  Message Diagram Conventions . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-1.3">1.3</a>.  Terminology . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-1.4">1.4</a>.  Conventions Used in This Document . . . . . . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-1.5">1.5</a>.  Compatibility with Other Specifications . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-2">2</a>.  Use of PT-EAP . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-3">3</a>.  Definition of PT-EAP  . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-3.1">3.1</a>.  Protocol Overview . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-3.2">3.2</a>.  Version Negotiation . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-3.3">3.3</a>.  PT-EAP Message Format . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-3.4">3.4</a>.  Preventing MITM Attacks with Channel Bindings . . . . . .   <a href="#page-8">8</a>
   <a href="#section-4">4</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
     <a href="#section-4.1">4.1</a>.  Trust Relationships . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
       <a href="#section-4.1.1">4.1.1</a>.  Posture Transport Client  . . . . . . . . . . . . . .   <a href="#page-9">9</a>
       <a href="#section-4.1.2">4.1.2</a>.  Posture Transport Server  . . . . . . . . . . . . . .  <a href="#page-10">10</a>
     <a href="#section-4.2">4.2</a>.  Threats and Countermeasures . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
       <a href="#section-4.2.1">4.2.1</a>.  Message Confidentiality . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
       <a href="#section-4.2.2">4.2.2</a>.  Message Fabrication . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
       <a href="#section-4.2.3">4.2.3</a>.  Message Modification  . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
       <a href="#section-4.2.4">4.2.4</a>.  Denial of Service . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
       <a href="#section-4.2.5">4.2.5</a>.  NEA Asokan Attacks  . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
     <a href="#section-4.3">4.3</a>.  Candidate EAP Tunnel Method Protections . . . . . . . . .  <a href="#page-13">13</a>
     <a href="#section-4.4">4.4</a>.  Security Claims for PT-EAP as per <a href="rfc3748.html">RFC 3748</a>  . . . . . . .  <a href="#page-14">14</a>
   <a href="#section-5">5</a>.  Requirements for EAP Tunnel Methods . . . . . . . . . . . . .  <a href="#page-14">14</a>
   <a href="#section-6">6</a>.  Privacy Considerations  . . . . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
   <a href="#section-7">7</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
     <a href="#section-7.1">7.1</a>.  Registry for PT-EAP Versions  . . . . . . . . . . . . . .  <a href="#page-17">17</a>
   <a href="#section-8">8</a>.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
   <a href="#section-9">9</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>
     <a href="#section-9.1">9.1</a>.  Normative References  . . . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>
     <a href="#section-9.2">9.2</a>.  Informative References  . . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   This document specifies PT-EAP, a Posture Transport (PT) protocol
   protected by a TLS-protected EAP tunnel method.  The PT protocol in
   the Network Endpoint Assessment (NEA) architecture is responsible for
   transporting Posture Broker (PB-TNC [<a href="rfc5793.html" title='"PB-TNC: A Posture Broker (PB) Protocol Compatible with Trusted Network Connect (TNC)"'>RFC5793</a>]) batches, often
   containing Posture Attributes (PA-TNC [<a href="rfc5792.html" title='"PA-TNC: A Posture Attribute (PA) Protocol Compatible with Trusted Network Connect (TNC)"'>RFC5792</a>]), across the network
   between the NEA Client and NEA Server.  The PT-EAP protocol must be
   protected by an outer TLS-based EAP tunnel method to ensure the
   exchanged messages are protected from a variety of threats from
   hostile intermediaries.





<span class="grey">Cam-Winget &amp; Sangster        Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7171.html">RFC 7171</a>                       NEA PT-EAP                       May 2014</span>


   NEA protocols are intended to be used both for pre-admission
   assessment of endpoints joining the network and assessment of
   endpoints already present on the network.  In order to support both
   usage models, two types of PT protocols are needed.  One type of PT,
   PT-TLS [<a href="rfc6876.html" title='"A Posture Transport Protocol over TLS (PT-TLS)"'>RFC6876</a>], operates after the endpoint has an assigned IP
   address, layering on top of the IP protocol to carry a NEA exchange.
   The other type of PT operates before the endpoint gains any access to
   the IP network.  This specification defines PT-EAP, the PT protocol
   used to assess endpoints before they gain access to the network.

   PT-EAP is an inner EAP [<a href="rfc3748.html" title='"Extensible Authentication Protocol (EAP)"'>RFC3748</a>] method designed to be used inside a
   protected tunnel such as Tunnel EAP (TEAP) [<a href="rfc7170.html" title='"Tunnel Extensible Authentication Protocol (TEAP) Version 1"'>RFC7170</a>], EAP Flexible
   Authentication via Secure Tunneling (EAP-FAST) [<a href="rfc4851.html" title='"The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST)"'>RFC4851</a>], or EAP
   Tunneled Transport Layer Security (EAP-TTLS) [<a href="rfc5281.html" title='"Extensible Authentication Protocol Tunneled Transport Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0)"'>RFC5281</a>].  That is, an
   outer EAP method is typically a TLS-based EAP method that first
   establishes a protected tunnel by which other conversations, such as
   other EAP methods (e.g., "inner" EAP methods) can ensue under the
   tunnel protection.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Prerequisites"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Prerequisites</span>

   This document does not define an architecture or reference model.
   Instead, it defines a protocol that works within the reference model
   described in the NEA Requirements specification [<a href="rfc5209.html" title='"Network Endpoint Assessment (NEA): Overview and Requirements"'>RFC5209</a>].  The
   reader is assumed to be thoroughly familiar with that document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Message%20Diagram%20Conventions"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Message Diagram Conventions</span>

   This specification defines the syntax of PT-EAP messages using
   diagrams.  Each diagram depicts the format and size of each field in
   bits.  Implementations MUST send the bits in each diagram as they are
   shown, traversing the diagram from top to bottom and then from left
   to right within each line (which represents a 32-bit quantity).
   Multi-byte fields representing numeric values MUST be sent in network
   (big-endian) byte order.

   Descriptions of bit field (e.g., flag) values are described referring
   to the position of the bit within the field.  These bit positions are
   numbered from the most significant bit through the least significant
   bit so a one octet field with only bit 0 set has the value 0x80.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20Terminology"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  Terminology</span>

   This document reuses many terms defined in the NEA Requirements
   document [<a href="rfc5209.html" title='"Network Endpoint Assessment (NEA): Overview and Requirements"'>RFC5209</a>], such as "Posture Transport Client" and "Posture
   Transport Server".  The reader is assumed to have read that document
   and understood it.




<span class="grey">Cam-Winget &amp; Sangster        Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7171.html">RFC 7171</a>                       NEA PT-EAP                       May 2014</span>


   When defining the PT-EAP method, this specification does not use the
   terms "EAP peer" and "EAP authenticator".  Instead, it uses the terms
   "NEA Client" and "NEA Server" since those are considered to be more
   familiar to NEA WG participants.  However, these terms are equivalent
   for the purposes of this specification.  The part of the NEA Client
   that terminates PT-EAP (generally in the Posture Transport Client) is
   the EAP peer for PT-EAP.  The part of the NEA Server that terminates
   PT-EAP (generally in the Posture Transport Server) is the EAP
   authenticator for PT-EAP.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.4.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-1.4" name="section-1.4">1.4</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.5.%20%20Compatibility%20with%20Other%20Specifications"></a><a class="selflink" href="#section-1.5" name="section-1.5">1.5</a>.  Compatibility with Other Specifications</span>

   One of the goals of the NEA effort is to deliver a single set of
   endpoint assessment standards, agreed upon by all parties.  For this
   reason, the authors understand that the Trusted Computing Group (TCG)
   will be replacing its existing posture transport protocols with new
   versions that are equivalent to and interoperable with the NEA
   specifications.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Use%20of%20PT-EAP"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Use of PT-EAP</span>

   PT-EAP is designed to encapsulate PB-TNC batches in a simple EAP
   method that can be carried within EAP tunnel methods.  The EAP tunnel
   methods provide confidentiality and message integrity, so PT-EAP does
   not have to do so.  Therefore, PT-EAP MUST be used inside a TLS-based
   EAP tunnel method that provides strong cryptographic authentication
   (possibly server only), message integrity, and confidentiality
   services.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Definition%20of%20PT-EAP"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Definition of PT-EAP</span>

   The PT-EAP protocol operates between a Posture Transport Client and a
   Posture Transport Server, allowing them to send PB-TNC batches to
   each other over an EAP tunnel method.  When PT-EAP is used, the
   Posture Transport Client in the NEA reference model acts as an EAP
   peer (terminating the PT-EAP method on the endpoint), and the Posture
   Transport Server acts as an EAP authenticator (terminating the PT-EAP
   method on the NEA Server).

   This section describes and defines the PT-EAP method.  First, it
   provides a protocol overview.  Second, it describes specific features
   like version negotiation.  Third, it gives a detailed packet



<span class="grey">Cam-Winget &amp; Sangster        Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7171.html">RFC 7171</a>                       NEA PT-EAP                       May 2014</span>


   description.  Finally, it describes how the tls-unique channel
   binding [<a href="rfc5929.html" title='"Channel Bindings for TLS"'>RFC5929</a>] may be used to bind PA-TNC exchanges to the EAP
   tunnel method, defeating man-in-the-middle (MITM) attacks such as the
   Asokan attack [<a href="#ref-Asokan" title='"Man-in-the-Middle Attacks in Tunneled Authentication Protocols"'>Asokan</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Protocol%20Overview"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Protocol Overview</span>

   PT-EAP has two phases that follow each other in strict sequence:
   negotiation and data transport.

   The PT-EAP method begins with the negotiation phase.  The NEA Server
   starts this phase by sending a PT-EAP Start message: an EAP Request
   message of type PT-EAP with the S (Start) flag set.  The NEA Server
   also sets the Version field as described in <a href="#section-3.2">Section 3.2</a>.  This is the
   only message in the negotiation phase.

   The data transport phase is the only phase of PT-EAP where PB-TNC
   batches are allowed to be exchanged.  This phase always starts with
   the NEA Client sending a PB-TNC batch to the NEA Server.  The NEA
   Client and NEA Server then take turns sending a PB-TNC batch.  The
   data transport phase always ends with an EAP Response message from
   the NEA Client to the NEA Server.  The Data field of this message may
   have zero length if the NEA Server has just sent the last PB-TNC
   batch in the PB-TNC exchange.

   Note that the success of PT-EAP does not mean the overall
   authentication (using the outer EAP tunnel method) will succeed.
   Neither does the failure of PT-EAP mean that the overall
   authentication will fail.  Success of the overall authentication
   depends on the policy configured by the administrator.

   At the end of the PT-EAP method, the NEA Server will indicate success
   or failure to the EAP tunnel method.  Some EAP tunnel methods may
   provide explicit confirmation of inner method success; others may
   not.  This is out of scope for the PT-EAP method specification.
   Successful completion of PT-EAP does not imply successful completion
   of the overall authentication nor does PT-EAP failure imply overall
   failure.  This depends on the administrative policy in place.

   The NEA Server and NEA Client may engage in an abnormal termination
   of the PT-EAP exchange at any time by simply stopping the exchange.
   This may also require terminating the EAP tunnel method, depending on
   the capabilities of the EAP tunnel method.








<span class="grey">Cam-Winget &amp; Sangster        Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7171.html">RFC 7171</a>                       NEA PT-EAP                       May 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Version%20Negotiation"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Version Negotiation</span>

   PT-EAP version negotiation takes place in the first PT-EAP message
   sent by the NEA Server (the Start message) and the first PT-EAP
   message sent by the NEA Client (the response to the Start message).
   The NEA Server MUST set the Version field in the Start message to the
   maximum PT-EAP version that the NEA Server supports and is willing to
   accept.

   The NEA Client chooses the PT-EAP version to be used for the exchange
   and places this value in the Version field in its response to the
   Start message.  The NEA Client SHOULD choose the value sent by the
   NEA Server if the NEA Client supports it.  However, the NEA Client
   MAY set the Version field to a value less than the value sent by the
   NEA Server (for example, if the NEA Client only supports lesser
   PT-EAP versions).  If the NEA Client only supports PT-EAP versions
   greater than the value sent by the NEA Server, the NEA Client MUST
   abnormally terminate the EAP negotiation.

   If the version sent by the NEA Client is not acceptable to the NEA
   Server, the NEA Server MUST terminate the PT-EAP session immediately.
   Otherwise, the version sent by the NEA Client is the version of
   PT-EAP that MUST be used.  Both the NEA Client and the NEA Server
   MUST set the Version field to the chosen version number in all
   subsequent PT-EAP messages in this exchange.

   This specification defines version 1 of PT-EAP.  Version 0 is
   reserved and MUST never be sent.  New versions of PT-EAP (values 2-7)
   may be defined by Standards Action, as defined in [<a href="rfc5226.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC5226</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20PT-EAP%20Message%20Format"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  PT-EAP Message Format</span>

   This section provides a detailed description of the fields in a
   PT-EAP message.  For a description of the diagram conventions used
   here, see <a href="#section-1.2">Section 1.2</a>.  Since PT-EAP is an EAP method, the first four
   fields (e.g., Code, Identifier, Length, and Type as shown in
   Figure 1) in each message are mandated by and defined in EAP.  The
   other fields, e.g., Flags, Version, and Data are specific to PT-EAP.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Code      |   Identifier  |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    Type       |   Flags | Ver |           Data ...            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                      Figure 1: PT-EAP Message Format



<span class="grey">Cam-Winget &amp; Sangster        Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7171.html">RFC 7171</a>                       NEA PT-EAP                       May 2014</span>


   Code

      The Code field is one octet and identifies the type of the EAP
      message.  The only values used for PT-EAP are:

      1  Request

      2  Response

   Identifier

      The Identifier field is one octet and aids in matching Responses
      with Requests.

   Length

      The Length field is two octets and indicates the length in octets
      of this PT-EAP message, starting from the Code field.

   Type

      54 (EAP Method Type [<a href="rfc3748.html" title='"Extensible Authentication Protocol (EAP)"'>RFC3748</a>] assignment for PT-EAP).

   Flags

      +-+-+-+-+-+
      |S R R R R|
      +-+-+-+-+-+

   S: Start

      Indicates the beginning of a PT-EAP exchange.  This flag MUST be
      set only for the first message from the NEA Server.  If the S flag
      is set, the EAP message MUST NOT contain Data.

   R: Reserved

      This flag MUST be set to 0 and ignored upon receipt.

   Version

      This field is used for version negotiation, as described in
      <a href="#section-3.2">Section 3.2</a>.








<span class="grey">Cam-Winget &amp; Sangster        Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7171.html">RFC 7171</a>                       NEA PT-EAP                       May 2014</span>


   Data

      Variable length data.  This field is processed by the PB layer and
      MUST include PB-TNC messages.  For more information see PB-TNC
      [<a href="rfc5793.html" title='"PB-TNC: A Posture Broker (PB) Protocol Compatible with Trusted Network Connect (TNC)"'>RFC5793</a>].

      The length of the Data field in a particular PT-EAP message may be
      determined by subtracting the length of the PT-EAP header fields
      from the value of the two-octet Length field.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Preventing%20MITM%20Attacks%20with%20Channel%20Bindings"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Preventing MITM Attacks with Channel Bindings</span>

   As described in the NEA Asokan Attack Analysis [<a href="rfc6813.html" title='"The Network Endpoint Assessment (NEA) Asokan Attack Analysis"'>RFC6813</a>], a
   sophisticated MITM attack can be mounted against NEA systems.  The
   attacker forwards PA-TNC messages from a healthy machine through an
   unhealthy one so that the unhealthy machine can gain network access.
   Because there are easier attacks on NEA systems, like having the
   unhealthy machine lie about its configuration, this attack is
   generally only mounted against machines with an External Measurement
   Agent (EMA).  The EMA is a separate entity, difficult to compromise,
   that measures and attests to the configuration of the endpoint.

   To protect against NEA Asokan attacks, it is necessary for the
   Posture Broker on an EMA-equipped endpoint to pass the tls-unique
   channel binding [<a href="rfc5929.html" title='"Channel Bindings for TLS"'>RFC5929</a>] from PT-EAP's tunnel method to the EMA.
   This value can then be included in the EMA's attestation so that the
   Posture Validator responsible may then confirm that the value matches
   the tls-unique channel binding for its end of the tunnel.  If the
   tls-unique values of the NEA Client and NEA Server match and this is
   confirmed by the EMA, then the posture sent by a trustworthy EMA (and
   thus the NEA Client) is from the same endpoint as the client side of
   the TLS connection (since the endpoint knows the tls-unique value) so
   no MITM is forwarding posture.  If they differ, an attack has been
   detected, and the Posture Validator SHOULD fail its verification.

   Note that tls-unique, as opposed to invoking a mutual cryptographic
   binding, is used as there is no keying material being generated by
   PT-EAP (the method is defined to facilitate the transport of posture
   data and is not an authentication method).  However, the NEA Client
   may host an EMA that can be used as the means to cryptographically
   bind the tls-unique content that may be validated by the Posture
   Validator interfacing with the EAP Server.  The binding of the
   tls-unique to the client authentication prevents the client's message
   from being used in another context.  This prevents a poorly
   configured client from unintentionally compromising the NEA system.
   Strong mutual authentication of the NEA Server and Client is still
   REQUIRED to prevent the disclosure of possibly sensitive NEA Client
   information to an attacker.



<span class="grey">Cam-Winget &amp; Sangster        Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7171.html">RFC 7171</a>                       NEA PT-EAP                       May 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Security%20Considerations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Security Considerations</span>

   This section discusses the major threats and countermeasures provided
   by PT-EAP.  As discussed throughout the document, the PT-EAP method
   is designed to run inside an EAP tunnel method that is capable of
   protecting the PT-EAP protocol from many threats.  Since the EAP
   tunnel method will be specified separately, this section describes
   the considerations on the EAP tunnel method but does not evaluate its
   ability to meet those requirements.  The security considerations and
   requirements for NEA can be found in [<a href="rfc5209.html" title='"Network Endpoint Assessment (NEA): Overview and Requirements"'>RFC5209</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Trust%20Relationships"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Trust Relationships</span>

   In order to understand where security countermeasures are necessary,
   this section starts with a discussion of where the NEA architecture
   envisions some trust relationships between the processing elements of
   the PT-EAP protocol.  The following sub-sections discuss the trust
   properties associated with each portion of the NEA reference model
   directly involved with the processing of the PT-EAP protocol flowing
   inside an EAP tunnel.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.1.%20%20Posture%20Transport%20Client"></a><a class="selflink" href="#section-4.1.1" name="section-4.1.1">4.1.1</a>.  Posture Transport Client</span>

   The Posture Transport Client is trusted by the Posture Broker Client
   to:

   o  Not disclose to unauthorized parties, fabricate, or alter the
      contents of the PB-TNC batches received from the network.

   o  Not observe, fabricate, or alter the PB-TNC batches passed down
      from the Posture Broker Client for transmission on the network.

   o  Transmit on the network any PB-TNC batches passed down from the
      Posture Broker Client.

   o  Provide configured security protections (e.g., authentication,
      integrity, and confidentiality) for the Posture Broker Client's
      PB-TNC batches sent on the network.

   o  Expose the authenticated identity of the Posture Transport Server
      to the Posture Broker Client.

   o  Verify the security protections placed upon messages received from
      the network to ensure the messages are authentic and protected
      from attacks on the network.

   o  Deliver to the Posture Broker Client the PB-TNC batches received
      from the network so long as they are properly security protected.



<span class="grey">Cam-Winget &amp; Sangster        Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7171.html">RFC 7171</a>                       NEA PT-EAP                       May 2014</span>


   o  Provide a secure, reliable, "in-order delivery", full-duplex
      transport for the Posture Broker Client's messages.

   Since the Posture Transport Server can not validate the
   trustworthiness of the Posture Transport Client, the Posture
   Transport Server should protect itself appropriately.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.2.%20%20Posture%20Transport%20Server"></a><a class="selflink" href="#section-4.1.2" name="section-4.1.2">4.1.2</a>.  Posture Transport Server</span>

   The Posture Transport Server is trusted by the Posture Broker Server
   to:

   o  Not observe, fabricate, or alter the contents of the PB-TNC
      batches received from the network.

   o  Not observe, fabricate, or alter the PB-TNC batches passed down
      from the Posture Broker Server for transmission on the network.

   o  Transmit on the network any PB-TNC batches passed down from the
      Posture Broker Server.

   o  Ensure PB-TNC batches received from the network are properly
      protected from a security perspective.

   o  Provide configured security protections (e.g., authentication,
      integrity, and confidentiality) for the Posture Broker Server's
      messages sent on the network.

   o  Expose the authenticated identity of the Posture Transport Client
      to the Posture Broker Server.

   o  Verify the security protections placed upon messages received from
      the network to ensure the messages are authentic and protected
      from attacks on the network.

   Since the Posture Transport Client can not validate the
   trustworthiness of the Posture Transport Server, the Posture
   Transport Client should protect itself appropriately.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Threats%20and%20Countermeasures"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Threats and Countermeasures</span>

   Beyond the trusted relationships assumed in <a href="#section-4.1">Section 4.1</a>, the PT-EAP
   EAP method faces a number of potential security attacks that could
   require security countermeasures.

   Generally, the PT protocol is responsible for providing strong
   security protections for all of the NEA protocols so any threats to
   PT's ability to protect NEA protocol messages could be very damaging



<span class="grey">Cam-Winget &amp; Sangster        Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7171.html">RFC 7171</a>                       NEA PT-EAP                       May 2014</span>


   to deployments.  For the PT-EAP method, most of the cryptographic
   security is provided by the outer EAP tunnel method, and PT-EAP is
   encapsulated within the protected tunnel.  Therefore, this section
   highlights the cryptographic requirements that need to be met by the
   EAP tunnel method carrying PT-EAP in order to meet the NEA PT
   requirements.

   Once the message is delivered to the Posture Broker Client or Posture
   Broker Server, the Posture Brokers are trusted to properly and safely
   process the messages.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.1.%20%20Message%20Confidentiality"></a><a class="selflink" href="#section-4.2.1" name="section-4.2.1">4.2.1</a>.  Message Confidentiality</span>

   When PT-EAP messages are sent over unprotected network links or span
   local software stacks that are not trusted, the contents of the
   messages may be subject to information theft by an intermediary
   party.  This theft could result in information being recorded for
   future use or analysis by an adversary.  Messages observed by
   eavesdroppers could contain information that exposes potential
   weaknesses in the security of the endpoint or system fingerprinting
   information easing the ability of the attacker to employ attacks more
   likely to be successful against the endpoint.  The eavesdropper might
   also learn information about the endpoint or network policies that
   either singularly or collectively is considered sensitive
   information.  For example, if PT-EAP is carried by an EAP tunnel
   method that does not provide confidentiality protection, an adversary
   could observe the PA-TNC attributes included in the PB-TNC batch and
   determine that the endpoint is lacking patches or that particular
   sub-networks have more lenient policies.

   In order to protect against NEA assessment message theft, the EAP
   tunnel method carrying PT-EAP must provide strong cryptographic
   authentication, integrity, and confidentiality protection.  The use
   of bidirectional authentication in the EAP tunnel method carrying
   PT-EAP ensures that only properly authenticated and authorized
   parties may be involved in an assessment message exchange.  When
   PT-EAP is carried within a cryptographically protected EAP tunnel
   method like EAP-FAST or EAP-TTLS, all of the contents of PB-TNC and
   PA-TNC protocol messages are hidden from potential theft by
   intermediaries lurking on the network.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.2.%20%20Message%20Fabrication"></a><a class="selflink" href="#section-4.2.2" name="section-4.2.2">4.2.2</a>.  Message Fabrication</span>

   Attackers on the network or present within the NEA system could
   introduce fabricated PT-EAP messages intending to trick or create a
   denial of service against aspects of an assessment.  For example, an
   adversary could attempt to insert a PT-EAP message to tell a NEA
   Server that the endpoint is totally infected.  This could cause the



<span class="grey">Cam-Winget &amp; Sangster        Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7171.html">RFC 7171</a>                       NEA PT-EAP                       May 2014</span>


   device to be blocked from accessing a critical resource, which would
   be a denial of service.

   The EAP tunnel method carrying a PT-EAP method needs to provide
   strong security protections for the complete message exchange over
   the network.  These security protections prevent an intermediary from
   being able to insert fake messages into the assessment.  See
   <a href="#section-5">Section 5</a> for more details on the EAP tunnel requirements.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.3.%20%20Message%20Modification"></a><a class="selflink" href="#section-4.2.3" name="section-4.2.3">4.2.3</a>.  Message Modification</span>

   This attack could allow an active attacker capable of intercepting a
   message to modify a PT-EAP message or transported PA-TNC attribute to
   a desired value to ease the compromise of an endpoint.  Without the
   ability for message recipients to detect whether a received message
   contains the same content as what was originally sent, active
   attackers can stealthily modify the attribute exchange.

   PT-EAP leverages the EAP tunnel method (e.g., TEAP, EAP-FAST, or EAP-
   TTLS) to provide strong authentication and integrity protections as a
   countermeasure to this threat.  The bidirectional authentication
   prevents the attacker from acting as an active MITM to the protocol
   that could be used to modify the message exchange.  The strong
   integrity protections offered by the TLS-based EAP tunnel method
   allow the PT-EAP message recipients to detect message alterations by
   other types of network-based adversaries.  Because PT-EAP does not
   itself provide explicit integrity protection for the PT-EAP payload,
   an EAP tunnel method that offers strong integrity protection is
   needed to mitigate this threat.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.4.%20%20Denial%20of%20Service"></a><a class="selflink" href="#section-4.2.4" name="section-4.2.4">4.2.4</a>.  Denial of Service</span>

   A variety of types of denial-of-service attacks are possible against
   PT-EAP if the message exchange is left unprotected while traveling
   over the network.  The Posture Transport Client and Posture Transport
   Server are trusted not to participate in the denial of service of the
   assessment session, leaving the threats to come from the network.

   The PT-EAP method primarily relies on the outer EAP tunnel method to
   provide strong authentication (at least of one party), and deployers
   are expected to leverage other EAP methods to authenticate the other
   party (typically the client) within the protected tunnel.  The use of
   a protected bidirectional authentication will prevent unauthorized
   parties from participating in a PT-EAP exchange.

   After the cryptographic authentication by the EAP tunnel method, the
   session can be protected cryptographically to provide confidentiality
   and source authenticity.  Such protection prevents undetected



<span class="grey">Cam-Winget &amp; Sangster        Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc7171.html">RFC 7171</a>                       NEA PT-EAP                       May 2014</span>


   modification that could create a denial-of-service situation.
   However, it is possible for an adversary to alter the message flows,
   causing each message to be rejected by the recipient because it fails
   the integrity checking.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.5.%20%20NEA%20Asokan%20Attacks"></a><a class="selflink" href="#section-4.2.5" name="section-4.2.5">4.2.5</a>.  NEA Asokan Attacks</span>

   As described in <a href="#section-3.4">Section 3.4</a> and in the NEA Asokan Attack Analysis
   [<a href="rfc6813.html" title='"The Network Endpoint Assessment (NEA) Asokan Attack Analysis"'>RFC6813</a>], a sophisticated MITM attack can be mounted against NEA
   systems.  The attacker forwards PA-TNC messages from a healthy
   machine through an unhealthy one so that the unhealthy machine can
   gain network access.  <a href="#section-3.4">Section 3.4</a> and [<a href="rfc6813.html" title='"The Network Endpoint Assessment (NEA) Asokan Attack Analysis"'>RFC6813</a>] provide a detailed
   description of this attack and of the countermeasures that can be
   employed against it.

   Because lying endpoint attacks are much easier than Asokan attacks
   and an effective countermeasure against lying endpoint attacks is the
   use of an External Measurement Agent (EMA), countermeasures against
   an Asokan attack are not necessary unless an EMA is in use.  However,
   PT-EAP implementers may not know whether an EMA will be used with
   their implementation.  Therefore, PT-EAP implementers SHOULD support
   these countermeasures by providing the value of the tls-unique
   channel binding to higher layers in the NEA reference model: Posture
   Broker Clients, Posture Broker Servers, Posture Collectors, and
   Posture Validators.  If the tls-unique channel binding is
   implemented, it must be verified before any other attestations are
   evaluated.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Candidate%20EAP%20Tunnel%20Method%20Protections"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Candidate EAP Tunnel Method Protections</span>

   This section discusses how PT-EAP is used within various EAP tunnel
   methods to meet the PT requirements in <a href="#section-5">Section 5</a>.

   TEAP [<a href="rfc7170.html" title='"Tunnel Extensible Authentication Protocol (TEAP) Version 1"'>RFC7170</a>], EAP-FAST [<a href="rfc4851.html" title='"The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST)"'>RFC4851</a>], and EAP-TTLS [<a href="rfc5281.html" title='"Extensible Authentication Protocol Tunneled Transport Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0)"'>RFC5281</a>] make use
   of TLS [<a href="rfc5246.html" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>RFC5246</a>] to protect the transport of information between the
   NEA Client and NEA Server.  Each of these EAP tunnel methods has two
   phases.  In the first phase, a TLS tunnel is established between the
   NEA Client and NEA Server.  In the second phase, the tunnel is used
   to pass other information.  PT-EAP requires that establishing this
   tunnel include at least an authentication of the NEA Server by the
   NEA Client.

   The phase two dialog may include authentication of the user by doing
   other EAP methods or, in the case of EAP-TTLS, by using EAP or non-
   EAP authentication dialogs.  PT-EAP is also carried by the phase two
   tunnel, allowing the NEA assessment to be within an encrypted and
   integrity-protected transport.




<span class="grey">Cam-Winget &amp; Sangster        Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc7171.html">RFC 7171</a>                       NEA PT-EAP                       May 2014</span>


   With all these methods (e.g., TEAP [<a href="rfc7170.html" title='"Tunnel Extensible Authentication Protocol (TEAP) Version 1"'>RFC7170</a>], EAP-FAST [<a href="rfc4851.html" title='"The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST)"'>RFC4851</a>], and
   EAP-TTLS [<a href="rfc5281.html" title='"Extensible Authentication Protocol Tunneled Transport Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0)"'>RFC5281</a>]), a cryptographic key is derived from the
   authentication that may be used to secure later transmissions.  Each
   of these methods employs at least a NEA Server authentication using
   an X.509 certificate.  Within each EAP tunnel method will exist a set
   of inner EAP methods.  These inner methods may perform additional
   security handshakes including more granular authentications or
   exchanges of integrity information (such as PT-EAP).  At some point
   after the conclusion of each inner EAP method, some of the methods
   will export the established secret keys to the outer tunnel method.
   It's expected that the outer method will cryptographically mix these
   keys into any keys it is currently using to protect the session and
   perform a final operation to determine whether both parties have
   arrived at the same mixed key.  This cryptographic binding of the
   inner method results to the outer method's keys is essential for
   detection of conventional (non-NEA) Asokan attacks.

   TEAP [<a href="rfc7170.html" title='"Tunnel Extensible Authentication Protocol (TEAP) Version 1"'>RFC7170</a>] is the mandatory-to-implement EAP tunnel method.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.4.%20%20Security%20Claims%20for%20PT-EAP%20as%20per%20RFC%203748"></a><a class="selflink" href="#section-4.4" name="section-4.4">4.4</a>.  Security Claims for PT-EAP as per <a href="rfc3748.html">RFC 3748</a></span>

   This section summarizes the security claims for this specification,
   as required by <a href="rfc3748.html#section-7.2">[RFC3748], Section 7.2</a>:

      Auth. mechanism:               None
      Ciphersuite negotiation:       No
      Mutual authentication:         No
      Integrity protection:          No
      Replay protection:             No
      Confidentiality:               No
      Key derivation:                No
      Key strength:                  N/A
      Dictionary attack resistant:   N/A
      Fast reconnect:                No
      Crypt. binding:                N/A
      Session independence:          N/A
      Fragmentation:                 No
      Channel binding:               No

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Requirements%20for%20EAP%20Tunnel%20Methods"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Requirements for EAP Tunnel Methods</span>

   Because the PT-EAP inner method described in this specification
   relies on the outer EAP tunnel method for a majority of its security
   protections, this section reiterates the PT requirements that MUST be
   met by the IETF standard EAP tunnel method for use with PT-EAP.






<span class="grey">Cam-Winget &amp; Sangster        Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc7171.html">RFC 7171</a>                       NEA PT-EAP                       May 2014</span>


   TEAP [<a href="rfc7170.html" title='"Tunnel Extensible Authentication Protocol (TEAP) Version 1"'>RFC7170</a>] is a Standards Track EAP tunnel method that satisfies
   NEA's requirements and is the mandatory-to-implement EAP tunnel
   method.

   The security requirements described in this specification MUST be
   implemented in any product claiming to be PT-EAP compliant.  The
   decision of whether a particular deployment chooses to use these
   protections is a deployment issue.  A customer may choose to avoid
   potential deployment issues or performance penalties associated with
   the use of cryptography when the required protection has been
   achieved through other mechanisms (e.g., physical isolation).  If
   security mechanisms may be deactivated by policy, an implementation
   SHOULD offer an interface to query how a message will be (or was)
   protected by PT so higher-layer NEA protocols can factor this into
   their decisions.

   <a href="rfc5209.html">RFC 5209</a> [<a href="rfc5209.html" title='"Network Endpoint Assessment (NEA): Overview and Requirements"'>RFC5209</a>] includes the following requirement that is to be
   applied during the selection of the EAP tunnel method(s) used in
   conjunction with PT-EAP:

      PT-2: The PT protocol MUST be capable of supporting mutual
      authentication, integrity, confidentiality, and replay protection
      of the PB messages between the Posture Transport Client and the
      Posture Transport Server.

   Note that mutual authentication could be achieved by a combination of
   a strong authentication of one party (e.g., server authentication
   while establishing the TLS-based tunnel) by the EAP tunnel method in
   conjunction with a second authentication of the other party (e.g.,
   client authentication inside the protected tunnel) by another EAP
   method running prior to PT-EAP.

   Having the Posture Transport Client always authenticate the Posture
   Transport Server provides assurance to the NEA Client that the NEA
   Server is authentic (not a rogue or MITM) prior to disclosing secret
   or potentially privacy-sensitive information about what is running or
   configured on the endpoint.  However, the NEA Server's policy may
   allow for the delay of the authentication of the NEA Client until a
   suitable protected channel has been established allowing for non-
   cryptographic NEA Client credentials (e.g., username/password) to be
   used.  Whether the communication channel is established with mutual
   or server-side-only authentication, the resulting channel needs to
   provide strong integrity and confidentiality protection to its
   contents.  These protections are to be bound to at least the
   authentication of the NEA Server by the NEA Client, so the session is
   cryptographically bound to a particular authentication event.





<span class="grey">Cam-Winget &amp; Sangster        Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc7171.html">RFC 7171</a>                       NEA PT-EAP                       May 2014</span>


   The EAP tunnel method carrying PT-EAP MUST provide strong
   cryptographic authentication, integrity, and confidentiality
   protection to protect against NEA assessment message theft as
   described in <a href="#section-4.2.1">Section 4.2.1</a>.  The cryptographically protected EAP
   tunnel ensures that all of the PA-TNC and PB-TNC protocol messages
   are hidden from intermediaries wanting to steal NEA data.

   To support countermeasures against NEA Asokan attacks as described in
   <a href="#section-3.4">Section 3.4</a>, the EAP tunnel method used with PT-EAP will need to
   support generation of the tls-unique value to be used with the higher
   layers of the NEA reference model.  This should not be a high bar
   since all EAP tunnel methods currently support this, but not all
   implementations of those methods may do so.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Privacy%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Privacy Considerations</span>

   The role of PT-EAP is to act as a secure transport for PB-TNC over a
   network before the endpoint has been admitted to the network.  As a
   transport protocol, PT-EAP does not directly utilize or require
   direct knowledge of any personally identifiable information (PII).
   PT-EAP will typically be used in conjunction with other EAP methods
   that provide for the user authentication (if bidirectional
   authentication is used), so the user's credentials are not directly
   seen by the PT-EAP inner method.

   While PT-EAP does not provide cryptographic protection for the PB-TNC
   batches, it is designed to operate within an EAP tunnel method that
   provides strong authentication, integrity, and confidentiality
   services.  Therefore, it is important for deployers to leverage these
   protections in order to prevent disclosure of PII potentially
   contained within PA-TNC or PB-TNC within the PT-EAP payload.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  IANA Considerations</span>

   This section provides guidance to the Internet Assigned Numbers
   Authority (IANA) regarding registration of values related to the
   PT-EAP protocol, in accordance with <a href="https://tools.ietf.org/html/bcp26">BCP 26</a> [<a href="rfc5226.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC5226</a>].

   The EAP Method type for PT-EAP has been assigned value 54, i.e., the
   assignment for Type in <a href="#section-3.3">Section 3.3</a>.

            +-------+----------------------------+-----------+
            | Value |        Description         | Reference |
            +-------+----------------------------+-----------+
            |   54  | EAP Method Type for PT-EAP | [<a href="rfc7171.html">RFC7171</a>] |
            +-------+----------------------------+-----------+





<span class="grey">Cam-Winget &amp; Sangster        Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc7171.html">RFC 7171</a>                       NEA PT-EAP                       May 2014</span>


   This document also defines one new IANA top-level registry: "PT-EAP
   Versions".  This section explains how this registry works.  Because
   only eight (8) values are available in this registry, a high bar is
   set for new assignments.  The only way to register new values in this
   registry is through Standards Action (via an approved Standards Track
   RFC).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Registry%20for%20PT-EAP%20Versions"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Registry for PT-EAP Versions</span>

   The name for this registry is "PT-EAP Versions".  Each entry in this
   registry includes a decimal integer value between 1 and 7 identifying
   the version and also includes a reference to the RFC where the
   version is defined.

   The following entries are defined in this document and are the
   initial entries in the registry.  Additional entries to this registry
   are added by Standards Action, as defined in <a href="rfc5226.html">RFC 5226</a> [<a href="rfc5226.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC5226</a>].

                    +-------+------------------------+
                    | Value | Defining Specification |
                    +-------+------------------------+
                    |   0   |        Reserved        |
                    |   1   |       [<a href="rfc7171.html">RFC7171</a>]        |
                    +-------+------------------------+

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Acknowledgements"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Acknowledgements</span>

   Thanks to the Trusted Computing Group for contributing the initial
   text upon which this document was based.

   The authors of this document would like to acknowledge the following
   people who have contributed to or provided substantial input on the
   preparation of this document or predecessors to it: Amit Agarwal,
   Morteza Ansari, Diana Arroyo, Stuart Bailey, Boris Balacheff, Uri
   Blumenthal, Gene Chang, Scott Cochrane, Pasi Eronen, Aman Garg,
   Sandilya Garimella, David Grawrock, Stephen Hanna, Thomas Hardjono,
   Chris Hessing, Ryan Hurst, Hidenobu Ito, John Jerrim, Meenakshi
   Kaushik, Greg Kazmierczak, Scott Kelly, Bryan Kingsford, PJ Kirner,
   Sung Lee, Lisa Lorenzin, Mahalingam Mani, Bipin Mistry, Seiji
   Munetoh, Rod Murchison, Barbara Nelson, Kazuaki Nimura, Ron Pon, Ivan
   Pulleyn, Alex Romanyuk, Ravi Sahita, Joseph Salowey, Chris Salter,
   Mauricio Sanchez, Dean Sheffield, Curtis Simonson, Jeff Six, Ned
   Smith, Michelle Sommerstad, Joseph Tardo, Lee Terrell, Susan Thomson,
   Chris Trytten, and John Vollbrecht.







<span class="grey">Cam-Winget &amp; Sangster        Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc7171.html">RFC 7171</a>                       NEA PT-EAP                       May 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20References"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20Normative%20References"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC3748" name="ref-RFC3748">RFC3748</a>]  Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H.
              Levkowetz, "Extensible Authentication Protocol (EAP)", <a href="rfc3748.html">RFC</a>
              <a href="rfc3748.html">3748</a>, June 2004.

   [<a id="ref-RFC5209" name="ref-RFC5209">RFC5209</a>]  Sangster, P., Khosravi, H., Mani, M., Narayan, K., and J.
              Tardo, "Network Endpoint Assessment (NEA): Overview and
              Requirements", <a href="rfc5209.html">RFC 5209</a>, June 2008.

   [<a id="ref-RFC5226" name="ref-RFC5226">RFC5226</a>]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc5226.html">RFC 5226</a>,
              May 2008.

   [<a id="ref-RFC5246" name="ref-RFC5246">RFC5246</a>]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.2", <a href="rfc5246.html">RFC 5246</a>, August 2008.

   [<a id="ref-RFC5792" name="ref-RFC5792">RFC5792</a>]  Sangster, P. and K. Narayan, "PA-TNC: A Posture Attribute
              (PA) Protocol Compatible with Trusted Network Connect
              (TNC)", <a href="rfc5792.html">RFC 5792</a>, March 2010.

   [<a id="ref-RFC5793" name="ref-RFC5793">RFC5793</a>]  Sahita, R., Hanna, S., Hurst, R., and K. Narayan, "PB-TNC:
              A Posture Broker (PB) Protocol Compatible with Trusted
              Network Connect (TNC)", <a href="rfc5793.html">RFC 5793</a>, March 2010.

   [<a id="ref-RFC5929" name="ref-RFC5929">RFC5929</a>]  Altman, J., Williams, N., and L. Zhu, "Channel Bindings
              for TLS", <a href="rfc5929.html">RFC 5929</a>, July 2010.

   [<a id="ref-RFC7170" name="ref-RFC7170">RFC7170</a>]  Zhou, H., Cam-Winget, N., Salowey, J., and S. Hanna,
              "Tunnel Extensible Authentication Protocol (TEAP) Version
              1", <a href="rfc7170.html">RFC 7170</a>, May 2014.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20Informative%20References"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  Informative References</span>

   [<a id="ref-Asokan" name="ref-Asokan">Asokan</a>]   Asokan, N., Niemi, V., Nyberg, K., and Nokia Research
              Center, Finland, "Man-in-the-Middle Attacks in Tunneled
              Authentication Protocols", Nov 2002,
              &lt;<a href="http://eprint.iacr.org/2002/163.pdf">http://eprint.iacr.org/2002/163.pdf</a>&gt;.

   [<a id="ref-RFC4851" name="ref-RFC4851">RFC4851</a>]  Cam-Winget, N., McGrew, D., Salowey, J., and H. Zhou, "The
              Flexible Authentication via Secure Tunneling Extensible
              Authentication Protocol Method (EAP-FAST)", <a href="rfc4851.html">RFC 4851</a>, May
              2007.



<span class="grey">Cam-Winget &amp; Sangster        Standards Track                   [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc7171.html">RFC 7171</a>                       NEA PT-EAP                       May 2014</span>


   [<a id="ref-RFC5281" name="ref-RFC5281">RFC5281</a>]  Funk, P. and S. Blake-Wilson, "Extensible Authentication
              Protocol Tunneled Transport Layer Security Authenticated
              Protocol Version 0 (EAP-TTLSv0)", <a href="rfc5281.html">RFC 5281</a>, August 2008.

   [<a id="ref-RFC6813" name="ref-RFC6813">RFC6813</a>]  Salowey, J. and S. Hanna, "The Network Endpoint Assessment
              (NEA) Asokan Attack Analysis", <a href="rfc6813.html">RFC 6813</a>, December 2012.

   [<a id="ref-RFC6876" name="ref-RFC6876">RFC6876</a>]  Sangster, P., Cam-Winget, N., and J. Salowey, "A Posture
              Transport Protocol over TLS (PT-TLS)", <a href="rfc6876.html">RFC 6876</a>, February
              2013.

Authors' Addresses

   Nancy Cam-Winget
   Cisco Systems
   80 West Tasman Drive
   San Jose, CA  95134
   US

   EMail: ncamwing@cisco.com


   Paul Sangster
   Symantec Corporation
   6825 Citrine Drive
   Carlsbad, CA  92009
   US

   EMail: paul_sangster@symantec.com






















Cam-Winget &amp; Sangster        Standards Track                   [Page 19]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7171 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:23 GMT --></html>