<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7903 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:18 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-seantek-image-wmf-emf" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:7903" name="DC.Identifier"/>
<meta content="September, 2016" name="DC.Date.Issued"/>
<meta content="Sean Leonard &lt;dev+ietf@seantek.com&gt;" name="DC.Creator"/>
<meta content="This document registers media types for certain image formats
promulgated in Microsoft Windows, namely image/wmf, image/x-wmf,
image/emf, image/x-emf, and image/bmp for use with Windows Metafile,
Enhanced Metafile, and Windows Bitmap formats. Originally designed for
Microsoft Windows 2.0 and 3.0, these image files are intended to be
portable between applications and devices, and they may contain both
vector and raster graphics." name="DC.Description.Abstract"/>
<meta content="Windows Image Media Types" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7903 - Windows Image Media Types</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7903.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7903" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-seantek-windows-image" title="draft-seantek-windows-image">draft-seantek-w...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7903" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7903" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7903" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Independent Submission                                        S. Leonard
Request for Comments: 7903                                 Penango, Inc.
Category: Informational                                   September 2016
ISSN: 2070-1721


                       <span class="h1">Windows Image Media Types</span>

Abstract

   This document registers media types for certain image formats
   promulgated in Microsoft Windows, namely image/wmf, image/x-wmf,
   image/emf, image/x-emf, and image/bmp for use with Windows Metafile,
   Enhanced Metafile, and Windows Bitmap formats.  Originally designed
   for Microsoft Windows 2.0 and 3.0, these image files are intended to
   be portable between applications and devices, and they may contain
   both vector and raster graphics.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This is a contribution to the RFC Series, independently of any other
   RFC stream.  The RFC Editor has chosen to publish this document at
   its discretion and makes no statement about its value for
   implementation or deployment.  Documents approved for publication by
   the RFC Editor are not a candidate for any level of Internet
   Standard; see <a href="rfc7841.html#section-2">Section 2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7903">http://www.rfc-editor.org/info/rfc7903</a>.

Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.






<span class="grey">Leonard                       Informational                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7903.html">RFC 7903</a>                Windows Image Media Types         September 2016</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
      <a href="#section-1.1">1.1</a>. Windows Metafiles ..........................................<a href="#page-2">2</a>
      <a href="#section-1.2">1.2</a>. Windows Bitmaps ............................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Windows Metafile Media Type Registration Application ............<a href="#page-4">4</a>
   <a href="#section-3">3</a>. Enhanced Metafile Media Type Registration Application ...........<a href="#page-6">6</a>
   <a href="#section-4">4</a>. Windows Bitmap Media Type Registration Application ..............<a href="#page-9">9</a>
   <a href="#section-5">5</a>. IANA Considerations ............................................<a href="#page-11">11</a>
   <a href="#section-6">6</a>. Security Considerations ........................................<a href="#page-11">11</a>
   <a href="#section-7">7</a>. References .....................................................<a href="#page-11">11</a>
      <a href="#section-7.1">7.1</a>. Normative References ......................................<a href="#page-11">11</a>
      <a href="#section-7.2">7.2</a>. Informative References ....................................<a href="#page-11">11</a>
   Author's Address ..................................................<a href="#page-12">12</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Windows%20Metafiles"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Windows Metafiles</span>

   Long before the invention of Scalable Vector Graphics, Microsoft
   Corporation recognized the value of recording images in a format that
   its applications and operating systems could easily render
   irrespective of the output device.  With the release of Windows 3.0,
   Microsoft released its Windows Metafile (WMF) format, which can
   contain vector and raster graphics in one package.  As a binary
   format that needed to work on 16-bit machines, WMF is comprised of a
   sequence of record structures.  Each record contains drawing
   commands, object definitions, and configuration settings.  When a
   metafile is processed, the image can be rendered on a display, output
   to a printer or plotter, stored in memory, or saved to some
   persistent storage.  Reflecting the relationship to the Windows
   Graphics Device Interface (GDI) API, WMF data is "played" to a
   playback device context in the same manner that PostScript content is
   treated as an executable program that results in the output of the
   original document.

   As Microsoft's first 32-bit operating system, Windows NT 3.1
   introduced an overhaul to the Windows API ("Win32") and the in-memory
   formats upon which those APIs relied.  The Enhanced Metafile (EMF)
   format was created at this time, using 32-bit values instead of WMF's
   16-bit values.  In Windows XP, Microsoft extended EMF with "EMF+",
   adding support for Windows GDI+.

   Many implementations of WMF and EMF were created because of Windows'
   commercial success in the 1990s.  A large body of free and
   commercially available clip art and other artwork exists in this
   format.  Furthermore, WMF content appears non-normatively in certain




<span class="grey">Leonard                       Informational                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7903.html">RFC 7903</a>                Windows Image Media Types         September 2016</span>


   standards (e.g., [<a href="#ref-OOXML" title='"Office Open XML File Formats"'>OOXML</a>]); the usage is common enough that an
   implementer would almost certainly need to support it for basic
   interoperability.

   Microsoft publicly documented the WMF format as early as the 1992
   Windows 3.1 SDK.  Since 2007, Microsoft has released the format
   specifications [<a href="#ref-MS-WMF" title='"[MS-WMF]: Windows Metafile Format"'>MS-WMF</a>], [<a href="#ref-MS-EMF" title='"[MS-EMF]: Enhanced Metafile Format"'>MS-EMF</a>], and [MS-EMF+] under its Open
   Specification Promise [<a href="#ref-MS-OSP" title='"Open Specification Promise"'>MS-OSP</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Windows%20Bitmaps"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Windows Bitmaps</span>

   Long before the invention of Portable Network Graphics (PNG),
   Microsoft Corporation and IBM Corporation needed to record images in
   a format that their applications and operating systems could easily
   render on low-end machines (Intel 80286).  The resulting "BMP" format
   contains a single raster graphic with basic header fields that can be
   easily mapped (or "blitted") to locations in memory.  As computing
   moved from 16-bit to 32-bit, BMP evolved to contain 32-bit
   structures.  As the '90s wore on, the venerable BMP got boosts with
   support for additional color spaces, color profiles, and compression
   formats.  The same basic format can be used to convey 2-bit black-
   and-white bitmaps with a 1-bit alpha mask from the '80s, and full-
   color Ultra HD images on leading-edge displays.  BMP is a building
   block of other formats, including Windows Metafiles, Windows Icons,
   and Windows Cursors.

   Many implementations of BMP were created because of Windows'
   commercial success in the 1990s.  Usage of the format for interchange
   has declined since the advent of PNG (for lossless raster graphics)
   and JPEG (for lossy raster graphics); however, a large body of free
   and commercially available BMP artwork exists.  Since Windows Icons
   are a building block of "favicon.ico" web technology, an implementer
   would almost certainly need to support this format for basic
   interoperability.

   Microsoft publicly documented the BMP format as early as the 1992
   Windows 3.1 SDK (in the Windows Metafile documentation).  Since 2007
   Microsoft has released the format specification [<a href="#ref-MS-WMF" title='"[MS-WMF]: Windows Metafile Format"'>MS-WMF</a>], which
   includes most components of the Windows Bitmap format, under its Open
   Specification Promise [<a href="#ref-MS-OSP" title='"Open Specification Promise"'>MS-OSP</a>].  See Section 2.2.2.9 of [<a href="#ref-MS-WMF" title='"[MS-WMF]: Windows Metafile Format"'>MS-WMF</a>]
   (DeviceIndependentBitmap Object).  BMP data begins with a
   BITMAPFILEHEADER and is followed by one of the bitmap headers
   (BITMAPINFOHEADER, BITMAPV4HEADER, or BITMAPV5HEADER), optional color
   table data, bitmap data, and optional profile data, in that order
   [<a href="#ref-BMPSTOR" title='"Bitmap Storage"'>BMPSTOR</a>].






<span class="grey">Leonard                       Informational                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7903.html">RFC 7903</a>                Windows Image Media Types         September 2016</span>


   Implementers need to be aware of the [<a href="#ref-MICE" title='"Vulnerability in Graphics Rendering Engine Could Allow Remote Code Execution (912919)"'>MICE</a>] vulnerability, and to
   guard against it.  Some details are included in the completed
   registration template.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Windows%20Metafile%20Media%20Type%20Registration%20Application"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Windows Metafile Media Type Registration Application</span>

   Type name: image

   Subtype name: wmf

   Required parameters: None.

   Optional parameters:

      DEFAULT_CHARSET: The character set intended when the CharacterSet
         enumeration (see the WMF specification) specifies
         DEFAULT_CHARSET.  The value of this parameter is a charset from
         the IANA "Character Sets" registry
         &lt;<a href="http://www.iana.org/assignments/character-sets">http://www.iana.org/assignments/character-sets</a>&gt;.  When this
         parameter is not specified, DEFAULT_CHARSET has the following
         meaning in the WMF specification: "a character set based on the
         current system locale; for example, when the system locale is
         United States English, the default character set is
         ANSI_CHARSET" (which is Windows-1252, more or less).  That is,
         when not specified, the default character set is system
         dependent.  This optional parameter is new to this registration
         and may not enjoy widespread support for some time.  Therefore,
         EMF instead of WMF (or if necessary under the circumstances,
         embedded EMF within WMF) is a more sensible choice when text is
         present.

   Encoding considerations: Binary.

   Security considerations:

      The Windows Metafile format's security history is punctuated in
      2005-2006 with the disclosure of the Metafile Image Code Execution
      ("MICE") vulnerability.  MICE won the 2007 Pwnie Award for "Mass
      0wnage" and "Breaking the Internet".  The official Microsoft
      security bulletin describes that the flaw occurs because Windows
      Metafiles can set the SETABORTPROC value of the MetafileEscapes
      enumeration (accessible via the META_ESCAPE record), allowing for
      arbitrary code execution, i.e., "active content".

      Windows Metafiles can contain Enhanced Metafiles using the
      META_ESCAPE_ENHANCED_METAFILE record; thus, the security
      considerations of EMF apply to WMF.




<span class="grey">Leonard                       Informational                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7903.html">RFC 7903</a>                Windows Image Media Types         September 2016</span>


      Windows Metafiles are historically very buggy.  As the original
      intent was to replicate Windows GDI calls, flaws in GDI, or in a
      display or printer driver implementing the backend to GDI, could
      be exploitable.  WMF implementations not backed by Windows GDI
      have different risks: namely, while a malicious WMF author may not
      consider the non-Windows GDI implementation as a primary target,
      WMF has many "corner case" records for which an implementation's
      processing may not have received the same level of scrutiny as the
      Windows implementation.  "Fuzzing" the implementation is
      appropriate.

      As a "basic" image format, the image/wmf media type does not
      employ executable content and provides no facilities for privacy
      or integrity.

   Interoperability considerations:

      Windows Metafile is the original 16-bit metafile format; it was
      released in 1990 at what some computer historians might consider
      the "zenith" of the desktop publishing revolution.  Accordingly,
      there is a large body of free and commercially available clip art
      that is still in use, either independently or embedded in
      productivity documents (word processing documents, desktop
      publishing documents, slideshows, presentations, spreadsheets, and
      workbooks).  For example, references to WMF content appear (non-
      normatively) in Office Open XML.  To say that support for this
      format is necessary for interoperability would not be an
      understatement.

      Accommodations for comments or arbitrary data storage in Windows
      Metafiles are virtually non-existent.  However, Windows Metafiles
      can contain Enhanced Metafiles using the
      META_ESCAPE_ENHANCED_METAFILE record, so an implementation that
      handles Windows Metafiles is also expected to handle enhanced
      metafile content.  Windows Metafiles can store and output text
      strings (see META_TEXTOUT and META_EXTTEXTOUT records), but the
      encodings of the strings may be ambiguous.  Unicode encodings are
      not possible without the DEFAULT_CHARSET parameter defined in this
      registration.

      The previously unregistered type image/x-wmf is also in wide use.
      Accordingly, it is registered as a deprecated alias.

   Published specification:

      WMF: Microsoft Corporation, "[<a href="#ref-MS-WMF" title='"[MS-WMF]: Windows Metafile Format"'>MS-WMF</a>]: Windows Metafile Format",
      v20160714 (Rev 13.1), July 2016,
      &lt;<a href="http://msdn.microsoft.com/library/cc250370">http://msdn.microsoft.com/library/cc250370</a>&gt;.



<span class="grey">Leonard                       Informational                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7903.html">RFC 7903</a>                Windows Image Media Types         September 2016</span>


   Applications that use this media type:

      Office productivity applications; clip art applications; desktop
      publishing applications; some web browsers (e.g., Internet
      Explorer).

   Fragment identifier considerations: None.

   Additional information:

      Deprecated alias names for this type: image/x-wmf

      Magic number(s): D7 CD C6 9A (little-endian DWORD 0x9AC6CDD7)

      File extension(s): .wmf

      Macintosh file type code(s):
         None.  A uniform type identifier (UTI) of "com.microsoft.wmf"
         is suggested.

   Person &amp; email address to contact for further information:

      Sean Leonard &lt;dev+ietf@seantek.com&gt;

   Restrictions on usage: None.

   Author/Change controller: Sean Leonard &lt;dev+ietf@seantek.com&gt;

   Intended usage: COMMON

   Provisional registration? No

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Enhanced%20Metafile%20Media%20Type%20Registration%20Application"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Enhanced Metafile Media Type Registration Application</span>

   Type name: image

   Subtype name: emf

   Required parameters: None.

   Optional parameters: None.

   Encoding considerations: Binary.








<span class="grey">Leonard                       Informational                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7903.html">RFC 7903</a>                Windows Image Media Types         September 2016</span>


   Security considerations:

      Enhanced Metafiles are not afflicted with the Metafile Image Code
      Execution ("MICE") vulnerability.  There has been no public
      disclosure of vulnerabilities specific to EMF or EMF+ to date.
      Neither EMF nor EMF+ are designed to contain "active content".
      Nonetheless, Enhanced Metafiles can contain Encapsulated
      PostScript (EPS) data; thus, the security considerations of
      PostScript processing may also apply to EMF.

      As the original intent was to replicate Windows GDI calls, flaws
      in GDI, or in a display or printer driver implementing the backend
      to GDI, could be exploitable with maliciously crafted EMF content.
      EMF implementations not backed by Windows GDI have different
      risks: namely, while a malicious EMF author may not consider the
      non-Windows GDI implementation as a primary target, EMF has many
      "corner case" records for which an implementation's processing may
      not have received the same level of scrutiny as the Windows
      implementation.  "Fuzzing" the implementation is appropriate.  It
      is also possible that EMF+ data is "safe" while EMF data contains
      an exploit (or vice versa); the EMF+-aware implementation (such as
      an application designed for GDI+ on Windows XP or above) would
      skip the "unsafe" data while another implementation would fall
      prey to the exploit.

      As a "basic" image format, the image/emf media type does not
      employ executable content and provides no facilities for privacy
      or integrity.

   Interoperability considerations:

      Enhanced Metafile is the 32-bit metafile format; it was released
      in 1992 along with Windows NT 3.1.  There is a large body of free
      and commercially available clip art that is still in use, either
      independently or embedded in productivity documents (word
      processing documents, desktop publishing documents, slideshows,
      presentations, spreadsheets, and workbooks).  To say that support
      for this format is necessary for interoperability would not be an
      understatement.

      Enhanced Metafiles have extensive accommodations for comments and
      arbitrary data storage.  Enhanced Metafiles can store and output
      text strings.  Mercifully, the encodings of these strings are
      well-defined.  Record examples include EMR_EXTTEXTOUTA (US-ASCII),
      EMR_EXTTEXTOUTW (UTF16-LE), EMR_POLYTEXTOUTA (US-ASCII),
      EMR_POLYTEXTOUTW (UTF16-LE), and EMR_SMALLTEXTOUT (UTF16-LE or the
      low-order 8 bits of UTF16-LE -- effectively ISO-8859-1 --
      depending on ETO_SMALL_CHARS).



<span class="grey">Leonard                       Informational                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7903.html">RFC 7903</a>                Windows Image Media Types         September 2016</span>


      Enhanced Metafiles can contain Encapsulated PostScript (EPS) data
      in the EpsData object.  The FormatSignature EPS_SIGNATURE
      (0x46535045, in little-endian) is used instead of
      ENHMETA_SIGNAUTRE (0x464D4520, in little-endian) in such a case.

      Windows XP introduced the GDI+ API, along with EMF+.  EMF+ is
      actually an embedded format in which GDI+ commands are stored as
      EMF comment records (EMR_COMMENT_EMFPLUS record type).  Content
      containing EMF+ data can be identified as "EMF+ Only" (only EMF+;
      the EMF records are not sufficient to reconstitute the drawing) or
      "EMF+ Dual" (both EMF records alone or EMF+ records alone, when
      played back, are sufficient to reconstitute the drawing).  Support
      for EMF+ records may not be as extensive as support for the
      original EMF records.

      The previously unregistered type image/x-emf is also in wide use.
      Accordingly, it is registered as a deprecated alias.

   Published specification:

      EMF: Microsoft Corporation, "[<a href="#ref-MS-EMF" title='"[MS-EMF]: Enhanced Metafile Format"'>MS-EMF</a>]: Enhanced Metafile Format",
      v20160714 (Rev 12.0), July 2016,
      &lt;<a href="http://msdn.microsoft.com/library/cc230514">http://msdn.microsoft.com/library/cc230514</a>&gt;.

      EMF+: Microsoft Corporation, "[MS-EMFPLUS]: Enhanced Metafile
      Format Plus Extensions", v20160714 (Rev 14.1), July 2016,
      &lt;<a href="http://msdn.microsoft.com/library/cc230724">http://msdn.microsoft.com/library/cc230724</a>&gt;.

   Applications that use this media type:

      Office productivity applications; clip art applications; desktop
      publishing applications; some web browsers (e.g., Internet
      Explorer).

   Fragment identifier considerations: None.

   Additional information:

      Deprecated alias names for this type: image/x-emf

      Magic number(s):
         01 00 00 00 (little-endian DWORD 0x00000001), corresponding to
         the EMR_HEADER Type field.
         The next field (EMR_HEADER Size) should be at least 88 (little-
         endian DWORD 0x00000050).

      File extension(s): .emf (for both EMF and EMF+ content)




<span class="grey">Leonard                       Informational                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7903.html">RFC 7903</a>                Windows Image Media Types         September 2016</span>


      Macintosh file type code(s):
         None.  A uniform type identifier (UTI) of "com.microsoft.emf"
         is suggested.

   Person &amp; email address to contact for further information:

      Sean Leonard &lt;dev+ietf@seantek.com&gt;

   Restrictions on usage: None.

   Author/Change controller: Sean Leonard &lt;dev+ietf@seantek.com&gt;

   Intended usage: COMMON

   Provisional registration? No

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Windows%20Bitmap%20Media%20Type%20Registration%20Application"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Windows Bitmap Media Type Registration Application</span>

   Type name: image

   Subtype name: bmp

   Required parameters: None.

   Optional parameters: None.

   Encoding considerations: Binary.

   Security considerations:

      Bitmaps have a mostly unremarkable security history.

      Because BMP data can encapsulate JPEG or PNG data (BI_JPEG, BI_PNG
      values of the Compression enumeration in <a href="#section-2.1.1.7">Section 2.1.1.7</a> of the
      WMF specification), the security considerations of JPEG and PNG
      processing may also apply to BMP.

      As a "basic" image format, the image/bmp media type does not
      employ executable content and provides no facilities for privacy
      or integrity.

   Interoperability considerations:

      Uncompressed Windows Bitmaps can be rather large.  If there is a
      need to compress an image, modern applications should consider
      emitting JPEG or PNG data instead of embedding them in BMP
      payloads.




<span class="grey">Leonard                       Informational                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7903.html">RFC 7903</a>                Windows Image Media Types         September 2016</span>


   Published specification:

      WMF: Microsoft Corporation, "[<a href="#ref-MS-WMF" title='"[MS-WMF]: Windows Metafile Format"'>MS-WMF</a>]: Windows Metafile Format",
      v20160714 (Rev 13.1), July 2016,
      &lt;<a href="http://msdn.microsoft.com/library/cc250370">http://msdn.microsoft.com/library/cc250370</a>&gt;.

      BMP: Microsoft Corporation, "Bitmap Storage", MSDN ID dd183391,
      &lt;<a href="http://msdn.microsoft.com/library/dd183391">http://msdn.microsoft.com/library/dd183391</a>&gt;.

   Applications that use this media type:

      Office productivity applications; clip art applications; desktop
      publishing applications; web browsers; graphics processing
      applications.

   Fragment identifier considerations: None.

   Additional information:

      Magic number(s):
         42 4D ("BM"), meaning "bitmap".  The next field
         (BITMAPFILEHEADER bfSize) is a little-endian DWORD indicating
         the size of the bitmap content in bytes.

      File extension(s): .bmp, .dib

      Macintosh file type code(s):
         "BMP ", "BMPf", or "BMPp".  Apple has promulgated a uniform
         type identifier (UTI) of "com.microsoft.bmp".

   Person &amp; email address to contact for further information:

      Sean Leonard &lt;dev+ietf@seantek.com&gt;

   Restrictions on usage: None.

   Author/Change controller: Sean Leonard &lt;dev+ietf@seantek.com&gt;

   Intended usage: COMMON

   Provisional registration? No










<span class="grey">Leonard                       Informational                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7903.html">RFC 7903</a>                Windows Image Media Types         September 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  IANA Considerations</span>

   IANA has registered the media types image/wmf, image/x-wmf,
   image/emf, image/x-emf, and image/bmp in the standards tree using the
   applications provided in Sections <a href="#section-2">2</a>, <a href="#section-3">3</a>, and <a href="#section-4">4</a> of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Security Considerations</span>

   See the registration templates for their respective security
   considerations.

   The Metafile Image Code Execution (MICE) vulnerability won the 2007
   Pwnie Award for "Mass 0wnage" and "Breaking the Internet" [<a href="#ref-PWNIES07" title='"Winners of Pwnie Awards 2007"'>PWNIES07</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20References"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Normative%20References"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-BMPSTOR" name="ref-BMPSTOR">BMPSTOR</a>]  Microsoft Corporation, "Bitmap Storage", MSDN ID dd183391,
              &lt;<a href="http://msdn.microsoft.com/library/dd183391">http://msdn.microsoft.com/library/dd183391</a>&gt;.

   [<a id="ref-MS-EMF" name="ref-MS-EMF">MS-EMF</a>]   Microsoft Corporation, "[<a href="#ref-MS-EMF" title='"[MS-EMF]: Enhanced Metafile Format"'>MS-EMF</a>]: Enhanced Metafile
              Format", v20160714 (Rev 12.0), July 2016,
              &lt;<a href="http://msdn.microsoft.com/library/cc230514">http://msdn.microsoft.com/library/cc230514</a>&gt;.

   [MS-EMF+]  Microsoft Corporation, "[MS-EMFPLUS]: Enhanced Metafile
              Format Plus Extensions", v20160714 (Rev 14.1), July 2016,
              &lt;<a href="http://msdn.microsoft.com/library/cc230724">http://msdn.microsoft.com/library/cc230724</a>&gt;.

   [<a id="ref-MS-WMF" name="ref-MS-WMF">MS-WMF</a>]   Microsoft Corporation, "[<a href="#ref-MS-WMF" title='"[MS-WMF]: Windows Metafile Format"'>MS-WMF</a>]: Windows Metafile
              Format", v20160714 (Rev 13.1), July 2016,
              &lt;<a href="http://msdn.microsoft.com/library/cc250370">http://msdn.microsoft.com/library/cc250370</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Informative%20References"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-MICE" name="ref-MICE">MICE</a>]     Microsoft Corporation, "Vulnerability in Graphics
              Rendering Engine Could Allow Remote Code Execution
              (912919)", MS06-001, V1.0, January 2006,
              &lt;<a href="https://technet.microsoft.com/library/security/ms06-001">https://technet.microsoft.com/library/security/ms06-001</a>&gt;.

   [<a id="ref-MS-OSP" name="ref-MS-OSP">MS-OSP</a>]   Microsoft Corporation, "Open Specification Promise",
              February 2007, &lt;<a href="https://msdn.microsoft.com/en-us/openspecifications/dn646765">https://msdn.microsoft.com/</a>
              <a href="https://msdn.microsoft.com/en-us/openspecifications/dn646765">en-us/openspecifications/dn646765</a>&gt;.

   [<a id="ref-OOXML" name="ref-OOXML">OOXML</a>]    Ecma International, "Office Open XML File Formats",
              Standard ECMA-376, Fourth Edition, ISO/IEC 29500, December
              2012, &lt;<a href="http://www.ecma-international.org/publications/standards/Ecma-376.htm">http://www.ecma-international.org/publications/</a>
              <a href="http://www.ecma-international.org/publications/standards/Ecma-376.htm">standards/Ecma-376.htm</a>&gt;.



<span class="grey">Leonard                       Informational                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7903.html">RFC 7903</a>                Windows Image Media Types         September 2016</span>


   [<a id="ref-PWNIES07" name="ref-PWNIES07">PWNIES07</a>] Pwnie Awards LLC, "Winners of Pwnie Awards 2007", 2007,
              &lt;<a href="http://pwnies.com/archive/2007/winners/">http://pwnies.com/archive/2007/winners/</a>&gt;.

Author's Address

   Sean Leonard
   Penango, Inc.
   5900 Wilshire Boulevard
   21st Floor
   Los Angeles, CA  90036
   United States of America

   Email: dev+ietf@seantek.com
   URI:   <a href="http://www.penango.com/">http://www.penango.com/</a>





































Leonard                       Informational                    [Page 12]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7903 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:18 GMT --></html>