<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7562 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:21 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:7562" name="DC.Identifier"/>
<meta content="This document specifies the use of Digital Transmission Content
Protection (DTCP) certificates as an authorization data type in the
authorization extension for the Transport Layer Security (TLS)
protocol. This is in accordance with the guidelines for authorization
extensions as specified in RFC 5878. As with other TLS extensions,
this authorization data can be included in the client and server hello
messages to confirm that both parties support the desired
authorization data types. If supported by both the client and the
server, DTCP certificates are exchanged in the supplemental data TLS
handshake message as specified in RFC 4680. This authorization data
type extension is in support of devices containing DTCP certificates
issued by the Digital Transmission Licensing Administrator (DTLA)." name="DC.Description.Abstract"/>
<meta content="Darshak Thakore &lt;d.thakore@cablelabs.com&gt;" name="DC.Creator"/>
<meta content="July, 2015" name="DC.Date.Issued"/>
<meta content="Transport Layer Security (TLS) Authorization Using Digital Transmission Content Protection (DTCP) Certificates" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7562 - Transport Layer Security (TLS) Authorization Using Digital Transmission Content Protection (DTCP) Certificates</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7562.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7562" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-dthakore-tls-authz" title="draft-dthakore-tls-authz">draft-dthakore-...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7562" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7562" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7562" title="Side-by-side diff">Diff2</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=7562&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>]   </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Independent Submission                                        D. Thakore
Request for Comments: 7562                                     CableLabs
Category: Informational                                        July 2015
ISSN: 2070-1721


           <span class="h1">Transport Layer Security (TLS) Authorization Using</span>
      <span class="h1">Digital Transmission Content Protection (DTCP) Certificates</span>

Abstract

   This document specifies the use of Digital Transmission Content
   Protection (DTCP) certificates as an authorization data type in the
   authorization extension for the Transport Layer Security (TLS)
   protocol.  This is in accordance with the guidelines for
   authorization extensions as specified in <a href="rfc5878.html">RFC 5878</a>.  As with other TLS
   extensions, this authorization data can be included in the client and
   server hello messages to confirm that both parties support the
   desired authorization data types.  If supported by both the client
   and the server, DTCP certificates are exchanged in the supplemental
   data TLS handshake message as specified in <a href="rfc4680.html">RFC 4680</a>.  This
   authorization data type extension is in support of devices containing
   DTCP certificates issued by the Digital Transmission Licensing
   Administrator (DTLA).

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This is a contribution to the RFC Series, independently of any other
   RFC stream.  The RFC Editor has chosen to publish this document at
   its discretion and makes no statement about its value for
   implementation or deployment.  Documents approved for publication by
   the RFC Editor are not a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7562">http://www.rfc-editor.org/info/rfc7562</a>.











<span class="grey">Thakore                       Informational                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7562.html">RFC 7562</a>                   TLS Auth Using DTCP                 July 2015</span>


Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Applicability Statement ....................................<a href="#page-3">3</a>
      <a href="#section-1.2">1.2</a>. Conventions ................................................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. Overview ........................................................<a href="#page-4">4</a>
      <a href="#section-2.1">2.1</a>. Overview of DTCP Certificates ..............................<a href="#page-4">4</a>
      <a href="#section-2.2">2.2</a>. Overview of SupplementalData Handshake .....................<a href="#page-5">5</a>
      <a href="#section-2.3">2.3</a>. Overview of Authorization Extensions .......................<a href="#page-5">5</a>
      <a href="#section-2.4">2.4</a>. Overview of SupplementalData Usage for Authorization .......<a href="#page-6">6</a>
   <a href="#section-3">3</a>. DTCP Authorization Data Format ..................................<a href="#page-6">6</a>
      <a href="#section-3.1">3.1</a>. DTCP Authorization Type ....................................<a href="#page-6">6</a>
      <a href="#section-3.2">3.2</a>. DTCP Authorization Data ....................................<a href="#page-6">6</a>
      3.3. Usage Rules for Clients to Exchange DTCP
           Authorization Data .........................................<a href="#page-7">7</a>
      3.4. Usage Rules for Servers to Exchange DTCP
           Authorization Data .........................................<a href="#page-8">8</a>
      <a href="#section-3.5">3.5</a>. TLS Message Exchange with dtcp_authz_data ..................<a href="#page-8">8</a>
      <a href="#section-3.6">3.6</a>. Alert Messages .............................................<a href="#page-9">9</a>
   <a href="#section-4">4</a>. IANA Considerations ............................................<a href="#page-10">10</a>
   <a href="#section-5">5</a>. Security Considerations ........................................<a href="#page-10">10</a>
   <a href="#section-6">6</a>. References .....................................................<a href="#page-11">11</a>
      <a href="#section-6.1">6.1</a>. Normative References ......................................<a href="#page-11">11</a>
      <a href="#section-6.2">6.2</a>. Informative References ....................................<a href="#page-12">12</a>
   <a href="#appendix-A">Appendix A</a>. Alternate Double Handshake Example ....................<a href="#page-13">13</a>
   Acknowledgements ..................................................<a href="#page-15">15</a>
   Author's Address ..................................................<a href="#page-15">15</a>












<span class="grey">Thakore                       Informational                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7562.html">RFC 7562</a>                   TLS Auth Using DTCP                 July 2015</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The Transport Layer Security (TLS) protocol (see TLS 1.0 [<a href="rfc2246.html" title='"The TLS Protocol Version 1.0"'>RFC2246</a>],
   TLS 1.1 [<a href="rfc4346.html" title='"The Transport Layer Security (TLS) Protocol Version 1.1"'>RFC4346</a>], and TLS1 .2 [<a href="rfc5246.html" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>RFC5246</a>]) is being used in an ever
   increasing variety of operational environments, the most common among
   which is its use in securing HTTP traffic [<a href="rfc2818.html" title='"HTTP Over TLS"'>RFC2818</a>].  [<a href="rfc5878.html" title='"Transport Layer Security (TLS) Authorization Extensions"'>RFC5878</a>]
   introduces extensions that enable TLS to operate in environments
   where authorization information needs to be exchanged between the
   client and the server before any protected data is exchanged.  The
   use of these TLS authorization extensions is especially attractive
   since it allows the client and server to determine the type of
   protected data to exchange based on the authorization information
   received in the extensions.

   A substantial number of deployed consumer electronics devices, such
   as televisions, tablets, game consoles, set-top boxes, and other
   multimedia devices, contain Digital Transmission Content Protection
   [<a href="#ref-DTCP" title='"Digital Transmission Content Protection Specification"'>DTCP</a>] certificates issued by [<a href="#ref-DTLA" title='"DTLA"'>DTLA</a>].  These DTCP certificates enable
   secure transmission of premium audiovisual content between devices
   over various types of links (e.g., DTCP over IP [<a href="#ref-DTCP-IP" title='"Mapping DTCP to IP"'>DTCP-IP</a>]).  These
   DTCP certificates can also be used to verify device functionality
   (e.g., supported device features).

   This document describes the format and necessary identifiers to
   exchange DTCP certificates within the supplemental data message (see
   [<a href="rfc4680.html" title='"TLS Handshake Message for Supplemental Data"'>RFC4680</a>]) while negotiating a TLS session.  The DTCP certificates
   are then used independent of their use for content protection (e.g.,
   to verify supported features) and the corresponding DTCP
   Authentication and Key Exchange (AKE) protocol.  This communication
   allows either the client, the server, or both to perform certain
   actions or provide specific services.  The actual semantics of the
   authorization decision by the client/server are beyond the scope of
   this document.  The DTCP certificate, which is not an X.509
   certificate, can be cryptographically tied to the X.509 certificate
   being used during the TLS tunnel establishment by an Elliptic Curve
   Digital Signature Algorithm (EC-DSA) [<a href="#ref-DTCP" title='"Digital Transmission Content Protection Specification"'>DTCP</a>] signature.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Applicability%20Statement"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Applicability Statement</span>

   DTCP-enabled consumer electronics devices (e.g., televisions, game
   consoles) use DTCP certificates for secure transmission of
   audiovisual content.  The AKE protocol defined in [<a href="#ref-DTCP" title='"Digital Transmission Content Protection Specification"'>DTCP</a>] is used to
   exchange DTCP certificates and allows a device to be identified and
   authenticated based on the information in the DTCP certificate.
   However, these DTCP-enabled devices offer additional functionality
   (e.g., via HTML5 User Agents or web-enabled applications) that is
   distinct from its capability to transmit and play audiovisual
   content.  The mechanism outlined in this document allows a DTCP-



<span class="grey">Thakore                       Informational                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7562.html">RFC 7562</a>                   TLS Auth Using DTCP                 July 2015</span>


   enabled consumer electronics device to authenticate and authorize
   using its DTCP certificate when accessing services over the internet;
   for example, web applications on televisions that can enable value-
   added services.  This is anticipated to be very valuable since there
   are a considerable number of such devices.  The reuse of well-known
   web security will also keep such communication consistent with
   existing standards and best practices.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Conventions"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Conventions</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Overview"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Overview</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Overview%20of%20DTCP%20Certificates"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Overview of DTCP Certificates</span>

   DTCP certificates issued by [<a href="#ref-DTLA" title='"DTLA"'>DTLA</a>] to DTLA-compliant devices come in
   three general variations (see Section 4.2.3.1 of [<a href="#ref-DTCP" title='"Digital Transmission Content Protection Specification"'>DTCP</a>]):

   o  Restricted Authentication device certificate format (Format 0):
      Typically issued to devices with limited computation resources.

   o  Baseline Full Authentication device certificate format (Format 1):
      This is the most commonly issued certificate format.  Format 1
      certificates include a unique DeviceID and device EC-DSA public/
      private key pair generated by the DTLA.  (See Section 4.3 of
      [<a href="#ref-DTCP" title='"Digital Transmission Content Protection Specification"'>DTCP</a>]).

   o  Extended Full Authentication device certificate format (Format 2):
      This is issued to devices that possess additional functions (e.g.,
      additional channel ciphers, specific device properties).  The
      presence of these additional functions is indicated by the device
      capability mask as specified in Section 4.2.3.2 of [<a href="#ref-DTCP" title='"Digital Transmission Content Protection Specification"'>DTCP</a>].  Format
      2 certificates also include a unique DeviceID and device EC-DSA
      public/private key pair generated by the DTLA (see Section 4.3 of
      [<a href="#ref-DTCP" title='"Digital Transmission Content Protection Specification"'>DTCP</a>]).

   The mechanism specified in this document allows only Formats 1 and 2
   DTCP certificates to be exchanged in the supplemental data message
   since it requires the use of the EC-DSA private key associated with
   the certificate.








<span class="grey">Thakore                       Informational                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7562.html">RFC 7562</a>                   TLS Auth Using DTCP                 July 2015</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Overview%20of%20SupplementalData%20Handshake"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Overview of SupplementalData Handshake</span>

   Figure 1 illustrates the exchange of the SupplementalData message
   during the TLS handshake as specified in [<a href="rfc4680.html" title='"TLS Handshake Message for Supplemental Data"'>RFC4680</a>] (repeated here for
   convenience):

        Client                                               Server

        ClientHello (with extensions) --------&gt;

                                       ServerHello(with extensions)
                                                  SupplementalData*
                                                       Certificate*
                                                 ServerKeyExchange*
                                                CertificateRequest*
                                     &lt;--------      ServerHelloDone

        SupplementalData*
        Certificate*
        ClientKeyExchange
        CertificateVerify*
        [ChangeCipherSpec]
        Finished                     --------&gt;
                                                 [ChangeCipherSpec]
                                     &lt;--------             Finished
        Application Data             &lt;-------&gt;     Application Data

        *  Indicates optional or situation-dependent messages that are
           not always sent.

        [] Indicates that ChangeCipherSpec is an independent TLS
           protocol content type; it is not a TLS handshake message.

      Figure 1: TLS Handshake Message Exchange with SupplementalData

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20Overview%20of%20Authorization%20Extensions"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  Overview of Authorization Extensions</span>

   [<a id="ref-RFC5878" name="ref-RFC5878">RFC5878</a>] defines two authorization extension types that are used in
   the ClientHello and ServerHello messages and are repeated below for
   convenience:

         enum {
           client_authz(7), server_authz(8), (65535)
         } ExtensionType;

   A client uses the client_authz and server_authz extensions in the
   ClientHello message to indicate that it will send client
   authorization data and receive server authorization data,



<span class="grey">Thakore                       Informational                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7562.html">RFC 7562</a>                   TLS Auth Using DTCP                 July 2015</span>


   respectively, in the SupplementalData messages.  A server uses the
   extensions in a similar manner in its ServerHello message.  [<a href="rfc5878.html" title='"Transport Layer Security (TLS) Authorization Extensions"'>RFC5878</a>]
   also establishes a registry that is maintained by IANA to register
   authorization data formats.  This document defines a new
   authorization data type for both the client_authz and server_authz
   extensions and allows the client and server to exchange DTCP
   certificates in the SupplementalData message.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.4.%20%20Overview%20of%20SupplementalData%20Usage%20for%20Authorization"></a><a class="selflink" href="#section-2.4" name="section-2.4">2.4</a>.  Overview of SupplementalData Usage for Authorization</span>

   <a href="rfc5878.html#section-3">Section 3 of [RFC5878]</a> specifies the syntax of the supplemental data
   message when carrying the authz_data message that is negotiated in
   the client_authz and/or server_authz types.  This document defines a
   new authorization data format that is used in the authz_data message
   when sending DTCP Authorization Data.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20DTCP%20Authorization%20Data%20Format"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  DTCP Authorization Data Format</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20DTCP%20Authorization%20Type"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  DTCP Authorization Type</span>

   The DTCP Authorization type definition in the TLS Authorization Data
   Formats registry is:

          dtcp_authorization(66);

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20DTCP%20Authorization%20Data"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  DTCP Authorization Data</span>

   The DTCP Authorization Data is used when the AuthzDataFormat type is
   dtcp_authorization.  The syntax of the authorization data is:

         struct {
             opaque random_bytes[32];
         } RandomNonce;

         struct {
             opaque RandomNonce nonce;
             opaque DTCPCert&lt;0..2^24-1&gt;;
             opaque ASN.1Cert&lt;0..2^24-1&gt;;
             opaque signature&lt;0..2^16-1&gt;;
         } dtcp_authz_data;

   RandomNonce is generated by the server and consists of 32 bytes
   generated by a high-quality, secure random number generator.  The
   client always sends back the server-generated RandomNonce in its
   dtcp_authz_data structure.  The RandomNonce helps the server in
   detecting replay attacks.  A client can detect replay attacks by





<span class="grey">Thakore                       Informational                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7562.html">RFC 7562</a>                   TLS Auth Using DTCP                 July 2015</span>


   associating the ASN.1 certificate in the dtcp_authz_data structure
   with the certificate received in the Certificate message of the TLS
   handshake, so a separate nonce for the client is not required.

   DTCPCert is the sender's DTCP certificate.  See <a href="#section-4.2.3.1">Section 4.2.3.1</a> of
   the DTCP Specification [<a href="#ref-DTCP" title='"Digital Transmission Content Protection Specification"'>DTCP</a>].

   ASN.1Cert is the sender's certificate used to establish the TLS
   session, i.e., it is sent in the Certificate or ClientCertificate
   message using the Certificate structure defined in <a href="rfc5246.html#section-7.4.2">Section 7.4.2 of
   [RFC5246]</a>.

   The DTCPCert and ASN.1Cert are variable-length vectors as specified
   in <a href="rfc5246.html#section-4.3">Section 4.3 of [RFC5246]</a>.  Hence, the actual length precedes the
   vector's contents in the byte stream.  If the ASN.1Cert is not being
   sent, the ASN.1Cert_length MUST be zero.

   dtcp_authz_data contains the RandomNonce, the DTCP certificate, and
   the optional ASN.1 certificate.  This is then followed by the digital
   signature covering the RandomNonce, the DTCP certificate, and the
   ASN.1 certificate (if present).  The signature is generated using the
   private key associated with the DTCP certificate and using the
   Signature Algorithm and Hash Algorithm as specified in Section 4.4 of
   [<a href="#ref-DTCP" title='"Digital Transmission Content Protection Specification"'>DTCP</a>].  This signature provides proof of the possession of the
   private key by the sender.  A sender sending its own DTCP certificate
   MUST populate this field.  The length of the signature field is
   determined by the Signature Algorithm and Hash Algorithm as specified
   in Section 4.4 of [<a href="#ref-DTCP" title='"Digital Transmission Content Protection Specification"'>DTCP</a>], and so it is not explicitly encoded in the
   dtcp_authz_data structure (e.g., the length will be 40 bytes for a
   SHA1+ECDSA algorithm combination).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Usage%20Rules%20for%20Clients%20to%20Exchange%20DTCP%20Authorization%20Data"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Usage Rules for Clients to Exchange DTCP Authorization Data</span>

   A client includes both the client_authz and server_authz extensions
   in the extended client hello message when indicating its desire to
   exchange dtcp_authorization data with the server.  Additionally, the
   client includes the AuthzDataFormat type specified in <a href="#section-3.1">Section 3.1</a> in
   the extension_data field to specify the format of the authorization
   data.

   A client will receive the server's dtcp_authz_data before it sends
   its own dtcp_authz_data.  When sending its own dtcp_authz_data
   message, the client includes the same RandomNonce that it receives in
   the server's dtcp_authz_data message.  Clients MUST include its DTCP
   certificate in the dtcp_authz_data message.  A client MAY include its
   ASN.1 certificate (certificate in the ClientCertificate message) in





<span class="grey">Thakore                       Informational                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7562.html">RFC 7562</a>                   TLS Auth Using DTCP                 July 2015</span>


   the ASN.1Cert field of the dtcp_authz_data to cryptographically tie
   the dtcp_authz_data with its ASN.1Cert being used to establish the
   TLS session (i.e., sent in the ClientCertificate message).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Usage%20Rules%20for%20Servers%20to%20Exchange%20DTCP%20Authorization%20Data"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Usage Rules for Servers to Exchange DTCP Authorization Data</span>

   A server responds with both the client_authz and server_authz
   extensions in the extended server hello message when indicating its
   desire to exchange dtcp_authorization data with the client.

   Additionally, the server includes the AuthzDataFormat type specified
   in <a href="#section-3.1">Section 3.1</a> in the extension_data field to specify the format of
   the dtcp_authorization data.  A client may or may not include an
   ASN.1 certificate during the TLS handshake.  However, the server will
   not know that at the time of sending the SupplementalData message.
   Hence, a server MUST generate and populate the RandomNonce in the
   dtcp_authz_data message.  If the client's hello message does not
   contain both the client_authz and server_authz extensions with
   dtcp_authorization type, the server MUST NOT include support for
   dtcp_authorization data in its hello message.  A server MAY include
   its DTCP certificate in the dtcp_authz_data message.  If the server
   does not send a DTCP certificate, it will send only the RandomNonce
   in its dtcp_authz_data message.  If the server includes its DTCP
   certificate, it MUST also include its server certificate (sent in the
   TLS Certificate message) in the certs field to cryptographically tie
   its dtcp_authz_data with the ASN.1 certificate used in the TLS
   session being established.  This also helps the client in detecting
   replay attacks.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.5.%20%20TLS%20Message%20Exchange%20with%20dtcp_authz_data"></a><a class="selflink" href="#section-3.5" name="section-3.5">3.5</a>.  TLS Message Exchange with dtcp_authz_data</span>

   Based on the usage rules in the sections above, Figure 2 provides one
   possible TLS message exchange where the client sends its DTCP
   certificate to the server within the dtcp_authz_data message.

















<span class="grey">Thakore                       Informational                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7562.html">RFC 7562</a>                   TLS Auth Using DTCP                 July 2015</span>


        Client                                               Server

        ClientHello (with extensions) --------&gt;

                                       ServerHello(with extensions)
                                    SupplementalData(with Nonce N1)
                                                        Certificate
                                                 ServerKeyExchange*
                                                 CertificateRequest
                                     &lt;--------      ServerHelloDone

        SupplementalData(with Data D1)
        Certificate
        ClientKeyExchange
        CertificateVerify
        [ChangeCipherSpec]
        Finished                     --------&gt;
                                                 [ChangeCipherSpec]
                                     &lt;--------             Finished
        Application Data             &lt;-------&gt;     Application Data

      N1 Indicates a Random nonce generated by server

      D1 Contains dtcp_authz_data populated with the following
        {(N1, DTCP Cert, Client X.509 Cert) Signature over all elements}

      *  Indicates optional or situation-dependent messages that are
         not always sent.

      [] Indicates that ChangeCipherSpec is an independent TLS
         protocol content type; it is not a TLS handshake message.

                 Figure 2: DTCP SupplementalData Exchange

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.6.%20%20Alert%20Messages"></a><a class="selflink" href="#section-3.6" name="section-3.6">3.6</a>.  Alert Messages</span>

   This document reuses TLS Alert messages for any errors that arise
   during authorization processing and reuses the AlertLevels as
   specified in [<a href="rfc5878.html" title='"Transport Layer Security (TLS) Authorization Extensions"'>RFC5878</a>].  Additionally, the following AlertDescription
   values are used to report errors in dtcp_authorization processing:

   unsupported_extension:
      During processing of dtcp_authorization, a client uses this when
      it receives a server hello message that includes support for
      dtcp_authorization in only one of client_authz or server_authz but
      not in both the extensions.  This message is always fatal.  Note:





<span class="grey">Thakore                       Informational                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7562.html">RFC 7562</a>                   TLS Auth Using DTCP                 July 2015</span>


      Completely omitting the dtcp_authorization extension and/or
      omitting the client_authz and server_authz completely is allowed
      and should not constitute the reason that this alert is sent.

   certificate_unknown:
      During processing of dtcp_authorization, a client or server uses
      this when it has received an X.509 certificate in the
      dtcp_authorization data and that X.509 certificate does not match
      the certificate sent in the corresponding ClientCertificate or
      Certificate message.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  IANA Considerations</span>

   This document includes an entry registered in the IANA-maintained
   "TLS Authorization Data Formats" registry for dtcp_authorization(66).
   This registry is defined in [<a href="rfc5878.html" title='"Transport Layer Security (TLS) Authorization Extensions"'>RFC5878</a>] and defines two ranges: one is
   IETF Review, and the other is Specification Required.  The value for
   dtcp_authorization should be assigned via [<a href="rfc5226.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC5226</a>] Specification
   Required.  The extension defined in this document is compatible with
   Data Transport Layer Security (DTLS) [<a href="rfc6347.html" title='"Datagram Transport Layer Security Version 1.2"'>RFC6347</a>], and the registry
   assignment has been marked "Y" for DTLS-OK.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Security%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Security Considerations</span>

   The dtcp_authorization data, as specified in this document, carries
   the DTCP certificate that identifies the associated device.
   Inclusion of the X.509 certificate being used to establish a TLS
   Session in the dtcp_authorization data allows an application to
   cryptographically tie them.  However, a TLS Client is not required to
   use (and may not possess) an X.509 certificate.  In this case, the
   dtcp_authorization data exchange is prone to a man-in-the-middle
   (MITM) attack.  In such situations, a TLS server MUST deny access to
   the application features dependent on the DTCP certificate or use a
   double handshake.  The double handshake mechanism is also vulnerable
   to the TLS MITM Renegotiation exploit as explained in [<a href="rfc5746.html" title='"Transport Layer Security (TLS) Renegotiation Indication Extension"'>RFC5746</a>].  In
   order to address this vulnerability, clients and servers MUST use the
   secure_renegotiation extension as specified in [<a href="rfc5746.html" title='"Transport Layer Security (TLS) Renegotiation Indication Extension"'>RFC5746</a>] when
   exchanging dtcp_authorization data.  Additionally, the renegotiation
   is also vulnerable to the Triple Handshake exploit.  To mitigate
   this, servers MUST use the same ASN.1 certificate during
   renegotiation as the one used in the initial handshake.

   It should be noted that for the double handshake to succeed, any
   extension (e.g., TLS Session Ticket [<a href="rfc5077.html" title='"Transport Layer Security (TLS) Session Resumption without Server-Side State"'>RFC5077</a>]) that results in the
   TLS handshake sequence being modified may result in failure to
   exchange SupplementalData.





<span class="grey">Thakore                       Informational                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7562.html">RFC 7562</a>                   TLS Auth Using DTCP                 July 2015</span>


   Additionally, the security considerations specified in [<a href="rfc5878.html" title='"Transport Layer Security (TLS) Authorization Extensions"'>RFC5878</a>] and
   [<a href="rfc5246.html" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>RFC5246</a>] apply to the extension specified in this document.  In
   addition, the dtcp_authorization data may be carried along with other
   supplemental data or some other authorization data and that
   information may require additional protection.  Finally, implementers
   should also reference [<a href="#ref-DTCP" title='"Digital Transmission Content Protection Specification"'>DTCP</a>] and [<a href="#ref-DTCP-IP" title='"Mapping DTCP to IP"'>DTCP-IP</a>] for more information
   regarding DTCP certificates, their usage, and associated security
   considerations.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20References"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Normative%20References"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC2246" name="ref-RFC2246">RFC2246</a>]  Dierks, T. and C. Allen, "The TLS Protocol Version 1.0",
              <a href="rfc2246.html">RFC 2246</a>, DOI 10.17487/RFC2246, January 1999,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2246">http://www.rfc-editor.org/info/rfc2246</a>&gt;.

   [<a id="ref-RFC4346" name="ref-RFC4346">RFC4346</a>]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.1", <a href="rfc4346.html">RFC 4346</a>,
              DOI 10.17487/RFC4346, April 2006,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4346">http://www.rfc-editor.org/info/rfc4346</a>&gt;.

   [<a id="ref-RFC5246" name="ref-RFC5246">RFC5246</a>]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.2", <a href="rfc5246.html">RFC 5246</a>,
              DOI 10.17487/RFC5246, August 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5246">http://www.rfc-editor.org/info/rfc5246</a>&gt;.

   [<a id="ref-RFC5746" name="ref-RFC5746">RFC5746</a>]  Rescorla, E., Ray, M., Dispensa, S., and N. Oskov,
              "Transport Layer Security (TLS) Renegotiation Indication
              Extension", <a href="rfc5746.html">RFC 5746</a>, DOI 10.17487/RFC5746, February 2010,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5746">http://www.rfc-editor.org/info/rfc5746</a>&gt;.

   [<a id="ref-RFC4680" name="ref-RFC4680">RFC4680</a>]  Santesson, S., "TLS Handshake Message for Supplemental
              Data", <a href="rfc4680.html">RFC 4680</a>, DOI 10.17487/RFC4680, October 2006,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4680">http://www.rfc-editor.org/info/rfc4680</a>&gt;.

   [<a id="ref-RFC5878" name="ref-RFC5878">RFC5878</a>]  Brown, M. and R. Housley, "Transport Layer Security (TLS)
              Authorization Extensions", <a href="rfc5878.html">RFC 5878</a>, DOI 10.17487/RFC5878,
              May 2010, &lt;<a href="http://www.rfc-editor.org/info/rfc5878">http://www.rfc-editor.org/info/rfc5878</a>&gt;.

   [<a id="ref-RFC6347" name="ref-RFC6347">RFC6347</a>]  Rescorla, E. and N. Modadugu, "Datagram Transport Layer
              Security Version 1.2", <a href="rfc6347.html">RFC 6347</a>, DOI 10.17487/RFC6347,
              January 2012, &lt;<a href="http://www.rfc-editor.org/info/rfc6347">http://www.rfc-editor.org/info/rfc6347</a>&gt;.



<span class="grey">Thakore                       Informational                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7562.html">RFC 7562</a>                   TLS Auth Using DTCP                 July 2015</span>


   [<a id="ref-DTCP" name="ref-DTCP">DTCP</a>]     Digital Transmission Licensing Administrator, "Digital
              Transmission Content Protection Specification", Volume 1,
              Informational Version,
              &lt;<a href="http://www.dtcp.com/documents/dtcp/info-20130605-dtcp-v1-rev-1-7-ed2.pdf">http://www.dtcp.com/documents/dtcp/</a>
              <a href="http://www.dtcp.com/documents/dtcp/info-20130605-dtcp-v1-rev-1-7-ed2.pdf">info-20130605-dtcp-v1-rev-1-7-ed2.pdf</a>&gt;.

   [<a id="ref-DTCP-IP" name="ref-DTCP-IP">DTCP-IP</a>]  Digital Transmission Licensing Administrator, "Mapping
              DTCP to IP", Volume 1, Supplement E, Informational
              Version, &lt;<a href="http://www.dtcp.com/documents/dtcp/info-20130605-dtcp-v1se-ip-rev-1-4-ed3.pdf">http://www.dtcp.com/documents/dtcp/</a>
              <a href="http://www.dtcp.com/documents/dtcp/info-20130605-dtcp-v1se-ip-rev-1-4-ed3.pdf">info-20130605-dtcp-v1se-ip-rev-1-4-ed3.pdf</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Informative%20References"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Informative References</span>

   [<a id="ref-RFC5226" name="ref-RFC5226">RFC5226</a>]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc5226.html">RFC 5226</a>,
              DOI 10.17487/RFC5226, May 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5226">http://www.rfc-editor.org/info/rfc5226</a>&gt;.

   [<a id="ref-DTLA" name="ref-DTLA">DTLA</a>]     Digital Transmission Licensing Administrator, "DTLA",
              &lt;<a href="http://www.dtcp.com/">http://www.dtcp.com</a>&gt;.

   [<a id="ref-RFC2818" name="ref-RFC2818">RFC2818</a>]  Rescorla, E., "HTTP Over TLS", <a href="rfc2818.html">RFC 2818</a>,
              DOI 10.17487/RFC2818, May 2000,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2818">http://www.rfc-editor.org/info/rfc2818</a>&gt;.

   [<a id="ref-RFC5077" name="ref-RFC5077">RFC5077</a>]  Salowey, J., Zhou, H., Eronen, P., and H. Tschofenig,
              "Transport Layer Security (TLS) Session Resumption without
              Server-Side State", <a href="rfc5077.html">RFC 5077</a>, DOI 10.17487/RFC5077,
              January 2008, &lt;<a href="http://www.rfc-editor.org/info/rfc5077">http://www.rfc-editor.org/info/rfc5077</a>&gt;.

   [<a id="ref-RFC6042" name="ref-RFC6042">RFC6042</a>]  Keromytis, A., "Transport Layer Security (TLS)
              Authorization Using KeyNote", <a href="rfc6042.html">RFC 6042</a>,
              DOI 10.17487/RFC6042, October 2010,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6042">http://www.rfc-editor.org/info/rfc6042</a>&gt;.

















<span class="grey">Thakore                       Informational                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc7562.html">RFC 7562</a>                   TLS Auth Using DTCP                 July 2015</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Alternate%20Double%20Handshake%20Example"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Alternate Double Handshake Example</span>

   This document specifies a TLS authorization data extension that
   allows TLS clients and servers to exchange DTCP certificates during a
   TLS handshake exchange.  In cases where the supplemental data
   contains sensitive information, the double handshake technique
   described in [<a href="rfc4680.html" title='"TLS Handshake Message for Supplemental Data"'>RFC4680</a>] can be used to provide protection for the
   supplemental data information.  The double handshake specified in
   [<a href="rfc4680.html" title='"TLS Handshake Message for Supplemental Data"'>RFC4680</a>] assumes that the client knows the context of the TLS
   session that is being set up and uses the authorization extensions as
   needed.  Figure 3 illustrates a variation of the double handshake
   that addresses the case where the client may not have a priori
   knowledge that it will be communicating with a server capable of
   exchanging dtcp_authz_data (typical for https connections; see
   [<a href="rfc2818.html" title='"HTTP Over TLS"'>RFC2818</a>]).  In Figure 3, the client's hello messages includes the
   client_authz and server_authz extensions.  The server simply
   establishes an encrypted TLS session with the client in the first
   handshake by not indicating support for any authz extensions.  The
   server initiates a second handshake by sending a HelloRequest.  The
   second handshake will include the server's support for authz
   extensions, which will result in SupplementalData being exchanged.

   Alternately, it is also possible to do a double handshake where the
   server sends the authorization extensions during both the first and
   the second handshake.  Depending on the information received in the
   first handshake, the server can decide whether or not a second
   handshake is needed.
























<span class="grey">Thakore                       Informational                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc7562.html">RFC 7562</a>                   TLS Auth Using DTCP                 July 2015</span>


     Client                                                   Server

     ClientHello (w/ extensions) --------&gt;                            |0
                                   ServerHello (no authz extensions)  |0
                                                        Certificate*  |0
                                                  ServerKeyExchange*  |0
                                                 CertificateRequest*  |0
                                 &lt;--------           ServerHelloDone  |0
     Certificate*                                                     |0
     ClientKeyExchange                                                |0
     CertificateVerify*                                               |0
     [ChangeCipherSpec]                                               |0
     Finished                    --------&gt;                            |1
                                                  [ChangeCipherSpec]  |0
                                 &lt;--------                  Finished  |1
                                 &lt;--------              HelloRequest  |1
     ClientHello (w/ extensions) --------&gt;                            |1
                                         ServerHello (w/ extensions)  |1
                                                   SupplementalData*  |1
                                                        Certificate*  |1
                                                  ServerKeyExchange*  |1
                                                 CertificateRequest*  |1
                                 &lt;--------           ServerHelloDone  |1
     SupplementalData*                                                |1
     Certificate*                                                     |1
     ClientKeyExchange                                                |1
     CertificateVerify*                                               |1
     [ChangeCipherSpec]                                               |1
     Finished                    --------&gt;                            |2
                                                  [ChangeCipherSpec]  |1
                                 &lt;--------                  Finished  |2
     Application Data            &lt;-------&gt;          Application Data  |2

     *  Indicates optional or situation-dependent messages.

          Figure 3: Double Handshake to Protect SupplementalData















<span class="grey">Thakore                       Informational                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc7562.html">RFC 7562</a>                   TLS Auth Using DTCP                 July 2015</span>


Acknowledgements

   The author wishes to thank Mark Brown, Sean Turner, Sumanth
   Channabasappa, and the Chairs (EKR, Joe Saloway) and members of the
   TLS Working Group who provided feedback and comments on one or more
   revisions of this document.

   This document derives its structure and much of its content from
   [<a href="rfc4680.html" title='"TLS Handshake Message for Supplemental Data"'>RFC4680</a>], [<a href="rfc5878.html" title='"Transport Layer Security (TLS) Authorization Extensions"'>RFC5878</a>], and [<a href="rfc6042.html" title='"Transport Layer Security (TLS) Authorization Using KeyNote"'>RFC6042</a>].

Author's Address

   D. Thakore
   Cable Television Laboratories, Inc.
   858 Coal Creek Circle
   Louisville, CO  80023
   United States

   Email: d.thakore@cablelabs.com
































Thakore                       Informational                    [Page 15]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7562 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:21 GMT --></html>