<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from tools.ietf.org/html/rfc5738 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:55:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.129c" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Identifier" content="urn:ietf:rfc:5738" />
<meta name="DC.Description.Abstract" content="This specification extends the Internet Message Access Protocol
version 4rev1 (IMAP4rev1) to support UTF-8 encoded international
characters in user names, mail addresses, and message headers. This
document defines an Experimental Protocol for the Internet community." />
<meta name="DC.Creator" content="Resnick, Pete" />
<meta name="DC.Creator" content="Newman, Chris" />
<meta name="DC.Date.Issued" content="March, 2010" />
<meta name="DC.Title" content="IMAP Support for UTF-8" />

    <link rel="icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 5738 - IMAP Support for UTF-8</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgbrown"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc5738.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc5738" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-eai-imap-utf8" title="draft-ietf-eai-imap-utf8">draft-ietf-eai-...</a>] [<a href='https://datatracker.ietf.org/doc/rfc5738' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5738" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc5738" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=5738">Errata</a>]</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">Obsoleted by: <a href="rfc6855.html">6855</a>                                          EXPERIMENTAL</span><br />
<span class="pre noprint docinfo">                                                            <span style='color: #C00;'>Errata Exist</span></span><br />
<pre>
Network Working Group                                         P. Resnick
Request for Comments: 5738                         Qualcomm Incorporated
Updates: <a href="rfc3501.html">3501</a>                                                  C. Newman
Category: Experimental                                  Sun Microsystems
                                                              March 2010


                         <span class="h1">IMAP Support for UTF-8</span>

Abstract

   This specification extends the Internet Message Access Protocol
   version 4rev1 (IMAP4rev1) to support UTF-8 encoded international
   characters in user names, mail addresses, and message headers.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for examination, experimental implementation, and
   evaluation.

   This document defines an Experimental Protocol for the Internet
   community.  This document is a product of the Internet Engineering
   Task Force (IETF).  It represents the consensus of the IETF
   community.  It has received public review and has been approved for
   publication by the Internet Engineering Steering Group (IESG).  Not
   all documents approved by the IESG are a candidate for any level of
   Internet Standard; see <a href="rfc5741.html#section-2">Section&nbsp;2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc5738">http://www.rfc-editor.org/info/rfc5738</a>.

Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.




<span class="grey">Resnick &amp; Newman              Experimental                      [Page 1]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc5738.html">RFC 5738</a>                 IMAP Support for UTF-8               March 2010</span>


   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Conventions Used in This Document  . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  UTF8=ACCEPT IMAP Capability  . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-3.1">3.1</a>.  IMAP UTF-8 Quoted Strings  . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-3.2">3.2</a>.  UTF8 Parameter to SELECT and EXAMINE . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-3.3">3.3</a>.  UTF-8 LIST and LSUB Responses  . . . . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-3.4">3.4</a>.  UTF-8 Interaction with IMAP4 LIST Command Extensions . . .  <a href="#page-6">6</a>
       <a href="#section-3.4.1">3.4.1</a>.  UTF8 and UTF8ONLY LIST Selection Options . . . . . . .  <a href="#page-6">6</a>
       <a href="#section-3.4.2">3.4.2</a>.  UTF8 LIST Return Option  . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
   <a href="#section-4">4</a>.  UTF8=APPEND Capability . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
   <a href="#section-5">5</a>.  UTF8=USER Capability . . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
   <a href="#section-6">6</a>.  UTF8=ALL Capability  . . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
   <a href="#section-7">7</a>.  UTF8=ONLY Capability . . . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
   <a href="#section-8">8</a>.  Up-Conversion Server Requirements  . . . . . . . . . . . . . .  <a href="#page-8">8</a>
   <a href="#section-9">9</a>.  Issues with UTF-8 Header Mailstore . . . . . . . . . . . . . .  <a href="#page-9">9</a>
   <a href="#section-10">10</a>. IANA Considerations  . . . . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
   <a href="#section-11">11</a>. Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
   <a href="#section-12">12</a>. References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
     <a href="#section-12.1">12.1</a>. Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
     <a href="#section-12.2">12.2</a>. Informative References . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
   <a href="#appendix-A">Appendix A</a>.  Design Rationale  . . . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
   <a href="#appendix-B">Appendix B</a>.  Examples Demonstrating Relationships between
                UTF8= Capabilities  . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
   <a href="#appendix-C">Appendix C</a>.  Acknowledgments . . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>













<span class="grey">Resnick &amp; Newman              Experimental                      [Page 2]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc5738.html">RFC 5738</a>                 IMAP Support for UTF-8               March 2010</span>


<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   This specification extends IMAP4rev1 [<a href="rfc3501.html" title="&quot;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1&quot;">RFC3501</a>] to permit UTF-8
   [<a href="rfc3629.html" title="&quot;UTF-8, a transformation format of ISO 10646&quot;">RFC3629</a>] in headers as described in "Internationalized Email
   Headers" [<a href="rfc5335.html" title="&quot;Internationalized Email Headers&quot;">RFC5335</a>].  It also adds a mechanism to support mailbox
   names, login names, and passwords using the UTF-8 charset.  This
   specification creates five new IMAP capabilities to allow servers to
   advertise these new extensions, along with two new IMAP LIST
   selection options and a new IMAP LIST return option.

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "SHOULD", "SHOULD NOT", and "MAY"
   in this document are to be interpreted as defined in "Key words for
   use in RFCs to Indicate Requirement Levels" [<a href="rfc2119.html" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

   The formal syntax uses the Augmented Backus-Naur Form (ABNF)
   [<a href="rfc5234.html" title="&quot;Augmented BNF for Syntax Specifications: ABNF&quot;">RFC5234</a>] notation including the core rules defined in <a href="rfc5234.html#appendix-B">Appendix&nbsp;B of
   [RFC5234]</a>.  In addition, rules from IMAP4rev1 [<a href="rfc3501.html" title="&quot;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1&quot;">RFC3501</a>], UTF-8
   [<a href="rfc3629.html" title="&quot;UTF-8, a transformation format of ISO 10646&quot;">RFC3629</a>], "Collected Extensions to IMAP4 ABNF" [<a href="rfc4466.html" title="&quot;Collected Extensions to IMAP4 ABNF&quot;">RFC4466</a>], and IMAP4
   LIST Command Extensions [<a href="rfc5258.html" title="&quot;Internet Message Access Protocol version 4 - LIST Command Extensions&quot;">RFC5258</a>] are also referenced.

   In examples, "C:" and "S:" indicate lines sent by the client and
   server, respectively.  If a single "C:" or "S:" label applies to
   multiple lines, then the line breaks between those lines are for
   editorial clarity only and are not part of the actual protocol
   exchange.

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  UTF8=ACCEPT IMAP Capability</span>

   The "UTF8=ACCEPT" capability indicates that the server supports UTF-8
   quoted strings, the "UTF8" parameter to SELECT and EXAMINE, and UTF-8
   responses from the LIST and LSUB commands.

   A client MUST use the "ENABLE UTF8=ACCEPT" command (defined in
   [<a href="rfc5161.html" title="&quot;The IMAP ENABLE Extension&quot;">RFC5161</a>]) to indicate to the server that the client accepts UTF-8
   quoted-strings.  The "ENABLE UTF8=ACCEPT" command MUST only be used
   in the authenticated state.  (Note that the "UTF8=ONLY" capability
   described in <a href="#section-7">Section 7</a> and the "UTF8=ALL" capability described in
   <a href="#section-6">Section 6</a> imply the "UTF8=ACCEPT" capability.  See additional
   information in these sections.)

<span class="h3"><a class="selflink" name="section-3.1" href="#section-3.1">3.1</a>.  IMAP UTF-8 Quoted Strings</span>

   The IMAP4rev1 [<a href="rfc3501.html" title="&quot;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1&quot;">RFC3501</a>] base specification forbids the use of 8-bit
   characters in atoms or quoted strings.  Thus, a UTF-8 string can only
   be sent as a literal.  This can be inconvenient from a coding
   standpoint, and unless the server offers IMAP4 non-synchronizing



<span class="grey">Resnick &amp; Newman              Experimental                      [Page 3]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc5738.html">RFC 5738</a>                 IMAP Support for UTF-8               March 2010</span>


   literals [<a href="rfc2088.html" title="&quot;IMAP4 non-synchronizing literals&quot;">RFC2088</a>], this requires an extra round trip for each UTF-8
   string sent by the client.  When the IMAP server advertises the
   "UTF8=ACCEPT" capability, it informs the client that it supports
   native UTF-8 quoted-strings with the following syntax:

     string        =/ utf8-quoted

     utf8-quoted   = "*" DQUOTE *UQUOTED-CHAR DQUOTE

     UQUOTED-CHAR  = QUOTED-CHAR / UTF8-2 / UTF8-3 / UTF8-4
                ; UTF8-2, UTF8-3, and UTF8-4 are as defined in <a href="rfc3629.html">RFC 3629</a>

   When this quoting mechanism is used by the client (specifically an
   octet sequence beginning with *" and ending with "), then the server
   MUST reject octet sequences with the high bit set that fail to comply
   with the formal syntax in [<a href="rfc3629.html" title="&quot;UTF-8, a transformation format of ISO 10646&quot;">RFC3629</a>] with a BAD response.

   The IMAP server MUST NOT send utf8-quoted syntax to the client unless
   the client has indicated support for that syntax by using the "ENABLE
   UTF8=ACCEPT" command.

   If the server advertises the "UTF8=ACCEPT" capability, the client MAY
   use utf8-quoted syntax with any IMAP argument that permits a string
   (including astring and nstring).  However, if characters outside the
   US-ASCII repertoire are used in an inappropriate place, the results
   would be the same as if other syntactically valid but semantically
   invalid characters were used.  For example, if the client includes
   UTF-8 characters in the user or password arguments (and the server
   has not advertised "UTF8=USER"), the LOGIN command will fail as it
   would with any other invalid user name or password.  Specific cases
   where UTF-8 characters are permitted or not permitted are described
   in the following paragraphs.

   All IMAP servers that advertise the "UTF8=ACCEPT" capability SHOULD
   accept UTF-8 in mailbox names, and those that also support the
   "Mailbox International Naming Convention" described in <a href="rfc3501.html#section-5.1.3">RFC 3501,
   Section&nbsp;5.1.3</a> MUST accept utf8-quoted mailbox names and convert them
   to the appropriate internal format.  Mailbox names MUST comply with
   the Net-Unicode Definition (<a href="rfc5198.html#section-2">Section&nbsp;2 of [RFC5198]</a>) with the specific
   exception that they MUST NOT contain control characters (0000-001F,
   0080-009F), delete (007F), line separator (2028), or paragraph
   separator (2029).

   An IMAP client MUST NOT issue a SEARCH command that uses a mixture of
   utf8-quoted syntax and a SEARCH CHARSET other than UTF-8.  If an IMAP
   server receives such a SEARCH command, it SHOULD reject the command
   with a BAD response (due to the conflicting charset labels).




<span class="grey">Resnick &amp; Newman              Experimental                      [Page 4]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc5738.html">RFC 5738</a>                 IMAP Support for UTF-8               March 2010</span>


<span class="h3"><a class="selflink" name="section-3.2" href="#section-3.2">3.2</a>.  UTF8 Parameter to SELECT and EXAMINE</span>

   The "UTF8=ACCEPT" capability also indicates that the server supports
   the "UTF8" parameter to SELECT and EXAMINE.  When a mailbox is
   selected with the "UTF8" parameter, it alters the behavior of all
   IMAP commands related to message sizes, message headers, and MIME
   body headers so they refer to the message with UTF-8 headers.  If the
   mailstore is not UTF-8 header native and the SELECT or EXAMINE
   command with UTF-8 header modifier succeeds, then the server MUST
   return results as if the mailstore were UTF-8 header native with
   upconversion requirements as described in <a href="#section-8">Section 8</a>.  The server MAY
   reject the SELECT or EXAMINE command with the [NOT-UTF-8] response
   code, unless the "UTF8=ALL" or "UTF8=ONLY" capability is advertised.

   Servers MAY include mailboxes that can only be selected or examined
   if the "UTF8" parameter is provided.  However, such mailboxes MUST
   NOT be included in the output of an unextended LIST, LSUB, or
   equivalent command.  If a client attempts to SELECT or EXAMINE such
   mailboxes without the "UTF8" parameter, the server MUST reject the
   command with a [UTF-8-ONLY] response code.  As a result, such
   mailboxes will not be accessible by IMAP clients written prior to
   this specification and are discouraged unless the server advertises
   "UTF8=ONLY" or the server implements IMAP4 LIST Command Extensions
   [<a href="rfc5258.html" title="&quot;Internet Message Access Protocol version 4 - LIST Command Extensions&quot;">RFC5258</a>].

     utf8-select-param = "UTF8"
               ;; Conforms to &lt;select-param&gt; from <a href="rfc4466.html">RFC 4466</a>

     C: a SELECT newmailbox (UTF8)
     S: ...
     S: a OK SELECT completed
     C: b FETCH 1 (SIZE ENVELOPE BODY)
     S: ... &lt; UTF-8 header native results &gt;
     S: b OK FETCH completed

     C: c EXAMINE legacymailbox (UTF8)
     S: c NO [NOT-UTF-8] Mailbox does not support UTF-8 access

     C: d SELECT funky-new-mailbox
     S: d NO [UTF-8-ONLY] Mailbox requires UTF-8 client

<span class="h3"><a class="selflink" name="section-3.3" href="#section-3.3">3.3</a>.  UTF-8 LIST and LSUB Responses</span>

   After an IMAP client successfully issues an "ENABLE UTF8=ACCEPT"
   command, the server MUST NOT return in LIST results any mailbox names
   to the client following the IMAP4 Mailbox International Naming
   Convention.  Instead, the server MUST return any mailbox names with
   characters outside the US-ASCII repertoire using utf8-quoted syntax.



<span class="grey">Resnick &amp; Newman              Experimental                      [Page 5]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc5738.html">RFC 5738</a>                 IMAP Support for UTF-8               March 2010</span>


   (The IMAP4 Mailbox International Naming Convention has proved
   problematic in the past, so the desire is to make this syntax
   obsolete as quickly as possible.)

<span class="h3"><a class="selflink" name="section-3.4" href="#section-3.4">3.4</a>.  UTF-8 Interaction with IMAP4 LIST Command Extensions</span>

   When an IMAP server advertises both the "UTF8=ACCEPT" capability and
   the "LIST-EXTENDED" [<a href="rfc5258.html" title="&quot;Internet Message Access Protocol version 4 - LIST Command Extensions&quot;">RFC5258</a>] capability, the server MUST support the
   LIST extensions described in this section.

<span class="h4"><a class="selflink" name="section-3.4.1" href="#section-3.4.1">3.4.1</a>.  UTF8 and UTF8ONLY LIST Selection Options</span>

   The "UTF8" LIST selection option tells the server to include
   mailboxes that only support UTF-8 headers in the output of the list
   command.  The "UTF8ONLY" LIST selection option tells the server to
   include all mailboxes that support UTF-8 headers and to exclude
   mailboxes that don't support UTF-8 headers.  Note that "UTF8ONLY"
   implies "UTF8", so it is not necessary for the client to request
   both.  Use of either selection option will also result in UTF-8
   mailbox names in the result as described in <a href="#section-3.3">Section 3.3</a> and implies
   the "UTF8" List return option described in <a href="#section-3.4.2">Section 3.4.2</a>.

<span class="h4"><a class="selflink" name="section-3.4.2" href="#section-3.4.2">3.4.2</a>.  UTF8 LIST Return Option</span>

   If the client supplies the "UTF8" LIST return option, then the server
   MUST include either the "\NoUTF8" or the "\UTF8Only" mailbox
   attribute as appropriate.  The "\NoUTF8" mailbox attribute indicates
   that an attempt to SELECT or EXAMINE that mailbox with the "UTF8"
   parameter will fail with a [NOT-UTF-8] response code.  The
   "\UTF8Only" mailbox attribute indicates that an attempt to SELECT or
   EXAMINE that mailbox without the "UTF8" parameter will fail with a
   [UTF-8-ONLY] response code.  Note that computing this information may
   be expensive on some server implementations, so this return option
   should not be used unless necessary.

   The ABNF [<a href="rfc5234.html" title="&quot;Augmented BNF for Syntax Specifications: ABNF&quot;">RFC5234</a>] for these LIST extensions follows:

     list-select-independent-opt =/ "UTF8"

     list-select-base-opt        =/ "UTF8ONLY"

     mbx-list-oflag              =/ "\NoUTF8" / "\UTF8Only"

     return-option               =/ "UTF8"

     resp-text-code              =/ "NOT-UTF-8" / "UTF-8-ONLY"





<span class="grey">Resnick &amp; Newman              Experimental                      [Page 6]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc5738.html">RFC 5738</a>                 IMAP Support for UTF-8               March 2010</span>


<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  UTF8=APPEND Capability</span>

   If the "UTF8=APPEND" capability is advertised, then the server
   accepts UTF-8 headers in the APPEND command message argument.  A
   client that sends a message with UTF-8 headers to the server MUST
   send them using the "UTF8" APPEND data extension.  If the server also
   advertises the CATENATE capability (as specified in [<a href="rfc4469.html" title="&quot;Internet Message Access Protocol (IMAP) CATENATE Extension&quot;">RFC4469</a>]), the
   client can use the same data extension to include such a message in a
   CATENATE message part.  The ABNF for the APPEND data extension and
   CATENATE extension follows:

     utf8-literal   = "UTF8" SP "(" literal8 ")"

     append-data    =/ utf8-literal

     cat-part       =/ utf8-literal

   A server that advertises "UTF8=APPEND" has to comply with the
   requirements of the IMAP base specification and [<a href="rfc5322.html" title="&quot;Internet Message Format&quot;">RFC5322</a>] for message
   fetching.  Mechanisms for 7-bit downgrading to help comply with the
   standards are discussed in Downgrading mechanism for
   Internationalized eMail Address (IMA) [<a href="rfc5504.html" title="&quot;Downgrading Mechanism for Email Address Internationalization&quot;">RFC5504</a>].

   IMAP servers that do not advertise the "UTF8=APPEND" or "UTF8=ONLY"
   capability SHOULD reject an APPEND command that includes any 8-bit in
   the message headers with a "NO" response.

   Note that the "UTF8=ONLY" capability described in <a href="#section-7">Section 7</a> implies
   the "UTF8=APPEND" capability.  See additional information in that
   section.

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  UTF8=USER Capability</span>

   If the "UTF8=USER" capability is advertised, that indicates the
   server accepts UTF-8 user names and passwords and applies SASLprep
   [<a href="rfc4013.html" title="&quot;SASLprep: Stringprep Profile for User Names and Passwords&quot;">RFC4013</a>] to both arguments of the LOGIN command.  The server MUST
   reject UTF-8 that fails to comply with the formal syntax in <a href="rfc3629.html">RFC 3629</a>
   [<a href="rfc3629.html" title="&quot;UTF-8, a transformation format of ISO 10646&quot;">RFC3629</a>] or if it encounters Unicode characters listed in <a href="#section-2.3">Section</a>
   <a href="#section-2.3">2.3</a> of SASLprep <a href="rfc4013.html">RFC 4013</a> [<a href="rfc4013.html" title="&quot;SASLprep: Stringprep Profile for User Names and Passwords&quot;">RFC4013</a>].

<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  UTF8=ALL Capability</span>

   The "UTF8=ALL" capability indicates all server mailboxes support
   UTF-8 headers.  Specifically, SELECT and EXAMINE with the "UTF8"
   parameter will never fail with a [NOT-UTF-8] response code.






<span class="grey">Resnick &amp; Newman              Experimental                      [Page 7]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc5738.html">RFC 5738</a>                 IMAP Support for UTF-8               March 2010</span>


   Note that the "UTF8=ONLY" capability described in <a href="#section-7">Section 7</a> implies
   the "UTF8=ALL" capability.  See additional information in that
   section.

   Note that the "UTF8=ALL" capability implies the "UTF8=ACCEPT"
   capability.

<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  UTF8=ONLY Capability</span>

   The "UTF8=ONLY" capability permits an IMAP server to advertise that
   it does not support the international mailbox name convention
   (modified UTF-7), and does not permit selection or examination of any
   mailbox unless the "UTF8" parameter is provided.  As this is an
   incompatible change to IMAP, a clear warning is necessary.  IMAP
   clients that find implementation of the "UTF8=ONLY" capability
   problematic are encouraged to at least detect the "UTF8=ONLY"
   capability and provide an informative error message to the end-user.

   When an IMAP mailbox internally uses UTF-8 header native storage, the
   down-conversion step is necessary to permit selection or examination
   of the mailbox in a backwards compatible fashion will become more
   difficult to support.  Although it is hoped that deployed IMAP
   servers will not advertise "UTF8=ONLY" for some years, this
   capability is intended to minimize the disruption when legacy support
   finally goes away.

   The "UTF8=ONLY" capability implies the "UTF8=ACCEPT" capability, the
   "UTF8=ALL" capability, and the "UTF8=APPEND" capability.  A server
   that advertises "UTF8=ONLY" need not advertise the three implicit
   capabilities.

<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  Up-Conversion Server Requirements</span>

   When an IMAP4 server uses a traditional mailbox format that includes
   7-bit headers and it chooses to permit access to that mailbox with
   the "UTF8" parameter, it MUST support minimal up-conversion as
   described in this section.

   The server MUST support up-conversion of the following address
   header-fields in the message header: From, Sender, To, CC, Bcc,
   Resent-From, Resent-Sender, Resent-To, Resent-CC, Resent-Bcc, and
   Reply-To.  This up-conversion MUST include address local-parts in
   fields downgraded according to [<a href="rfc5504.html" title="&quot;Downgrading Mechanism for Email Address Internationalization&quot;">RFC5504</a>], address domains encoded
   according to Internationalizing Domain Names in Applications (IDNA)
   [<a href="rfc3490.html" title="&quot;Internationalizing Domain Names in Applications (IDNA)&quot;">RFC3490</a>], and MIME header encoding [<a href="rfc2047.html" title="&quot;MIME (Multipurpose Internet Mail Extensions) Part Three: Message Header Extensions for Non-ASCII Text&quot;">RFC2047</a>] of display-names and
   any [<a href="rfc5322.html" title="&quot;Internet Message Format&quot;">RFC5322</a>] comments.





<span class="grey">Resnick &amp; Newman              Experimental                      [Page 8]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc5738.html">RFC 5738</a>                 IMAP Support for UTF-8               March 2010</span>


   The following charsets MUST be supported for up-conversion of MIME
   header encoding [<a href="rfc2047.html" title="&quot;MIME (Multipurpose Internet Mail Extensions) Part Three: Message Header Extensions for Non-ASCII Text&quot;">RFC2047</a>]: UTF-8, US-ASCII, ISO-8859-1, ISO-8859-2,
   ISO-8859-3, ISO-8859-4, ISO-8859-5, ISO-8859-6, ISO-8859-7,
   ISO-8859-8, ISO-8859-9, ISO-8859-10, ISO-8859-14, and ISO-8859-15.
   If the server supports other charsets in IMAP SEARCH or IMAP CONVERT
   [<a href="rfc5259.html" title="&quot;Internet Message Access Protocol - CONVERT Extension&quot;">RFC5259</a>], it SHOULD also support those charsets in this conversion.

   Up-conversion of MIME header encoding of the following headers MUST
   also be implemented: Subject, Date ([<a href="rfc5322.html" title="&quot;Internet Message Format&quot;">RFC5322</a>] comments only),
   Comments, Keywords, and Content-Description.

   Server implementations also SHOULD up-convert all MIME body headers
   [<a href="rfc2045.html" title="&quot;Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies&quot;">RFC2045</a>], SHOULD up-convert or remove the deprecated (and misused)
   "name" parameter [<a href="rfc1341.html" title="&quot;MIME (Multipurpose Internet Mail Extensions): Mechanisms for Specifying and Describing the Format of Internet Message Bodies&quot;">RFC1341</a>] on Content-Type, and MUST up-convert the
   Content-Disposition [<a href="rfc2183.html" title="&quot;Communicating Presentation Information in Internet Messages: The Content-Disposition Header Field&quot;">RFC2183</a>] "filename" parameter, except when any
   of these are contained within a multipart/signed MIME body part (see
   below).  These parameters can be encoded using the standard MIME
   parameter encoding [<a href="rfc2231.html" title="&quot;MIME Parameter Value and Encoded Word Extensions: Character Sets, Languages, and Continuations&quot;">RFC2231</a>] mechanism, or via non-standard use of
   MIME header encoding [<a href="rfc2047.html" title="&quot;MIME (Multipurpose Internet Mail Extensions) Part Three: Message Header Extensions for Non-ASCII Text&quot;">RFC2047</a>] in quoted strings.

   The IMAP server MUST NOT perform up-conversion of headers and content
   of multipart/signed, as well as Original-Recipient and Return-Path.

<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  Issues with UTF-8 Header Mailstore</span>

   When an IMAP server uses a mailbox format that supports UTF-8 headers
   and it permits selection or examination of that mailbox without the
   "UTF8" parameter, it is the responsibility of the server to comply
   with the IMAP4rev1 base specification [<a href="rfc3501.html" title="&quot;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1&quot;">RFC3501</a>] and [<a href="rfc5322.html" title="&quot;Internet Message Format&quot;">RFC5322</a>] with
   respect to all header information transmitted over the wire.
   Mechanisms for 7-bit downgrading to help comply with the standards
   are discussed in "Downgrading Mechanism for Email Address
   Internationalization" [<a href="rfc5504.html" title="&quot;Downgrading Mechanism for Email Address Internationalization&quot;">RFC5504</a>].

   An IMAP server with a mailbox that supports UTF-8 headers MUST comply
   with the protocol requirements implicit from <a href="#section-8">Section 8</a>.  However, the
   code necessary for such compliance need not be part of the IMAP
   server itself in this case.  For example, the minimal required up-
   conversion could be performed when a message is inserted into the
   IMAP-accessible mailbox.

<span class="h2"><a class="selflink" name="section-10" href="#section-10">10</a>.  IANA Considerations</span>

   This adds five new capabilities ("UTF8=ACCEPT", "UTF8=USER",
   "UTF8=APPEND", "UTF8=ALL", and "UTF8=ONLY") to the IMAP4rev1
   Capabilities registry [<a href="rfc3501.html" title="&quot;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1&quot;">RFC3501</a>].





<span class="grey">Resnick &amp; Newman              Experimental                      [Page 9]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc5738.html">RFC 5738</a>                 IMAP Support for UTF-8               March 2010</span>


   This adds two new IMAP4 list selection options and one new IMAP4 list
   return option.

   1.  LIST-EXTENDED option name: UTF8

       LIST-EXTENDED option type: SELECTION

       Implied return options(s): UTF8

       LIST-EXTENDED option description: Causes the LIST response to
       include mailboxes that mandate the UTF8 SELECT/EXAMINE parameter.

       Published specification: <a href="rfc5738.html#section-3.4.1">RFC 5738, Section&nbsp;3.4.1</a>

       Security considerations: <a href="rfc5738.html#section-11">RFC 5738, Section&nbsp;11</a>

       Intended usage: COMMON

       Person and email address to contact for further information: see
       the Authors' Addresses at the end of this specification

       Owner/Change controller: iesg@ietf.org

   2.  LIST-EXTENDED option name: UTF8ONLY

       LIST-EXTENDED option type: SELECTION

       Implied return options(s): UTF8

       LIST-EXTENDED option description: Causes the LIST response to
       include mailboxes that mandate the UTF8 SELECT/EXAMINE parameter
       and exclude mailboxes that do not support the UTF8 SELECT/EXAMINE
       parameter.

       Published specification: <a href="rfc5738.html#section-3.4.1">RFC 5738, Section&nbsp;3.4.1</a>

       Security considerations: <a href="rfc5738.html#section-11">RFC 5738, Section&nbsp;11</a>

       Intended usage: COMMON

       Person and email address to contact for further information: see
       the Authors' Addresses at the end of this specification

       Owner/Change controller: iesg@ietf.org







<span class="grey">Resnick &amp; Newman              Experimental                     [Page 10]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc5738.html">RFC 5738</a>                 IMAP Support for UTF-8               March 2010</span>


   3.  LIST-EXTENDED option name: UTF8

       LIST-EXTENDED option type: RETURN

       Implied return options(s): none

       LIST-EXTENDED option description: Causes the LIST response to
       include \NoUTF8 and \UTF8Only mailbox attributes.

       Published specification: <a href="rfc5738.html#section-3.4.1">RFC 5738, Section&nbsp;3.4.1</a>

       Security considerations: <a href="rfc5738.html#section-11">RFC 5738, Section&nbsp;11</a>

       Intended usage: COMMON

       Person and email address to contact for further information: see
       the Authors' Addresses at the end of this specification

       Owner/Change controller: iesg@ietf.org

<span class="h2"><a class="selflink" name="section-11" href="#section-11">11</a>.  Security Considerations</span>

   The security considerations of UTF-8 [<a href="rfc3629.html" title="&quot;UTF-8, a transformation format of ISO 10646&quot;">RFC3629</a>] and SASLprep [<a href="rfc4013.html" title="&quot;SASLprep: Stringprep Profile for User Names and Passwords&quot;">RFC4013</a>]
   apply to this specification, particularly with respect to use of
   UTF-8 in user names and passwords.  Otherwise, this is not believed
   to alter the security considerations of IMAP4rev1.

<span class="h2"><a class="selflink" name="section-12" href="#section-12">12</a>.  References</span>

<span class="h3"><a class="selflink" name="section-12.1" href="#section-12.1">12.1</a>.  Normative References</span>

   [<a name="ref-RFC1341" id="ref-RFC1341">RFC1341</a>]  Borenstein, N. and N. Freed, "MIME (Multipurpose Internet
              Mail Extensions): Mechanisms for Specifying and Describing
              the Format of Internet Message Bodies", <a href="rfc1341.html">RFC 1341</a>,
              June 1992.

   [<a name="ref-RFC2045" id="ref-RFC2045">RFC2045</a>]  Freed, N. and N. Borenstein, "Multipurpose Internet Mail
              Extensions (MIME) Part One: Format of Internet Message
              Bodies", <a href="rfc2045.html">RFC 2045</a>, November 1996.

   [<a name="ref-RFC2047" id="ref-RFC2047">RFC2047</a>]  Moore, K., "MIME (Multipurpose Internet Mail Extensions)
              Part Three: Message Header Extensions for Non-ASCII Text",
              <a href="rfc2047.html">RFC 2047</a>, November 1996.

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.





<span class="grey">Resnick &amp; Newman              Experimental                     [Page 11]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc5738.html">RFC 5738</a>                 IMAP Support for UTF-8               March 2010</span>


   [<a name="ref-RFC2183" id="ref-RFC2183">RFC2183</a>]  Troost, R., Dorner, S., and K. Moore, "Communicating
              Presentation Information in Internet Messages: The
              Content-Disposition Header Field", <a href="rfc2183.html">RFC 2183</a>, August 1997.

   [<a name="ref-RFC2231" id="ref-RFC2231">RFC2231</a>]  Freed, N. and K. Moore, "MIME Parameter Value and Encoded
              Word Extensions:
              Character Sets, Languages, and Continuations", <a href="rfc2231.html">RFC 2231</a>,
              November 1997.

   [<a name="ref-RFC3490" id="ref-RFC3490">RFC3490</a>]  Faltstrom, P., Hoffman, P., and A. Costello,
              "Internationalizing Domain Names in Applications (IDNA)",
              <a href="rfc3490.html">RFC 3490</a>, March 2003.

   [<a name="ref-RFC3501" id="ref-RFC3501">RFC3501</a>]  Crispin, M., "INTERNET MESSAGE ACCESS PROTOCOL - VERSION
              4rev1", <a href="rfc3501.html">RFC 3501</a>, March 2003.

   [<a name="ref-RFC3629" id="ref-RFC3629">RFC3629</a>]  Yergeau, F., "UTF-8, a transformation format of ISO
              10646", STD 63, <a href="rfc3629.html">RFC 3629</a>, November 2003.

   [<a name="ref-RFC4013" id="ref-RFC4013">RFC4013</a>]  Zeilenga, K., "SASLprep: Stringprep Profile for User Names
              and Passwords", <a href="rfc4013.html">RFC 4013</a>, February 2005.

   [<a name="ref-RFC4466" id="ref-RFC4466">RFC4466</a>]  Melnikov, A. and C. Daboo, "Collected Extensions to IMAP4
              ABNF", <a href="rfc4466.html">RFC 4466</a>, April 2006.

   [<a name="ref-RFC4469" id="ref-RFC4469">RFC4469</a>]  Resnick, P., "Internet Message Access Protocol (IMAP)
              CATENATE Extension", <a href="rfc4469.html">RFC 4469</a>, April 2006.

   [<a name="ref-RFC5161" id="ref-RFC5161">RFC5161</a>]  Gulbrandsen, A. and A. Melnikov, "The IMAP ENABLE
              Extension", <a href="rfc5161.html">RFC 5161</a>, March 2008.

   [<a name="ref-RFC5198" id="ref-RFC5198">RFC5198</a>]  Klensin, J. and M. Padlipsky, "Unicode Format for Network
              Interchange", <a href="rfc5198.html">RFC 5198</a>, March 2008.

   [<a name="ref-RFC5234" id="ref-RFC5234">RFC5234</a>]  Crocker, D. and P. Overell, "Augmented BNF for Syntax
              Specifications: ABNF", STD 68, <a href="rfc5234.html">RFC 5234</a>, January 2008.

   [<a name="ref-RFC5258" id="ref-RFC5258">RFC5258</a>]  Leiba, B. and A. Melnikov, "Internet Message Access
              Protocol version 4 - LIST Command Extensions", <a href="rfc5258.html">RFC 5258</a>,
              June 2008.

   [<a name="ref-RFC5259" id="ref-RFC5259">RFC5259</a>]  Melnikov, A. and P. Coates, "Internet Message Access
              Protocol - CONVERT Extension", <a href="rfc5259.html">RFC 5259</a>, July 2008.

   [<a name="ref-RFC5322" id="ref-RFC5322">RFC5322</a>]  Resnick, P., Ed., "Internet Message Format", <a href="rfc5322.html">RFC 5322</a>,
              October 2008.





<span class="grey">Resnick &amp; Newman              Experimental                     [Page 12]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey"><a href="rfc5738.html">RFC 5738</a>                 IMAP Support for UTF-8               March 2010</span>


   [<a name="ref-RFC5335" id="ref-RFC5335">RFC5335</a>]  Abel, Y., "Internationalized Email Headers", <a href="rfc5335.html">RFC 5335</a>,
              September 2008.

   [<a name="ref-RFC5504" id="ref-RFC5504">RFC5504</a>]  Fujiwara, K. and Y. Yoneya, "Downgrading Mechanism for
              Email Address Internationalization", <a href="rfc5504.html">RFC 5504</a>, March 2009.

<span class="h3"><a class="selflink" name="section-12.2" href="#section-12.2">12.2</a>.  Informative References</span>

   [<a name="ref-RFC2049" id="ref-RFC2049">RFC2049</a>]  Freed, N. and N. Borenstein, "Multipurpose Internet Mail
              Extensions (MIME) Part Five: Conformance Criteria and
              Examples", <a href="rfc2049.html">RFC 2049</a>, November 1996.

   [<a name="ref-RFC2088" id="ref-RFC2088">RFC2088</a>]  Myers, J., "IMAP4 non-synchronizing literals", <a href="rfc2088.html">RFC 2088</a>,
              January 1997.

   [<a name="ref-RFC2277" id="ref-RFC2277">RFC2277</a>]  Alvestrand, H., "IETF Policy on Character Sets and
              Languages", <a href="https://tools.ietf.org/html/bcp18">BCP 18</a>, <a href="rfc2277.html">RFC 2277</a>, January 1998.

   [<a name="ref-RFC5721" id="ref-RFC5721">RFC5721</a>]  Gellens, R. and C. Newman, "POP3 Support for UTF-8",
              <a href="rfc5721.html">RFC 5721</a>, February 2010.































<span class="grey">Resnick &amp; Newman              Experimental                     [Page 13]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey"><a href="rfc5738.html">RFC 5738</a>                 IMAP Support for UTF-8               March 2010</span>


<span class="h2"><a class="selflink" name="appendix-A" href="#appendix-A">Appendix A</a>.  Design Rationale</span>

   This non-normative section discusses the reasons behind some of the
   design choices in the above specification.

   The basic approach of advertising the ability to access a mailbox in
   UTF-8 mode is intended to permit graceful upgrade, including servers
   that support multiple mailbox formats.  In particular, it would be
   undesirable to force conversion of an entire server mailstore to
   UTF-8 headers, so being able to phase-in support for new mailboxes
   and gradually migrate old mailboxes is permitted by this design.

   "UTF8=USER" is optional because many identity systems are US-ASCII
   only, so it's helpful to inform the client up front that UTF-8 won't
   work.

   "UTF8=APPEND" is optional because it effectively requires IMAP server
   support for down-conversion, which is a much more complex operation
   than up-conversion.

   The "UTF8=ONLY" mechanism simplifies diagnosis of interoperability
   problems when legacy support goes away.  In the situation where
   backwards compatibility is broken anyway, just-send-UTF-8 IMAP has
   the advantage that it might work with some legacy clients.  However,
   the difficulty of diagnosing interoperability problems caused by a
   just-send-UTF-8 IMAP mechanism is the reason the "UTF8=ONLY"
   capability mechanism was chosen.

   The up-conversion requirements are designed to balance the desire to
   deprecate and eventually eliminate complicated encodings (like MIME
   header encodings) without creating a significant deployment burden
   for servers.  As IMAP4 servers already require a MIME parser, this
   includes additional server up-conversion requirements not present in
   POP3 Support for UTF-8 [<a href="rfc5721.html" title="&quot;POP3 Support for UTF-8&quot;">RFC5721</a>].

   The set of mandatory charsets comes from two sources: MIME
   requirements [<a href="rfc2049.html" title="&quot;Multipurpose Internet Mail Extensions (MIME) Part Five: Conformance Criteria and Examples&quot;">RFC2049</a>] and IETF Policy on Character Sets [<a href="rfc2277.html" title="&quot;IETF Policy on Character Sets and Languages&quot;">RFC2277</a>].
   Including a requirement to up-convert widely deployed encoded
   ideographic charsets to UTF-8 would be reasonable for most scenarios,
   but may require unacceptable table sizes for some embedded devices.
   The open-ended recommendation to support widely deployed charsets
   avoids the political ramifications of attempting to list such
   charsets.  The authors believe market forces, existing open-source
   software, and public conversion tables are sufficient to deploy the
   appropriate charsets.






<span class="grey">Resnick &amp; Newman              Experimental                     [Page 14]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-15" id="page-15" href="#page-15" class="invisible"> </a>
<span class="grey"><a href="rfc5738.html">RFC 5738</a>                 IMAP Support for UTF-8               March 2010</span>


<span class="h2"><a class="selflink" name="appendix-B" href="#appendix-B">Appendix B</a>.  Examples Demonstrating Relationships between UTF8=</span>
             Capabilities


     UTF8=ACCEPT UTF8=USER UTF8=APPEND
     UTF8=ACCEPT UTF8=ALL
     UTF8=ALL       ; Note, same as above
     UTF8=ACCEPT UTF8=USER UTF8=APPEND UTF8=ALL UTF8=ONLY
     UTF8=USER UTF8=ONLY ; Note, same as above

<span class="h2"><a class="selflink" name="appendix-C" href="#appendix-C">Appendix C</a>.  Acknowledgments</span>

   The authors wish to thank the participants of the EAI working group
   for their contributions to this document with particular thanks to
   Harald Alvestrand, David Black, Randall Gellens, Arnt Gulbrandsen,
   Kari Hurtta, John Klensin, Xiaodong Lee, Charles Lindsey, Alexey
   Melnikov, Subramanian Moonesamy, Shawn Steele, Daniel Taharlev, and
   Joseph Yee for their specific contributions to the discussion.

Authors' Addresses

   Pete Resnick
   Qualcomm Incorporated
   5775 Morehouse Drive
   San Diego, CA  92121-1714
   US

   Phone: +1 858 651 4478
   EMail: presnick@qualcomm.com
   URI:   <a href="http://www.qualcomm.com/~presnick/">http://www.qualcomm.com/~presnick/</a>

   Chris Newman
   Sun Microsystems
   800 Royal Oaks
   Monrovia, CA  91016
   US

   EMail: chris.newman@sun.com













Resnick &amp; Newman              Experimental                     [Page 15]

</pre><br />
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.129c, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>
</body>

<!-- Mirrored from tools.ietf.org/html/rfc5738 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:55:41 GMT -->
</html>
