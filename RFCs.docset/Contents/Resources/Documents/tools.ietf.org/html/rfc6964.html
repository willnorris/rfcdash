<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from tools.ietf.org/html/rfc6964 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:37:31 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.129c" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Identifier" content="urn:ietf:rfc:6964" />
<meta name="DC.Description.Abstract" content="Many end-user sites in the Internet today still have predominantly
IPv4 internal infrastructures. These sites range in size from small
home/office networks to large corporate enterprise networks, but share
the commonality that IPv4 provides satisfactory internal routing and
addressing services for most applications. As more and more IPv6-only
services are deployed, however, end-user devices within such sites
will increasingly require at least basic IPv6 functionality. This
document therefore provides operational guidance for deployment of
IPv6 within predominantly IPv4 sites using the Intra-Site Automatic
Tunnel Addressing Protocol (ISATAP)." />
<meta name="DC.Creator" content="Fred Templin &lt;fltemplin@acm.org&gt;" />
<meta name="DC.Date.Issued" content="May, 2013" />
<meta name="DC.Title" content="Operational Guidance for IPv6 Deployment in IPv4 Sites Using the Intra-Site Automatic Tunnel Addressing Protocol (ISATAP)" />

    <link rel="icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 6964 - Operational Guidance for IPv6 Deployment in IPv4 Sites Using the Intra-Site Automatic Tunnel Addressing Protocol (ISATAP)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgorange"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6964.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6964" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-templin-v6ops-isops" title="draft-templin-v6ops-isops">draft-templin-v...</a>] [<a href='https://datatracker.ietf.org/doc/rfc6964' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6964" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6964" title="Side-by-side diff">Diff2</a>]         </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Independent Submission                                        F. Templin
Request for Comments: 6964                  Boeing Research &amp; Technology
Category: Informational                                         May 2013
ISSN: 2070-1721


    <span class="h1">Operational Guidance for IPv6 Deployment in IPv4 Sites Using the</span>
        <span class="h1">Intra-Site Automatic Tunnel Addressing Protocol (ISATAP)</span>

Abstract

   Many end-user sites in the Internet today still have predominantly
   IPv4 internal infrastructures.  These sites range in size from small
   home/office networks to large corporate enterprise networks, but
   share the commonality that IPv4 provides satisfactory internal
   routing and addressing services for most applications.  As more and
   more IPv6-only services are deployed, however, end-user devices
   within such sites will increasingly require at least basic IPv6
   functionality.  This document therefore provides operational guidance
   for deployment of IPv6 within predominantly IPv4 sites using the
   Intra-Site Automatic Tunnel Addressing Protocol (ISATAP).

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This is a contribution to the RFC Series, independently of any other
   RFC stream.  The RFC Editor has chosen to publish this document at
   its discretion and makes no statement about its value for
   implementation or deployment.  Documents approved for publication by
   the RFC Editor are not a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">Section&nbsp;2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6964">http://www.rfc-editor.org/info/rfc6964</a>.














<span class="grey">Templin                       Informational                     [Page 1]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc6964.html">RFC 6964</a>               ISATAP Operational Guidance              May 2013</span>


Copyright Notice

   Copyright (c) 2013 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Enabling IPv6 Services Using ISATAP . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-3">3</a>.  SLAAC Services  . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-3.1">3.1</a>.  Advertising ISATAP Router Behavior  . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-3.2">3.2</a>.  ISATAP Host Behavior  . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-3.3">3.3</a>.  Reference Operational Scenario - Shared Prefix Model  . .   <a href="#page-6">6</a>
     3.4.  Reference Operational Scenario - Individual Prefix Model    9
     <a href="#section-3.5">3.5</a>.  SLAAC Site Administration Guidance  . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-3.6">3.6</a>.  Loop Avoidance  . . . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
     3.7.  Considerations for Compatibility of Interface Identifiers  14
   <a href="#section-4">4</a>.  Manual Configuration  . . . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
   <a href="#section-5">5</a>.  Scaling Considerations  . . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
   <a href="#section-6">6</a>.  Site Renumbering Considerations . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
   <a href="#section-7">7</a>.  Path MTU Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
   <a href="#section-8">8</a>.  Alternative Approaches  . . . . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
   <a href="#section-9">9</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
   <a href="#section-10">10</a>. Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>
   <a href="#section-11">11</a>. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>
     <a href="#section-11.1">11.1</a>.  Normative References . . . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>
     <a href="#section-11.2">11.2</a>.  Informative References . . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>

















<span class="grey">Templin                       Informational                     [Page 2]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc6964.html">RFC 6964</a>               ISATAP Operational Guidance              May 2013</span>


<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   End-user sites in the Internet today internally use IPv4 routing and
   addressing for core operating functions, such as web browsing, file
   sharing, network printing, email, teleconferencing, and numerous
   other site-internal networking services.  Such sites typically have
   an abundance of public and/or private IPv4 addresses for internal
   networking and are separated from the public Internet by firewalls,
   packet filtering gateways, proxies, address translators, and other
   site-border demarcation devices.  To date, such sites have had little
   incentive to enable IPv6 services internally [<a href="rfc1687.html" title="&quot;A Large Corporate User's View of IPng&quot;">RFC1687</a>].

   End-user sites that currently use IPv4 services internally come in
   endless sizes and varieties.  For example, a home network behind a
   Network Address Translator (NAT) may consist of a single link
   supporting a few laptops, printers, etc.  As a larger example, a
   small business may consist of one or a few offices with several
   networks connecting considerably larger numbers of computers,
   routers, handheld devices, printers, faxes, etc.  Moving further up
   the scale, large financial institutions, major retailers, large
   corporations, etc., may consist of hundreds or thousands of branches
   worldwide that are tied together in a complex global enterprise
   network.  Additional examples include personal-area networks, mobile
   vehicular networks, disaster relief networks, tactical military
   networks, various forms of Mobile Ad Hoc Networks (MANETs), etc.

   With the proliferation of IPv6 services, however, existing IPv4 sites
   will increasingly require a means for enabling IPv6 services so that
   hosts within the site can communicate with IPv6-only correspondents.
   Such services must be deployable with minimal configuration and in a
   fashion that will not cause disruptions to existing IPv4 services.
   The Intra-Site Automatic Tunnel Addressing Protocol (ISATAP)
   [<a href="rfc5214.html" title="&quot;Intra-Site Automatic Tunnel Addressing Protocol (ISATAP)&quot;">RFC5214</a>] provides a simple-to-use service that sites can deploy in
   the near term to meet these requirements.

   ISATAP has also often been mentioned with respect to IPv6 deployment
   in enterprise networks [<a href="rfc4057.html" title="&quot;IPv6 Enterprise Network Scenarios&quot;">RFC4057</a>] [<a href="rfc4852.html" title="&quot;IPv6 Enterprise Network Analysis - IP Layer 3 Focus&quot;">RFC4852</a>] [<a href="#ref-ENT-IPv6" title="&quot;Enterprise IPv6 Deployment Guidelines&quot;">ENT-IPv6</a>].  ISATAP can
   therefore be considered as an IPv6 solution alternative based on
   candidate enterprise network characteristics.

   This document provides operational guidance for using ISATAP to
   enable IPv6 services within predominantly IPv4 sites while causing no
   disruptions to existing IPv4 services.  The terminology of ISATAP
   (see <a href="rfc5214.html#section-3">[RFC5214], Section&nbsp;3</a>) applies also to this document.







<span class="grey">Templin                       Informational                     [Page 3]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc6964.html">RFC 6964</a>               ISATAP Operational Guidance              May 2013</span>


<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Enabling IPv6 Services Using ISATAP</span>

   Existing sites within the Internet will soon need to enable IPv6
   services.  Larger sites typically obtain provider-independent IPv6
   prefixes from an Internet registry and advertise the prefixes into
   the IPv6 routing system on their own behalf, i.e., they act as an
   Internet Service Provider (ISP) unto themselves.  Smaller sites that
   wish to enable IPv6 can arrange to obtain public IPv6 prefixes from
   an ISP, where the prefixes may be either purely native or the near-
   native prefixes offered by the IPv6 Rapid Deployment on IPv4 (6rd)
   [<a href="rfc5969.html" title="&quot;IPv6 Rapid Deployment on IPv4 Infrastructures (6rd) -- Protocol Specification&quot;">RFC5969</a>].  Alternatively, the site can obtain prefixes independently
   of an ISP, e.g., via a tunnel broker [<a href="rfc3053.html" title="&quot;IPv6 Tunnel Broker&quot;">RFC3053</a>], by using one of its
   public IPv4 addresses to form a 6to4 prefix [<a href="rfc3056.html" title="&quot;Connection of IPv6 Domains via IPv4 Clouds&quot;">RFC3056</a>], etc.  In any
   case, after obtaining IPv6 prefixes, the site can automatically
   enable IPv6 services internally by configuring ISATAP.

   The ISATAP service uses a Non-Broadcast, Multiple Access (NBMA)
   tunnel virtual interface model [<a href="rfc2491.html" title="&quot;IPv6 over Non-Broadcast Multiple Access (NBMA) networks&quot;">RFC2491</a>] [<a href="rfc2529.html" title="&quot;Transmission of IPv6 over IPv4 Domains without Explicit Tunnels&quot;">RFC2529</a>] based on IPv6-in-
   IPv4 encapsulation [<a href="rfc4213.html" title="&quot;Basic Transition Mechanisms for IPv6 Hosts and Routers&quot;">RFC4213</a>].  The encapsulation format can further
   use Differentiated Services (DS) [<a href="rfc2983.html" title="&quot;Differentiated Services and Tunnels&quot;">RFC2983</a>] and Explicit Congestion
   Notification (ECN) [<a href="rfc3168.html" title="&quot;The Addition of Explicit Congestion Notification (ECN) to IP&quot;">RFC3168</a>] mapping between the inner and outer IP
   headers to ensure expected per-hop behavior within well-managed
   sites.

   The ISATAP service is based on two node types known as advertising
   ISATAP routers and ISATAP hosts.  (While out of scope for this
   document, a third node type known as non-advertising ISATAP routers
   is defined in [<a href="#ref-ISATAP-UPDATE" title="&quot;ISATAP Updates&quot;">ISATAP-UPDATE</a>].)  Each node may further have multiple
   ISATAP interfaces (i.e., one interface for each site) and may act as
   an advertising ISATAP router on some of those interfaces and a simple
   ISATAP host on others.  Hence, the node type is considered on a per-
   interface basis.

   Advertising ISATAP routers configure their ISATAP interfaces as
   advertising router interfaces (see <a href="rfc4861.html#section-6.2.2">[RFC4861], Section&nbsp;6.2.2</a>).  ISATAP
   hosts configure their ISATAP interfaces as simple host interfaces and
   also coordinate their autoconfiguration operations with advertising
   ISATAP routers.  In this sense, advertising ISATAP routers are
   "servers" while ISATAP hosts are "clients" in the service model.

   Advertising ISATAP routers arrange to add their IPv4 addresses to the
   site's Potential Router List (PRL) so that ISATAP clients can
   discover them, as discussed in Sections <a href="#section-8.3.2">8.3.2</a> and <a href="#section-9">9</a> of [<a href="rfc5214.html" title="&quot;Intra-Site Automatic Tunnel Addressing Protocol (ISATAP)&quot;">RFC5214</a>].
   Alternatively, site administrators could include IPv4 anycast
   addresses in the PRL and assign each such address to multiple
   advertising ISATAP routers.  In that case, IPv4 routing within the
   site would direct the ISATAP client to the nearest advertising ISATAP
   router.



<span class="grey">Templin                       Informational                     [Page 4]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc6964.html">RFC 6964</a>               ISATAP Operational Guidance              May 2013</span>


   After the PRL is published, ISATAP clients within the site can
   automatically perform unicast IPv6 Neighbor Discovery Router
   Solicitation (RS) / Router Advertisement (RA) exchanges with
   advertising ISATAP routers using IPv6-in-IPv4 encapsulation [<a href="rfc4861.html" title="&quot;Neighbor Discovery for IP version 6 (IPv6)&quot;">RFC4861</a>]
   [<a href="rfc5214.html" title="&quot;Intra-Site Automatic Tunnel Addressing Protocol (ISATAP)&quot;">RFC5214</a>].  In the exchange, the IPv4 source address of the RS and
   the destination address of the RA are an IPv4 address of the client,
   while the IPv4 destination address of the RS and the source address
   of the RA are an IPv4 address of a server found in the PRL.
   Similarly, the IPv6 source address of the RS is a link-local ISATAP
   address that embeds the client's IPv4 address, while the source
   address of the RA is a link-local ISATAP address that embeds the
   server's IPv4 address.  (The destination addresses of the RS and RA
   may be either the neighbor's link-local ISATAP address or a link-
   scoped multicast address, depending on the implementation.)

   Following router discovery, ISATAP clients can configure and assign
   IPv6 addresses and/or prefixes using Stateless Address
   AutoConfiguration (SLAAC) [<a href="rfc4862.html" title="&quot;IPv6 Stateless Address Autoconfiguration&quot;">RFC4862</a>] [<a href="rfc5214.html" title="&quot;Intra-Site Automatic Tunnel Addressing Protocol (ISATAP)&quot;">RFC5214</a>].  While out of scope
   for this document, use of the Dynamic Host Configuration Protocol for
   IPv6 (DHCPv6) [<a href="rfc3315.html" title="&quot;Dynamic Host Configuration Protocol for IPv6 (DHCPv6)&quot;">RFC3315</a>] is also possible, pending future updates (see
   [<a href="#ref-ISATAP-UPDATE" title="&quot;ISATAP Updates&quot;">ISATAP-UPDATE</a>]).

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  SLAAC Services</span>

   Predominantly IPv4 sites can enable SLAAC services for ISATAP clients
   that need to communicate with IPv6 correspondents.  SLAAC services
   are enabled using either the "shared" or "individual" prefix model.
   In the shared prefix model, all advertising ISATAP routers advertise
   a common prefix (e.g., 2001:db8::/64) to ISATAP clients within the
   site.  In the individual prefix model, advertising ISATAP router
   advertise individual prefixes (e.g., 2001:db8:0:1::/64,
   2001:db8:0:2::/64, 2001:db8:0:3::/64, etc.)  to ISATAP clients within
   the site.  Note that combinations of the shared and individual prefix
   models are also possible, in which some of the site's ISATAP routers
   advertise shared prefixes and others advertise individual prefixes.

   The following sections discuss operational considerations for
   enabling ISATAP SLAAC services within predominantly IPv4 sites.

<span class="h3"><a class="selflink" name="section-3.1" href="#section-3.1">3.1</a>.  Advertising ISATAP Router Behavior</span>

   Advertising ISATAP routers that support SLAAC services send RA
   messages in response to RS messages received on an advertising ISATAP
   interface.  SLAAC services are enabled when advertising ISATAP
   routers advertise non-link-local IPv6 prefixes in the Prefix
   Information Options (PIOs) with the A flag set to 1 [<a href="rfc4861.html" title="&quot;Neighbor Discovery for IP version 6 (IPv6)&quot;">RFC4861</a>].  When
   there are multiple advertising ISATAP routers, the routers can
   advertise a shared IPv6 prefix or individual IPv6 prefixes.



<span class="grey">Templin                       Informational                     [Page 5]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc6964.html">RFC 6964</a>               ISATAP Operational Guidance              May 2013</span>


<span class="h3"><a class="selflink" name="section-3.2" href="#section-3.2">3.2</a>.  ISATAP Host Behavior</span>

   ISATAP hosts resolve the PRL and send RS messages to obtain RA
   messages from an advertising ISATAP router.  When the host receives
   RA messages, it uses SLAAC to configure IPv6 addresses from any
   advertised prefixes with the A flag set to 1 as specified in
   [<a href="rfc4862.html" title="&quot;IPv6 Stateless Address Autoconfiguration&quot;">RFC4862</a>] and [<a href="rfc5214.html" title="&quot;Intra-Site Automatic Tunnel Addressing Protocol (ISATAP)&quot;">RFC5214</a>], then it assigns the addresses to the ISATAP
   interface.  The host also assigns any of the advertised prefixes with
   the L flag set to 1 to the ISATAP interface.  (Note that the IPv6
   link-local prefix fe80::/64 is always considered on-link on an ISATAP
   interface.)

<span class="h3"><a class="selflink" name="section-3.3" href="#section-3.3">3.3</a>.  Reference Operational Scenario - Shared Prefix Model</span>

   Figure 1 depicts an example ISATAP network topology for allowing
   hosts within a predominantly IPv4 site to configure ISATAP services
   using SLAAC with the shared prefix model.  The example shows two
   advertising ISATAP routers ('A', 'B'), two ISATAP hosts ('C', 'D'),
   and an ordinary IPv6 host ('E') outside of the site in a typical
   deployment configuration.  In this model, routers 'A' and 'B' both
   advertise the same (shared) IPv6 prefix 2001:db8::/64 into the IPv6
   routing system, and also advertise the prefix in the RA messages they
   send to ISATAP clients.




























<span class="grey">Templin                       Informational                     [Page 6]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc6964.html">RFC 6964</a>               ISATAP Operational Guidance              May 2013</span>


                    .-(::::::::)      2001:db8:1::1
                 .-(::: IPv6 :::)-.  +-------------+
                (:::: Internet ::::) | IPv6 Host E |
                 `-(::::::::::::)-'  +-------------+
                    `-(::::::)-'
                ,~~~~~~~~~~~~~~~~~,
           ,----|companion gateway|--.
          /     '~~~~~~~~~~~~~~~~~'  :
         /                           |.
      ,-'                              `.
     ;  +------------+   +------------+  )
     :  |  Router A  |   |  Router B  |  /
      : |  (isatap)  |   |  (isatap)  |  :
      : | 192.0.2.1  |   | 192.0.2.1  | ;
      + +------------+   +------------+  \
     fe80::*:192.0.2.1   fe80::*:192.0.2.1
     | 2001:db8::/64       2001:db8::/64  |
     |                                   ;
     :              IPv4 Site         -+-'
      `-.       (PRL: 192.0.2.1)       .)
         \                           _)
          `-----+--------)----+'----'
     fe80::*:192.0.2.18          fe80::*:192.0.2.34
   2001:db8::*:192.0.2.18      2001:db8::*:192.0.2.34
     +--------------+           +--------------+
     |  192.0.2.18  |           |  192.0.2.34  |
     |   (isatap)   |           |   (isatap)   |
     |    Host C    |           |    Host D    |
     +--------------+           +--------------+

   (* == "0000:5efe", i.e., the organizational unique code for ISATAP,
    per <a href="rfc5214.html#section-6.1">Section&nbsp;6.1 of [RFC5214]</a>)

    Figure 1: Example ISATAP Network Topology Using Shared Prefix Model

   With reference to Figure 1, advertising ISATAP routers 'A' and 'B'
   within the IPv4 site connect to the IPv6 Internet either directly or
   via a companion gateway.  The routers advertise the shared prefix
   2001:db8::/64 into the IPv6 Internet routing system either as a
   singleton /64 or as part of a shorter aggregated IPv6 prefix.  For
   the purpose of this example, we also assume that the IPv4 site is
   configured within multiple IPv4 subnets -- each with an IPv4 prefix
   length of /28.

   Advertising ISATAP routers 'A' and 'B' both configure the IPv4
   anycast address 192.0.2.1 on a site-interior IPv4 interface, then
   configure an advertising ISATAP router interface for the site with
   link-local ISATAP address fe80::5efe:192.0.2.1.  The site



<span class="grey">Templin                       Informational                     [Page 7]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc6964.html">RFC 6964</a>               ISATAP Operational Guidance              May 2013</span>


   administrator then places the single IPv4 address 192.0.2.1 in the
   site's PRL.  'A' and 'B' then both advertise the anycast address/
   prefix into the site's IPv4 routing system so that ISATAP clients can
   locate the router that is topologically closest.  (Note: advertising
   ISATAP routers can also use individual IPv4 unicast addresses instead
   of, or in addition to, a shared IPv4 anycast address.  In that case,
   the PRL will contain multiple IPv4 addresses of advertising routers
   -- some of which may be anycast and others unicast.)

   ISATAP host 'C' connects to the site via an IPv4 interface with
   address 192.0.2.18/28 and also configures an ISATAP host interface
   with link-local ISATAP address fe80::5efe:192.0.2.18 over the IPv4
   interface.  'C' next resolves the PRL and sends an RS message to the
   IPv4 address 192.0.2.1, where IPv4 routing will direct it to the
   closest of either 'A' or 'B'.  Assuming 'A' is closest, 'C' receives
   an RA from 'A' then configures a default IPv6 route with next-hop
   address fe80::5efe:192.0.2.1 via the ISATAP interface and processes
   the IPv6 prefix 2001:db8::/64 advertised in the PIO.  If the A flag
   is set in the PIO, 'C' uses SLAAC to automatically configure the IPv6
   address 2001:db8::5efe:192.0.2.18 (i.e., an address with an ISATAP
   interface identifier) and assigns it to the ISATAP interface.  If the
   L flag is set, 'C' also assigns the prefix 2001:db8::/64 to the
   ISATAP interface, and the IPv6 address becomes a true ISATAP address.

   In the same fashion, ISATAP host 'D' configures its IPv4 interface
   with address 192.0.2.34/28 and configures its ISATAP interface with
   link-local ISATAP address fe80::5efe:192.0.2.34.  'D' next performs
   an RS/RA exchange that is serviced by 'B', then uses SLAAC to
   autoconfigure the address 2001:db8::5efe:192.0.2.34 and a default
   IPv6 route with next-hop address fe80::5efe:192.0.2.1.  Finally, IPv6
   host 'E' connects to an IPv6 network outside of the site.  'E'
   configures its IPv6 interface in a manner specific to its attached
   IPv6 link and autoconfigures the IPv6 address 2001:db8:1::1.

   Following this autoconfiguration, when host 'C' inside the site has
   an IPv6 packet to send to host 'E' outside the site, it prepares the
   packet with source address 2001:db8::5efe:192.0.2.18 and destination
   address 2001:db8:1::1.  'C' then uses IPv6-in-IPv4 encapsulation to
   forward the packet to the IPv4 address 192.0.2.1, which will be
   directed to 'A' based on IPv4 routing.  'A' in turn decapsulates the
   packet and forwards it into the public IPv6 Internet, where it will
   be conveyed to 'E' via normal IPv6 routing.  In the same fashion,
   host 'D' uses IPv6-in-IPv4 encapsulation via its default router 'B'
   to send IPv6 packets to IPv6 Internet hosts such as 'E'.

   When host 'E' outside the site sends IPv6 packets to ISATAP host 'C'
   inside the site, the IPv6 routing system may direct the packet to
   either 'A' or 'B'.  If the site is not partitioned internally, the



<span class="grey">Templin                       Informational                     [Page 8]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc6964.html">RFC 6964</a>               ISATAP Operational Guidance              May 2013</span>


   router that receives the packet can use ISATAP to statelessly forward
   the packet directly to 'C'.  If the site may be partitioned
   internally, however, the packet must first be forwarded to 'C's
   serving router based on IPv6 routing information.  This implies that,
   in a partitioned site, the advertising ISATAP routers must connect
   within a full or partial mesh of IPv6 links, and they must either run
   a dynamic IPv6 routing protocol or configure static routes so that
   incoming IPv6 packets can be forwarded to the correct serving router.

   In this example, 'A' can configure the IPv6 route
   2001:db8::5efe:192.0.2.32/124 with the IPv6 address of the next hop
   toward 'B' in the mesh network as the next hop, and 'B' can configure
   the IPv6 route 2001:db8::5efe:192.0.2.16/124 with the IPv6 address of
   the next hop toward 'A' as the next hop.  (Notice that the /124
   prefixes properly cover the /28 prefix of the IPv4 address that is
   embedded within the IPv6 address.)  In that case, when 'A' receives a
   packet from the IPv6 Internet with destination address
   2001:db8::5efe:192.0.2.34, it first forwards the packet toward 'B'
   over an IPv6 mesh link.  'B' in turn uses ISATAP to forward the
   packet into the site, where IPv4 routing will direct it to 'D'.  In
   the same fashion, when 'B' receives a packet from the IPv6 Internet
   with destination address 2001:db8::5efe:192.0.2.18, it first forwards
   the packet toward 'A' over an IPv6 mesh link.  'A' then uses ISATAP
   to forward the packet into the site, where IPv4 routing will direct
   it to 'C'.

   Finally, when host 'C' inside the site connects to host 'D' inside
   the site, it has the option of using the native IPv4 service or the
   ISATAP IPv6-in-IPv4 encapsulation service.  When there is operational
   assurance that IPv4 services between the two hosts are available, the
   hosts may be better served to continue to use legacy IPv4 services in
   order to avoid encapsulation overhead and to avoid communication
   failures due to middleboxes in the path that filter protocol-41
   packets [<a href="rfc4213.html" title="&quot;Basic Transition Mechanisms for IPv6 Hosts and Routers&quot;">RFC4213</a>].  If 'C' and 'D' could be in different IPv4 network
   partitions, however, IPv6-in-IPv4 encapsulation should be used with
   one or both of routers 'A' and 'B' serving as intermediate gateways.

<span class="h3"><a class="selflink" name="section-3.4" href="#section-3.4">3.4</a>.  Reference Operational Scenario - Individual Prefix Model</span>

   Figure 2 depicts an example ISATAP network topology for allowing
   hosts within a predominantly IPv4 site to configure ISATAP services
   using SLAAC with the individual prefix model.  The example shows two
   advertising ISATAP routers ('A', 'B'), two ISATAP hosts ('C', 'D'),
   and an ordinary IPv6 host ('E') outside of the site in a typical
   deployment configuration.  In the figure, ISATAP routers 'A' and 'B'
   both advertise different prefixes taken from the aggregated prefix
   2001:db8::/48, with 'A' advertising 2001:db8:0:1::/64 and 'B'
   advertising 2001:db8:0:2::/64.



<span class="grey">Templin                       Informational                     [Page 9]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc6964.html">RFC 6964</a>               ISATAP Operational Guidance              May 2013</span>


                    .-(::::::::)      2001:db8:1::1
                 .-(::: IPv6 :::)-.  +-------------+
                (:::: Internet ::::) | IPv6 Host E |
                 `-(::::::::::::)-'  +-------------+
                    `-(::::::)-'
                ,~~~~~~~~~~~~~~~~~,
           ,----|companion gateway|--.
          /     '~~~~~~~~~~~~~~~~~'  :
         /                           |.
      ,-'                              `.
     ;  +------------+   +------------+  )
     :  |  Router A  |   |  Router B  |  /
      : |  (isatap)  |   |  (isatap)  |  :
      : | 192.0.2.17 |   | 192.0.2.33 | ;
      + +------------+   +------------+  \
     fe80::*:192.0.2.17   fe80::*:192.0.2.33
     2001:db8:0:1::/64   2001:db8:0:2::/64
     |                                   ;
     :              IPv4 Site         -+-'
      `-.       (PRL: 192.0.2.1)       .)
         \                           _)
          `-----+--------)----+'----'
     fe80::*:192.0.2.18          fe80::*:192.0.2.34
   2001:db8:0:1::*:192.0.2.18  2001:db8:0:2::*:192.0.2.34
     +--------------+           +--------------+
     |  192.0.2.18  |           |  192.0.2.34  |
     |   (isatap)   |           |   (isatap)   |
     |    Host C    |           |    Host D    |
     +--------------+           +--------------+

   (* == "0000:5efe")

              Figure 2: Example ISATAP Network Topology Using
                          Individual Prefix Model

   With reference to Figure 2, advertising ISATAP routers 'A' and 'B'
   within the IPv4 site connect to the IPv6 Internet either directly or
   via a companion gateway.  Router 'A' advertises the individual prefix
   2001:db8:0:1::/64 into the IPv6 Internet routing system, and router
   'B' advertises the individual prefix 2001:db8:0:2::/64.  The routers
   could instead both advertise a shorter shared prefix such as
   2001:db8::/48 into the IPv6 routing system, but in that case they
   would need to configure a mesh of IPv6 links between themselves in
   the same fashion as described for the shared prefix model in
   <a href="#section-3.3">Section 3.3</a>.  For the purpose of this example, we also assume that
   the IPv4 site is configured within multiple IPv4 subnets -- each with
   an IPv4 prefix length of /28.




<span class="grey">Templin                       Informational                    [Page 10]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc6964.html">RFC 6964</a>               ISATAP Operational Guidance              May 2013</span>


   Advertising ISATAP routers 'A' and 'B' both configure individual IPv4
   unicast addresses 192.0.2.17/28 and 192.0.2.33/28 (respectively)
   instead of, or in addition to, a shared IPv4 anycast address.  Router
   'A' then configures an advertising ISATAP router interface for the
   site with link-local ISATAP address fe80::5efe:192.0.2.17, while
   router 'B' configures an advertising ISATAP router interface for the
   site with link-local ISATAP address fe80::5efe:192.0.2.33.  The site
   administrator then places the IPv4 addresses 192.0.2.17 and
   192.0.2.33 in the site's PRL.  'A' and 'B' then both advertise their
   IPv4 addresses into the site's IPv4 routing system.

   ISATAP host 'C' connects to the site via an IPv4 interface with
   address 192.0.2.18/28 and also configures an ISATAP host interface
   with link-local ISATAP address fe80::5efe:192.0.2.18 over the IPv4
   interface.  'C' next resolves the PRL and sends an RS message to the
   IPv4 address 192.0.2.17, where IPv4 routing will direct it to 'A'.
   'C' then receives an RA from 'A' then configures a default IPv6 route
   with next-hop address fe80::5efe:192.0.2.17 via the ISATAP interface
   and processes the IPv6 prefix 2001:db8:0:1:/64 advertised in the PIO.
   If the A flag is set in the PIO, 'C' uses SLAAC to automatically
   configure the IPv6 address 2001:db8:0:1::5efe:192.0.2.18 (i.e., an
   address with an ISATAP interface identifier) and assigns it to the
   ISATAP interface.  If the L flag is set, 'C' also assigns the prefix
   2001:db8:0:1::/64 to the ISATAP interface, and the IPv6 address
   becomes a true ISATAP address.

   In the same fashion, ISATAP host 'D' configures its IPv4 interface
   with address 192.0.2.34/28 and configures its ISATAP interface with
   link-local ISATAP address fe80::5efe:192.0.2.34.  'D' next performs
   an RS/RA exchange that is serviced by 'B', then uses SLAAC to
   autoconfigure the address 2001:db8:0:2::5efe:192.0.2.34 and a default
   IPv6 route with next-hop address fe80::5efe:192.0.2.33.  Finally,
   IPv6 host 'E' connects to an IPv6 network outside of the site.  'E'
   configures its IPv6 interface in a manner specific to its attached
   IPv6 link, and it autoconfigures the IPv6 address 2001:db8:1::1.

   Following this autoconfiguration, when host 'C' inside the site has
   an IPv6 packet to send to host 'E' outside the site, it prepares the
   packet with source address 2001:db8::5efe:192.0.2.18 and destination
   address 2001:db8:1::1.  'C' then uses IPv6-in-IPv4 encapsulation to
   forward the packet to the IPv4 address 192.0.2.17, which will be
   directed to 'A' based on IPv4 routing.  'A' in turn decapsulates the
   packet and forwards it into the public IPv6 Internet, where it will
   be conveyed to 'E' via normal IPv6 routing.  In the same fashion,
   host 'D' uses IPv6-in-IPv4 encapsulation via its default router 'B'
   to send IPv6 packets to IPv6 Internet hosts such as 'E'.





<span class="grey">Templin                       Informational                    [Page 11]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc6964.html">RFC 6964</a>               ISATAP Operational Guidance              May 2013</span>


   When host 'E' outside the site sends IPv6 packets to ISATAP host 'C'
   inside the site, the IPv6 routing system will direct the packet to
   'A' since 'A' advertises the individual prefix that matches 'C's
   destination address.  'A' can then use ISATAP to statelessly forward
   the packet directly to 'C'.  If 'A' and 'B' both advertise the shared
   shorter prefix 2001:db8::/48 into the IPv6 routing system, however,
   packets coming from 'E' may be directed to either 'A' or 'B'.  In
   that case, the advertising ISATAP routers must connect within a full
   or partial mesh of IPv6 links the same as for the shared prefix model
   and must either run a dynamic IPv6 routing protocol or configure
   static routes so that incoming IPv6 packets can be forwarded to the
   correct serving router.

   In this example, 'A' can configure the IPv6 route 2001:db8:0:2::/64
   with the IPv6 address of the next hop toward 'B' in the mesh network
   as the next hop, and 'B' can configure the IPv6 route
   2001:db8:0.1::/64 with the IPv6 address of the next hop toward 'A' as
   the next hop.  Then, when 'A' receives a packet from the IPv6
   Internet with destination address 2001:db8:0:2::5efe:192.0.2.34, it
   first forwards the packet toward 'B' over an IPv6 mesh link.  'B' in
   turn uses ISATAP to forward the packet into the site, where IPv4
   routing will direct it to 'D'.  In the same fashion, when 'B'
   receives a packet from the IPv6 Internet with destination address
   2001:db8:0:1::5efe:192.0.2.18, it first forwards the packet toward
   'A' over an IPv6 mesh link.  'A' then uses ISATAP to forward the
   packet into the site, where IPv4 routing will direct it to 'C'.

   Finally, when host 'C' inside the site connects to host 'D' inside
   the site, it has the option of using the native IPv4 service or the
   ISATAP IPv6-in-IPv4 encapsulation service.  When there is operational
   assurance that IPv4 services between the two hosts are available, the
   hosts may be better served to continue to use legacy IPv4 services in
   order to avoid encapsulation overhead and to avoid any IPv4
   protocol-41 filtering middleboxes that may be in the path.  If 'C'
   and 'D' may be in different IPv4 network partitions, however,
   IPv6-in-IPv4 encapsulation should be used with one or both of routers
   'A' and 'B' serving as intermediate gateways.

<span class="h3"><a class="selflink" name="section-3.5" href="#section-3.5">3.5</a>.  SLAAC Site Administration Guidance</span>

   In common practice, firewalls, gateways, and packet filtering devices
   of various forms are often deployed in order to divide the site into
   separate partitions.  In both the shared and individual prefix models
   described above, the entire site can be represented by the aggregate
   IPv6 prefix assigned to the site, while each site partition can be
   represented by "sliver" IPv6 prefixes taken from the aggregate.  In
   order to provide a simple service that does not interact poorly with
   the site topology, site administrators should therefore institute an



<span class="grey">Templin                       Informational                    [Page 12]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey"><a href="rfc6964.html">RFC 6964</a>               ISATAP Operational Guidance              May 2013</span>


   address plan to align IPv6 sliver prefixes with IPv4 site partition
   boundaries.

   For example, in the shared prefix model in <a href="#section-3.3">Section 3.3</a>, the aggregate
   prefix is 2001:db8::/64, and the sliver prefixes are
   2001:db8::5efe:192.0.2.0/124, 2001:db8::5efe:192.0.2.16/124,
   2001:db8::5efe:192.0.2.32/124, etc.  In the individual prefix model
   in <a href="#section-3.4">Section 3.4</a>, the aggregate prefix is 2001:db8::/48, and the sliver
   prefixes are 2001:db8:0:0::/64, 2001:db8:0:1::/64, 2001:db8:0:2::/64,
   etc.

   When individual prefixes are used, site administrators can configure
   advertising ISATAP routers to advertise different individual prefixes
   to different sets of clients, e.g., based on the client's IPv4 subnet
   prefix such that the IPv6 prefixes are congruent with the IPv4
   addressing plan.  (For example, administrators can configure each
   advertising ISATAP router to provide services only to certain sets of
   ISATAP clients through inbound IPv6 Access Control List (ACL) entries
   that match the IPv4 subnet prefix embedded in the ISATAP interface
   identifier of the IPv6 source address.)  When a shared prefix is
   used, site administrators instead configure the ISATAP routers to
   advertise the shared prefix to all clients.

   Advertising ISATAP routers can advertise prefixes with the (A, L)
   flags set to (1,0) so that ISATAP clients will use SLAAC to
   autoconfigure IPv6 addresses with ISATAP interface identifiers from
   the prefixes and assign them to the receiving ISATAP interface, but
   they will not assign the prefix itself to the ISATAP interface.  In
   that case, the advertising router must assign the sliver prefix for
   the site partition to the advertising ISATAP interface.  In this way,
   the advertising router considers the addresses covered by the sliver
   prefix as true ISATAP addresses, but the ISATAP clients themselves do
   not.  This configuration enables a hub-and-spoke architecture, which
   in some cases may be augmented by route optimization based on the
   receipt of ICMPv6 Redirects.

   Site administrators can implement address selection policy rules
   [<a href="rfc6724.html" title="&quot;Default Address Selection for Internet Protocol Version 6 (IPv6)&quot;">RFC6724</a>] through explicit configurations in each ISATAP client in
   order to give preference to IPv4 destination addresses over
   destination addresses derived from one of the client's IPv6 sliver
   prefixes.  For example, site administrators can configure each ISATAP
   client associated with a sliver prefix such as
   2001:db8::5efe:192.0.2.64/124 to add the prefix to its address
   selection policy table with a lower precedence than the prefix
   ::ffff:0:0/96.  In this way, IPv4 addresses are preferred over IPv6
   addresses from within the same sliver.  The prefix could be added to
   each ISATAP client either manually or through an automated service
   such as a DHCP option [<a href="#ref-ADDR-SELECT" title="&quot;Distributing Address Selection Policy using DHCPv6&quot;">ADDR-SELECT</a>] discovered by the client, e.g.,



<span class="grey">Templin                       Informational                    [Page 13]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey"><a href="rfc6964.html">RFC 6964</a>               ISATAP Operational Guidance              May 2013</span>


   using Stateless DHCPv6 [<a href="rfc3736.html" title="&quot;Stateless Dynamic Host Configuration Protocol (DHCP) Service for IPv6&quot;">RFC3736</a>].  In this way, clients will use IPv4
   communications to reach correspondents within the same IPv4 site
   partition and will use IPv6 communications to reach correspondents in
   other partitions and/or outside of the site.

   It should be noted that sliver prefixes longer than /64 cannot be
   advertised for SLAAC purposes.  Also, sliver prefixes longer than /64
   do not allow for interface identifier rewriting by address
   translators.  These factors may favor the individual prefix model in
   some deployment scenarios, while the flexibility afforded by the
   shared prefix model may be more desirable in others.  Additionally,
   if the network is small, then the shared prefix model works well.  If
   the network is large, however, a better alternative may be to deploy
   separate ISATAP routers in each partition and have each advertise its
   own individual prefix.

   Finally, site administrators should configure ISATAP routers to not
   send ICMPv6 Redirect messages to inform a source client of a better
   next hop toward the destination unless there is strong assurance that
   the client and the next hop are within the same IPv4 site partition.

<span class="h3"><a class="selflink" name="section-3.6" href="#section-3.6">3.6</a>.  Loop Avoidance</span>

   In sites that provide IPv6 services through ISATAP with SLAAC as
   described in this section, site administrators must take operational
   precautions to avoid routing loops.  For example, each advertising
   ISATAP router should drop any incoming IPv6 packets that would be
   forwarded back to itself via another of the site's advertising
   routers.  Additionally, each advertising ISATAP router should drop
   any encapsulated packets received from another advertising router
   that would be forwarded back to that same advertising router.  This
   corresponds to the mitigation documented in <a href="rfc6324.html#section-3.2.3">Section&nbsp;3.2.3 of
   [RFC6324]</a>, but other mitigations specified in that document can also
   be employed.

   Note that IPv6 packets with link-local ISATAP addresses are exempt
   from these checks, since they cannot be forwarded by an IPv6 router
   and may be necessary for router-to-router coordinations.

<span class="h3"><a class="selflink" name="section-3.7" href="#section-3.7">3.7</a>.  Considerations for Compatibility of Interface Identifiers</span>

   <a href="rfc5214.html#section-6.1">[RFC5214], Section&nbsp;6.1</a> specifies the setting of the "u" bit in the
   Modified EUI-64 interface identifier format used by ISATAP.
   Implementations that comply with the specification set the "u" bit to
   1 when the IPv4 address is known to be globally unique; however, some
   legacy implementations unconditionally set the "u" bit to 0.





<span class="grey">Templin                       Informational                    [Page 14]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-15" id="page-15" href="#page-15" class="invisible"> </a>
<span class="grey"><a href="rfc6964.html">RFC 6964</a>               ISATAP Operational Guidance              May 2013</span>


   Implementations interpret the ISATAP interface identifier only within
   the link to which the corresponding ISATAP prefix is assigned; hence,
   the value of the "u" bit is interpreted only within the context of an
   on-link prefix and not within a global context.  Implementers are
   responsible for ensuring that their products are interoperable;
   therefore, implementations must make provisions for ensuring "u" bit
   compatibility for intra-link communications.

   Site administrators should accordingly configure ACL entries and
   other literal representations of ISATAP interface identifiers such
   that both values of the "u" bit are accepted.  For example, if the
   site administrator configures an ACL entry that matches the prefix
   "fe80::0000:5efe:192.0.2.0/124", they should also configure a
   companion list entry that matches the prefix
   "fe80::0200:5efe:192.0.2.0/124".

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Manual Configuration</span>

   When no autoconfiguration services are available (e.g., if there are
   no advertising ISATAP routers present), site administrators can use
   manual configuration to assign IPv6 addresses with ISATAP interface
   identifiers to the ISATAP interfaces of clients.  Otherwise, site
   administrators should avoid manual configurations that would in any
   way invalidate the assumptions of the autoconfiguration service.  For
   example, manually configured addresses may not be automatically
   renumbered during a site-wide renumbering event, which could
   subsequently result in communication failures.

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  Scaling Considerations</span>

   <a href="#section-3">Section 3</a> depicts ISATAP network topologies with only two advertising
   ISATAP routers within the site.  In order to support larger numbers
   of ISATAP clients (and/or multiple site partitions), the site can
   deploy more advertising ISATAP routers to support load balancing and
   generally shortest-path routing.

   Such an arrangement requires that the advertising ISATAP routers
   participate in an IPv6 routing protocol instance so that IPv6
   addresses/prefixes can be mapped to the correct ISATAP router.  The
   routing protocol instance can be configured as either a full-mesh
   topology involving all advertising ISATAP routers, or as a partial-
   mesh topology with each advertising ISATAP router associating with
   one or more companion gateways.  Each such companion gateway would in
   turn participate in a full mesh between all companion gateways.







<span class="grey">Templin                       Informational                    [Page 15]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-16" id="page-16" href="#page-16" class="invisible"> </a>
<span class="grey"><a href="rfc6964.html">RFC 6964</a>               ISATAP Operational Guidance              May 2013</span>


<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Site Renumbering Considerations</span>

   Advertising ISATAP routers distribute IPv6 prefixes to ISATAP clients
   within the site.  If the site subsequently reconnects to a different
   ISP, however, the site must renumber to use addresses derived from
   the new IPv6 prefixes [<a href="rfc6879.html" title="&quot;IPv6 Enterprise Network Renumbering Scenarios, Considerations, and Methods&quot;">RFC6879</a>].

   For IPv6 services provided by SLAAC, site renumbering in the event of
   a change in an ISP-served IPv6 prefix entails a simple renumbering of
   IPv6 addresses and/or prefixes that are assigned to the ISATAP
   interfaces of clients within the site.  In some cases, filtering
   rules (e.g., within filtering tables at site-border firewalls) may
   also require renumbering, but this operation can be automated and
   limited to only one or a few administrative "touch points".

   In order to renumber the ISATAP interfaces of clients within the site
   using SLAAC, advertising ISATAP routers need only schedule the
   services offered by the old ISP for deprecation and begin to
   advertise the IPv6 prefixes provided by the new ISP.  Lifetimes of
   ISATAP client interface addresses will eventually expire, and the
   host will renumber its interfaces with addresses derived from the new
   prefixes.  ISATAP clients should also eventually remove any
   deprecated SLAAC prefixes from their address selection policy tables,
   but this action is not time-critical.

   Finally, site renumbering in the event of a change in an ISP-served
   IPv6 prefix further entails locating and rewriting all IPv6 addresses
   in naming services, databases, configuration files, packet filtering
   rules, documentation, etc.  If the site has published the IPv6
   addresses of any site-internal nodes within the public Internet DNS
   system, then the corresponding resource records will also need to be
   updated during the renumbering operation.  This can be accomplished
   via secure dynamic updates to the DNS.

<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  Path MTU Considerations</span>

   IPv6-in-IPv4 encapsulation overhead effectively reduces the size of
   IPv6 packets that can traverse the tunnel in relation to the actual
   Maximum Transmission Unit (MTU) of the underlying IPv4 network path
   between the tunnel ingress and egress.  Two methods for accommodating
   IPv6 path MTU discovery over IPv6-in-IPv4 tunnels (i.e., the static
   and dynamic methods) are documented in <a href="rfc4213.html#section-3.2">Section&nbsp;3.2 of [RFC4213]</a>.

   The static method places a "safe" upper bound on the size of IPv6
   packets permitted to enter the tunnel; however, the method can be
   overly conservative when larger IPv4 path MTUs are available.  The
   dynamic method can accommodate much larger IPv6 packet sizes in some




<span class="grey">Templin                       Informational                    [Page 16]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-17" id="page-17" href="#page-17" class="invisible"> </a>
<span class="grey"><a href="rfc6964.html">RFC 6964</a>               ISATAP Operational Guidance              May 2013</span>


   cases, but can fail silently if the underlying IPv4 network path does
   not return the necessary error messages.

   This document notes that sites that include well-managed IPv4 links,
   routers, and other network middleboxes are candidates for use of the
   dynamic MTU determination method, which may provide for a better
   operational IPv6 experience in the presence of IPv6-in-IPv4 tunnels.

   Finally, since all ISATAP tunnels terminate at a host, transport
   protocols that perform packet-size negotiations will see an IPv6 MTU
   that accounts for the encapsulation headers and therefore will avoid
   sending encapsulated packets that exceed the IPv4 path MTU.

<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  Alternative Approaches</span>

   [<a name="ref-RFC4554" id="ref-RFC4554">RFC4554</a>] proposes a use of VLANs for IPv4-IPv6 coexistence in
   enterprise networks.  The ISATAP approach provides a more flexible
   and broadly applicable alternative and with fewer administrative
   touch points.

   The tunnel broker service [<a href="rfc3053.html" title="&quot;IPv6 Tunnel Broker&quot;">RFC3053</a>] uses point-to-point tunnels that
   require end users to establish an explicit administrative
   configuration of the tunnel's far end, which may be outside of the
   administrative boundaries of the site.

   6to4 [<a href="rfc3056.html" title="&quot;Connection of IPv6 Domains via IPv4 Clouds&quot;">RFC3056</a>] and Teredo [<a href="rfc4380.html" title="&quot;Teredo: Tunneling IPv6 over UDP through Network Address Translations (NATs)&quot;">RFC4380</a>] provide "last resort" unmanaged
   automatic tunneling services when no other means for IPv6
   connectivity is available.  These services are given lower priority
   when the ISATAP managed service and/or native IPv6 services are
   enabled.

   6rd [<a href="rfc5969.html" title="&quot;IPv6 Rapid Deployment on IPv4 Infrastructures (6rd) -- Protocol Specification&quot;">RFC5969</a>] enables a stateless prefix delegation capability based
   on IPv4-embedded IPv6 prefixes, whereas ISATAP enables a stateful
   prefix delegation capability based on native IPv6 prefixes.

<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  Security Considerations</span>

   In addition to the security considerations documented in [<a href="rfc5214.html" title="&quot;Intra-Site Automatic Tunnel Addressing Protocol (ISATAP)&quot;">RFC5214</a>],
   sites that use ISATAP should take care to ensure that no routing
   loops are enabled [<a href="rfc6324.html" title="&quot;Routing Loop Attack Using IPv6 Automatic Tunnels: Problem Statement and Proposed Mitigations&quot;">RFC6324</a>].  Additional security concerns with IP
   tunneling are documented in [<a href="rfc6169.html" title="&quot;Security Concerns with IP Tunneling&quot;">RFC6169</a>].










<span class="grey">Templin                       Informational                    [Page 17]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-18" id="page-18" href="#page-18" class="invisible"> </a>
<span class="grey"><a href="rfc6964.html">RFC 6964</a>               ISATAP Operational Guidance              May 2013</span>


<span class="h2"><a class="selflink" name="section-10" href="#section-10">10</a>.  Acknowledgments</span>

   The following are acknowledged for their insights that helped shape
   this work: Dmitry Anipko, Fred Baker, Ron Bonica, Brian Carpenter,
   Remi Despres, Thomas Henderson, Philip Homburg, Lee Howard, Ray
   Hunter, Joel Jaeggli, John Mann, Gabi Nakibly, Christopher Palmer,
   Hemant Singh, Mark Smith, Ole Troan, and Gunter Van de Velde.

<span class="h2"><a class="selflink" name="section-11" href="#section-11">11</a>.  References</span>

<span class="h3"><a class="selflink" name="section-11.1" href="#section-11.1">11.1</a>.  Normative References</span>

   [<a name="ref-RFC3315" id="ref-RFC3315">RFC3315</a>]  Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C.,
              and M. Carney, "Dynamic Host Configuration Protocol for
              IPv6 (DHCPv6)", <a href="rfc3315.html">RFC 3315</a>, July 2003.

   [<a name="ref-RFC3736" id="ref-RFC3736">RFC3736</a>]  Droms, R., "Stateless Dynamic Host Configuration Protocol
              (DHCP) Service for IPv6", <a href="rfc3736.html">RFC 3736</a>, April 2004.

   [<a name="ref-RFC4213" id="ref-RFC4213">RFC4213</a>]  Nordmark, E. and R. Gilligan, "Basic Transition Mechanisms
              for IPv6 Hosts and Routers", <a href="rfc4213.html">RFC 4213</a>, October 2005.

   [<a name="ref-RFC4861" id="ref-RFC4861">RFC4861</a>]  Narten, T., Nordmark, E., Simpson, W., and H. Soliman,
              "Neighbor Discovery for IP version 6 (IPv6)", <a href="rfc4861.html">RFC 4861</a>,
              September 2007.

   [<a name="ref-RFC4862" id="ref-RFC4862">RFC4862</a>]  Thomson, S., Narten, T., and T. Jinmei, "IPv6 Stateless
              Address Autoconfiguration", <a href="rfc4862.html">RFC 4862</a>, September 2007.

   [<a name="ref-RFC5214" id="ref-RFC5214">RFC5214</a>]  Templin, F., Gleeson, T., and D. Thaler, "Intra-Site
              Automatic Tunnel Addressing Protocol (ISATAP)", <a href="rfc5214.html">RFC 5214</a>,
              March 2008.

<span class="h3"><a class="selflink" name="section-11.2" href="#section-11.2">11.2</a>.  Informative References</span>

   [<a name="ref-ADDR-SELECT" id="ref-ADDR-SELECT">ADDR-SELECT</a>]
              Matsumoto, A., Fujisaki, T., and T. Chown, "Distributing
              Address Selection Policy using DHCPv6", Work in Progress,
              April 2013.

   [<a name="ref-ENT-IPv6" id="ref-ENT-IPv6">ENT-IPv6</a>] Chittimaneni, K., Chown, T., Howard, L., Kuarsingh, V.,
              Pouffary, Y., and E. Vyncke, "Enterprise IPv6 Deployment
              Guidelines", Work in Progress, February 2013.

   [<a name="ref-ISATAP-UPDATE" id="ref-ISATAP-UPDATE">ISATAP-UPDATE</a>]
              Templin, F., <a style="text-decoration: none" href='https://www.google.com/search?sitesearch=tools.ietf.org%2Fhtml%2F&amp;q=inurl:draft-+%22ISATAP+Updates%22'>"ISATAP Updates"</a>, Work in Progress, May 2012.





<span class="grey">Templin                       Informational                    [Page 18]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-19" id="page-19" href="#page-19" class="invisible"> </a>
<span class="grey"><a href="rfc6964.html">RFC 6964</a>               ISATAP Operational Guidance              May 2013</span>


   [<a name="ref-RFC1687" id="ref-RFC1687">RFC1687</a>]  Fleischman, E., "A Large Corporate User's View of IPng",
              <a href="rfc1687.html">RFC 1687</a>, August 1994.

   [<a name="ref-RFC2491" id="ref-RFC2491">RFC2491</a>]  Armitage, G., Schulter, P., Jork, M., and G. Harter, "IPv6
              over Non-Broadcast Multiple Access (NBMA) networks", <a href="rfc2491.html">RFC</a>
              <a href="rfc2491.html">2491</a>, January 1999.

   [<a name="ref-RFC2529" id="ref-RFC2529">RFC2529</a>]  Carpenter, B. and C. Jung, "Transmission of IPv6 over IPv4
              Domains without Explicit Tunnels", <a href="rfc2529.html">RFC 2529</a>, March 1999.

   [<a name="ref-RFC2983" id="ref-RFC2983">RFC2983</a>]  Black, D., "Differentiated Services and Tunnels", <a href="rfc2983.html">RFC</a>
              <a href="rfc2983.html">2983</a>, October 2000.

   [<a name="ref-RFC3053" id="ref-RFC3053">RFC3053</a>]  Durand, A., Fasano, P., Guardini, I., and D. Lento, "IPv6
              Tunnel Broker", <a href="rfc3053.html">RFC 3053</a>, January 2001.

   [<a name="ref-RFC3056" id="ref-RFC3056">RFC3056</a>]  Carpenter, B. and K. Moore, "Connection of IPv6 Domains
              via IPv4 Clouds", <a href="rfc3056.html">RFC 3056</a>, February 2001.

   [<a name="ref-RFC3168" id="ref-RFC3168">RFC3168</a>]  Ramakrishnan, K., Floyd, S., and D. Black, "The Addition
              of Explicit Congestion Notification (ECN) to IP", <a href="rfc3168.html">RFC</a>
              <a href="rfc3168.html">3168</a>, September 2001.

   [<a name="ref-RFC4057" id="ref-RFC4057">RFC4057</a>]  Bound, J., "IPv6 Enterprise Network Scenarios", <a href="rfc4057.html">RFC 4057</a>,
              June 2005.

   [<a name="ref-RFC4380" id="ref-RFC4380">RFC4380</a>]  Huitema, C., "Teredo: Tunneling IPv6 over UDP through
              Network Address Translations (NATs)", <a href="rfc4380.html">RFC 4380</a>, February
              2006.

   [<a name="ref-RFC4554" id="ref-RFC4554">RFC4554</a>]  Chown, T., "Use of VLANs for IPv4-IPv6 Coexistence in
              Enterprise Networks", <a href="rfc4554.html">RFC 4554</a>, June 2006.

   [<a name="ref-RFC4852" id="ref-RFC4852">RFC4852</a>]  Bound, J., Pouffary, Y., Klynsma, S., Chown, T., and D.
              Green, "IPv6 Enterprise Network Analysis - IP Layer 3
              Focus", <a href="rfc4852.html">RFC 4852</a>, April 2007.

   [<a name="ref-RFC5969" id="ref-RFC5969">RFC5969</a>]  Townsley, W. and O. Troan, "IPv6 Rapid Deployment on IPv4
              Infrastructures (6rd) -- Protocol Specification", <a href="rfc5969.html">RFC</a>
              <a href="rfc5969.html">5969</a>, August 2010.

   [<a name="ref-RFC6169" id="ref-RFC6169">RFC6169</a>]  Krishnan, S., Thaler, D., and J. Hoagland, "Security
              Concerns with IP Tunneling", <a href="rfc6169.html">RFC 6169</a>, April 2011.

   [<a name="ref-RFC6324" id="ref-RFC6324">RFC6324</a>]  Nakibly, G. and F. Templin, "Routing Loop Attack Using
              IPv6 Automatic Tunnels: Problem Statement and Proposed
              Mitigations", <a href="rfc6324.html">RFC 6324</a>, August 2011.




<span class="grey">Templin                       Informational                    [Page 19]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-20" id="page-20" href="#page-20" class="invisible"> </a>
<span class="grey"><a href="rfc6964.html">RFC 6964</a>               ISATAP Operational Guidance              May 2013</span>


   [<a name="ref-RFC6724" id="ref-RFC6724">RFC6724</a>]  Thaler, D., Draves, R., Matsumoto, A., and T. Chown,
              "Default Address Selection for Internet Protocol Version 6
              (IPv6)", <a href="rfc6724.html">RFC 6724</a>, September 2012.

   [<a name="ref-RFC6879" id="ref-RFC6879">RFC6879</a>]  Jiang, S., Liu, B., and B. Carpenter, "IPv6 Enterprise
              Network Renumbering Scenarios, Considerations, and
              Methods", <a href="rfc6879.html">RFC 6879</a>, February 2013.

Author's Address

   Fred L. Templin
   Boeing Research &amp; Technology
   P.O. Box 3707 MC 7L-49
   Seattle, WA  98124
   USA

   EMail: fltemplin@acm.org


































Templin                       Informational                    [Page 20]

</pre><br />
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.129c, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>
</body>

<!-- Mirrored from tools.ietf.org/html/rfc6964 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:37:31 GMT -->
</html>
