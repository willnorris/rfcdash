<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7321 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:22 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="rfc4835" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:7321" name="DC.Identifier"/>
<meta content="August, 2014" name="DC.Date.Issued"/>
<meta content="McGrew, David" name="DC.Creator"/>
<meta content="Hoffman, Paul" name="DC.Creator"/>
<meta content="This document updates the Cryptographic Algorithm Implementation
Requirements for the Encapsulating Security Payload (ESP) and
Authentication Header (AH). It also adds usage guidance to help in the
selection of these algorithms.  ESP and AH protocols make use of
various cryptographic algorithms to provide confidentiality and/or
data origin authentication to protected data communications in the IP
Security (IPsec) architecture. To ensure interoperability between
disparate implementations, the IPsec standard specifies a set of
mandatory-to- implement algorithms. This document specifies the
current set of mandatory-to-implement algorithms for ESP and AH,
specifies algorithms that should be implemented because they may be
promoted to mandatory at some future time, and also recommends against
the implementation of some obsolete algorithms. Usage guidance is also
provided to help the user of ESP and AH best achieve their security
goals through appropriate choices of cryptographic algorithms." name="DC.Description.Abstract"/>
<meta content="Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7321 - Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgbrown" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7321.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7321" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-ipsecme-esp-ah-reqts" title="draft-ietf-ipsecme-esp-ah-reqts">draft-ietf-ipse...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7321" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7321" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7321" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">Obsoleted by: <a href="rfc8221.html">8221</a>                                     PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                         D. McGrew
Request for Comments: 7321                                 Cisco Systems
Obsoletes: <a href="rfc4835.html">4835</a>                                               P. Hoffman
Category: Standards Track                                 VPN Consortium
ISSN: 2070-1721                                              August 2014


 <span class="h1">Cryptographic Algorithm Implementation Requirements and Usage Guidance</span>
for Encapsulating Security Payload (ESP) and Authentication Header (AH)

Abstract

   This document updates the Cryptographic Algorithm Implementation
   Requirements for the Encapsulating Security Payload (ESP) and
   Authentication Header (AH).  It also adds usage guidance to help in
   the selection of these algorithms.

   ESP and AH protocols make use of various cryptographic algorithms to
   provide confidentiality and/or data origin authentication to
   protected data communications in the IP Security (IPsec)
   architecture.  To ensure interoperability between disparate
   implementations, the IPsec standard specifies a set of mandatory-to-
   implement algorithms.  This document specifies the current set of
   mandatory-to-implement algorithms for ESP and AH, specifies
   algorithms that should be implemented because they may be promoted to
   mandatory at some future time, and also recommends against the
   implementation of some obsolete algorithms.  Usage guidance is also
   provided to help the user of ESP and AH best achieve their security
   goals through appropriate choices of cryptographic algorithms.

   This document obsoletes <a href="rfc4835.html">RFC 4835</a>.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7321">http://www.rfc-editor.org/info/rfc7321</a>.






<span class="grey">McGrew &amp; Hoffman             Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7321.html">RFC 7321</a>               Requirements for ESP and AH           August 2014</span>


Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-1.1">1.1</a>.  Requirements Language . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Implementation Requirements . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
     2.1.  ESP Authenticated Encryption (Combined Mode Algorithms) .   4
     <a href="#section-2.2">2.2</a>.  ESP Encryption Algorithms . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-2.3">2.3</a>.  ESP Authentication Algorithms . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-2.4">2.4</a>.  AH Authentication Algorithms  . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-2.5">2.5</a>.  Summary of Changes from <a href="rfc4835.html">RFC 4835</a>  . . . . . . . . . . . .   <a href="#page-5">5</a>
   <a href="#section-3">3</a>.  Usage Guidance  . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
   <a href="#section-4">4</a>.  Rationale . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-4.1">4.1</a>.  Authenticated Encryption  . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-4.2">4.2</a>.  Encryption Transforms . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-4.3">4.3</a>.  Authentication Transforms . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
   <a href="#section-5">5</a>.  Algorithm Diversity . . . . . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
   <a href="#section-6">6</a>.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
   <a href="#section-7">7</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
   <a href="#section-8">8</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
     <a href="#section-8.1">8.1</a>.  Normative References  . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
     <a href="#section-8.2">8.2</a>.  Informative References  . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>



<span class="grey">McGrew &amp; Hoffman             Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7321.html">RFC 7321</a>               Requirements for ESP and AH           August 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The Encapsulating Security Payload (ESP) [<a href="rfc4303.html" title='"IP Encapsulating Security Payload (ESP)"'>RFC4303</a>] and the
   Authentication Header (AH) [<a href="rfc4302.html" title='"IP Authentication Header"'>RFC4302</a>] are the mechanisms for applying
   cryptographic protection to data being sent over an IPsec Security
   Association (SA) [<a href="rfc4301.html" title='"Security Architecture for the Internet Protocol"'>RFC4301</a>].

   To ensure interoperability between disparate implementations, it is
   necessary to specify a set of mandatory-to-implement algorithms.
   This ensures that there is at least one algorithm that all
   implementations will have in common.  This document specifies the
   current set of mandatory-to-implement algorithms for ESP and AH,
   specifies algorithms that should be implemented because they may be
   promoted to mandatory at some future time, and also recommends
   against the implementation of some obsolete algorithms.  Usage
   guidance is also provided to help the user of ESP and AH best achieve
   their security goals through appropriate choices of mechanisms.

   The nature of cryptography is that new algorithms surface
   continuously and existing algorithms are continuously attacked.  An
   algorithm believed to be strong today may be demonstrated to be weak
   tomorrow.  Given this, the choice of mandatory-to-implement algorithm
   should be conservative so as to minimize the likelihood of it being
   compromised quickly.  Thought should also be given to performance
   considerations, as many uses of IPsec will be in environments where
   performance is a concern.

   The ESP and AH mandatory-to-implement algorithm(s) may need to change
   over time to adapt to new developments in cryptography.  For this
   reason, the specification of the mandatory-to-implement algorithms is
   not included in the main IPsec, ESP, or AH specifications, but is
   instead placed in this document.  Ideally, the mandatory-to-implement
   algorithm of tomorrow should already be available in most
   implementations of IPsec by the time it is made mandatory.  To
   facilitate this, this document identifies such algorithms, as they
   are known today.  There is no guarantee that the algorithms that we
   predict will be mandatory in the future will actually be so.  All
   algorithms known today are subject to cryptographic attack and may be
   broken in the future.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Requirements%20Language"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Requirements Language</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].





<span class="grey">McGrew &amp; Hoffman             Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7321.html">RFC 7321</a>               Requirements for ESP and AH           August 2014</span>


   We define some additional keywords here:

   MUST-  This term means the same as MUST.  However, we expect that at
      some point in the future this algorithm will no longer be a MUST.

   SHOULD+  This term means the same as SHOULD.  However, it is likely
      that an algorithm marked as SHOULD+ will be promoted at some
      future time to be a MUST.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Implementation%20Requirements"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Implementation Requirements</span>

   This section specifies the cryptographic algorithms that MUST be
   implemented, and provides guidance about ones that SHOULD or SHOULD
   NOT be implemented.

   In the following sections, all AES modes are for 128-bit AES. 192-bit
   and 256-bit AES MAY be supported for those modes, but the
   requirements here are for 128-bit AES.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20ESP%20Authenticated%20Encryption%20%28Combined%20Mode%20Algorithms%29"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  ESP Authenticated Encryption (Combined Mode Algorithms)</span>

   ESP combined mode algorithms provide both confidentiality and
   authentication services; in cryptographic terms, these are
   authenticated encryption algorithms [<a href="rfc5116.html" title='"An Interface and Algorithms for Authenticated Encryption"'>RFC5116</a>].  Authenticated
   encryption transforms are listed in the ESP encryption transforms
   IANA registry.

   Requirement    Authenticated Encryption Algorithm
   -----------    ----------------------------------
   SHOULD+        AES-GCM with a 16 octet ICV [<a href="rfc4106.html" title='"The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP)"'>RFC4106</a>]
   MAY            AES-CCM [<a href="rfc4309.html" title='"Using Advanced Encryption Standard (AES) CCM Mode with IPsec Encapsulating Security Payload (ESP)"'>RFC4309</a>]

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20ESP%20Encryption%20Algorithms"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  ESP Encryption Algorithms</span>

   Requirement    Encryption Algorithm
   -----------    --------------------------
   MUST           NULL [<a href="rfc2410.html" title='"The NULL Encryption Algorithm and Its Use With IPsec"'>RFC2410</a>]
   MUST           AES-CBC [<a href="rfc3602.html" title='"The AES-CBC Cipher Algorithm and Its Use with IPsec"'>RFC3602</a>]
   MAY            AES-CTR [<a href="rfc3686.html" title='"Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP)"'>RFC3686</a>]
   MAY            TripleDES-CBC [<a href="rfc2451.html" title='"The ESP CBC-Mode Cipher Algorithms"'>RFC2451</a>]
   MUST NOT       DES-CBC [<a href="rfc2405.html" title='"The ESP DES-CBC Cipher Algorithm With Explicit IV"'>RFC2405</a>]










<span class="grey">McGrew &amp; Hoffman             Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7321.html">RFC 7321</a>               Requirements for ESP and AH           August 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20ESP%20Authentication%20Algorithms"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  ESP Authentication Algorithms</span>

   Requirement    Authentication Algorithm (notes)
   -----------    -----------------------------
   MUST           HMAC-SHA1-96 [<a href="rfc2404.html" title='"The Use of HMAC-SHA-1-96 within ESP and AH"'>RFC2404</a>]
   SHOULD+        AES-GMAC with AES-128 [<a href="rfc4543.html" title='"The Use of Galois Message Authentication Code (GMAC) in IPsec ESP and AH"'>RFC4543</a>]
   SHOULD         AES-XCBC-MAC-96 [<a href="rfc3566.html" title='"The AES-XCBC-MAC-96 Algorithm and Its Use With IPsec"'>RFC3566</a>]
   MAY            NULL [<a href="rfc4303.html" title='"IP Encapsulating Security Payload (ESP)"'>RFC4303</a>]

   Note that the requirement level for NULL authentication depends on
   the type of encryption used.  When using authenticated encryption
   from <a href="#section-2.1">Section 2.1</a>, the requirement for NULL encryption is the same as
   the requirement for the authenticated encryption itself.  When using
   the encryption from <a href="#section-2.2">Section 2.2</a>, the requirement for NULL encryption
   is truly "MAY"; see <a href="#section-3">Section 3</a> for more detail.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.4.%20%20AH%20Authentication%20Algorithms"></a><a class="selflink" href="#section-2.4" name="section-2.4">2.4</a>.  AH Authentication Algorithms</span>

   The requirements for AH are the same as for ESP Authentication
   Algorithms, except that NULL authentication is inapplicable.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.5.%20%20Summary%20of%20Changes%20from%20RFC%204835"></a><a class="selflink" href="#section-2.5" name="section-2.5">2.5</a>.  Summary of Changes from <a href="rfc4835.html">RFC 4835</a></span>

   The following is a summary of the changes from <a href="rfc4835.html">RFC 4835</a>.

   Old            New
   Requirement    Requirement      Algorithm (notes)
   ----           -----------      -----------------
   MAY            SHOULD+          AES-GCM with a 16 octet ICV [<a href="rfc4106.html" title='"The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP)"'>RFC4106</a>]
   MAY            SHOULD+          AES-GMAC with AES-128 [<a href="rfc4543.html" title='"The Use of Galois Message Authentication Code (GMAC) in IPsec ESP and AH"'>RFC4543</a>]
   MUST-          MAY              TripleDES-CBC [<a href="rfc2451.html" title='"The ESP CBC-Mode Cipher Algorithms"'>RFC2451</a>]
   SHOULD NOT     MUST NOT         DES-CBC [<a href="rfc2405.html" title='"The ESP DES-CBC Cipher Algorithm With Explicit IV"'>RFC2405</a>]
   SHOULD+        SHOULD           AES-XCBC-MAC-96 [<a href="rfc3566.html" title='"The AES-XCBC-MAC-96 Algorithm and Its Use With IPsec"'>RFC3566</a>]
   SHOULD         MAY              AES-CTR [<a href="rfc3686.html" title='"Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP)"'>RFC3686</a>]

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Usage%20Guidance"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Usage Guidance</span>

   Since ESP and AH can be used in several different ways, this document
   provides guidance on the best way to utilize these mechanisms.

   ESP can provide confidentiality, data origin authentication, or the
   combination of both of those security services.  AH provides only
   data origin authentication.  Background information on those security
   services is available [<a href="rfc4949.html" title='"Internet Security Glossary, Version 2"'>RFC4949</a>].  In the following, we shorten "data
   origin authentication" to "authentication".






<span class="grey">McGrew &amp; Hoffman             Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7321.html">RFC 7321</a>               Requirements for ESP and AH           August 2014</span>


   Providing both confidentiality and authentication offers the best
   security.  If confidentiality is not needed, providing authentication
   can still be useful.  Confidentiality without authentication is not
   effective [<a href="#ref-DP07" title='"Attacking the IPsec Standards in Encryption-only Configurations"'>DP07</a>] and therefore SHOULD NOT be used.  We describe each
   of these cases in more detail below.

   To provide both confidentiality and authentication, an authenticated
   encryption transform from <a href="#section-2.1">Section 2.1</a> SHOULD be used in ESP, in
   conjunction with NULL authentication.  Alternatively, an ESP
   encryption transform and ESP authentication transform MAY be used
   together.  It is NOT RECOMMENDED to use ESP with NULL authentication
   in conjunction with AH; some configurations of this combination of
   services have been shown to be insecure [<a href="#ref-PD10" title='"On the (in)security of IPsec in MAC-then-encrypt configurations"'>PD10</a>].

   To provide authentication without confidentiality, an authentication
   transform MUST be used in either ESP or AH.  The IPsec community
   generally prefers ESP with NULL encryption over AH.  AH is still
   required in some protocols and operational environments when there
   are security-sensitive options in the IP header, such as source
   routing headers; ESP inherently cannot protect those IP options.  It
   is not possible to provide effective confidentiality without
   authentication, because the lack of authentication undermines the
   trustworthiness of encryption [<a href="#ref-B96" title='"Problem areas for the IP security protocols"'>B96</a>][V02].  Therefore, an encryption
   transform MUST NOT be used with a NULL authentication transform
   (unless the encryption transform is an authenticated encryption
   transform from <a href="#section-2.1">Section 2.1</a>).

   Triple-DES SHOULD NOT be used in any scenario in which multiple
   gigabytes of data will be encrypted with a single key.  As a 64-bit
   block cipher, it leaks information about plaintexts above that
   "birthday bound" [<a href="#ref-M13" title='"Impossible plaintext cryptanalysis and probable-plaintext collision attacks of 64-bit block cipher modes"'>M13</a>].  Triple-DES CBC is listed as a MAY implement
   for the sake of backwards compatibility, but its use is discouraged.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Rationale"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Rationale</span>

   This section explains the principles behind the implementation
   requirements described above.

   The algorithms listed as "MAY implement" are not meant to be endorsed
   over other non-standard alternatives.  All of the algorithms that
   appeared in [<a href="rfc4835.html" title='"Cryptographic Algorithm Implementation Requirements for Encapsulating Security Payload (ESP) and Authentication Header (AH)"'>RFC4835</a>] are included in this document, for the sake of
   continuity.  In some cases, these algorithms have moved from being
   "SHOULD implement" to "MAY implement".








<span class="grey">McGrew &amp; Hoffman             Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7321.html">RFC 7321</a>               Requirements for ESP and AH           August 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Authenticated%20Encryption"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Authenticated Encryption</span>

   This document encourages the use of authenticated encryption
   algorithms because they can provide significant efficiency and
   throughput advantages, and the tight binding between authentication
   and encryption can be a security advantage [<a href="rfc5116.html" title='"An Interface and Algorithms for Authenticated Encryption"'>RFC5116</a>].

   AES-GCM [<a href="rfc4106.html" title='"The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP)"'>RFC4106</a>] brings significant performance benefits [<a href="#ref-KKGEGD" title='"Encrypting the Internet"'>KKGEGD</a>],
   has been incorporated into IPsec recommendations [<a href="rfc6379.html" title='"Suite B Cryptographic Suites for IPsec"'>RFC6379</a>], and has
   emerged as the preferred authenticated encryption method in IPsec and
   other standards.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Encryption%20Transforms"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Encryption Transforms</span>

   Since ESP encryption is optional, support for the "NULL" algorithm is
   required to maintain consistency with the way services are
   negotiated.  Note that while authentication and encryption can each
   be "NULL", they MUST NOT both be "NULL" [<a href="rfc4301.html" title='"Security Architecture for the Internet Protocol"'>RFC4301</a>] [<a href="#ref-H10" title='"Using Intel AES New Instructions and PCLMULQDQ to Significantly Improve IPSec Performance on Linux"'>H10</a>].

   AES Counter Mode (AES-CTR) is an efficient encryption method, but it
   provides no authentication capability.  The AES-GCM authenticated
   encryption method has all of the advantages of AES-CTR, while also
   providing authentication.  Thus, this document moves AES-CTR from a
   SHOULD to a MAY.

   The Triple Data Encryption Standard (TDES) is obsolete because of its
   small block size; as with all 64-bit block ciphers, it SHOULD NOT be
   used to encrypt more than one gigabyte of data with a single key
   [<a href="#ref-M13" title='"Impossible plaintext cryptanalysis and probable-plaintext collision attacks of 64-bit block cipher modes"'>M13</a>].  Its key size is smaller than that of the Advanced Encryption
   Standard (AES), while at the same time its performance and efficiency
   are worse.  Thus, its use in new implementations is discouraged.

   The Data Encryption Standard (DES) is obsolete because of its small
   key size and small block size.  There have been publicly demonstrated
   and open-design special-purpose cracking hardware.  Therefore, its
   use is has been changed to MUST NOT in this document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Authentication%20Transforms"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Authentication Transforms</span>

   AES-GMAC provides good security along with performance advantages,
   even over HMAC-MD5.  In addition, it uses the same internal
   components as AES-GCM and is easy to implement in a way that shares
   components with that authenticated encryption algorithm.

   The MD5 hash function has been found to not meet its goal of
   collision resistance; it is so weak that its use in digital
   signatures is highly discouraged [<a href="rfc6151.html" title='"Updated Security Considerations for the MD5 Message-Digest and the HMAC-MD5 Algorithms"'>RFC6151</a>].  There have been
   theoretical results against HMAC-MD5, but that message authentication



<span class="grey">McGrew &amp; Hoffman             Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7321.html">RFC 7321</a>               Requirements for ESP and AH           August 2014</span>


   code does not seem to have a practical vulnerability.  Thus, it may
   not be urgent to remove HMAC-MD5 from the existing protocols.

   SHA-1 has been found to not meet its goal of collision resistance.
   However, HMAC-SHA-1 does not rely on this property, and HMAC-SHA-1 is
   believed to be secure.

   HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 are believed to provide
   a good security margin, and they perform adequately on many
   platforms.  However, these algorithms are not recommended for
   implementation in this document, because HMAC-SHA-1 support is
   widespread and its security is good, AES-GMAC provides good security
   with better performance, and Authenticated Encryption algorithms do
   not need any authentication methods.

   AES-XCBC has not seen widespread deployment, despite being previously
   recommended as a SHOULD+ in <a href="rfc4835.html">RFC 4835</a>.  Thus, this document lists it
   only as a SHOULD.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Algorithm%20Diversity"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Algorithm Diversity</span>

   When the AES cipher was first adopted, it was decided to continue
   encouraging the implementation of Triple-DES, in order to provide
   algorithm diversity.  But the passage of time has eroded the
   viability of Triple-DES as an alternative to AES.  As it is a 64-bit
   block cipher, its security is inadequate at high data rates (see
   <a href="#section-4.2">Section 4.2</a>).  Its performance in software and Field-Programmable
   Gate Arrays (FPGAs) is considerably worse than that of AES.  Since it
   would not be possible to use Triple-DES as an alternative to AES in
   high data rate environments, or in environments where its performance
   could not keep up the requirements, the rationale of retaining
   Triple-DES to provide algorithm diversity is disappearing.  (Of
   course, this does not change the rationale of retaining Triple-DES in
   IPsec implementations for backwards compatibility.)

   Recent discussions in the IETF have started considering how to make
   the selection of a different cipher that could provide algorithm
   diversity in IPsec and other IETF standards.  That work is expected
   to take a long time and involve discussions among many participants
   and organizations.

   It is important to bear in mind that it is very unlikely that an
   exploitable flaw will be found in AES (e.g., a flaw that required
   less than a terabyte of known plaintext, when AES is used in a
   conventional mode of operation).  The only reason that algorithm
   diversity deserves any consideration is because there would be large
   problems if such a flaw were found.




<span class="grey">McGrew &amp; Hoffman             Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7321.html">RFC 7321</a>               Requirements for ESP and AH           August 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Acknowledgements"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Acknowledgements</span>

   Some of the wording herein was adapted from [<a href="rfc4835.html" title='"Cryptographic Algorithm Implementation Requirements for Encapsulating Security Payload (ESP) and Authentication Header (AH)"'>RFC4835</a>], the document
   that this one obsoletes.  That RFC itself borrows from earlier RFCs,
   notably <a href="rfc4305.html">RFC 4305</a> and 4307.  <a href="rfc4835.html">RFC 4835</a>, <a href="rfc4305.html">RFC 4305</a>, and <a href="rfc4307.html">RFC 4307</a> were
   authored by Vishwas Manral, Donald Eastlake, and Jeffrey Schiller
   respectively.

   Thanks are due to Wajdi Feghali, Brian Weis, Cheryl Madson, Dan
   Harkins, Paul Wouters, Ran Atkinson, Scott Fluhrer, Tero Kivinen, and
   Valery Smyslov for insightful feedback on this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Security%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Security Considerations</span>

   The security of a system that uses cryptography depends on both the
   strength of the cryptographic algorithms chosen and the strength of
   the keys used with those algorithms.  The security also depends on
   the engineering and administration of the protocol used by the system
   to ensure that there are no non-cryptographic ways to bypass the
   security of the overall system.

   This document concerns itself with the selection of cryptographic
   algorithms for the use of ESP and AH, specifically with the selection
   of mandatory-to-implement algorithms.  The algorithms identified in
   this document as "MUST implement" or "SHOULD implement" are not known
   to be broken at the current time, and cryptographic research to date
   leads us to believe that they will likely remain secure into the
   foreseeable future.  However, this is not necessarily forever.
   Therefore, we expect that revisions of that document will be issued
   from time to time to reflect the current best practice in this area.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20References"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Normative%20References"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC4301" name="ref-RFC4301">RFC4301</a>]  Kent, S. and K. Seo, "Security Architecture for the
              Internet Protocol", <a href="rfc4301.html">RFC 4301</a>, December 2005.

   [<a id="ref-RFC4302" name="ref-RFC4302">RFC4302</a>]  Kent, S., "IP Authentication Header", <a href="rfc4302.html">RFC 4302</a>, December
              2005.

   [<a id="ref-RFC4303" name="ref-RFC4303">RFC4303</a>]  Kent, S., "IP Encapsulating Security Payload (ESP)", <a href="rfc4303.html">RFC</a>
              <a href="rfc4303.html">4303</a>, December 2005.





<span class="grey">McGrew &amp; Hoffman             Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7321.html">RFC 7321</a>               Requirements for ESP and AH           August 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Informative%20References"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Informative References</span>

   [<a id="ref-B96" name="ref-B96">B96</a>]      Bellovin, S., "Problem areas for the IP security
              protocols", Proceedings of the Sixth Usenix Unix Security
              Symposium, 1996.

   [<a id="ref-DP07" name="ref-DP07">DP07</a>]     Degabriele, J. and K. Paterson, "Attacking the IPsec
              Standards in Encryption-only Configurations", IEEE
              Symposium on Privacy and Security, 2007.

   [<a id="ref-H10" name="ref-H10">H10</a>]      Hoban, A., "Using Intel AES New Instructions and PCLMULQDQ
              to Significantly Improve IPSec Performance on Linux",
              Intel White Paper, August 2010.

   [<a id="ref-KKGEGD" name="ref-KKGEGD">KKGEGD</a>]   Kounavis, M., Kang, X., Grewal, K., Eszenyi, M., Gueron,
              S., and D. Durham, "Encrypting the Internet", SIGCOMM,
              2010.

   [<a id="ref-M13" name="ref-M13">M13</a>]      McGrew, D., "Impossible plaintext cryptanalysis and
              probable-plaintext collision attacks of 64-bit block
              cipher modes", IACR ePrint, 2012.

   [<a id="ref-PD10" name="ref-PD10">PD10</a>]     Paterson, K. and J. Degabriele, "On the (in)security of
              IPsec in MAC-then-encrypt configurations", CCS '10, ACM
              Conference on Computer and Communications Security, 2010.

   [<a id="ref-RFC2404" name="ref-RFC2404">RFC2404</a>]  Madson, C. and R. Glenn, "The Use of HMAC-SHA-1-96 within
              ESP and AH", <a href="rfc2404.html">RFC 2404</a>, November 1998.

   [<a id="ref-RFC2405" name="ref-RFC2405">RFC2405</a>]  Madson, C. and N. Doraswamy, "The ESP DES-CBC Cipher
              Algorithm With Explicit IV", <a href="rfc2405.html">RFC 2405</a>, November 1998.

   [<a id="ref-RFC2410" name="ref-RFC2410">RFC2410</a>]  Glenn, R. and S. Kent, "The NULL Encryption Algorithm and
              Its Use With IPsec", <a href="rfc2410.html">RFC 2410</a>, November 1998.

   [<a id="ref-RFC2451" name="ref-RFC2451">RFC2451</a>]  Pereira, R. and R. Adams, "The ESP CBC-Mode Cipher
              Algorithms", <a href="rfc2451.html">RFC 2451</a>, November 1998.

   [<a id="ref-RFC3566" name="ref-RFC3566">RFC3566</a>]  Frankel, S. and H. Herbert, "The AES-XCBC-MAC-96 Algorithm
              and Its Use With IPsec", <a href="rfc3566.html">RFC 3566</a>, September 2003.

   [<a id="ref-RFC3602" name="ref-RFC3602">RFC3602</a>]  Frankel, S., Glenn, R., and S. Kelly, "The AES-CBC Cipher
              Algorithm and Its Use with IPsec", <a href="rfc3602.html">RFC 3602</a>, September
              2003.

   [<a id="ref-RFC3686" name="ref-RFC3686">RFC3686</a>]  Housley, R., "Using Advanced Encryption Standard (AES)
              Counter Mode With IPsec Encapsulating Security Payload
              (ESP)", <a href="rfc3686.html">RFC 3686</a>, January 2004.



<span class="grey">McGrew &amp; Hoffman             Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7321.html">RFC 7321</a>               Requirements for ESP and AH           August 2014</span>


   [<a id="ref-RFC4106" name="ref-RFC4106">RFC4106</a>]  Viega, J. and D. McGrew, "The Use of Galois/Counter Mode
              (GCM) in IPsec Encapsulating Security Payload (ESP)", <a href="rfc4106.html">RFC</a>
              <a href="rfc4106.html">4106</a>, June 2005.

   [<a id="ref-RFC4309" name="ref-RFC4309">RFC4309</a>]  Housley, R., "Using Advanced Encryption Standard (AES) CCM
              Mode with IPsec Encapsulating Security Payload (ESP)", <a href="rfc4309.html">RFC</a>
              <a href="rfc4309.html">4309</a>, December 2005.

   [<a id="ref-RFC4543" name="ref-RFC4543">RFC4543</a>]  McGrew, D. and J. Viega, "The Use of Galois Message
              Authentication Code (GMAC) in IPsec ESP and AH", <a href="rfc4543.html">RFC 4543</a>,
              May 2006.

   [<a id="ref-RFC4835" name="ref-RFC4835">RFC4835</a>]  Manral, V., "Cryptographic Algorithm Implementation
              Requirements for Encapsulating Security Payload (ESP) and
              Authentication Header (AH)", <a href="rfc4835.html">RFC 4835</a>, April 2007.

   [<a id="ref-RFC4949" name="ref-RFC4949">RFC4949</a>]  Shirey, R., "Internet Security Glossary, Version 2", <a href="rfc4949.html">RFC</a>
              <a href="rfc4949.html">4949</a>, August 2007.

   [<a id="ref-RFC5116" name="ref-RFC5116">RFC5116</a>]  McGrew, D., "An Interface and Algorithms for Authenticated
              Encryption", <a href="rfc5116.html">RFC 5116</a>, January 2008.

   [<a id="ref-RFC6151" name="ref-RFC6151">RFC6151</a>]  Turner, S. and L. Chen, "Updated Security Considerations
              for the MD5 Message-Digest and the HMAC-MD5 Algorithms",
              <a href="rfc6151.html">RFC 6151</a>, March 2011.

   [<a id="ref-RFC6379" name="ref-RFC6379">RFC6379</a>]  Law, L. and J. Solinas, "Suite B Cryptographic Suites for
              IPsec", <a href="rfc6379.html">RFC 6379</a>, October 2011.

   [<a id="ref-V02" name="ref-V02">V02</a>]      Vaudenay, S., "Security Flaws Induced by CBC Padding -
              Applications to SSL, IPSEC, WTLS ...", EUROCRYPT, 2002.

Authors' Addresses

   David McGrew
   Cisco Systems

   EMail: mcgrew@cisco.com


   Paul Hoffman
   VPN Consortium

   EMail: paul.hoffman@vpnc.org







McGrew &amp; Hoffman             Standards Track                   [Page 11]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7321 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:22 GMT --></html>