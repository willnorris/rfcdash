<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc4765 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:39 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:4765" name="DC.Identifier"/>
<meta content="The purpose of the Intrusion Detection Message Exchange Format (IDMEF)
is to define data formats and exchange procedures for sharing
information of interest to intrusion detection and response systems
and to the management systems that may need to interact with them.
This document describes a data model to represent information exported
by intrusion detection systems and explains the rationale for using
this model. An implementation of the data model in the Extensible
Markup Language (XML) is presented, an XML Document Type Definition is
developed, and examples are provided. This memo defines an
Experimental Protocol for the Internet community." name="DC.Description.Abstract"/>
<meta content="Debar, Herve" name="DC.Creator"/>
<meta content="Curry, David A." name="DC.Creator"/>
<meta content="Feinstein, Benjamin S." name="DC.Creator"/>
<meta content="March, 2007" name="DC.Date.Issued"/>
<meta content="The Intrusion Detection Message Exchange Format (IDMEF)" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 4765 - The Intrusion Detection Message Exchange Format (IDMEF)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgyellow" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc4765.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc4765" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-idwg-idmef-xml" title="draft-ietf-idwg-idmef-xml">draft-ietf-idwg...</a>] [<a href="https://datatracker.ietf.org/doc/rfc4765" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4765" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc4765" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                            EXPERIMENTAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                           H. Debar
Request for Comments: 4765                                France Telecom
Category: Experimental                                          D. Curry
                                                                Guardian
                                                            B. Feinstein
                                                       SecureWorks, Inc.
                                                              March 2007

        <span class="h1">The Intrusion Detection Message Exchange Format (IDMEF)</span>

Status of This Memo

   This memo defines an Experimental Protocol for the Internet
   community.  It does not specify an Internet standard of any kind.
   Discussion and suggestions for improvement are requested.
   Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The IETF Trust (2007).

IESG Note

   The content of this RFC was at one time considered by the IETF, but
   the working group concluded before this work was approved as a
   standards-track protocol.  This RFC is not a candidate for any level
   of Internet Standard.  The IETF disclaims any knowledge of the
   fitness of this RFC for any purpose and in particular notes that the
   decision to publish is not based on complete IETF review for such
   things as security, congestion control, or inappropriate interaction
   with deployed protocols.  The IESG has chosen to publish this
   document in order to document the work as it was when the working
   group concluded and to encourage experimentation and development of
   the technology.  Readers of this RFC should exercise caution in
   evaluating its value for implementation and deployment.

Abstract

   The purpose of the Intrusion Detection Message Exchange Format
   (IDMEF) is to define data formats and exchange procedures for sharing
   information of interest to intrusion detection and response systems
   and to the management systems that may need to interact with them.

   This document describes a data model to represent information
   exported by intrusion detection systems and explains the rationale
   for using this model.  An implementation of the data model in the
   Extensible Markup Language (XML) is presented, an XML Document Type
   Definition is developed, and examples are provided.



<span class="grey">Debar, et al.                 Experimental                      [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-4">4</a>
      <a href="#section-1.1">1.1</a>. About the IDMEF Data Model .................................<a href="#page-4">4</a>
           <a href="#section-1.1.1">1.1.1</a>. Problems Addressed by the Data Model ................<a href="#page-5">5</a>
           <a href="#section-1.1.2">1.1.2</a>. Data Model Design Goals .............................<a href="#page-6">6</a>
      <a href="#section-1.2">1.2</a>. About the IDMEF XML Implementation .........................<a href="#page-7">7</a>
           <a href="#section-1.2.1">1.2.1</a>. The Extensible Markup Language ......................<a href="#page-7">7</a>
           <a href="#section-1.2.2">1.2.2</a>. Rationale for Implementing IDMEF in XML .............<a href="#page-8">8</a>
   <a href="#section-2">2</a>. Notices and Conventions Used in This Document ..................<a href="#page-10">10</a>
   <a href="#section-3">3</a>. Notational Conventions and Formatting Issues ...................<a href="#page-10">10</a>
      <a href="#section-3.1">3.1</a>. IDMEF XML Documents .......................................<a href="#page-10">10</a>
           <a href="#section-3.1.1">3.1.1</a>. The Document Prolog ................................<a href="#page-10">10</a>
           <a href="#section-3.1.2">3.1.2</a>. Character Data Processing in IDMEF .................<a href="#page-11">11</a>
           <a href="#section-3.1.3">3.1.3</a>. Languages in IDMEF .................................<a href="#page-12">12</a>
      <a href="#section-3.2">3.2</a>. IDMEF Data Types ..........................................<a href="#page-12">12</a>
           <a href="#section-3.2.1">3.2.1</a>. Integers ...........................................<a href="#page-12">12</a>
           <a href="#section-3.2.2">3.2.2</a>. Real Numbers .......................................<a href="#page-12">12</a>
           <a href="#section-3.2.3">3.2.3</a>. Characters and Strings .............................<a href="#page-13">13</a>
           <a href="#section-3.2.4">3.2.4</a>. Bytes ..............................................<a href="#page-14">14</a>
           <a href="#section-3.2.5">3.2.5</a>. Enumerated Types ...................................<a href="#page-14">14</a>
           <a href="#section-3.2.6">3.2.6</a>. Date-Time Strings ..................................<a href="#page-14">14</a>
           <a href="#section-3.2.7">3.2.7</a>. NTP Timestamps .....................................<a href="#page-16">16</a>
           <a href="#section-3.2.8">3.2.8</a>. Port Lists .........................................<a href="#page-16">16</a>
           <a href="#section-3.2.9">3.2.9</a>. Unique Identifiers .................................<a href="#page-17">17</a>
   <a href="#section-4">4</a>. The IDMEF Data Model and DTD ...................................<a href="#page-18">18</a>
      <a href="#section-4.1">4.1</a>. Data Model Overview .......................................<a href="#page-18">18</a>
      <a href="#section-4.2">4.2</a>. The Message Classes .......................................<a href="#page-20">20</a>
           <a href="#section-4.2.1">4.2.1</a>. The IDMEF-Message Class ............................<a href="#page-20">20</a>
           <a href="#section-4.2.2">4.2.2</a>. The Alert Class ....................................<a href="#page-20">20</a>
           <a href="#section-4.2.3">4.2.3</a>. The Heartbeat Class ................................<a href="#page-27">27</a>
           <a href="#section-4.2.4">4.2.4</a>. The Core Classes ...................................<a href="#page-29">29</a>
           <a href="#section-4.2.5">4.2.5</a>. The Time Classes ...................................<a href="#page-41">41</a>
           <a href="#section-4.2.6">4.2.6</a>. The Assessment Classes .............................<a href="#page-42">42</a>
           <a href="#section-4.2.7">4.2.7</a>. The Support Classes ................................<a href="#page-47">47</a>
   <a href="#section-5">5</a>. Extending the IDMEF ............................................<a href="#page-79">79</a>
      <a href="#section-5.1">5.1</a>. Extending the Data Model ..................................<a href="#page-79">79</a>
      <a href="#section-5.2">5.2</a>. Extending the IDMEF DTD ...................................<a href="#page-80">80</a>
   <a href="#section-6">6</a>. Special Considerations .........................................<a href="#page-81">81</a>
      <a href="#section-6.1">6.1</a>. XML Validity and Well-Formedness ..........................<a href="#page-81">81</a>
      <a href="#section-6.2">6.2</a>. Unrecognized XML Tags .....................................<a href="#page-82">82</a>
      <a href="#section-6.3">6.3</a>. Analyzer-Manager Time Synchronization .....................<a href="#page-82">82</a>
      <a href="#section-6.4">6.4</a>. NTP Timestamp Wrap-Around .................................<a href="#page-84">84</a>
      <a href="#section-6.5">6.5</a>. Digital Signatures ........................................<a href="#page-85">85</a>
   <a href="#section-7">7</a>. Examples .......................................................<a href="#page-85">85</a>
      <a href="#section-7.1">7.1</a>. Denial-of-Service Attacks .................................<a href="#page-86">86</a>
           <a href="#section-7.1.1">7.1.1</a>. The "teardrop" Attack ..............................<a href="#page-86">86</a>
           <a href="#section-7.1.2">7.1.2</a>. The "ping of death" Attack .........................<a href="#page-87">87</a>



<span class="grey">Debar, et al.                 Experimental                      [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


      <a href="#section-7.2">7.2</a>. Port Scanning Attacks .....................................<a href="#page-88">88</a>
           <a href="#section-7.2.1">7.2.1</a>. Connection to a Disallowed Service .................<a href="#page-88">88</a>
           <a href="#section-7.2.2">7.2.2</a>. Simple Port Scanning ...............................<a href="#page-89">89</a>
      <a href="#section-7.3">7.3</a>. Local Attacks .............................................<a href="#page-90">90</a>
           <a href="#section-7.3.1">7.3.1</a>. The "loadmodule" Attack ............................<a href="#page-90">90</a>
           <a href="#section-7.3.2">7.3.2</a>. The "phf" Attack ...................................<a href="#page-93">93</a>
           <a href="#section-7.3.3">7.3.3</a>. File Modification ..................................<a href="#page-94">94</a>
      <a href="#section-7.4">7.4</a>. System Policy Violation ...................................<a href="#page-96">96</a>
      <a href="#section-7.5">7.5</a>. Correlated Alerts .........................................<a href="#page-98">98</a>
      <a href="#section-7.6">7.6</a>. Analyzer Assessments ......................................<a href="#page-99">99</a>
      <a href="#section-7.7">7.7</a>. Heartbeat ................................................<a href="#page-100">100</a>
      <a href="#section-7.8">7.8</a>. XML Extension ............................................<a href="#page-101">101</a>
   <a href="#section-8">8</a>. The IDMEF Document Type Definition (Normative) ................<a href="#page-104">104</a>
   <a href="#section-9">9</a>. Security Considerations .......................................<a href="#page-117">117</a>
   <a href="#section-10">10</a>. IANA Considerations ..........................................<a href="#page-118">118</a>
      <a href="#section-10.1">10.1</a>. Adding Values to Existing Attributes ....................<a href="#page-118">118</a>
           <a href="#section-10.1.1">10.1.1</a>. Attribute Registrations ..........................<a href="#page-119">119</a>
           <a href="#section-10.1.2">10.1.2</a>. Registration Template ............................<a href="#page-130">130</a>
      <a href="#section-10.2">10.2</a>. Adding New Attributes and Classes .......................<a href="#page-131">131</a>
   <a href="#section-11">11</a>. References ...................................................<a href="#page-131">131</a>
      <a href="#section-11.1">11.1</a>. Normative References ....................................<a href="#page-131">131</a>
      <a href="#section-11.2">11.2</a>. Informative References ..................................<a href="#page-132">132</a>
   <a href="#appendix-A">Appendix A</a>.  Acknowledgements ....................................<a href="#page-134">134</a>
   <a href="#appendix-B">Appendix B</a>.  The IDMEF Schema Definition (Non-normative) .........<a href="#page-135">135</a>



























<span class="grey">Debar, et al.                 Experimental                      [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The Intrusion Detection Message Exchange Format (IDMEF) [<a href="#ref-2" title='"Intrusion Detection Mesage Exchange Requirements"'>2</a>] is
   intended to be a standard data format that automated intrusion
   detection systems can use to report alerts about events that they
   deem suspicious.  The development of this standard format will enable
   interoperability among commercial, open source, and research systems,
   allowing users to mix-and-match the deployment of these systems
   according to their strong and weak points to obtain an optimal
   implementation.

   The most obvious place to implement the IDMEF is in the data channel
   between an intrusion detection analyzer (or "sensor") and the manager
   (or "console") to which it sends alarms.  But there are other places
   where the IDMEF can be useful:

   o  a single database system that could store the results from a
      variety of intrusion detection products would make it possible for
      data analysis and reporting activities to be performed on "the
      whole picture" instead of just a part of it;

   o  an event correlation system that could accept alerts from a
      variety of intrusion detection products would be capable of
      performing more sophisticated cross-correlation and cross-
      confirmation calculations than one that is limited to a single
      product;

   o  a graphical user interface that could display alerts from a
      variety of intrusion detection products would enable the user to
      monitor all of the products from a single screen, and require him
      or her to learn only one interface, instead of several; and

   o  a common data exchange format would make it easier for different
      organizations (users, vendors, response teams, law enforcement) to
      not only exchange data, but also communicate about it.

   The diversity of uses for the IDMEF needs to be considered when
   selecting its method of implementation.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20About%20the%20IDMEF%20Data%20Model"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  About the IDMEF Data Model</span>

   The IDMEF data model is an object-oriented representation of the
   alert data sent to intrusion detection managers by intrusion
   detection analyzers.







<span class="grey">Debar, et al.                 Experimental                      [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/1.1.1.%20%20Problems%20Addressed%20by%20the%20Data%20Model"></a><a class="selflink" href="#section-1.1.1" name="section-1.1.1">1.1.1</a>.  Problems Addressed by the Data Model</span>

   The data model addresses several problems associated with
   representing intrusion detection alert data:

   o  Alert information is inherently heterogeneous.  Some alerts are
      defined with very little information, such as origin, destination,
      name, and time of the event.  Other alerts provide much more
      information, such as ports or services, processes, user
      information, and so on.  The data model that represents this
      information must be flexible to accommodate different needs.

      An object-oriented model is naturally extensible via aggregation
      and subclassing.  If an implementation of the data model extends
      it with new classes, either by aggregation or subclassing, an
      implementation that does not understand these extensions will
      still be able to understand the subset of information that is
      defined by the data model.  Subclassing and aggregation provide
      extensibility while preserving the consistency of the model.

   o  Intrusion detection environments are different.  Some analyzers
      detect attacks by analyzing network traffic; others use operating
      system logs or application audit trail information.  Alerts for
      the same attack, sent by analyzers with different information
      sources, will not contain the same information.

      The data model defines support classes that accommodate the
      differences in data sources among analyzers.  In particular, the
      notions of source and target for the alert are represented by the
      combination of Node, Process, Service, and User classes.

   o  Analyzer capabilities are different.  Depending on the
      environment, one may install a lightweight analyzer that provides
      little information in its alerts, or a more complex analyzer that
      will have a greater impact on the running system but provide more
      detailed alert information.  The data model must allow for
      conversion to formats used by tools other than intrusion detection
      analyzers, for the purpose of further processing the alert
      information.

      The data model defines extensions to the basic Document Type
      Definition (DTD) that allow carrying both simple and complex
      alerts.  Extensions are accomplished through subclassing or
      association of new classes.







<span class="grey">Debar, et al.                 Experimental                      [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   o  Operating environments are different.  Depending on the kind of
      network or operating system used, attacks will be observed and
      reported with different characteristics.  The data model should
      accommodate these differences.

      Significant flexibility in reporting is provided by the Node and
      Service support classes.  If additional information must be
      reported, subclasses may be defined that extend the data model
      with additional attributes.

   o  Commercial vendor objectives are different.  For various reasons,
      vendors may wish to deliver more or less information about certain
      types of attacks.

      The object-oriented approach allows this flexibility while the
      subclassing rules preserve the integrity of the model.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/1.1.2.%20%20Data%20Model%20Design%20Goals"></a><a class="selflink" href="#section-1.1.2" name="section-1.1.2">1.1.2</a>.  Data Model Design Goals</span>

   The data model was designed to provide a standard representation of
   alerts in an unambiguous fashion, and to permit the relationship
   between simple and complex alerts to be described.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/1.1.2.1.%20%20Representing%20Events"></a><a class="selflink" href="#section-1.1.2.1" name="section-1.1.2.1">1.1.2.1</a>.  Representing Events</span>

   The goal of the data model is to provide a standard representation of
   the information that an intrusion detection analyzer reports when it
   detects an occurrence of some unusual event(s).  These alerts may be
   simple or complex, depending on the capabilities of the analyzer that
   creates them.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/1.1.2.2.%20%20Content-Driven"></a><a class="selflink" href="#section-1.1.2.2" name="section-1.1.2.2">1.1.2.2</a>.  Content-Driven</span>

   The design of the data model is content-driven.  This means that new
   objects are introduced to accommodate additional content, not
   semantic differences between alerts.  This is an important goal, as
   the task of classifying and naming computer vulnerabilities is both
   extremely difficult and very subjective.

   The data model must be unambiguous.  This means that while we allow
   analyzers to be more or less precise than one another (i.e., one
   analyzer may report more information about an event than another), we
   do not allow them to produce contradictory information in two alerts
   describing the same event (i.e., the common subset of information
   reported by both analyzers must be identical and inserted in the same
   placeholders within the alert data structure).  Of course, it is
   always possible to insert all "interesting" information about an




<span class="grey">Debar, et al.                 Experimental                      [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   event in extension fields of the alert instead of in the fields where
   it belongs; however, such practice reduces interoperability and
   should be avoided whenever possible.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/1.1.2.3.%20%20Relationship%20between%20Alerts"></a><a class="selflink" href="#section-1.1.2.3" name="section-1.1.2.3">1.1.2.3</a>.  Relationship between Alerts</span>

   Intrusion detection alerts can be transmitted at several levels.
   This document applies to the entire range, from very simple alerts
   (e.g., those alerts that are the result of a single action or
   operation in the system, such as a failed login report) to very
   complex ones (e.g., the aggregation of several events causing an
   alert to be generated).

   As such, the data model must provide a way for complex alerts that
   aggregate several simple alerts to identify those simple alerts in
   the complex alert's content.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20About%20the%20IDMEF%20XML%20Implementation"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  About the IDMEF XML Implementation</span>

   Two implementations of the IDMEF were originally proposed to the
   Intrusion Detection Working Group (IDWG): one using the Structure of
   Management Information (SMI) to describe a Simple Network Management
   Protocol (SNMP) MIB, and the other using a DTD to describe XML
   documents.

   These proposed implementations were reviewed by the IDWG at its
   September 1999 and February 2000 meetings; it was decided at the
   February meeting that the XML solution was best at fulfilling the
   IDWG requirements.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/1.2.1.%20%20The%20Extensible%20Markup%20Language"></a><a class="selflink" href="#section-1.2.1" name="section-1.2.1">1.2.1</a>.  The Extensible Markup Language</span>

   The Extensible Markup Language (XML) [<a href="#ref-3" title='"Extensible Markup Language (XML) 1.0 (Second Edition)"'>3</a>] is a simplified version of
   the Standard Generalized Markup Language (SGML), a syntax for
   specifying text markup defined by the ISO 8879 standard.  XML is
   gaining widespread attention as a language for representing and
   exchanging documents and data on the Internet, and as the solution to
   most of the problems inherent in HyperText Markup Language (HTML).
   XML was published as a recommendation by the World Wide Web
   Consortium (W3C) on February 10, 1998.

   XML is a metalanguage -- a language for describing other languages --
   that enables an application to define its own markup.  XML allows the
   definition of customized markup languages for different types of
   documents and different applications.  This differs from HTML, in
   which there is a fixed set of identifiers with preset meanings that
   must be "adapted" for specialized uses.  Both XML and HTML use
   elements (tags) (identifiers delimited by '&lt;' and '&gt;') and attributes



<span class="grey">Debar, et al.                 Experimental                      [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   (of the form "name='value'").  But where "&lt;p&gt;" always means
   "paragraph" in HTML, it may mean "paragraph", "person", "price", or
   "platypus" in XML, or it might have no meaning at all, depending on
   the particular application.

   NOTE:  XML provides both a syntax for declaring document markup and
      structure (i.e., defining elements and attributes, specifying the
      order in which they appear, and so on) and a syntax for using that
      markup in documents.  Because markup declarations look radically
      different from markup, many people are confused as to which syntax
      is called XML.  The answer is that they both are, because they are
      actually both part of the same language.

      For clarity in this document, we will use the terms "XML" and "XML
      documents" when speaking in the general case, and the term "IDMEF
      markup" when speaking specifically of the elements (tags) and
      attributes that describe IDMEF messages.

   The publication of XML was followed by the publication of a second
   recommendation [<a href="#ref-4" title='"Namespaces in XML"'>4</a>] by the World Wide Web Consortium, defining the use
   of namespaces in XML documents.  An XML namespace is a collection of
   names, identified by a Uniform Resource Identifier (URI) [<a href="#ref-5" title='"Uniform Resource Identifier (URI): Generic Syntax"'>5</a>].  When
   using namespaces, each tag is identified with the namespace it comes
   from, allowing tags from different namespaces with the same names to
   occur in the same document.  For example, a single document could
   contain both "usa:football" and "europe:football" tags, each with
   different meanings.

   In anticipation of the widespread use of XML namespaces, this memo
   includes the definition of the URI to be used to identify the IDMEF
   namespace.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/1.2.2.%20%20Rationale%20for%20Implementing%20IDMEF%20in%20XML"></a><a class="selflink" href="#section-1.2.2" name="section-1.2.2">1.2.2</a>.  Rationale for Implementing IDMEF in XML</span>

   XML-based applications are being used or developed for a wide variety
   of purposes, including electronic data interchange in a variety of
   fields, financial data interchange, electronic business cards,
   calendar and scheduling, enterprise software distribution, web "push"
   technology, and markup languages for chemistry, mathematics, music,
   molecular dynamics, astronomy, book and periodical publishing, web
   publishing, weather observations, real estate transactions, and many
   others.

   XML's flexibility makes it a good choice for these applications; that
   same flexibility makes it a good choice for implementing the IDMEF as
   well.  Other, more specific reasons for choosing XML to implement the
   IDMEF are:




<span class="grey">Debar, et al.                 Experimental                      [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   o  XML allows a custom language to be developed specifically for the
      purpose of describing intrusion detection alerts.  It also defines
      a standard way to extend this language, either for later revisions
      of this document ("standard" extensions) or for vendor-specific
      use ("non-standard" extensions).

   o  Software tools for processing XML documents are widely available,
      in both commercial and open source forms.  Numerous tools and APIs
      for parsing and/or validating XML are available in a variety of
      languages, including Java, C, C++, Tcl, Perl, Python, and GNU
      Emacs Lisp.  Widespread access to tools will make adoption of the
      IDMEF by product developers easier, and hopefully, faster.

   o  XML meets IDMEF Requirement 5.1 [<a href="#ref-2" title='"Intrusion Detection Mesage Exchange Requirements"'>2</a>], that message formats support
      full internationalization and localization.  The XML standard
      requires support for both the UTF-8 and UTF-16 encodings of ISO/
      IEC 10646 (Universal Multiple-Octet Coded Character Set, "UCS")
      and Unicode, making all XML applications (and therefore all IDMEF-
      compliant applications) compatible with these common character
      encodings.

      XML also provides support for specifying, on a per-element basis,
      the language in which the element's content is written, making
      IDMEF easy to adapt to "Natural Language Support" versions of a
      product.

   o  XML meets IDMEF Requirement 5.2 [<a href="#ref-2" title='"Intrusion Detection Mesage Exchange Requirements"'>2</a>], that message formats must
      support filtering and aggregation.  XML's integration with XSL, a
      style language, allows messages to be combined, discarded, and
      rearranged.

   o  Ongoing XML development projects, in the W3C and elsewhere, will
      provide object-oriented extensions, database support, and other
      useful features.  If implemented in XML, the IDMEF immediately
      gains these features as well.

   o  XML is free, with no license, no license fees, and no royalties.














<span class="grey">Debar, et al.                 Experimental                      [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Notices%20and%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Notices and Conventions Used in This Document</span>

   The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="#ref-1" title='"Key words for use in RFCs to Indicate Requirement Levels"'>1</a>].

   An "IDMEF-compliant application" is a program or program component,
   such as an analyzer or manager, that reads and/or writes messages in
   the format specified by this memo.

   An "IDMEF document" is a message that adheres to the requirements
   specified by this memo and that is exchanged by two or more IDMEF
   applications.  "IDMEF message" is another term for an "IDMEF
   document".

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Notational%20Conventions%20and%20Formatting%20Issues"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Notational Conventions and Formatting Issues</span>

   This document uses three notations: Unified Modeling Language to
   describe the data model [<a href="#ref-14" title='"The Unified Modeling Language Reference Model"'>14</a>], XML to describe the markup used in
   IDMEF documents, and IDMEF markup to represent the documents
   themselves.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20IDMEF%20XML%20Documents"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  IDMEF XML Documents</span>

   This section describes IDMEF XML document formatting rules.  Most of
   these rules are "inherited" from the rules for formatting XML
   documents.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.1.%20%20The%20Document%20Prolog"></a><a class="selflink" href="#section-3.1.1" name="section-3.1.1">3.1.1</a>.  The Document Prolog</span>

   The format of an IDMEF XML document prolog is described in the
   following sections.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.1.1.1.%20%20XML%20Declaration"></a><a class="selflink" href="#section-3.1.1.1" name="section-3.1.1.1">3.1.1.1</a>.  XML Declaration</span>

   IDMEF documents being exchanged between IDMEF-compliant applications
   MUST begin with an XML declaration, and MUST specify the XML version
   in use.  Specification of the encoding in use is RECOMMENDED.

   An IDMEF message SHOULD therefore start with:

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;

   &lt;idmef:IDMEF-Message version="1.0"
                        xmlns:idmef="http://iana.org/idmef"/&gt;






<span class="grey">Debar, et al.                 Experimental                     [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   IDMEF-compliant applications MAY choose to omit the XML declaration
   internally to conserve space, adding it only when the message is sent
   to another destination (e.g., a web browser).  This practice is NOT
   RECOMMENDED unless it can be accomplished without loss of each
   message's version and encoding information.

   In order to be valid (see <a href="#section-6.1">Section 6.1</a>), an XML document must contain
   a document type definition.  However, this represents significant
   overhead to an IDMEF-compliant application, both in the bandwidth it
   consumes as well as the requirements it places on the XML processor
   (not only to parse the declaration itself, but also to parse the DTD
   it references).

   Implementors MAY decide, therefore, to have analyzers and managers
   agree out-of-band on the particular document type definition they
   will be using to exchange messages (the standard one as defined here,
   or one with extensions), and then omit the document type definition
   from IDMEF messages.  The method for negotiating this agreement is
   outside the scope of this document.  Note that great care must be
   taken in negotiating any such agreements, as the manager may have to
   accept messages from many different analyzers, each using a DTD with
   a different set of extensions.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.2.%20%20Character%20Data%20Processing%20in%20IDMEF"></a><a class="selflink" href="#section-3.1.2" name="section-3.1.2">3.1.2</a>.  Character Data Processing in IDMEF</span>

   For portability reasons, IDMEF-compliant applications SHOULD NOT use,
   and IDMEF messages SHOULD NOT be encoded in, character encodings
   other than UTF-8 and UTF-16.  Consistent with the XML standard, if no
   encoding is specified for an IDMEF message, UTF-8 is assumed.

   NOTE:  The ASCII character set is a subset of the UTF-8 encoding, and
      therefore may be used to encode IDMEF messages.

   Per the XML standard, IDMEF documents encoded in UTF-16 MUST begin
   with the Byte Order Mark described by ISO/IEC 10646 Annex E and
   Unicode <a href="#appendix-B">Appendix B</a> (the "ZERO WIDTH NO-BREAK SPACE" character,
   #xFEFF).

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.1.2.1.%20%20Character%20Entity%20References"></a><a class="selflink" href="#section-3.1.2.1" name="section-3.1.2.1">3.1.2.1</a>.  Character Entity References</span>

   It is RECOMMENDED that IDMEF-compliant applications use the entity
   reference form (see <a href="#section-3.2.3.1">Section 3.2.3.1</a>) of the characters '&amp;', ,'&lt;',
   '&gt;', '"', and ''' (single-quote) whenever writing these characters in
   data, to avoid any possibility of misinterpretation.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.1.2.2.%20%20White%20Space%20Processing"></a><a class="selflink" href="#section-3.1.2.2" name="section-3.1.2.2">3.1.2.2</a>.  White Space Processing</span>

   All IDMEF elements MUST support the "xml:space" attribute.



<span class="grey">Debar, et al.                 Experimental                     [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.3.%20%20Languages%20in%20IDMEF"></a><a class="selflink" href="#section-3.1.3" name="section-3.1.3">3.1.3</a>.  Languages in IDMEF</span>

   IDMEF-compliant applications MUST specify the language in which their
   contents are encoded; in general this can be done by specifying the
   "xml:lang" attribute for the top-level element and letting all other
   elements "inherit" that definition [<a href="#ref-10" title='"Tags for Identifying Languages"'>10</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20IDMEF%20Data%20Types"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  IDMEF Data Types</span>

   Within an XML IDMEF message, all data will be expressed as "text" (as
   opposed to "binary"), since XML is a text formatting language.  We
   provide typing information for the attributes of the classes in the
   data model, however, to convey to the reader the type of data that
   the model expects for each attribute.

   Each data type in the model has specific formatting requirements in
   an XML IDMEF message; these requirements are set forth in this
   section.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.1.%20%20Integers"></a><a class="selflink" href="#section-3.2.1" name="section-3.2.1">3.2.1</a>.  Integers</span>

   Integer attributes are represented by the INTEGER data type.  Integer
   data MUST be encoded in Base 10 or Base 16.

   Base 10 integer encoding uses the digits '0' through '9' and an
   optional sign ('+' or '-').  For example, "123", "-456".

   Base 16 integer encoding uses the digits '0' through '9' and 'a'
   through 'f' (or their uppercase equivalents), and is preceded by the
   characters "0x".  For example, "0x1a2b".

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.2.%20%20Real%20Numbers"></a><a class="selflink" href="#section-3.2.2" name="section-3.2.2">3.2.2</a>.  Real Numbers</span>

   Real (floating-point) attributes are represented by the REAL data
   type.  Real data MUST be encoded in Base 10.

   Real encoding is that of the POSIX 1003.1 "strtod" library function:
   an optional sign ('+' or '-') followed by a non-empty string of
   decimal digits, optionally containing a radix character, then an
   optional exponent part.  An exponent part consists of an 'e' or 'E',
   followed by an optional sign, followed by one or more decimal digits.
   For example, "123.45e02", "-567,89e-03".

   IDMEF-compliant applications MUST support both the '.' and ',' radix
   characters.






<span class="grey">Debar, et al.                 Experimental                     [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.3.%20%20Characters%20and%20Strings"></a><a class="selflink" href="#section-3.2.3" name="section-3.2.3">3.2.3</a>.  Characters and Strings</span>

   Single-character attributes are represented by the CHARACTER data
   type.  Multi-character attributes of known length are represented by
   the STRING data type.

   Character and string data have no special formatting requirements,
   other than the need to occasionally use character references (see
   <a href="#section-3.2.3.1">Section 3.2.3.1</a> and <a href="#section-3.2.3.2">Section 3.2.3.2</a>) to represent special characters.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.2.3.1.%20%20Character%20Entity%20References"></a><a class="selflink" href="#section-3.2.3.1" name="section-3.2.3.1">3.2.3.1</a>.  Character Entity References</span>

   Within XML documents, certain characters have special meanings in
   some contexts.  To include the actual character itself in one of
   these contexts, a special escape sequence, called an entity
   reference, must be used.

   The characters that sometimes need to be escaped, and their entity
   references, are:

                     +-----------+------------------+
                     | Character | Entity Reference |
                     +-----------+------------------+
                     |         &amp; | &amp;amp;            |
                     |           |                  |
                     |         &lt; | &amp;lt;             |
                     |           |                  |
                     |         &gt; | &amp;gt;             |
                     |           |                  |
                     |         " | &amp;quot;           |
                     |           |                  |
                     |         ' | &amp;apos;           |
                     +-----------+------------------+

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.2.3.2.%20%20Character%20Code%20References"></a><a class="selflink" href="#section-3.2.3.2" name="section-3.2.3.2">3.2.3.2</a>.  Character Code References</span>

   Any character defined by the ISO/IEC 10646 and Unicode standards may
   be included in an XML document by the use of a character reference.
   A character reference is started with the characters '&amp;' and '#', and
   ended with the character ';'.  Between these characters, the
   character code for the character is inserted.

   If the character code is preceded by an 'x' it is interpreted in
   hexadecimal (base 16); otherwise, it is interpreted in decimal (base
   10).  For instance, the ampersand (&amp;) is encoded as &amp;#38; or &amp;#x0026;
   and the less-than sign (&lt;) is encoded as &amp;#60; or &amp;#x003C;.





<span class="grey">Debar, et al.                 Experimental                     [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   Any one-, two-, or four-byte character specified in the ISO/IEC 10646
   and Unicode standards can be included in a document using this
   technique.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.4.%20%20Bytes"></a><a class="selflink" href="#section-3.2.4" name="section-3.2.4">3.2.4</a>.  Bytes</span>

   Binary data is represented by the BYTE (and BYTE[]) data type.

   Binary data MUST be encoded in its entirety using base64.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.5.%20%20Enumerated%20Types"></a><a class="selflink" href="#section-3.2.5" name="section-3.2.5">3.2.5</a>.  Enumerated Types</span>

   Enumerated types are represented by the ENUM data type, and consist
   of an ordered list of acceptable values.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.6.%20%20Date-Time%20Strings"></a><a class="selflink" href="#section-3.2.6" name="section-3.2.6">3.2.6</a>.  Date-Time Strings</span>

   Date-time strings are represented by the DATETIME data type.  Each
   date-time string identifies a particular instant in time; ranges are
   not supported.

   Date-time strings are formatted according to a subset of ISO 8601:
   2000 [<a href="#ref-6" title='"Data elements and interchange formats - Information interchange - Representation of dates and times"'>6</a>], as show below.  Section references in parentheses refer to
   sections of the ISO 8601:2000 standard [<a href="#ref-6" title='"Data elements and interchange formats - Information interchange - Representation of dates and times"'>6</a>].

   1.  Dates MUST be formatted as follows:

          YYYY-MM-DD

       where YYYY is the four-digit year, MM is the two-digit month
       (01-12), and DD is the two-digit day (01-31).  (<a href="#section-5.2.1.1">Section 5.2.1.1</a>,
       "Complete representation -- Extended format".)

   2.  Times MUST be formatted as follows:

          hh:mm:ss

       where hh is the two-digit hour (00-24), mm is the two-digit
       minute (00-59), and ss is the two-digit second (00-60).  (<a href="#section-5.3.1.1">Section</a>
       <a href="#section-5.3.1.1">5.3.1.1</a>, "Complete representation -- Extended format".)

       Note that midnight has two representations, 00:00:00 and
       24:00:00.  Both representations MUST be supported by IDMEF-
       compliant applications; however, the 00:00:00 representation
       SHOULD be used whenever possible.






<span class="grey">Debar, et al.                 Experimental                     [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


       Note also that this format accounts for leap seconds.  Positive
       leap seconds are inserted between 23:59:59Z and 24:00:00Z and are
       represented as 23:59:60Z.  Negative leap seconds are achieved by
       the omission of 23:59:59Z.  IDMEF-compliant applications MUST
       support leap seconds.

   3.  Times MAY be formatted to include a decimal fraction of seconds,
       as follows:

          hh:mm:ss.ss or
          hh:mm:ss,ss

       As many digits as necessary may follow the decimal sign (at least
       one digit must follow the decimal sign).  Decimal fractions of
       hours and minutes are not supported.  (<a href="#section-5.3.1.3">Section 5.3.1.3</a>,
       "Representation of decimal fractions".)

       IDMEF-compliant applications MUST support the use of both decimal
       signs ('.' and ',').

       Note that the number of digits in the fraction part does not
       imply anything about accuracy -- i.e., "00.100000", "00,1000",
       and "00.1" are all equivalent.

   4.  Times MUST be formatted to include (a) an indication that the
       time is in Coordinated Universal Time (UTC) or (b) an indication
       of the difference between the specified time and Coordinated
       Universal Time.

       *  Times in UTC MUST be formatted by appending the letter 'Z' to
          the time string as follows:

             hh:mm:ssZ
             hh:mm:ss.ssZ
             hh:mm:ss,ssZ

          (<a href="#section-5.3.3">Section 5.3.3</a>, "Coordinated Universal Time (UTC) -- Extended
          format".)

       *  If the time is ahead of or equal to UTC, a '+' sign is
          appended to the time string; if the time is behind UTC, a '-'
          sign is appended.  Following the sign, the number of hours and
          minutes representing the different from UTC is appended, as
          follows:

             hh:mm:ss+hh:mm
             hh:mm:ss-hh:mm
             hh:mm:ss.ss+hh:mm



<span class="grey">Debar, et al.                 Experimental                     [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


             hh:mm:ss.ss-hh:mm
             hh:mm:ss,ss+hh:mm
             hh:mm:ss,ss-hh:mm

          The difference from UTC MUST be specified in both hours and
          minutes, even if the minutes component is 0.  A "difference"
          of "+00:00" is equivalent to UTC.  (<a href="#section-5.3.4.2">Section 5.3.4.2</a>, "Local
          time and the difference with Coordinated Universal Time --
          Extended Format".)

   5.  Date-time strings are created by joining the date and time
       strings with the letter 'T', as shown below:

          YYYY-MM-DDThh:mm:ssZ
          YYYY-MM-DDThh:mm:ss.ssZ
          YYYY-MM-DDThh:mm:ss,ssZ
          YYYY-MM-DDThh:mm:ss+hh:mm
          YYYY-MM-DDThh:mm:ss-hh:mm
          YYYY-MM-DDThh:mm:ss.ss+hh:mm
          YYYY-MM-DDThh:mm:ss.ss-hh:mm
          YYYY-MM-DDThh:mm:ss,ss+hh:mm
          YYYY-MM-DDThh:mm:ss,ss-hh:mm

       (<a href="#section-5.4.1">Section 5.4.1</a>, "Complete representation -- Extended format".)

   In summary, IDMEF date-time strings MUST adhere to one of the nine
   templates identified in Paragraph 5, above.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.7.%20%20NTP%20Timestamps"></a><a class="selflink" href="#section-3.2.7" name="section-3.2.7">3.2.7</a>.  NTP Timestamps</span>

   NTP timestamps are represented by the NTPSTAMP data type and are
   described in detail in [<a href="#ref-7" title='"Network Time Protocol (Version 3) Specification, Implementation"'>7</a>] and [<a href="#ref-8" title='"Simple Network Time Protocol (SNTP) Version 4 for IPv4, IPv6 and OSI"'>8</a>].  An NTP timestamp is a 64-bit
   unsigned fixed-point number.  The integer part is in the first 32
   bits, and the fraction part is in the last 32 bits.

   Within IDMEF messages, NTP timestamps MUST be encoded as two 32-bit
   hexadecimal values, separated by a period ('.').  For example,
   "0x12345678.0x87654321".

   See also <a href="#section-6.4">Section 6.4</a> for more information on NTP timestamps.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.8.%20%20Port%20Lists"></a><a class="selflink" href="#section-3.2.8" name="section-3.2.8">3.2.8</a>.  Port Lists</span>

   Port lists are represented by the PORTLIST data type and consist of a
   comma-separated list of numbers (individual integers) and ranges (N-M
   means ports N through M, inclusive).  Any combination of numbers and
   ranges may be used in a single list.  For example,
   "5-25,37,42,43,53,69-119,123-514".



<span class="grey">Debar, et al.                 Experimental                     [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.9.%20%20Unique%20Identifiers"></a><a class="selflink" href="#section-3.2.9" name="section-3.2.9">3.2.9</a>.  Unique Identifiers</span>

   There are two types of unique identifiers used in this specification.
   Both types are represented by STRING data types.

   These identifiers are implemented as attributes on the relevant XML
   elements, and they must have unique values as follows:

   1.  The Analyzer class' (<a href="#section-4.2.4.1">Section 4.2.4.1</a>) "analyzerid" attribute, if
       specified, MUST have a value that is unique across all analyzers
       in the intrusion detection environment.

       The "analyzerid" attribute is not required to be globally unique,
       only unique within the intrusion detection environment of which
       the analyzer is a member.  It is permissible for two analyzers,
       in different intrusion detection environments, to have the same
       value for "analyzerid".

       The default value is "0", which indicates that the analyzer
       cannot generate unique identifiers.

   2.  The Alert and Heartbeat messages (Sections <a href="#section-4.2.2">4.2.2</a>, <a href="#section-4.2.3">4.2.3</a>) must be
       uniquely identified by the couple (analyzerid,messageid), if the
       analyzer supports the generation of message identifiers.

   3.  The Classification, Source, Target, Node, User, Process, Service,
       File, Address, and UserId classes' (Sections <a href="#section-4.2.4.2">4.2.4.2</a>, <a href="#section-4.2.4.3">4.2.4.3</a>,
       4.2.4.4, 4.2.7.2, 4.2.7.3, 4.2.7.4, 4.2.7.5, 4.2.7.6, 4.2.7.2.1,
       and 4.2.7.3.1) "ident" attribute, if specified, MUST have a value
       that is unique across all messages sent by the individual
       analyzer.

       The "ident" attribute value MUST be unique for each particular
       combination of data identifying an object, not for each object.
       Objects may have more than one "ident" value associated with
       them.  For example, an identification of a host by name would
       have one value, while an identification of that host by address
       would have another value, and an identification of that host by
       both name and address would have still another value.
       Furthermore, different analyzers may produce different values for
       the same information.

       The "ident" attribute by itself provides a unique identifier only
       among all the "ident" values sent by a particular analyzer.  But
       when combined with the "analyzerid" value for the analyzer, a
       value that is unique across the intrusion detection environment
       is created.  Again, there is no requirement for global
       uniqueness.



<span class="grey">Debar, et al.                 Experimental                     [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


       The default value is "0", which indicates that the analyzer
       cannot generate unique identifiers.

   The specification of methods for creating the unique values contained
   in these attributes is outside the scope of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20The%20IDMEF%20Data%20Model%20and%20DTD"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  The IDMEF Data Model and DTD</span>

   In this section, the individual components of the IDMEF data model
   are explained in detail.  Unified Modeling Language (UML) diagrams of
   the model are provided to show how the components are related to each
   other, and relevant sections of the IDMEF DTD are presented to show
   how the model is translated into XML.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Data%20Model%20Overview"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Data Model Overview</span>

   The relationship between the principal components of the data model
   is shown in Figure 1 (occurrence indicators and attributes are
   omitted).

   The top-level class for all IDMEF messages is IDMEF-Message; each
   type of message is a subclass of this top-level class.  There are
   presently two types of messages defined: Alerts and Heartbeats.
   Within each message, subclasses of the message class are used to
   provide the detailed information carried in the message.

   It is important to note that the data model does not specify how an
   alert should be classified or identified.  For example, a port scan
   may be identified by one analyzer as a single attack against multiple
   targets, while another analyzer might identify it as multiple attacks
   from a single source.  However, once an analyzer has determined the
   type of alert it plans to send, the data model dictates how that
   alert should be formatted.


















<span class="grey">Debar, et al.                 Experimental                     [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


                         IDMEF-Message
                              /_\
                               |
          +--------------------+-------------+
          |                                  |
      +-------+   +--------------+    +-----------+   +----------------+
      | Alert |&lt;&gt;-|   Analyzer   |    | Heartbeat |&lt;&gt;-|    Analyzer    |
      +-------+   +--------------+    +-----------+   +----------------+
      |       |   +--------------+    |           |   +----------------+
      |       |&lt;&gt;-|  CreateTime  |    |           |&lt;&gt;-|   CreateTime   |
      |       |   +--------------+    |           |   +----------------+
      |       |   +--------------+    |           |   +----------------+
      |       |&lt;&gt;-|  DetectTime  |    |           |&lt;&gt;-| AdditionalData |
      |       |   +--------------+    +-----------+   +----------------+
      |       |   +--------------+
      |       |&lt;&gt;-| AnalyzerTime |
      |       |   +--------------+
      |       |   +--------+   +----------+
      |       |&lt;&gt;-| Source |&lt;&gt;-|   Node   |
      |       |   +--------+   +----------+
      |       |   |        |   +----------+
      |       |   |        |&lt;&gt;-|   User   |
      |       |   |        |   +----------+
      |       |   |        |   +----------+
      |       |   |        |&lt;&gt;-| Process  |
      |       |   |        |   +----------+
      |       |   |        |   +----------+
      |       |   |        |&lt;&gt;-| Service  |
      |       |   +--------+   +----------+
      |       |   +--------+   +----------+
      |       |&lt;&gt;-| Target |&lt;&gt;-|   Node   |
      |       |   +--------+   +----------+
      |       |   |        |   +----------+
      |       |   |        |&lt;&gt;-|   User   |
      |       |   |        |   +----------+
      |       |   |        |   +----------+
      |       |   |        |&lt;&gt;-| Process  |
      |       |   |        |   +----------+
      |       |   |        |   +----------+
      |       |   |        |&lt;&gt;-| Service  |       +----------------+
      |       |   |        |   +----------+  +----| Classification |
      |       |   |        |   +----------+  |    +----------------+
      |       |   |        |&lt;&gt;-|   File   |  |    +----------------+
      |       |   +--------+   +----------+  | +--|   Assessment   |
      |       |&lt;&gt;----------------------------+ |  +----------------+
      |       |&lt;&gt;------------------------------+  +----------------+
      |       |&lt;&gt;---------------------------------| AdditionalData |
      +-------+                                   +----------------+



<span class="grey">Debar, et al.                 Experimental                     [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


                       Figure 1: Data Model Overview

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20The%20Message%20Classes"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  The Message Classes</span>

   The individual classes are described in the following sections.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.1.%20%20The%20IDMEF-Message%20Class"></a><a class="selflink" href="#section-4.2.1" name="section-4.2.1">4.2.1</a>.  The IDMEF-Message Class</span>

   All IDMEF messages are instances of the IDMEF-Message class; it is
   the top-level class of the IDMEF data model, as well as the IDMEF
   DTD.  There are currently two types (subclasses) of IDMEF-Message:
   Alert and Heartbeat.

   The IDMEF-Message class has a single attribute:

   version

      The version of the IDMEF-Message specification (this document)
      this message conforms to.  Applications specifying a value for
      this attribute MUST specify the value "1.0".

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.2.%20%20The%20Alert%20Class"></a><a class="selflink" href="#section-4.2.2" name="section-4.2.2">4.2.2</a>.  The Alert Class</span>

   Generally, every time an analyzer detects an event that it has been
   configured to look for, it sends an Alert message to its manager(s).
   Depending on the analyzer, an Alert message may correspond to a
   single detected event or multiple detected events.  Alerts occur
   asynchronously in response to outside events.

   An Alert message is composed of several aggregate classes, as shown
   in Figure 2.  The aggregate classes themselves are described in
   <a href="#section-4.2.4">Section 4.2.4</a>, <a href="#section-4.2.5">Section 4.2.5</a>, and <a href="#section-4.2.6">Section 4.2.6</a>.



















<span class="grey">Debar, et al.                 Experimental                     [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


              +-------------------+
              |    Alert          |
              +-------------------+            +------------------+
              | STRING messageid  |&lt;&gt;----------|     Analyzer     |
              |                   |            +------------------+
              |                   |            +------------------+
              |                   |&lt;&gt;----------|    CreateTime    |
              |                   |            +------------------+
              |                   |            +------------------+
              |                   |&lt;&gt;----------|  Classification  |
              |                   |            +------------------+
              |                   |       0..1 +------------------+
              |                   |&lt;&gt;----------|    DetectTime    |
              |                   |            +------------------+
              |                   |       0..1 +------------------+
              |                   |&lt;&gt;----------|   AnalyzerTime   |
              |                   |            +------------------+
              |                   |       0..* +------------------+
              |                   |&lt;&gt;----------|      Source      |
              |                   |            +------------------+
              |                   |       0..* +------------------+
              |                   |&lt;&gt;----------|      Target      |
              |                   |            +------------------+
              |                   |       0..1 +------------------+
              |                   |&lt;&gt;----------|    Assessment    |
              |                   |            +------------------+
              |                   |       0..* +------------------+
              |                   |&lt;&gt;----------|  AdditionalData  |
              |                   |            +------------------+
              +-------------------+
                     /_\
                      |
                      +----+------------+-------------+
                           |            |             |
                +-------------------+   |   +-------------------+
                |     ToolAlert     |   |   |  CorrelationAlert |
                +-------------------+   |   +-------------------+
                                        |
                              +-------------------+
                              |   OverflowAlert   |
                              +-------------------+

                         Figure 2: The Alert Class








<span class="grey">Debar, et al.                 Experimental                     [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   The aggregate classes that make up Alert are:

   Analyzer

      Exactly one.  Identification information for the analyzer that
      originated the alert.

   CreateTime

      Exactly one.  The time the alert was created.  Of the three times
      that may be provided with an Alert, this is the only one that is
      required.

   Classification

      Exactly one.  The "name" of the alert, or other information
      allowing the manager to determine what it is.

   DetectTime

      Zero or one.  The time the event(s) leading up to the alert was
      detected.  In the case of more than one event, the time the first
      event was detected.  In some circumstances, this may not be the
      same value as CreateTime.

   AnalyzerTime

      Zero or one.  The current time on the analyzer (see <a href="#section-6.3">Section 6.3</a>).

   Source

      Zero or more.  The source(s) of the event(s) leading up to the
      alert.

   Target

      Zero or more.  The target(s) of the event(s) leading up to the
      alert.

   Assessment

      Zero or one.  Information about the impact of the event, actions
      taken by the analyzer in response to it, and the analyzer's
      confidence in its evaluation.







<span class="grey">Debar, et al.                 Experimental                     [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   AdditionalData

      Zero or more.  Information included by the analyzer that does not
      fit into the data model.  This may be an atomic piece of data, or
      a large amount of data provided through an extension to the IDMEF
      (see <a href="#section-5">Section 5</a>).

   Alert is represented in the IDMEF DTD as follows:

   &lt;!ELEMENT Alert                         (
       Analyzer, CreateTime, DetectTime?, AnalyzerTime?,
       Source*, Target*, Classification, Assessment?, (ToolAlert |
       OverflowAlert | CorrelationAlert)?, AdditionalData*
     )&gt;
   &lt;!ATTLIST Alert
       messageid           CDATA                   '0'
       %attlist.global;
     &gt;

   The Alert class has one attribute:

   messageid

      Optional.  A unique identifier for the alert; see <a href="#section-3.2.9">Section 3.2.9</a>.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.2.1.%20%20The%20ToolAlert%20Class"></a><a class="selflink" href="#section-4.2.2.1" name="section-4.2.2.1">4.2.2.1</a>.  The ToolAlert Class</span>

   The ToolAlert class carries additional information related to the use
   of attack tools or malevolent programs such as Trojan horses and can
   be used by the analyzer when it is able to identify these tools.  It
   is intended to group one or more previously-sent alerts together, to
   say "these alerts were all the result of someone using this tool".

   The ToolAlert class is composed of three aggregate classes, as shown
   in Figure 3.
















<span class="grey">Debar, et al.                 Experimental                     [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


             +------------------+
             |      Alert       |
             +------------------+
                     /_\
                      |
             +------------------+
             |    ToolAlert     |
             +------------------+            +-------------------+
             |                  |&lt;&gt;----------|        name       |
             |                  |            +-------------------+
             |                  |       0..1 +-------------------+
             |                  |&lt;&gt;----------|      command      |
             |                  |            +-------------------+
             |                  |       1..* +-------------------+
             |                  |&lt;&gt;----------|    alertident     |
             |                  |            +-------------------+
             |                  |            | STRING analyzerid |
             |                  |            +-------------------+
             +------------------+

                       Figure 3: The ToolAlert Class

   The aggregate classes that make up ToolAlert are:

   name

      Exactly one.  STRING.  The reason for grouping the alerts
      together, for example, the name of a particular tool.

   command

      Zero or one.  STRING.  The command or operation that the tool was
      asked to perform, for example, a BackOrifice ping.

   alertident

      One or more.  STRING.  The list of alert identifiers that are
      related to this alert.  Because alert identifiers are only unique
      across the alerts sent by a single analyzer, the optional
      "analyzerid" attribute of "alertident" should be used to identify
      the analyzer that a particular alert came from.  If the
      "analyzerid" is not provided, the alert is assumed to have come
      from the same analyzer that is sending the ToolAlert.








<span class="grey">Debar, et al.                 Experimental                     [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   This is represented in the IDMEF DTD as follows:

   &lt;!ELEMENT ToolAlert                     (
       name, command?, alertident+
     )&gt;
   &lt;!ATTLIST ToolAlert
       %attlist.global;
     &gt;

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.2.2.%20%20The%20CorrelationAlert%20Class"></a><a class="selflink" href="#section-4.2.2.2" name="section-4.2.2.2">4.2.2.2</a>.  The CorrelationAlert Class</span>

   The CorrelationAlert class carries additional information related to
   the correlation of alert information.  It is intended to group one or
   more previously-sent alerts together, to say "these alerts are all
   related".

   The CorrelationAlert class is composed of two aggregate classes, as
   shown in Figure 4.

             +------------------+
             |      Alert       |
             +------------------+
                     /_\
                      |
             +------------------+
             | CorrelationAlert |
             +------------------+            +-------------------+
             |                  |&lt;&gt;----------|        name       |
             |                  |            +-------------------+
             |                  |       1..* +-------------------+
             |                  |&lt;&gt;----------|    alertident     |
             |                  |            +-------------------+
             |                  |            | STRING analyzerid |
             |                  |            +-------------------+
             +------------------+

                   Figure 4: The CorrelationAlert Class

   The aggregate classes that make up CorrelationAlert are:

   name

      Exactly one.  STRING.  The reason for grouping the alerts
      together, for example, a particular correlation method.







<span class="grey">Debar, et al.                 Experimental                     [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   alertident

      One or more.  STRING.  The list of alert identifiers that are
      related to this alert.  Because alert identifiers are only unique
      across the alerts sent by a single analyzer, the optional
      "analyzerid" attribute of "alertident" should be used to identify
      the analyzer that a particular alert came from.  If the
      "analyzerid" is not provided, the alert is assumed to have come
      from the same analyzer that is sending the CorrelationAlert.

   This is represented in the IDMEF DTD as follows.

   &lt;!ELEMENT CorrelationAlert              (
       name, alertident+
     )&gt;
   &lt;!ATTLIST CorrelationAlert
       %attlist.global;
     &gt;

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.2.3.%20%20The%20OverflowAlert%20Class"></a><a class="selflink" href="#section-4.2.2.3" name="section-4.2.2.3">4.2.2.3</a>.  The OverflowAlert Class</span>

   The OverflowAlert carries additional information related to buffer
   overflow attacks.  It is intended to enable an analyzer to provide
   the details of the overflow attack itself.

   The OverflowAlert class is composed of three aggregate classes, as
   shown in Figure 5.

                  +------------------+
                  |      Alert       |
                  +------------------+
                          /_\
                           |
                  +------------------+
                  |  OverflowAlert   |
                  +------------------+            +---------+
                  |                  |&lt;&gt;----------| program |
                  |                  |            +---------+
                  |                  |       0..1 +---------+
                  |                  |&lt;&gt;----------| size    |
                  |                  |            +---------+
                  |                  |       0..1 +---------+
                  |                  |&lt;&gt;----------| buffer  |
                  |                  |            +---------+
                  +------------------+

                     Figure 5: The OverflowAlert Class




<span class="grey">Debar, et al.                 Experimental                     [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   The aggregate classes that make up OverflowAlert are:

   program

      Exactly one.  STRING.  The program that the overflow attack
      attempted to run (NOTE: this is not the program that was
      attacked).

   size

      Zero or one.  INTEGER.  The size, in bytes, of the overflow (i.e.,
      the number of bytes the attacker sent).

   buffer

      Zero or one.  BYTE[].  Some or all of the overflow data itself
      (dependent on how much the analyzer can capture).

   This is represented in the IDMEF DTD as follows:

   &lt;!ELEMENT OverflowAlert                 (
       program, size?, buffer?
     )&gt;
   &lt;!ATTLIST OverflowAlert
       %attlist.global;
     &gt;

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.3.%20%20The%20Heartbeat%20Class"></a><a class="selflink" href="#section-4.2.3" name="section-4.2.3">4.2.3</a>.  The Heartbeat Class</span>

   Analyzers use Heartbeat messages to indicate their current status to
   managers.  Heartbeats are intended to be sent in a regular period,
   say, every ten minutes or every hour.  The receipt of a Heartbeat
   message from an analyzer indicates to the manager that the analyzer
   is up and running; lack of a Heartbeat message (or more likely, lack
   of some number of consecutive Heartbeat messages) indicates that the
   analyzer or its network connection has failed.

   All managers MUST support the receipt of Heartbeat messages; however,
   the use of these messages by analyzers is OPTIONAL.  Developers of
   manager software SHOULD permit the software to be configured on a
   per-analyzer basis to use/not use Heartbeat messages.

   A Heartbeat message is composed of several aggregate classes, as
   shown in Figure 6.  The aggregate classes themselves are described in
   Sections <a href="#section-4.2.4">4.2.4</a> and <a href="#section-4.2.5">4.2.5</a>.






<span class="grey">Debar, et al.                 Experimental                     [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


               +------------------+
               |    Heartbeat     |
               +------------------+            +------------------+
               | STRING messageid |&lt;&gt;----------|     Analyzer     |
               |                  |            +------------------+
               |                  |            +------------------+
               |                  |&lt;&gt;----------|    CreateTime    |
               |                  |            +------------------+
               |                  |       0..1 +------------------+
               |                  |&lt;&gt;----------| HeartbeatInterval|
               |                  |            +------------------+
               |                  |       0..1 +------------------+
               |                  |&lt;&gt;----------|   AnalyzerTime   |
               |                  |            +------------------+
               |                  |       0..* +------------------+
               |                  |&lt;&gt;----------|  AdditionalData  |
               |                  |            +------------------+
               +------------------+

                       Figure 6: The Heartbeat Class

   The aggregate classes that make up Heartbeat are:

   Analyzer

      Exactly one.  Identification information for the analyzer that
      originated the heartbeat.

   CreateTime

      Exactly one.  The time the heartbeat was created.

   HeartbeatInterval

      Zero or one.  The interval in seconds at which heartbeats are
      generated.

   AnalyzerTime

      Zero or one.  The current time on the analyzer (see <a href="#section-6.3">Section 6.3</a>).

   AdditionalData

      Zero or more.  Information included by the analyzer that does not
      fit into the data model.  This may be an atomic piece of data or a
      large amount of data provided through an extension to the IDMEF
      (see <a href="#section-5">Section 5</a>).




<span class="grey">Debar, et al.                 Experimental                     [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   This is represented in the IDMEF DTD as follows:

   &lt;!ELEMENT Heartbeat                     (
       Analyzer, CreateTime, HeartbeatInterval?, AnalyzerTime?,
       AdditionalData*
     )&gt;
   &lt;!ATTLIST Heartbeat
       messageid           CDATA                   '0'
       %attlist.global;
     &gt;

   The Heartbeat class has one attribute:

   messageid

      Optional.  A unique identifier for the heartbeat; see
      <a href="#section-3.2.9">Section 3.2.9</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.4.%20%20The%20Core%20Classes"></a><a class="selflink" href="#section-4.2.4" name="section-4.2.4">4.2.4</a>.  The Core Classes</span>

   The core classes -- Analyzer, Source, Target, Classification, and
   AdditionalData -- are the main parts of Alerts and Heartbeats, as
   shown in Figure 7.

                +-----------+                +----------------+
                | Heartbeat |        +-------|    Analyzer    |
                +-----------+        |       +----------------+
                |           |&lt;&gt;---+--+
                +-----------+     |  |  0..* +----------------+
                                  |  +-------| AdditionalData |
                                  |          +----------------+
                +-----------+     |
                |   Alert   |     |     0..* +----------------+
                +-----------+     |  +-------|     Source     |
                |           |&lt;&gt;---+  |       +----------------+
                |           |        |  0..* +----------------+
                |           |        +-------|     Target     |
                |           |        |       +----------------+
                |           |&lt;&gt;------+
                +-----------+        |       +----------------+
                                     +-------| Classification |
                                             +----------------+

                        Figure 7: The Core Classes







<span class="grey">Debar, et al.                 Experimental                     [Page 29]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.4.1.%20%20The%20Analyzer%20Class"></a><a class="selflink" href="#section-4.2.4.1" name="section-4.2.4.1">4.2.4.1</a>.  The Analyzer Class</span>

   The Analyzer class identifies the analyzer from which the Alert or
   Heartbeat message originates.  Only one analyzer may be encoded for
   each alert or heartbeat, and that MUST be the analyzer at which the
   alert or heartbeat originated.  Although the IDMEF data model does
   not prevent the use of hierarchical intrusion detection systems
   (where alerts get relayed up the tree), it does not provide any way
   to record the identity of the "relay" analyzers along the path from
   the originating analyzer to the manager that ultimately receives the
   alert.

   The Analyzer class is composed of three aggregate classes, as shown
   in Figure 8.

                +---------------------+
                |      Analyzer       |
                +---------------------+       0..1 +----------+
                | STRING analyzerid   |&lt;&gt;----------|  Node    |
                | STRING name         |            +----------+
                | STRING manufacturer |
                | STRING model        |       0..1 +----------+
                | STRING version      |&lt;&gt;----------| Process  |
                | STRING class        |            +----------+
                | STRING ostype       |       0..1 +----------+
                | STRING osversion    |&lt;&gt;----------| Analyzer |
                +---------------------+            +----------+

                       Figure 8: The Analyzer Class

   The aggregate classes that make up Analyzer are:

   Node

      Zero or one.  Information about the host or device on which the
      analyzer resides (network address, network name, etc.).

   Process

      Zero or one.  Information about the process in which the analyzer
      is executing.

   Analyzer

      Zero or one.  Information about the analyzer from which the
      message may have gone through.  The idea behind this mechanism is
      that when a manager receives an alert and wants to forward it to
      another analyzer, it needs to substitute the original analyzer



<span class="grey">Debar, et al.                 Experimental                     [Page 30]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


      information with its own.  To preserve the original analyzer
      information, it may be included in the new analyzer definition.
      This will allow analyzer path tracking.

   This is represented in the IDMEF DTD as follows:

   &lt;!ELEMENT Analyzer                      (
       Node?, Process?, Analyzer?
     )&gt;
   &lt;!ATTLIST Analyzer
       analyzerid          CDATA                   '0'
       name                CDATA                   #IMPLIED
       manufacturer        CDATA                   #IMPLIED
       model               CDATA                   #IMPLIED
       version             CDATA                   #IMPLIED
       class               CDATA                   #IMPLIED
       ostype              CDATA                   #IMPLIED
       osversion           CDATA                   #IMPLIED
       %attlist.global;
     &gt;

   The Analyzer class has eight attributes:

   analyzerid

      Optional (but see below).  A unique identifier for the analyzer;
      see <a href="#section-3.2.9">Section 3.2.9</a>.

      This attribute is only "partially" optional.  If the analyzer
      makes use of the "ident" attributes on other classes to provide
      unique identifiers for those objects, then it MUST also provide a
      valid "analyzerid" attribute.  This requirement is dictated by the
      uniqueness requirements of the "ident" attribute (they are unique
      only within the context of a particular "analyzerid").  If the
      analyzer does not make use of the "ident" attributes, however, it
      may also omit the "analyzerid" attribute.

   name

      Optional.  An explicit name for the analyzer that may be easier to
      understand than the analyzerid.

   manufacturer

      Optional.  The manufacturer of the analyzer software and/or
      hardware.





<span class="grey">Debar, et al.                 Experimental                     [Page 31]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   model

      Optional.  The model name/number of the analyzer software and/or
      hardware.

   version

      Optional.  The version number of the analyzer software and/or
      hardware.

   class

      Optional.  The class of analyzer software and/or hardware.

   ostype

      Optional.  Operating system name.  On POSIX 1003.1 compliant
      systems, this is the value returned in utsname.sysname by the
      uname() system call, or the output of the "uname -s" command.

   osversion

      Optional.  Operating system version.  On POSIX 1003.1 compliant
      systems, this is the value returned in utsname.release by the
      uname() system call, or the output of the "uname -r" command.

   The "manufacturer", "model", "version", and "class" attributes'
   contents are vendor-specific, but may be used together to identify
   different types of analyzers (and perhaps make determinations about
   the contents to expect in other vendor-specific fields of IDMEF
   messages).

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.4.2.%20%20The%20Classification%20Class"></a><a class="selflink" href="#section-4.2.4.2" name="section-4.2.4.2">4.2.4.2</a>.  The Classification Class</span>

   The Classification class provides the "name" of an alert, or other
   information allowing the manager to determine what it is.  This name
   is chosen by the alert provider.

   The Classification class is composed of one aggregate class, as shown
   in Figure 9.











<span class="grey">Debar, et al.                 Experimental                     [Page 32]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


                    +----------------+
                    | Classification |
                    +----------------+       0..* +-----------+
                    | STRING ident   |&lt;&gt;----------| Reference |
                    | STRING text    |            +-----------+
                    +----------------+

                    Figure 9: The Classification Class

   The aggregate class that makes up Classification is:

   Reference

      Zero or more.  Information about the message, pointing to external
      documentation sites, that will provide background information
      about the alert.

   This is represented in the IDMEF DTD as follows:

   &lt;!ELEMENT Classification                (
       Reference*
     )&gt;
   &lt;!ATTLIST Classification
       ident               CDATA                   '0'
       text                CDATA                   #REQUIRED
     &gt;

   The Classification class has two attributes:

   ident

      Optional.  A unique identifier for this classification; see
      <a href="#section-3.2.9">Section 3.2.9</a>.

   text

      Required.  A vendor-provided string identifying the Alert message.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.4.3.%20%20The%20Source%20Class"></a><a class="selflink" href="#section-4.2.4.3" name="section-4.2.4.3">4.2.4.3</a>.  The Source Class</span>

   The Source class contains information about the possible source(s) of
   the event(s) that generated an alert.  An event may have more than
   one source (e.g., in a distributed denial-of-service attack).

   The Source class is composed of four aggregate classes, as shown in
   Figure 10.





<span class="grey">Debar, et al.                 Experimental                     [Page 33]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-34" id="page-34" name="page-34"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


                  +------------------+
                  |      Source      |
                  +------------------+       0..1 +---------+
                  | STRING ident     |&lt;&gt;----------|  Node   |
                  | ENUM spoofed     |            +---------+
                  | STRING interface |       0..1 +---------+
                  |                  |&lt;&gt;----------|  User   |
                  |                  |            +---------+
                  |                  |       0..1 +---------+
                  |                  |&lt;&gt;----------| Process |
                  |                  |            +---------+
                  |                  |       0..1 +---------+
                  |                  |&lt;&gt;----------| Service |
                  |                  |            +---------+
                  +------------------+

                        Figure 10: The Source Class

   The aggregate classes that make up Source are:

   Node

      Zero or one.  Information about the host or device that appears to
      be causing the events (network address, network name, etc.).

   User

      Zero or one.  Information about the user that appears to be
      causing the event(s).

   Process

      Zero or one.  Information about the process that appears to be
      causing the event(s).

   Service

      Zero or one.  Information about the network service involved in
      the event(s).












<span class="grey">Debar, et al.                 Experimental                     [Page 34]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-35" id="page-35" name="page-35"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   This is represented in the IDMEF DTD as follows:

   &lt;!ELEMENT Source                        (
       Node?, User?, Process?, Service?
     )&gt;
   &lt;!ATTLIST Source
       ident               CDATA                   '0'
       spoofed             %attvals.yesno;         'unknown'
       interface           CDATA                   #IMPLIED
       %attlist.global;
     &gt;

   The Source class has three attributes:

   ident

      Optional.  A unique identifier for this source; see <a href="#section-3.2.9">Section 3.2.9</a>.

   spoofed

      Optional.  An indication of whether the source is, as far as the
      analyzer can determine, a spoofed address used for hiding the real
      origin of the attack.  The permitted values for this attribute are
      shown below.  The default value is "unknown".  (See also
      <a href="#section-10">Section 10</a>.)

        +------+---------+----------------------------------------+
        | Rank | Keyword | Description                            |
        +------+---------+----------------------------------------+
        |    0 | unknown | Accuracy of source information unknown |
        |      |         |                                        |
        |    1 | yes     | Source is believed to be a decoy       |
        |      |         |                                        |
        |    2 | no      | Source is believed to be "real"        |
        +------+---------+----------------------------------------+

   interface

      Optional.  May be used by a network-based analyzer with multiple
      interfaces to indicate which interface this source was seen on.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.4.4.%20%20The%20Target%20Class"></a><a class="selflink" href="#section-4.2.4.4" name="section-4.2.4.4">4.2.4.4</a>.  The Target Class</span>

   The Target class contains information about the possible target(s) of
   the event(s) that generated an alert.  An event may have more than
   one target (e.g., in the case of a port sweep).





<span class="grey">Debar, et al.                 Experimental                     [Page 35]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-36" id="page-36" name="page-36"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   The Target class is composed of four aggregate classes, as shown in
   Figure 11.

                  +------------------+
                  |      Target      |
                  +------------------+       0..1 +----------+
                  | STRING ident     |&lt;&gt;----------|   Node   |
                  | ENUM decoy       |            +----------+
                  | STRING interface |       0..1 +----------+
                  |                  |&lt;&gt;----------|   User   |
                  |                  |            +----------+
                  |                  |       0..1 +----------+
                  |                  |&lt;&gt;----------| Process  |
                  |                  |            +----------+
                  |                  |       0..1 +----------+
                  |                  |&lt;&gt;----------| Service  |
                  |                  |            +----------+
                  |                  |       0..n +----------+
                  |                  |&lt;&gt;----------|   File   |
                  |                  |            +----------+
                  +------------------+

                        Figure 11: The Target Class

   The aggregate classes that make up Target are:

   Node

      Zero or one.  Information about the host or device at which the
      event(s) (network address, network name, etc.) is being directed.

   User

      Zero or one.  Information about the user at which the event(s) is
      being directed.

   Process

      Zero or one.  Information about the process at which the event(s)
      is being directed.

   Service

      Zero or one.  Information about the network service involved in
      the event(s).






<span class="grey">Debar, et al.                 Experimental                     [Page 36]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-37" id="page-37" name="page-37"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   File

      Optional.  Information about file(s) involved in the event(s).

   This is represented in the IDMEF DTD as follows:

   &lt;!ELEMENT Target                        (
       Node?, User?, Process?, Service?, File*
     )&gt;
   &lt;!ATTLIST Target
       ident               CDATA                   '0'
       decoy               %attvals.yesno;         'unknown'
       interface           CDATA                   #IMPLIED
       %attlist.global;
     &gt;

   The Target class has three attributes:

   ident

      Optional.  A unique identifier for this target, see <a href="#section-3.2.9">Section 3.2.9</a>.

   decoy

      Optional.  An indication of whether the target is, as far as the
      analyzer can determine, a decoy.  The permitted values for this
      attribute are shown below.  The default value is "unknown".  (See
      also <a href="#section-10">Section 10</a>.)

        +------+---------+----------------------------------------+
        | Rank | Keyword | Description                            |
        +------+---------+----------------------------------------+
        |    0 | unknown | Accuracy of target information unknown |
        |      |         |                                        |
        |    1 | yes     | Target is believed to be a decoy       |
        |      |         |                                        |
        |    2 | no      | Target is believed to be "real"        |
        +------+---------+----------------------------------------+

   interface

      Optional.  May be used by a network-based analyzer with multiple
      interfaces to indicate which interface this target was seen on.








<span class="grey">Debar, et al.                 Experimental                     [Page 37]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-38" id="page-38" name="page-38"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.4.5.%20%20The%20Assessment%20Class"></a><a class="selflink" href="#section-4.2.4.5" name="section-4.2.4.5">4.2.4.5</a>.  The Assessment Class</span>

   The Assessment class is used to provide the analyzer's assessment of
   an event -- its impact, actions taken in response, and confidence.

   The Assessment class is composed of three aggregate classes, as shown
   in Figure 12.

                  +------------------+
                  |   Assessment     |
                  +------------------+       0..1 +------------+
                  |                  |&lt;&gt;----------|   Impact   |
                  |                  |            +------------+
                  |                  |       0..* +------------+
                  |                  |&lt;&gt;----------|   Action   |
                  |                  |            +------------+
                  |                  |       0..1 +------------+
                  |                  |&lt;&gt;----------| Confidence |
                  |                  |            +------------+
                  +------------------+

                      Figure 12: The Assessment Class

   The aggregate classes that make up Assessment are:

   Impact

      Zero or one.  The analyzer's assessment of the impact of the event
      on the target(s).

   Action

      Zero or more.  The action(s) taken by the analyzer in response to
      the event.

   Confidence

      Zero or one.  A measurement of the confidence the analyzer has in
      its evaluation of the event.

   This is represented in the IDMEF DTD as follows:

   &lt;!ELEMENT Assessment                    (
       Impact?, Action*, Confidence?
     )&gt;
   &lt;!ATTLIST Assessment
       %attlist.global;
     &gt;



<span class="grey">Debar, et al.                 Experimental                     [Page 38]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-39" id="page-39" name="page-39"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.4.6.%20%20The%20AdditionalData%20Class"></a><a class="selflink" href="#section-4.2.4.6" name="section-4.2.4.6">4.2.4.6</a>.  The AdditionalData Class</span>

   The AdditionalData class is used to provide information that cannot
   be represented by the data model.  AdditionalData can be used to
   provide atomic data (integers, strings, etc.) in cases where only
   small amounts of additional information need to be sent; it can also
   be used to extend the data model and the DTD to support the
   transmission of complex data (such as packet headers).  Detailed
   instructions for extending the data model and the DTD are provided in
   <a href="#section-5">Section 5</a>.

   +------+-------------+----------------------------------------------+
   | Rank | Keyword     | Description                                  |
   +------+-------------+----------------------------------------------+
   |    0 | boolean     | The element contains a boolean value, i.e.,  |
   |      |             | the strings "true" or "false"                |
   |      |             |                                              |
   |    1 | byte        | The element content is a single 8-bit byte   |
   |      |             | (see <a href="#section-3.2.4">Section 3.2.4</a>)                          |
   |      |             |                                              |
   |    2 | character   | The element content is a single character    |
   |      |             | (see <a href="#section-3.2.3">Section 3.2.3</a>)                          |
   |      |             |                                              |
   |    3 | date-time   | The element content is a date-time string    |
   |      |             | (see <a href="#section-3.2.6">Section 3.2.6</a>)                          |
   |      |             |                                              |
   |    4 | integer     | The element content is an integer (see       |
   |      |             | <a href="#section-3.2.1">Section 3.2.1</a>)                               |
   |      |             |                                              |
   |    5 | ntpstamp    | The element content is an NTP timestamp (see |
   |      |             | <a href="#section-3.2.7">Section 3.2.7</a>)                               |
   |      |             |                                              |
   |    6 | portlist    | The element content is a list of ports (see  |
   |      |             | <a href="#section-3.2.8">Section 3.2.8</a>)                               |
   |      |             |                                              |
   |    7 | real        | The element content is a real number (see    |
   |      |             | <a href="#section-3.2.2">Section 3.2.2</a>)                               |
   |      |             |                                              |
   |    8 | string      | The element content is a string (see         |
   |      |             | <a href="#section-3.2.3">Section 3.2.3</a>)                               |
   |      |             |                                              |
   |    9 | byte-string | The element is a byte[] (see <a href="#section-3.2.4">Section 3.2.4</a>)  |
   |      |             |                                              |
   |   10 | xmltext     | The element content is XML-tagged data (see  |
   |      |             | <a href="#section-5.2">Section 5.2</a>)                                 |
   +------+-------------+----------------------------------------------+





<span class="grey">Debar, et al.                 Experimental                     [Page 39]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-40" id="page-40" name="page-40"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   The AdditionalData element is declared in the IDMEF DTD as follows:

   &lt;!ENTITY % attvals.adtype               "
       ( boolean | byte | character | date-time | integer | ntpstamp |
         portlist | real | string | byte-string | xmltext )
     "&gt;

   &lt;!ELEMENT AdditionalData           (
     (boolean | byte        | character | date-time |
      integer | ntpstamp    | portlist  | real      |
      string  | byte-string | xmltext  )
    )&gt;

   &lt;!ATTLIST AdditionalData
       type                %attvals.adtype;        'string'
       meaning             CDATA                   #IMPLIED
       %attlist.global;
     &gt;

   The AdditionalData class has one attribute:

   meaning

      Optional.  A string describing the meaning of the element content.
      These values will be vendor/implementation dependent; the method
      for ensuring that managers understand the strings sent by
      analyzers is outside the scope of this specification.  A list of
      acceptable meaning keywords is not within the scope of the
      document, although later versions may undertake to establish such
      a list.





















<span class="grey">Debar, et al.                 Experimental                     [Page 40]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-41" id="page-41" name="page-41"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.5.%20%20The%20Time%20Classes"></a><a class="selflink" href="#section-4.2.5" name="section-4.2.5">4.2.5</a>.  The Time Classes</span>

   The data model provides three classes for representing time.  These
   classes are elements of the Alert and Heartbeat classes.

   The time classes are represented in the IDMEF DTD as follows:

   &lt;!ELEMENT ntpstamp          (#PCDATA)         &gt;
   &lt;!ATTLIST ntpstamp          %attlist.global;  &gt;

   &lt;!ELEMENT CreateTime          (#PCDATA) &gt;
   &lt;!ATTLIST CreateTime
       ntpstamp            CDATA                   #REQUIRED
       %attlist.global;
     &gt;

   &lt;!ELEMENT DetectTime          (#PCDATA) &gt;
   &lt;!ATTLIST DetectTime
       ntpstamp            CDATA                   #REQUIRED
       %attlist.global;
     &gt;

   &lt;!ELEMENT AnalyzerTime        (#PCDATA) &gt;
   &lt;!ATTLIST AnalyzerTime
       ntpstamp            CDATA                   #REQUIRED
       %attlist.global;
     &gt;

   The DATETIME format of the &lt;CreateTime&gt; element content is described
   in <a href="#section-3.2.6">Section 3.2.6</a>.

   If the date and time represented by the element content and the NTP
   timestamp differ (should "never" happen), the value in the NTP
   timestamp MUST be used.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.5.1.%20%20The%20CreateTime%20Class"></a><a class="selflink" href="#section-4.2.5.1" name="section-4.2.5.1">4.2.5.1</a>.  The CreateTime Class</span>

   The CreateTime class is used to indicate the date and time the alert
   or heartbeat was created by the analyzer.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.5.2.%20%20The%20DetectTime%20Class"></a><a class="selflink" href="#section-4.2.5.2" name="section-4.2.5.2">4.2.5.2</a>.  The DetectTime Class</span>

   The DetectTime class is used to indicate the date and time that the
   event(s) producing an alert was detected by the analyzer.  In the
   case of more than one event, it is the time that the first event was
   detected.  (This may or may not be the same time as CreateTime;
   analyzers are not required to send alerts immediately upon
   detection).



<span class="grey">Debar, et al.                 Experimental                     [Page 41]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-42" id="page-42" name="page-42"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.5.3.%20%20The%20AnalyzerTime%20Class"></a><a class="selflink" href="#section-4.2.5.3" name="section-4.2.5.3">4.2.5.3</a>.  The AnalyzerTime Class</span>

   The AnalyzerTime class is used to indicate the current date and time
   on the analyzer.  Its values should be filled in as late as possible
   in the message transmission process, ideally immediately before
   placing the message "on the wire".

   The use of &lt;AnalyzerTime&gt; to perform rudimentary time synchronization
   between analyzers and managers is discussed in <a href="#section-6.3">Section 6.3</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.6.%20%20The%20Assessment%20Classes"></a><a class="selflink" href="#section-4.2.6" name="section-4.2.6">4.2.6</a>.  The Assessment Classes</span>

   The data model provides three types of "assessments" that an analyzer
   can make about an event.  These classes are aggregates of the
   Assessment class.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.6.1.%20%20The%20Impact%20Class"></a><a class="selflink" href="#section-4.2.6.1" name="section-4.2.6.1">4.2.6.1</a>.  The Impact Class</span>

   The Impact class is used to provide the analyzer's assessment of the
   impact of the event on the target(s).  It is represented in the IDMEF
   DTD as follows:

   &lt;!ENTITY % attvals.severity             "
       ( info | low | medium | high )
     "&gt;
   &lt;!ENTITY % attvals.completion           "
       ( failed | succeeded )
     "&gt;
   &lt;!ENTITY % attvals.impacttype           "
       ( admin | dos | file | recon | user | other )
     "&gt;

   &lt;!ELEMENT Impact              (#PCDATA) &gt;
   &lt;!ATTLIST Impact
       severity            %attvals.severity;      #IMPLIED
       completion          %attvals.completion;    #IMPLIED
       type                %attvals.impacttype;    'other'
       %attlist.global;
     &gt;












<span class="grey">Debar, et al.                 Experimental                     [Page 42]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-43" id="page-43" name="page-43"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   The Impact class has three attributes:

   severity

      An estimate of the relative severity of the event.  The permitted
      values are shown below.  There is no default value.  (See also
      <a href="#section-10">Section 10</a>.)

       +------+---------+-----------------------------------------+
       | Rank | Keyword | Description                             |
       +------+---------+-----------------------------------------+
       |    0 | info    | Alert represents informational activity |
       |      |         |                                         |
       |    1 | low     | Low severity                            |
       |      |         |                                         |
       |    2 | medium  | Medium severity                         |
       |      |         |                                         |
       |    3 | high    | High severity                           |
       +------+---------+-----------------------------------------+

   completion

      An indication of whether the analyzer believes the attempt that
      the event describes was successful or not.  The permitted values
      are shown below.  There is no default value.  (See also
      <a href="#section-10">Section 10</a>.)

           +------+-----------+--------------------------------+
           | Rank | Keyword   | Description                    |
           +------+-----------+--------------------------------+
           |    0 | failed    | The attempt was not successful |
           |      |           |                                |
           |    1 | succeeded | The attempt succeeded          |
           +------+-----------+--------------------------------+

















<span class="grey">Debar, et al.                 Experimental                     [Page 43]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-44" id="page-44" name="page-44"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   type

      The type of attempt represented by this event, in relatively broad
      categories.  The permitted values are shown below.  The default
      value is "other".  (See also <a href="#section-10">Section 10</a>.)

   +------+---------+--------------------------------------------------+
   | Rank | Keyword | Description                                      |
   +------+---------+--------------------------------------------------+
   |    0 | admin   | Administrative privileges were attempted or      |
   |      |         | obtained                                         |
   |      |         |                                                  |
   |    1 | dos     | A denial of service was attempted or completed   |
   |      |         |                                                  |
   |    2 | file    | An action on a file was attempted or completed   |
   |      |         |                                                  |
   |    3 | recon   | A reconnaissance probe was attempted or          |
   |      |         | completed                                        |
   |      |         |                                                  |
   |    4 | user    | User privileges were attempted or obtained       |
   |      |         |                                                  |
   |    5 | other   | Anything not in one of the above categories      |
   +------+---------+--------------------------------------------------+

   All three attributes are optional.  The element itself may be empty,
   or may contain a textual description of the impact, if the analyzer
   is able to provide additional details.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.6.2.%20%20The%20Action%20Class"></a><a class="selflink" href="#section-4.2.6.2" name="section-4.2.6.2">4.2.6.2</a>.  The Action Class</span>

   The Action class is used to describe any actions taken by the
   analyzer in response to the event.  Is is represented in the IDMEF
   DTD as follows:

   &lt;!ENTITY % attvals.actioncat            "
       ( block-installed | notification-sent | taken-offline | other )
     "&gt;

   &lt;!ELEMENT Action              (#PCDATA) &gt;
   &lt;!ATTLIST Action
       category            %attvals.actioncat;     'other'
       %attlist.global;
     &gt;








<span class="grey">Debar, et al.                 Experimental                     [Page 44]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-45" id="page-45" name="page-45"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   Action has one attribute:

   category

      The type of action taken.  The permitted values are shown below.
      The default value is "other".  (See also <a href="#section-10">Section 10</a>.)

   +------+-------------------+----------------------------------------+
   | Rank | Keyword           | Description                            |
   +------+-------------------+----------------------------------------+
   |    0 | block-installed   | A block of some sort was installed to  |
   |      |                   | prevent an attack from reaching its    |
   |      |                   | destination.  The block could be a     |
   |      |                   | port block, address block, etc., or    |
   |      |                   | disabling a user account.              |
   |      |                   |                                        |
   |    1 | notification-sent | A notification message of some sort    |
   |      |                   | was sent out-of-band (via pager,       |
   |      |                   | e-mail, etc.).  Does not include the   |
   |      |                   | transmission of this alert.            |
   |      |                   |                                        |
   |    2 | taken-offline     | A system, computer, or user was taken  |
   |      |                   | offline, as when the computer is shut  |
   |      |                   | down or a user is logged off.          |
   |      |                   |                                        |
   |    3 | other             | Anything not in one of the above       |
   |      |                   | categories.                            |
   +------+-------------------+----------------------------------------+

      The element itself may be empty, or may contain a textual
      description of the action, if the analyzer is able to provide
      additional details.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.6.3.%20%20The%20Confidence%20Class"></a><a class="selflink" href="#section-4.2.6.3" name="section-4.2.6.3">4.2.6.3</a>.  The Confidence Class</span>

   The Confidence class is used to represent the analyzer's best
   estimate of the validity of its analysis.  It is represented in the
   IDMEF DTD as follows:

   &lt;!ENTITY % attvals.rating               "
       ( low | medium | high | numeric )
     "&gt;

   &lt;!ELEMENT Confidence          (#PCDATA) &gt;
   &lt;!ATTLIST Confidence
       rating              %attvals.rating;        'numeric'
       %attlist.global;
     &gt;



<span class="grey">Debar, et al.                 Experimental                     [Page 45]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-46" id="page-46" name="page-46"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   The Confidence class has one attribute:

   rating

      The analyzer's rating of its analytical validity.  The permitted
      values are shown below.  The default value is "numeric".  (See
      also <a href="#section-10">Section 10</a>.)

   +------+---------+--------------------------------------------------+
   | Rank | Keyword | Description                                      |
   +------+---------+--------------------------------------------------+
   |    0 | low     | The analyzer has little confidence in its        |
   |      |         | validity                                         |
   |      |         |                                                  |
   |    1 | medium  | The analyzer has average confidence in its       |
   |      |         | validity                                         |
   |      |         |                                                  |
   |    2 | high    | The analyzer has high confidence in its validity |
   |      |         |                                                  |
   |    3 | numeric | The analyzer has provided a posterior            |
   |      |         | probability value indicating its confidence in   |
   |      |         | its validity                                     |
   +------+---------+--------------------------------------------------+

   This element should be used only when the analyzer can produce
   meaningful information.  Systems that can output only a rough
   heuristic should use "low", "medium", or "high" as the rating value.
   In this case, the element content should be omitted.

   Systems capable of producing reasonable probability estimates should
   use "numeric" as the rating value and include a numeric confidence
   value in the element content.  This numeric value should reflect a
   posterior probability (the probability that an attack has occurred
   given the data seen by the detection system and the model used by the
   system).  It is a floating point number between 0.0 and 1.0,
   inclusive.  The number of digits should be limited to those
   representable by a single precision floating point value, and may be
   represented as described in <a href="#section-3.2.2">Section 3.2.2</a>.

   NOTE:  It should be noted that different types of analyzers may
      compute confidence values in different ways and that in many
      cases, confidence values from different analyzers should not be
      compared (for example, if the analyzers use different methods of
      computing or representing confidence, or are of different types or
      configurations).  Care should be taken when implementing systems
      that process confidence values (such as event correlators) not to
      make comparisons or assumptions that cannot be supported by the
      system's knowledge of the environment in which it is working.



<span class="grey">Debar, et al.                 Experimental                     [Page 46]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-47" id="page-47" name="page-47"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.7.%20%20The%20Support%20Classes"></a><a class="selflink" href="#section-4.2.7" name="section-4.2.7">4.2.7</a>.  The Support Classes</span>

   The support classes make up the major parts of the core classes, and
   are shared between them.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.7.1.%20%20The%20Reference%20Class"></a><a class="selflink" href="#section-4.2.7.1" name="section-4.2.7.1">4.2.7.1</a>.  The Reference Class</span>

   The Reference class provides the "name" of an alert, or other
   information allowing the manager to determine what it is.

   The Reference class is composed of two aggregate classes, as shown in
   Figure 13.

                    +----------------+
                    | Reference      |
                    +----------------+            +------+
                    | STRING origin  |&lt;&gt;----------| name |
                    | STRING meaning |            +------+
                    |                |            +------+
                    |                |&lt;&gt;----------| url  |
                    |                |            +------+
                    +----------------+

                      Figure 13: The Reference Class

   The aggregate classes that make up Reference are:

   name

      Exactly one.  STRING.  The name of the alert, from one of the
      origins listed below.

   url

      Exactly one.  STRING.  A URL at which the manager (or the human
      operator of the manager) can find additional information about the
      alert.  The document pointed to by the URL may include an in-depth
      description of the attack, appropriate countermeasures, or other
      information deemed relevant by the vendor.












<span class="grey">Debar, et al.                 Experimental                     [Page 47]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-48" id="page-48" name="page-48"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   This is represented in the IDMEF DTD as follows:

   &lt;!ENTITY % attvals.origin               "
       ( unknown | vendor-specific | user-specific | bugtraqid | cve |
         osvdb )
     "&gt;

   &lt;!ELEMENT Reference                (
       name, url
     )&gt;
   &lt;!ATTLIST Reference
       origin              %attvals.origin;        'unknown'
       meaning             CDATA                   #IMPLIED
     &gt;

   The Reference class has two attributes:

   origin

      Required.  The source from which the name of the alert originates.
      The permitted values for this attribute are shown below.  The
      default value is "unknown".  (See also <a href="#section-10">Section 10</a>.)

   +------+-----------------+------------------------------------------+
   | Rank | Keyword         | Description                              |
   +------+-----------------+------------------------------------------+
   |    0 | unknown         | Origin of the name is not known          |
   |      |                 |                                          |
   |    1 | vendor-specific | A vendor-specific name (and hence, URL); |
   |      |                 | this can be used to provide              |
   |      |                 | product-specific information             |
   |      |                 |                                          |
   |    2 | user-specific   | A user-specific name (and hence, URL);   |
   |      |                 | this can be used to provide              |
   |      |                 | installation-specific information        |
   |      |                 |                                          |
   |    3 | bugtraqid       | The SecurityFocus ("Bugtraq")            |
   |      |                 | vulnerability database identifier        |
   |      |                 | (<a href="http://www.securityfocus.com/bid">http://www.securityfocus.com/bid</a>)       |
   |      |                 |                                          |
   |    4 | cve             | The Common Vulnerabilities and Exposures |
   |      |                 | (CVE) name (<a href="http://www.cve.mitre.org/">http://www.cve.mitre.org/</a>)   |
   |      |                 |                                          |
   |    5 | osvdb           | The Open Source Vulnerability Database   |
   |      |                 | (<a href="http://www.osvdb.org/">http://www.osvdb.org</a>)                   |
   +------+-----------------+------------------------------------------+





<span class="grey">Debar, et al.                 Experimental                     [Page 48]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-49" id="page-49" name="page-49"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   meaning

      Optional.  The meaning of the reference, as understood by the
      alert provider.  This field is only valid if the value of the
      &lt;origin&gt; attribute is set to "vendor-specific" or "user-specific".

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.7.2.%20%20The%20Node%20Class"></a><a class="selflink" href="#section-4.2.7.2" name="section-4.2.7.2">4.2.7.2</a>.  The Node Class</span>

   The Node class is used to identify hosts and other network devices
   (routers, switches, etc.).

   The Node class is composed of three aggregate classes, as shown in
   Figure 14.

                   +---------------+
                   |     Node      |
                   +---------------+       0..1 +----------+
                   | STRING ident  |&lt;&gt;----------| location |
                   | ENUM category |            +----------+
                   |               |       0..1 +----------+
                   |               |&lt;&gt;----------|   name   |
                   |               |            +----------+
                   |               |       0..* +----------+
                   |               |&lt;&gt;----------|  Address |
                   |               |            +----------+
                   +---------------+

                         Figure 14: The Node Class

   The aggregate classes that make up Node are:

   location

      Zero or one.  STRING.  The location of the equipment.

   name

      Zero or one.  STRING.  The name of the equipment.  This
      information MUST be provided if no Address information is given.

   Address

      Zero or more.  The network or hardware address of the equipment.
      Unless a name (above) is provided, at least one address must be
      specified.






<span class="grey">Debar, et al.                 Experimental                     [Page 49]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-50" id="page-50" name="page-50"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   This is represented in the IDMEF DTD as follows:

   &lt;!ENTITY % attvals.nodecat              "
       ( unknown | ads | afs | coda | dfs | dns | hosts | kerberos |
         nds | nis | nisplus | nt | wfw )
     "&gt;

   &lt;!ELEMENT Node                          (
       location?, (name | Address), Address*
     )&gt;
   &lt;!ATTLIST Node
       ident               CDATA                   '0'
       category            %attvals.nodecat;       'unknown'
       %attlist.global;
     &gt;




































<span class="grey">Debar, et al.                 Experimental                     [Page 50]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-51" id="page-51" name="page-51"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   The Node class has two attributes:

   ident

      Optional.  A unique identifier for the node; see <a href="#section-3.2.9">Section 3.2.9</a>.

   category

      Optional.  The "domain" from which the name information was
      obtained, if relevant.  The permitted values for this attribute
      are shown in the table below.  The default value is "unknown".
      (See also <a href="#section-10">Section 10</a> for extensions to the table.)

      +------+----------+------------------------------------------+
      | Rank | Keyword  | Description                              |
      +------+----------+------------------------------------------+
      |    0 | unknown  | Domain unknown or not relevant           |
      |      |          |                                          |
      |    1 | ads      | Windows 2000 Advanced Directory Services |
      |      |          |                                          |
      |    2 | afs      | Andrew File System (Transarc)            |
      |      |          |                                          |
      |    3 | coda     | Coda Distributed File System             |
      |      |          |                                          |
      |    4 | dfs      | Distributed File System (IBM)            |
      |      |          |                                          |
      |    5 | dns      | Domain Name System                       |
      |      |          |                                          |
      |    6 | hosts    | Local hosts file                         |
      |      |          |                                          |
      |    7 | kerberos | Kerberos realm                           |
      |      |          |                                          |
      |    8 | nds      | Novell Directory Services                |
      |      |          |                                          |
      |    9 | nis      | Network Information Services (Sun)       |
      |      |          |                                          |
      |   10 | nisplus  | Network Information Services Plus (Sun)  |
      |      |          |                                          |
      |   11 | nt       | Windows NT domain                        |
      |      |          |                                          |
      |   12 | wfw      | Windows for Workgroups                   |
      +------+----------+------------------------------------------+









<span class="grey">Debar, et al.                 Experimental                     [Page 51]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-52" id="page-52" name="page-52"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/4.2.7.2.1.%20%20The%20Address%20Class"></a><a class="selflink" href="#section-4.2.7.2.1" name="section-4.2.7.2.1">4.2.7.2.1</a>.  The Address Class</span>

   The Address class is used to represent network, hardware, and
   application addresses.

   The Address class is composed of two aggregate classes, as shown in
   Figure 15.

                  +------------------+
                  |     Address      |
                  +------------------+            +---------+
                  | STRING ident     |&lt;&gt;----------| address |
                  | ENUM category    |            +---------+
                  | STRING vlan-name |       0..1 +---------+
                  | INTEGER vlan-num |&lt;&gt;----------| netmask |
                  |                  |            +---------+
                  +------------------+

                       Figure 15: The Address Class

   The aggregate classes that make up Address are:

   address

      Exactly one.  STRING.  The address information.  The format of
      this data is governed by the category attribute.

   netmask

      Zero or one.  STRING.  The network mask for the address, if
      appropriate.




















<span class="grey">Debar, et al.                 Experimental                     [Page 52]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-53" id="page-53" name="page-53"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   This is represented in the IDMEF DTD as follows:

   &lt;!ENTITY % attvals.addrcat              "
       ( unknown | atm | e-mail | lotus-notes | mac | sna | vm |
         ipv4-addr | ipv4-addr-hex | ipv4-net | ipv4-net-mask |
         ipv6-addr | ipv6-addr-hex | ipv6-net | ipv6-net-mask )
     "&gt;

   &lt;!ELEMENT Address                       (
       address, netmask?
     )&gt;
   &lt;!ATTLIST Address
       ident               CDATA                   '0'
       category            %attvals.addrcat;       'unknown'
       vlan-name           CDATA                   #IMPLIED
       vlan-num            CDATA                   #IMPLIED
       %attlist.global;
     &gt;

   The Address class has four attributes:

   ident

      Optional.  A unique identifier for the address; see <a href="#section-3.2.9">Section 3.2.9</a>.

   category

      Optional.  The type of address represented.  The permitted values
      for this attribute are shown below.  The default value is
      "unknown".  (See also <a href="#section-10">Section 10</a>.)





















<span class="grey">Debar, et al.                 Experimental                     [Page 53]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-54" id="page-54" name="page-54"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   +------+---------------+--------------------------------------------+
   | Rank | Keyword       | Description                                |
   +------+---------------+--------------------------------------------+
   |    0 | unknown       | Address type unknown                       |
   |      |               |                                            |
   |    1 | atm           | Asynchronous Transfer Mode network address |
   |      |               |                                            |
   |    2 | e-mail        | Electronic mail address (<a href="rfc2822.html">RFC 2822</a> [<a href="#ref-12" title='"Internet Message Format"'>12</a>])    |
   |      |               |                                            |
   |    3 | lotus-notes   | Lotus Notes e-mail address                 |
   |      |               |                                            |
   |    4 | mac           | Media Access Control (MAC) address         |
   |      |               |                                            |
   |    5 | sna           | IBM Shared Network Architecture (SNA)      |
   |      |               | address                                    |
   |      |               |                                            |
   |    6 | vm            | IBM VM ("PROFS") e-mail address            |
   |      |               |                                            |
   |    7 | ipv4-addr     | IPv4 host address in dotted-decimal        |
   |      |               | notation (a.b.c.d)                         |
   |      |               |                                            |
   |    8 | ipv4-addr-hex | IPv4 host address in hexadecimal notation  |
   |      |               |                                            |
   |    9 | ipv4-net      | IPv4 network address in dotted-decimal     |
   |      |               | notation, slash, significant bits          |
   |      |               | (a.b.c.d/nn)                               |
   |      |               |                                            |
   |   10 | ipv4-net-mask | IPv4 network address in dotted-decimal     |
   |      |               | notation, slash, network mask in           |
   |      |               | dotted-decimal notation (a.b.c.d/w.x.y.z)  |
   |      |               |                                            |
   |   11 | ipv6-addr     | IPv6 host address                          |
   |      |               |                                            |
   |   12 | ipv6-addr-hex | IPv6 host address in hexadecimal notation  |
   |      |               |                                            |
   |   13 | ipv6-net      | IPv6 network address, slash, significant   |
   |      |               | bits                                       |
   |      |               |                                            |
   |   14 | ipv6-net-mask | IPv6 network address, slash, network mask  |
   +------+---------------+--------------------------------------------+

   vlan-name

      Optional.  The name of the Virtual LAN to which the address
      belongs.






<span class="grey">Debar, et al.                 Experimental                     [Page 54]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-55" id="page-55" name="page-55"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   vlan-num

      Optional.  The number of the Virtual LAN to which the address
      belongs.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.7.3.%20%20The%20User%20Class"></a><a class="selflink" href="#section-4.2.7.3" name="section-4.2.7.3">4.2.7.3</a>.  The User Class</span>

   The User class is used to describe users.  It is primarily used as a
   "container" class for the UserId aggregate class, as shown in
   Figure 16.

               +---------------+
               |     User      |
               +---------------+       1..* +--------+
               | STRING ident  |&lt;&gt;----------| UserId |
               | ENUM category |            +--------+
               +---------------+

                         Figure 16: The User Class

   The aggregate class contained in User is:

   UserId

      One or more.  Identification of a user, as indicated by its type
      attribute (see <a href="#section-4.2.7.3.1">Section 4.2.7.3.1</a>).

   This is represented in the IDMEF DTD as follows:

   &lt;!ENTITY % attvals.usercat              "
       ( unknown | application | os-device )
     "&gt;

   &lt;!ELEMENT User                          (
       UserId+
     )&gt;
   &lt;!ATTLIST User
       ident               CDATA                   '0'
       category            %attvals.usercat;       'unknown'
       %attlist.global;
     &gt;










<span class="grey">Debar, et al.                 Experimental                     [Page 55]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-56" id="page-56" name="page-56"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   The User class has two attributes:

   ident

      Optional.  A unique identifier for the user; see <a href="#section-3.2.9">Section 3.2.9</a>.

   category

      Optional.  The type of user represented.  The permitted values for
      this attribute are shown below.  The default value is "unknown".
      (See also <a href="#section-10">Section 10</a>.)

        +------+-------------+------------------------------------+
        | Rank | Keyword     | Description                        |
        +------+-------------+------------------------------------+
        |    0 | unknown     | User type unknown                  |
        |      |             |                                    |
        |    1 | application | An application user                |
        |      |             |                                    |
        |    2 | os-device   | An operating system or device user |
        +------+-------------+------------------------------------+

<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/4.2.7.3.1.%20%20The%20UserId%20Class"></a><a class="selflink" href="#section-4.2.7.3.1" name="section-4.2.7.3.1">4.2.7.3.1</a>.  The UserId Class</span>

   The UserId class provides specific information about a user.  More
   than one UserId can be used within the User class to indicate
   attempts to transition from one user to another, or to provide
   complete information about a user's (or process') privileges.

   The UserId class is composed of two aggregate classes, as shown in
   Figure 17.

                      +--------------+
                      |    UserId    |
                      +--------------+       0..1 +--------+
                      | STRING ident |&lt;&gt;----------|  name  |
                      | ENUM type    |            +--------+
                      | STRING tty   |       0..1 +--------+
                      |              |&lt;&gt;----------| number |
                      |              |            +--------+
                      +--------------+

                        Figure 17: The UserId Class








<span class="grey">Debar, et al.                 Experimental                     [Page 56]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-57" id="page-57" name="page-57"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   The aggregate classes that make up UserId are:

   name

      Zero or one.  STRING.  A user or group name.

   number

      Zero or one.  INTEGER.  A user or group number.

   This is represented in the IDMEF DTD as follows:

   &lt;!ENTITY % attvals.idtype               "
       ( current-user | original-user | target-user | user-privs |
         current-group | group-privs | other-privs )
     "&gt;

   &lt;!ELEMENT UserId                        (
       (name, number?) | (number, name?)
     )&gt;
   &lt;!ATTLIST UserId
       ident               CDATA                   '0'
       type                %attvals.idtype;        'original-user'
       tty                 CDATA                   #IMPLIED
       %attlist.global;
     &gt;

   The UserId class has three attributes:

   ident

      Optional.  A unique identifier for the user id, see <a href="#section-3.2.9">Section 3.2.9</a>.

   type

      Optional.  The type of user information represented.  The
      permitted values for this attribute are shown below.  The default
      value is "original-user".  (See also <a href="#section-10">Section 10</a>.)













<span class="grey">Debar, et al.                 Experimental                     [Page 57]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-58" id="page-58" name="page-58"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   +------+---------------+--------------------------------------------+
   | Rank | Keyword       | Description                                |
   +------+---------------+--------------------------------------------+
   |    0 | current-user  | The current user id being used by the user |
   |      |               | or process.  On Unix systems, this would   |
   |      |               | be the "real" user id, in general.         |
   |      |               |                                            |
   |    1 | original-user | The actual identity of the user or process |
   |      |               | being reported on.  On those systems that  |
   |      |               | (a) do some type of auditing and (b)       |
   |      |               | support extracting a user id from the      |
   |      |               | "audit id" token, that value should be     |
   |      |               | used.  On those systems that do not        |
   |      |               | support this, and where the user has       |
   |      |               | logged into the system, the "login id"     |
   |      |               | should be used.                            |
   |      |               |                                            |
   |    2 | target-user   | The user id the user or process is         |
   |      |               | attempting to become.  This would apply,   |
   |      |               | on Unix systems for example, when the user |
   |      |               | attempts to use "su", "rlogin", "telnet",  |
   |      |               | etc.                                       |
   |      |               |                                            |
   |    3 | user-privs    | Another user id the user or process has    |
   |      |               | the ability to use, or a user id           |
   |      |               | associated with a file permission.  On     |
   |      |               | Unix systems, this would be the            |
   |      |               | "effective" user id in a user or process   |
   |      |               | context, and the owner permissions in a    |
   |      |               | file context.  Multiple UserId elements of |
   |      |               | this type may be used to specify a list of |
   |      |               | privileges.                                |
   |      |               |                                            |
   |    4 | current-group | The current group id (if applicable) being |
   |      |               | used by the user or process.  On Unix      |
   |      |               | systems, this would be the "real" group    |
   |      |               | id, in general.                            |
   |      |               |                                            |
   |    5 | group-privs   | Another group id the group or process has  |
   |      |               | the ability to use, or a group id          |
   |      |               | associated with a file permission.  On     |
   |      |               | Unix systems, this would be the            |
   |      |               | "effective" group id in a group or process |
   |      |               | context, and the group permissions in a    |
   |      |               | file context.  On BSD-derived Unix         |
   |      |               | systems, multiple UserId elements of this  |
   |      |               | type would be used to include all the      |
   |      |               | group ids on the "group list".             |



<span class="grey">Debar, et al.                 Experimental                     [Page 58]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-59" id="page-59" name="page-59"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   |    6 | other-privs   | Not used in a user, group, or process      |
   |      |               | context, only used in the file context.    |
   |      |               | The file permissions assigned to users who |
   |      |               | do not match either the user or group      |
   |      |               | permissions on the file.  On Unix systems, |
   |      |               | this would be the "world" permissions.     |
   +------+---------------+--------------------------------------------+

   tty

      Optional.  STRING.  The tty the user is using.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.7.4.%20%20The%20Process%20Class"></a><a class="selflink" href="#section-4.2.7.4" name="section-4.2.7.4">4.2.7.4</a>.  The Process Class</span>

   The Process class is used to describe processes being executed on
   sources, targets, and analyzers.

   The Process class is composed of five aggregate classes, as shown in
   Figure 18.

                     +--------------+
                     |    Process   |
                     +--------------+            +------+
                     | STRING ident |&lt;&gt;----------| name |
                     |              |            +------+
                     |              |       0..1 +------+
                     |              |&lt;&gt;----------| pid  |
                     |              |            +------+
                     |              |       0..1 +------+
                     |              |&lt;&gt;----------| path |
                     |              |            +------+
                     |              |       0..* +------+
                     |              |&lt;&gt;----------| arg  |
                     |              |            +------+
                     |              |       0..* +------+
                     |              |&lt;&gt;----------| env  |
                     |              |            +------+
                     +--------------+

                       Figure 18: The Process Class











<span class="grey">Debar, et al.                 Experimental                     [Page 59]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-60" id="page-60" name="page-60"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   The aggregate classes that make up Process are:

   name

      Exactly one.  STRING.  The name of the program being executed.
      This is a short name; path and argument information are provided
      elsewhere.

   pid

      Zero or one.  INTEGER.  The process identifier of the process.

   path

      Zero or one.  STRING.  The full path of the program being
      executed.

   arg

      Zero or more.  STRING.  A command-line argument to the program.
      Multiple arguments may be specified (they are assumed to have
      occurred in the same order they are provided) with multiple uses
      of arg.

   env

      Zero or more.  STRING.  An environment string associated with the
      process; generally of the format "VARIABLE=value".  Multiple
      environment strings may be specified with multiple uses of env.

   This is represented in the IDMEF DTD as follows:

    &lt;!ELEMENT Process                       (
       name, pid?, path?, arg*, env*
     )&gt;
   &lt;!ATTLIST Process
       ident               CDATA                   '0'
       %attlist.global;
     &gt;

   The Process class has one attribute:

   ident

      Optional.  A unique identifier for the process; see <a href="#section-3.2.9">Section 3.2.9</a>.






<span class="grey">Debar, et al.                 Experimental                     [Page 60]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-61" id="page-61" name="page-61"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.7.5.%20%20The%20Service%20Class"></a><a class="selflink" href="#section-4.2.7.5" name="section-4.2.7.5">4.2.7.5</a>.  The Service Class</span>

   The Service class describes network services on sources and targets.
   It can identify services by name, port, and protocol.  When Service
   occurs as an aggregate class of Source, it is understood that the
   service is one from which activity of interest is originating; and
   that the service is "attached" to the Node, Process, and User
   information also contained in Source.  Likewise, when Service occurs
   as an aggregate class of Target, it is understood that the service is
   one to which activity of interest is being directed; and that the
   service is "attached" to the Node, Process, and User information also
   contained in Target.  If Service occurs in both Source and Target,
   then information in both locations should be the same.  If
   information is the same in both locations and implementers wish to
   carry it in only one location, they should specify it as an aggregate
   of the Target class.

   The Service class is composed of four aggregate classes, as shown in
   Figure 19.

            +-----------------------------+
            |   Service                   |
            +-----------------------------+       0..1 +----------+
            | STRING  ident               |&lt;&gt;----------|   name   |
            | INTEGER ip_version          |            +----------+
            | INTEGER iana_protocol_number|       0..1 +----------+
            | STRING  iana_protocol_name  |&lt;&gt;----------|   port   |
            |                             |            +----------+
            |                             |       0..1 +----------+
            |                             |&lt;&gt;----------| portlist |
            |                             |            +----------+
            |                             |       0..1 +----------+
            |                             |&lt;&gt;----------| protocol |
            |                             |            +----------+
            +-----------------------------+
                            /_\
                             |
                   +---------+--------+
                   |                  |
            +-------------+     +-------------+
            | SNMPService |     | WebService  |
            +-------------+     +-------------+

                       Figure 19: The Service Class







<span class="grey">Debar, et al.                 Experimental                     [Page 61]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-62" id="page-62" name="page-62"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   The aggregate classes that make up Service are:

   name

      Zero or one.  STRING.  The name of the service.  Whenever
      possible, the name from the IANA list of well-known ports SHOULD
      be used.

   port

      Zero or one.  INTEGER.  The port number being used.

   portlist

      Zero or one.  PORTLIST.  A list of port numbers being used; see
      <a href="#section-3.2.8">Section 3.2.8</a> for formatting rules.  If a portlist is given, the
      iana_protocol_number and iana_protocol_name MUST apply to all the
      elements of the list.

   protocol

      Zero or one.  STRING.  Additional information about the protocol
      being used.  The intent of the protocol field is to carry
      additional information related to the protocol being used when the
      &lt;Service&gt; attributes iana_protocol_number or/and
      iana_protocol_name are filed.

   A Service MUST be specified as either (a) a name or a port or (b) a
   portlist.  The protocol is optional in all cases, but no other
   combinations are permitted.

   Service is represented in the IDMEF DTD as follows:

   &lt;!ELEMENT Service                       (
       (((name, port?) | (port, name?)) | portlist), protocol?,
       SNMPService?, WebService?
     )&gt;
   &lt;!ATTLIST Service
       ident                CDATA                   '0'
   ip_version           CDATA                   #IMPLIED
   iana_protocol_number CDATA                  #IMPLIED
   iana_protocol_name   CDATA                  #IMPLIED
       %attlist.global;
     &gt;







<span class="grey">Debar, et al.                 Experimental                     [Page 62]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-63" id="page-63" name="page-63"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   The Service class has four attributes:

   ident

      Optional.  A unique identifier for the service; see <a href="#section-3.2.9">Section 3.2.9</a>.

   ip_version

      Optional.  INTEGER.  The IP version number.

   iana_protocol_number

      Optional.  INTEGER.  The IANA protocol number.

   iana_protocol_name

      Optional.  STRING.  The IANA protocol name.

<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/4.2.7.5.1.%20%20The%20WebService%20Class"></a><a class="selflink" href="#section-4.2.7.5.1" name="section-4.2.7.5.1">4.2.7.5.1</a>.  The WebService Class</span>

   The WebService class carries additional information related to web
   traffic.

   The WebService class is composed of four aggregate classes, as shown
   in Figure 20.

                   +-------------+
                   |   Service   |
                   +-------------+
                         /_\
                          |
                   +-------------+
                   | WebService  |
                   +-------------+            +-------------+
                   |             |&lt;&gt;----------|     url     |
                   |             |            +-------------+
                   |             |       0..1 +-------------+
                   |             |&lt;&gt;----------|     cgi     |
                   |             |            +-------------+
                   |             |       0..1 +-------------+
                   |             |&lt;&gt;----------| http-method |
                   |             |            +-------------+
                   |             |       0..* +-------------+
                   |             |&lt;&gt;----------|     arg     |
                   |             |            +-------------+
                   +-------------+

                      Figure 20: The WebService Class



<span class="grey">Debar, et al.                 Experimental                     [Page 63]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-64" id="page-64" name="page-64"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   The aggregate classes that make up WebService are:

   url

      Exactly one.  STRING.  The URL in the request.

   cgi

      Zero or one.  STRING.  The CGI script in the request, without
      arguments.

   http-method

      Zero or one.  STRING.  The HTTP method (PUT, GET) used in the
      request.

   arg

      Zero or more.  STRING.  The arguments to the CGI script.

   This is represented in the IDMEF DTD as follows:

   &lt;!ELEMENT WebService                    (
       url, cgi?, http-method?, arg*
     )&gt;
   &lt;!ATTLIST WebService
       %attlist.global;
     &gt;

<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/4.2.7.5.2.%20%20The%20SNMPService%20Class"></a><a class="selflink" href="#section-4.2.7.5.2" name="section-4.2.7.5.2">4.2.7.5.2</a>.  The SNMPService Class</span>

   The SNMPService class carries additional information related to SNMP
   traffic.  The aggregate classes composing SNMPService must be
   interpreted as described in <a href="rfc3411.html">RFC 3411</a> [<a href="#ref-15" title='"An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks"'>15</a>] and <a href="rfc3584.html">RFC 3584</a> [<a href="#ref-16" title='"Coexistence between Version 1, Version 2, and Version 3 of the Internet-standard Network Management Framework"'>16</a>].

   The SNMPService class is composed of eight aggregate classes, as
   shown in Figure 21.














<span class="grey">Debar, et al.                 Experimental                     [Page 64]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-65" id="page-65" name="page-65"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


                +-------------+
                |   Service   |
                +-------------+
                      /_\
                       |
                +-------------+
                | SNMPService |
                +-------------+       0..1 +----------------------+
                |             |&lt;&gt;----------|       oid            |
                |             |            +----------------------+
                |             |       0..1 +----------------------+
                |             |&lt;&gt;----------|messageProcessingModel|
                |             |            +----------------------+
                |             |       0..1 +----------------------+
                |             |&lt;&gt;----------|    securityModel     |
                |             |            +----------------------+
                |             |       0..1 +----------------------+
                |             |&lt;&gt;----------|    securityName      |
                |             |            +----------------------+
                |             |       0..1 +----------------------+
                |             |&lt;&gt;----------|   securityLevel      |
                |             |            +----------------------+
                |             |       0..1 +----------------------+
                |             |&lt;&gt;----------|    contextName       |
                |             |            +----------------------+
                |             |       0..1 +----------------------+
                |             |&lt;&gt;----------|   contextEngineID    |
                |             |            +----------------------+
                |             |       0..1 +----------------------+
                |             |&lt;&gt;----------|     command          |
                |             |            +----------------------+
                +-------------+

                     Figure 21: The SNMPService Class

   The aggregate classes that make up SNMPService are:

   oid

      Zero or one.  STRING.  The object identifier in the request.

   messageProcessingModel

      Zero or one.  INTEGER.  The SNMP version, typically 0 for SNMPv1,
      1 for SNMPv2c, 2 for SNMPv2u and SNMPv2*, and 3 for SNMPv3; see
      <a href="rfc3411.html">RFC 3411</a> [<a href="#ref-15" title='"An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks"'>15</a>] <a href="#section-5">Section 5</a> for appropriate values.





<span class="grey">Debar, et al.                 Experimental                     [Page 65]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-66" id="page-66" name="page-66"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   securityModel

      Zero or one.  INTEGER.  The identification of the security model
      in use, typically 0 for any, 1 for SNMPv1, 2 for SNMPv2c, and 3
      for USM; see <a href="rfc3411.html">RFC 3411</a> [<a href="#ref-15" title='"An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks"'>15</a>] <a href="#section-5">Section 5</a> for appropriate values.

   securityName

      Zero or one.  STRING.  The object's security name; see <a href="rfc3411.html">RFC 3411</a>
      [<a href="#ref-15" title='"An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks"'>15</a>] <a href="#section-3.2.2">Section 3.2.2</a>.

   securityLevel

      Zero or one.  INTEGER.  The security level of the SNMP request;
      see <a href="rfc3411.html">RFC 3411</a> [<a href="#ref-15" title='"An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks"'>15</a>] <a href="#section-3.4.3">Section 3.4.3</a>.

   contextName

      Zero or one.  STRING.  The object's context name; see <a href="rfc3411.html">RFC 3411</a>
      [<a href="#ref-15" title='"An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks"'>15</a>] <a href="#section-3.3.3">Section 3.3.3</a>.

   contextEngineID

      Zero or one.  STRING.  The object's context engine identifier; see
      <a href="rfc3411.html">RFC 3411</a> [<a href="#ref-15" title='"An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks"'>15</a>] <a href="#section-3.3.2">Section 3.3.2</a>.

   command

      Zero or one.  STRING.  The command sent to the SNMP server (GET,
      SET, etc.).

   If other fields of an SNMP message are available and should be
   incorporated in the IDMEF alert, they must be located in the
   additionaldata structure with the meaning being an object definition
   defined in <a href="rfc3411.html">RFC 3411</a> [<a href="#ref-15" title='"An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks"'>15</a>] <a href="#section-5">Section 5</a> and the value located within the
   additionaldata payload.

   This is represented in the IDMEF DTD as follows:

   &lt;!ELEMENT SNMPService                   (
       oid?, messageProcessingModel?, securityModel?, securityName?,
       securityLevel?, contextName?, contextEngineID?, command?
     )&gt;
   &lt;!ATTLIST SNMPService
       %attlist.global;
     &gt;





<span class="grey">Debar, et al.                 Experimental                     [Page 66]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-67" id="page-67" name="page-67"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.7.6.%20%20The%20File%20Class"></a><a class="selflink" href="#section-4.2.7.6" name="section-4.2.7.6">4.2.7.6</a>.  The File Class</span>

   The File class provides specific information about a file or other
   file-like object that has been created, deleted, or modified on the
   target.  The description can provide either the file settings prior
   to the event or the file settings at the time of the event, as
   specified using the "category" attribute.

   The File class is composed of eleven aggregate classes, as shown in
   Figure 22.
                  +--------------+
                  |     File     |
                  +--------------+            +-------------+
                  |              |&lt;&gt;----------|    name     |
                  |              |            +-------------+
                  |              |            +-------------+
                  |              |&lt;&gt;----------|    path     |
                  |              |            +-------------+
                  |              |       0..1 +-------------+
                  |              |&lt;&gt;----------| create-time |
                  |              |            +-------------+
                  |              |       0..1 +-------------+
                  |              |&lt;&gt;----------| modify-time |
                  |              |            +-------------+
                  |              |       0..1 +-------------+
                  |              |&lt;&gt;----------| access-time |
                  |              |            +-------------+
                  |              |       0..1 +-------------+
                  |              |&lt;&gt;----------|  data-size  |
                  |              |            +-------------+
                  |              |       0..1 +-------------+
                  |              |&lt;&gt;----------|  disk-size  |
                  |              |            +-------------+
                  |              |       0..* +-------------+
                  |              |&lt;&gt;----------| FileAccess  |
                  |              |            +-------------+
                  |              |       0..* +-------------+
                  |              |&lt;&gt;----------|   Linkage   |
                  |              |            +-------------+
                  |              |       0..1 +-------------+
                  |              |&lt;&gt;----------|    Inode    |
                  |              |            +-------------+
                  |              |       0..* +-------------+
                  |              |&lt;&gt;----------|  Checksum   |
                  |              |            +-------------+
                  +--------------+

                         Figure 22: The File Class



<span class="grey">Debar, et al.                 Experimental                     [Page 67]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-68" id="page-68" name="page-68"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   The aggregate classes that make up File are:

   name

      Exactly one.  STRING.  The name of the file to which the alert
      applies, not including the path to the file.

   path

      Exactly one.  STRING.  The full path to the file, including the
      name.  The path name should be represented in as "universal" a
      manner as possible, to facilitate processing of the alert.

      For Windows systems, the path should be specified using the
      Universal Naming Convention (UNC) for remote files, and using a
      drive letter for local files (e.g., "C:\boot.ini").  For Unix
      systems, paths on network file systems should use the name of the
      mounted resource instead of the local mount point (e.g.,
      "fileserver:/usr/local/bin/foo").  The mount point can be provided
      using the &lt;Linkage&gt; element.

   create-time

      Zero or one.  DATETIME.  Time the file was created.  Note that
      this is *not* the Unix "st_ctime" file attribute (which is not
      file creation time).  The Unix "st_ctime" attribute is contained
      in the "Inode" class.

   modify-time

      Zero or one.  DATETIME.  Time the file was last modified.

   access-time

      Zero or one.  DATETIME.  Time the file was last accessed.

   data-size

      Zero or one.  INTEGER.  The size of the data, in bytes.  Typically
      what is meant when referring to file size.  On Unix UFS file
      systems, this value corresponds to stat.st_size.  On Windows NTFS,
      this value corresponds to Valid Data Length (VDL).









<span class="grey">Debar, et al.                 Experimental                     [Page 68]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-69" id="page-69" name="page-69"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   disk-size

      Zero or one.  INTEGER.  The physical space on disk consumed by the
      file, in bytes.  On Unix UFS file systems, this value corresponds
      to 512 * stat.st_blocks.  On Windows NTFS, this value corresponds
      to End of File (EOF).

   FileAccess

      Zero or more.  Access permissions on the file.

   Linkage

      Zero or more.  File system objects to which this file is linked
      (other references for the file).

   Inode

      Zero or one.  Inode information for this file (relevant to Unix).

   Checksum

      Zero or more.  Checksum information for this file.

   This is represented in the IDMEF DTD as follows:

   &lt;!ENTITY % attvals.filecat              "
       ( current | original )
     "&gt;

   &lt;!ELEMENT File                          (
       name, path, create-time?, modify-time?, access-time?,
       data-size?, disk-size?, FileAccess*, Linkage*, Inode?,
       Checksum*
     )&gt;
   &lt;!ATTLIST File
       ident               CDATA                   '0'
       category            %attvals.filecat;       #REQUIRED
       fstype              CDATA                   #IMPLIED
       file-type           CDATA                   #IMPLIED
       %attlist.global;
     &gt;

   The File class has four attributes (one required and three optional):

   ident

      Optional.  A unique identifier for this file; see <a href="#section-3.2.9">Section 3.2.9</a>.



<span class="grey">Debar, et al.                 Experimental                     [Page 69]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-70" id="page-70" name="page-70"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   category

      Required.  The context for the information being provided.  The
      permitted values are shown below.  There is no default value.
      (See also <a href="#section-10">Section 10</a>.)

   +------+----------+-------------------------------------------------+
   | Rank | Keyword  | Description                                     |
   +------+----------+-------------------------------------------------+
   |    0 | current  | The file information is from after the reported |
   |      |          | change                                          |
   |      |          |                                                 |
   |    1 | original | The file information is from before the         |
   |      |          | reported change                                 |
   +------+----------+-------------------------------------------------+

   fstype

      Optional.  The type of file system the file resides on.  This
      attribute governs how path names and other attributes are
      interpreted.

                +------+---------+-------------------------------------+
                | Rank | Keyword | Description                         |
                +------+---------+-------------------------------------+
                |    0 | ufs     | Berkeley Unix Fast File System      |
                |    1 | efs     | Linux "efs" file system             |
                |    2 | nfs     | Network File System                 |
                |    3 | afs     | Andrew File System                  |
                |    4 | ntfs    | Windows NT File System              |
                |    5 | fat16   | 16-bit Windows FAT File System      |
                |    6 | fat32   | 32-bit Windows FAT File System      |
                |    7 | pcfs    | "PC" (MS-DOS) file system on CD-ROM |
                |    8 | joliet  | Joliet CD-ROM file system           |
                |    9 | iso9660 | ISO 9660 CD-ROM file system         |
                +------+---------+-------------------------------------+

   file-type

      Optional.  The type of file, as a mime-type.











<span class="grey">Debar, et al.                 Experimental                     [Page 70]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-71" id="page-71" name="page-71"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/4.2.7.6.1.%20%20The%20FileAccess%20Class"></a><a class="selflink" href="#section-4.2.7.6.1" name="section-4.2.7.6.1">4.2.7.6.1</a>.  The FileAccess Class</span>

   The FileAccess class represents the access permissions on a file.
   The representation is intended to be useful across operating systems.

   The FileAccess class is composed of two aggregate classes, as shown
   in Figure 23.

                  +--------------+
                  |  FileAccess  |
                  +--------------+            +------------+
                  |              |&lt;&gt;----------|   UserId   |
                  |              |            +------------+
                  |              |       1..* +------------+
                  |              |&lt;&gt;----------| Permission |
                  |              |            +------------+
                  +--------------+

                      Figure 23: The FileAccess Class

   The aggregate classes that make up FileAccess are:

   UserId

      Exactly one.  The user (or group) to which these permissions
      apply.  The value of the "type" attribute must be "user-privs",
      "group-privs", or "other-privs" as appropriate.  Other values for
      "type" MUST NOT be used in this context.























<span class="grey">Debar, et al.                 Experimental                     [Page 71]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-72" id="page-72" name="page-72"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   Permission

      One or more.  ENUM.  Level of access allowed.  The permitted
      values are shown below.  There is no default value.  (See also
      <a href="#section-10">Section 10</a>.)

   +------+-------------------+----------------------------------------+
   | Rank | Keyword           | Description                            |
   +------+-------------------+----------------------------------------+
   |    0 | noAccess          | No access at all is allowed for this   |
   |      |                   | user                                   |
   |      |                   |                                        |
   |    1 | read              | This user has read access to the file  |
   |      |                   |                                        |
   |    2 | write             | This user has write access to the file |
   |      |                   |                                        |
   |    3 | execute           | This user has the ability to execute   |
   |      |                   | the file                               |
   |      |                   |                                        |
   |    4 | search            | This user has the ability to search    |
   |      |                   | this file (applies to "execute"        |
   |      |                   | permission on directories in Unix)     |
   |      |                   |                                        |
   |    5 | delete            | This user has the ability to delete    |
   |      |                   | this file                              |
   |      |                   |                                        |
   |    6 | executeAs         | This user has the ability to execute   |
   |      |                   | this file as another user              |
   |      |                   |                                        |
   |    7 | changePermissions | This user has the ability to change    |
   |      |                   | the access permissions on this file    |
   |      |                   |                                        |
   |    8 | takeOwnership     | This user has the ability to take      |
   |      |                   | ownership of this file                 |
   +------+-------------------+----------------------------------------+

   The "changePermissions" and "takeOwnership" strings represent those
   concepts in Windows.  On Unix, the owner of the file always has
   "changePermissions" access, even if no other access is allowed for
   that user.  "Full Control" in Windows is represented by enumerating
   the permissions it contains.  The "executeAs" string represents the
   set-user-id and set-group-id features in Unix.









<span class="grey">Debar, et al.                 Experimental                     [Page 72]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-73" id="page-73" name="page-73"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   This is represented in the IDMEF DTD as follows:

   &lt;!ELEMENT Permission EMPTY &gt;
   &lt;!ATTLIST Permission
       perms               %attvals.fileperm;      #REQUIRED
       %attlist.global;
   &gt;

   &lt;!ENTITY % attvals.fileperm "( noAccess | read | write | execute |
     search | delete | executeAs | changePermissions |
     takeOwnership)" &gt;

<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/4.2.7.6.2.%20%20The%20Linkage%20Class"></a><a class="selflink" href="#section-4.2.7.6.2" name="section-4.2.7.6.2">4.2.7.6.2</a>.  The Linkage Class</span>

   The Linkage class represents file system connections between the file
   described in the &lt;File&gt; element and other objects in the file system.
   For example, if the &lt;File&gt; element is a symbolic link or shortcut,
   then the &lt;Linkage&gt; element should contain the name of the object the
   link points to.  Further information can be provided about the object
   in the &lt;Linkage&gt; element with another &lt;File&gt; element, if appropriate.

   The Linkage class is composed of three aggregate classes, as shown in
   Figure 24.

                  +--------------+
                  |   Linkage    |
                  +--------------+            +------+
                  |              |&lt;&gt;----------| name |
                  |              |            +------+
                  |              |            +------+
                  |              |&lt;&gt;----------| path |
                  |              |            +------+
                  |              |            +------+
                  |              |&lt;&gt;----------| File |
                  |              |            +------+
                  +--------------+

                       Figure 24: The Linkage Class

   The aggregate classes that make up Linkage are:

   name

      Exactly one.  STRING.  The name of the file system object, not
      including the path.






<span class="grey">Debar, et al.                 Experimental                     [Page 73]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-74" id="page-74" name="page-74"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   path

      Exactly one.  STRING.  The full path to the file system object,
      including the name.  The path name should be represented in as
      "universal" a manner as possible, to facilitate processing of the
      alert.

   File

      Exactly one.  A &lt;File&gt; element may be used in place of the &lt;name&gt;
      and &lt;path&gt; elements if additional information about the file is to
      be included.

   This is represented in the IDMEF DTD as follows:

   &lt;!ENTITY % attvals.linkcat              "
       ( hard-link | mount-point | reparse-point | shortcut | stream |
         symbolic-link )
     "&gt;

   &lt;!ELEMENT Linkage                       (
       (name, path) | File
     )&gt;
   &lt;!ATTLIST Linkage
       category            %attvals.linkcat;       #REQUIRED
       %attlist.global;
     &gt;
























<span class="grey">Debar, et al.                 Experimental                     [Page 74]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-75" id="page-75" name="page-75"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   The Linkage class has one attribute:

   category

      The type of object that the link describes.  The permitted values
      are shown below.  There is no default value.  (See also
      <a href="#section-10">Section 10</a>.)

   +------+---------------+--------------------------------------------+
   | Rank | Keyword       | Description                                |
   +------+---------------+--------------------------------------------+
   |    0 | hard-link     | The &lt;name&gt; element represents another name |
   |      |               | for this file.  This information may be    |
   |      |               | more easily obtainable on NTFS file        |
   |      |               | systems than others.                       |
   |      |               |                                            |
   |    1 | mount-point   | An alias for the directory specified by    |
   |      |               | the parent's &lt;name&gt; and &lt;path&gt; elements.   |
   |      |               |                                            |
   |    2 | reparse-point | Applies only to Windows; excludes symbolic |
   |      |               | links and mount points, which are specific |
   |      |               | types of reparse points.                   |
   |      |               |                                            |
   |    3 | shortcut      | The file represented by a Windows          |
   |      |               | "shortcut".  A shortcut is distinguished   |
   |      |               | from a symbolic link because of the        |
   |      |               | difference in their contents, which may be |
   |      |               | of importance to the manager.              |
   |      |               |                                            |
   |    4 | stream        | An Alternate Data Stream (ADS) in Windows; |
   |      |               | a fork on MacOS.  Separate file system     |
   |      |               | entity that is considered an extension of  |
   |      |               | the main &lt;File&gt;.                           |
   |    5 | symbolic-link | The &lt;name&gt; element represents the file to  |
   |      |               | which the link points.                     |
   +------+---------------+--------------------------------------------+















<span class="grey">Debar, et al.                 Experimental                     [Page 75]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-76" id="page-76" name="page-76"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/4.2.7.6.3.%20%20The%20Inode%20Class"></a><a class="selflink" href="#section-4.2.7.6.3" name="section-4.2.7.6.3">4.2.7.6.3</a>.  The Inode Class</span>

   The Inode class is used to represent the additional information
   contained in a Unix file system i-node.

   The Inode class is composed of six aggregate classes, as shown in
   Figure 25.

                  +--------------+
                  |    Inode     |
                  +--------------+            +----------------+
                  |              |&lt;&gt;----------|   change-time  |
                  |              |            +----------------+
                  |              |            +----------------+
                  |              |&lt;&gt;----------|     number     |
                  |              |            +----------------+
                  |              |            +----------------+
                  |              |&lt;&gt;----------|  major-device  |
                  |              |            +----------------+
                  |              |            +----------------+
                  |              |&lt;&gt;----------|  minor-device  |
                  |              |            +----------------+
                  |              |            +----------------+
                  |              |&lt;&gt;----------| c-major-device |
                  |              |            +----------------+
                  |              |            +----------------+
                  |              |&lt;&gt;----------| c-minor-device |
                  |              |            +----------------+
                  +--------------+

                        Figure 25: The Inode Class

   The aggregate classes that make up Inode are:

   change-time

      Zero or one.  DATETIME.  The time of the last inode change, given
      by the st_ctime element of "struct stat".

   number

      Zero or one.  INTEGER.  The inode number.

   major-device

      Zero or one.  INTEGER.  The major device number of the device the
      file resides on.




<span class="grey">Debar, et al.                 Experimental                     [Page 76]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-77" id="page-77" name="page-77"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   minor-device

      Zero or one.  INTEGER.  The minor device number of the device the
      file resides on.

   c-major-device

      Zero or one.  INTEGER.  The major device of the file itself, if it
      is a character special device.

   c-minor-device

      Zero or one.  INTEGER.  The minor device of the file itself, if it
      is a character special device.

   Note that &lt;number&gt;, &lt;major-device&gt;, and &lt;minor-device&gt; must be given
   together, and the &lt;c-major-device&gt; and &lt;c-minor-device&gt; must be given
   together.

   This is represented in the IDMEF DTD as follows:

   &lt;!ELEMENT Inode                         (
       change-time?, (number, major-device, minor-device)?,
       (c-major-device, c-minor-device)?
     )&gt;
   &lt;!ATTLIST Inode
       %attlist.global;
     &gt;























<span class="grey">Debar, et al.                 Experimental                     [Page 77]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-78" id="page-78" name="page-78"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/4.2.7.6.4.%20%20The%20Checksum%20Class"></a><a class="selflink" href="#section-4.2.7.6.4" name="section-4.2.7.6.4">4.2.7.6.4</a>.  The Checksum Class</span>

   The Checksum class represents checksum information associated with
   the file.  This checksum information can be provided by file
   integrity checkers, among others.

   The checksum class is composed of two aggregate classes, as shown in
   Figure 26.

                  +--------------+
                  |   Checksum   |
                  +--------------+            +-------+
                  | algorithm    |&lt;&gt;----------| value |
                  |              |            +-------+
                  |              |        0..1+-------+
                  |              |&lt;&gt;----------|  key  |
                  |              |            +-------+
                  +--------------+

                       Figure 26: The Checksum Class

   The aggregate classes that make up Checksum are:

   value

      Exactly one.  STRING.  The value of the checksum.

   key

      Zero or one.  STRING.  The key to the checksum, if appropriate.

   This is represented in the IDMEF DTD as follows:

   &lt;!ENTITY % attvals.checksumalgos        "
         ( MD4 | MD5 | SHA1 | SHA2-256 | SHA2-384 | SHA2-512 | CRC-32 |
           Haval | Tiger | Gost )
     "&gt;

   &lt;!ELEMENT Checksum                      (
       value, key?
     )&gt;
   &lt;!ATTLIST Checksum
       algorithm           %attvals.checksumalgos; #REQUIRED
       %attlist.global;
     &gt;






<span class="grey">Debar, et al.                 Experimental                     [Page 78]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-79" id="page-79" name="page-79"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   The Checksum class has one attribute:

   algorithm

      The cryptographic algorithm used for the computation of the
      checksum.  The permitted values are shown below.  There is no
      default value.  (See also <a href="#section-10">Section 10</a>.)

      +------+----------+------------------------------------------+
      | Rank | Keyword  | Description                              |
      +------+----------+------------------------------------------+
      |    0 | MD4      | The MD4 algorithm.                       |
      |      |          |                                          |
      |    1 | MD5      | The MD5 algorithm.                       |
      |      |          |                                          |
      |    2 | SHA1     | The SHA1 algorithm.                      |
      |      |          |                                          |
      |    3 | SHA2-256 | The SHA2 algorithm with 256 bits length. |
      |      |          |                                          |
      |    4 | SHA2-384 | The SHA2 algorithm with 384 bits length. |
      |      |          |                                          |
      |    5 | SHA2-512 | The SHA2 algorithm with 512 bits length. |
      |      |          |                                          |
      |    6 | CRC-32   | The CRC algorithm with 32 bits length.   |
      |      |          |                                          |
      |    7 | Haval    | The Haval algorithm.                     |
      |      |          |                                          |
      |    8 | Tiger    | The Tiger algorithm.                     |
      |      |          |                                          |
      |    9 | Gost     | The Gost algorithm.                      |
      +------+----------+------------------------------------------+

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Extending%20the%20IDMEF"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Extending the IDMEF</span>

   As intrusion detection systems evolve, the IDMEF data model and DTD
   will have to evolve along with them.  To allow new features to be
   added as they are developed, both the data model and the DTD can be
   extended as described in this section.  As these extensions mature,
   they can then be incorporated into future versions of the
   specification.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Extending%20the%20Data%20Model"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Extending the Data Model</span>

   There are two mechanisms for extending the IDMEF data model,
   inheritance and aggregation:

   o  Inheritance denotes a superclass/subclass type of relationship
      where the subclass inherits all the attributes, operations, and



<span class="grey">Debar, et al.                 Experimental                     [Page 79]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-80" id="page-80" name="page-80"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


      relationships of the superclass.  This type of relationship is
      also called a "is-a" or "kind-of" relationship.  Subclasses may
      have additional attributes or operations that apply only to the
      subclass and not to the superclass.

   o  Aggregation is a form of association in which the whole is related
      to its parts.  This type of relationship is also referred to as a
      "part-of" relationship.  In this case, the aggregate class
      contains all of its own attributes and as many of the attributes
      associated with its parts as required and specified by occurrence
      indicators.

   Of the two mechanisms, inheritance is preferred, because it preserves
   the existing data model structure and also preserves the operations
   (methods) executed on the classes of the structure.

   Note that the rules for extending the IDMEF DTD (see below) set
   limits on the places where extensions to the data model may be made.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Extending%20the%20IDMEF%20DTD"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Extending the IDMEF DTD</span>

   There are two ways to extend the IDMEF DTD:

   1.  The AdditionalData class (see <a href="#section-4.2.4.6">Section 4.2.4.6</a>) allows
       implementors to include arbitrary "atomic" data items (integers,
       strings, etc.) in an Alert or Heartbeat message.  This approach
       SHOULD be used whenever possible.  See <a href="#section-7.4">Section 7.4</a> and
       <a href="#section-7.5">Section 7.5</a>.

   2.  The AdditionalData class allows implementors to extend the IDMEF
       DTD with additional DTD "modules" that describe arbitrarily
       complex data types and relationships.  The remainder of this
       section describes this extension method.

   To extend the IDMEF DTD with a new DTD "module", the following steps
   MUST be followed:

   1.  The document declaration MUST define a DTD location that defines
       the namespace and contains the location of the extension DTD, and
       then reference that namespace.

   2.  Multiple extensions may be included by defining multiple
       namespaces and DTD locations, and referencing them.

   3.  Extension DTDs MUST declare all of their elements and attributes
       in a separate XML namespace.  Extension DTDs MUST NOT declare any
       elements or attributes in the "idmef" or default namespaces.




<span class="grey">Debar, et al.                 Experimental                     [Page 80]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-81" id="page-81" name="page-81"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   4.  Extensions MUST only be included in IDMEF Alert and Heartbeat
       messages under an &lt;AdditionalData&gt; element whose "type" attribute
       contains the value "xml".  For example:

   In this example, the "vendorco" namespace is defined and then
   referenced, causing the DTD for the extension to be read by the XML
   parser.

   &lt;idmef:IDMEF-Message version="1.0"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xmlns:idmef="http://iana.org/idmef"
     xmlns:vendorco="http://vendor.com/idmef"
   xsi:schemaLocation="http://vendor.com/idmef <a href="http://v.com/vidmef.xsd">http://v.com/vidmef.xsd</a>"&gt;

    &lt;idmef:Alert messageid="..."&gt;
         ...
    &lt;idmef:AdditionalData type="xml" meaning="VendorExtension"&gt;
     &lt;idmef:xml&gt;
      &lt;vendorco:TestVendor a="attribute of example"
       xmlns:vendorco="http://vendor.com/idmef"
   xsi:schemaLocation="http://vendor.com/idmef <a href="http://v.com/vidmef.xsd">http://v.com/vidmef.xsd</a>"&gt;
       &lt;vendorco:content&gt;content element of example&lt;/vendorco:content&gt;
      &lt;/vendorco:TestVendor&gt;
     &lt;/idmef:xml&gt;
    &lt;/idmef:AdditionalData&gt;
    &lt;/idmef:Alert&gt;
   &lt;/idmef:IDMEF-Message&gt;

   See <a href="#section-7.8">Section 7.8</a> for another example of extending the IDMEF DTD.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Special%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Special Considerations</span>

   This section discusses some of the special considerations that must
   be taken into account by implementors of the IDMEF.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20XML%20Validity%20and%20Well-Formedness"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  XML Validity and Well-Formedness</span>

   It is expected that IDMEF-compliant applications will not normally
   include the IDMEF DTD itself in their communications.  Instead, the
   DTD will be referenced in the document type definition in the IDMEF
   message.  Such IDMEF documents will be well-formed and valid as
   defined in [<a href="#ref-3" title='"Extensible Markup Language (XML) 1.0 (Second Edition)"'>3</a>].

   Other IDMEF documents will be specified that do not include the
   document prolog (e.g., entries in an IDMEF-format database).  Such
   IDMEF documents will be well-formed but not valid.





<span class="grey">Debar, et al.                 Experimental                     [Page 81]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-82" id="page-82" name="page-82"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   Generally, well-formedness implies that a document has a single
   element that contains everything else (e.g., "&lt;Book&gt;") and that all
   the other elements nest nicely within each other without any
   overlapping (e.g., a "chapter" does not start in the middle of
   another "chapter").

   Validity further implies that not only is the document well-formed,
   but it also follows specific rules (contained in the Document Type
   Definition) about which elements are "legal" in the document, how
   those elements nest within other elements, and so on (e.g., a
   "chapter" does not begin in the middle of a "title").  A document
   cannot be valid unless it references a DTD.

   XML processors are required to be able to parse any well-formed
   document, valid or not.  The purpose of validation is to make the
   processing of that document (what's done with the data after it's
   parsed) easier.  Without validation, a document may contain elements
   in nonsense order, elements "invented" by the author that the
   processing application doesn't understand, and so forth.

   IDMEF documents MUST be well-formed.  IDMEF documents SHOULD be valid
   whenever both possible and practical.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Unrecognized%20XML%20Tags"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Unrecognized XML Tags</span>

   On occasion, an IDMEF-compliant application may receive a well-
   formed, or even well-formed and valid, IDMEF message containing tags
   that it does not understand.  The tags may be either:

   o  Recognized as "legitimate" (a valid document), but the application
      does not know the semantic meaning of the element's content; or

   o  Not recognized at all.

   IDMEF-compliant applications MUST continue to process IDMEF messages
   that contain unknown tags, provided that such messages meet the well-
   formedness requirement of <a href="#section-6.1">Section 6.1</a>.  It is up to the individual
   application to decide how to process (or ignore) any content from the
   unknown elements(s).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20Analyzer-Manager%20Time%20Synchronization"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  Analyzer-Manager Time Synchronization</span>

   Synchronization of time-of-day clocks between analyzers and managers
   is outside the scope of this document.  However, the following
   comments and suggestions are offered:






<span class="grey">Debar, et al.                 Experimental                     [Page 82]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-83" id="page-83" name="page-83"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   1.  Whenever possible, all analyzers and managers should have their
       time-of-day clocks synchronized to an external source such as NTP
       [<a href="#ref-7" title='"Network Time Protocol (Version 3) Specification, Implementation"'>7</a>] or SNTP [<a href="#ref-8" title='"Simple Network Time Protocol (SNTP) Version 4 for IPv4, IPv6 and OSI"'>8</a>] Global Positioning System (GPS), Geosynchronous
       Operational Environmental Satellite (GOES), NIST radio station
       WWV clocks, or some other reliable time standard.

   2.  When external time synchronization is not possible, the IDMEF
       provides the &lt;AnalyzerTime&gt; element, which may be used to perform
       rudimentary time synchronization (see below).

   3.  IDMEF-compliant applications SHOULD permit the user to enable/
       disable the &lt;AnalyzerTime&gt; method of time synchronization as a
       configuration option.

   A number of caveats apply to the use of &lt;AnalyzerTime&gt; for time
   synchronization:

   1.  &lt;AnalyzerTime&gt; works best in a "flat" environment where analyzers
       report up to a single level of managers.  When a tree topology of
       high-level managers, intermediate relays, and analyzers is used,
       the problem becomes more complex.

   2.  When intermediate message relays (managers or otherwise) are
       involved, two scenarios are possible:

       *  The intermediaries may forward entire IDMEF messages, or may
          perform aggregation or correlation, but MUST NOT inject delay.
          In this case, time synchronization is end-to-end between the
          analyzer and the highest-level manager.

       *  The intermediaries may inject delay, due to storage or
          additional processing.  In this case, time synchronization
          MUST be performed at each hop.  This means each intermediary
          must decompose the IDMEF message, adjust all time values, and
          then reconstruct the message before sending it on.

   3.  When the environment is mixed, with some analyzers and managers
       using external time synchronization and some not, all managers
       and intermediaries must perform &lt;AnalyzerTime&gt; synchronization.
       This is because determining whether or not compensation is
       actually needed between two parties rapidly becomes very complex,
       and requires knowledge of other parts of the topology.

   4.  If an alert can take alternate paths, or be stored in multiple
       locations, the recorded times may be different depending on the
       path taken.





<span class="grey">Debar, et al.                 Experimental                     [Page 83]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-84" id="page-84" name="page-84"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   The above being said, &lt;AnalyzerTime&gt; synchronization is probably
   still better than nothing in many environments.  To implement this
   type of synchronization, the following procedure is suggested:

   1.  When an analyzer or manager sends an IDMEF message, it should
       place the current value of its time-of-day clock in an
       &lt;AnalyzerTime&gt; element.  This should occur as late as possible in
       the message transmission process, ideally right before the
       message is "put on the wire".

   2.  When a manager receives an IDMEF message, it should compute the
       difference between its own time-of-day clock and the time in the
       &lt;AnalyzerTime&gt; element of the message.  This difference should
       then be used to adjust the times in the &lt;CreateTime&gt; and
       &lt;DetectTime&gt; elements (NTP timestamps should also be adjusted).

   3.  If the manager is an intermediary and sends the IDMEF message on
       to a higher-level manager, and hop-by-hop synchronization is in
       effect, it should regenerate the &lt;AnalyzerTime&gt; value to contain
       the value of its own time-of-day clock.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.4.%20%20NTP%20Timestamp%20Wrap-Around"></a><a class="selflink" href="#section-6.4" name="section-6.4">6.4</a>.  NTP Timestamp Wrap-Around</span>

   From [<a href="#ref-8" title='"Simple Network Time Protocol (SNTP) Version 4 for IPv4, IPv6 and OSI"'>8</a>]:

      Note that, since some time in 1968 (second 2,147,483,648) the most
      significant bit (bit 0 of the integer part) has been set and that
      the 64-bit field will overflow some time in 2036 (second
      4,294,967,296).  Should NTP or SNTP be in use in 2036, some
      external means will be necessary to qualify time relative to 1900
      and time relative to 2036 (and other multiples of 136 years).
      There will exist a 200-picosecond interval, henceforth ignored,
      every 136 years when the 64-bit field will be 0, which by
      convention is interpreted as an invalid or unavailable timestamp.

   IDMEF-compliant applications MUST NOT send a zero-valued NTP
   timestamp unless they mean to indicate that it is invalid or
   unavailable.  If an IDMEF-compliant application must send an IDMEF
   message at the time of rollover, the application should wait for 200
   picoseconds until the timestamp will have a non-zero value.

   Also from [<a href="#ref-8" title='"Simple Network Time Protocol (SNTP) Version 4 for IPv4, IPv6 and OSI"'>8</a>]:

      As the NTP timestamp format has been in use for the last 17 years,
      it remains a possibility that it will be in use 40 years from now
      when the seconds field overflows.  As it is probably inappropriate
      to archive NTP timestamps before bit 0 was set in 1968, a




<span class="grey">Debar, et al.                 Experimental                     [Page 84]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-85" id="page-85" name="page-85"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


      convenient way to extend the useful life of NTP timestamps is the
      following convention:

         If bit 0 is set, the UTC time is in the range 1968-2036 and UTC
         time is reckoned from 0h 0m 0s UTC on 1 January 1900.

         If bit 0 is not set, the time is in the range 2036-2104 and UTC
         time is reckoned from 6h 28m 16s UTC on 7 February 2036.

      Note that when calculating the correspondence, 2000 is not a leap
      year.  Note also that leap seconds are not counted in the
      reckoning.

   IDMEF-compliant applications in use after 2036-02-07T06:28:16Z MUST
   adhere to the above convention.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.5.%20%20Digital%20Signatures"></a><a class="selflink" href="#section-6.5" name="section-6.5">6.5</a>.  Digital Signatures</span>

   Standard XML digital signature processing rules and syntax are
   specified in [<a href="#ref-13" title='"(Extensible Markup Language) XML-Signature Syntax and Processing"'>13</a>].  XML Signatures provide integrity, message
   authentication, and/or signer authentication services for data of any
   type, whether located within the XML that includes the signature or
   elsewhere.

   The IDMEF requirements document [<a href="#ref-2" title='"Intrusion Detection Mesage Exchange Requirements"'>2</a>] assigns responsibility for
   message integrity and authentication to the communications protocol,
   not the message format.  However, in situations where IDMEF messages
   are exchanged over other, less secure protocols, or in cases where
   the digital signatures must be archived for later use, the inclusion
   of digital signatures within an IDMEF message itself may be
   desirable.

   Specifications for the use of digital signatures within IDMEF
   messages are outside the scope of this document.  However, if such
   functionality is needed, use of the XML Signature standard is
   RECOMMENDED.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Examples"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Examples</span>

   The examples shown in this section demonstrate how the IDMEF is used
   to encode alert data.  These examples are for illustrative purposes
   only, and do not necessarily represent the only (or even the "best")
   way to encode these particular alerts.  These examples should not be
   taken as guidelines on how alerts should be classified.







<span class="grey">Debar, et al.                 Experimental                     [Page 85]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-86" id="page-86" name="page-86"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Denial-of-Service%20Attacks"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Denial-of-Service Attacks</span>

   The following examples show how some common denial-of-service attacks
   could be represented in the IDMEF.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.1.1.%20%20The%20%22teardrop%22%20Attack"></a><a class="selflink" href="#section-7.1.1" name="section-7.1.1">7.1.1</a>.  The "teardrop" Attack</span>

   Network-based detection of the "teardrop" attack.  This shows the
   basic format of an alert.

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;

   &lt;idmef:IDMEF-Message xmlns:idmef="http://iana.org/idmef"
                        version="1.0"&gt;
     &lt;idmef:Alert messageid="abc123456789"&gt;
       &lt;idmef:Analyzer analyzerid="hq-dmz-analyzer01"&gt;
         &lt;idmef:Node category="dns"&gt;
           &lt;idmef:location&gt;Headquarters DMZ Network&lt;/idmef:location&gt;
           &lt;idmef:name&gt;analyzer01.example.com&lt;/idmef:name&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Analyzer&gt;
       &lt;idmef:CreateTime ntpstamp="0xbc723b45.0xef449129"&gt;
         2000-03-09T10:01:25.93464-05:00
       &lt;/idmef:CreateTime&gt;
       &lt;idmef:Source ident="a1b2c3d4"&gt;
         &lt;idmef:Node ident="a1b2c3d4-001" category="dns"&gt;
           &lt;idmef:name&gt;badguy.example.net&lt;/idmef:name&gt;
           &lt;idmef:Address ident="a1b2c3d4-002"
                          category="ipv4-net-mask"&gt;
             &lt;idmef:address&gt;192.0.2.50&lt;/idmef:address&gt;
             &lt;idmef:netmask&gt;255.255.255.255&lt;/idmef:netmask&gt;
           &lt;/idmef:Address&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Source&gt;
       &lt;idmef:Target ident="d1c2b3a4"&gt;
         &lt;idmef:Node ident="d1c2b3a4-001" category="dns"&gt;
           &lt;idmef:Address category="ipv4-addr-hex"&gt;
             &lt;idmef:address&gt;0xde796f70&lt;/idmef:address&gt;
           &lt;/idmef:Address&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Target&gt;
       &lt;idmef:Classification text="Teardrop detected"&gt;
         &lt;idmef:Reference origin="bugtraqid"&gt;
           &lt;idmef:name&gt;124&lt;/idmef:name&gt;
           &lt;idmef:url&gt;http://www.securityfocus.com/bid/124&lt;/idmef:url&gt;
         &lt;/idmef:Reference&gt;
       &lt;/idmef:Classification&gt;
     &lt;/idmef:Alert&gt;



<span class="grey">Debar, et al.                 Experimental                     [Page 86]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-87" id="page-87" name="page-87"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   &lt;/idmef:IDMEF-Message&gt;

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.1.2.%20%20The%20%22ping%20of%20death%22%20Attack"></a><a class="selflink" href="#section-7.1.2" name="section-7.1.2">7.1.2</a>.  The "ping of death" Attack</span>

   Network-based detection of the "ping of death" attack.  Note the
   identification of multiple targets, and the identification of the
   source as a spoofed address.

   NOTE: The URL has been cut to fit the IETF formating requirements.

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;

   &lt;idmef:IDMEF-Message version="1.0"
                        xmlns:idmef="http://iana.org/idmef"&gt;
     &lt;idmef:Alert messageid="abc123456789"&gt;
       &lt;idmef:Analyzer analyzerid="bc-sensor01"&gt;
         &lt;idmef:Node category="dns"&gt;
           &lt;idmef:name&gt;sensor.example.com&lt;/idmef:name&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Analyzer&gt;
       &lt;idmef:CreateTime ntpstamp="0xbc71f4f5.0xef449129"&gt;
         2000-03-09T10:01:25.93464Z
       &lt;/idmef:CreateTime&gt;
       &lt;idmef:Source ident="a1a2" spoofed="yes"&gt;
         &lt;idmef:Node ident="a1a2-1"&gt;
           &lt;idmef:Address ident="a1a2-2" category="ipv4-addr"&gt;
             &lt;idmef:address&gt;192.0.2.200&lt;/idmef:address&gt;
           &lt;/idmef:Address&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Source&gt;
       &lt;idmef:Target ident="b3b4"&gt;
         &lt;idmef:Node&gt;
           &lt;idmef:Address ident="b3b4-1" category="ipv4-addr"&gt;
             &lt;idmef:address&gt;192.0.2.50&lt;/idmef:address&gt;
           &lt;/idmef:Address&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Target&gt;
       &lt;idmef:Target ident="c5c6"&gt;
         &lt;idmef:Node ident="c5c6-1" category="nisplus"&gt;
           &lt;idmef:name&gt;lollipop&lt;/idmef:name&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Target&gt;
       &lt;idmef:Target ident="d7d8"&gt;
         &lt;idmef:Node ident="d7d8-1"&gt;
           &lt;idmef:location&gt;Cabinet B10&lt;/idmef:location&gt;
           &lt;idmef:name&gt;Cisco.router.b10&lt;/idmef:name&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Target&gt;



<span class="grey">Debar, et al.                 Experimental                     [Page 87]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-88" id="page-88" name="page-88"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


       &lt;idmef:Classification text="Ping-of-death detected"&gt;
         &lt;idmef:Reference origin="cve"&gt;
           &lt;idmef:name&gt;CVE-1999-128&lt;/idmef:name&gt;
           &lt;idmef:url&gt;http://www.cve.mitre.org/cgi-bin/
           cvename.cgi?name=CVE-1999-128&lt;/idmef:url&gt;
         &lt;/idmef:Reference&gt;
       &lt;/idmef:Classification&gt;
     &lt;/idmef:Alert&gt;
   &lt;/idmef:IDMEF-Message&gt;

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Port%20Scanning%20Attacks"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Port Scanning Attacks</span>

   The following examples show how some common port scanning attacks
   could be represented in the IDMEF.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.2.1.%20%20Connection%20to%20a%20Disallowed%20Service"></a><a class="selflink" href="#section-7.2.1" name="section-7.2.1">7.2.1</a>.  Connection to a Disallowed Service</span>

   Host-based detection of a policy violation (attempt to obtain
   information via "finger").  Note the identification of the target
   service, as well as the originating user (obtained, e.g., through <a href="rfc1413.html">RFC</a>
   <a href="rfc1413.html">1413</a> [<a href="#ref-11" title='"Identification Protocol"'>11</a>]).

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;

   &lt;idmef:IDMEF-Message version="1.0"
                        xmlns:idmef="http://iana.org/idmef"&gt;
     &lt;idmef:Alert messageid="abc123456789"&gt;
       &lt;idmef:Analyzer analyzerid="bc-sensor01"&gt;
         &lt;idmef:Node category="dns"&gt;
           &lt;idmef:name&gt;sensor.example.com&lt;/idmef:name&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Analyzer&gt;
       &lt;idmef:CreateTime ntpstamp="0xbc72541d.0x00000000"&gt;
         2000-03-09T18:47:25+02:00
       &lt;/idmef:CreateTime&gt;
       &lt;idmef:Source ident="a123"&gt;
         &lt;idmef:Node ident="a123-01"&gt;
           &lt;idmef:Address ident="a123-02" category="ipv4-addr"&gt;
             &lt;idmef:address&gt;192.0.2.200&lt;/idmef:address&gt;
           &lt;/idmef:Address&gt;
         &lt;/idmef:Node&gt;
         &lt;idmef:User ident="q987-03" category="os-device"&gt;
           &lt;idmef:UserId ident="q987-04" type="target-user"&gt;
             &lt;idmef:name&gt;badguy&lt;/idmef:name&gt;
           &lt;/idmef:UserId&gt;
         &lt;/idmef:User&gt;
         &lt;idmef:Service ident="a123-03"&gt;
           &lt;idmef:port&gt;31532&lt;/idmef:port&gt;



<span class="grey">Debar, et al.                 Experimental                     [Page 88]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-89" id="page-89" name="page-89"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


         &lt;/idmef:Service&gt;
       &lt;/idmef:Source&gt;
       &lt;idmef:Target ident="z456"&gt;
         &lt;idmef:Node ident="z456-01" category="nis"&gt;
           &lt;idmef:name&gt;myhost&lt;/idmef:name&gt;
           &lt;idmef:Address ident="z456-02" category="ipv4-addr"&gt;
             &lt;idmef:address&gt;192.0.2.50&lt;/idmef:address&gt;
           &lt;/idmef:Address&gt;
         &lt;/idmef:Node&gt;
         &lt;idmef:Service ident="z456-03"&gt;
           &lt;idmef:name&gt;finger&lt;/idmef:name&gt;
           &lt;idmef:port&gt;79&lt;/idmef:port&gt;
         &lt;/idmef:Service&gt;
       &lt;/idmef:Target&gt;
       &lt;idmef:Classification text="Portscan"&gt;
         &lt;idmef:Reference origin="vendor-specific"&gt;
           &lt;idmef:name&gt;finger&lt;/idmef:name&gt;
           &lt;idmef:url&gt;http://www.vendor.com/finger&lt;/idmef:url&gt;
         &lt;/idmef:Reference&gt;
         &lt;idmef:Reference origin="vendor-specific"
                          meaning="general documentation"&gt;
           &lt;idmef:name&gt;Distributed attack&lt;/idmef:name&gt;
           &lt;idmef:url&gt;http://www.vendor.com/distributed&lt;/idmef:url&gt;
         &lt;/idmef:Reference&gt;
       &lt;/idmef:Classification&gt;
     &lt;/idmef:Alert&gt;
   &lt;/idmef:IDMEF-Message&gt;

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.2.2.%20%20Simple%20Port%20Scanning"></a><a class="selflink" href="#section-7.2.2" name="section-7.2.2">7.2.2</a>.  Simple Port Scanning</span>

   Network-based detection of a port scan.  This shows detection by a
   single analyzer; see <a href="#section-7.5">Section 7.5</a> for the same attack as detected by a
   correlation engine.  Note the use of &lt;portlist&gt; to show the ports
   that were scanned.

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;

   &lt;idmef:IDMEF-Message version="1.0"
                  xmlns:idmef="http://iana.org/idmef"&gt;
     &lt;idmef:Alert messageid="abc123456789"&gt;
       &lt;idmef:Analyzer analyzerid="hq-dmz-analyzer62"&gt;
         &lt;idmef:Node category="dns"&gt;
           &lt;idmef:location&gt;Headquarters Web Server&lt;/idmef:location&gt;
           &lt;idmef:name&gt;analyzer62.example.com&lt;/idmef:name&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Analyzer&gt;
       &lt;idmef:CreateTime ntpstamp="0xbc72b2b4.0x00000000"&gt;
         2000-03-09T15:31:00-08:00



<span class="grey">Debar, et al.                 Experimental                     [Page 89]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-90" id="page-90" name="page-90"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


       &lt;/idmef:CreateTime&gt;
       &lt;idmef:Source ident="abc01"&gt;
         &lt;idmef:Node ident="abc01-01"&gt;
           &lt;idmef:Address ident="abc01-02" category="ipv4-addr"&gt;
             &lt;idmef:address&gt;192.0.2.200&lt;/idmef:address&gt;
           &lt;/idmef:Address&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Source&gt;
       &lt;idmef:Target ident="def01"&gt;
         &lt;idmef:Node ident="def01-01" category="dns"&gt;
           &lt;idmef:name&gt;www.example.com&lt;/idmef:name&gt;
           &lt;idmef:Address ident="def01-02" category="ipv4-addr"&gt;
             &lt;idmef:address&gt;192.0.2.50&lt;/idmef:address&gt;
           &lt;/idmef:Address&gt;
         &lt;/idmef:Node&gt;
         &lt;idmef:Service ident="def01-03"&gt;
           &lt;idmef:portlist&gt;5-25,37,42,43,53,69-119,123-514
           &lt;/idmef:portlist&gt;
         &lt;/idmef:Service&gt;
       &lt;/idmef:Target&gt;
       &lt;idmef:Classification text="simple portscan"&gt;
         &lt;idmef:Reference origin="vendor-specific"&gt;
           &lt;idmef:name&gt;portscan&lt;/idmef:name&gt;
           &lt;idmef:url&gt;http://www.vendor.com/portscan&lt;/idmef:url&gt;
         &lt;/idmef:Reference&gt;
       &lt;/idmef:Classification&gt;
     &lt;/idmef:Alert&gt;
   &lt;/idmef:IDMEF-Message&gt;

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.3.%20%20Local%20Attacks"></a><a class="selflink" href="#section-7.3" name="section-7.3">7.3</a>.  Local Attacks</span>

   The following examples show how some common local host attacks could
   be represented in the IDMEF.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.3.1.%20%20The%20%22loadmodule%22%20Attack"></a><a class="selflink" href="#section-7.3.1" name="section-7.3.1">7.3.1</a>.  The "loadmodule" Attack</span>

   Host-based detection of the "loadmodule" exploit.  This attack
   involves tricking the "loadmodule" program into running another
   program; since "loadmodule" is set-user-id "root", the executed
   program runs with super-user privileges.  Note the use of &lt;User&gt; and
   &lt;Process&gt; to identify the user attempting the exploit and how he's
   doing it.

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;

   &lt;idmef:IDMEF-Message version="1.0"
                        xmlns:idmef="http://iana.org/idmef"&gt;
     &lt;idmef:Alert messageid="abc123456789"&gt;



<span class="grey">Debar, et al.                 Experimental                     [Page 90]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-91" id="page-91" name="page-91"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


       &lt;idmef:Analyzer analyzerid="bc-fs-sensor13"&gt;
         &lt;idmef:Node category="dns"&gt;
           &lt;idmef:name&gt;fileserver.example.com&lt;/idmef:name&gt;
         &lt;/idmef:Node&gt;
         &lt;idmef:Process&gt;
           &lt;idmef:name&gt;monitor&lt;/idmef:name&gt;
           &lt;idmef:pid&gt;8956&lt;/idmef:pid&gt;
           &lt;idmef:arg&gt;monitor&lt;/idmef:arg&gt;
           &lt;idmef:arg&gt;-d&lt;/idmef:arg&gt;
           &lt;idmef:arg&gt;-m&lt;/idmef:arg&gt;
           &lt;idmef:arg&gt;idmanager.example.com&lt;/idmef:arg&gt;
           &lt;idmef:arg&gt;-l&lt;/idmef:arg&gt;
           &lt;idmef:arg&gt;/var/logs/idlog&lt;/idmef:arg&gt;
         &lt;/idmef:Process&gt;
       &lt;/idmef:Analyzer&gt;
       &lt;idmef:CreateTime ntpstamp="0xbc7221c0.0x4ccccccc"&gt;
         2000-03-09T08:12:32.3-05:00
       &lt;/idmef:CreateTime&gt;
       &lt;idmef:Source ident="a1a2"&gt;
         &lt;idmef:User ident="a1a2-01" category="os-device"&gt;
           &lt;idmef:UserId ident="a1a2-02"
                         type="original-user"&gt;
             &lt;idmef:name&gt;joe&lt;/idmef:name&gt;
             &lt;idmef:number&gt;13243&lt;/idmef:number&gt;
           &lt;/idmef:UserId&gt;
         &lt;/idmef:User&gt;
         &lt;idmef:Process ident="a1a2-03"&gt;
           &lt;idmef:name&gt;loadmodule&lt;/idmef:name&gt;
           &lt;idmef:path&gt;/usr/openwin/bin&lt;/idmef:path&gt;
         &lt;/idmef:Process&gt;
       &lt;/idmef:Source&gt;
       &lt;idmef:Target ident="z3z4"&gt;
         &lt;idmef:Node ident="z3z4-01" category="dns"&gt;
           &lt;idmef:name&gt;fileserver.example.com&lt;/idmef:name&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Target&gt;
       &lt;idmef:Classification text="Loadmodule attack"
                             ident="loadmodule"&gt;
         &lt;idmef:Reference origin="bugtraqid"&gt;
           &lt;idmef:name&gt;33&lt;/idmef:name&gt;
           &lt;idmef:url&gt;http://www.securityfocus.com&lt;/idmef:url&gt;
         &lt;/idmef:Reference&gt;
       &lt;/idmef:Classification&gt;
     &lt;/idmef:Alert&gt;
   &lt;/idmef:IDMEF-Message&gt;






<span class="grey">Debar, et al.                 Experimental                     [Page 91]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-92" id="page-92" name="page-92"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   The Intrusion Detection System (IDS) could also indicate that the
   target user is the "root" user, and show the attempted command; the
   alert might then look like:

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;

   &lt;idmef:IDMEF-Message version="1.0"
                        xmlns:idmef="http://iana.org/idmef"&gt;
     &lt;idmef:Alert messageid="abc123456789"&gt;
       &lt;idmef:Analyzer analyzerid="bc-fs-sensor13"&gt;
         &lt;idmef:Node category="dns"&gt;
           &lt;idmef:name&gt;fileserver.example.com&lt;/idmef:name&gt;
         &lt;/idmef:Node&gt;
         &lt;idmef:Process&gt;
           &lt;idmef:name&gt;monitor&lt;/idmef:name&gt;
           &lt;idmef:pid&gt;8956&lt;/idmef:pid&gt;
           &lt;idmef:arg&gt;monitor&lt;/idmef:arg&gt;
           &lt;idmef:arg&gt;-d&lt;/idmef:arg&gt;
           &lt;idmef:arg&gt;-m&lt;/idmef:arg&gt;
           &lt;idmef:arg&gt;idmanager.example.com&lt;/idmef:arg&gt;
           &lt;idmef:arg&gt;-l&lt;/idmef:arg&gt;
           &lt;idmef:arg&gt;/var/logs/idlog&lt;/idmef:arg&gt;
         &lt;/idmef:Process&gt;
       &lt;/idmef:Analyzer&gt;
       &lt;idmef:CreateTime ntpstamp="0xbc7221c0.0x4ccccccc"&gt;
         2000-03-09T08:12:32.3-05:00
       &lt;/idmef:CreateTime&gt;
       &lt;idmef:Source ident="a1a2"&gt;
         &lt;idmef:User ident="a1a2-01" category="os-device"&gt;
           &lt;idmef:UserId ident="a1a2-02" type="original-user"&gt;
             &lt;idmef:name&gt;joe&lt;/idmef:name&gt;
             &lt;idmef:number&gt;13243&lt;/idmef:number&gt;
           &lt;/idmef:UserId&gt;
         &lt;/idmef:User&gt;
         &lt;idmef:Process ident="a1a2-03"&gt;
           &lt;idmef:name&gt;loadmodule&lt;/idmef:name&gt;
           &lt;idmef:path&gt;/usr/openwin/bin&lt;/idmef:path&gt;
         &lt;/idmef:Process&gt;
       &lt;/idmef:Source&gt;
       &lt;idmef:Target ident="z3z4"&gt;
         &lt;idmef:Node ident="z3z4-01" category="dns"&gt;
           &lt;idmef:name&gt;fileserver.example.com&lt;/idmef:name&gt;
         &lt;/idmef:Node&gt;
         &lt;idmef:User ident="z3z4-02" category="os-device"&gt;
           &lt;idmef:UserId ident="z3z4-03" type="target-user"&gt;
             &lt;idmef:name&gt;root&lt;/idmef:name&gt;
             &lt;idmef:number&gt;0&lt;/idmef:number&gt;
           &lt;/idmef:UserId&gt;



<span class="grey">Debar, et al.                 Experimental                     [Page 92]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-93" id="page-93" name="page-93"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


         &lt;/idmef:User&gt;
         &lt;idmef:Process ident="z3z4-04"&gt;
           &lt;idmef:name&gt;sh&lt;/idmef:name&gt;
           &lt;idmef:pid&gt;25134&lt;/idmef:pid&gt;
           &lt;idmef:path&gt;/bin/sh&lt;/idmef:path&gt;
         &lt;/idmef:Process&gt;
       &lt;/idmef:Target&gt;
       &lt;idmef:Classification text="Loadmodule attack"
                             ident="loadmodule"&gt;
       &lt;/idmef:Classification&gt;
     &lt;/idmef:Alert&gt;
   &lt;/idmef:IDMEF-Message&gt;

   Note that the identification of the classification is used.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.3.2.%20%20The%20%22phf%22%20Attack"></a><a class="selflink" href="#section-7.3.2" name="section-7.3.2">7.3.2</a>.  The "phf" Attack</span>

   Network-based detection of the "phf" attack.  Note the use of the
   &lt;WebService&gt; element to provide more details about this particular
   attack.

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;

   &lt;idmef:IDMEF-Message version="1.0"
                        xmlns:idmef="http://iana.org/idmef"&gt;
     &lt;idmef:Alert messageid="abc123456789"&gt;
       &lt;idmef:Analyzer analyzerid="bc-sensor01"&gt;
         &lt;idmef:Node category="dns"&gt;
           &lt;idmef:name&gt;sensor.example.com&lt;/idmef:name&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Analyzer&gt;
       &lt;idmef:CreateTime ntpstamp="0xbc71e980.0x00000000"&gt;
         2000-03-09T08:12:32-01:00
       &lt;/idmef:CreateTime&gt;
       &lt;idmef:Source ident="abc123"&gt;
         &lt;idmef:Node ident="abc123-001"&gt;
           &lt;idmef:Address ident="abc123-002"
                          category="ipv4-addr"&gt;
             &lt;idmef:address&gt;192.0.2.200&lt;/idmef:address&gt;
           &lt;/idmef:Address&gt;
         &lt;/idmef:Node&gt;
         &lt;idmef:Service ident="abc123-003"&gt;
           &lt;idmef:port&gt;21534&lt;/idmef:port&gt;
         &lt;/idmef:Service&gt;
       &lt;/idmef:Source&gt;
       &lt;idmef:Target ident="xyz789"&gt;
         &lt;idmef:Node ident="xyz789-001" category="dns"&gt;
           &lt;idmef:name&gt;www.example.com&lt;/idmef:name&gt;



<span class="grey">Debar, et al.                 Experimental                     [Page 93]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-94" id="page-94" name="page-94"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


           &lt;idmef:Address ident="xyz789-002"
                          category="ipv4-addr"&gt;
             &lt;idmef:address&gt;192.0.2.100&lt;/idmef:address&gt;
           &lt;/idmef:Address&gt;
         &lt;/idmef:Node&gt;
         &lt;idmef:Service&gt;
           &lt;idmef:port&gt;8080&lt;/idmef:port&gt;
           &lt;idmef:WebService&gt;
             &lt;idmef:url&gt;
             http://www.example.com/cgi-bin/phf?/etc/group
             &lt;/idmef:url&gt;
             &lt;idmef:cgi&gt;/cgi-bin/phf&lt;/idmef:cgi&gt;
             &lt;idmef:http-method&gt;GET&lt;/idmef:http-method&gt;
           &lt;/idmef:WebService&gt;
         &lt;/idmef:Service&gt;
       &lt;/idmef:Target&gt;
       &lt;idmef:Classification text="phf attack"&gt;
         &lt;idmef:Reference origin="bugtraqid"&gt;
           &lt;idmef:name&gt;629&lt;/idmef:name&gt;
           &lt;idmef:url&gt;
           <a href="http://www.securityfocus.com/bid/629">http://www.securityfocus.com/bid/629</a>
           &lt;/idmef:url&gt;
         &lt;/idmef:Reference&gt;
       &lt;/idmef:Classification&gt;
     &lt;/idmef:Alert&gt;
   &lt;/idmef:IDMEF-Message&gt;

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.3.3.%20%20File%20Modification"></a><a class="selflink" href="#section-7.3.3" name="section-7.3.3">7.3.3</a>.  File Modification</span>

   Host-based detection of a race condition attack.  Note the use of the
   &lt;File&gt; to provide information about the files that are used to
   perform the attack.

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;

   &lt;idmef:IDMEF-Message version="1.0"
                        xmlns:idmef="http://iana.org/idmef"&gt;
     &lt;idmef:Alert&gt;
       &lt;idmef:Analyzer analyzerid="bids-192.0.2.1"
                       ostype="Linux"
                       osversion="2.2.16-3"&gt;
         &lt;idmef:Node category="hosts"&gt;
           &lt;idmef:name&gt;etude&lt;/idmef:name&gt;
           &lt;idmef:Address category="ipv4-addr"&gt;
             &lt;idmef:address&gt;192.0.2.1&lt;/idmef:address&gt;
           &lt;/idmef:Address&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Analyzer&gt;



<span class="grey">Debar, et al.                 Experimental                     [Page 94]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-95" id="page-95" name="page-95"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


       &lt;idmef:CreateTime ntpstamp="0xbc71e980.0x00000000"&gt;
         2000-03-09T08:12:32-01:00
       &lt;/idmef:CreateTime&gt;
       &lt;idmef:Source spoofed="no"&gt;
         &lt;idmef:Node&gt;
           &lt;idmef:location&gt;console&lt;/idmef:location&gt;
           &lt;idmef:Address category="ipv4-addr"&gt;
             &lt;idmef:address&gt;192.0.2.1&lt;/idmef:address&gt;
           &lt;/idmef:Address&gt;
           &lt;/idmef:Node&gt;
       &lt;/idmef:Source&gt;
       &lt;idmef:Target decoy="no"&gt;
         &lt;idmef:Node&gt;
           &lt;idmef:location&gt;local&lt;/idmef:location&gt;
           &lt;idmef:Address category="ipv4-addr"&gt;
             &lt;idmef:address&gt;192.0.2.1&lt;/idmef:address&gt;
           &lt;/idmef:Address&gt;
         &lt;/idmef:Node&gt;
         &lt;idmef:User category="os-device"&gt;
           &lt;idmef:UserId type="original-user"&gt;
             &lt;idmef:number&gt;456&lt;/idmef:number&gt;
           &lt;/idmef:UserId&gt;
           &lt;idmef:UserId type="current-user"&gt;
             &lt;idmef:name&gt;fred&lt;/idmef:name&gt;
             &lt;idmef:number&gt;456&lt;/idmef:number&gt;
           &lt;/idmef:UserId&gt;
           &lt;idmef:UserId type="user-privs"&gt;
             &lt;idmef:number&gt;456&lt;/idmef:number&gt;
           &lt;/idmef:UserId&gt;
         &lt;/idmef:User&gt;
         &lt;idmef:File category="current" fstype="tmpfs"&gt;
           &lt;idmef:name&gt;xxx000238483&lt;/idmef:name&gt;
           &lt;idmef:path&gt;/tmp/xxx000238483&lt;/idmef:path&gt;
           &lt;idmef:FileAccess&gt;
             &lt;idmef:UserId type="user-privs"&gt;
               &lt;idmef:name&gt;alice&lt;/idmef:name&gt;
               &lt;idmef:number&gt;777&lt;/idmef:number&gt;
             &lt;/idmef:UserId&gt;
             &lt;idmef:permission perms="read" /&gt;
             &lt;idmef:permission perms="write" /&gt;
             &lt;idmef:permission perms="delete" /&gt;
             &lt;idmef:permission perms="changePermissions" /&gt;
           &lt;/idmef:FileAccess&gt;
           &lt;idmef:FileAccess&gt;
             &lt;idmef:UserId type="group-privs"&gt;
               &lt;idmef:name&gt;user&lt;/idmef:name&gt;
               &lt;idmef:number&gt;42&lt;/idmef:number&gt;
             &lt;/idmef:UserId&gt;



<span class="grey">Debar, et al.                 Experimental                     [Page 95]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-96" id="page-96" name="page-96"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


             &lt;idmef:permission perms="read" /&gt;
             &lt;idmef:permission perms="write" /&gt;
             &lt;idmef:permission perms="delete" /&gt;
           &lt;/idmef:FileAccess&gt;
           &lt;idmef:FileAccess&gt;
             &lt;idmef:UserId type="other-privs"&gt;
               &lt;idmef:name&gt;world&lt;/idmef:name&gt;
             &lt;/idmef:UserId&gt;
             &lt;idmef:permission perms="noAccess" /&gt;
           &lt;/idmef:FileAccess&gt;
           &lt;idmef:Linkage category="symbolic-link"&gt;
             &lt;idmef:name&gt;passwd&lt;/idmef:name&gt;
             &lt;idmef:path&gt;/etc/passwd&lt;/idmef:path&gt;
           &lt;/idmef:Linkage&gt;
         &lt;/idmef:File&gt;
       &lt;/idmef:Target&gt;
       &lt;idmef:Classification text="DOM race condition"&gt;
         &lt;idmef:Reference origin="vendor-specific"&gt;
           &lt;idmef:name&gt;DOM race condition&lt;/idmef:name&gt;
           &lt;idmef:url&gt;file://attack-info/race.html
           &lt;/idmef:url&gt;
         &lt;/idmef:Reference&gt;
       &lt;/idmef:Classification&gt;
     &lt;/idmef:Alert&gt;
   &lt;/idmef:IDMEF-Message&gt;

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.4.%20%20System%20Policy%20Violation"></a><a class="selflink" href="#section-7.4" name="section-7.4">7.4</a>.  System Policy Violation</span>

   In this example, logins are restricted to daytime hours.  The alert
   reports a violation of this policy that occurs when a user logs in a
   little after 10:00 pm.  Note the use of &lt;AdditionalData&gt; to provide
   information about the policy being violated.

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;

   &lt;idmef:IDMEF-Message version="1.0"
                        xmlns:idmef="http://iana.org/idmef"&gt;
     &lt;idmef:Alert messageid="abc123456789"&gt;
       &lt;idmef:Analyzer analyzerid="bc-ds-01"&gt;
         &lt;idmef:Node category="dns"&gt;
           &lt;idmef:name&gt;dialserver.example.com&lt;/idmef:name&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Analyzer&gt;
       &lt;idmef:CreateTime ntpstamp="0xbc72e7ef.0x00000000"&gt;
         2000-03-09T22:18:07-05:00
       &lt;/idmef:CreateTime&gt;
       &lt;idmef:Source ident="s01"&gt;
         &lt;idmef:Node ident="s01-1"&gt;



<span class="grey">Debar, et al.                 Experimental                     [Page 96]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-97" id="page-97" name="page-97"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


           &lt;idmef:Address category="ipv4-addr"&gt;
             &lt;idmef:address&gt;127.0.0.1&lt;/idmef:address&gt;
           &lt;/idmef:Address&gt;
         &lt;/idmef:Node&gt;
         &lt;idmef:Service ident="s01-2"&gt;
           &lt;idmef:port&gt;4325&lt;/idmef:port&gt;
         &lt;/idmef:Service&gt;
       &lt;/idmef:Source&gt;
       &lt;idmef:Target ident="t01"&gt;
         &lt;idmef:Node ident="t01-1" category="dns"&gt;
           &lt;idmef:name&gt;mainframe.example.com&lt;/idmef:name&gt;
         &lt;/idmef:Node&gt;
         &lt;idmef:User ident="t01-2" category="os-device"&gt;
           &lt;idmef:UserId ident="t01-3" type="current-user"&gt;
             &lt;idmef:name&gt;louis&lt;/idmef:name&gt;
             &lt;idmef:number&gt;501&lt;/idmef:number&gt;
           &lt;/idmef:UserId&gt;
         &lt;/idmef:User&gt;
         &lt;idmef:Service ident="t01-4"&gt;
           &lt;idmef:name&gt;login&lt;/idmef:name&gt;
           &lt;idmef:port&gt;23&lt;/idmef:port&gt;
         &lt;/idmef:Service&gt;
       &lt;/idmef:Target&gt;
       &lt;idmef:Classification text="Login policy violation"&gt;
         &lt;idmef:Reference origin="user-specific"&gt;
           &lt;idmef:name&gt;out-of-hours activity&lt;/idmef:name&gt;
           &lt;idmef:url&gt;http://my.company.com/policies
           &lt;/idmef:url&gt;
         &lt;/idmef:Reference&gt;
       &lt;/idmef:Classification&gt;
       &lt;idmef:AdditionalData type="date-time"
                             meaning="start-time"&gt;
         &lt;idmef:date-time&gt;2000-03-09T07:00:00-05:00&lt;/idmef:date-time&gt;
       &lt;/idmef:AdditionalData&gt;
       &lt;idmef:AdditionalData type="date-time"
                             meaning="stop-time"&gt;
         &lt;idmef:date-time&gt;2000-03-09T19:30:00-05:00&lt;/idmef:date-time&gt;
       &lt;/idmef:AdditionalData&gt;
     &lt;/idmef:Alert&gt;
   &lt;/idmef:IDMEF-Message&gt;











<span class="grey">Debar, et al.                 Experimental                     [Page 97]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-98" id="page-98" name="page-98"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.5.%20%20Correlated%20Alerts"></a><a class="selflink" href="#section-7.5" name="section-7.5">7.5</a>.  Correlated Alerts</span>

   The following example shows how the port scan alert from
   <a href="#section-7.2.2">Section 7.2.2</a> could be represented if it had been detected and sent
   from a correlation engine, instead of a single analyzer.

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;

   &lt;idmef:IDMEF-Message version="1.0"
                        xmlns:idmef="http://iana.org/idmef"&gt;
     &lt;idmef:Alert messageid="abc123456789"&gt;
       &lt;idmef:Analyzer analyzerid="bc-corr-01"&gt;
         &lt;idmef:Node category="dns"&gt;
           &lt;idmef:name&gt;correlator01.example.com&lt;/idmef:name&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Analyzer&gt;
       &lt;idmef:CreateTime ntpstamp="0xbc72423b.0x00000000"&gt;
         2000-03-09T15:31:07Z
       &lt;/idmef:CreateTime&gt;
       &lt;idmef:Source ident="a1"&gt;
         &lt;idmef:Node ident="a1-1"&gt;
           &lt;idmef:Address ident="a1-2" category="ipv4-addr"&gt;
             &lt;idmef:address&gt;192.0.2.200&lt;/idmef:address&gt;
           &lt;/idmef:Address&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Source&gt;
       &lt;idmef:Target ident="a2"&gt;
         &lt;idmef:Node ident="a2-1" category="dns"&gt;
           &lt;idmef:name&gt;www.example.com&lt;/idmef:name&gt;
           &lt;idmef:Address ident="a2-2" category="ipv4-addr"&gt;
             &lt;idmef:address&gt;192.0.2.50&lt;/idmef:address&gt;
           &lt;/idmef:Address&gt;
         &lt;/idmef:Node&gt;
         &lt;idmef:Service ident="a2-3"&gt;
           &lt;idmef:portlist&gt;5-25,37,42,43,53,69-119,123-514
           &lt;/idmef:portlist&gt;
         &lt;/idmef:Service&gt;
       &lt;/idmef:Target&gt;
       &lt;idmef:Classification text="Portscan"&gt;
         &lt;idmef:Reference origin="vendor-specific"&gt;
           &lt;idmef:name&gt;portscan&lt;/idmef:name&gt;
           &lt;idmef:url&gt;http://www.vendor.com/portscan&lt;/idmef:url&gt;
         &lt;/idmef:Reference&gt;
       &lt;/idmef:Classification&gt;
       &lt;idmef:CorrelationAlert&gt;
         &lt;idmef:name&gt;multiple ports in short time&lt;/idmef:name&gt;
         &lt;idmef:alertident&gt;123456781&lt;/idmef:alertident&gt;
         &lt;idmef:alertident&gt;123456782&lt;/idmef:alertident&gt;



<span class="grey">Debar, et al.                 Experimental                     [Page 98]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-99" id="page-99" name="page-99"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


         &lt;idmef:alertident&gt;123456783&lt;/idmef:alertident&gt;
         &lt;idmef:alertident&gt;123456784&lt;/idmef:alertident&gt;
         &lt;idmef:alertident&gt;123456785&lt;/idmef:alertident&gt;
         &lt;idmef:alertident&gt;123456786&lt;/idmef:alertident&gt;
         &lt;idmef:alertident analyzerid="a1b2c3d4"&gt;987654321
         &lt;/idmef:alertident&gt;
         &lt;idmef:alertident analyzerid="a1b2c3d4"&gt;987654322
         &lt;/idmef:alertident&gt;
       &lt;/idmef:CorrelationAlert&gt;
     &lt;/idmef:Alert&gt;
   &lt;/idmef:IDMEF-Message&gt;

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.6.%20%20Analyzer%20Assessments"></a><a class="selflink" href="#section-7.6" name="section-7.6">7.6</a>.  Analyzer Assessments</span>

   Host-based detection of a successful unauthorized acquisition of root
   access through the eject buffer overflow.  Note the use of
   &lt;Assessment&gt; to provide information about the analyzer's evaluation
   of and reaction to the attack.

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;

   &lt;idmef:IDMEF-Message version="1.0"
                        xmlns:idmef="http://iana.org/idmef"&gt;
     &lt;idmef:Alert&gt;
       &lt;idmef:Analyzer analyzerid="bids-192.0.2.1"&gt;
       &lt;/idmef:Analyzer&gt;
       &lt;idmef:CreateTime ntpstamp="0xbc71e980.0x00000000"&gt;
         2000-03-09T08:12:32-01:00
       &lt;/idmef:CreateTime&gt;
       &lt;idmef:Source spoofed="no"&gt;
         &lt;idmef:Node&gt;
           &lt;idmef:location&gt;console&lt;/idmef:location&gt;
           &lt;idmef:Address category="ipv4-addr"&gt;
             &lt;idmef:address&gt;192.0.2.1&lt;/idmef:address&gt;
           &lt;/idmef:Address&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Source&gt;
       &lt;idmef:Target decoy="no"&gt;
         &lt;idmef:Node&gt;
           &lt;idmef:location&gt;local&lt;/idmef:location&gt;
           &lt;idmef:Address category="ipv4-addr"&gt;
             &lt;idmef:address&gt;192.0.2.1&lt;/idmef:address&gt;
           &lt;/idmef:Address&gt;
         &lt;/idmef:Node&gt;
         &lt;idmef:User category="os-device"&gt;
           &lt;idmef:UserId type="original-user"&gt;
             &lt;idmef:number&gt;456&lt;/idmef:number&gt;
           &lt;/idmef:UserId&gt;



<span class="grey">Debar, et al.                 Experimental                     [Page 99]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-100" id="page-100" name="page-100"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


           &lt;idmef:UserId type="current-user"&gt;
             &lt;idmef:name&gt;root&lt;/idmef:name&gt;
             &lt;idmef:number&gt;0&lt;/idmef:number&gt;
           &lt;/idmef:UserId&gt;
           &lt;idmef:UserId type="user-privs"&gt;
             &lt;idmef:number&gt;0&lt;/idmef:number&gt;
           &lt;/idmef:UserId&gt;
         &lt;/idmef:User&gt;
         &lt;idmef:Process&gt;
           &lt;idmef:name&gt;eject&lt;/idmef:name&gt;
           &lt;idmef:pid&gt;32451&lt;/idmef:pid&gt;
           &lt;idmef:path&gt;/usr/bin/eject&lt;/idmef:path&gt;
           &lt;idmef:arg&gt;\x90\x80\x3f\xff...\x08/bin/sh&lt;/idmef:arg&gt;
         &lt;/idmef:Process&gt;
       &lt;/idmef:Target&gt;
       &lt;idmef:Classification
           text="Unauthorized administrative access"&gt;
         &lt;idmef:Reference origin="vendor-specific"&gt;
           &lt;idmef:name&gt;Unauthorized user to superuser&lt;/idmef:name&gt;
           &lt;idmef:url&gt;file://attack-info/u2s.html&lt;/idmef:url&gt;
         &lt;/idmef:Reference&gt;
       &lt;/idmef:Classification&gt;
       &lt;idmef:Assessment&gt;
         &lt;idmef:Impact severity="high" completion="succeeded"
                 type="admin"/&gt;
         &lt;idmef:Action category="notification-sent"&gt;
           page
           &lt;/idmef:Action&gt;
         &lt;idmef:Action category="block-installed"&gt;
           disabled user (fred)
         &lt;/idmef:Action&gt;
         &lt;idmef:Action category="taken-offline"&gt;
           logout user (fred)
         &lt;/idmef:Action&gt;
         &lt;idmef:Confidence rating="high"/&gt;
       &lt;/idmef:Assessment&gt;
     &lt;/idmef:Alert&gt;
   &lt;/idmef:IDMEF-Message&gt;

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.7.%20%20Heartbeat"></a><a class="selflink" href="#section-7.7" name="section-7.7">7.7</a>.  Heartbeat</span>

   This example shows a Heartbeat message that provides "I'm alive and
   working" information to the manager.  Note the use of
   &lt;AdditionalData&gt; elements, with "meaning" attributes, to provide some
   additional information.






<span class="grey">Debar, et al.                 Experimental                    [Page 100]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-101" id="page-101" name="page-101"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   &lt;?xml version="1.0" encoding="UTF-8"?&gt;

   &lt;idmef:IDMEF-Message version="1.0"
                  xmlns:idmef="http://iana.org/idmef"&gt;
     &lt;idmef:Heartbeat messageid="abc123456789"&gt;
       &lt;idmef:Analyzer analyzerid="hq-dmz-analyzer01"&gt;
         &lt;idmef:Node category="dns"&gt;
           &lt;idmef:location&gt;Headquarters DMZ Network&lt;/idmef:location&gt;
           &lt;idmef:name&gt;analyzer01.example.com&lt;/idmef:name&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Analyzer&gt;
       &lt;idmef:CreateTime ntpstamp="0xbc722ebe.0x00000000"&gt;
         2000-03-09T14:07:58Z
       &lt;/idmef:CreateTime&gt;
       &lt;idmef:AdditionalData type="real" meaning="%memused"&gt;
         &lt;idmef:real&gt;62.5&lt;/idmef:real&gt;
       &lt;/idmef:AdditionalData&gt;
       &lt;idmef:AdditionalData type="real" meaning="%diskused"&gt;
         &lt;idmef:real&gt;87.1&lt;/idmef:real&gt;
       &lt;/idmef:AdditionalData&gt;
     &lt;/idmef:Heartbeat&gt;
   &lt;/idmef:IDMEF-Message&gt;

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.8.%20%20XML%20Extension"></a><a class="selflink" href="#section-7.8" name="section-7.8">7.8</a>.  XML Extension</span>

   The following example shows how to extend the IDMEF DTD.  In the
   example, the VendorCo company has decided it wants to add geographic
   information to the Node class.  To do this, VendorCo creates a
   Document Type Definition or DTD that defines how their class will be
   formatted:

   &lt;xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
               xmlns:vendorco="http://vendor.com/idmef"
               targetNamespace="http://vendor.com/idmef"
               elementFormDefault="qualified" &gt;

     &lt;xsd:annotation&gt;
       &lt;xsd:documentation&gt;
         Intrusion Detection Message Exchange Format (IDMEF) Extension
         for geographic information
       &lt;/xsd:documentation&gt;
     &lt;/xsd:annotation&gt;

     &lt;xsd:complexType name="NodeGeoType"&gt;
       &lt;xsd:sequence&gt;
       &lt;xsd:element name="latitude"
                    type="xsd:string" /&gt;
       &lt;xsd:element name="longitude"



<span class="grey">Debar, et al.                 Experimental                    [Page 101]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-102" id="page-102" name="page-102"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


                    type="xsd:string" /&gt;

       &lt;xsd:element name="elevation"
                    type="xsd:string"
                    minOccurs="0"
                    maxOccurs="1" /&gt;
           &lt;/xsd:sequence&gt;
       &lt;xsd:attribute name="node-ident"
                      type="xsd:integer"
                      use="required"/&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:element name="NodeGeography" type="vendorco:NodeGeoType" /&gt;

   &lt;/xsd:schema&gt;

   The VendorCo:NodeGeography class will contain the geographic data in
   three aggregate classes, VendorCo:latitude, VendorCo:longitude, and
   VendorCo:elevation.  To associate the information in this class with
   a particular node, the "VendorCo:node-ident" attribute is provided;
   it must contain the same value as the "ident" attribute on the
   relevant Node element.

   To make use of this DTD now, VendorCo follows the rules in
   <a href="#section-5.2">Section 5.2</a> and defines a parameter entity called "x-vendorco" within
   the Document Type Definition, and then references this entity.  In
   the alert, the VendorCo elements are included under the
   AdditionalData element, with a "type" attribute of "xml", as shown
   below.

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;

   &lt;idmef:IDMEF-Message version="1.0"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:idmef="http://iana.org/idmef"
        xmlns:vendorco="http://v.com/idmef"
        xsi:schemaLocation="http://v.com/idmef <a href="http://v.com/geo.xsd">http://v.com/geo.xsd</a>"&gt;

     &lt;idmef:Alert messageid="abc123456789"&gt;
       &lt;idmef:Analyzer analyzerid="hq-dmz-analyzer01"&gt;
         &lt;idmef:Node category="dns"&gt;
           &lt;idmef:location&gt;Headquarters DMZ Network&lt;/idmef:location&gt;
           &lt;idmef:name&gt;analyzer01.example.com&lt;/idmef:name&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Analyzer&gt;
       &lt;idmef:CreateTime ntpstamp="0xbc723b45.0xef449129"&gt;
         2000-03-09T10:01:25.93464-05:00
       &lt;/idmef:CreateTime&gt;



<span class="grey">Debar, et al.                 Experimental                    [Page 102]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-103" id="page-103" name="page-103"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


       &lt;idmef:Source ident="a1b2c3d4"&gt;
         &lt;idmef:Node ident="a1b2c3d4-001" category="dns"&gt;
           &lt;idmef:name&gt;badguy.example.net&lt;/idmef:name&gt;
           &lt;idmef:Address ident="a1b2c3d4-002" category="ipv4-net-mask"&gt;
             &lt;idmef:address&gt;192.0.2.50&lt;/idmef:address&gt;
             &lt;idmef:netmask&gt;255.255.255.255&lt;/idmef:netmask&gt;
           &lt;/idmef:Address&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Source&gt;
       &lt;idmef:Target ident="d1c2b3a4"&gt;
         &lt;idmef:Node ident="d1c2b3a4-001" category="dns"&gt;
           &lt;idmef:Address category="ipv4-addr-hex"&gt;
             &lt;idmef:address&gt;0xde796f70&lt;/idmef:address&gt;
           &lt;/idmef:Address&gt;
         &lt;/idmef:Node&gt;
       &lt;/idmef:Target&gt;
       &lt;idmef:Classification text="Teardrop"&gt;
         &lt;idmef:Reference origin="bugtraqid"&gt;
           &lt;idmef:name&gt;124&lt;/idmef:name&gt;
           &lt;idmef:url&gt;http://www.securityfocus.com/bid/124&lt;/idmef:url&gt;
         &lt;/idmef:Reference&gt;
       &lt;/idmef:Classification&gt;
       &lt;idmef:AdditionalData type="xml" meaning="node geo info"&gt;
         &lt;idmef:xml&gt;
           &lt;vendorco:NodeGeography
             xmlns:vendorco="http://vendor.com/idmef"
      xsi:schemaLocation="http://v.com/idmef <a href="http://v.com/geo.xsd">http://v.com/geo.xsd</a>"
             vendorco:node-ident="a1b2c3d4-001"&gt;
           &lt;vendorco:latitude&gt;38.89&lt;/vendorco:latitude&gt;
           &lt;vendorco:longitude&gt;-77.02&lt;/vendorco:longitude&gt;
         &lt;/vendorco:NodeGeography&gt;
         &lt;/idmef:xml&gt;
       &lt;/idmef:AdditionalData&gt;
     &lt;/idmef:Alert&gt;
   &lt;/idmef:IDMEF-Message&gt;
















<span class="grey">Debar, et al.                 Experimental                    [Page 103]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-104" id="page-104" name="page-104"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20The%20IDMEF%20Document%20Type%20Definition%20%28Normative%29"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  The IDMEF Document Type Definition (Normative)</span>

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;

   &lt;!-- ***************************************************************
    *******************************************************************
    *** Intrusion Detection Message Exchange Format (IDMEF) XML DTD ***
    ***                Version 1.0, 07 March 2006                   ***
    ***                                                             ***
    *** The use and extension of the IDMEF XML DTD are described in ***
    *** <a href="rfc4765.html">RFC 4765</a>, "The Intrusion Detection Message Exchange         ***
    *** Format",  H. Debar, D. Curry, B. Feinstein.                 ***
    *******************************************************************
    *************************************************************** --&gt;

   &lt;!-- ===============================================================
    ===================================================================
    === <a href="#section-1">SECTION 1</a>.  Attribute list declarations.
    ===================================================================
    =============================================================== --&gt;

   &lt;!--
    | Attributes of the IDMEF element.  In general, the fixed values of
    | these attributes will change each time a new version of the DTD
    | is released.
    --&gt;

   &lt;!ENTITY % attlist.idmef                "
       version             CDATA                   #FIXED    '1.0'
     "&gt;

   &lt;!--
    | Attributes of all elements.  These are the "XML" attributes that
    | every element should have.  Space handling, language, and name
    | space.
    --&gt;
   &lt;!ENTITY % attlist.global               "
       xmlns:idmef         CDATA                   #FIXED
           'http://iana.org/idmef'
       xmlns               CDATA                   #FIXED
           'http://iana.org/idmef'
       xml:space           (default | preserve)    'default'
       xml:lang            NMTOKEN                 #IMPLIED
     "&gt;







<span class="grey">Debar, et al.                 Experimental                    [Page 104]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-105" id="page-105" name="page-105"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   &lt;!-- ===============================================================
    ===================================================================
    === <a href="#section-2">SECTION 2</a>.  Attribute value declarations.  Enumerated values for
    ===            many of the element-specific attribute lists.
    ===================================================================
    =============================================================== --&gt;

   &lt;!--
    | Values for the Action.category attribute.
    --&gt;
   &lt;!ENTITY % attvals.actioncat            "
       ( block-installed | notification-sent | taken-offline | other )
     "&gt;

   &lt;!--
    | Values for the Address.category attribute.
    --&gt;
   &lt;!ENTITY % attvals.addrcat              "
       ( unknown | atm | e-mail | lotus-notes | mac | sna | vm |
         ipv4-addr | ipv4-addr-hex | ipv4-net | ipv4-net-mask |
         ipv6-addr | ipv6-addr-hex | ipv6-net | ipv6-net-mask )
     "&gt;

   &lt;!--
    | Values for the AdditionalData.type attribute.
    --&gt;
   &lt;!ENTITY % attvals.adtype               "
       ( boolean | byte | character | date-time | integer | ntpstamp |
         portlist | real | string | byte-string | xmltext )
     "&gt;

   &lt;!--
    | Values for the Impact.completion attribute.
    --&gt;
   &lt;!ENTITY % attvals.completion           "
       ( failed | succeeded )
     "&gt;
   &lt;!--
    | Values for the File.category attribute.
    --&gt;
   &lt;!ENTITY % attvals.filecat              "
       ( current | original )
     "&gt;

   &lt;!ENTITY % attvals.fileperm "( noAccess | read | write | execute |
     search | delete | executeAs | changePermissions |
     takeOwnership)" &gt;




<span class="grey">Debar, et al.                 Experimental                    [Page 105]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-106" id="page-106" name="page-106"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   &lt;!--
    | Values for the UserId.type attribute.
    --&gt;
   &lt;!ENTITY % attvals.idtype               "
       ( current-user | original-user | target-user | user-privs |
         current-group | group-privs | other-privs )
     "&gt;

   &lt;!--
    | Values for the Impact.type attribute.
    --&gt;
   &lt;!ENTITY % attvals.impacttype           "
       ( admin | dos | file | recon | user | other )
     "&gt;

   &lt;!--
    | Values for the Linkage.category attribute.
    --&gt;
   &lt;!ENTITY % attvals.linkcat              "
       ( hard-link | mount-point | reparse-point | shortcut | stream |
         symbolic-link )
     "&gt;

   &lt;!--
    | Values for the Checksum.algorithm attribute
    --&gt;
   &lt;!ENTITY % attvals.checksumalgos        "
         ( MD4 | MD5 | SHA1 | SHA2-256 | SHA2-384 | SHA2-512 | CRC-32 |
           Haval | Tiger | Gost )
     "&gt;

   &lt;!--
    | Values for the Node.category attribute.
    --&gt;
   &lt;!ENTITY % attvals.nodecat              "
       ( unknown | ads | afs | coda | dfs | dns | hosts | kerberos |
         nds | nis | nisplus | nt | wfw )
     "&gt;

   &lt;!--
    | Values for the Reference.origin attribute.
    --&gt;
   &lt;!ENTITY % attvals.origin               "
       ( unknown | vendor-specific | user-specific | bugtraqid | cve |
         osvdb )
     "&gt;

   &lt;!--



<span class="grey">Debar, et al.                 Experimental                    [Page 106]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-107" id="page-107" name="page-107"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


    | Values for the Confidence.rating attribute.
    --&gt;
   &lt;!ENTITY % attvals.rating               "
       ( low | medium | high | numeric )
     "&gt;

   &lt;!--
    | Values for the Impact.severity attribute.
    --&gt;
   &lt;!ENTITY % attvals.severity             "
       ( info | low | medium | high )
     "&gt;

   &lt;!--
    | Values for the User.category attribute.
    --&gt;
   &lt;!ENTITY % attvals.usercat              "
       ( unknown | application | os-device )
     "&gt;

   &lt;!--
    | Values for yes/no attributes such as Source.spoofed and
    | Target.decoy.
    --&gt;
   &lt;!ENTITY % attvals.yesno                "
       ( unknown | yes | no )
     "&gt;

   &lt;!-- ===============================================================
    ===================================================================
    === <a href="#section-3">SECTION 3</a>.  Top-level element declarations.  The IDMEF-Message
    ===            element and the types of messages it can include.
    ===================================================================
    =============================================================== --&gt;

   &lt;!ELEMENT IDMEF-Message                 (
       (Alert | Heartbeat)*
     )&gt;
   &lt;!ATTLIST IDMEF-Message
       %attlist.global;
       %attlist.idmef;
     &gt;

   &lt;!ELEMENT Alert                         (
       Analyzer, CreateTime, DetectTime?, AnalyzerTime?,
       Source*, Target*, Classification, Assessment?, (ToolAlert |
       OverflowAlert | CorrelationAlert)?, AdditionalData*
     )&gt;



<span class="grey">Debar, et al.                 Experimental                    [Page 107]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-108" id="page-108" name="page-108"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   &lt;!ATTLIST Alert
       messageid           CDATA                   '0'
       %attlist.global;
     &gt;

   &lt;!ELEMENT Heartbeat                     (
       Analyzer, CreateTime, HeartbeatInterval?, AnalyzerTime?,
       AdditionalData*
     )&gt;
   &lt;!ATTLIST Heartbeat
       messageid           CDATA                   '0'
       %attlist.global;
     &gt;

   &lt;!-- ===============================================================
    ===================================================================
    === <a href="#section-4">SECTION 4</a>.  Subclasses of the Alert element that provide more
    ===            data for specific types of alerts.
    ===================================================================
    =============================================================== --&gt;

   &lt;!ELEMENT CorrelationAlert              (
       name, alertident+
     )&gt;
   &lt;!ATTLIST CorrelationAlert
       %attlist.global;
     &gt;

   &lt;!ELEMENT OverflowAlert                 (
       program, size?, buffer?
     )&gt;
   &lt;!ATTLIST OverflowAlert
       %attlist.global;
     &gt;

   &lt;!ELEMENT ToolAlert                     (
       name, command?, alertident+
     )&gt;
   &lt;!ATTLIST ToolAlert
       %attlist.global;
     &gt;

   &lt;!-- ===============================================================
    ===================================================================
    === <a href="#section-5">SECTION 5</a>.  The AdditionalData element.  This element allows an
    ===             alert to include additional information that cannot
    ===             be encoded elsewhere in the data model.
    ===================================================================



<span class="grey">Debar, et al.                 Experimental                    [Page 108]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-109" id="page-109" name="page-109"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


    =============================================================== --&gt;


   &lt;!ELEMENT AdditionalData           (
     (boolean | byte        | character | date-time |
      integer | ntpstamp    | portlist  | real      |
      string  | byte-string | xmltext   )
    )&gt;

   &lt;!ATTLIST AdditionalData
       type                %attvals.adtype;        'string'
       meaning             CDATA                   #IMPLIED
       %attlist.global;
     &gt;

   &lt;!-- ===============================================================
    ===================================================================
    === <a href="#section-6">SECTION 6</a>.  Elements related to identifying entities - analyzers
    ===            (the senders of these messages), sources (of
    ===            attacks), and targets (of attacks).
    ===================================================================
    =============================================================== --&gt;

   &lt;!ELEMENT Analyzer                      (
       Node?, Process?, Analyzer?
     )&gt;
   &lt;!ATTLIST Analyzer
       analyzerid          CDATA                   '0'
       name                CDATA                   #IMPLIED
       manufacturer        CDATA                   #IMPLIED
       model               CDATA                   #IMPLIED
       version             CDATA                   #IMPLIED
       class               CDATA                   #IMPLIED
       ostype              CDATA                   #IMPLIED
       osversion           CDATA                   #IMPLIED
       %attlist.global;
     &gt;

   &lt;!ELEMENT Classification                (
       Reference*
     )&gt;
   &lt;!ATTLIST Classification
       ident               CDATA                   '0'
       text                CDATA                   #REQUIRED
     &gt;

   &lt;!ELEMENT Source                        (
       Node?, User?, Process?, Service?



<span class="grey">Debar, et al.                 Experimental                    [Page 109]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-110" id="page-110" name="page-110"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


     )&gt;
   &lt;!ATTLIST Source
       ident               CDATA                   '0'
       spoofed             %attvals.yesno;         'unknown'
       interface           CDATA                   #IMPLIED
       %attlist.global;
     &gt;

   &lt;!ELEMENT Target                        (
       Node?, User?, Process?, Service?, File*
     )&gt;
   &lt;!ATTLIST Target
       ident               CDATA                   '0'
       decoy               %attvals.yesno;         'unknown'
       interface           CDATA                   #IMPLIED
       %attlist.global;
     &gt;

   &lt;!ELEMENT Assessment                    (
       Impact?, Action*, Confidence?
     )&gt;
   &lt;!ATTLIST Assessment
       %attlist.global;
     &gt;

   &lt;!-- ===============================================================
    ===================================================================
    === <a href="#section-7">SECTION 7</a>.  Support elements used for providing detailed info
    ===            about entities - addresses, names, etc.
    ===================================================================
    =============================================================== --&gt;

   &lt;!ELEMENT Reference                (
       name, url
     )&gt;
   &lt;!ATTLIST Reference
       origin              %attvals.origin;        'unknown'
       meaning             CDATA                   #IMPLIED
     &gt;

   &lt;!ELEMENT Node                          (
       location?, (name | Address), Address*
     )&gt;
   &lt;!ATTLIST Node
       ident               CDATA                   '0'
       category            %attvals.nodecat;       'unknown'
       %attlist.global;
     &gt;



<span class="grey">Debar, et al.                 Experimental                    [Page 110]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-111" id="page-111" name="page-111"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   &lt;!ELEMENT Address                       (
       address, netmask?
     )&gt;
   &lt;!ATTLIST Address
       ident               CDATA                   '0'
       category            %attvals.addrcat;       'unknown'
       vlan-name           CDATA                   #IMPLIED
       vlan-num            CDATA                   #IMPLIED
       %attlist.global;
     &gt;

   &lt;!ELEMENT File                          (
       name, path, create-time?, modify-time?, access-time?,
       data-size?, disk-size?, FileAccess*, Linkage*, Inode?,
       Checksum*
     )&gt;
   &lt;!ATTLIST File
       ident               CDATA                   '0'
       category            %attvals.filecat;       #REQUIRED
       fstype              CDATA                   #IMPLIED
       file-type           CDATA                   #IMPLIED
       %attlist.global;
     &gt;

   &lt;!ELEMENT Permission EMPTY &gt;
   &lt;!ATTLIST Permission
       perms               %attvals.fileperm;      #REQUIRED
       %attlist.global;
   &gt;

   &lt;!ELEMENT FileAccess                    (
       UserId, Permission+
     )&gt;
   &lt;!ATTLIST FileAccess
       %attlist.global;
     &gt;

   &lt;!ELEMENT Inode                         (
       change-time?, (number, major-device, minor-device)?,
       (c-major-device, c-minor-device)?
     )&gt;
   &lt;!ATTLIST Inode
       %attlist.global;
     &gt;

   &lt;!ELEMENT Linkage                       (
       (name, path) | File
     )&gt;



<span class="grey">Debar, et al.                 Experimental                    [Page 111]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-112" id="page-112" name="page-112"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   &lt;!ATTLIST Linkage
       category            %attvals.linkcat;       #REQUIRED
       %attlist.global;
     &gt;

   &lt;!ELEMENT Checksum                      (
       value, key?
     )&gt;
   &lt;!ATTLIST Checksum
       algorithm           %attvals.checksumalgos; #REQUIRED
       %attlist.global;
     &gt;

   &lt;!ELEMENT Process                       (
       name, pid?, path?, arg*, env*
     )&gt;
   &lt;!ATTLIST Process
       ident               CDATA                   '0'
       %attlist.global;
     &gt;

   &lt;!ELEMENT Service                       (
       (((name, port?) | (port, name?)) | portlist), protocol?,
       SNMPService?, WebService?
     )&gt;
   &lt;!ATTLIST Service
       ident                CDATA                   '0'
   ip_version           CDATA                   #IMPLIED
   iana_protocol_number CDATA                  #IMPLIED
   iana_protocol_name   CDATA                  #IMPLIED
       %attlist.global;
     &gt;

   &lt;!ELEMENT SNMPService                   (
       oid?, messageProcessingModel?, securityModel?, securityName?,
       securityLevel?, contextName?, contextEngineID?, command?
     )&gt;
   &lt;!ATTLIST SNMPService
       %attlist.global;
     &gt;

   &lt;!ELEMENT User                          (
       UserId+
     )&gt;
   &lt;!ATTLIST User
       ident               CDATA                   '0'
       category            %attvals.usercat;       'unknown'
       %attlist.global;



<span class="grey">Debar, et al.                 Experimental                    [Page 112]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-113" id="page-113" name="page-113"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


     &gt;

   &lt;!ELEMENT UserId                        (
       (name, number?) | (number, name?)
     )&gt;
   &lt;!ATTLIST UserId
       ident               CDATA                   '0'
       type                %attvals.idtype;        'original-user'
       tty                 CDATA                   #IMPLIED
       %attlist.global;
     &gt;

   &lt;!ELEMENT WebService                    (
       url, cgi?, http-method?, arg*
     )&gt;
   &lt;!ATTLIST WebService
       %attlist.global;
     &gt;

   &lt;!-- ===============================================================
    ===================================================================
    === <a href="#section-8">SECTION 8</a>.  Simple elements with sub-elements or attributes of a
    ===            special nature.
    ===================================================================
    =============================================================== --&gt;

   &lt;!ELEMENT Action              (#PCDATA) &gt;
   &lt;!ATTLIST Action
       category            %attvals.actioncat;     'other'
       %attlist.global;
     &gt;

   &lt;!ELEMENT CreateTime          (#PCDATA) &gt;
   &lt;!ATTLIST CreateTime
       ntpstamp            CDATA                   #REQUIRED
       %attlist.global;
     &gt;

   &lt;!ELEMENT DetectTime          (#PCDATA) &gt;
   &lt;!ATTLIST DetectTime
       ntpstamp            CDATA                   #REQUIRED
       %attlist.global;

     &gt;

   &lt;!ELEMENT AnalyzerTime        (#PCDATA) &gt;
   &lt;!ATTLIST AnalyzerTime
       ntpstamp            CDATA                   #REQUIRED



<span class="grey">Debar, et al.                 Experimental                    [Page 113]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-114" id="page-114" name="page-114"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


       %attlist.global;
     &gt;

   &lt;!ELEMENT Confidence          (#PCDATA) &gt;
   &lt;!ATTLIST Confidence
       rating              %attvals.rating;        'numeric'
       %attlist.global;
     &gt;

   &lt;!ELEMENT Impact              (#PCDATA) &gt;
   &lt;!ATTLIST Impact
       severity            %attvals.severity;      #IMPLIED
       completion          %attvals.completion;    #IMPLIED
       type                %attvals.impacttype;    'other'
       %attlist.global;
     &gt;

   &lt;!ELEMENT alertident          (#PCDATA) &gt;
   &lt;!ATTLIST alertident
       analyzerid          CDATA                   #IMPLIED
       %attlist.global;
     &gt;

   &lt;!-- ===============================================================
    ===================================================================
    === <a href="#section-9">SECTION 9</a>.  Simple elements with no sub-elements and no special
    === attributes.
    ===================================================================
    =============================================================== --&gt;

   &lt;!ELEMENT boolean           (#PCDATA)         &gt;
   &lt;!ATTLIST boolean           %attlist.global;  &gt;

   &lt;!ELEMENT byte              (#PCDATA)         &gt;
   &lt;!ATTLIST byte              %attlist.global;  &gt;

   &lt;!ELEMENT character         (#PCDATA)         &gt;
   &lt;!ATTLIST character         %attlist.global;  &gt;

   &lt;!ELEMENT date-time         (#PCDATA)         &gt;
   &lt;!ATTLIST date-time         %attlist.global;  &gt;

   &lt;!ELEMENT integer           (#PCDATA)         &gt;
   &lt;!ATTLIST integer           %attlist.global;  &gt;

   &lt;!ELEMENT ntpstamp          (#PCDATA)         &gt;
   &lt;!ATTLIST ntpstamp          %attlist.global;  &gt;




<span class="grey">Debar, et al.                 Experimental                    [Page 114]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-115" id="page-115" name="page-115"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   &lt;!ELEMENT real              (#PCDATA)         &gt;
   &lt;!ATTLIST real              %attlist.global;  &gt;

   &lt;!ELEMENT string            (#PCDATA)         &gt;
   &lt;!ATTLIST string            %attlist.global;  &gt;

   &lt;!ELEMENT byte-string       (#PCDATA)         &gt;
   &lt;!ATTLIST byte-string       %attlist.global;  &gt;

   &lt;!ELEMENT xmltext           ANY               &gt;
   &lt;!ATTLIST xmltext           %attlist.global;  &gt;

   &lt;!ELEMENT access-time       (#PCDATA)         &gt;
   &lt;!ATTLIST access-time       %attlist.global;  &gt;

   &lt;!ELEMENT address           (#PCDATA)         &gt;
   &lt;!ATTLIST address           %attlist.global;  &gt;

   &lt;!ELEMENT arg               (#PCDATA)         &gt;
   &lt;!ATTLIST arg               %attlist.global;  &gt;

   &lt;!ELEMENT buffer            (#PCDATA)         &gt;
   &lt;!ATTLIST buffer            %attlist.global;  &gt;

   &lt;!ELEMENT c-major-device    (#PCDATA)         &gt;
   &lt;!ATTLIST c-major-device    %attlist.global;  &gt;

   &lt;!ELEMENT c-minor-device    (#PCDATA)         &gt;
   &lt;!ATTLIST c-minor-device    %attlist.global;  &gt;

   &lt;!ELEMENT cgi               (#PCDATA)         &gt;
   &lt;!ATTLIST cgi               %attlist.global;  &gt;

   &lt;!ELEMENT change-time       (#PCDATA)         &gt;
   &lt;!ATTLIST change-time       %attlist.global;  &gt;

   &lt;!ELEMENT command           (#PCDATA)         &gt;
   &lt;!ATTLIST command           %attlist.global;  &gt;

   &lt;!ELEMENT create-time       (#PCDATA)         &gt;
   &lt;!ATTLIST create-time       %attlist.global;  &gt;

   &lt;!ELEMENT data-size         (#PCDATA)         &gt;
   &lt;!ATTLIST data-size         %attlist.global;  &gt;

   &lt;!ELEMENT disk-size         (#PCDATA)         &gt;
   &lt;!ATTLIST disk-size         %attlist.global;  &gt;




<span class="grey">Debar, et al.                 Experimental                    [Page 115]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-116" id="page-116" name="page-116"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   &lt;!ELEMENT env               (#PCDATA)         &gt;
   &lt;!ATTLIST env               %attlist.global;  &gt;

   &lt;!ELEMENT http-method       (#PCDATA)         &gt;
   &lt;!ATTLIST http-method       %attlist.global;  &gt;

   &lt;!ELEMENT location          (#PCDATA)         &gt;
   &lt;!ATTLIST location          %attlist.global;  &gt;

   &lt;!ELEMENT major-device      (#PCDATA)         &gt;
   &lt;!ATTLIST major-device      %attlist.global;  &gt;

   &lt;!ELEMENT minor-device      (#PCDATA)         &gt;
   &lt;!ATTLIST minor-device      %attlist.global;  &gt;

   &lt;!ELEMENT modify-time       (#PCDATA)         &gt;
   &lt;!ATTLIST modify-time       %attlist.global;  &gt;

   &lt;!ELEMENT name              (#PCDATA)         &gt;
   &lt;!ATTLIST name              %attlist.global;  &gt;

   &lt;!ELEMENT netmask           (#PCDATA)         &gt;
   &lt;!ATTLIST netmask           %attlist.global;  &gt;

   &lt;!ELEMENT number            (#PCDATA)         &gt;
   &lt;!ATTLIST number            %attlist.global;  &gt;

   &lt;!ELEMENT oid               (#PCDATA)         &gt;
   &lt;!ATTLIST oid               %attlist.global;  &gt;

   &lt;!ELEMENT path              (#PCDATA)         &gt;
   &lt;!ATTLIST path              %attlist.global;  &gt;

   &lt;!ELEMENT permission        (#PCDATA)         &gt;
   &lt;!ATTLIST permission        %attlist.global;  &gt;

   &lt;!ELEMENT pid               (#PCDATA)         &gt;
   &lt;!ATTLIST pid               %attlist.global;  &gt;

   &lt;!ELEMENT port              (#PCDATA)         &gt;
   &lt;!ATTLIST port              %attlist.global;  &gt;

   &lt;!ELEMENT portlist          (#PCDATA)         &gt;
   &lt;!ATTLIST portlist          %attlist.global;  &gt;

   &lt;!ELEMENT program           (#PCDATA)         &gt;
   &lt;!ATTLIST program           %attlist.global;  &gt;




<span class="grey">Debar, et al.                 Experimental                    [Page 116]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-117" id="page-117" name="page-117"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   &lt;!ELEMENT protocol          (#PCDATA)         &gt;
   &lt;!ATTLIST protocol          %attlist.global;  &gt;

   &lt;!ELEMENT size              (#PCDATA)         &gt;
   &lt;!ATTLIST size              %attlist.global;  &gt;

   &lt;!ELEMENT url               (#PCDATA)         &gt;
   &lt;!ATTLIST url               %attlist.global;  &gt;

   &lt;!ELEMENT HeartbeatInterval (#PCDATA)         &gt;
   &lt;!ATTLIST HeartbeatInterval %attlist.global;  &gt;

   &lt;!ELEMENT messageProcessingModel (#PCDATA)    &gt;
   &lt;!ATTLIST messageProcessingModel %attlist.global;&gt;

   &lt;!ELEMENT securityModel     (#PCDATA)         &gt;
   &lt;!ATTLIST securityModel     %attlist.global;  &gt;

   &lt;!ELEMENT securityName      (#PCDATA)         &gt;
   &lt;!ATTLIST securityName      %attlist.global;  &gt;

   &lt;!ELEMENT securityLevel     (#PCDATA)         &gt;
   &lt;!ATTLIST securityLevel     %attlist.global;  &gt;

   &lt;!ELEMENT contextName       (#PCDATA)         &gt;
   &lt;!ATTLIST contextName       %attlist.global;  &gt;

   &lt;!ELEMENT contextEngineID   (#PCDATA)         &gt;
   &lt;!ATTLIST contextEngineID   %attlist.global;  &gt;

   &lt;!ELEMENT value             (#PCDATA)         &gt;
   &lt;!ATTLIST value             %attlist.global;  &gt;

   &lt;!ELEMENT key               (#PCDATA)         &gt;
   &lt;!ATTLIST key               %attlist.global;  &gt;

   &lt;!-- End of IDMEF DTD --&gt;

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Security%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Security Considerations</span>

   This document describes a data representation for exchanging
   security-related information between intrusion detection system
   implementations.  Although there are no security concerns directly
   applicable to the format of this data, the data itself may contain
   security-sensitive information whose confidentiality, integrity,
   and/or availability may need to be protected.





<span class="grey">Debar, et al.                 Experimental                    [Page 117]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-118" id="page-118" name="page-118"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   This suggests that the systems used to collect, transmit, process,
   and store this data should be protected against unauthorized use and
   that the data itself should be protected against unauthorized access.
   The means for achieving this protection are outside the scope of this
   document.

   Section 5 of [<a href="#ref-2" title='"Intrusion Detection Mesage Exchange Requirements"'>2</a>] describes the required and recommended security
   characteristics of the transmission protocol that will be used to
   deliver IDMEF data from analyzers to managers.  These requirements
   include message confidentiality, message integrity, non-repudiation,
   and avoidance of duplicate messages.  Both standard and proposed
   protocols exist that provide these features.

   Where a protocol that does not meet the requirements of Section 5 of
   [<a href="#ref-2" title='"Intrusion Detection Mesage Exchange Requirements"'>2</a>] is used to exchange IDMEF messages, it may be desirable to use
   digital signatures to certify the integrity of these messages; this
   is discussed in <a href="#section-6.5">Section 6.5</a> of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  IANA Considerations</span>

   <a href="#section-5">Section 5</a> describes how to use the AdditionalData class to include
   arbitrary "atomic" data items in an IDMEF message, as well as how
   AdditionalData may be used to extend the DTD itself by adding new
   classes and attributes.

   From time to time, it may be desirable to move an extension from its
   private or local use status (as all extensions made via the above
   mechanism are) to "standard" status that should be supported by all
   implementations.

   This may be accomplished as described in this section.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Adding%20Values%20to%20Existing%20Attributes"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Adding Values to Existing Attributes</span>

   Several of the attributes specified in this document have lists of
   permissible values that they may contain.  To allow the addition of
   new values to these lists, the IANA created a repository for
   attribute values called "Intrusion Detection Message Exchange Format
   (IDMEF) Attribute Values".

   Following the policies outlined in [<a href="#ref-9" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>9</a>], this repository is
   "Specification Required" by RFC.  <a href="#section-10.1.1">Section 10.1.1</a> describes the
   initial values for this repository.








<span class="grey">Debar, et al.                 Experimental                    [Page 118]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-119" id="page-119" name="page-119"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   To create a new attribute, you MUST publish an RFC to document the
   type.  In the RFC, include a copy of the registration template found
   in <a href="#section-10.1.2">Section 10.1.2</a> of this document.  Put the template in your IANA
   Considerations section, filling in the appropriate fields.  You MUST
   describe any interoperability and security issues in your document.

   When adding a new attribute value to the repository, the IANA shall
   assign the next rank number in numerical sequence for the value.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/10.1.1.%20%20Attribute%20Registrations"></a><a class="selflink" href="#section-10.1.1" name="section-10.1.1">10.1.1</a>.  Attribute Registrations</span>

   IDMEF Class Name:  Reference

   IDMEF Attribute Name:  origin

   Registered Values:

   +------+-----------------+------------------------------------------+
   | Rank | Keyword         | Description                              |
   +------+-----------------+------------------------------------------+
   |    0 | unknown         | Origin of the name is not known          |
   |    1 | vendor-specific | A vendor-specific name (and hence, URL); |
   |      |                 | this can be used to provide              |
   |      |                 | product-specific information             |
   |    2 | user-specific   | A user-specific name (and hence, URL);   |
   |      |                 | this can be used to provide              |
   |      |                 | installation-specific information        |
   |    3 | bugtraqid       | The SecurityFocus ("Bugtraq")            |
   |      |                 | vulnerability database identifier        |
   |      |                 | (<a href="http://www.securityfocus.com/bid">http://www.securityfocus.com/bid</a>)       |
   |    4 | cve             | The Common Vulnerabilities and Exposures |
   |      |                 | (CVE) name (<a href="http://cve.mitre.org/">http://cve.mitre.org/</a>)       |
   |    5 | osvdb           | The Open Source Vulnerability Database   |
   |      |                 | (<a href="http://www.osvdb.org/">http://www.osvdb.org</a>)                   |
   +------+-----------------+------------------------------------------+
















<span class="grey">Debar, et al.                 Experimental                    [Page 119]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-120" id="page-120" name="page-120"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   IDMEF Class Name:  Source

   IDMEF Attribute Name:  spoofed

   Registered Values:

        +------+---------+----------------------------------------+
        | Rank | Keyword | Description                            |
        +------+---------+----------------------------------------+
        |    0 | unknown | Accuracy of source information unknown |
        |    1 | yes     | Source is believed to be a decoy       |
        |    2 | no      | Source is believed to be "real"        |
        +------+---------+----------------------------------------+

   IDMEF Class Name:  Target

   IDMEF Attribute Name:  decoy

   Registered Values:

        +------+---------+----------------------------------------+
        | Rank | Keyword | Description                            |
        +------+---------+----------------------------------------+
        |    0 | unknown | Accuracy of target information unknown |
        |    1 | yes     | Target is believed to be a decoy       |
        |    2 | no      | Target is believed to be "real"        |
        +------+---------+----------------------------------------+
























<span class="grey">Debar, et al.                 Experimental                    [Page 120]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-121" id="page-121" name="page-121"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   IDMEF Class Name:  AdditionalData

   IDMEF Attribute Name:  type

   Registered Values:

   +------+-------------+----------------------------------------------+
   | Rank | Keyword     | Description                                  |
   +------+-------------+----------------------------------------------+
   |    0 | boolean     | The element contains a boolean value, i.e.,  |
   |      |             | the strings "true" or "false"                |
   |    1 | byte        | The element content is a single 8-bit byte   |
   |      |             | (see <a href="#section-3.2.4">Section 3.2.4</a>)                          |
   |    2 | character   | The element content is a single character    |
   |      |             | (see <a href="#section-3.2.3">Section 3.2.3</a>)                          |
   |    3 | date-time   | The element content is a date-time string    |
   |      |             | (see <a href="#section-3.2.6">Section 3.2.6</a>)                          |
   |    4 | integer     | The element content is an integer (see       |
   |      |             | <a href="#section-3.2.1">Section 3.2.1</a>)                               |
   |    5 | ntpstamp    | The element content is an NTP timestamp (see |
   |      |             | <a href="#section-3.2.7">Section 3.2.7</a>)                               |
   |    6 | portlist    | The element content is a list of ports (see  |
   |      |             | <a href="#section-3.2.8">Section 3.2.8</a>)                               |
   |    7 | real        | The element content is a real number (see    |
   |      |             | <a href="#section-3.2.2">Section 3.2.2</a>)                               |
   |    8 | string      | The element content is a string (see         |
   |      |             | <a href="#section-3.2.3">Section 3.2.3</a>)                               |
   |    9 | byte-string | The element content is a byte[] (see         |
   |      |             | <a href="#section-3.2.4">Section 3.2.4</a>)                               |
   |   10 | xmltext     | The element content is XML-tagged data (see  |
   |      |             | <a href="#section-5.2">Section 5.2</a>)                                 |
   +------+-------------+----------------------------------------------+



















<span class="grey">Debar, et al.                 Experimental                    [Page 121]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-122" id="page-122" name="page-122"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   IDMEF Class Name:  Impact

   IDMEF Attribute Name:  severity

   Registered Values:

       +------+---------+-----------------------------------------+
       | Rank | Keyword | Description                             |
       +------+---------+-----------------------------------------+
       |    0 | info    | Alert represents informational activity |
       |      |         |                                         |
       |    1 | low     | Low severity                            |
       |      |         |                                         |
       |    2 | medium  | Medium severity                         |
       |      |         |                                         |
       |    3 | high    | High severity                           |
       +------+---------+-----------------------------------------+

   IDMEF Class Name:  Impact

   IDMEF Attribute Name:  completion

   Registered Values:

           +------+-----------+--------------------------------+
           | Rank | Keyword   | Description                    |
           +------+-----------+--------------------------------+
           |    0 | failed    | The attempt was not successful |
           |    1 | succeeded | The attempt succeeded          |
           +------+-----------+--------------------------------+





















<span class="grey">Debar, et al.                 Experimental                    [Page 122]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-123" id="page-123" name="page-123"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   IDMEF Class Name:  Impact

   IDMEF Attribute Name:  type

   Registered Values:

   +------+---------+--------------------------------------------------+
   | Rank | Keyword | Description                                      |
   +------+---------+--------------------------------------------------+
   |    0 | admin   | Administrative privileges were attempted or      |
   |      |         | obtained                                         |
   |    1 | dos     | A denial of service was attempted or completed   |
   |    2 | file    | An action on a file was attempted or completed   |
   |    3 | recon   | A reconnaissance probe was attempted or          |
   |      |         | completed                                        |
   |    4 | user    | User privileges were attempted or obtained       |
   |    5 | other   | Anything not in one of the above categories      |
   +------+---------+--------------------------------------------------+

   IDMEF Class Name:  Action

   IDMEF Attribute Name:  category

   Registered Values:

   +------+-------------------+----------------------------------------+
   | Rank | Keyword           | Description                            |
   +------+-------------------+----------------------------------------+
   |    0 | block-installed   | A block of some sort was installed to  |
   |      |                   | prevent an attack from reaching its    |
   |      |                   | destination.  The block could be a     |
   |      |                   | port block, address block, etc., or    |
   |      |                   | disabling a user account.              |
   |    1 | notification-sent | A notification message of some sort    |
   |      |                   | was sent out-of-band (via pager,       |
   |      |                   | e-mail, etc.).  Does not include the   |
   |      |                   | transmission of this alert.            |
   |    2 | taken-offline     | A system, computer, or user was taken  |
   |      |                   | offline, as when the computer is shut  |
   |      |                   | down or a user is logged off.          |
   |    3 | other             | Anything not in one of the above       |
   |      |                   | categories.                            |
   +------+-------------------+----------------------------------------+








<span class="grey">Debar, et al.                 Experimental                    [Page 123]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-124" id="page-124" name="page-124"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   IDMEF Class Name:  Confidence

   IDMEF Attribute Name:  rating

   Registered Values:

   +------+---------+--------------------------------------------------+
   | Rank | Keyword | Description                                      |
   +------+---------+--------------------------------------------------+
   |    0 | low     | The analyzer has little confidence in its        |
   |      |         | validity                                         |
   |    1 | medium  | The analyzer has average confidence in its       |
   |      |         | validity                                         |
   |    2 | high    | The analyzer has high confidence in its validity |
   |    3 | numeric | The analyzer has provided a posterior            |
   |      |         | probability value indicating its confidence in   |
   |      |         | its validity                                     |
   +------+---------+--------------------------------------------------+

   IDMEF Class Name:  Node

   IDMEF Attribute Name:  category

   Registered Values:

      +------+----------+------------------------------------------+
      | Rank | Keyword  | Description                              |
      +------+----------+------------------------------------------+
      |    0 | unknown  | Domain unknown or not relevant           |
      |    1 | ads      | Windows 2000 Advanced Directory Services |
      |    2 | afs      | Andrew File System (Transarc)            |
      |    3 | coda     | Coda Distributed File System             |
      |    4 | dfs      | Distributed File System (IBM)            |
      |    5 | dns      | Domain Name System                       |
      |    6 | hosts    | Local hosts file                         |
      |    7 | kerberos | Kerberos realm                           |
      |    8 | nds      | Novell Directory Services                |
      |    9 | nis      | Network Information Services (Sun)       |
      |   10 | nisplus  | Network Information Services Plus (Sun)  |
      |   11 | nt       | Windows NT domain                        |
      |   12 | wfw      | Windows for Workgroups                   |
      +------+----------+------------------------------------------+









<span class="grey">Debar, et al.                 Experimental                    [Page 124]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-125" id="page-125" name="page-125"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   IDMEF Class Name:  Address

   IDMEF Attribute Name:  category

   Registered Values:

   +------+---------------+--------------------------------------------+
   | Rank | Keyword       | Description                                |
   +------+---------------+--------------------------------------------+
   |    0 | unknown       | Address type unknown                       |
   |    1 | atm           | Asynchronous Transfer Mode network address |
   |    2 | e-mail        | Electronic mail address (<a href="rfc822.html">RFC 822</a>)          |
   |    3 | lotus-notes   | Lotus Notes e-mail address                 |
   |    4 | mac           | Media Access Control (MAC) address         |
   |    5 | sna           | IBM Shared Network Architecture (SNA)      |
   |      |               | address                                    |
   |    6 | vm            | IBM VM ("PROFS") e-mail address            |
   |    7 | ipv4-addr     | IPv4 host address in dotted-decimal        |
   |      |               | notation (a.b.c.d)                         |
   |    8 | ipv4-addr-hex | IPv4 host address in hexadecimal notation  |
   |    9 | ipv4-net      | IPv4 network address in dotted-decimal     |
   |      |               | notation, slash, significant bits          |
   |      |               | (a.b.c.d/nn)                               |
   |   10 | ipv4-net-mask | IPv4 network address in dotted-decimal     |
   |      |               | notation, slash, network mask in           |
   |      |               | dotted-decimal notation (a.b.c.d/w.x.y.z)  |
   |   11 | ipv6-addr     | IPv6 host address                          |
   |   12 | ipv6-addr-hex | IPv6 host address in hexadecimal notation  |
   |   13 | ipv6-net      | IPv6 network address, slash, significant   |
   |      |               | bits                                       |
   |   14 | ipv6-net-mask | IPv6 network address, slash, network mask  |
   +------+---------------+--------------------------------------------+



















<span class="grey">Debar, et al.                 Experimental                    [Page 125]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-126" id="page-126" name="page-126"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   IDMEF Class Name:  User

   IDMEF Attribute Name:  category

   Registered Values:

        +------+-------------+------------------------------------+
        | Rank | Keyword     | Description                        |
        +------+-------------+------------------------------------+
        |    0 | unknown     | User type unknown                  |
        |    1 | application | An application user                |
        |    2 | os-device   | An operating system or device user |
        +------+-------------+------------------------------------+

   IDMEF Class Name:  UserId

   IDMEF Attribute Name:  category

   Registered Values:

   +------+---------------+--------------------------------------------+
   | Rank | Keyword       | Description                                |
   +------+---------------+--------------------------------------------+
   |    0 | current-user  | The current user id being used by the user |
   |      |               | or process.  On Unix systems, this would   |
   |      |               | be the "real" user id, in general.         |
   |    1 | original-user | The actual identity of the user or process |
   |      |               | being reported on.  On those systems that  |
   |      |               | (a) do some type of auditing and (b)       |
   |      |               | support extracting a user id from the      |
   |      |               | "audit id" token, that value should be     |
   |      |               | used.  On those systems that do not        |
   |      |               | support this, and where the user has       |
   |      |               | logged into the system, the "login id"     |
   |      |               | should be used.                            |
   |    2 | target-user   | The user id the user or process is         |
   |      |               | attempting to become.  This would apply,   |
   |      |               | on Unix systems for example, when the user |
   |      |               | attempts to use "su", "rlogin", "telnet",  |
   |      |               | etc.                                       |











<span class="grey">Debar, et al.                 Experimental                    [Page 126]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-127" id="page-127" name="page-127"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   |    3 | user-privs    | Another user id the user or process has    |
   |      |               | the ability to use, or a user id           |
   |      |               | associated with a file permission.  On     |
   |      |               | Unix systems, this would be the            |
   |      |               | "effective" user id in a user or process   |
   |      |               | context, and the owner permissions in a    |
   |      |               | file context.  Multiple UserId elements of |
   |      |               | this type may be used to specify a list of |
   |      |               | privileges.                                |
   |    4 | current-group | The current group id (if applicable) being |
   |      |               | used by the user or process.  On Unix      |
   |      |               | systems, this would be the "real" group    |
   |      |               | id, in general.                            |
   |    5 | group-privs   | Another group id the group or process has  |
   |      |               | the ability to use, or a group id          |
   |      |               | associated with a file permission.  On     |
   |      |               | Unix systems, this would be the            |
   |      |               | "effective" group id in a group or process |
   |      |               | context, and the group permissions in a    |
   |      |               | file context.  On BSD-derived Unix         |
   |      |               | systems, multiple UserId elements of this  |
   |      |               | type would be used to include all the      |
   |      |               | group ids on the "group list".             |
   |    6 | other-privs   | Not used in a user, group, or process      |
   |      |               | context, only used in the file context.    |
   |      |               | The file permissions assigned to users who |
   |      |               | do not match either the user or group      |
   |      |               | permissions on the file.  On Unix systems, |
   |      |               | this would be the "world" permissions.     |
   +------+---------------+--------------------------------------------+

   IDMEF Class Name:  File

   IDMEF Attribute Name:  category

   Registered Values:

   +------+----------+-------------------------------------------------+
   | Rank | Keyword  | Description                                     |
   +------+----------+-------------------------------------------------+
   |    0 | current  | The file information is from after the reported |
   |      |          | change                                          |
   |    1 | original | The file information is from before the         |
   |      |          | reported change                                 |
   +------+----------+-------------------------------------------------+






<span class="grey">Debar, et al.                 Experimental                    [Page 127]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-128" id="page-128" name="page-128"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   IDMEF Class Name:  File

   IDMEF Attribute Name:  fstype

   Registered Values:

         +------+---------+-------------------------------------+
         | Rank | Keyword | Description                         |
         +------+---------+-------------------------------------+
         |    0 | ufs     | Berkeley Unix Fast File System      |
         |    1 | efs     | Linux "efs" file system             |
         |    2 | nfs     | Network File System                 |
         |    3 | afs     | Andrew File System                  |
         |    4 | ntfs    | Windows NT File System              |
         |    5 | fat16   | 16-bit Windows FAT File System      |
         |    6 | fat32   | 32-bit Windows FAT File System      |
         |    7 | pcfs    | "PC" (MS-DOS) file system on CD-ROM |
         |    8 | joliet  | Joliet CD-ROM file system           |
         |    9 | iso9660 | ISO 9660 CD-ROM file system         |
         +------+---------+-------------------------------------+

   IDMEF Class Name:  FileAccess

   IDMEF Attribute Name:  permission

   Registered Values:

   +------+-------------------+----------------------------------------+
   | Rank | Keyword           | Description                            |
   +------+-------------------+----------------------------------------+
   |    0 | noAccess          | No access at all is allowed for this   |
   |      |                   | user                                   |
   |    1 | read              | This user has read access to the file  |
   |    2 | write             | This user has write access to the file |
   |    3 | execute           | This user has the ability to execute   |
   |      |                   | the file                               |
   |    4 | search            | This user has the ability to search    |
   |      |                   | this file (applies to "execute"        |
   |      |                   | permission on directories in Unix)     |
   |    5 | delete            | This user has the ability to delete    |
   |      |                   | this file                              |
   |    6 | executeAs         | This user has the ability to execute   |
   |      |                   | this file as another user              |
   |    7 | changePermissions | This user has the ability to change    |
   |      |                   | the access permissions on this file    |
   |    8 | takeOwnership     | This user has the ability to take      |
   |      |                   | ownership of this file                 |
   +------+-------------------+----------------------------------------+



<span class="grey">Debar, et al.                 Experimental                    [Page 128]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-129" id="page-129" name="page-129"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   IDMEF Class Name:  Linkage

   IDMEF Attribute Name:  category

   Registered Values:

   +------+---------------+--------------------------------------------+
   | Rank | Keyword       | Description                                |
   +------+---------------+--------------------------------------------+
   |    0 | hard-link     | The &lt;name&gt; element represents another name |
   |      |               | for this file.  This information may be    |
   |      |               | more easily obtainable on NTFS file        |
   |      |               | systems than others.                       |
   |    1 | mount-point   | An alias for the directory specified by    |
   |      |               | the parent's &lt;name&gt; and &lt;path&gt; elements.   |
   |    2 | reparse-point | Applies only to Windows; excludes symbolic |
   |      |               | links and mount points, which are specific |
   |      |               | types of reparse points.                   |
   |    3 | shortcut      | The file represented by a Windows          |
   |      |               | "shortcut".  A shortcut is distinguished   |
   |      |               | from a symbolic link because of the        |
   |      |               | difference in their contents, which may be |
   |      |               | of importance to the manager.              |
   |    4 | stream        | An Alternate Data Stream (ADS) in Windows; |
   |      |               | a fork on MacOS.  Separate file system     |
   |      |               | entity that is considered an extension of  |
   |      |               | the main &lt;File&gt;.                           |
   |    5 | symbolic-link | The &lt;name&gt; element represents the file to  |
   |      |               | which the link points.                     |
   +------+---------------+--------------------------------------------+





















<span class="grey">Debar, et al.                 Experimental                    [Page 129]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-130" id="page-130" name="page-130"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   IDMEF Class Name:  Checksum

   IDMEF Attribute Name:  algorithm

   Registered Values:

      +------+----------+------------------------------------------+
      | Rank | Keyword  | Description                              |
      +------+----------+------------------------------------------+
      |    0 | MD4      | The MD4 algorithm.                       |
      |    1 | MD5      | The MD5 algorithm.                       |
      |    2 | SHA1     | The SHA1 algorithm.                      |
      |    3 | SHA2-256 | The SHA2 algorithm with 256 bits length. |
      |    4 | SHA2-384 | The SHA2 algorithm with 384 bits length. |
      |    5 | SHA2-512 | The SHA2 algorithm with 512 bits length. |
      |    6 | CRC-32   | The CRC algorithm with 32 bits length.   |
      |    7 | Haval    | The Haval algorithm.                     |
      |    8 | Tiger    | The Tiger algorithm.                     |
      |    9 | Gost     | The Gost algorithm.                      |
      +------+----------+------------------------------------------+

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/10.1.2.%20%20Registration%20Template"></a><a class="selflink" href="#section-10.1.2" name="section-10.1.2">10.1.2</a>.  Registration Template</span>

   IDMEF Class Name:

      &lt;provide the name of the class that contains the attribute to
      which you want to add a new value, e.g., "Address"&gt;

   IDMEF Attribute Name:

      &lt;provide the name of the attribute to which you want to add a new
      value, e.g., "category"&gt;

   New Attribute Value to Be Defined:

      &lt;provide the name of the new attribute value that you want to add,
      e.g., "sneaker-net"&gt;

   Meaning of New Attribute Value:

      &lt;describe in detail what the attribute value means -- i.e., if an
      analyzer sends this value, what is it telling the receiver of the
      information?&gt;

   Contact Person and E-Mail Address:

      &lt;your name and e-mail address&gt;




<span class="grey">Debar, et al.                 Experimental                    [Page 130]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-131" id="page-131" name="page-131"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.2.%20%20Adding%20New%20Attributes%20and%20Classes"></a><a class="selflink" href="#section-10.2" name="section-10.2">10.2</a>.  Adding New Attributes and Classes</span>

   To the extent possible, the IDMEF classes and attributes specified in
   this document have been designed to accommodate all current and near-
   future needs.  Although it is recognized that the addition of new
   classes, as well as the addition of new attributes to existing
   classes, will be necessary in the future, these actions should not be
   taken lightly.

   Any addition of new attributes or classes should only be undertaken
   when the current classes and attributes simply cannot be used to
   represent the information in a "clean" way -- and such additions
   should only be made to represent generally-useful types of data.
   Vendor-specific information, obscure information provided by only a
   particular type of analyzer or used only by a particular type of
   manager, "pet" attributes, and the like are not good reasons to make
   class and attribute additions.

   At the time this RFC was written, the first anticipated case for
   which new classes and attributes will need to be added is to handle
   host-based intrusion detection systems.  However, such additions
   should not be made until some level of consensus has been reached
   about the set of data that will be provided by these systems.

   Following the policies outlined in [<a href="#ref-9" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>9</a>], the addition of new classes
   and attributes to the IDMEF requires "IETF Consensus".

   To add new attributes or classes, you MUST publish an RFC to document
   them, and get that RFC approved by the IESG.  Typically, the IESG
   will seek input on prospective additions from appropriate persons
   (e.g., a relevant working group if one exists).  You MUST describe
   any interoperability and security issues in your document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20References"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.1.%20%20Normative%20References"></a><a class="selflink" href="#section-11.1" name="section-11.1">11.1</a>.  Normative References</span>

   [<a id="ref-1" name="ref-1">1</a>]   Bradner, S., "Key words for use in RFCs to Indicate Requirement
         Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-2" name="ref-2">2</a>]   Wood, M. and M. Erlinger, "Intrusion Detection Mesage Exchange
         Requirements", <a href="rfc4766.html">RFC 4766</a>, March 2007.









<span class="grey">Debar, et al.                 Experimental                    [Page 131]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-132" id="page-132" name="page-132"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   [<a id="ref-3" name="ref-3">3</a>]   Sperberg-McQueen, C., Paoli, J., Maler, E., and T. Bray,
         "Extensible Markup Language (XML) 1.0 (Second Edition)", World
         Wide Web Consortium
         FirstEdition <a href="http://www.w3.org/TR/2000/REC-xml-20001006">http://www.w3.org/TR/2000/REC-xml-20001006</a>,
         October 2000.

   [<a id="ref-4" name="ref-4">4</a>]   Bray, T., Hollander, D., and A. Layman, "Namespaces in XML",
         World Wide Web Consortium
         Recommendation <a href="http://www.w3.org/TR/1999/REC-xml-names-19990114">http://www.w3.org/TR/1999/</a>
         <a href="http://www.w3.org/TR/1999/REC-xml-names-19990114">REC-xml-names-19990114</a>, January 1999.

   [<a id="ref-5" name="ref-5">5</a>]   Berners-Lee, T., Fielding, R., and L. Masinter, "Uniform
         Resource Identifier (URI): Generic Syntax", STD 66, <a href="rfc3986.html">RFC 3986</a>,
         January 2005.

   [<a id="ref-6" name="ref-6">6</a>]   International Organization for Standardization, "Data elements
         and interchange formats - Information interchange -
         Representation of dates and times", ISO Standard 8601, Second
         Edition, December 2000.

   [<a id="ref-7" name="ref-7">7</a>]   Mills, D., "Network Time Protocol (Version 3) Specification,
         Implementation", <a href="rfc1305.html">RFC 1305</a>, March 1992.

   [<a id="ref-8" name="ref-8">8</a>]   Mills, D., "Simple Network Time Protocol (SNTP) Version 4 for
         IPv4, IPv6 and OSI", <a href="rfc4330.html">RFC 4330</a>, January 2006.

   [<a id="ref-9" name="ref-9">9</a>]   Narten, T. and H. Alvestrand, "Guidelines for Writing an IANA
         Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc2434.html">RFC 2434</a>,
         October 1998.

   [<a id="ref-10" name="ref-10">10</a>]  Phillips, A. and M. Davis, "Tags for Identifying Languages",
         <a href="https://tools.ietf.org/html/bcp47">BCP 47</a>, <a href="rfc4646.html">RFC 4646</a>, September 2006.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.2.%20%20Informative%20References"></a><a class="selflink" href="#section-11.2" name="section-11.2">11.2</a>.  Informative References</span>

   [<a id="ref-11" name="ref-11">11</a>]  St. Johns, M., "Identification Protocol", <a href="rfc1413.html">RFC 1413</a>,
         February 1993.

   [<a id="ref-12" name="ref-12">12</a>]  Resnick, P., "Internet Message Format", <a href="rfc2822.html">RFC 2822</a>, April 2001.

   [<a id="ref-13" name="ref-13">13</a>]  Eastlake, D., Reagle, J., and D. Solo, "(Extensible Markup
         Language) XML-Signature Syntax and Processing", <a href="rfc3275.html">RFC 3275</a>,
         March 2002.

   [<a id="ref-14" name="ref-14">14</a>]  Rumbaugh, J., Jacobson, I., and G. Booch, "The Unified Modeling
         Language Reference Model", ISBN 020130998X, 1998.





<span class="grey">Debar, et al.                 Experimental                    [Page 132]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-133" id="page-133" name="page-133"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


   [<a id="ref-15" name="ref-15">15</a>]  Harrington, D., Presuhn, R., and B. Wijnen, "An Architecture
         for Describing Simple Network Management Protocol (SNMP)
         Management Frameworks", STD 62, <a href="rfc3411.html">RFC 3411</a>, December 2002.

   [<a id="ref-16" name="ref-16">16</a>]  Frye, R., Levi, D., Routhier, S., and B. Wijnen, "Coexistence
         between Version 1, Version 2, and Version 3 of the
         Internet-standard Network Management Framework", <a href="https://tools.ietf.org/html/bcp74">BCP 74</a>,
         <a href="rfc3584.html">RFC 3584</a>, August 2003.











































<span class="grey">Debar, et al.                 Experimental                    [Page 133]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-134" id="page-134" name="page-134"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Acknowledgements"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Acknowledgements</span>

   The following individuals contributed substantially to this document
   and should be recognized for their efforts.  This document would not
   exist without their help:

   Dominique Alessandri, IBM Corporation
   Spencer Allain, Teknowledge Corporation
   James L. Burden, California Independent Systems Operator
   Marc Dacier, IBM Corporation
   Oliver Dain, MIT Lincoln Laboratory
   Nicolas Delon, Prelude Hybrid IDS project
   David J. Donahoo, AFIWC
   Michael Erlinger, Harvey Mudd College
   Reinhard Handwerker, Internet Security Systems, Inc.
   Ming-Yuh Huang, The Boeing Company
   Glenn Mansfield, Cyber Solutions, Inc.
   Joe McAlerney, Silicon Defense
   Cynthia McLain, MIT Lincoln Laboratory
   Paul Osterwald, Intrusion.com
   Jean-Philippe Pouzol
   James Riordan, IBM Corporation
   Paul Sangree, Cisco Systems
   Stephane Schitter, IBM Corporation
   Michael J. Slifcak, Trusted Network Technologies, Inc.
   Steven R. Snapp, CyberSafe Corporation
   Stuart Staniford-Chen, Silicon Defense
   Michael Steiner, University of Saarland
   Maureen Stillman, Nokia IP Telephony
   Vimal Vaidya, AXENT
   Yoann Vandoorselaere, Prelude Hybrid IDS project
   Andy Walther, Harvey Mudd College
   Andreas Wespi, IBM Corporation
   John C. C. White, MITRE
   Eric D. Williams, Information Brokers, Inc.
   S. Felix Wu, University of California Davis















<span class="grey">Debar, et al.                 Experimental                    [Page 134]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-135" id="page-135" name="page-135"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20B.%20%20The%20IDMEF%20Schema%20Definition%20%28Non-normative%29"></a><a class="selflink" href="#appendix-B" name="appendix-B">Appendix B</a>.  The IDMEF Schema Definition (Non-normative)</span>

   &lt;?xml version="1.0"?&gt;
   &lt;xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
               xmlns:idmef="http://iana.org/idmef"
               targetNamespace="http://iana.org/idmef"
               elementFormDefault="qualified" &gt;

     &lt;xsd:annotation&gt;
       &lt;xsd:documentation&gt;
         Intrusion Detection Message Exchange Format (IDMEF) Version 1.0
       &lt;/xsd:documentation&gt;
     &lt;/xsd:annotation&gt;

     &lt;!-- <a href="#section-1">Section 1</a> --&gt;
     &lt;!-- Omitted.  This section did namespace magic and is not
          needed with XSD validation. --&gt;

     &lt;!-- <a href="#section-2">Section 2</a> --&gt;

     &lt;!--
       Values for the Action.category attribute.
     --&gt;
     &lt;xsd:simpleType name="action-category"&gt;
       &lt;xsd:restriction base="xsd:token"&gt;
         &lt;xsd:enumeration value="block-installed"   /&gt;
         &lt;xsd:enumeration value="notification-sent" /&gt;
         &lt;xsd:enumeration value="taken-offline"     /&gt;
         &lt;xsd:enumeration value="other"             /&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;!--
       Values for the Address.category attribute.
      --&gt;
     &lt;xsd:simpleType name="address-category"&gt;
       &lt;xsd:restriction base="xsd:token"&gt;
         &lt;xsd:enumeration value="unknown"       /&gt;
         &lt;xsd:enumeration value="atm"           /&gt;
         &lt;xsd:enumeration value="e-mail"        /&gt;
         &lt;xsd:enumeration value="lotus-notes"   /&gt;
         &lt;xsd:enumeration value="mac"           /&gt;
         &lt;xsd:enumeration value="sna"           /&gt;
         &lt;xsd:enumeration value="vm"            /&gt;
         &lt;xsd:enumeration value="ipv4-addr"     /&gt;
         &lt;xsd:enumeration value="ipv4-addr-hex" /&gt;
         &lt;xsd:enumeration value="ipv4-net"      /&gt;
         &lt;xsd:enumeration value="ipv4-net-mask" /&gt;



<span class="grey">Debar, et al.                 Experimental                    [Page 135]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-136" id="page-136" name="page-136"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


         &lt;xsd:enumeration value="ipv6-addr"     /&gt;
         &lt;xsd:enumeration value="ipv6-addr-hex" /&gt;
         &lt;xsd:enumeration value="ipv6-net"      /&gt;
         &lt;xsd:enumeration value="ipv6-net-mask" /&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;!--
      | Values for the Impact.severity attribute.
      --&gt;
     &lt;xsd:simpleType name="impact-severity"&gt;
       &lt;xsd:restriction base="xsd:token"&gt;
         &lt;xsd:enumeration value="info" /&gt;
         &lt;xsd:enumeration value="low" /&gt;
         &lt;xsd:enumeration value="medium" /&gt;
         &lt;xsd:enumeration value="high" /&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;!--
       Values for the Impact.completion attribute.
      --&gt;
     &lt;xsd:simpleType name="impact-completion"&gt;
       &lt;xsd:restriction base="xsd:token"&gt;
         &lt;xsd:enumeration value="failed" /&gt;
         &lt;xsd:enumeration value="succeeded" /&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;!--
      | Values for the Impact.type attribute.
      --&gt;
     &lt;xsd:simpleType name="impact-type"&gt;
       &lt;xsd:restriction base="xsd:token"&gt;
         &lt;xsd:enumeration value="admin" /&gt;
         &lt;xsd:enumeration value="dos"   /&gt;
         &lt;xsd:enumeration value="file"  /&gt;
         &lt;xsd:enumeration value="recon" /&gt;
         &lt;xsd:enumeration value="user"  /&gt;
         &lt;xsd:enumeration value="other" /&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;!--
       Values for the File.category attribute.
      --&gt;
     &lt;xsd:simpleType name="file-category"&gt;
       &lt;xsd:restriction base="xsd:token"&gt;



<span class="grey">Debar, et al.                 Experimental                    [Page 136]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-137" id="page-137" name="page-137"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


         &lt;xsd:enumeration value="current"  /&gt;
         &lt;xsd:enumeration value="original" /&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;!--
       Values for the FileAccess.Permissions attribute
     --&gt;
     &lt;xsd:simpleType name="file-permission"&gt;
       &lt;xsd:restriction base="xsd:token"&gt;
         &lt;xsd:enumeration value="noAccess"/&gt;
         &lt;xsd:enumeration value="read"/&gt;
         &lt;xsd:enumeration value="write"/&gt;
         &lt;xsd:enumeration value="execute"/&gt;
         &lt;xsd:enumeration value="search" /&gt;
         &lt;xsd:enumeration value="delete" /&gt;
         &lt;xsd:enumeration value="executeAs" /&gt;
         &lt;xsd:enumeration value="changePermissions" /&gt;
         &lt;xsd:enumeration value="takeOwnership" /&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;!--
       Values for the Id.type attribute.
      --&gt;
     &lt;xsd:simpleType name="id-type"&gt;
       &lt;xsd:restriction base="xsd:token"&gt;
         &lt;xsd:enumeration value="current-user"  /&gt;
         &lt;xsd:enumeration value="original-user" /&gt;
         &lt;xsd:enumeration value="target-user"   /&gt;
         &lt;xsd:enumeration value="user-privs"    /&gt;
         &lt;xsd:enumeration value="current-group" /&gt;
         &lt;xsd:enumeration value="group-privs"   /&gt;
         &lt;xsd:enumeration value="other-privs"   /&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;!--
      | Values for the Linkage.category attribute.
      --&gt;
     &lt;xsd:simpleType name="linkage-category"&gt;
       &lt;xsd:restriction base="xsd:token"&gt;
         &lt;xsd:enumeration value="hard-link"     /&gt;
         &lt;xsd:enumeration value="mount-point"   /&gt;
         &lt;xsd:enumeration value="reparse-point" /&gt;
         &lt;xsd:enumeration value="shortcut"      /&gt;
         &lt;xsd:enumeration value="stream"        /&gt;
         &lt;xsd:enumeration value="symbolic-link" /&gt;



<span class="grey">Debar, et al.                 Experimental                    [Page 137]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-138" id="page-138" name="page-138"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;!--
       | Values for the Checksum.algorithm attribute
     --&gt;
     &lt;xsd:simpleType name="checksum-algorithm"&gt;
       &lt;xsd:restriction base="xsd:token"&gt;
         &lt;xsd:enumeration value="MD4" /&gt;
         &lt;xsd:enumeration value="MD5" /&gt;
         &lt;xsd:enumeration value="SHA1" /&gt;
         &lt;xsd:enumeration value="SHA2-256" /&gt;
         &lt;xsd:enumeration value="SHA2-384" /&gt;
         &lt;xsd:enumeration value="SHA2-512" /&gt;
         &lt;xsd:enumeration value="CRC-32" /&gt;
         &lt;xsd:enumeration value="Haval" /&gt;
         &lt;xsd:enumeration value="Tiger" /&gt;
         &lt;xsd:enumeration value="Gost" /&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;!--
      | Values for the Node.category attribute.
      --&gt;
     &lt;xsd:simpleType name="node-category"&gt;
       &lt;xsd:restriction base="xsd:token"&gt;
         &lt;xsd:enumeration value="unknown"  /&gt;
         &lt;xsd:enumeration value="ads"      /&gt;
         &lt;xsd:enumeration value="afs"      /&gt;
         &lt;xsd:enumeration value="coda"     /&gt;
         &lt;xsd:enumeration value="dfs"      /&gt;
         &lt;xsd:enumeration value="dns"      /&gt;
         &lt;xsd:enumeration value="hosts"    /&gt;
         &lt;xsd:enumeration value="kerberos" /&gt;
         &lt;xsd:enumeration value="nds"      /&gt;
         &lt;xsd:enumeration value="nis"      /&gt;
         &lt;xsd:enumeration value="nisplus"  /&gt;
         &lt;xsd:enumeration value="nt"       /&gt;
         &lt;xsd:enumeration value="wfw"      /&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;!--
      | Values for the reference.origin attribute.
      --&gt;
     &lt;xsd:simpleType name="reference-origin"&gt;
       &lt;xsd:restriction base="xsd:token"&gt;
         &lt;xsd:enumeration value="unknown" /&gt;



<span class="grey">Debar, et al.                 Experimental                    [Page 138]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-139" id="page-139" name="page-139"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


         &lt;xsd:enumeration value="vendor-specific" /&gt;
         &lt;xsd:enumeration value="user-specific" /&gt;
         &lt;xsd:enumeration value="bugtraqid" /&gt;
         &lt;xsd:enumeration value="cve" /&gt;
         &lt;xsd:enumeration value="osvdb" /&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;!--
      | Values for the Confidence.rating attribute.
      --&gt;
     &lt;xsd:simpleType name="confidence-rating"&gt;
       &lt;xsd:restriction base="xsd:token"&gt;
         &lt;xsd:enumeration value="low"    /&gt;
         &lt;xsd:enumeration value="medium" /&gt;
         &lt;xsd:enumeration value="high"   /&gt;
         &lt;xsd:enumeration value="numeric" /&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;!--
      | Values for the User.category attribute.
      --&gt;
     &lt;xsd:simpleType name="user-category"&gt;
       &lt;xsd:restriction base="xsd:token"&gt;
         &lt;xsd:enumeration value="unknown"     /&gt;
         &lt;xsd:enumeration value="application" /&gt;
         &lt;xsd:enumeration value="os-device"   /&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;!--
     / Values for the additionaldata.type attribute.
     --&gt;
     &lt;xsd:simpleType name="additionaldata-type"&gt;
       &lt;xsd:restriction base="xsd:token"&gt;
         &lt;xsd:enumeration value="boolean"     /&gt;
         &lt;xsd:enumeration value="byte"        /&gt;
         &lt;xsd:enumeration value="character"   /&gt;
         &lt;xsd:enumeration value="date-time"   /&gt;
         &lt;xsd:enumeration value="integer"     /&gt;
         &lt;xsd:enumeration value="ntpstamp"    /&gt;
         &lt;xsd:enumeration value="portlist"    /&gt;
         &lt;xsd:enumeration value="real"        /&gt;
         &lt;xsd:enumeration value="string"      /&gt;
         &lt;xsd:enumeration value="byte-string" /&gt;
         &lt;xsd:enumeration value="xml"         /&gt;
       &lt;/xsd:restriction&gt;



<span class="grey">Debar, et al.                 Experimental                    [Page 139]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-140" id="page-140" name="page-140"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


     &lt;/xsd:simpleType&gt;


     &lt;!--
      | Values for yes/no attributes such as Source.spoofed and
      | Target.decoy.
      --&gt;
     &lt;xsd:simpleType name="yes-no-type"&gt;
       &lt;xsd:restriction base="xsd:token"&gt;
         &lt;xsd:enumeration value="unknown" /&gt;
         &lt;xsd:enumeration value="yes"     /&gt;
         &lt;xsd:enumeration value="no"      /&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;xsd:simpleType name="port-range"&gt;
       &lt;xsd:restriction base="xsd:string"&gt;
         &lt;xsd:pattern value="[0-9]{1,5}(\-[0-9]{1,5})?"/&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;xsd:simpleType name="port-list"&gt;
       &lt;xsd:list itemType="idmef:port-range" /&gt;
     &lt;/xsd:simpleType&gt;

     &lt;xsd:simpleType name="ntpstamp"&gt;
       &lt;xsd:restriction base="xsd:string"&gt;
         &lt;xsd:pattern value="0x[A-Fa-f0-9]{8}.0x[A-Fa-f0-9]{8}"/&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;xsd:simpleType name="mime-type"&gt;
       &lt;xsd:restriction base="xsd:string"&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;


     &lt;!-- <a href="#section-3">Section 3</a>: Top-level element declarations.  The IDMEF-Message
          element and the types of messages it can include. --&gt;

     &lt;xsd:complexType name="IDMEF-Message" &gt;
       &lt;xsd:choice minOccurs="1" maxOccurs="unbounded"&gt;
         &lt;xsd:element ref="idmef:Alert"     /&gt;
         &lt;xsd:element ref="idmef:Heartbeat" /&gt;
       &lt;/xsd:choice&gt;
       &lt;xsd:attribute name="version" type="xsd:decimal"
                      fixed="1.0" /&gt;
     &lt;/xsd:complexType&gt;



<span class="grey">Debar, et al.                 Experimental                    [Page 140]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-141" id="page-141" name="page-141"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


     &lt;xsd:element name="IDMEF-Message" type="idmef:IDMEF-Message" /&gt;

     &lt;xsd:complexType name="Alert"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="Analyzer"
                      type="idmef:Analyzer" /&gt;
         &lt;xsd:element name="CreateTime"
                      type="idmef:TimeWithNtpstamp" /&gt;
         &lt;xsd:element name="DetectTime"
                      type="idmef:TimeWithNtpstamp"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="AnalyzerTime"
                      type="idmef:TimeWithNtpstamp"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="Source"
                      type="idmef:Source"
                      minOccurs="0"
                      maxOccurs="unbounded" /&gt;
         &lt;xsd:element name="Target"
                      type="idmef:Target"
                      minOccurs="0"
                      maxOccurs="unbounded" /&gt;
         &lt;xsd:element name="Classification"
                      type="idmef:Classification" /&gt;
         &lt;xsd:element name="Assessment"
                      type="idmef:Assessment"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:choice minOccurs="0" maxOccurs="1"&gt;
           &lt;xsd:element name="ToolAlert"
                        type="idmef:ToolAlert" /&gt;
           &lt;xsd:element name="OverflowAlert"
                        type="idmef:OverflowAlert" /&gt;
           &lt;xsd:element name="CorrelationAlert"
                        type="idmef:CorrelationAlert" /&gt;
         &lt;/xsd:choice&gt;
         &lt;xsd:element name="AdditionalData"
                      type="idmef:AdditionalData"
                      minOccurs="0"
                      maxOccurs="unbounded" /&gt;
       &lt;/xsd:sequence&gt;
       &lt;xsd:attribute name="messageid"
                      type="xsd:string"
                      default="0" /&gt;
     &lt;/xsd:complexType&gt;




<span class="grey">Debar, et al.                 Experimental                    [Page 141]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-142" id="page-142" name="page-142"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


     &lt;xsd:element name="Alert" type="idmef:Alert" /&gt;

     &lt;xsd:complexType name="Heartbeat"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="Analyzer" type="idmef:Analyzer" /&gt;
         &lt;xsd:element name="CreateTime"
                      type="idmef:TimeWithNtpstamp" /&gt;
         &lt;xsd:element name="HeartbeatInterval"
                      type="xsd:integer"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="AnalyzerTime"
                      type="idmef:TimeWithNtpstamp"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="AdditionalData"
                      type="idmef:AdditionalData"
                      minOccurs="0"
                      maxOccurs="unbounded" /&gt;
       &lt;/xsd:sequence&gt;
       &lt;xsd:attribute name="messageid"
                      type="xsd:string"
                      default="0" /&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:element name="Heartbeat"
                  type="idmef:Heartbeat" /&gt;

     &lt;!-- <a href="#section-4">Section 4</a>: Subclasses of the Alert class that provide
          more data for specific types of alerts. --&gt;

     &lt;xsd:complexType name="CorrelationAlert"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="name"
                      type="xsd:string" /&gt;
         &lt;xsd:element name="alertident"
                      type="idmef:Alertident"
                      minOccurs="1"
                      maxOccurs="unbounded" /&gt;
       &lt;/xsd:sequence&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="OverflowAlert"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="program"
                      type="xsd:string" /&gt;
         &lt;xsd:element name="size"
                      type="xsd:string" /&gt;



<span class="grey">Debar, et al.                 Experimental                    [Page 142]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-143" id="page-143" name="page-143"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


         &lt;xsd:element name="buffer"
                      type="xsd:hexBinary" /&gt;
       &lt;/xsd:sequence&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="ToolAlert"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="name"
                      type="xsd:string" /&gt;
         &lt;xsd:element name="command"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="alertident"
                      type="idmef:Alertident"
                      minOccurs="1"
                      maxOccurs="unbounded" /&gt;
       &lt;/xsd:sequence&gt;
     &lt;/xsd:complexType&gt;

     &lt;!-- <a href="#section-5">Section 5</a>: The AdditionalData element.  This element allows an
          alert to include additional information that cannot be encoded
          elsewhere in the data model. --&gt;

     &lt;xsd:complexType name="AdditionalData"&gt;
       &lt;xsd:choice&gt;
         &lt;xsd:element name="boolean"
                      type="xsd:boolean" /&gt;
         &lt;xsd:element name="byte"
                      type="xsd:byte" /&gt;
         &lt;xsd:element name="character"&gt;
           &lt;xsd:simpleType&gt;
             &lt;xsd:restriction base="xsd:string"&gt;
               &lt;xsd:minLength value="1"/&gt;
               &lt;xsd:maxLength value="1"/&gt;
             &lt;/xsd:restriction&gt;
           &lt;/xsd:simpleType&gt;
         &lt;/xsd:element&gt;
         &lt;xsd:element name="date-time"
                      type="xsd:dateTime" /&gt;
         &lt;xsd:element name="integer"
                      type="xsd:integer" /&gt;
         &lt;xsd:element name="ntpstamp"
                      type="idmef:ntpstamp" /&gt;
         &lt;xsd:element name="portlist"
                      type="idmef:port-list" /&gt;
         &lt;xsd:element name="real"
                      type="xsd:decimal" /&gt;



<span class="grey">Debar, et al.                 Experimental                    [Page 143]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-144" id="page-144" name="page-144"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


         &lt;xsd:element name="string"
                      type="xsd:string" /&gt;
         &lt;xsd:element name="byte-string"
                      type="xsd:hexBinary" /&gt;
         &lt;xsd:element name="xml"
                      type="idmef:xmltext" /&gt;
       &lt;/xsd:choice&gt;
       &lt;xsd:attribute name="type"
                      type="idmef:additionaldata-type" /&gt;
       &lt;xsd:attribute name="meaning"
                      type="xsd:string" /&gt;
     &lt;/xsd:complexType&gt;

     &lt;!-- <a href="#section-6">Section 6</a>: Elements related to identifying entities -
          analyzers (the senders of these messages), sources (of
          attacks), and targets (of attacks). --&gt;

     &lt;xsd:complexType name="Analyzer"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="Node"
                      type="idmef:Node"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="Process"
                      type="idmef:Process"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="Analyzer"
                      type="idmef:Analyzer"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
       &lt;/xsd:sequence&gt;
       &lt;xsd:attribute name="analyzerid"
                      type="xsd:string"
                      default="0" /&gt;
       &lt;xsd:attribute name="name"
                      type="xsd:string" /&gt;
       &lt;xsd:attribute name="manufacturer"
                      type="xsd:string" /&gt;
       &lt;xsd:attribute name="model"
                      type="xsd:string" /&gt;
       &lt;xsd:attribute name="version"
                      type="xsd:string" /&gt;
       &lt;xsd:attribute name="class"
                      type="xsd:string" /&gt;
       &lt;xsd:attribute name="ostype"
                      type="xsd:string" /&gt;
       &lt;xsd:attribute name="osversion"



<span class="grey">Debar, et al.                 Experimental                    [Page 144]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-145" id="page-145" name="page-145"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


                      type="xsd:string" /&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="Source"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="Node"
                      type="idmef:Node"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="User"
                      type="idmef:User"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="Process"
                      type="idmef:Process"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="Service"
                      type="idmef:Service"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
       &lt;/xsd:sequence&gt;
       &lt;xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" /&gt;
       &lt;xsd:attribute name="spoofed"
                      type="idmef:yes-no-type"
                      default="unknown" /&gt;
       &lt;xsd:attribute name="interface"
                      type="xsd:string" /&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="Target"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="Node"
                      type="idmef:Node"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="User"
                      type="idmef:User"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="Process"
                      type="idmef:Process"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="Service"
                      type="idmef:Service"



<span class="grey">Debar, et al.                 Experimental                    [Page 145]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-146" id="page-146" name="page-146"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="File"
                      type="idmef:File"
                      minOccurs="0"
                      maxOccurs="unbounded" /&gt;
       &lt;/xsd:sequence&gt;
       &lt;xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" /&gt;
       &lt;xsd:attribute name="decoy"
                      type="idmef:yes-no-type"
                      default="unknown" /&gt;
       &lt;xsd:attribute name="interface"
                      type="xsd:string" /&gt;
     &lt;/xsd:complexType&gt;

     &lt;!-- <a href="#section-7">Section 7</a>: Support elements used for providing detailed info
          about entities - addresses, names, etc. --&gt;

     &lt;xsd:complexType name="Address"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="address"
                      type="xsd:string" /&gt;
         &lt;xsd:element name="netmask"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
       &lt;/xsd:sequence&gt;
       &lt;xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" /&gt;
       &lt;xsd:attribute name="category"
                      type="idmef:address-category"
                      default="unknown" /&gt;
       &lt;xsd:attribute name="vlan-name"
                      type="xsd:string" /&gt;
       &lt;xsd:attribute name="vlan-num"
                      type="xsd:string" /&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="Assessment"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="Impact"
                      type="idmef:Impact"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="Action"



<span class="grey">Debar, et al.                 Experimental                    [Page 146]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-147" id="page-147" name="page-147"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


                      type="idmef:Action"
                      minOccurs="0"
                      maxOccurs="unbounded" /&gt;
         &lt;xsd:element name="Confidence"
                      type="idmef:Confidence"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
       &lt;/xsd:sequence&gt;
     &lt;/xsd:complexType&gt;
     &lt;xsd:complexType name="Reference"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="name"
                      type="xsd:string" /&gt;
         &lt;xsd:element name="url"
                      type="xsd:string" /&gt;
       &lt;/xsd:sequence&gt;
       &lt;xsd:attribute name="origin"
                      type="idmef:reference-origin"
                      default="unknown" /&gt;
       &lt;xsd:attribute name="meaning"
                      type="xsd:string" /&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="Classification"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="Reference"
                      type="idmef:Reference"
                      minOccurs="0"
                      maxOccurs="unbounded" /&gt;
       &lt;/xsd:sequence&gt;
       &lt;xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" /&gt;
       &lt;xsd:attribute name="text"
                      type="xsd:string"
                      use="required" /&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="File"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="name"
                      type="xsd:string" /&gt;
         &lt;xsd:element name="path"
                      type="xsd:string" /&gt;
         &lt;xsd:element name="create-time"
                      type="xsd:dateTime"
                      minOccurs="0"
                      maxOccurs="1" /&gt;



<span class="grey">Debar, et al.                 Experimental                    [Page 147]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-148" id="page-148" name="page-148"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


         &lt;xsd:element name="modify-time"
                      type="xsd:dateTime"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="access-time"
                      type="xsd:dateTime"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="data-size"
                      type="xsd:integer"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="disk-size"
                      type="xsd:integer"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="FileAccess"
                      type="idmef:FileAccess"
                      minOccurs="0"
                      maxOccurs="unbounded" /&gt;
         &lt;xsd:element name="Linkage"
                      type="idmef:Linkage"
                      minOccurs="0"
                      maxOccurs="unbounded" /&gt;
         &lt;xsd:element name="Inode"
                      type="idmef:Inode"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="Checksum"
                      type="idmef:Checksum"
                      minOccurs="0"
                      maxOccurs="unbounded" /&gt;
       &lt;/xsd:sequence&gt;
       &lt;xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" /&gt;
       &lt;xsd:attribute name="category"
                      type="idmef:file-category"
                      use="required" /&gt;
       &lt;xsd:attribute name="fstype"
                      type="xsd:string"
                      use="required" /&gt;
       &lt;xsd:attribute name="file-type"
                      type="idmef:mime-type" /&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="Permission"&gt;
       &lt;xsd:attribute name="perms"



<span class="grey">Debar, et al.                 Experimental                    [Page 148]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-149" id="page-149" name="page-149"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


                      type="idmef:file-permission"
                      use="required" /&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="FileAccess"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="UserId"
                      type="idmef:UserId" /&gt;
         &lt;xsd:element name="permission"
                      type="idmef:Permission"
                      minOccurs="1"
                      maxOccurs="unbounded" /&gt;
       &lt;/xsd:sequence&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="Inode"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="change-time"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:sequence minOccurs="0" maxOccurs="1"&gt;
           &lt;xsd:element name="number"
                        type="xsd:string" /&gt;
           &lt;xsd:element name="major-device"
                        type="xsd:string" /&gt;
           &lt;xsd:element name="minor-device"
                        type="xsd:string" /&gt;
         &lt;/xsd:sequence&gt;
         &lt;xsd:sequence minOccurs="0" maxOccurs="1"&gt;
           &lt;xsd:element name="c-major-device"
                        type="xsd:string" /&gt;
           &lt;xsd:element name="c-minor-device"
                        type="xsd:string" /&gt;
         &lt;/xsd:sequence&gt;
       &lt;/xsd:sequence&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="Linkage"&gt;
       &lt;xsd:choice&gt;
         &lt;xsd:sequence&gt;
           &lt;xsd:element name="name" type="xsd:string" /&gt;
           &lt;xsd:element name="path" type="xsd:string" /&gt;
         &lt;/xsd:sequence&gt;
         &lt;xsd:element name="File" type="idmef:File" /&gt;
       &lt;/xsd:choice&gt;
       &lt;xsd:attribute name="category"
                      type="idmef:linkage-category"



<span class="grey">Debar, et al.                 Experimental                    [Page 149]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-150" id="page-150" name="page-150"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


                      use="required" /&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="Checksum"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="value"
                      type="xsd:string" /&gt;
         &lt;xsd:element name="key"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
       &lt;/xsd:sequence&gt;
       &lt;xsd:attribute name="algorithm"
                      type="idmef:checksum-algorithm"
                      use="required" /&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="Node"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="location"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:choice&gt;
           &lt;xsd:element name="name"
                        type="xsd:string" /&gt;
           &lt;xsd:element name="Address"
                        type="idmef:Address" /&gt;
         &lt;/xsd:choice&gt;
         &lt;xsd:element name="Address"
                      type="idmef:Address"
                      minOccurs="0"
                      maxOccurs="unbounded" /&gt;
       &lt;/xsd:sequence&gt;
       &lt;xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" /&gt;
       &lt;xsd:attribute name="category"
                      type="idmef:node-category"
                      default="unknown" /&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="Process"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="name"
                      type="xsd:string" /&gt;
         &lt;xsd:element name="pid"
                      type="xsd:integer"



<span class="grey">Debar, et al.                 Experimental                    [Page 150]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-151" id="page-151" name="page-151"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="path"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="arg"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="unbounded" /&gt;
         &lt;xsd:element name="env"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="unbounded" /&gt;
       &lt;/xsd:sequence&gt;
       &lt;xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" /&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="Service"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:choice&gt;
           &lt;xsd:sequence&gt;
             &lt;xsd:element name="name"
                          type="xsd:string" /&gt;
             &lt;xsd:element name="port"
                          type="xsd:integer"
                          minOccurs="0"
                          maxOccurs="1" /&gt;
           &lt;/xsd:sequence&gt;
           &lt;xsd:sequence&gt;
             &lt;xsd:element name="port"
                          type="xsd:integer" /&gt;
             &lt;xsd:element name="name"
                          type="xsd:string"
                          minOccurs="0"
                          maxOccurs="1" /&gt;
           &lt;/xsd:sequence&gt;
           &lt;xsd:element name="portlist"
                        type="idmef:port-list" /&gt;
         &lt;/xsd:choice&gt;
         &lt;xsd:element name="protocol"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="SNMPService"
                      type="idmef:SNMPService"



<span class="grey">Debar, et al.                 Experimental                    [Page 151]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-152" id="page-152" name="page-152"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="WebService"
                      type="idmef:WebService"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
       &lt;/xsd:sequence&gt;
       &lt;xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" /&gt;
       &lt;xsd:attribute name="ip_version"
                      type="xsd:integer" /&gt;
       &lt;xsd:attribute name="iana_protocol_number"
                      type="xsd:integer" /&gt;
       &lt;xsd:attribute name="iana_protocol_name"
                      type="xsd:string" /&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="WebService"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="url"
                      type="xsd:anyURI" /&gt;
         &lt;xsd:element name="cgi"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="http-method"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="arg"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="unbounded" /&gt;
       &lt;/xsd:sequence&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="SNMPService"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="oid"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="messageProcessingModel"
                      type="xsd:integer"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="securityModel"



<span class="grey">Debar, et al.                 Experimental                    [Page 152]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-153" id="page-153" name="page-153"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


                      type="xsd:integer"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="securityName"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="securityLevel"
                      type="xsd:integer"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="contextName"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="contextEngineID"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
         &lt;xsd:element name="command"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" /&gt;
       &lt;/xsd:sequence&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="User"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="UserId"
                      type="idmef:UserId"
                      minOccurs="1"
                      maxOccurs="unbounded" /&gt;
       &lt;/xsd:sequence&gt;
       &lt;xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" /&gt;
       &lt;xsd:attribute name="category"
                      type="idmef:user-category"
                      default="unknown" /&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="UserId" &gt;
       &lt;xsd:choice&gt;
         &lt;xsd:sequence&gt;
           &lt;xsd:element name="name"
                        type="xsd:string" /&gt;
           &lt;xsd:element name="number"
                        type="xsd:integer"



<span class="grey">Debar, et al.                 Experimental                    [Page 153]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-154" id="page-154" name="page-154"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


                        minOccurs="0"
                        maxOccurs="1" /&gt;
         &lt;/xsd:sequence&gt;
         &lt;xsd:sequence&gt;
           &lt;xsd:element name="number"
                        type="xsd:integer" /&gt;
           &lt;xsd:element name="name"
                        type="xsd:string"
                        minOccurs="0"
                        maxOccurs="1" /&gt;
         &lt;/xsd:sequence&gt;
       &lt;/xsd:choice&gt;
       &lt;xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" /&gt;
       &lt;xsd:attribute name="type"
                      type="idmef:id-type"
                      default="original-user" /&gt;
       &lt;xsd:attribute name="tty"
                      type="xsd:string" /&gt;
     &lt;/xsd:complexType&gt;

     &lt;!-- <a href="#section-8">Section 8</a>: Simple elements with sub-elements or attributes
          of a special nature. --&gt;

     &lt;xsd:complexType name="Action"&gt;
       &lt;xsd:simpleContent&gt;
         &lt;xsd:extension base="xsd:string" &gt;
           &lt;xsd:attribute name="category"
                          type="idmef:action-category"
                          default="other" /&gt;
         &lt;/xsd:extension&gt;
       &lt;/xsd:simpleContent&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="Confidence"&gt;
       &lt;xsd:simpleContent&gt;
         &lt;xsd:extension base="xsd:string" &gt;
           &lt;xsd:attribute name="rating"
                          type="idmef:confidence-rating"
                          use="required" /&gt;
         &lt;/xsd:extension&gt;
       &lt;/xsd:simpleContent&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="TimeWithNtpstamp"&gt;
       &lt;xsd:simpleContent&gt;
         &lt;xsd:extension base="xsd:dateTime"&gt;



<span class="grey">Debar, et al.                 Experimental                    [Page 154]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-155" id="page-155" name="page-155"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


           &lt;xsd:attribute name="ntpstamp"
                          type="idmef:ntpstamp"
                          use="required"/&gt;
         &lt;/xsd:extension&gt;
       &lt;/xsd:simpleContent&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="Impact"&gt;
       &lt;xsd:simpleContent&gt;
         &lt;xsd:extension base="xsd:string" &gt;
           &lt;xsd:attribute name="severity"
                          type="idmef:impact-severity" /&gt;
           &lt;xsd:attribute name="completion"
                          type="idmef:impact-completion" /&gt;
           &lt;xsd:attribute name="type" type="idmef:impact-type"
                          default="other" /&gt;
         &lt;/xsd:extension&gt;
       &lt;/xsd:simpleContent&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="Alertident"&gt;
       &lt;xsd:simpleContent&gt;
         &lt;xsd:extension base="xsd:string" &gt;
           &lt;xsd:attribute name="analyzerid"
                          type="xsd:string" /&gt;
         &lt;/xsd:extension&gt;
       &lt;/xsd:simpleContent&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="xmltext"&gt;
       &lt;xsd:complexContent mixed="true"&gt;
         &lt;xsd:restriction base="xsd:anyType"&gt;
           &lt;xsd:sequence&gt;
             &lt;xsd:any namespace="##other"
                      processContents="lax"
                      minOccurs="0"
                      maxOccurs="unbounded" /&gt;
           &lt;/xsd:sequence&gt;
         &lt;/xsd:restriction&gt;
       &lt;/xsd:complexContent&gt;
     &lt;/xsd:complexType&gt;

   &lt;/xsd:schema&gt;








<span class="grey">Debar, et al.                 Experimental                    [Page 155]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-156" id="page-156" name="page-156"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


Authors' Addresses

   Herve Debar
   France Telecom R &amp; D
   42 Rue des Coutures
   Caen  14000
   FR

   Phone: +33 2 31 75 92 61
   EMail: herve.debar@orange-ftgroup.com
   URI:   <a href="http://www.francetelecom.fr/">http://www.francetelecom.fr/</a>


   David A. Curry
   Guardian Life Insurance Company of America
   7 Hanover Square, 24th Floor
   New York, NY  10004
   US

   Phone: +1 212 919-3086
   EMail: david_a_curry@glic.com
   URI:   <a href="http://www.glic.com/">http://www.glic.com/</a>


   Benjamin S. Feinstein
   SecureWorks, Inc.
   PO Box 95007
   Atlanta, GA 30347
   US

   Phone: +1 404 327-6339
   Email: bfeinstein@acm.org
   URI:   <a href="http://www.secureworks.com/">http://www.secureworks.com/</a>


















<span class="grey">Debar, et al.                 Experimental                    [Page 156]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-157" id="page-157" name="page-157"> </a>
<span class="grey"><a href="rfc4765.html">RFC 4765</a>                       The IDMEF                      March 2007</span>


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.







Debar, et al.                 Experimental                    [Page 157]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc4765 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:39 GMT --></html>