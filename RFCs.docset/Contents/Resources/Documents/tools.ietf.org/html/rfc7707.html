<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7707 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:19 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="rfc5157" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:7707" name="DC.Identifier"/>
<meta content="March, 2016" name="DC.Date.Issued"/>
<meta content="Chown, Tim" name="DC.Creator"/>
<meta content="Gont, Fernando" name="DC.Creator"/>
<meta content="IPv6 offers a much larger address space than that of its IPv4
counterpart. An IPv6 subnet of size /64 can (in theory) accommodate
approximately 1.844 ~ agenda-18-01-31.txt ansible areca.cli64 attic
bah.txt bandname bin charter-migration.log data default.tag Desktop
doc draft-ietf-netmod-yang-json-04.txt draft-mm-wg-effect-
encrypt-04.txt draft-palet-v6ops-rfc7084-bis-transition-00.xml
exim.tgz foo(bar ftp-www-rsync-fix.txt get-pip.py help hours-
year-2013-12-09.txt hours-year-2013-12-09.v2.txt id2bib.sh idauthors
idsigcheck ISOC-Dark-RGB_Logo-470x173.jpg log mail Mail Maildir
RPCdata-author-email.txt schaad.log src tmp tools.ietf.org.zip tt
unix.tag valborg.cvs valborg.db valborg.sql xbin 10^19 hosts, thus
resulting in a much lower host density (#hosts/#addresses) than is
typical in IPv4 networks, where a site typically has 65,000 or fewer
unique addresses. As a result, it is widely assumed that it would take
a tremendous effort to perform address-scanning attacks against IPv6
networks; therefore, IPv6 address-scanning attacks have been
considered unfeasible. This document formally obsoletes RFC 5157,
which first discussed this assumption, by providing further analysis
on how traditional address-scanning techniques apply to IPv6 networks
and exploring some additional techniques that can be employed for IPv6
network reconnaissance." name="DC.Description.Abstract"/>
<meta content="Network Reconnaissance in IPv6 Networks" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7707 - Network Reconnaissance in IPv6 Networks</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7707.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7707" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-opsec-ipv6-host-scanning" title="draft-ietf-opsec-ipv6-host-scanning">draft-ietf-opse...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7707" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7707" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7707" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=7707">Errata</a>]</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Internet Engineering Task Force (IETF)                           F. Gont
Request for Comments: 7707                           Huawei Technologies
Obsoletes: <a href="rfc5157.html">5157</a>                                                 T. Chown
Category: Informational                                             Jisc
ISSN: 2070-1721                                               March 2016


                <span class="h1">Network Reconnaissance in IPv6 Networks</span>

Abstract

   IPv6 offers a much larger address space than that of its IPv4
   counterpart.  An IPv6 subnet of size /64 can (in theory) accommodate
   approximately 1.844 * 10^19 hosts, thus resulting in a much lower
   host density (#hosts/#addresses) than is typical in IPv4 networks,
   where a site typically has 65,000 or fewer unique addresses.  As a
   result, it is widely assumed that it would take a tremendous effort
   to perform address-scanning attacks against IPv6 networks; therefore,
   IPv6 address-scanning attacks have been considered unfeasible.  This
   document formally obsoletes <a href="rfc5157.html">RFC 5157</a>, which first discussed this
   assumption, by providing further analysis on how traditional address-
   scanning techniques apply to IPv6 networks and exploring some
   additional techniques that can be employed for IPv6 network
   reconnaissance.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7707">http://www.rfc-editor.org/info/rfc7707</a>.











<span class="grey">Gont &amp; Chown                  Informational                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Conventions . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   3.  Requirements for the Applicability of Network Reconnaissance
       Techniques  . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-4">4</a>.  IPv6 Address Scanning . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-4.1">4.1</a>.  Address Configuration in IPv6 . . . . . . . . . . . . . .   <a href="#page-6">6</a>
       <a href="#section-4.1.1">4.1.1</a>.  Stateless Address Autoconfiguration (SLAAC) . . . . .   <a href="#page-6">6</a>
       4.1.2.  Dynamic Host Configuration Protocol for IPv6 (DHCPv6)  11
       <a href="#section-4.1.3">4.1.3</a>.  Manually Configured Addresses . . . . . . . . . . . .  <a href="#page-12">12</a>
       4.1.4.  IPv6 Addresses Corresponding to
               Transition/Coexistence Technologies . . . . . . . . .  <a href="#page-14">14</a>
       4.1.5.  IPv6 Address Assignment in Real-World Network
               Scenarios . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
     <a href="#section-4.2">4.2</a>.  IPv6 Address Scanning of Remote Networks  . . . . . . . .  <a href="#page-17">17</a>
       <a href="#section-4.2.1">4.2.1</a>.  Reducing the Subnet ID Search Space . . . . . . . . .  <a href="#page-18">18</a>
     <a href="#section-4.3">4.3</a>.  IPv6 Address Scanning of Local Networks . . . . . . . . .  <a href="#page-19">19</a>
     <a href="#section-4.4">4.4</a>.  Existing IPv6 Address-Scanning Tools  . . . . . . . . . .  <a href="#page-20">20</a>
       <a href="#section-4.4.1">4.4.1</a>.  Remote IPv6 Network Address Scanners  . . . . . . . .  <a href="#page-20">20</a>
       <a href="#section-4.4.2">4.4.2</a>.  Local IPv6 Network Address Scanners . . . . . . . . .  <a href="#page-21">21</a>
     <a href="#section-4.5">4.5</a>.  Mitigations . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-21">21</a>
     <a href="#section-4.6">4.6</a>.  Conclusions . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-22">22</a>
   <a href="#section-5">5</a>.  Alternative Methods to Glean IPv6 Addresses . . . . . . . . .  <a href="#page-23">23</a>
     5.1.  Leveraging the Domain Name System (DNS) for Network
           Reconnaissance  . . . . . . . . . . . . . . . . . . . . .  <a href="#page-23">23</a>
       <a href="#section-5.1.1">5.1.1</a>.  DNS Advertised Hosts  . . . . . . . . . . . . . . . .  <a href="#page-23">23</a>
       <a href="#section-5.1.2">5.1.2</a>.  DNS Zone Transfers  . . . . . . . . . . . . . . . . .  <a href="#page-23">23</a>
       <a href="#section-5.1.3">5.1.3</a>.  DNS Brute Forcing . . . . . . . . . . . . . . . . . .  <a href="#page-23">23</a>
       <a href="#section-5.1.4">5.1.4</a>.  DNS Reverse Mappings  . . . . . . . . . . . . . . . .  <a href="#page-24">24</a>
     5.2.  Leveraging Local Name Resolution and Service Discovery
           Services  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-24">24</a>
     <a href="#section-5.3">5.3</a>.  Public Archives . . . . . . . . . . . . . . . . . . . . .  <a href="#page-25">25</a>



<span class="grey">Gont &amp; Chown                  Informational                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


     <a href="#section-5.4">5.4</a>.  Application Participation . . . . . . . . . . . . . . . .  <a href="#page-25">25</a>
     5.5.  Inspection of the IPv6 Neighbor Cache and Routing Table .  25
     <a href="#section-5.6">5.6</a>.  Inspection of System Configuration and Log Files  . . . .  <a href="#page-26">26</a>
     <a href="#section-5.7">5.7</a>.  Gleaning Information from Routing Protocols . . . . . . .  <a href="#page-26">26</a>
     5.8.  Gleaning Information from IP Flow Information Export
           (IPFIX) . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-26">26</a>
     <a href="#section-5.9">5.9</a>.  Obtaining Network Information with traceroute6  . . . . .  <a href="#page-26">26</a>
     <a href="#section-5.10">5.10</a>. Gleaning Information from Network Devices Using SNMP  . .  <a href="#page-27">27</a>
     <a href="#section-5.11">5.11</a>. Obtaining Network Information via Traffic Snooping  . . .  <a href="#page-27">27</a>
   <a href="#section-6">6</a>.  Conclusions . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-27">27</a>
   <a href="#section-7">7</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-27">27</a>
   <a href="#section-8">8</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-28">28</a>
     <a href="#section-8.1">8.1</a>.  Normative References  . . . . . . . . . . . . . . . . . .  <a href="#page-28">28</a>
     <a href="#section-8.2">8.2</a>.  Informative References  . . . . . . . . . . . . . . . . .  <a href="#page-29">29</a>
   <a href="#appendix-A">Appendix A</a>.  Implementation of a Full-Fledged IPv6 Address-
                Scanning Tool  . . . . . . . . . . . . . . . . . . .  <a href="#page-34">34</a>
     <a href="#appendix-A.1">A.1</a>.  Host-Probing Considerations . . . . . . . . . . . . . . .  <a href="#page-34">34</a>
     <a href="#appendix-A.2">A.2</a>.  Implementation of an IPv6 Local Address-Scanning Tool . .  <a href="#page-35">35</a>
     A.3.  Implementation of an IPv6 Remote Address-Scanning Tool  .  36
   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-37">37</a>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-38">38</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The main driver for IPv6 [<a href="rfc2460.html" title='"Internet Protocol, Version 6 (IPv6) Specification"'>RFC2460</a>] deployment is its larger address
   space [<a href="#ref-CPNI-IPv6">CPNI-IPv6</a>].  This larger address space not only allows for an
   increased number of connected devices but also introduces a number of
   subtle changes in several aspects of the resulting networks.  One of
   these changes is the reduced host density (the number of hosts
   divided by the number of addresses) of typical IPv6 subnetworks, when
   compared to their IPv4 counterparts.  [<a href="rfc5157.html" title='"IPv6 Implications for Network Scanning"'>RFC5157</a>] describes how this
   significantly lower IPv6 host density is likely to make classic
   network address-scanning attacks less feasible, since even by
   applying various heuristics, the address space to be scanned remains
   very large.  <a href="rfc5157.html">RFC 5157</a> goes on to describe some alternative methods
   for attackers to glean active IPv6 addresses and provides some
   guidance for administrators and implementors, e.g., not using
   sequential addresses with DHCPv6.

   With the benefit of more than five years of additional IPv6
   deployment experience, this document formally obsoletes <a href="rfc5157.html">RFC 5157</a>.  It
   emphasizes that while address-scanning attacks are less feasible,
   they may, with appropriate heuristics, remain possible.  At the time
   that <a href="rfc5157.html">RFC 5157</a> was written, observed address-scanning attacks were
   typically across ports on the addresses of discovered servers; since
   then, evidence that some classic address scanning is occurring is
   being witnessed.  This text thus updates the analysis on the
   feasibility of address-scanning attacks in IPv6 networks, and it



<span class="grey">Gont &amp; Chown                  Informational                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   explores a number of additional techniques that can be employed for
   IPv6 network reconnaissance.  Practical examples and guidance are
   also included in the appendices.

   On one hand, raising awareness about IPv6 network reconnaissance
   techniques may allow (in some cases) network and security
   administrators to prevent or detect such attempts.  On the other
   hand, network reconnaissance is essential for the so-called
   "penetration tests" typically performed to assess the security of
   production networks.  As a result, we believe the benefits of a
   thorough discussion of IPv6 network reconnaissance are twofold.

   <a href="#section-4">Section 4</a> analyzes the feasibility of address-scanning attacks (e.g.,
   ping sweeps) in IPv6 networks and explores a number of possible
   improvements to such techniques.  <a href="#appendix-A">Appendix A</a> describes how the
   aforementioned analysis can be leveraged to produce address-scanning
   tools (e.g., for penetration testing purposes).  Finally, the rest of
   this document discusses a number of miscellaneous techniques that
   could be leveraged for IPv6 network reconnaissance.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Conventions"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Conventions</span>

   Throughout this document, we consider that bits are numbered from
   left to right, starting at 0, and that bytes are numbered from left
   to right, starting at 0.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Requirements%20for%20the%20Applicability%20of%20Network%20Reconnaissance"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Requirements for the Applicability of Network Reconnaissance</span>
<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Techniques"></a>    Techniques</span>

   Throughout this document, a number of network reconnaissance
   techniques are discussed.  Each of these techniques has different
   requirements on the side of the practitioner, with respect to whether
   they require local access to the target network and whether they
   require login access (or similar access credentials) to the system on
   which the technique is applied.

   The following table tries to summarize the aforementioned
   requirements and serves as a cross index to the corresponding
   sections.












<span class="grey">Gont &amp; Chown                  Informational                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   +---------------------------------------------+----------+----------+
   |                  Technique                  |  Local   |  Login   |
   |                                             |  access  |  access  |
   +---------------------------------------------+----------+----------+
   |    Remote Address Scanning (<a href="#section-4.2">Section 4.2</a>)    |    No    |    No    |
   +---------------------------------------------+----------+----------+
   |     Local Address Scanning (<a href="#section-4.3">Section 4.3</a>)    |   Yes    |    No    |
   +---------------------------------------------+----------+----------+
   |     DNS Advertised Hosts (<a href="#section-5.1.1">Section 5.1.1</a>)    |    No    |    No    |
   +---------------------------------------------+----------+----------+
   |      DNS Zone Transfers (<a href="#section-5.1.2">Section 5.1.2</a>)     |    No    |    No    |
   +---------------------------------------------+----------+----------+
   |      DNS Brute Forcing (<a href="#section-5.1.3">Section 5.1.3</a>)      |    No    |    No    |
   +---------------------------------------------+----------+----------+
   |     DNS Reverse Mappings (<a href="#section-5.1.4">Section 5.1.4</a>)    |    No    |    No    |
   +---------------------------------------------+----------+----------+
   |     Leveraging Local Name Resolution and    |   Yes    |    No    |
   |   Service Discovery Services (<a href="#section-5.2">Section 5.2</a>)  |          |          |
   +---------------------------------------------+----------+----------+
   |        Public Archives (<a href="#section-5.3">Section 5.3</a>)        |    No    |    No    |
   +---------------------------------------------+----------+----------+
   |   Application Participation (<a href="#section-5.4">Section 5.4</a>)   |    No    |    No    |
   +---------------------------------------------+----------+----------+
   |  Inspection of the IPv6 Neighbor Cache and  |    No    |   Yes    |
   |         Routing Table (<a href="#section-5.5">Section 5.5</a>)         |          |          |
   +---------------------------------------------+----------+----------+
   |   Inspecting System Configuration and Log   |    No    |   Yes    |
   |             Files (<a href="#section-5.6">Section 5.6</a>)             |          |          |
   +---------------------------------------------+----------+----------+
   | Gleaning Information from Routing Protocols |   Yes    |    No    |
   |                (<a href="#section-5.7">Section 5.7</a>)                |          |          |
   +---------------------------------------------+----------+----------+
   |      Gleaning Information from IP Flow      |    No    |   Yes    |
   |   Information Export (IPFIX) (<a href="#section-5.8">Section 5.8</a>)  |          |          |
   +---------------------------------------------+----------+----------+
   |      Obtaining Network Information with     |    No    |    No    |
   |          traceroute6 (<a href="#section-5.9">Section 5.9</a>)          |          |          |
   +---------------------------------------------+----------+----------+
   |  Gleaning Information from Network Devices  |    No    |   Yes    |
   |          Using SNMP (<a href="#section-5.10">Section 5.10</a>)          |          |          |
   +---------------------------------------------+----------+----------+
   |  Obtaining Network Information via Traffic  |   Yes    |    No    |
   |           Snooping (<a href="#section-5.11">Section 5.11</a>)           |          |          |
   +---------------------------------------------+----------+----------+

              Table 1: Requirements for the Applicability of
                     Network Reconnaissance Techniques




<span class="grey">Gont &amp; Chown                  Informational                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20IPv6%20Address%20Scanning"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  IPv6 Address Scanning</span>

   This section discusses how traditional address-scanning techniques
   (e.g., "ping sweeps") apply to IPv6 networks.  <a href="#section-4.1">Section 4.1</a> provides
   an essential analysis of how address configuration is performed in
   IPv6, identifying patterns in IPv6 addresses that can be leveraged to
   reduce the IPv6 address search space when performing IPv6 address-
   scanning attacks.  <a href="#section-4.2">Section 4.2</a> discusses IPv6 address scanning of
   remote networks.  <a href="#section-4.3">Section 4.3</a> discusses IPv6 address scanning of
   local networks.  <a href="#section-4.4">Section 4.4</a> discusses existing IPv6 address-scanning
   tools.  <a href="#section-4.5">Section 4.5</a> provides advice on how to mitigate IPv6 address-
   scanning attacks.  Finally, <a href="#appendix-A">Appendix A</a> discusses how the insights
   obtained in the following subsections can be incorporated into a
   fully fledged IPv6 address-scanning tool.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Address%20Configuration%20in%20IPv6"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Address Configuration in IPv6</span>

   IPv6 incorporates two automatic address-configuration mechanisms:
   Stateless Address Autoconfiguration (SLAAC) [<a href="rfc4862.html" title='"IPv6 Stateless Address Autoconfiguration"'>RFC4862</a>] and Dynamic
   Host Configuration Protocol for IPv6 (DHCPv6) [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>].  Support for
   SLAAC for automatic address configuration is mandatory, while support
   for DHCPv6 is optional -- however, most current versions of general-
   purpose operating systems support both.  In addition to automatic
   address configuration, hosts, typically servers, may employ manual
   configuration, in which all the necessary information is manually
   entered by the host or network administrator into configuration files
   at the host.

   The following subsections describe each of the possible configuration
   mechanisms/approaches in more detail.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.1.%20%20Stateless%20Address%20Autoconfiguration%20%28SLAAC%29"></a><a class="selflink" href="#section-4.1.1" name="section-4.1.1">4.1.1</a>.  Stateless Address Autoconfiguration (SLAAC)</span>

   The basic idea behind SLAAC is that every host joining a network will
   send a multicasted solicitation requesting network configuration
   information, and local routers will respond to the request providing
   the necessary information.  SLAAC employs two different ICMPv6
   message types: ICMPv6 Router Solicitation and ICMPv6 Router
   Advertisement messages.  Router Solicitation messages are employed by
   hosts to query local routers for configuration information, while
   Router Advertisement messages are employed by local routers to convey
   the requested information.









<span class="grey">Gont &amp; Chown                  Informational                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   Router Advertisement messages convey a plethora of network
   configuration information, including the IPv6 prefix that should be
   used for configuring IPv6 addresses on the local network.  For each
   local prefix learned from a Router Advertisement message, an IPv6
   address is configured by appending a locally generated Interface
   Identifier (IID) to the corresponding IPv6 prefix.

   The following subsections describe currently deployed policies for
   generating the IIDs used with SLAAC.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.1.1.1.%20%20Interface%20Identifiers%20Embedding%20IEEE%20Identifiers"></a><a class="selflink" href="#section-4.1.1.1" name="section-4.1.1.1">4.1.1.1</a>.  Interface Identifiers Embedding IEEE Identifiers</span>

   The traditional SLAAC IIDs are based on the link-layer address of the
   corresponding network interface card.  For example, in the case of
   Ethernet addresses, the IIDs are constructed as follows:

   1.  The "Universal" bit (bit 6, from left to right) of the address is
       set to 1.

   2.  The word 0xfffe is inserted between the Organizationally Unique
       Identifier (OUI) and the rest of the Ethernet address.

   For example, the Media Access Control (MAC) address 00:1b:38:83:88:3c
   would lead to the IID 021b:38ff:fe83:883c.

   A number of considerations should be made about these identifiers.
   Firstly, one 16-bit word (bytes 3-4) of the resulting address always
   has a fixed value (0xfffe), thus reducing the search space for the
   IID.  Secondly, the high-order three bytes of the IID correspond to
   the OUI of the network interface card vendor.  Since not all possible
   OUIs have been assigned, this further reduces the IID search space.
   Furthermore, of the assigned OUIs, many could be regarded as
   corresponding to legacy devices and thus are unlikely to be used for
   Internet-connected IPv6-enabled systems, yet further reducing the IID
   search space.  Finally, in some scenarios, it could be possible to
   infer the OUI in use by the target network devices, yet narrowing
   down the possible IIDs even more.

   NOTE:
      For example, an organization known for being provisioned by vendor
      X is likely to have most of the nodes in its organizational
      network with OUIs corresponding to vendor X.

   These considerations mean that in some scenarios, the original IID
   search space of 64 bits may be effectively reduced to 2^24 or n *
   2^24 (where "n" is the number of different OUIs assigned to the
   target vendor).




<span class="grey">Gont &amp; Chown                  Informational                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   Furthermore, if just one host address is detected or known within a
   subnet, it is not unlikely that, if systems were ordered in a batch,
   they may have sequential MAC addresses.  Additionally, given a MAC
   address observed in one subnet, sequential or nearby MAC addresses
   may be seen in other subnets in the same site.

   NOTE:
      [<a href="rfc7136.html" title='"Significance of IPv6 Interface Identifiers"'>RFC7136</a>] notes that all bits of an IID should be treated as
      "opaque" bits.  Furthermore, [<a href="#ref-DEFAULT-IIDS">DEFAULT-IIDS</a>] is currently in the
      process of changing the default IID generation scheme to align
      with [<a href="rfc7217.html" title='"A Method for Generating Semantically Opaque Interface Identifiers with IPv6 Stateless Address Autoconfiguration (SLAAC)"'>RFC7217</a>] (as described below in <a href="#section-4.1.1.5">Section 4.1.1.5</a>), such that
      IIDs are semantically opaque and do not follow any patterns.
      Therefore, the traditional IIDs based on link-layer addresses are
      expected to become less common over time.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.1.1.2.%20%20Interface%20Identifiers%20of%20Virtualization%20Technologies"></a><a class="selflink" href="#section-4.1.1.2" name="section-4.1.1.2">4.1.1.2</a>.  Interface Identifiers of Virtualization Technologies</span>

   IIDs resulting from virtualization technologies can be considered a
   specific subcase of IIDs embedding IEEE identifiers (please see
   <a href="#section-4.1.1.1">Section 4.1.1.1</a>): they employ IEEE identifiers, but part of the IID
   has specific patterns.  The following subsections describe IIDs of
   some popular virtualization technologies.

<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/4.1.1.2.1.%20%20VirtualBox"></a><a class="selflink" href="#section-4.1.1.2.1" name="section-4.1.1.2.1">4.1.1.2.1</a>.  VirtualBox</span>

   All automatically generated MAC addresses in VirtualBox virtual
   machines employ the OUI 08:00:27 [<a href="#ref-VBox2011" title='"Oracle VM VirtualBox User Manual"'>VBox2011</a>].  This means that all
   addresses resulting from traditional SLAAC will have an IID of the
   form a00:27ff:feXX:XXXX, thus effectively reducing the IID search
   space from 64 bits to 24 bits.

<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/4.1.1.2.2.%20%20VMware%20ESX%20Server"></a><a class="selflink" href="#section-4.1.1.2.2" name="section-4.1.1.2.2">4.1.1.2.2</a>.  VMware ESX Server</span>

   The VMware ESX server (versions 1.0 to 2.5) provides yet a more
   interesting example.  Automatically generated MAC addresses have the
   following pattern [<a href="#ref-vmesx2011">vmesx2011</a>]:

   1.  The OUI is set to 00:05:69.

   2.  The next 16 bits of the MAC address are set to the same value as
       the last 16 bits of the console operating system's primary IPv4
       address.

   3.  The final 8 bits of the MAC address are set to a hash value based
       on the name of the virtual machine's configuration file.






<span class="grey">Gont &amp; Chown                  Informational                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   This means that, assuming the console operating system's primary IPv4
   address is known, the IID search space is reduced from 64 bits to 8
   bits.

   On the other hand, manually configured MAC addresses in the VMware
   ESX server employ the OUI 00:50:56, with the low-order three bytes of
   the MAC address being in the range 00:00:00-3F:FF:FF (to avoid
   conflicts with other VMware products).  Therefore, even in the case
   of manually configured MAC addresses, the IID search space is reduced
   from 64 bits to 22 bits.

<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/4.1.1.2.3.%20%20VMware%20vSphere"></a><a class="selflink" href="#section-4.1.1.2.3" name="section-4.1.1.2.3">4.1.1.2.3</a>.  VMware vSphere</span>

   VMware vSphere [<a href="#ref-vSphere" title='"vSphere Networking"'>vSphere</a>] supports these default MAC address
   generation algorithms:

   o  Generated addresses

      *  Assigned by the vCenter server

      *  Assigned by the ESXi host

   o  Manually configured addresses

   By default, MAC addresses assigned by the vCenter server use the OUI
   00:50:56 and have the format 00:50:56:XX:YY:ZZ, where XX is
   calculated as (0x80 + vCenter Server ID (in the range 0x00-0x3F)),
   and XX and YY are random two-digit hexadecimal numbers.  Thus, the
   possible IID range is 00:50:56:80:00:00-00:50:56:BF:FF:FF; therefore,
   the search space for the resulting SLAAC addresses will be 22 bits.

   MAC addresses generated by the ESXi host use the OUI 00:0C:29 and
   have the format 00:0C:29:XX:YY:ZZ, where XX, YY, and ZZ are the last
   three octets in hexadecimal format of the virtual machine Universally
   Unique Identifier (UUID) (based on a hash calculated with the UUID of
   the ESXi physical machine and the path to a configuration file).
   Thus, the MAC addresses will be in the range
   00:0C:29:00:00:00-00:0C:29:FF:FF:FF; therefore, the search space for
   the resulting SLAAC addresses will be 24 bits.

   Finally, manually configured MAC addresses employ the OUI 00:50:56,
   with the low-order three bytes being in the range 00:00:00-3F:FF:FF
   (to avoid conflicts with other VMware products).  Therefore, the
   resulting MAC addresses will be in the range
   00:50:56:00:00:00-00:50:56:3F:FF:FF, and the search space for the
   corresponding SLAAC addresses will be 22 bits.





<span class="grey">Gont &amp; Chown                  Informational                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.1.1.3.%20%20Temporary%20Addresses"></a><a class="selflink" href="#section-4.1.1.3" name="section-4.1.1.3">4.1.1.3</a>.  Temporary Addresses</span>

   Privacy concerns [<a href="#ref-Gont-DEEPSEC2011">Gont-DEEPSEC2011</a>] [<a href="rfc7721.html" title='"Security and Privacy Considerations for IPv6 Address Generation Mechanisms"'>RFC7721</a>] regarding IIDs
   embedding IEEE identifiers led to the introduction of "Privacy
   Extensions for Stateless Address Autoconfiguration in IPv6"
   [<a href="rfc4941.html" title='"Privacy Extensions for Stateless Address Autoconfiguration in IPv6"'>RFC4941</a>], also known as "temporary addresses" or "privacy
   addresses".  Essentially, "temporary addresses" produce random
   addresses by concatenating a random identifier to the
   autoconfiguration IPv6 prefix advertised in a Router Advertisement
   message.

   NOTE:
      In addition to their unpredictability, these addresses are
      typically short-lived, such that even if an attacker were to learn
      of one of these addresses, they would be of use for a limited
      period of time.  A typical implementation may keep a temporary
      address preferred for 24 hours, and configured but deprecated for
      seven days.

   It is important to note that "temporary addresses" are generated in
   addition to the stable addresses [<a href="rfc7721.html" title='"Security and Privacy Considerations for IPv6 Address Generation Mechanisms"'>RFC7721</a>] (such as the traditional
   SLAAC addresses based on IEEE identifiers): stable SLAAC addresses
   are meant to be employed for "server-like" inbound communications,
   while "temporary addresses" are meant to be employed for "client-
   like" outbound communications.  This means that implementation/use of
   "temporary addresses" does not prevent an attacker from leveraging
   the predictability of stable SLAAC addresses, since "temporary
   addresses" are generated in addition to (rather than as a replacement
   of) the stable SLAAC addresses (such as those derived from IEEE
   identifiers).

   The benefit that temporary addresses offer in this context is that
   they reduce the exposure of the host addresses to any third parties
   that may observe traffic sent from a host where temporary addresses
   are enabled and used by default.  But, in the absence of firewall
   protection for the host, its stable SLAAC address remains liable to
   be scanned from off-site.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.1.1.4.%20%20Constant%2C%20Semantically%20Opaque%20IIDs"></a><a class="selflink" href="#section-4.1.1.4" name="section-4.1.1.4">4.1.1.4</a>.  Constant, Semantically Opaque IIDs</span>

   In order to mitigate the security implications arising from the
   predictable IPv6 addresses derived from IEEE identifiers, Microsoft
   Windows produced an alternative scheme for generating "stable
   addresses" (in replacement of the ones embedding IEEE identifiers).
   The aforementioned scheme is believed to be an implementation of <a href="rfc4941.html">RFC</a>
   <a href="rfc4941.html">4941</a> [<a href="rfc4941.html" title='"Privacy Extensions for Stateless Address Autoconfiguration in IPv6"'>RFC4941</a>], but without regenerating the addresses over time.
   The resulting IIDs are constant across system bootstraps, and also
   constant across networks.



<span class="grey">Gont &amp; Chown                  Informational                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   Assuming no flaws in the aforementioned algorithm, this scheme would
   remove any patterns from the SLAAC addresses.

   NOTE:
      However, since the resulting IIDs are constant across networks,
      these addresses may still be leveraged for host-tracking purposes
      [<a href="rfc7217.html" title='"A Method for Generating Semantically Opaque Interface Identifiers with IPv6 Stateless Address Autoconfiguration (SLAAC)"'>RFC7217</a>] [<a href="rfc7721.html" title='"Security and Privacy Considerations for IPv6 Address Generation Mechanisms"'>RFC7721</a>].

   The benefit of this scheme is thus that the host may be less readily
   detected by applying heuristics to an address-scanning attack, but,
   in the absence of concurrent use of temporary addresses, the host is
   liable to be tracked across visited networks.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.1.1.5.%20%20Stable%2C%20Semantically%20Opaque%20IIDs"></a><a class="selflink" href="#section-4.1.1.5" name="section-4.1.1.5">4.1.1.5</a>.  Stable, Semantically Opaque IIDs</span>

   In response to the predictability issues discussed in <a href="#section-4.1.1.1">Section 4.1.1.1</a>
   and the privacy issues discussed in [<a href="rfc7721.html" title='"Security and Privacy Considerations for IPv6 Address Generation Mechanisms"'>RFC7721</a>], the IETF has
   standardized (in [<a href="rfc7217.html" title='"A Method for Generating Semantically Opaque Interface Identifiers with IPv6 Stateless Address Autoconfiguration (SLAAC)"'>RFC7217</a>]) a method for generating IPv6 IIDs to be
   used with IPv6 SLAAC, such that addresses configured using this
   method are stable within each subnet, but the IIDs change when hosts
   move from one subnet to another.  The aforementioned method is meant
   to be an alternative to generating IIDs based on IEEE identifiers,
   such that the benefits of stable addresses can be achieved without
   sacrificing the privacy of users.

   Implementation of this method (in replacement of IIDs based on IEEE
   identifiers) eliminates any patterns from the IID, thus benefiting
   user privacy and reducing the ease with which addresses can be
   scanned.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.2.%20%20Dynamic%20Host%20Configuration%20Protocol%20for%20IPv6%20%28DHCPv6%29"></a><a class="selflink" href="#section-4.1.2" name="section-4.1.2">4.1.2</a>.  Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</span>

   DHCPv6 can be employed as a stateful address configuration mechanism,
   in which a server (the DHCPv6 server) leases IPv6 addresses to IPv6
   hosts.  As with the IPv4 counterpart, addresses are assigned
   according to a configuration-defined address range and policy, with
   some DHCPv6 servers assigning addresses sequentially, from a specific
   range.  In such cases, addresses tend to be predictable.

   NOTE:
      For example, if the prefix 2001:db8::/64 is used for assigning
      addresses on the local network, the DHCPv6 server might
      (sequentially) assign addresses from the range 2001:db8::1 -
      2001:db8::100.

   In most common scenarios, this means that the IID search space will
   be reduced from the original 64 bits to 8 or 16 bits.  [<a href="rfc5157.html" title='"IPv6 Implications for Network Scanning"'>RFC5157</a>]
   recommended that DHCPv6 instead issue addresses randomly from a large



<span class="grey">Gont &amp; Chown                  Informational                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   pool; that advice is repeated here.  [<a href="#ref-IIDS-DHCPv6">IIDS-DHCPv6</a>] specifies an
   algorithm that can be employed by DHCPv6 servers to produce stable
   addresses that do not follow any specific pattern, thus resulting in
   an IID search space of 64 bits.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.3.%20%20Manually%20Configured%20Addresses"></a><a class="selflink" href="#section-4.1.3" name="section-4.1.3">4.1.3</a>.  Manually Configured Addresses</span>

   In some scenarios, node addresses may be manually configured.  This
   is typically the case for IPv6 addresses assigned to routers (since
   routers do not employ automatic address configuration) but also for
   servers (since having a stable address that does not depend on the
   underlying link-layer address is generally desirable).

   While network administrators are mostly free to select the IID from
   any value in the range 1 - 2^64, for the sake of simplicity (i.e.,
   ease of remembering), they tend to select addresses with one of the
   following patterns:

   o  low-byte addresses: in which most of the bytes of the IID are set
      to 0 (except for the least significant byte)

   o  IPv4-based addresses: in which the IID embeds the IPv4 address of
      the network interface (as in 2001:db8::192.0.2.1)

   o  service port addresses: in which the IID embeds the TCP/UDP
      service port of the main service running on that node (as in
      2001:db8::80 or 2001:db8::25)

   o  wordy addresses: which encode words (as in 2001:db8::bad:cafe)

   Each of these patterns is discussed in detail in the following
   subsections.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.1.3.1.%20%20Low-Byte%20Addresses"></a><a class="selflink" href="#section-4.1.3.1" name="section-4.1.3.1">4.1.3.1</a>.  Low-Byte Addresses</span>

   The most common form of low-byte addresses is that in which all the
   bytes of the IID (except the least significant bytes) are set to zero
   (as in 2001:db8::1, 2001:db8::2, etc.).  However, it is also common
   to find similar addresses in which the two lowest-order 16-bit words
   (from the right to left) are set to small numbers (as in
   2001::db8::1:10, 2001:db8::2:10, etc.).  Yet it is not uncommon to
   find IPv6 addresses in which the second lowest-order 16-bit word
   (from right to left) is set to a small value in the range
   0x0000:0x00ff, while the lowest-order 16-bit word (from right to
   left) varies in the range 0x0000:0xffff.  It should be noted that all
   of these address patterns are generally referred to as "low-byte





<span class="grey">Gont &amp; Chown                  Informational                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   addresses", even when, strictly speaking, it is not only the lowest-
   order byte of the IPv6 address that varies from one address to
   another.

   In the worst-case scenario, the search space for this pattern is 2^24
   (although most systems can be found by searching 2^16 or even 2^8
   addresses).

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.1.3.2.%20%20IPv4-Based%20Addresses"></a><a class="selflink" href="#section-4.1.3.2" name="section-4.1.3.2">4.1.3.2</a>.  IPv4-Based Addresses</span>

   The most common form of these addresses is that in which an IPv4
   address is encoded in the lowest-order 32 bits of the IPv6 address
   (usually as a result of the address notation of the form
   2001:db8::192.0.2.1).  However, it is also common for administrators
   to encode each of the bytes of the IPv4 address in each of the 16-bit
   words of the IID (as in, e.g., 2001:db8::192:0:2:1).

   Therefore, the search space for addresses following this pattern is
   that of the corresponding IPv4 prefix (or twice the size of that
   search space if both forms of "IPv4-based addresses" are to be
   searched).

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.1.3.3.%20%20Service-Port%20Addresses"></a><a class="selflink" href="#section-4.1.3.3" name="section-4.1.3.3">4.1.3.3</a>.  Service-Port Addresses</span>

   Addresses following this pattern include the service port (e.g., 80
   for HTTP) in the lowest-order byte of the IID and have the rest of
   the bytes of the IID set to zero.  There are a number of variants for
   this address pattern:

   o  The lowest-order 16-bit word (from right to left) may contain the
      service port, and the second lowest-order 16-bit word (from right
      to left) may be set to a number in the range 0x0000-0x00ff (as in,
      e.g., 2001:db8::1:80).

   o  The lowest-order 16-bit word (from right to left) may be set to a
      value in the range 0x0000-0x00ff, while the second lowest-order
      16-bit word (from right to left) may contain the service port (as
      in, e.g., 2001:db8::80:1).

   o  The service port itself might be encoded in decimal or in
      hexadecimal notation (e.g., an address embedding the HTTP port
      might be 2001:db8::80 or 2001:db8::50) -- with addresses encoding
      the service port as a decimal number being more common.

   Considering a maximum of 20 popular service ports, the search space
   for addresses following this pattern is, in the worst-case scenario,
   10 * 2^11.




<span class="grey">Gont &amp; Chown                  Informational                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.1.3.4.%20%20Wordy%20Addresses"></a><a class="selflink" href="#section-4.1.3.4" name="section-4.1.3.4">4.1.3.4</a>.  Wordy Addresses</span>

   Since the IPv6 address notation allows for a number of hexadecimal
   digits, it is not difficult to encode words into IPv6 addresses (as
   in, e.g., 2001:db8::bad:cafe).

   Addresses following this pattern are likely to be explored by means
   of "dictionary attacks"; therefore, computing the corresponding
   search space is not straightforward.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.4.%20%20IPv6%20Addresses%20Corresponding%20to%20Transition%2FCoexistence"></a><a class="selflink" href="#section-4.1.4" name="section-4.1.4">4.1.4</a>.  IPv6 Addresses Corresponding to Transition/Coexistence</span>
<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/Technologies"></a>        Technologies</span>

   Some transition/coexistence technologies might be leveraged to reduce
   the target search space of remote address-scanning attacks, since
   they specify how the corresponding IPv6 address must be generated.
   For example, in the case of Teredo [<a href="rfc4380.html" title='"Teredo: Tunneling IPv6 over UDP through Network Address Translations (NATs)"'>RFC4380</a>], the 64-bit IID is
   generated from the IPv4 address observed at a Teredo server along
   with a UDP port number.

   For obvious reasons, the search space for these addresses will depend
   on the specific transition/coexistence technology being employed.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.5.%20%20IPv6%20Address%20Assignment%20in%20Real-World%20Network%20Scenarios"></a><a class="selflink" href="#section-4.1.5" name="section-4.1.5">4.1.5</a>.  IPv6 Address Assignment in Real-World Network Scenarios</span>

   Figures 1, 2, and 3 provide a summary of the results obtained by
   [<a href="#ref-Gont-LACSEC2013">Gont-LACSEC2013</a>] when measuring the address patterns employed by web
   servers, name servers, and mail servers, respectively.  Figure 4
   provides a rough summary of the results obtained by [<a href="#ref-Malone2008">Malone2008</a>] for
   IPv6 routers.  Figure 5 provides a summary of the results obtained by
   [<a href="#ref-Ford2013" title='"IPv6 Address Analysis - Privacy In, Transition Out"'>Ford2013</a>] for clients.




















<span class="grey">Gont &amp; Chown                  Informational                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


                      +---------------+------------+
                      |  Address type | Percentage |
                      +---------------+------------+
                      |   IEEE-based  |    1.44%   |
                      +---------------+------------+
                      | Embedded-IPv4 |   25.41%   |
                      +---------------+------------+
                      | Embedded-Port |    3.06%   |
                      +---------------+------------+
                      |     ISATAP    |    0.00%   |
                      +---------------+------------+
                      |    Low-byte   |   56.88%   |
                      +---------------+------------+
                      |  Byte-pattern |    6.97%   |
                      +---------------+------------+
                      |   Randomized  |    6.24%   |
                      +---------------+------------+

                  Figure 1: Measured Web Server Addresses

                      +---------------+------------+
                      |  Address type | Percentage |
                      +---------------+------------+
                      |   IEEE-based  |    0.67%   |
                      +---------------+------------+
                      | Embedded-IPv4 |   22.11%   |
                      +---------------+------------+
                      | Embedded-Port |    6.48%   |
                      +---------------+------------+
                      |     ISATAP    |    0.00%   |
                      +---------------+------------+
                      |    Low-byte   |   56.58%   |
                      +---------------+------------+
                      |  Byte-pattern |   11.07%   |
                      +---------------+------------+
                      |   Randomized  |    3.09%   |
                      +---------------+------------+

                 Figure 2: Measured Name Server Addresses












<span class="grey">Gont &amp; Chown                  Informational                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


                      +---------------+------------+
                      |  Address type | Percentage |
                      +---------------+------------+
                      |   IEEE-based  |    0.48%   |
                      +---------------+------------+
                      | Embedded-IPv4 |    4.02%   |
                      +---------------+------------+
                      | Embedded-Port |    1.07%   |
                      +---------------+------------+
                      |     ISATAP    |    0.00%   |
                      +---------------+------------+
                      |    Low-byte   |   92.65%   |
                      +---------------+------------+
                      |  Byte-pattern |    1.20%   |
                      +---------------+------------+
                      |   Randomized  |    0.59%   |
                      +---------------+------------+

                 Figure 3: Measured Mail Server Addresses

                       +--------------+------------+
                       | Address type | Percentage |
                       +--------------+------------+
                       |   Low-byte   |   70.00%   |
                       +--------------+------------+
                       |  IPv4-based  |    5.00%   |
                       +--------------+------------+
                       |    SLAAC     |    1.00%   |
                       +--------------+------------+
                       |    Wordy     |   &lt;1.00%   |
                       +--------------+------------+
                       |  Randomized  |   &lt;1.00%   |
                       +--------------+------------+
                       |    Teredo    |   &lt;1.00%   |
                       +--------------+------------+
                       |    Other     |   &lt;1.00%   |
                       +--------------+------------+

                    Figure 4: Measured Router Addresses












<span class="grey">Gont &amp; Chown                  Informational                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


                         +---------------+------------+
                         |  Address type | Percentage |
                         +---------------+------------+
                         |   IEEE-based  |    7.72%   |
                         +---------------+------------+
                         | Embedded-IPv4 |   14.31%   |
                         +---------------+------------+
                         | Embedded-Port |    0.21%   |
                         +---------------+------------+
                         |     ISATAP    |    1.06%   |
                         +---------------+------------+
                         |   Randomized  |   69.73%   |
                         +---------------+------------+
                         |    Low-byte   |    6.23%   |
                         +---------------+------------+
                         |  Byte-pattern |    0.74%   |
                         +---------------+------------+

                    Figure 5: Measured Client Addresses

   NOTE:
      "ISATAP" stands for "Intra-Site Automatic Tunnel Addressing
      Protocol" [<a href="rfc5214.html" title='"Intra-Site Automatic Tunnel Addressing Protocol (ISATAP)"'>RFC5214</a>].

   It should be clear from these measurements that a very high
   percentage of host and router addresses follow very specific
   patterns.

   Figure 5 shows that while around 70% of clients observed in this
   measurement appear to be using temporary addresses, a significant
   number of clients still expose IEEE-based addresses and addresses
   using embedded IPv4 (thus also revealing IPv4 addresses).  Besides,
   as noted in <a href="#section-4.1.1.3">Section 4.1.1.3</a>, temporary addresses are employed along
   with stable IPv6 addresses; thus, hosts employing a temporary address
   may still be the subject of address-scanning attacks that target
   their stable address(es).

   [<a id="ref-ADDR-ANALYSIS" name="ref-ADDR-ANALYSIS">ADDR-ANALYSIS</a>] contains a spatial and temporal analysis of IPv6
   addresses corresponding to clients and routers.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20IPv6%20Address%20Scanning%20of%20Remote%20Networks"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  IPv6 Address Scanning of Remote Networks</span>

   Although attackers have been able to get away with "brute-force"
   address-scanning attacks in IPv4 networks (thanks to the lesser
   search space), successfully performing a brute-force address-scanning
   attack of an entire /64 network would be infeasible.  As a result, it
   is expected that attackers will leverage the IPv6 address patterns
   discussed in <a href="#section-4.1">Section 4.1</a> to reduce the IPv6 address search space.



<span class="grey">Gont &amp; Chown                  Informational                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   IPv6 address scanning of remote networks should consider an
   additional factor not present for the IPv4 case: since the typical
   IPv6 subnet is a /64, scanning an entire /64 could, in theory, lead
   to the creation of 2^64 entries in the Neighbor Cache of the last-hop
   router.  Unfortunately, a number of IPv6 implementations have been
   found to be unable to properly handle a large number of entries in
   the Neighbor Cache; hence, these address-scanning attacks may have
   the side effect of resulting in a Denial-of-Service (DoS) attack
   [<a href="#ref-CPNI-IPv6">CPNI-IPv6</a>] [<a href="rfc6583.html" title='"Operational Neighbor Discovery Problems"'>RFC6583</a>].

   [<a id="ref-RFC7421" name="ref-RFC7421">RFC7421</a>] discusses the "default" /64 boundary for host subnets and
   the assumptions surrounding it.  While there are reports of sites
   implementing IPv6 subnets of size /112 or smaller to reduce concerns
   about the above attack, such smaller subnets are likely to make
   address-scanning attacks more feasible, in addition to encountering
   the issues with non-/64 host subnets discussed in [<a href="rfc7421.html" title='"Analysis of the 64-bit Boundary in IPv6 Addressing"'>RFC7421</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.1.%20%20Reducing%20the%20Subnet%20ID%20Search%20Space"></a><a class="selflink" href="#section-4.2.1" name="section-4.2.1">4.2.1</a>.  Reducing the Subnet ID Search Space</span>

   When address scanning a remote network, consideration is required to
   select which subnet IDs to choose.  A typical site might have a /48
   allocation, which would mean up to 65,000 or so IPv6 /64 subnets to
   be scanned.

   However, in the same way the search space for the IID can be reduced,
   we may also be able to reduce the subnet ID search space in a number
   of ways, by guessing likely address plan schemes or using any
   complementary clues that might exist from other sources or
   observations.  For example, there are a number of documents available
   online (e.g., [<a href="rfc5375.html" title='"IPv6 Unicast Address Assignment Considerations"'>RFC5375</a>]) that provide recommendations for the
   allocation of address space, which address various operational
   considerations, including Regional Internet Registry (RIR) assignment
   policy, ability to delegate reverse DNS zones to different servers,
   ability to aggregate routes efficiently, address space preservation,
   ability to delegate address assignment within the organization,
   ability to add/allocate new sites/prefixes to existing entities
   without updating Access Control Lists (ACLs), and ability to
   de-aggregate and advertise subspaces via various Autonomous System
   (AS) interfaces.

   Address plans might include use of subnets that:

   o  Run from low ID upwards, e.g., 2001:db8:0::/64, 2001:db8:1::/64,
      etc.

   o  Use building numbers, in hexadecimal or decimal form.

   o  Use Virtual Local Area Network (VLAN) numbers.



<span class="grey">Gont &amp; Chown                  Informational                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   o  Use an IPv4 subnet number in a dual-stack target, e.g., a site
      with a /16 for IPv4 might use /24 subnets, and the IPv6 address
      plan may reuse the third byte of the IPv4 address as the IPv6
      subnet ID.

   o  Use the service "color", as defined for service-based prefix
      coloring, or semantic prefixes.  For example, a site using a
      specific coloring for a specific service such as Voice over IP
      (VoIP) may reduce the subnet ID search space for those devices.

   The net effect is that the address space of an organization may be
   highly structured, and allocations of individual elements within this
   structure may be predictable once other elements are known.

   In general, any subnet ID address plan may convey information, or be
   based on known information, which may in turn be of advantage to an
   attacker.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20IPv6%20Address%20Scanning%20of%20Local%20Networks"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  IPv6 Address Scanning of Local Networks</span>

   IPv6 address scanning in Local Area Networks (LANs) could be
   considered, to some extent, a completely different problem than that
   of scanning a remote IPv6 network.  The main difference is that use
   of link-local multicast addresses can relieve the attacker of
   searching for unicast addresses in a large IPv6 address space.

   NOTE:
      While a number of other network reconnaissance vectors (such as
      network snooping, leveraging Neighbor Discovery traffic, etc.) are
      available when scanning a local network, this section focuses only
      on address-scanning attacks (a la "ping sweep").

   An attacker can simply send probe packets to the all-nodes link-local
   multicast address (ff02::1), such that responses are elicited from
   all local nodes.

   Since Windows systems (Vista, 7, etc.) do not respond to ICMPv6 Echo
   Request messages sent to multicast addresses, IPv6 address-scanning
   tools typically employ a number of additional probe packets to elicit
   responses from all the local nodes.  For example, unrecognized IPv6
   options of type 10xxxxxx elicit Internet Control Message Protocol
   version 6 (ICMPv6) Parameter Problem, code 2, error messages.

   Many address-scanning tools discover only IPv6 link-local addresses
   (rather than, e.g., the global addresses of the target systems):
   since the probe packets are typically sent with the attacker's IPv6
   link-local address, the "victim" nodes send the response packets
   using the IPv6 link-local address of the corresponding network



<span class="grey">Gont &amp; Chown                  Informational                    [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   interface (as specified by the IPv6 address-selection rules
   [<a href="rfc6724.html" title='"Default Address Selection for Internet Protocol Version 6 (IPv6)"'>RFC6724</a>]).  However, sending multiple probe packets, with each
   packet employing source addresses from different prefixes, typically
   helps to overcome this limitation.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.4.%20%20Existing%20IPv6%20Address-Scanning%20Tools"></a><a class="selflink" href="#section-4.4" name="section-4.4">4.4</a>.  Existing IPv6 Address-Scanning Tools</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.4.1.%20%20Remote%20IPv6%20Network%20Address%20Scanners"></a><a class="selflink" href="#section-4.4.1" name="section-4.4.1">4.4.1</a>.  Remote IPv6 Network Address Scanners</span>

   IPv4 address-scanning tools have traditionally carried out their task
   by probing an entire address range (usually the entire address range
   comprised by the target subnetwork).  One might argue that the reason
   for which they have been able to get away with such somewhat
   "rudimentary" techniques is that the scale or challenge of the task
   is so small in the IPv4 world that a "brute-force" attack is "good
   enough".  However, the scale of the "address-scanning" task is so
   large in IPv6 that attackers must be very creative to be "good
   enough".  Simply sweeping an entire /64 IPv6 subnet would just not be
   feasible.

   Many address-scanning tools do not even support sweeping an IPv6
   address range.  On the other hand, the alive6 tool from [<a href="#ref-THC-IPV6" title='"THC-IPV6"'>THC-IPV6</a>]
   supports sweeping address ranges, thus being able to leverage some
   patterns found in IPv6 addresses, such as the incremental addresses
   resulting from some DHCPv6 setups.  Finally, the scan6 tool from
   [<a href="#ref-IPv6-Toolkit">IPv6-Toolkit</a>] supports sweeping address ranges and can also leverage
   all the address patterns described in <a href="#section-4.1">Section 4.1</a> of this document.

   Clearly, a limitation of many of the currently available tools for
   IPv6 address scanning is that they lack an appropriately tuned
   "heuristics engine" that can help reduce the search space, such that
   the problem of IPv6 address scanning becomes tractable.

   It should be noted that IPv6 network monitoring and management tools
   also need to build and maintain information about the hosts in their
   network.  Such systems can no longer scan internal systems in a
   reasonable time to build a database of connected systems.  Rather,
   such systems will need more efficient approaches, e.g., by polling
   network devices for data held about observed IP addresses, MAC
   addresses, physical ports used, etc.  Such an approach can also
   enhance address accountability, by mapping IPv4 and IPv6 addresses to
   observed MAC addresses.  This of course implies that any access
   control mechanisms for querying such network devices, e.g., community
   strings for SNMP, should be set appropriately to avoid an attacker
   being able to gather address information remotely.






<span class="grey">Gont &amp; Chown                  Informational                    [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.4.2.%20%20Local%20IPv6%20Network%20Address%20Scanners"></a><a class="selflink" href="#section-4.4.2" name="section-4.4.2">4.4.2</a>.  Local IPv6 Network Address Scanners</span>

   There are a variety of publicly available local IPv6 network address-
   scanners:

   o  Current versions of nmap [<a href="#ref-nmap2015" title='"Fyodor"'>nmap2015</a>] implement this functionality.

   o  The Hacker's Choice (THC) IPv6 Attack Toolkit [<a href="#ref-THC-IPV6" title='"THC-IPV6"'>THC-IPV6</a>] includes
      a tool (alive6) that implements this functionality.

   o  SI6 Network's IPv6 Toolkit [<a href="#ref-IPv6-Toolkit">IPv6-Toolkit</a>] includes a tool (scan6)
      that implements this functionality.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.5.%20%20Mitigations"></a><a class="selflink" href="#section-4.5" name="section-4.5">4.5</a>.  Mitigations</span>

   IPv6 address-scanning attacks can be mitigated in a number of ways.
   A non-exhaustive list of the possible mitigations includes:

   o  Employing [<a href="rfc7217.html" title='"A Method for Generating Semantically Opaque Interface Identifiers with IPv6 Stateless Address Autoconfiguration (SLAAC)"'>RFC7217</a>] (stable, semantically opaque IIDs) in
      replacement of addresses based on IEEE identifiers, such that any
      address patterns are eliminated.

   o  Employing Intrusion Prevention Systems (IPSs) at the perimeter.

   o  Enforcing IPv6 packet filtering where applicable (see, e.g.,
      [<a href="rfc4890.html" title='"Recommendations for Filtering ICMPv6 Messages in Firewalls"'>RFC4890</a>]).

   o  Employing manually configured MAC addresses if virtual machines
      are employed and "resistance" to address-scanning attacks is
      deemed desirable, such that even if the virtual machines employ
      IEEE-derived IIDs, they are generated from non-predictable MAC
      addresses.

   o  Avoiding use of sequential addresses when using DHCPv6.  Ideally,
      the DHCPv6 server would allocate random addresses from a large
      pool (see, e.g., [<a href="#ref-IIDS-DHCPv6">IIDS-DHCPv6</a>]).

   o  Using the "default" /64 size IPv6 subnet prefixes.

   o  In general, avoiding being predictable in the way addresses are
      assigned.

   It should be noted that some of the aforementioned mitigations are
   operational, while others depend on the availability of specific
   protocol features (such as [<a href="rfc7217.html" title='"A Method for Generating Semantically Opaque Interface Identifiers with IPv6 Stateless Address Autoconfiguration (SLAAC)"'>RFC7217</a>]) on the corresponding nodes.






<span class="grey">Gont &amp; Chown                  Informational                    [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   Additionally, while some resistance to address-scanning attacks is
   generally desirable (particularly when lightweight mitigations are
   available), there are scenarios in which mitigation of some address-
   scanning vectors is unlikely to be a high priority (if at all
   possible).  And one should always remember that security by obscurity
   is not a reasonable defense in itself; it may only be one (relatively
   small) layer in a broader security environment.

   Two of the techniques discussed in this document for local address-
   scanning attacks are those that employ multicasted ICMPv6 Echo
   Requests and multicasted IPv6 packets containing unsupported options
   of type 10xxxxxx.  These two vectors could be easily mitigated by
   configuring nodes to not respond to multicasted ICMPv6 Echo Requests
   (default on Windows systems) and by updating the IPv6 specifications
   (and/or possibly configuring local nodes) such that multicasted
   packets never elicit ICMPv6 error messages (even if they contain
   unsupported options of type 10xxxxxx).

   NOTE:
      [<a href="#ref-SMURF-AMPLIFIER">SMURF-AMPLIFIER</a>] proposed such an update to the IPv6
      specifications.

   In any case, when it comes to local networks, there are a variety of
   network reconnaissance vectors.  Therefore, even if address-scanning
   vectors were mitigated, an attacker could still rely on, e.g.,
   protocols employed for the so-called "service discovery protocols"
   (see <a href="#section-5.2">Section 5.2</a>) or eventually rely on network snooping as a last
   resort for network reconnaissance.  There is ongoing work in the IETF
   on extending mDNS, or at least DNS-based service discovery, to work
   across a whole site, rather than in just a single subnet, which will
   have associated security implications.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.6.%20%20Conclusions"></a><a class="selflink" href="#section-4.6" name="section-4.6">4.6</a>.  Conclusions</span>

   In the previous subsections, we have shown why a /64 host subnet may
   be more vulnerable to address-based scanning than might intuitively
   be thought and how an attacker might reduce the target search space
   when performing an address-scanning attack.

   We have described a number of mitigations against address-scanning
   attacks, including the replacement of traditional SLAAC with stable
   semantically opaque IIDs (which requires support from system
   vendors).  We have also offered some practical guidance in regard to
   the principle of avoiding predictability in host addressing schemes.
   Finally, examples of address-scanning approaches and tools are
   discussed in the appendices.





<span class="grey">Gont &amp; Chown                  Informational                    [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   While most early IPv6-enabled networks remain dual stack, they are
   more likely to be scanned and attacked over IPv4 transport, and one
   may argue that the IPv6-specific considerations discussed here are
   not of an immediate concern.  However, an early IPv6 deployment
   within a dual-stack network may be seen by an attacker as a
   potentially "easier" target if the implementation of security
   policies is not as strict for IPv6 (for whatever reason).  As
   IPv6-only networks become more common, the above considerations will
   be of much greater importance.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Alternative%20Methods%20to%20Glean%20IPv6%20Addresses"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Alternative Methods to Glean IPv6 Addresses</span>

   The following subsections describe alternative methods by which an
   attacker might attempt to glean IPv6 addresses for subsequent
   probing.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Leveraging%20the%20Domain%20Name%20System%20%28DNS%29%20for%20Network%20Reconnaissance"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Leveraging the Domain Name System (DNS) for Network Reconnaissance</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.1.%20%20DNS%20Advertised%20Hosts"></a><a class="selflink" href="#section-5.1.1" name="section-5.1.1">5.1.1</a>.  DNS Advertised Hosts</span>

   Any systems that are "published" in the DNS, e.g., Mail Exchange (MX)
   relays or web servers, will remain open to probing from the very fact
   that their IPv6 addresses are publicly available.  It is worth noting
   that where the addresses used at a site follow specific patterns,
   publishing just one address may lead to an attack upon the other
   nodes.

   Additionally, we note that publication of IPv6 addresses in the DNS
   should not discourage the elimination of IPv6 address patterns: if
   any address patterns are eliminated from addresses published in the
   DNS, an attacker may have to rely on performing dictionary-based DNS
   lookups in order to find all systems in a target network (which is
   generally less reliable and more time/traffic consuming than mapping
   nodes with predictable IPv6 addresses).

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.2.%20%20DNS%20Zone%20Transfers"></a><a class="selflink" href="#section-5.1.2" name="section-5.1.2">5.1.2</a>.  DNS Zone Transfers</span>

   A DNS zone transfer (DNS query type "AXFR") [<a href="rfc1034.html" title='"Domain names - concepts and facilities"'>RFC1034</a>] [<a href="rfc1035.html" title='"Domain names - implementation and specification"'>RFC1035</a>] can
   readily provide information about potential attack targets.
   Restricting zone transfers is thus probably more important for IPv6,
   even if it is already good practice to restrict them in the IPv4
   world.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.3.%20%20DNS%20Brute%20Forcing"></a><a class="selflink" href="#section-5.1.3" name="section-5.1.3">5.1.3</a>.  DNS Brute Forcing</span>

   Attackers may employ DNS brute-forcing techniques by testing for the
   presence of DNS AAAA records against commonly used host names.




<span class="grey">Gont &amp; Chown                  Informational                    [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.4.%20%20DNS%20Reverse%20Mappings"></a><a class="selflink" href="#section-5.1.4" name="section-5.1.4">5.1.4</a>.  DNS Reverse Mappings</span>

   [<a id="ref-van-Dijk" name="ref-van-Dijk">van-Dijk</a>] describes an interesting technique that employs DNS
   reverse mappings for network reconnaissance.  Essentially, the
   attacker walks through the "ip6.arpa" zone looking up PTR records, in
   the hopes of learning the IPv6 addresses of hosts in a given target
   network (assuming that the reverse mappings have been configured, of
   course).  What is most interesting about this technique is that it
   can greatly reduce the IPv6 address search space.

   Basically, an attacker would walk the ip6.arpa zone corresponding to
   a target network (e.g., "0.8.0.0.8.b.d.0.1.0.0.2.ip6.arpa." for
   "2001:db8:80::/48"), issuing queries for PTR records corresponding to
   the domain names "0.0.8.0.0.8.b.d.0.1.0.0.2.ip6.arpa.",
   "1.0.8.0.0.8.b.d.0.1.0.0.2.ip6.arpa.", etc.  If, say, there were PTR
   records for any hosts "starting" with the domain name
   "0.0.8.0.0.8.b.d.0.1.0.0.2.ip6.arpa." (e.g., the ip6.arpa domain name
   corresponding to the IPv6 address 2001:db8:80::1), the response would
   contain an RCODE of 0 (no error).  Otherwise, the response would
   contain an RCODE of 4 (NXDOMAIN).  As noted in [<a href="#ref-van-Dijk" title='"Finding v6 hosts by efficiently mapping ip6.arpa"'>van-Dijk</a>], this
   technique allows for a tremendous reduction in the "IPv6 address"
   search space.

   NOTE:
      Some name servers, incorrectly implementing the DNS protocol,
      reply NXDOMAIN instead of NODATA (NOERROR=0 and ANSWER=0) when
      encountering a domain without any resource records but that has
      child domains, something that is very common in ip6.arpa (these
      domains are called ENT for Empty Non-Terminals; see [<a href="rfc7719.html" title='"DNS Terminology"'>RFC7719</a>]).
      When scanning ip6.arpa, this behavior may slow down or completely
      prevent the exploration of ip6.arpa.  Nevertheless, since such
      behavior is wrong (see [<a href="#ref-NXDOMAIN-DEF">NXDOMAIN-DEF</a>]), one cannot rely on it to
      "secure" ip6.arpa against tree walking.

      [<a id="ref-IPv6-RDNS" name="ref-IPv6-RDNS">IPv6-RDNS</a>] analyzes different approaches and considerations for
      ISPs in managing the ip6.arpa zone for IPv6 address space assigned
      to many customers, which may affect the technique described in
      this section.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Leveraging%20Local%20Name%20Resolution%20and%20Service%20Discovery%20Services"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Leveraging Local Name Resolution and Service Discovery Services</span>

   A number of protocols allow for unmanaged local name resolution and
   service.  For example, mDNS [<a href="rfc6762.html" title='"Multicast DNS"'>RFC6762</a>] and DNS Service Discovery (DNS-
   SD) [<a href="rfc6763.html" title='"DNS-Based Service Discovery"'>RFC6763</a>], or Link-Local Multicast Name Resolution (LLMNR)
   [<a href="rfc4795.html" title='"Link-local Multicast Name Resolution (LLMNR)"'>RFC4795</a>], are examples of such protocols.






<span class="grey">Gont &amp; Chown                  Informational                    [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   NOTE:
      Besides the Graphical User Interfaces (GUIs) included in products
      supporting such protocols, command-line tools such as mdns-scan
      [<a href="#ref-mdns-scan">mdns-scan</a>] and mzclient [<a href="#ref-mzclient" title='"Mono Zeroconf Project -- mzclient command- line tool"'>mzclient</a>] can help discover IPv6 hosts
      employing mDNS/DNS-SD.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Public%20Archives"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Public Archives</span>

   Public mailing-list archives or Usenet news messages archives may
   prove to be a useful channel for an attacker, since hostnames and/or
   IPv6 addresses could be easily obtained by inspection of the (many)
   "Received from:" or other header lines in the archived email or
   Usenet news messages.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20Application%20Participation"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  Application Participation</span>

   Peer-to-peer applications often include some centralized server that
   coordinates the transfer of data between peers.  For example,
   BitTorrent [<a href="#ref-BitTorrent">BitTorrent</a>] builds swarms of nodes that exchange chunks
   of files, with a tracker passing information about peers with
   available chunks of data between the peers.  Such applications may
   offer an attacker a source of peer addresses to probe.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.5.%20%20Inspection%20of%20the%20IPv6%20Neighbor%20Cache%20and%20Routing%20Table"></a><a class="selflink" href="#section-5.5" name="section-5.5">5.5</a>.  Inspection of the IPv6 Neighbor Cache and Routing Table</span>

   Information about other systems connected to the local network might
   be readily available from the Neighbor Cache [<a href="rfc4861.html" title='"Neighbor Discovery for IP version 6 (IPv6)"'>RFC4861</a>] and/or the
   routing table of any system connected to such network.  Source
   Address Validation Improvement (SAVI) [<a href="rfc6620.html" title='"FCFS SAVI: First-Come, First-Served Source Address Validation Improvement for Locally Assigned IPv6 Addresses"'>RFC6620</a>] also builds a cache
   of IPv6 and link-layer addresses (without actively participating in
   the Neighbor Discovery packet exchange) and hence is another source
   of similar information.

   These data structures could be inspected via either "login" access or
   SNMP.  While this requirement may limit the applicability of this
   technique, there are a number of scenarios in which this technique
   might be of use.  For example, security audit tools might be provided
   with the necessary credentials such that the Neighbor Cache and the
   routing table of all systems for which the tool has "login" or SNMP
   access can be automatically gleaned.  On the other hand, IPv6 worms
   [<a href="#ref-V6-WORMS" title='"Worm propagation strategies in an IPv6 Internet"'>V6-WORMS</a>] could leverage this technique for the purpose of spreading
   on the local network, since they will typically have access to the
   Neighbor Cache and routing table of an infected system.

   Section 2.5.1.4 of [<a href="#ref-OPSEC-IPv6">OPSEC-IPv6</a>] discusses additional considerations
   for the inspection of the IPv6 Neighbor Cache.





<span class="grey">Gont &amp; Chown                  Informational                    [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.6.%20%20Inspection%20of%20System%20Configuration%20and%20Log%20Files"></a><a class="selflink" href="#section-5.6" name="section-5.6">5.6</a>.  Inspection of System Configuration and Log Files</span>

   Nodes are generally configured with the addresses of other important
   local computers, such as email servers, local file servers, web proxy
   servers, recursive DNS servers, etc.  The /etc/hosts file in UNIX-
   like systems, Secure Shell (SSH) known_hosts files, or the Microsoft
   Windows registry are just some examples of places where interesting
   information about such systems might be found.

   Additionally, system log files (including web server logs, etc.) may
   also prove to be a useful source for an attacker.

   While the required credentials to access the aforementioned
   configuration and log files may limit the applicability of this
   technique, there are a number of scenarios in which this technique
   might be of use.  For example, security audit tools might be provided
   with the necessary credentials such that these files can be
   automatically accessed.  On the other hand, IPv6 worms could leverage
   this technique for the purpose of spreading on the local network,
   since they will typically have access to these files on an infected
   system [<a href="#ref-V6-WORMS" title='"Worm propagation strategies in an IPv6 Internet"'>V6-WORMS</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.7.%20%20Gleaning%20Information%20from%20Routing%20Protocols"></a><a class="selflink" href="#section-5.7" name="section-5.7">5.7</a>.  Gleaning Information from Routing Protocols</span>

   Some organizational IPv6 networks employ routing protocols to
   dynamically maintain routing information.  In such an environment, a
   local attacker could become a passive listener of the routing
   protocol, to determine other valid subnets/prefixes and some router
   addresses within that organization [<a href="#ref-V6-WORMS" title='"Worm propagation strategies in an IPv6 Internet"'>V6-WORMS</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.8.%20%20Gleaning%20Information%20from%20IP%20Flow%20Information%20Export%20%28IPFIX%29"></a><a class="selflink" href="#section-5.8" name="section-5.8">5.8</a>.  Gleaning Information from IP Flow Information Export (IPFIX)</span>

   IPFIX [<a href="rfc7012.html" title='"Information Model for IP Flow Information Export (IPFIX)"'>RFC7012</a>] can aggregate the flows by source addresses and hence
   may be leveraged for obtaining a list of "active" IPv6 addresses.
   Additional discussion of IPFIX can be found in Section 2.5.1.2 of
   [<a href="#ref-OPSEC-IPv6">OPSEC-IPv6</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.9.%20%20Obtaining%20Network%20Information%20with%20traceroute6"></a><a class="selflink" href="#section-5.9" name="section-5.9">5.9</a>.  Obtaining Network Information with traceroute6</span>

   IPv6 traceroute [<a href="#ref-traceroute6">traceroute6</a>] and similar tools (such as path6 from
   [<a href="#ref-IPv6-Toolkit">IPv6-Toolkit</a>]) can be employed to find router addresses and valid
   network prefixes.









<span class="grey">Gont &amp; Chown                  Informational                    [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.10.%20%20Gleaning%20Information%20from%20Network%20Devices%20Using%20SNMP"></a><a class="selflink" href="#section-5.10" name="section-5.10">5.10</a>.  Gleaning Information from Network Devices Using SNMP</span>

   SNMP can be leveraged to obtain information from a number of data
   structures such as the Neighbor Cache [<a href="rfc4861.html" title='"Neighbor Discovery for IP version 6 (IPv6)"'>RFC4861</a>], the routing table,
   and the SAVI [<a href="rfc6620.html" title='"FCFS SAVI: First-Come, First-Served Source Address Validation Improvement for Locally Assigned IPv6 Addresses"'>RFC6620</a>] cache of IPv6 and link-layer addresses.  SNMP
   access should be secured, such that unauthorized access to the
   aforementioned information is prevented.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.11.%20%20Obtaining%20Network%20Information%20via%20Traffic%20Snooping"></a><a class="selflink" href="#section-5.11" name="section-5.11">5.11</a>.  Obtaining Network Information via Traffic Snooping</span>

   Snooping network traffic can help in discovering active nodes in a
   number of ways.  Firstly, each captured packet will reveal the source
   and destination of the packet.  Secondly, the captured traffic may
   correspond to network protocols that transfer information such as
   host or router addresses, network topology information, etc.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Conclusions"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Conclusions</span>

   This document explores the topic of network reconnaissance in IPv6
   networks.  It analyzes the feasibility of address-scanning attacks in
   IPv6 networks and shows that the search space for such attacks is
   typically much smaller than the one traditionally assumed (64 bits).

   Additionally, this document explores a plethora of other network
   reconnaissance techniques, ranging from inspecting the IPv6 Network
   Cache of an attacker-controlled system to gleaning information about
   IPv6 addresses from public mailing-list archives or Peer-to-Peer
   (P2P) protocols.

   We expect traditional address-scanning attacks to become more and
   more elaborated (i.e., less "brute force"), and other network
   reconnaissance techniques to be actively explored, as global
   deployment of IPv6 increases and, more specifically, as more
   IPv6-only devices are deployed.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Security%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Security Considerations</span>

   This document reviews methods by which addresses of hosts within IPv6
   subnets can be determined.  As such, it raises no new security
   concerns.











<span class="grey">Gont &amp; Chown                  Informational                    [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20References"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Normative%20References"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Normative References</span>

   [<a id="ref-RFC1034" name="ref-RFC1034">RFC1034</a>]  Mockapetris, P., "Domain names - concepts and facilities",
              STD 13, <a href="rfc1034.html">RFC 1034</a>, DOI 10.17487/RFC1034, November 1987,
              &lt;<a href="http://www.rfc-editor.org/info/rfc1034">http://www.rfc-editor.org/info/rfc1034</a>&gt;.

   [<a id="ref-RFC1035" name="ref-RFC1035">RFC1035</a>]  Mockapetris, P., "Domain names - implementation and
              specification", STD 13, <a href="rfc1035.html">RFC 1035</a>, DOI 10.17487/RFC1035,
              November 1987, &lt;<a href="http://www.rfc-editor.org/info/rfc1035">http://www.rfc-editor.org/info/rfc1035</a>&gt;.

   [<a id="ref-RFC2460" name="ref-RFC2460">RFC2460</a>]  Deering, S. and R. Hinden, "Internet Protocol, Version 6
              (IPv6) Specification", <a href="rfc2460.html">RFC 2460</a>, DOI 10.17487/RFC2460,
              December 1998, &lt;<a href="http://www.rfc-editor.org/info/rfc2460">http://www.rfc-editor.org/info/rfc2460</a>&gt;.

   [<a id="ref-RFC3315" name="ref-RFC3315">RFC3315</a>]  Droms, R., Ed., Bound, J., Volz, B., Lemon, T., Perkins,
              C., and M. Carney, "Dynamic Host Configuration Protocol
              for IPv6 (DHCPv6)", <a href="rfc3315.html">RFC 3315</a>, DOI 10.17487/RFC3315, July
              2003, &lt;<a href="http://www.rfc-editor.org/info/rfc3315">http://www.rfc-editor.org/info/rfc3315</a>&gt;.

   [<a id="ref-RFC4380" name="ref-RFC4380">RFC4380</a>]  Huitema, C., "Teredo: Tunneling IPv6 over UDP through
              Network Address Translations (NATs)", <a href="rfc4380.html">RFC 4380</a>,
              DOI 10.17487/RFC4380, February 2006,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4380">http://www.rfc-editor.org/info/rfc4380</a>&gt;.

   [<a id="ref-RFC4861" name="ref-RFC4861">RFC4861</a>]  Narten, T., Nordmark, E., Simpson, W., and H. Soliman,
              "Neighbor Discovery for IP version 6 (IPv6)", <a href="rfc4861.html">RFC 4861</a>,
              DOI 10.17487/RFC4861, September 2007,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4861">http://www.rfc-editor.org/info/rfc4861</a>&gt;.

   [<a id="ref-RFC4862" name="ref-RFC4862">RFC4862</a>]  Thomson, S., Narten, T., and T. Jinmei, "IPv6 Stateless
              Address Autoconfiguration", <a href="rfc4862.html">RFC 4862</a>,
              DOI 10.17487/RFC4862, September 2007,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4862">http://www.rfc-editor.org/info/rfc4862</a>&gt;.

   [<a id="ref-RFC4941" name="ref-RFC4941">RFC4941</a>]  Narten, T., Draves, R., and S. Krishnan, "Privacy
              Extensions for Stateless Address Autoconfiguration in
              IPv6", <a href="rfc4941.html">RFC 4941</a>, DOI 10.17487/RFC4941, September 2007,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4941">http://www.rfc-editor.org/info/rfc4941</a>&gt;.

   [<a id="ref-RFC5214" name="ref-RFC5214">RFC5214</a>]  Templin, F., Gleeson, T., and D. Thaler, "Intra-Site
              Automatic Tunnel Addressing Protocol (ISATAP)", <a href="rfc5214.html">RFC 5214</a>,
              DOI 10.17487/RFC5214, March 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5214">http://www.rfc-editor.org/info/rfc5214</a>&gt;.






<span class="grey">Gont &amp; Chown                  Informational                    [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   [<a id="ref-RFC6620" name="ref-RFC6620">RFC6620</a>]  Nordmark, E., Bagnulo, M., and E. Levy-Abegnoli, "FCFS
              SAVI: First-Come, First-Served Source Address Validation
              Improvement for Locally Assigned IPv6 Addresses",
              <a href="rfc6620.html">RFC 6620</a>, DOI 10.17487/RFC6620, May 2012,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6620">http://www.rfc-editor.org/info/rfc6620</a>&gt;.

   [<a id="ref-RFC6724" name="ref-RFC6724">RFC6724</a>]  Thaler, D., Ed., Draves, R., Matsumoto, A., and T. Chown,
              "Default Address Selection for Internet Protocol Version 6
              (IPv6)", <a href="rfc6724.html">RFC 6724</a>, DOI 10.17487/RFC6724, September 2012,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6724">http://www.rfc-editor.org/info/rfc6724</a>&gt;.

   [<a id="ref-RFC7012" name="ref-RFC7012">RFC7012</a>]  Claise, B., Ed. and B. Trammell, Ed., "Information Model
              for IP Flow Information Export (IPFIX)", <a href="rfc7012.html">RFC 7012</a>,
              DOI 10.17487/RFC7012, September 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7012">http://www.rfc-editor.org/info/rfc7012</a>&gt;.

   [<a id="ref-RFC7136" name="ref-RFC7136">RFC7136</a>]  Carpenter, B. and S. Jiang, "Significance of IPv6
              Interface Identifiers", <a href="rfc7136.html">RFC 7136</a>, DOI 10.17487/RFC7136,
              February 2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7136">http://www.rfc-editor.org/info/rfc7136</a>&gt;.

   [<a id="ref-RFC7217" name="ref-RFC7217">RFC7217</a>]  Gont, F., "A Method for Generating Semantically Opaque
              Interface Identifiers with IPv6 Stateless Address
              Autoconfiguration (SLAAC)", <a href="rfc7217.html">RFC 7217</a>,
              DOI 10.17487/RFC7217, April 2014,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7217">http://www.rfc-editor.org/info/rfc7217</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Informative%20References"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Informative References</span>

   [<a id="ref-ADDR-ANALYSIS" name="ref-ADDR-ANALYSIS">ADDR-ANALYSIS</a>]
              Plonka, D. and A. Berger, "Temporal and Spatial
              Classification of Active IPv6 Addresses", ACM Internet
              Measurement Conference (IMC), Tokyo, Japan, Pages 509-522,
              DOI 10.1145/2815675.2815678, October 2015,
              &lt;<a href="http://conferences2.sigcomm.org/imc/2015/papers/p509.pdf">http://conferences2.sigcomm.org/imc/2015/papers/</a>
              <a href="http://conferences2.sigcomm.org/imc/2015/papers/p509.pdf">p509.pdf</a>&gt;.

   [<a id="ref-BitTorrent" name="ref-BitTorrent">BitTorrent</a>]
              Wikipedia, "BitTorrent", November 2015,
              &lt;<a href="https://en.wikipedia.org/w/index.php?title=BitTorrent&amp;oldid=690381343">https://en.wikipedia.org/w/</a>
              <a href="https://en.wikipedia.org/w/index.php?title=BitTorrent&amp;oldid=690381343">index.php?title=BitTorrent&amp;oldid=690381343</a>&gt;.

   [<a id="ref-CPNI-IPv6" name="ref-CPNI-IPv6">CPNI-IPv6</a>]
              Gont, F., "Security Assessment of the Internet Protocol
              version 6 (IPv6)", UK Centre for the Protection of
              National Infrastructure, (available on request).






<span class="grey">Gont &amp; Chown                  Informational                    [Page 29]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   [<a id="ref-DEFAULT-IIDS" name="ref-DEFAULT-IIDS">DEFAULT-IIDS</a>]
              Gont, F., Cooper, A., Thaler, D., and W. Liu,
              "Recommendation on Stable IPv6 Interface Identifiers",
              Work in Progress, <a href="https://tools.ietf.org/html/draft-ietf-6man-default-iids-10">draft-ietf-6man-default-iids-10</a>,
              February 2016.

   [<a id="ref-Ford2013" name="ref-Ford2013">Ford2013</a>] Ford, M., "IPv6 Address Analysis - Privacy In, Transition
              Out", May 2013,
              &lt;<a href="http://www.internetsociety.org/blog/2013/05/ipv6-address-analysis-privacy-transition-out">http://www.internetsociety.org/blog/2013/05/</a>
              <a href="http://www.internetsociety.org/blog/2013/05/ipv6-address-analysis-privacy-transition-out">ipv6-address-analysis-privacy-transition-out</a>&gt;.

   [<a id="ref-Gont-DEEPSEC2011" name="ref-Gont-DEEPSEC2011">Gont-DEEPSEC2011</a>]
              Gont, F., "Results of a Security Assessment of the
              Internet Protocol version 6 (IPv6)", DEEPSEC
              Conference, Vienna, Austria, November 2011,
              &lt;<a href="http://www.si6networks.com/presentations/deepsec2011/fgont-deepsec2011-ipv6-security.pdf">http://www.si6networks.com/presentations/deepsec2011/</a>
              <a href="http://www.si6networks.com/presentations/deepsec2011/fgont-deepsec2011-ipv6-security.pdf">fgont-deepsec2011-ipv6-security.pdf</a>&gt;.

   [<a id="ref-Gont-LACSEC2013" name="ref-Gont-LACSEC2013">Gont-LACSEC2013</a>]
              Gont, F., "IPv6 Network Reconnaissance: Theory &amp;
              Practice", LACSEC Conference, Medellin, Colombia, May
              2013, &lt;<a href="http://www.si6networks.com/presentations/lacnic19/lacsec2013-fgont-ipv6-network-reconnaissance.pdf">http://www.si6networks.com/presentations/lacnic19/</a>
              <a href="http://www.si6networks.com/presentations/lacnic19/lacsec2013-fgont-ipv6-network-reconnaissance.pdf">lacsec2013-fgont-ipv6-network-reconnaissance.pdf</a>&gt;.

   [<a id="ref-IIDS-DHCPv6" name="ref-IIDS-DHCPv6">IIDS-DHCPv6</a>]
              Gont, F. and W. Liu, "A Method for Generating Semantically
              Opaque Interface Identifiers with Dynamic Host
              Configuration Protocol for IPv6 (DHCPv6)", Work in
              Progress, <a href="https://tools.ietf.org/html/draft-ietf-dhc-stable-privacy-addresses-02">draft-ietf-dhc-stable-privacy-addresses-02</a>,
              April 2015.

   [<a id="ref-IPV6-EXT-HEADERS" name="ref-IPV6-EXT-HEADERS">IPV6-EXT-HEADERS</a>]
              Gont, F., Linkova, J., Chown, T., and W. Liu,
              "Observations on the Dropping of Packets with IPv6
              Extension Headers in the Real World", Work in Progress,
              <a href="https://tools.ietf.org/html/draft-ietf-v6ops-ipv6-ehs-in-real-world-02">draft-ietf-v6ops-ipv6-ehs-in-real-world-02</a>, December 2015.

   [<a id="ref-IPv6-RDNS" name="ref-IPv6-RDNS">IPv6-RDNS</a>]
              Howard, L., "Reverse DNS in IPv6 for Internet Service
              Providers", Work in Progress, <a href="https://tools.ietf.org/html/draft-ietf-dnsop-isp-ip6rdns-00">draft-ietf-dnsop-isp-</a>
              <a href="https://tools.ietf.org/html/draft-ietf-dnsop-isp-ip6rdns-00">ip6rdns-00</a>, October 2015.

   [<a id="ref-IPv6-Toolkit" name="ref-IPv6-Toolkit">IPv6-Toolkit</a>]
              SI6 Networks, "SI6 Networks' IPv6 Toolkit",
              &lt;<a href="http://www.si6networks.com/tools/ipv6toolkit">http://www.si6networks.com/tools/ipv6toolkit</a>&gt;.






<span class="grey">Gont &amp; Chown                  Informational                    [Page 30]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   [<a id="ref-Malone2008" name="ref-Malone2008">Malone2008</a>]
              Malone, D., "Observations of IPv6 Addresses", Passive and
              Active Network Measurement (PAM 2008, LNCS 4979),
              DOI 10.1007/978-3-540-79232-1_3, April 2008,
              &lt;<a href="http://www.maths.tcd.ie/~dwmalone/p/addr-pam08.pdf">http://www.maths.tcd.ie/~dwmalone/p/addr-pam08.pdf</a>&gt;.

   [<a id="ref-mdns-scan" name="ref-mdns-scan">mdns-scan</a>]
              Poettering, L., "mdns-scan(1) Manual Page",
              &lt;<a href="http://manpages.ubuntu.com/manpages/precise/man1/mdns-scan.1.html">http://manpages.ubuntu.com/manpages/precise/man1/</a>
              <a href="http://manpages.ubuntu.com/manpages/precise/man1/mdns-scan.1.html">mdns-scan.1.html</a>&gt;.

   [<a id="ref-mzclient" name="ref-mzclient">mzclient</a>] Bockover, A., "Mono Zeroconf Project -- mzclient command-
              line tool",
              &lt;<a href="http://www.mono-project.com/archived/monozeroconf/">http://www.mono-project.com/archived/monozeroconf/</a>&gt;.

   [<a id="ref-nmap2015" name="ref-nmap2015">nmap2015</a>] Lyon, Gordon "Fyodor", "Nmap 7.00", November 2015,
              &lt;<a href="http://insecure.org/">http://insecure.org</a>&gt;.

   [<a id="ref-NXDOMAIN-DEF" name="ref-NXDOMAIN-DEF">NXDOMAIN-DEF</a>]
              Bortzmeyer, S. and S. Huque, "NXDOMAIN really means there
              is nothing underneath", Work in Progress, <a href="https://tools.ietf.org/html/draft-ietf-dnsop-nxdomain-cut-00">draft-ietf-</a>
              <a href="https://tools.ietf.org/html/draft-ietf-dnsop-nxdomain-cut-00">dnsop-nxdomain-cut-00</a>, December 2015.

   [<a id="ref-OPSEC-IPv6" name="ref-OPSEC-IPv6">OPSEC-IPv6</a>]
              Chittimaneni, K., Kaeo, M., and E. Vyncke, "Operational
              Security Considerations for IPv6 Networks", Work in
              Progress, <a href="https://tools.ietf.org/html/draft-ietf-opsec-v6-07">draft-ietf-opsec-v6-07</a>, September 2015.

   [<a id="ref-RFC4795" name="ref-RFC4795">RFC4795</a>]  Aboba, B., Thaler, D., and L. Esibov, "Link-local
              Multicast Name Resolution (LLMNR)", <a href="rfc4795.html">RFC 4795</a>,
              DOI 10.17487/RFC4795, January 2007,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4795">http://www.rfc-editor.org/info/rfc4795</a>&gt;.

   [<a id="ref-RFC4890" name="ref-RFC4890">RFC4890</a>]  Davies, E. and J. Mohacsi, "Recommendations for Filtering
              ICMPv6 Messages in Firewalls", <a href="rfc4890.html">RFC 4890</a>,
              DOI 10.17487/RFC4890, May 2007,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4890">http://www.rfc-editor.org/info/rfc4890</a>&gt;.

   [<a id="ref-RFC5157" name="ref-RFC5157">RFC5157</a>]  Chown, T., "IPv6 Implications for Network Scanning",
              <a href="rfc5157.html">RFC 5157</a>, DOI 10.17487/RFC5157, March 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5157">http://www.rfc-editor.org/info/rfc5157</a>&gt;.

   [<a id="ref-RFC5375" name="ref-RFC5375">RFC5375</a>]  Van de Velde, G., Popoviciu, C., Chown, T., Bonness, O.,
              and C. Hahn, "IPv6 Unicast Address Assignment
              Considerations", <a href="rfc5375.html">RFC 5375</a>, DOI 10.17487/RFC5375, December
              2008, &lt;<a href="http://www.rfc-editor.org/info/rfc5375">http://www.rfc-editor.org/info/rfc5375</a>&gt;.





<span class="grey">Gont &amp; Chown                  Informational                    [Page 31]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   [<a id="ref-RFC6583" name="ref-RFC6583">RFC6583</a>]  Gashinsky, I., Jaeggli, J., and W. Kumari, "Operational
              Neighbor Discovery Problems", <a href="rfc6583.html">RFC 6583</a>,
              DOI 10.17487/RFC6583, March 2012,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6583">http://www.rfc-editor.org/info/rfc6583</a>&gt;.

   [<a id="ref-RFC6762" name="ref-RFC6762">RFC6762</a>]  Cheshire, S. and M. Krochmal, "Multicast DNS", <a href="rfc6762.html">RFC 6762</a>,
              DOI 10.17487/RFC6762, February 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6762">http://www.rfc-editor.org/info/rfc6762</a>&gt;.

   [<a id="ref-RFC6763" name="ref-RFC6763">RFC6763</a>]  Cheshire, S. and M. Krochmal, "DNS-Based Service
              Discovery", <a href="rfc6763.html">RFC 6763</a>, DOI 10.17487/RFC6763, February 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6763">http://www.rfc-editor.org/info/rfc6763</a>&gt;.

   [<a id="ref-RFC7421" name="ref-RFC7421">RFC7421</a>]  Carpenter, B., Ed., Chown, T., Gont, F., Jiang, S.,
              Petrescu, A., and A. Yourtchenko, "Analysis of the 64-bit
              Boundary in IPv6 Addressing", <a href="rfc7421.html">RFC 7421</a>,
              DOI 10.17487/RFC7421, January 2015,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7421">http://www.rfc-editor.org/info/rfc7421</a>&gt;.

   [<a id="ref-RFC7719" name="ref-RFC7719">RFC7719</a>]  Hoffman, P., Sullivan, A., and K. Fujiwara, "DNS
              Terminology", <a href="rfc7719.html">RFC 7719</a>, DOI 10.17487/RFC7719, December
              2015, &lt;<a href="http://www.rfc-editor.org/info/rfc7719">http://www.rfc-editor.org/info/rfc7719</a>&gt;.

   [<a id="ref-RFC7721" name="ref-RFC7721">RFC7721</a>]  Cooper, A., Gont, F., and D. Thaler, "Security and Privacy
              Considerations for IPv6 Address Generation Mechanisms",
              <a href="rfc7721.html">RFC 7721</a>, DOI 10.17487/RFC7721, March 2016,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7721">http://www.rfc-editor.org/info/rfc7721</a>&gt;.

   [<a id="ref-SMURF-AMPLIFIER" name="ref-SMURF-AMPLIFIER">SMURF-AMPLIFIER</a>]
              Gont, F. and W. Liu, "Security Implications of IPv6
              Options of Type 10xxxxxx", Work in Progress, <a href="https://tools.ietf.org/html/draft-gont-6man-ipv6-smurf-amplifier-03">draft-gont-</a>
              <a href="https://tools.ietf.org/html/draft-gont-6man-ipv6-smurf-amplifier-03">6man-ipv6-smurf-amplifier-03</a>, March 2013.

   [<a id="ref-THC-IPV6" name="ref-THC-IPV6">THC-IPV6</a>] "THC-IPV6", &lt;<a href="http://www.thc.org/thc-ipv6/">http://www.thc.org/thc-ipv6/</a>&gt;.

   [<a id="ref-traceroute6" name="ref-traceroute6">traceroute6</a>]
              FreeBSD, "FreeBSD System Manager's Manual: traceroute6(8)
              manual page", August 2009, &lt;<a href="https://www.freebsd.org/cgi/man.cgi?query=traceroute6">https://www.freebsd.org/cgi/</a>
              <a href="https://www.freebsd.org/cgi/man.cgi?query=traceroute6">man.cgi?query=traceroute6</a>&gt;.

   [<a id="ref-V6-WORMS" name="ref-V6-WORMS">V6-WORMS</a>] Bellovin, S., Cheswick, B., and A. Keromytis, "Worm
              propagation strategies in an IPv6 Internet", Vol. 31, No.
              1, pp. 70-76, February 2006,
              &lt;<a href="https://www.cs.columbia.edu/~smb/papers/v6worms.pdf">https://www.cs.columbia.edu/~smb/papers/v6worms.pdf</a>&gt;.

   [<a id="ref-van-Dijk" name="ref-van-Dijk">van-Dijk</a>] van Dijk, P., "Finding v6 hosts by efficiently mapping
              ip6.arpa", March 2012, &lt;<a href="http://7bits.nl/blog/2012/03/26/finding-v6-hosts-by-efficiently-mapping-ip6-arpa">http://7bits.nl/blog/2012/03/26/</a>
              <a href="http://7bits.nl/blog/2012/03/26/finding-v6-hosts-by-efficiently-mapping-ip6-arpa">finding-v6-hosts-by-efficiently-mapping-ip6-arpa</a>&gt;.



<span class="grey">Gont &amp; Chown                  Informational                    [Page 32]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   [<a id="ref-VBox2011" name="ref-VBox2011">VBox2011</a>] VirtualBox, "Oracle VM VirtualBox User Manual",
              Version 4.1.2, August 2011, &lt;<a href="http://www.virtualbox.org/">http://www.virtualbox.org</a>&gt;.

   [<a id="ref-vmesx2011" name="ref-vmesx2011">vmesx2011</a>]
              VMware, "Setting a static MAC address for a virtual NIC
              (219)", VMware Knowledge Base, August 2011,
              &lt;<a href="http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=219">http://kb.vmware.com/selfservice/microsites/</a>
              <a href="http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=219">search.do?language=en_US&amp;cmd=displayKC&amp;externalId=219</a>&gt;.

   [<a id="ref-vSphere" name="ref-vSphere">vSphere</a>]  VMware, "vSphere Networking", vSphere 5.5, Update 2,
              September 2014, &lt;<a href="http://pubs.vmware.com/vsphere-55/topic/com.vmware.ICbase/PDF/vsphere-esxi-vcenter-server-552-networking-guide.pdf">http://pubs.vmware.com/</a>
              <a href="http://pubs.vmware.com/vsphere-55/topic/com.vmware.ICbase/PDF/vsphere-esxi-vcenter-server-552-networking-guide.pdf">vsphere-55/topic/com.vmware.ICbase/PDF/</a>
              <a href="http://pubs.vmware.com/vsphere-55/topic/com.vmware.ICbase/PDF/vsphere-esxi-vcenter-server-552-networking-guide.pdf">vsphere-esxi-vcenter-server-552-networking-guide.pdf</a>&gt;.






































<span class="grey">Gont &amp; Chown                  Informational                    [Page 33]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-34" id="page-34" name="page-34"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Implementation%20of%20a%20Full-Fledged%20IPv6%20Address-Scanning%20Tool"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Implementation of a Full-Fledged IPv6 Address-Scanning Tool</span>

   This section describes the implementation of a full-fledged IPv6
   address-scanning tool.  <a href="#appendix-A.1">Appendix A.1</a> discusses the selection of host
   probes.  <a href="#appendix-A.2">Appendix A.2</a> describes the implementation of an IPv6 address
   scanner for local area networks.  <a href="#appendix-A.3">Appendix A.3</a> outlines the
   implementation of a general (i.e., non-local) IPv6 address scanner.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.1.%20%20Host-Probing%20Considerations"></a><a class="selflink" href="#appendix-A.1" name="appendix-A.1">A.1</a>.  Host-Probing Considerations</span>

   A number of factors should be considered when selecting the probe
   packet types and the probing rate for an IPv6 address-scanning tool.

   Firstly, some hosts (or border firewalls) might be configured to
   block or rate limit some specific packet types.  For example, it is
   usual for host and router implementations to rate-limit ICMPv6 error
   traffic.  Additionally, some firewalls might be configured to block
   or rate limit incoming ICMPv6 echo request packets (see, e.g.,
   [<a href="rfc4890.html" title='"Recommendations for Filtering ICMPv6 Messages in Firewalls"'>RFC4890</a>]).

   NOTE:
      As noted earlier in this document, Windows systems simply do not
      respond to ICMPv6 echo requests sent to multicast IPv6 addresses.

   Among the possible probe types are:

   o  ICMPv6 Echo Request packets (meant to elicit ICMPv6 Echo Replies),

   o  TCP SYN segments (meant to elicit SYN/ACK or RST segments),

   o  TCP segments that do not contain the ACK bit set (meant to elicit
      RST segments),

   o  UDP datagrams (meant to elicit a UDP application response or an
      ICMPv6 Port Unreachable),

   o  IPv6 packets containing any suitable payload and an unrecognized
      extension header (meant to elicit ICMPv6 Parameter Problem error
      messages), or

   o  IPv6 packets containing any suitable payload and an unrecognized
      option of type 10xxxxxx (meant to elicit an ICMPv6 Parameter
      Problem error message).

   Selecting an appropriate probe packet might help conceal the ongoing
   attack, but it may also be actually necessary if host or network
   configuration causes certain probe packets to be dropped.




<span class="grey">Gont &amp; Chown                  Informational                    [Page 34]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-35" id="page-35" name="page-35"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   Some address-scanning tools (such as scan6 of [<a href="#ref-IPv6-Toolkit">IPv6-Toolkit</a>])
   incorporate support for IPv6 extension headers.  In some cases,
   inserting some IPv6 extension headers in the probe packet may allow
   some filtering policies or monitoring devices to be circumvented.
   However, it may also result in the probe packets being dropped, as a
   result of the widespread dropping of IPv6 packets that employ IPv6
   extension headers (see [<a href="#ref-IPV6-EXT-HEADERS">IPV6-EXT-HEADERS</a>]).

   Another factor to consider is the address-probing rate.  Clearly, the
   higher the rate, the smaller the amount of time required to perform
   the attack.  However, the probing rate should not be too high, or
   else:

   1.  the attack might cause network congestion, thus resulting in
       packet loss.

   2.  the attack might hit rate limiting, thus resulting in packet
       loss.

   3.  the attack might reveal underlying problems in Neighbor Discovery
       implementations, thus leading to packet loss and possibly even
       Denial of Service.

   Packet loss is undesirable, since it would mean that an "alive" node
   might remain undetected as a result of a lost probe or response.
   Such losses could be the result of congestion (in case the attacker
   is scanning a target network at a rate higher than the target network
   can handle) or may be the result of rate limiting (as it would be
   typically the case if ICMPv6 is employed for the probe packets).
   Finally, as discussed in [<a href="#ref-CPNI-IPv6">CPNI-IPv6</a>] and [<a href="rfc6583.html" title='"Operational Neighbor Discovery Problems"'>RFC6583</a>], some IPv6 router
   implementations have been found to be unable to perform decent
   resource management when faced with Neighbor Discovery traffic
   involving a large number of local nodes.  This essentially means that
   regardless of the type of probe packets, an address-scanning attack
   might result in a DoS of the target network, with the same (or worse)
   effects as that of network congestion or rate limiting.

   The specific rates at which each of these issues may come into play
   vary from one scenario to another and depend on the type of deployed
   routers/firewalls, configuration parameters, etc.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.2.%20%20Implementation%20of%20an%20IPv6%20Local%20Address-Scanning%20Tool"></a><a class="selflink" href="#appendix-A.2" name="appendix-A.2">A.2</a>.  Implementation of an IPv6 Local Address-Scanning Tool</span>

   scan6 [<a href="#ref-IPv6-Toolkit">IPv6-Toolkit</a>] is a full-fledged IPv6 local address-scanning
   tool, which has proven to be effective and efficient for the
   discovery of IPv6 hosts on a local network.





<span class="grey">Gont &amp; Chown                  Informational                    [Page 35]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-36" id="page-36" name="page-36"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   The scan6 tool operates (roughly) as follows:

   1.  The tool learns the local prefixes used for autoconfiguration and
       generates/configures one address for each local prefix (in
       addition to a link-local address).

   2.  An ICMPv6 Echo Request message destined to the all-nodes on-link
       multicast address (ff02::1) is sent from each of the addresses
       "configured" in the previous step.  Because of the different
       source addresses, each probe packet causes the victim nodes to
       use different source addresses for the response packets (this
       allows the tool to learn virtually all the addresses in use in
       the local network segment).

   3.  The same procedure of the previous bullet is performed, but this
       time with ICMPv6 packets that contain an unrecognized option of
       type 10xxxxxx, such that ICMPv6 Parameter Problem error messages
       are elicited.  This allows the tool to discover, e.g., Windows
       nodes, which otherwise do not respond to multicasted ICMPv6 Echo
       Request messages.

   4.  Each time a new "alive" address is discovered, the corresponding
       IID is combined with all the local prefixes, and the resulting
       addresses are probed (with unicasted packets).  This can help to
       discover other addresses in use on the local network segment,
       since the same IID is typically used with all the available
       prefixes for the local network.

   NOTE:
      The aforementioned scheme can fail to discover some addresses for
      some implementations.  For example, Mac OS X employs IPv6
      addresses embedding IEEE identifiers (rather than "temporary
      addresses") when responding to packets destined to a link-local
      multicast address, sourced from an on-link prefix.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.3.%20%20Implementation%20of%20an%20IPv6%20Remote%20Address-Scanning%20Tool"></a><a class="selflink" href="#appendix-A.3" name="appendix-A.3">A.3</a>.  Implementation of an IPv6 Remote Address-Scanning Tool</span>

   An IPv6 remote address-scanning tool could be implemented with the
   following features:

   o  The tool can be instructed to target specific address ranges
      (e.g., 2001:db8::0-10:0-1000).

   o  The tool can be instructed to scan for SLAAC addresses of a
      specific vendor, such that only addresses embedding the
      corresponding IEEE OUIs are probed.





<span class="grey">Gont &amp; Chown                  Informational                    [Page 36]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-37" id="page-37" name="page-37"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   o  The tool can be instructed to scan for SLAAC addresses that employ
      a specific IEEE OUI or set of OUIs corresponding to a specific
      vector.

   o  The tool can be instructed to discover virtual machines, such that
      a given IPv6 prefix is only scanned for the address patterns
      resulting from virtual machines.

   o  The tool can be instructed to scan for low-byte addresses.

   o  The tool can be instructed to scan for wordy addresses, in which
      case the tool selects addresses based on a local dictionary.

   o  The tool can be instructed to scan for IPv6 addresses embedding
      TCP/UDP service ports, in which case the tool selects addresses
      based on a list of well-known service ports.

   o  The tool can be specified to scan an IPv4 address range in use at
      the target network, such that only IPv4-based IPv6 addresses are
      scanned.

   The scan6 tool of [<a href="#ref-IPv6-Toolkit">IPv6-Toolkit</a>] implements all these techniques/
   features.  Furthermore, when given a target domain name or sample
   IPv6 address for a given prefix, the tool will try to infer the
   address pattern in use at the target network, and reduce the address
   search space accordingly.

Acknowledgements

   The authors would like to thank Ray Hunter, who provided valuable
   text that was readily incorporated into <a href="#section-4.2.1">Section 4.2.1</a> of this
   document.

   The authors would like to thank (in alphabetical order) Ivan Arce,
   Alissa Cooper, Spencer Dawkins, Stephen Farrell, Wesley George, Marc
   Heuse, Ray Hunter, Barry Leiba, Libor Polcak, Alvaro Retana, Tomoyuki
   Sahara, Jan Schaumann, Arturo Servin, and Eric Vyncke for providing
   valuable comments on earlier draft versions of this document.

   Fernando Gont would like to thank Jan Zorz of Go6 Lab
   &lt;<a href="http://go6lab.si/">http://go6lab.si/</a>&gt; and Jared Mauch of NTT America for providing
   access to systems and networks that were employed to perform
   experiments and measurements that helped to improve this document.
   Additionally, he would like to thank SixXS &lt;<a href="https://www.sixxs.net/">https://www.sixxs.net</a>&gt;
   for providing IPv6 connectivity.






<span class="grey">Gont &amp; Chown                  Informational                    [Page 37]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-38" id="page-38" name="page-38"> </a>
<span class="grey"><a href="rfc7707.html">RFC 7707</a>                   IPv6 Reconnaissance                March 2016</span>


   Part of the contents of this document are based on the results of the
   project "Security Assessment of the Internet Protocol version 6
   (IPv6)" [<a href="#ref-CPNI-IPv6">CPNI-IPv6</a>], carried out by Fernando Gont on behalf of the UK
   Centre for the Protection of National Infrastructure (CPNI).

   Fernando Gont would like to thank Daniel Bellomo (UNRC) for his
   continued support.

Authors' Addresses

   Fernando Gont
   Huawei Technologies
   Evaristo Carriego 2644
   Haedo, Provincia de Buenos Aires  1706
   Argentina

   Phone: +54 11 4650 8472
   Email: fgont@si6networks.com
   URI:   <a href="http://www.si6networks.com/">http://www.si6networks.com</a>


   Tim Chown
   Jisc
   Lumen House, Library Avenue
   Harwell Oxford, Didcot. OX11 0SG
   United Kingdom

   Email: tim.chown@jisc.ac.uk























Gont &amp; Chown                  Informational                    [Page 38]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7707 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:19 GMT --></html>