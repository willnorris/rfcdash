<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7783 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:20 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-tissa-trill-cmt" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:7783" name="DC.Identifier"/>
<meta content="February, 2016" name="DC.Date.Issued"/>
<meta content="Senevirathne, Tissa" name="DC.Creator"/>
<meta content="Hudson, Jon" name="DC.Creator"/>
<meta content="Pathangi, Janardhanan" name="DC.Creator"/>
<meta content="TRILL (Transparent Interconnection of Lots of Links) facilitates loop-
free connectivity to non-TRILL networks via a choice of an Appointed
Forwarder for a set of VLANs. Appointed Forwarders provide VLAN-based
load sharing with an active-standby model. High-performance
applications require an active-active load-sharing model. The active-
active load-sharing model can be accomplished by representing any
given non-TRILL network with a single virtual RBridge (also referred
to as a virtual Routing Bridge or virtual TRILL switch). Virtual
representation of the non-TRILL network with a single RBridge poses
serious challenges in multi-destination RPF (Reverse Path Forwarding)
check calculations. This document specifies required enhancements to
build Coordinated Multicast Trees (CMT) within the TRILL campus to
solve related RPF issues. CMT, which only requires a software upgrade,
provides flexibility to RBridges in selecting a desired path of
association to a given TRILL multi-destination distribution tree. This
document updates RFC 6325." name="DC.Description.Abstract"/>
<meta content="Coordinated Multicast Trees (CMT) for Transparent Interconnection of Lots of Links (TRILL)" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7783 - Coordinated Multicast Trees (CMT) for Transparent Interconnection of Lots of Links (TRILL)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7783.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7783" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-trill-cmt" title="draft-ietf-trill-cmt">draft-ietf-tril...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7783" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7783" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7783" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                   T. Senevirathne
Request for Comments: 7783                                    Consultant
Updates: <a href="rfc6325.html">6325</a>                                                J. Pathangi
Category: Standards Track                                           Dell
ISSN: 2070-1721                                                J. Hudson
                                                                 Brocade
                                                           February 2016


                   <span class="h1">Coordinated Multicast Trees (CMT)</span>
        <span class="h1">for Transparent Interconnection of Lots of Links (TRILL)</span>

Abstract

   TRILL (Transparent Interconnection of Lots of Links) facilitates
   loop-free connectivity to non-TRILL networks via a choice of an
   Appointed Forwarder for a set of VLANs.  Appointed Forwarders provide
   VLAN-based load sharing with an active-standby model.  High-
   performance applications require an active-active load-sharing model.
   The active-active load-sharing model can be accomplished by
   representing any given non-TRILL network with a single virtual
   RBridge (also referred to as a virtual Routing Bridge or virtual
   TRILL switch).  Virtual representation of the non-TRILL network with
   a single RBridge poses serious challenges in multi-destination RPF
   (Reverse Path Forwarding) check calculations.  This document
   specifies required enhancements to build Coordinated Multicast Trees
   (CMT) within the TRILL campus to solve related RPF issues.  CMT,
   which only requires a software upgrade, provides flexibility to
   RBridges in selecting a desired path of association to a given TRILL
   multi-destination distribution tree.  This document updates <a href="rfc6325.html">RFC 6325</a>.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7783">http://www.rfc-editor.org/info/rfc7783</a>.







<span class="grey">Senevirathne, et al.         Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7783.html">RFC 7783</a>          Coordinated Multicast Trees for TRILL    February 2016</span>


Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Scope and Applicability ....................................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. Conventions Used in This Document ...............................<a href="#page-5">5</a>
      <a href="#section-2.1">2.1</a>. Acronyms and Phrases .......................................<a href="#page-5">5</a>
   <a href="#section-3">3</a>. The Affinity Sub-TLV ............................................<a href="#page-6">6</a>
   <a href="#section-4">4</a>. Multicast Tree Construction and Use of Affinity Sub-TLV .........<a href="#page-6">6</a>
      <a href="#section-4.1">4.1</a>. Update to <a href="rfc6325.html">RFC 6325</a> .........................................<a href="#page-7">7</a>
      <a href="#section-4.2">4.2</a>. Announcing Virtual RBridge Nickname ........................<a href="#page-8">8</a>
      <a href="#section-4.3">4.3</a>. Affinity Sub-TLV Capability ................................<a href="#page-8">8</a>
   <a href="#section-5">5</a>. Theory of Operation .............................................<a href="#page-8">8</a>
      <a href="#section-5.1">5.1</a>. Distribution Tree Assignment ...............................<a href="#page-8">8</a>
      <a href="#section-5.2">5.2</a>. Affinity Sub-TLV Advertisement .............................<a href="#page-9">9</a>
      <a href="#section-5.3">5.3</a>. Affinity Sub-TLV Conflict Resolution .......................<a href="#page-9">9</a>
      <a href="#section-5.4">5.4</a>. Ingress Multi-Destination Forwarding ......................<a href="#page-10">10</a>
           <a href="#section-5.4.1">5.4.1</a>. Forwarding when n &lt; k ..............................<a href="#page-10">10</a>
      <a href="#section-5.5">5.5</a>. Egress Multi-Destination Forwarding .......................<a href="#page-11">11</a>
           <a href="#section-5.5.1">5.5.1</a>. Traffic Arriving on an Assigned Tree to RBk-RBv ....<a href="#page-11">11</a>
           <a href="#section-5.5.2">5.5.2</a>. Traffic Arriving on Other Trees ....................<a href="#page-11">11</a>
      <a href="#section-5.6">5.6</a>. Failure Scenarios .........................................<a href="#page-11">11</a>
           <a href="#section-5.6.1">5.6.1</a>. Edge RBridge RBk Failure ...........................<a href="#page-11">11</a>
      <a href="#section-5.7">5.7</a>. Backward Compatibility ....................................<a href="#page-12">12</a>
   <a href="#section-6">6</a>. Security Considerations ........................................<a href="#page-13">13</a>
   <a href="#section-7">7</a>. IANA Considerations ............................................<a href="#page-13">13</a>
   <a href="#section-8">8</a>. References .....................................................<a href="#page-14">14</a>
      <a href="#section-8.1">8.1</a>. Normative References ......................................<a href="#page-14">14</a>
      <a href="#section-8.2">8.2</a>. Informative References ....................................<a href="#page-15">15</a>
   Acknowledgments ...................................................<a href="#page-16">16</a>
   Contributors ......................................................<a href="#page-16">16</a>
   Authors' Addresses ................................................<a href="#page-16">16</a>





<span class="grey">Senevirathne, et al.         Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7783.html">RFC 7783</a>          Coordinated Multicast Trees for TRILL    February 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   TRILL (Transparent Interconnection of Lots of Links), as presented in
   [<a href="rfc6325.html" title='"Routing Bridges (RBridges): Base Protocol Specification"'>RFC6325</a>] and other related documents, provides methods of utilizing
   all available paths for active forwarding, with minimum
   configuration.  TRILL utilizes IS-IS (Intermediate System to
   Intermediate System) [<a href="#ref-IS-IS" title='"Information technology -- Telecommunications and information exchange between systems -- Intermediate System to Intermediate System intra-domain routeing information exchange protocol for use in conjunction with the protocol for providing the connectionless-mode network service (ISO 8473)"'>IS-IS</a>] as its control plane and uses a TRILL
   Header that includes a Hop Count.

   [<a href="rfc6325.html" title='"Routing Bridges (RBridges): Base Protocol Specification"'>RFC6325</a>], [<a href="rfc7177.html" title='"Transparent Interconnection of Lots of Links (TRILL): Adjacency"'>RFC7177</a>], and [<a href="rfc6439.html" title='"Routing Bridges (RBridges): Appointed Forwarders"'>RFC6439</a>] provide methods for
   interoperability between TRILL and Ethernet end stations and bridged
   networks.  [<a href="rfc6439.html" title='"Routing Bridges (RBridges): Appointed Forwarders"'>RFC6439</a>] provides an active-standby solution, where only
   one of the RBridges (aka Routing Bridges or TRILL switches) on a link
   with end stations is in the active forwarding state for end-station
   traffic for any given VLAN.  That RBridge is referred to as the
   Appointed Forwarder (AF).  All frames ingressed into a TRILL network
   via the AF are encapsulated with the TRILL Header with a nickname
   held by the ingress AF RBridge.  Due to failures, reconfigurations,
   and other network dynamics, the AF for any set of VLANs may change.
   RBridges maintain forwarding tables that contain bindings for
   destination Media Access Control (MAC) addresses and Data Labels
   (VLAN or Fine-Grained Labels (FGLs)) to egress RBridges.  In the
   event of an AF change, forwarding tables of remote RBridges may
   continue to forward traffic to the previous AF.  That traffic may get
   discarded at the egress, causing traffic disruption.

   High-performance applications require resiliency during failover.
   The active-active forwarding model minimizes impact during failures
   and maximizes the available network bandwidth.  A typical deployment
   scenario, depicted in Figure 1, may have end stations and/or bridges
   attached to the RBridges.  These devices typically are multi-homed to
   several RBridges and treat all of the uplinks independently using a
   Local Active-Active Link Protocol (LAALP) [<a href="rfc7379.html" title='"Problem Statement and Goals for Active-Active Connection at the Transparent Interconnection of Lots of Links (TRILL) Edge"'>RFC7379</a>], such as a single
   Multi-Chassis Link Aggregation (MC-LAG) bundle or Distributed
   Resilient Network Interconnect [<a href="#ref-802.1AX" title='"IEEE Standard for Local and metropolitan area networks - Link Aggregation"'>802.1AX</a>].  The AF designation
   presented in [<a href="rfc6439.html" title='"Routing Bridges (RBridges): Appointed Forwarders"'>RFC6439</a>] requires each of the edge RBridges to exchange
   TRILL Hello packets.  By design, an LAALP does not forward packets
   received on one of the member ports of the MC-LAG to other member
   ports of the same MC-LAG.  As a result, the AF designation methods
   presented in [<a href="rfc6439.html" title='"Routing Bridges (RBridges): Appointed Forwarders"'>RFC6439</a>] cannot be applied to the deployment scenario
   depicted in Figure 1.

   An active-active load-sharing model can be implemented by
   representing the edge of the network connected to a specific edge
   group of RBridges by a single virtual RBridge.  Each virtual RBridge
   MUST have a nickname unique within its TRILL campus.  In addition to
   an active-active forwarding model, there may be other applications
   that may require similar representations.



<span class="grey">Senevirathne, et al.         Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7783.html">RFC 7783</a>          Coordinated Multicast Trees for TRILL    February 2016</span>


   Sections <a href="#section-4.5.1">4.5.1</a> and <a href="#section-4.5.2">4.5.2</a> of [<a href="rfc6325.html" title='"Routing Bridges (RBridges): Base Protocol Specification"'>RFC6325</a>], as updated by [<a href="rfc7780.html" title='"Transparent Interconnection of Lots of Links (TRILL): Clarifications, Corrections, and Updates"'>RFC7780</a>],
   specify distribution tree calculation and RPF (Reverse Path
   Forwarding) check calculation algorithms for multi-destination
   forwarding.  These algorithms strictly depend on link cost and parent
   RBridge priority.  As a result, based on the network topology, it may
   be possible that a given edge RBridge, if it is forwarding on behalf
   of the virtual RBridge, may not have a candidate multicast tree on
   which it (the edge RBridge) can forward traffic, because there is no
   tree for which the virtual RBridge is a leaf node from the edge
   RBridge.

   In this document, we present a method that allows RBridges to specify
   the path of association for real or virtual child nodes to
   distribution trees.  Remote RBridges calculate their forwarding
   tables and derive the RPF for distribution trees based on the
   distribution tree association advertisements.  In the absence of
   distribution tree association advertisements, remote RBridges derive
   the SPF (Shortest Path First) based on the algorithm specified in
   <a href="rfc6325.html#section-4.5.1">Section 4.5.1 of [RFC6325]</a>, as updated by [<a href="rfc7780.html" title='"Transparent Interconnection of Lots of Links (TRILL): Clarifications, Corrections, and Updates"'>RFC7780</a>].  This document
   updates [<a href="rfc6325.html" title='"Routing Bridges (RBridges): Base Protocol Specification"'>RFC6325</a>] by changing, when Coordinated Multicast Trees (CMT)
   sub-TLVs are present, [<a href="rfc6325.html" title='"Routing Bridges (RBridges): Base Protocol Specification"'>RFC6325</a>] mandatory provisions as to how
   distribution trees are constructed.

   In addition to the above-mentioned active-active forwarding model,
   other applications may utilize the distribution tree association
   framework presented in this document to associate to distribution
   trees through a preferred path.

   This proposal requires (1) the presence of multiple multi-destination
   trees within the TRILL campus and (2) that all the RBridges in the
   network be updated to support the new Affinity sub-TLV (<a href="#section-3">Section 3</a>).
   It is expected that both of these requirements will be met, as they
   are control-plane changes and will be common deployment scenarios.
   In case either of the above two conditions is not met, RBridges MUST
   support a fallback option for interoperability.  Since the fallback
   is expected to be a temporary phenomenon until all RBridges are
   upgraded, this proposal gives guidelines for such fallbacks and does
   not mandate or specify any specific set of fallback options.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Scope%20and%20Applicability"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Scope and Applicability</span>

   This document specifies an Affinity sub-TLV to solve RPF issues at
   the active-active edge.  Specific methods in this document for making
   use of the Affinity sub-TLV are applicable where a virtual RBridge is
   used to represent multiple RBridges connected to an edge Customer
   Equipment (CE) device through an LAALP, such as MC-LAG or some
   similar arrangement where the RBridges cannot see each other's
   Hellos.



<span class="grey">Senevirathne, et al.         Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7783.html">RFC 7783</a>          Coordinated Multicast Trees for TRILL    February 2016</span>


   This document does not provide other required operational elements to
   implement an active-active edge solution, such as MC-LAG methods.
   Solution-specific operational elements are outside the scope of this
   document and will be covered in other documents.  (See, for example,
   [<a href="rfc7781.html" title='"Transparent Interconnection of Lots of Links (TRILL): Pseudo-Nickname for Active-Active Access"'>RFC7781</a>].)

   Examples provided in this document are for illustration purposes
   only.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

   In this document, these words will appear with that interpretation
   only when in ALL CAPS.  Lowercase uses of these words are not to be
   interpreted as carrying [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>] significance.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Acronyms%20and%20Phrases"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Acronyms and Phrases</span>

   The following acronyms and phrases are used in this document:

   AF: Appointed Forwarder [<a href="rfc6439.html" title='"Routing Bridges (RBridges): Appointed Forwarders"'>RFC6439</a>].

   CE: Customer Equipment device, that is, a device that performs
      forwarding based on 802.1Q bridging.  This also can be an
      end station or a server.

   Data Label: VLAN or FGL.

   FGL: Fine-Grained Label [<a href="rfc7172.html" title='"Transparent Interconnection of Lots of Links (TRILL): Fine-Grained Labeling"'>RFC7172</a>].

   LAALP: Local Active-Active Link Protocol [<a href="rfc7379.html" title='"Problem Statement and Goals for Active-Active Connection at the Transparent Interconnection of Lots of Links (TRILL) Edge"'>RFC7379</a>].

   MC-LAG: Multi-Chassis Link Aggregation.  A proprietary extension to
      [<a href="#ref-802.1AX" title='"IEEE Standard for Local and metropolitan area networks - Link Aggregation"'>802.1AX</a>] that facilitates connecting a group of links from an
      originating device (A) to a group of discrete devices (B).
      Device (A) treats all of the links in a given MC-LAG bundle as a
      single logical interface and treats all devices in Group (B) as a
      single logical device for all forwarding purposes.  Device (A)
      does not forward packets received on the multi-chassis link bundle
      out of the same multi-chassis link bundle.  Figure 1 depicts a
      specific use case example.







<span class="grey">Senevirathne, et al.         Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7783.html">RFC 7783</a>          Coordinated Multicast Trees for TRILL    February 2016</span>


   RPF: Reverse Path Forwarding.  See <a href="rfc6325.html#section-4.5.2">Section 4.5.2 of [RFC6325]</a>.

   Virtual RBridge: A purely conceptual RBridge that represents an
      active-active edge group and is in turn represented by a nickname.
      For example, see [<a href="rfc7781.html" title='"Transparent Interconnection of Lots of Links (TRILL): Pseudo-Nickname for Active-Active Access"'>RFC7781</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20The%20Affinity%20Sub-TLV"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  The Affinity Sub-TLV</span>

   Association of an RBridge to a multi-destination distribution tree
   through a specific path is accomplished by using a new IS-IS sub-TLV,
   the Affinity sub-TLV.

   The Affinity sub-TLV appears in Router Capability TLVs or
   MT Capability TLVs that are within Link State PDUs (LSPs), as
   described in [<a href="rfc7176.html" title='"Transparent Interconnection of Lots of Links (TRILL) Use of IS-IS"'>RFC7176</a>].  [<a href="rfc7176.html" title='"Transparent Interconnection of Lots of Links (TRILL) Use of IS-IS"'>RFC7176</a>] specifies the code point and data
   structure for the Affinity sub-TLV.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Multicast%20Tree%20Construction%20and%20Use%20of%20Affinity%20Sub-TLV"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Multicast Tree Construction and Use of Affinity Sub-TLV</span>

   Figures 1 and 2 below show the reference topology and a logical
   topology using CMT to provide active-active service.

                        --------------------
                       /                    \
                      |                      |
                      |     TRILL Campus     |
                      |                      |
                       \                    /
                        --------------------
                           |       |    |
                      -----        |     --------
                     |             |             |
                 +------+      +------+      +------+
                 |      |      |      |      |      |
                 |(RB1) |      |(RB2) |      | (RBk)|
                 +------+      +------+      +------+
                   |..|          |..|          |..|
                   |  +----+     |  |          |  |
                   |   +---|-----|--|----------+  |
                   | +-|---|-----+  +-----------+ |
                   | | |   +------------------+ | |
                  (| | |)  &lt;-- MC-LAG          (| | |) &lt;-- MC-LAG
                 +-------+    .  .  .       +-------+
                 | CE1   |                  | CEn   |
                 |       |                  |       |
                 +-------+                  +-------+

                       Figure 1: Reference Topology



<span class="grey">Senevirathne, et al.         Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7783.html">RFC 7783</a>          Coordinated Multicast Trees for TRILL    February 2016</span>


             --------------------           Sample Multicast Tree (T1)
            /                    \
           |                      |                  |
           |     TRILL Campus     |                  o RBn
           |                      |                / | \
            \                    /                /  |  ---\
             --------------------             RB1 o  o      o
                |       |    |                    |   RB2    RBk
                |       |    --------------       |
                |       |                  |      o RBv
              +------+ +------+          +------+
              |      | |      |          |      |
              |(RB1) | |(RB2) |          | (RBk)|
              +------+ +------+          +------+
                |..|       |..|             |..|
                |  +----+  |  |             |  |
                |   +---|--|--|-------------+  |
                | +-|---|--+  +--------------+ |
                | | |   +------------------+ | |
     MC-LAG --&gt;(| | |)                    (| | |)&lt;-- MC-LAG
               +-------+    .  .  .       +-------+
               | CE1   |                  | CEn   |
               |       |                  |       |
               +-------+                  +-------+

        RBv: virtual RBridge

                    Figure 2: Example Logical Topology

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Update%20to%20RFC%206325"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Update to <a href="rfc6325.html">RFC 6325</a></span>

   This document updates <a href="rfc6325.html#section-4.5.1">Section 4.5.1 of [RFC6325]</a> and changes the
   calculation of distribution trees, as specified below:

   Each RBridge that desires to be the parent RBridge for a child
   RBridge (RBy) in a multi-destination distribution tree (Tree x)
   announces the desired association using an Affinity sub-TLV.  The
   child is specified by its nickname.  If an RBridge (RB1) advertises
   an Affinity sub-TLV designating one of its own nicknames (N1) as its
   "child" in some distribution tree, the effect is that nickname N1 is
   ignored when constructing other distribution trees.  Thus, the
   RPF check will enforce the rule that only RB1 can use nickname N1 to
   do ingress/egress on Tree x.  (This has no effect on least-cost path
   calculations for unicast traffic.)

   When such an Affinity sub-TLV is present, the association specified
   by the Affinity sub-TLV MUST be used when constructing the
   multi-destination distribution tree, except in the case of a



<span class="grey">Senevirathne, et al.         Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7783.html">RFC 7783</a>          Coordinated Multicast Trees for TRILL    February 2016</span>


   conflicting Affinity sub-TLV; such cases are resolved as specified in
   <a href="#section-5.3">Section 5.3</a>.  In the absence of such an Affinity sub-TLV, or if there
   are any RBridges in the campus that do not support the Affinity
   sub-TLV, distribution trees are calculated as specified in
   <a href="rfc6325.html#section-4.5.1">Section 4.5.1 of [RFC6325]</a>, as updated by [<a href="rfc7780.html" title='"Transparent Interconnection of Lots of Links (TRILL): Clarifications, Corrections, and Updates"'>RFC7780</a>].  <a href="#section-4.3">Section 4.3</a>
   below specifies how to identify RBridges that support the Affinity
   sub-TLV.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Announcing%20Virtual%20RBridge%20Nickname"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Announcing Virtual RBridge Nickname</span>

   Each edge RBridge (RB1 to RBk) advertises its LSP virtual RBridge
   nickname (RBv) by using the Nickname sub-TLV (6) [<a href="rfc7176.html" title='"Transparent Interconnection of Lots of Links (TRILL) Use of IS-IS"'>RFC7176</a>], along
   with their regular nickname or nicknames.

   It will be possible for any RBridge to determine that RBv is a
   virtual RBridge, because each RBridge (RB1 to RBk) that appears to be
   advertising that it is holding RBv is also advertising an Affinity
   sub-TLV asking that RBv be its child in one or more trees.

   Virtual RBridges are ignored when determining the distribution tree
   roots for the campus.

   All RBridges outside the edge group assume that multi-destination
   packets with their TRILL Header Ingress Nickname field set to RBv
   might use any of the distribution trees that any member of the edge
   group advertises that it might use.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Affinity%20Sub-TLV%20Capability"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Affinity Sub-TLV Capability</span>

   RBridges that announce the TRILL Version sub-TLV [<a href="rfc7176.html" title='"Transparent Interconnection of Lots of Links (TRILL) Use of IS-IS"'>RFC7176</a>] and set
   the Affinity capability bit (<a href="#section-7">Section 7</a>) support the Affinity sub-TLV,
   calculation of multi-destination distribution trees, and RPF checks,
   as specified herein.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Theory%20of%20Operation"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Theory of Operation</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Distribution%20Tree%20Assignment"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Distribution Tree Assignment</span>

   Let's assume that there are n distribution trees and k edge RBridges
   in the edge group of interest.

   If n &gt;= k

      Let's assume that edge RBridges are sorted in numerically
      ascending order by IS-IS System ID such that RB1 &lt; RB2 &lt; RBk.
      Each RBridge in the numerically sorted list is assigned a
      monotonically increasing number j such that RB1 = 0, RB2 = 1,




<span class="grey">Senevirathne, et al.         Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7783.html">RFC 7783</a>          Coordinated Multicast Trees for TRILL    February 2016</span>


      RBi = j, and RBi + 1 = j + 1.  (See <a href="rfc6325.html#section-4.5">Section 4.5 of [RFC6325]</a>, as
      updated by <a href="rfc7780.html#section-3.4">Section 3.4 of [RFC7780]</a>, for how tree numbers are
      determined.)

      Assign each tree to RBi such that tree number
      (((tree_number) % k) + 1) is assigned to edge group RBridge i for
      tree_number from 1 to n, where n is the number of trees, k is the
      number of edge group RBridges considered for tree allocation, and
      "%" is the integer division remainder operation.

   If n &lt; k

      Distribution trees are assigned to edge group RBridges RB1 to RBn,
      using the same algorithm as the n &gt;= k case.  RBridges RBn + 1 to
      RBk do not participate in the active-active forwarding process on
      behalf of RBv.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Affinity%20Sub-TLV%20Advertisement"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Affinity Sub-TLV Advertisement</span>

   Each RBridge in the RB1 through RBk domain advertises an Affinity
   sub-TLV for RBv to be its child.

   As an example, let's assume that RB1 has chosen Trees t1 and tk + 1
   on behalf of RBv.

   RB1 advertises the Affinity sub-TLV;
   {RBv, Num of Trees = 2, t1, tk + 1}.

   Other RBridges in the RB1 through RBk edge group follow the same
   procedure.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Affinity%20Sub-TLV%20Conflict%20Resolution"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Affinity Sub-TLV Conflict Resolution</span>

   In TRILL, multi-destination distribution trees are built outward from
   the root by each RBridge so that they all derive the same set of
   distribution trees [<a href="rfc6325.html" title='"Routing Bridges (RBridges): Base Protocol Specification"'>RFC6325</a>].

   If RBridge RB1 advertises an Affinity sub-TLV with an AFFINITY RECORD
   that asks for RBridge RBroot to be its child in a tree rooted at
   RBroot, that AFFINITY RECORD is in conflict with TRILL distribution
   tree root determination and MUST be ignored.

   If RBridge RB1 advertises an Affinity sub-TLV with an AFFINITY RECORD
   that asks for nickname RBn to be its child in any tree and RB1 is not
   adjacent to RBn nor does nickname RBn identify RB1 itself, that
   AFFINITY RECORD is in conflict with the campus topology and MUST be
   ignored.




<span class="grey">Senevirathne, et al.         Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7783.html">RFC 7783</a>          Coordinated Multicast Trees for TRILL    February 2016</span>


   If different RBridges advertise Affinity sub-TLVs that try to
   associate the same virtual RBridge as their child in the same tree or
   trees, those Affinity sub-TLVs are in conflict with each other for
   those trees.  The nicknames of the conflicting RBridges are compared
   to identify which RBridge holds the nickname that is the highest
   priority to be a tree root, with the System ID as the tiebreaker.

   The RBridge with the highest priority to be a tree root will retain
   the Affinity association.  Other RBridges with lower priority to be a
   tree root MUST stop advertising their conflicting Affinity sub-TLVs,
   recalculate the multicast tree affinity allocation, and, if
   appropriate, advertise new non-conflicting Affinity sub-TLVs.

   Similarly, remote RBridges MUST honor the Affinity sub-TLV from the
   RBridge with the highest priority to be a tree root (using System ID
   as the tiebreaker in the event of conflicting priorities) and ignore
   the conflicting Affinity sub-TLV entries advertised by the RBridges
   with lower priorities to be tree roots.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20Ingress%20Multi-Destination%20Forwarding"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  Ingress Multi-Destination Forwarding</span>

   If there is at least one tree on which RBv has affinity via RBk, then
   RBk performs the following operations for multi-destination frames
   received from a CE node:

   1. Flood to locally attached CE nodes subjected to VLAN and multicast
      pruning.

   2. Ingress (by encapsulating with a TRILL Header) and set the Ingress
      Nickname field of the TRILL Header to RBv (the nickname of the
      virtual RBridge).

   3. Forward to one of the distribution trees, Tree x, in which RBv is
      associated with RBk.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.4.1.%20%20Forwarding%20when%20n%20%3C%20k"></a><a class="selflink" href="#section-5.4.1" name="section-5.4.1">5.4.1</a>.  Forwarding when n &lt; k</span>

   If there is no tree on which RBv can claim affinity via RBk (probably
   because the number of trees (n) built is less than the number of
   RBridges (k) announcing the Affinity sub-TLV), then RBk MUST fall
   back to one of the following:

   1. This RBridge (RBk) should stop forwarding frames from the CE nodes
      and should mark its port towards those CE nodes as disabled.  This
      will prevent the CE nodes from forwarding data to this RBridge.
      Thus, the CE nodes will only use those RBridges that have been
      assigned a tree.




<span class="grey">Senevirathne, et al.         Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7783.html">RFC 7783</a>          Coordinated Multicast Trees for TRILL    February 2016</span>


      -OR-

   2. This RBridge tunnels multi-destination frames received from
      attached native devices to an RBridge RBy that has an assigned
      tree.  The tunnel destination should forward it to the TRILL
      network and also to its local access links.  (The mechanism of
      tunneling and handshaking between the tunnel source and
      destination are out of scope for this specification and may be
      addressed in other documents, such as [<a href="#ref-ChannelTunnel">ChannelTunnel</a>].)

   The above fallback options may be specific to the active-active
   forwarding scenario.  However, as stated above, the Affinity sub-TLV
   may be used in other applications.  In such an event, the application
   SHOULD specify applicable fallback options.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.5.%20%20Egress%20Multi-Destination%20Forwarding"></a><a class="selflink" href="#section-5.5" name="section-5.5">5.5</a>.  Egress Multi-Destination Forwarding</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.5.1.%20%20Traffic%20Arriving%20on%20an%20Assigned%20Tree%20to%20RBk-RBv"></a><a class="selflink" href="#section-5.5.1" name="section-5.5.1">5.5.1</a>.  Traffic Arriving on an Assigned Tree to RBk-RBv</span>

   Multi-destination frames arriving at RBk on a Tree x, where RBk has
   announced the affinity of RBv via x, MUST be forwarded to CE members
   of RBv that are in the frame's VLAN.  Forwarding to other end nodes
   and RBridges that are not part of the network represented by the
   virtual RBridge nickname (RBv) MUST follow the forwarding rules
   specified in [<a href="rfc6325.html" title='"Routing Bridges (RBridges): Base Protocol Specification"'>RFC6325</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.5.2.%20%20Traffic%20Arriving%20on%20Other%20Trees"></a><a class="selflink" href="#section-5.5.2" name="section-5.5.2">5.5.2</a>.  Traffic Arriving on Other Trees</span>

   Multi-destination frames arriving at RBk on a Tree y, where RBk has
   not announced the affinity of RBv via y, MUST NOT be forwarded to CE
   members of RBv.  Forwarding to other end nodes and RBridges that are
   not part of the network represented by the virtual RBridge nickname
   (RBv) MUST follow the forwarding rules specified in [<a href="rfc6325.html" title='"Routing Bridges (RBridges): Base Protocol Specification"'>RFC6325</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.6.%20%20Failure%20Scenarios"></a><a class="selflink" href="#section-5.6" name="section-5.6">5.6</a>.  Failure Scenarios</span>

   The failure recovery algorithm below is presented only as a
   guideline.  An active-active edge group MAY use other failure
   recovery algorithms; it is recommended that only one algorithm be
   used in an edge group at a time.  Details of such algorithms are
   outside the scope of this document.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.6.1.%20%20Edge%20RBridge%20RBk%20Failure"></a><a class="selflink" href="#section-5.6.1" name="section-5.6.1">5.6.1</a>.  Edge RBridge RBk Failure</span>

   Each of the member RBridges of a given virtual RBridge edge group is
   aware of its member RBridges through configuration, LSP
   advertisements, or some other method.




<span class="grey">Senevirathne, et al.         Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7783.html">RFC 7783</a>          Coordinated Multicast Trees for TRILL    February 2016</span>


   Member RBridges detect nodal failure of a member RBridge through
   IS-IS LSP advertisements or lack thereof.

   Upon detecting a member failure, each of the member RBridges of the
   RBv edge group start recovery timer T_rec for failed RBridge RBi.  If
   the previously failed RBridge RBi has not recovered after the expiry
   of timer T_rec, member RBridges perform the distribution tree
   assignment algorithm specified in <a href="#section-5.1">Section 5.1</a>.  Each of the member
   RBridges re-advertises the Affinity sub-TLV with the new tree
   assignment.  This action causes the campus to update the tree
   calculation with the new assignment.

   RBi, upon startup, advertises its presence through IS-IS LSPs and
   starts a timer T_i.  Other member RBridges of the edge group,
   detecting the presence of RBi, start a timer T_j.

   Upon expiry of timer T_j, other member RBridges recalculate the
   multi-destination tree assignment and advertise the related trees
   using the Affinity sub-TLV.  Upon expiry of timer T_i, RBi
   recalculates the multi-destination tree assignment and advertises the
   related trees using the Affinity sub-TLV.

   If the new RBridge in the edge group calculates trees and starts to
   use one or more of them before the existing RBridges in the edge
   group recalculate, there could be duplication of packets (for
   example, more than one edge group RBridge could decapsulate and
   forward a multi-destination frame on links into the active-active
   group) or loss of packets (for example, due to the Reverse Path
   Forwarding check, in the rest of the campus, if two edge group
   RBridges are trying to forward on the same tree, those from one will
   be discarded).  Alternatively, if the new RBridge in the edge group
   calculates trees and starts to use one or more of them after the
   existing RBridges recalculate, there could be loss of data due to
   frames arriving at the new RBridge being black-holed.  Timers T_i and
   T_j should be initialized to values designed to minimize these
   problems, keeping in mind that, in general, duplication of packets is
   a more serious problem than dropped packets.  It is RECOMMENDED that
   T_j be less than T_i, and a reasonable default is 1/2 of T_i.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.7.%20%20Backward%20Compatibility"></a><a class="selflink" href="#section-5.7" name="section-5.7">5.7</a>.  Backward Compatibility</span>

   Implementations MUST support a backward compatibility modes to
   interoperate with "pre-Affinity sub-TLV" RBridges in the network.
   Such backward compatibility operations MAY include, but are not
   limited to, tunneling and/or active-standby modes of operation.  It
   should be noted that tunneling would require silicon changes.
   However, CMT in itself is a software upgrade.




<span class="grey">Senevirathne, et al.         Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc7783.html">RFC 7783</a>          Coordinated Multicast Trees for TRILL    February 2016</span>


   Example:

   Step 1. Stop using the virtual RBridge nickname for traffic
      ingressing from CE nodes.

   Step 2. Stop performing active-active forwarding.  Fall back to
      active standby forwarding, based on locally defined policies.  The
      definition of such policies is outside the scope of this document
      and may be addressed in other documents.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Security Considerations</span>

   In general, the RBridges in a campus are trusted routers, and the
   authenticity of their link-state information (LSPs) and link-local
   PDUs (e.g., Hellos) can be enforced using regular IS-IS security
   mechanisms [<a href="#ref-IS-IS" title='"Information technology -- Telecommunications and information exchange between systems -- Intermediate System to Intermediate System intra-domain routeing information exchange protocol for use in conjunction with the protocol for providing the connectionless-mode network service (ISO 8473)"'>IS-IS</a>] [<a href="rfc5310.html" title='"IS-IS Generic Cryptographic Authentication"'>RFC5310</a>].  This includes authenticating the
   contents of the PDUs used to transport Affinity sub-TLVs.

   The particular security considerations involved with different
   applications of the Affinity sub-TLV will be covered in the
   document(s) specifying those applications.

   For general TRILL security considerations, see [<a href="rfc6325.html" title='"Routing Bridges (RBridges): Base Protocol Specification"'>RFC6325</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  IANA Considerations</span>

   This document serves as the reference for the registration of
   "Affinity sub-TLV support" (bit 0) in the "TRILL-VER Sub-TLV
   Capability Flags" registry.

   This document mentions the registration of "AFFINITY" (value 17) in
   the "Sub-TLVs for TLV 144" registry, but it is intentionally not
   listed as a reference for that registration; the reference remains
   [<a href="rfc7176.html" title='"Transparent Interconnection of Lots of Links (TRILL) Use of IS-IS"'>RFC7176</a>].

















<span class="grey">Senevirathne, et al.         Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc7783.html">RFC 7783</a>          Coordinated Multicast Trees for TRILL    February 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20References"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Normative%20References"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Normative References</span>

   [<a id="ref-IS-IS" name="ref-IS-IS">IS-IS</a>]    International Organization for Standardization,
              "Information technology -- Telecommunications and
              information exchange between systems -- Intermediate
              System to Intermediate System intra-domain routeing
              information exchange protocol for use in conjunction with
              the protocol for providing the connectionless-mode network
              service (ISO 8473)", ISO/IEC 10589:2002, Second Edition,
              November 2002.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC5310" name="ref-RFC5310">RFC5310</a>]  Bhatia, M., Manral, V., Li, T., Atkinson, R., White, R.,
              and M. Fanto, "IS-IS Generic Cryptographic
              Authentication", <a href="rfc5310.html">RFC 5310</a>, DOI 10.17487/RFC5310,
              February 2009, &lt;<a href="http://www.rfc-editor.org/info/rfc5310">http://www.rfc-editor.org/info/rfc5310</a>&gt;.

   [<a id="ref-RFC6325" name="ref-RFC6325">RFC6325</a>]  Perlman, R., Eastlake 3rd, D., Dutt, D., Gai, S., and A.
              Ghanwani, "Routing Bridges (RBridges): Base Protocol
              Specification", <a href="rfc6325.html">RFC 6325</a>, DOI 10.17487/RFC6325, July 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6325">http://www.rfc-editor.org/info/rfc6325</a>&gt;.

   [<a id="ref-RFC6439" name="ref-RFC6439">RFC6439</a>]  Perlman, R., Eastlake, D., Li, Y., Banerjee, A., and F.
              Hu, "Routing Bridges (RBridges): Appointed Forwarders",
              <a href="rfc6439.html">RFC 6439</a>, DOI 10.17487/RFC6439, November 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6439">http://www.rfc-editor.org/info/rfc6439</a>&gt;.

   [<a id="ref-RFC7172" name="ref-RFC7172">RFC7172</a>]  Eastlake 3rd, D., Zhang, M., Agarwal, P., Perlman, R., and
              D. Dutt, "Transparent Interconnection of Lots of Links
              (TRILL): Fine-Grained Labeling", <a href="rfc7172.html">RFC 7172</a>,
              DOI 10.17487/RFC7172, May 2014,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7172">http://www.rfc-editor.org/info/rfc7172</a>&gt;.

   [<a id="ref-RFC7176" name="ref-RFC7176">RFC7176</a>]  Eastlake 3rd, D., Senevirathne, T., Ghanwani, A., Dutt,
              D., and A. Banerjee, "Transparent Interconnection of Lots
              of Links (TRILL) Use of IS-IS", <a href="rfc7176.html">RFC 7176</a>,
              DOI 10.17487/RFC7176, May 2014,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7176">http://www.rfc-editor.org/info/rfc7176</a>&gt;.







<span class="grey">Senevirathne, et al.         Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc7783.html">RFC 7783</a>          Coordinated Multicast Trees for TRILL    February 2016</span>


   [<a id="ref-RFC7177" name="ref-RFC7177">RFC7177</a>]  Eastlake 3rd, D., Perlman, R., Ghanwani, A., Yang, H., and
              V. Manral, "Transparent Interconnection of Lots of Links
              (TRILL): Adjacency", <a href="rfc7177.html">RFC 7177</a>, DOI 10.17487/RFC7177,
              May 2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7177">http://www.rfc-editor.org/info/rfc7177</a>&gt;.

   [<a id="ref-RFC7780" name="ref-RFC7780">RFC7780</a>]  Eastlake 3rd, D., Zhang, M., Perlman, R., Banerjee, A.,
              Ghanwani, A., and S. Gupta, "Transparent Interconnection
              of Lots of Links (TRILL): Clarifications, Corrections, and
              Updates", <a href="rfc7780.html">RFC 7780</a>, DOI 10.17487/RFC7780, February 2016,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7780">http://www.rfc-editor.org/info/rfc7780</a>&gt;.

   [<a id="ref-RFC7781" name="ref-RFC7781">RFC7781</a>]  Zhai, H., Senevirathne, T., Perlman, R., Zhang, M., and Y.
              Li, "Transparent Interconnection of Lots of Links (TRILL):
              Pseudo-Nickname for Active-Active Access", <a href="rfc7781.html">RFC 7781</a>,
              DOI 10.17487/RFC7781, February 2016,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7781">http://www.rfc-editor.org/info/rfc7781</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Informative%20References"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Informative References</span>

   [<a id="ref-802.1AX" name="ref-802.1AX">802.1AX</a>]  IEEE, "IEEE Standard for Local and metropolitan area
              networks - Link Aggregation", IEEE Std 802.1AX-2014,
              DOI 10.1109/IEEESTD.2014.7055197, December 2014.

   [<a id="ref-ChannelTunnel" name="ref-ChannelTunnel">ChannelTunnel</a>]
              Eastlake 3rd, D., Umair, M., and Y. Li, "TRILL: RBridge
              Channel Tunnel Protocol", Work in Progress,
              <a href="https://tools.ietf.org/html/draft-ietf-trill-channel-tunnel-07">draft-ietf-trill-channel-tunnel-07</a>, August 2015.

   [<a id="ref-RFC7379" name="ref-RFC7379">RFC7379</a>]  Li, Y., Hao, W., Perlman, R., Hudson, J., and H. Zhai,
              "Problem Statement and Goals for Active-Active Connection
              at the Transparent Interconnection of Lots of Links
              (TRILL) Edge", <a href="rfc7379.html">RFC 7379</a>, DOI 10.17487/RFC7379,
              October 2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7379">http://www.rfc-editor.org/info/rfc7379</a>&gt;.


















<span class="grey">Senevirathne, et al.         Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc7783.html">RFC 7783</a>          Coordinated Multicast Trees for TRILL    February 2016</span>


Acknowledgments

   The authors wish to extend their appreciations towards individuals
   who volunteered to review and comment on the work presented in this
   document and who provided constructive and critical feedback.
   Specific acknowledgments are due for Anoop Ghanwani, Ronak Desai,
   Gayle Noble, and Varun Shah.  Very special thanks to Donald Eastlake
   for his careful review and constructive comments.

Contributors

   The work in this document is a result of many passionate discussions
   and contributions from the following individuals, listed in
   alphabetical order by their first names:

   Ayan Banerjee, Dinesh Dutt, Donald Eastlake, Hongjun Zhai, Mingui
   Zhang, Radia Perlman, Sam Aldrin, and Shivakumar Sundaram.

Authors' Addresses

   Tissa Senevirathne
   Consultant

   Email: tsenevir@gmail.com


   Janardhanan Pathangi
   Dell/Force10 Networks
   Olympia Technology Park
   Guindy Chennai  600 032
   India

   Phone: +91-44-42208400
   Email: Pathangi_Janardhanan@Dell.com


   Jon Hudson
   Brocade
   130 Holger Way
   San Jose, CA  95134
   United States

   Phone: +1-408-333-4062
   Email: jon.hudson@gmail.com







Senevirathne, et al.         Standards Track                   [Page 16]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7783 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:20 GMT --></html>