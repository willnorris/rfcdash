<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc4853 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:39 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:4853" name="DC.Identifier"/>
<meta content="This document updates the Cryptographic Message Syntax (CMS), which is
published in RFC 3852. This document clarifies the proper handling of
the SignedData protected content type when more than one digital
signature is present. [STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="Russell Housley &lt;housley@vigilsec.com&gt;" name="DC.Creator"/>
<meta content="April, 2007" name="DC.Date.Issued"/>
<meta content="Cryptographic Message Syntax (CMS) Multiple Signer Clarification" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 4853 - Cryptographic Message Syntax (CMS) Multiple Signer Clarification</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc4853.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc4853" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-smime-cms-mult-sign" title="draft-ietf-smime-cms-mult-sign">draft-ietf-smim...</a>] [<a href="https://datatracker.ietf.org/doc/rfc4853" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4853" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc4853" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=4853">Errata</a>]</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Network Working Group                                         R. Housley
Request for Comments: 4853                                Vigil Security
Updates: <a href="rfc3852.html">3852</a>                                                 April 2007
Category: Standards Track


                   <span class="h1">Cryptographic Message Syntax (CMS)</span>
                     <span class="h1">Multiple Signer Clarification</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The IETF Trust (2007).

Abstract

   This document updates the Cryptographic Message Syntax (CMS), which
   is published in <a href="rfc3852.html">RFC 3852</a>.  This document clarifies the proper
   handling of the SignedData protected content type when more than one
   digital signature is present.
























<span class="grey">Housley                     Standards Track                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc4853.html">RFC 4853</a>           CMS Multiple Signer Clarification          April 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   This document updates the Cryptographic Message Syntax [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>].  The
   CMS SignedData protected content type allows multiple digital
   signatures, but the specification is unclear about the appropriate
   processing by a recipient of such a signed content.  This document
   provides replacement text for a few paragraphs, making it clear that
   the protected content is validly signed by a given signer, if any of
   the digital signatures from that signer are valid.

   This property is especially important in two cases.  First, when the
   recipients do not all implement the same digital signature algorithm,
   a signer can sign the content with several different digital
   signature algorithms so that each of the recipients can find an
   acceptable signature.  For example, if some recipients support RSA
   and some recipients support ECDSA, then the signer can generate two
   signatures, one with RSA and one with ECDSA, so that each recipient
   will be able to validate one of the signatures.  Second, when a
   community is transitioning one-way hash functions or digital
   signature algorithms, a signer can sign the content with the older
   and the newer signature algorithms so that each recipient can find an
   acceptable signature, regardless of their state in the transition.
   For example, consider a transition from RSA with SHA-1 to RSA with
   SHA-256.  The signer can generate two signatures, one with SHA-1 and
   one with SHA-256, so that each recipient will be able to validate at
   least one of the RSA signatures.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="#ref-STDWORDS" title='"Key words for use in RFCs to Indicate Requirement Levels"'>STDWORDS</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Update%20to%20RFC%203852%2C%20Section%205%3A%20Signed-data%20Content%20Type"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Update to <a href="rfc3852.html#section-5">RFC 3852, Section 5</a>: Signed-data Content Type</span>

   <a href="rfc3852.html#section-5">RFC 3852, section 5</a>, the next to the last paragraph says:

|  A recipient independently computes the message digest.  This message
|  digest and the signer's public key are used to verify the signature
|  value.  The signer's public key is referenced either by an issuer
|  distinguished name along with an issuer-specific serial number or by
|  a subject key identifier that uniquely identifies the certificate
|  containing the public key.  The signer's certificate can be included
|  in the SignedData certificates field.







<span class="grey">Housley                     Standards Track                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc4853.html">RFC 4853</a>           CMS Multiple Signer Clarification          April 2007</span>


   This block of text is replaced with:

|  A recipient independently computes the message digest.  This message
|  digest and the signer's public key are used to verify the signature
|  value.  The signer's public key is referenced either by an issuer
|  distinguished name along with an issuer-specific serial number or by
|  a subject key identifier that uniquely identifies the certificate
|  containing the public key.  The signer's certificate can be included
|  in the SignedData certificates field.
|
|  When more than one signature is present, the successful validation
|  of one signature associated with a given signer is usually treated
|  as a successful signature by that signer.  However, there are some
|  application environments where other rules are needed.  An
|  application that employs a rule other than one valid signature for
|  each signer must specify those rules.  Also, where simple matching of
|  the signer identifier is not sufficient to determine whether the
|  signatures were generated by the same signer, the application
|  specification must describe how to determine which signatures were
|  generated by the same signer.  Support of different communities of
|  recipients is the primary reason that signers choose to include more
|  than one signature.  For example, the signed-data content type might
|  include signatures generated with the RSA signature algorithm and
|  with the ECDSA signature algorithm.  This allows recipients to
|  verify the signature associated with one algorithm or the other.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Update%20to%20RFC%203852%2C%20Section%205.1%3A%20SignedData%20Type"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Update to <a href="rfc3852.html#section-5.1">RFC 3852, Section 5.1</a>: SignedData Type</span>

   <a href="rfc3852.html#section-5.1">RFC 3852, section 5.1</a>, the next to the last paragraph says:

|     signerInfos is a collection of per-signer information.  There MAY
|     be any number of elements in the collection, including zero.  The
|     details of the SignerInfo type are discussed in <a href="#section-5.3">section 5.3</a>.
|     Since each signer can employ a digital signature technique and
|     future specifications could update the syntax, all implementations
|     MUST gracefully handle unimplemented versions of SignerInfo.
|     Further, since all implementations will not support every possible
|     signature algorithm, all implementations MUST gracefully handle
|     unimplemented signature algorithms when they are encountered.

   This block of text is replaced with:

|     signerInfos is a collection of per-signer information.  There MAY
|     be any number of elements in the collection, including zero.  When
|     the collection represents more than one signature, the successful
|     validation of one of signature from a given signer ought to be
|     treated as a successful signature by that signer.  However,
|     there are some application environments where other rules are



<span class="grey">Housley                     Standards Track                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc4853.html">RFC 4853</a>           CMS Multiple Signer Clarification          April 2007</span>


|     needed.  The details of the SignerInfo type are discussed in
|     <a href="#section-5.3">section 5.3</a>.  Since each signer can employ a different digital
|     signature technique, and future specifications could update the
|     syntax, all implementations MUST gracefully handle unimplemented
|     versions of SignerInfo.  Further, since all implementations will
|     not support every possible signature algorithm, all
|     implementations MUST gracefully handle unimplemented signature
|     algorithms when they are encountered.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Security Considerations</span>

   The replacement text will reduce the likelihood of interoperability
   errors during the transition from MD5 and SHA-1 to stronger one-way
   hash functions, or to better signature algorithms.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Normative%20References"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Normative References</span>

   [<a id="ref-CMS" name="ref-CMS">CMS</a>]       Housley, R., "Cryptographic Message Syntax (CMS)", <a href="rfc3852.html">RFC</a>
               <a href="rfc3852.html">3852</a>, July 2004.

   [<a id="ref-STDWORDS" name="ref-STDWORDS">STDWORDS</a>]  Bradner, S., "Key words for use in RFCs to Indicate
               Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

Author's Address

   Russell Housley
   Vigil Security, LLC
   918 Spring Knoll Drive
   Herndon, VA 20170
   USA

   EMail: housley@vigilsec.com



















<span class="grey">Housley                     Standards Track                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc4853.html">RFC 4853</a>           CMS Multiple Signer Clarification          April 2007</span>


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.







Housley                     Standards Track                     [Page 5]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc4853 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:39 GMT --></html>