<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc5792 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:33 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-sangster-nea-pa-tnc" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:5792" name="DC.Identifier"/>
<meta content="March, 2010" name="DC.Date.Issued"/>
<meta content="Narayan, Kaushik" name="DC.Creator"/>
<meta content="Sangster, Paul" name="DC.Creator"/>
<meta content="This document specifies PA-TNC, a Posture Attribute Protocol identical
to the Trusted Computing Group's IF-M 1.0 protocol. The document
then evaluates PA-TNC against the requirements defined in the NEA
Requirements specification." name="DC.Description.Abstract"/>
<meta content="PA-TNC: A Posture Attribute Protocol (PA) Compatible with TNC" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5792 - PA-TNC: A Posture Attribute Protocol (PA) Compatible with TNC</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc5792.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc5792" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-nea-pa-tnc" title="draft-ietf-nea-pa-tnc">draft-ietf-nea-...</a>] [<a href="https://datatracker.ietf.org/doc/rfc5792" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5792" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc5792" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=5792">Errata</a>]</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Internet Engineering Task Force (IETF)                       P. Sangster
Request for Comments: 5792                          Symantec Corporation
Category: Standards Track                                     K. Narayan
ISSN: 2070-1721                                            Cisco Systems
                                                              March 2010


          <span class="h1">PA-TNC: A Posture Attribute (PA) Protocol Compatible</span>
                   <span class="h1">with Trusted Network Connect (TNC)</span>

Abstract

   This document specifies PA-TNC, a Posture Attribute protocol
   identical to the Trusted Computing Group's IF-M 1.0 protocol.  The
   document then evaluates PA-TNC against the requirements defined in
   the NEA Requirements specification.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc5792">http://www.rfc-editor.org/info/rfc5792</a>.

Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.






<span class="grey">Sangster &amp; Narayan           Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-4">4</a>
      <a href="#section-1.1">1.1</a>. Prerequisites ..............................................<a href="#page-4">4</a>
      <a href="#section-1.2">1.2</a>. Message Diagram Conventions ................................<a href="#page-4">4</a>
      <a href="#section-1.3">1.3</a>. Conventions Used in This Document ..........................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. Design Considerations ...........................................<a href="#page-4">4</a>
      <a href="#section-2.1">2.1</a>. Standard Attribute Namespace for Interoperability ..........<a href="#page-4">4</a>
      <a href="#section-2.2">2.2</a>. Vendor-Defined Namespace for Differentiation and Agility ...<a href="#page-5">5</a>
      <a href="#section-2.3">2.3</a>. Use of TLV-Based Encoding for Efficiency ...................<a href="#page-6">6</a>
   <a href="#section-3">3</a>. PA-TNC Message Protocol .........................................<a href="#page-7">7</a>
      <a href="#section-3.1">3.1</a>. PA-TNC Messaging Model .....................................<a href="#page-7">7</a>
      <a href="#section-3.2">3.2</a>. PA-TNC Relationship to PB-TNC ..............................<a href="#page-8">8</a>
      3.3. PB-PA Posture Collector and Posture Validator
           Identifiers ...............................................<a href="#page-10">10</a>
      <a href="#section-3.4">3.4</a>. PA-TNC Messages in PB-TNC .................................<a href="#page-10">10</a>
      <a href="#section-3.5">3.5</a>. IETF Standard PA Subtypes .................................<a href="#page-11">11</a>
      <a href="#section-3.6">3.6</a>. PA-TNC Message Header Format ..............................<a href="#page-12">12</a>
   <a href="#section-4">4</a>. PA-TNC Attributes ..............................................<a href="#page-13">13</a>
      <a href="#section-4.1">4.1</a>.  PA-TNC Attribute Header ..................................<a href="#page-13">13</a>
      <a href="#section-4.2">4.2</a>.  IETF Standard PA-TNC Attribute Types .....................<a href="#page-17">17</a>
           <a href="#section-4.2.1">4.2.1</a>. Attribute Request ..................................<a href="#page-18">18</a>
           <a href="#section-4.2.2">4.2.2</a>. Product Information ................................<a href="#page-20">20</a>
           <a href="#section-4.2.3">4.2.3</a>. Numeric Version ....................................<a href="#page-22">22</a>
           <a href="#section-4.2.4">4.2.4</a>. String Version .....................................<a href="#page-24">24</a>
           <a href="#section-4.2.5">4.2.5</a>. Operational Status .................................<a href="#page-26">26</a>
           <a href="#section-4.2.6">4.2.6</a>. Port Filter ........................................<a href="#page-29">29</a>
           <a href="#section-4.2.7">4.2.7</a>. Installed Packages .................................<a href="#page-31">31</a>
           <a href="#section-4.2.8">4.2.8</a>. PA-TNC Error .......................................<a href="#page-34">34</a>
           <a href="#section-4.2.9">4.2.9</a>. Assessment Result ..................................<a href="#page-41">41</a>
           <a href="#section-4.2.10">4.2.10</a>. Remediation Instructions ..........................<a href="#page-42">42</a>
           <a href="#section-4.2.11">4.2.11</a>. Forwarding Enabled ................................<a href="#page-45">45</a>
           <a href="#section-4.2.12">4.2.12</a>. Factory Default Password Enabled ..................<a href="#page-47">47</a>
      <a href="#section-4.3">4.3</a>.  Vendor-Defined Attributes ................................<a href="#page-48">48</a>
   <a href="#section-5">5</a>. Security Considerations ........................................<a href="#page-48">48</a>
      <a href="#section-5.1">5.1</a>. Trust Relationships .......................................<a href="#page-48">48</a>



<span class="grey">Sangster &amp; Narayan           Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


           <a href="#section-5.1.1">5.1.1</a>. Posture Collector ..................................<a href="#page-49">49</a>
           <a href="#section-5.1.2">5.1.2</a>. Posture Validator ..................................<a href="#page-49">49</a>
           <a href="#section-5.1.3">5.1.3</a>. Posture Broker Client, Posture Broker Server .......<a href="#page-49">49</a>
      <a href="#section-5.2">5.2</a>. Security Threats ..........................................<a href="#page-50">50</a>
           <a href="#section-5.2.1">5.2.1</a>. Attribute Theft ....................................<a href="#page-50">50</a>
           <a href="#section-5.2.2">5.2.2</a>. Message Fabrication ................................<a href="#page-51">51</a>
           <a href="#section-5.2.3">5.2.3</a>. Attribute Modification .............................<a href="#page-51">51</a>
           <a href="#section-5.2.4">5.2.4</a>. Attribute Replay ...................................<a href="#page-52">52</a>
           <a href="#section-5.2.5">5.2.5</a>. Attribute Insertion ................................<a href="#page-52">52</a>
           <a href="#section-5.2.6">5.2.6</a>. Denial of Service ..................................<a href="#page-53">53</a>
   <a href="#section-6">6</a>. Privacy Considerations .........................................<a href="#page-53">53</a>
   <a href="#section-7">7</a>. IANA Considerations ............................................<a href="#page-54">54</a>
      <a href="#section-7.1">7.1</a>. Designated Expert Guidelines ..............................<a href="#page-55">55</a>
      <a href="#section-7.2">7.2</a>. PA Subtypes ...............................................<a href="#page-56">56</a>
      <a href="#section-7.3">7.3</a>. Registry for PA-TNC Attribute Types .......................<a href="#page-56">56</a>
      <a href="#section-7.4">7.4</a>. Registry for PA-TNC Error Codes ...........................<a href="#page-57">57</a>
      <a href="#section-7.5">7.5</a>. Registry for PA-TNC Remediation Parameters Types ..........<a href="#page-58">58</a>
   <a href="#section-8">8</a>. Acknowledgments ................................................<a href="#page-58">58</a>
   <a href="#section-9">9</a>. References .....................................................<a href="#page-59">59</a>
      <a href="#section-9.1">9.1</a>. Normative References ......................................<a href="#page-59">59</a>
      <a href="#section-9.2">9.2</a>. Informative References ....................................<a href="#page-59">59</a>
   <a href="#appendix-A">Appendix A</a>. Use Cases .............................................<a href="#page-60">60</a>
      <a href="#appendix-A.1">A.1</a>. Initial Client-Triggered Assessment .......................<a href="#page-60">60</a>
      <a href="#appendix-A.2">A.2</a>. Server-Initiated Assessment with Remediation ..............<a href="#page-64">64</a>
      <a href="#appendix-A.3">A.3</a>. Client-Triggered Reassessment .............................<a href="#page-71">71</a>
   <a href="#appendix-B">Appendix B</a>. Evaluation against NEA Requirements ...................<a href="#page-77">77</a>
      <a href="#appendix-B.1">B.1</a>. Evaluation against Requirements C-1 .......................<a href="#page-77">77</a>
      <a href="#appendix-B.2">B.2</a>. Evaluation against Requirements C-2 .......................<a href="#page-77">77</a>
      <a href="#appendix-B.3">B.3</a>. Evaluation against Requirements C-3 .......................<a href="#page-77">77</a>
      <a href="#appendix-B.4">B.4</a>. Evaluation against Requirements C-4 .......................<a href="#page-78">78</a>
      <a href="#appendix-B.5">B.5</a>. Evaluation against Requirements C-5 .......................<a href="#page-78">78</a>
      <a href="#appendix-B.6">B.6</a>. Evaluation against Requirements C-6 .......................<a href="#page-78">78</a>
      <a href="#appendix-B.7">B.7</a>. Evaluation against Requirements C-7 .......................<a href="#page-79">79</a>
      <a href="#appendix-B.8">B.8</a>. Evaluation against Requirements C-8 .......................<a href="#page-79">79</a>
      <a href="#appendix-B.9">B.9</a>. Evaluation against Requirements C-9 .......................<a href="#page-79">79</a>
      <a href="#appendix-B.10">B.10</a>. Evaluation against Requirements C-10 .....................<a href="#page-80">80</a>
      <a href="#appendix-B.11">B.11</a>. Evaluation against Requirements C-11 .....................<a href="#page-80">80</a>
      <a href="#appendix-B.12">B.12</a>. Evaluation against Requirements PA-1 .....................<a href="#page-81">81</a>
      <a href="#appendix-B.13">B.13</a>. Evaluation against Requirements PA-2 .....................<a href="#page-81">81</a>
      <a href="#appendix-B.14">B.14</a>. Evaluation against Requirements PA-3 .....................<a href="#page-81">81</a>
      <a href="#appendix-B.15">B.15</a>. Evaluation against Requirements PA-4 .....................<a href="#page-82">82</a>
      <a href="#appendix-B.16">B.16</a>. Evaluation against Requirements PA-5 .....................<a href="#page-82">82</a>
      <a href="#appendix-B.17">B.17</a>. Evaluation against Requirements PA-6 .....................<a href="#page-83">83</a>








<span class="grey">Sangster &amp; Narayan           Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   This document specifies PA-TNC, a Posture Attribute (PA) Protocol
   identical to the Trusted Computing Group's IF-M 1.0 protocol [<a href="#ref-8" title='"IF-M: TLV Binding"'>8</a>].
   The document then evaluates PA-TNC against the requirements defined
   in the Network Endpoint Assessment (NEA) Requirements specification
   [<a href="#ref-9" title='"Network Endpoint Assessment (NEA): Overview and Requirements"'>9</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Prerequisites"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Prerequisites</span>

   This document does not define an architecture or reference model.
   Instead, it defines a protocol that works within the reference model
   described in the NEA Overview and Requirements specification.  The
   reader is assumed to be thoroughly familiar with that document.  No
   familiarity with TCG specifications is assumed.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Message%20Diagram%20Conventions"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Message Diagram Conventions</span>

   This specification defines the syntax of PA-TNC messages using
   diagrams.  Each diagram depicts the format and size of each field in
   bits.  Implementations MUST send the bits in each diagram as they are
   shown, traversing the diagram from top to bottom and then from left
   to right within each line (which represents a 32-bit quantity).
   Multi-byte fields representing numeric values must be sent in network
   (big endian) byte order.

   Descriptions of bit field (e.g., flag) values are described referring
   to the position of the bit within the field.  These bit positions are
   numbered from the most significant bit through the least significant
   bit, so a 1-octet field with only bit 0 set has the value 0x80.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="#ref-1" title='"Key words for use in RFCs to Indicate Requirement Levels"'>1</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Design%20Considerations"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Design Considerations</span>

   This section discusses some of the key design considerations for the
   PA protocol.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Standard%20Attribute%20Namespace%20for%20Interoperability"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Standard Attribute Namespace for Interoperability</span>

   The PA protocol requires the use of two categories of namespaces:
   component types (AKA PA subtypes) and attributes.  Each of these
   namespace categories needs to contain well-known, interoperable names
   with defined syntax and semantics co-existing with names for vendor-



<span class="grey">Sangster &amp; Narayan           Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   defined private extensions.  Similarly, each namespace category needs
   to be readily extensible without repeated coordination yet avoids
   naming conflicts.

   The PA-TNC and PB-TNC protocols provide for multiple orthogonal
   namespaces for each category that exist without overlap by including
   a Structure of Management Information (SMI) Private Enterprise Number
   (PEN) field to identify the definer of namespace of the associated
   field.  This allows the IETF NEA WG to define a set of standard
   component types and attribute types while allowing vendors to each
   create additional names outside of the IETF standard namespace.  Over
   time, vendor-defined names might be proposed for standardization and
   thus migration into the IETF namespace.

   The PB-TNC protocol defines an IETF standard namespace (using
   vendor-id=0) that allows for definition of standard component types
   (e.g., Operating System, Firewall, Anti-Virus) using the PA Subtype
   field (see <a href="#section-3.2">section 3.2</a>).  Similarly, PA-TNC defines a set of standard
   attributes in <a href="#section-4.2">section 4.2</a> that represent the most common capabilities
   (attributes) of these types of components across a variety of vendor
   implementations.  The standard namespace allows NEA deployments with
   both open source and vendor-provided NEA implementations to support a
   consistent set of policies across their environment based on these
   standard attributes.  The standard attributes can be used with a
   variety of endpoints (hosts, printers, mobile devices) that are
   running applications and operating systems (defined by the PA
   subtypes) from a variety of vendors.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Vendor-Defined%20Namespace%20for%20Differentiation%20and%20Agility"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Vendor-Defined Namespace for Differentiation and Agility</span>

   The endpoint is a very dynamic environment in terms of rate of new
   features being deployed and attacks that are crafted against existing
   and new applications such as viruses, worms, malware, and spyware.
   It is difficult to imagine the standard namespaces being able to keep
   pace with this rapidly changing environment.  Vendors typically
   differentiate themselves by moving rapidly to provide unique
   mechanisms to address such threats and their ability to deal with
   changes in an agile manner.  The PA-TNC and PB-TNC protocols allow
   for creation of vendor-defined namespace(s) where each namespace
   allows use of vendor-defined PA subtypes to identify non-standard
   applications or operating system variants and vendor-defined
   attributes describing new aspects of each type of component.  The
   vendor namespaces will allow NEA deployments to craft compliance
   policies using a mixture of attributes from both the IETF standard
   namespace and vendor-defined namespaces that may include multiple
   vendors representing the various hardware and software components
   present on the endpoints.




<span class="grey">Sangster &amp; Narayan           Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   The PA-TNC protocol's use of vendor-id to identify the namespace of
   each attribute allows Posture Collectors to support some or all of
   the IETF standard attributes plus optionally a set of vendor-defined
   attributes (potentially from more than one vendor-id namespace).  For
   instance, an open source anti-virus Posture Collector might be
   written that supports all of the IETF standard attributes used to
   describe a local anti-virus component and a subset of multiple anti-
   virus manufacturers' vendor-defined attributes.  This Posture
   Collector might therefore be able to interoperate with Posture
   Validators from multiple vendors.  Conversely, a simple Posture
   Collector might be written to ignore any vendor-defined attributes
   requested and only return standard attributes that it supports.  If
   the vendor-provided Posture Validator's policy allows for this subset
   to be considered compliant, then these simple Posture Collectors can
   be used to perform a successful assessment.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20Use%20of%20TLV-Based%20Encoding%20for%20Efficiency"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  Use of TLV-Based Encoding for Efficiency</span>

   The PA-TNC protocol has chosen to employ a binary encoding using a
   type-length-value (TLV) structure.  TLV encoding was preferred over
   the use of a textual encoding format such as XML to provide a more
   efficient utilization of the potentially constrained bandwidth
   available between the NEA Client and NEA Server (see NEA Overview and
   Architecture [<a href="#ref-9" title='"Network Endpoint Assessment (NEA): Overview and Requirements"'>9</a>]).  Efficiency was a primary criterion for this
   choice with consideration given to both:

      1. Optimization of the bits-on-the-wire to accommodate NEA
         requirements for assessment over low bandwidth or high latency
         links (C-8) and allow for the Posture Transport (PT) protocol
         to run over existing network access protocols (PT-4, C-11) that
         are constrained by packet size.

      2. Optimization of CPU utilization on the endpoint to accommodate
         for low power endpoints such as mobile devices.

   The choice of TLV encoding does not preclude the use of XML-based
   attribute values within the vendor namespaces or future standard
   attributes.  It is conceivable that certain vendors may utilize XML
   encoding for extensibility within their namespace when the above
   considerations are less applicable to their technologies.  Attributes
   encoded within the vendor-defined namespace using alternate encoding
   such as XML will be opaque to NEA software only supporting standard
   attributes and will be processed primarily by the vendor-defined
   components (collector/validator).







<span class="grey">Sangster &amp; Narayan           Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20PA-TNC%20Message%20Protocol"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  PA-TNC Message Protocol</span>

   This section discusses the use of the PA-TNC message and its
   attributes, and specifies the syntax and semantics for the PA-TNC
   message header.  The details of each attribute included within the
   PA-TNC payload are specified in <a href="#section-4.2">section 4.2</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20PA-TNC%20Messaging%20Model"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  PA-TNC Messaging Model</span>

   PA-TNC messages are carried by the PB-TNC protocol [<a href="#ref-5" title='"PB-TNC: A Posture Broker (PB) Protocol Compatible with Trusted Network Connect (TNC)"'>5</a>], which
   provides a multi-roundtrip reliable transport and end-to-end message
   delivery to subscribed (interested) parties using a variety of
   underlying network protocols.  PA-TNC is unaware of these underlying
   PT protocols being used below PB-TNC.

   The interested parties consist of Posture Collectors on the NEA
   Client and Posture Validators associated with the NEA Server that
   have registered to receive messages about particular types of
   components (e.g., anti-virus) during an assessment.  The PA-TNC
   messaging protocol operates synchronously within an assessment
   session, with Posture Collectors and Posture Validators taking turns
   sending one or more messages to each other.  Each PA-TNC message may
   contain one or more attributes associated with the functional
   component identified in the component type (PA Subtype) of the
   Posture Broker (PB) protocol.

   Posture Collectors may only send PA-TNC messages to Posture
   Validators and vice versa.  No Posture Collector-to-Posture Collector
   or Posture Validator-to-Posture Validator messaging is allowed to
   occur.  Each Posture Collector or Posture Validator may send several
   PA-TNC messages in succession before indicating that it has completed
   its batch of messages to the Posture Broker Client or Posture Broker
   Server respectively.  As necessary, the Posture Broker Client and
   Posture Broker Server will batch these messages prior to sending them
   over the network.

   PB-TNC provides a publish/subscribe model of message exchange.  This
   means that, at any given point in time, zero or more subscribers for
   a particular type of message may be present on a Posture Broker
   Client or Posture Broker Server.  This is beneficial, since it allows
   one Posture Collector or Posture Validator to combine multiple
   functions (like anti-virus and personal firewall) by subscribing to
   both TNC standard component types.  It also allows multiple Posture
   Collectors or Posture Validators to support the same components, such
   as two anti-virus Posture Validators that are each used to manage
   their own respective anti-virus client software.





<span class="grey">Sangster &amp; Narayan           Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   However, this publish/subscribe model has some possible negative side
   effects.  When a Posture Collector or Posture Validator initially
   sends a PA-TNC message, it does not know whether it will receive
   many, one, or no PA-TNC messages from the other side.  For many types
   of assessments, this is acceptable, but in some cases a more direct
   channel binding between a particular Posture Collector and Posture
   Validator pair is necessary.  For example, a Posture Validator may
   wish to provide remediation instructions to a particular Posture
   Collector that it knows is capable of remediating a non-compliant
   component.  This can be accomplished using the exclusive delivery PB-
   TNC capability to limit distribution of a message to a single Posture
   Collector by including the target Posture Collector Identifier in the
   PB-PA header.  For more information on the PB-PA header, see <a href="#section-4.5">section</a>
   <a href="#section-4.5">4.5</a> of the PB-TNC specification.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20PA-TNC%20Relationship%20to%20PB-TNC"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  PA-TNC Relationship to PB-TNC</span>

   This section summarizes the major elements of a PA-TNC message as
   they might appear inside of a PB-TNC message.  The double line (===)
   in the diagram below indicates the separation between the PB-TNC and
   PA-TNC protocols.  The PA-TNC portion of the message is delivered to
   each Posture Collector or Posture Validator registered to receive
   messages containing a particular message type.  Note that PB-TNC is
   capable of carrying multiple PB-TNC and PA-TNC messages in a single
   PB-TNC batch.  See the PB-TNC specification [<a href="#ref-5" title='"PB-TNC: A Posture Broker (PB) Protocol Compatible with Trusted Network Connect (TNC)"'>5</a>] for more information
   on its capabilities.

   One important linkage between the PA-TNC and PB-TNC protocols is the
   PA message type (PA Message Vendor ID and PA Subtype) that is used by
   the Posture Broker Client and Posture Broker Server to route messages
   to interested Posture Collectors and Posture Validators.  The message
   type indicates the software component (component type) that is
   associated with the attributes included inside the PA-TNC message.
   Therefore, Posture Collectors and Posture Validators written to
   support an assessment of a particular component can register to
   receive messages about the component and thus participate in its
   assessment.  Each Posture Collector and Posture Validator MUST only
   send PA-TNC messages containing attributes that pertain to the
   software component defined in the message type of the message.  This
   ensures that only the appropriate Posture Collectors and Posture
   Validators that support a particular type of component will receive
   attributes related to that component.  If a PA-TNC message contained
   a mix of attributes about different components and a message type of
   only one of those components, the message would only be delivered to
   parties interested in the component type included in the message
   type, so other interested recipients wouldn't see those attributes.





<span class="grey">Sangster &amp; Narayan           Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   The message type is composed of two fields: a PA Message Vendor ID
   and a PA Subtype.  The PA Message Vendor ID identifies the vendor or
   other organization that defined this message type.  The PA Subtype
   identifies the message type more specifically within the set of
   message types defined by that vendor.  This specification defines
   several IETF Standard PA Subtypes to be used with a PA Message Vendor
   ID of zero (0).  Within this specification, the PA Subtype field is
   used to indicate the type of component (e.g., firewall) involved with
   the message's attributes.  Therefore, for clarity, the PA subtype
   will be referred to as the "component type" in this specification.
   Vendor-defined namespaces may use other semantics for the PA Subtype
   field as this is outside the scope of this specification.

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         PB-TNC Header                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                PB-TNC Message of type PB-PA-Message         |
   |(includes PA Message Vendor ID, PA Subtype, and other fields |
   | used by Posture Broker Client and Posture Broker Server for |
   | routing)                                                    |
   ===============================================================
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     PA-TNC Message Header                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         PA-TNC Attribute                    |
   |                  (e.g., Product Information)                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         PA-TNC Attribute                    |
   |                  (e.g., Operational Status)                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Figure 1.  Overview of a PB-TNC batch that contains a PA-TNC message

   For example, if a Posture Broker Client sent a PB-TNC batch that
   contained a PA-TNC message with a message type indicating firewall
   component, this message would be routed by the Posture Broker Server
   to Posture Validators registered to assess firewalls.  Each
   registered Posture Validator would receive a copy of the PA-TNC
   message including the PA-TNC header and set of attributes.  It is
   important that each of the attributes included in the PA-TNC message
   be associated with the firewall component because only the Posture
   Collector and Posture Validator interested in firewalls will receive
   such messages.








<span class="grey">Sangster &amp; Narayan           Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   If the above message contained both firewall and operating system
   attributes inside a PA-TNC message with a component type of firewall,
   then any Posture Collector and Posture Validator registered to
   receive operating system messages would not receive those attributes,
   as the messages would only be delivered to those registered for
   firewall messages.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20PB-PA%20Posture%20Collector%20and%20Posture%20Validator%20Identifiers"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  PB-PA Posture Collector and Posture Validator Identifiers</span>

   The PB-PA header contains several fields important to the processing
   of a received PA message.  The PA Vendor ID and Subtype are described
   in the PB-TNC specification and above in <a href="#section-3.2">section 3.2</a>.  Also present
   in the PB-PA header is a pair of fields that identify the Posture
   Collector and/or Posture Validator involved in the exchange.  These
   fields are used for performing exclusive delivery of messages as
   described in <a href="#section-3.1">section 3.1</a> and as an indicator for correlation of
   received attributes.

   Correlation of attributes is necessary when the sending Posture
   Collector provides posture for multiple implementations of a single
   type of component during an assessment, so the recipient Posture
   Validators need to know which attributes are describing the same
   implementation.

   For example, a single Posture Collector might report attributes on
   two installed VPN implementations on the endpoint.  Because the
   individual attributes do not include an indication of which VPN
   product they are describing, the recipient needs something to perform
   this correlation.  Therefore, for this example, the VPN Posture
   Collector would need to obtain two Posture Collector Identifiers from
   the Posture Broker Client and consistently use one with each of the
   implementations during an assessment.  The VPN Posture Collector
   would group all the attributes associated with a particular VPN
   implementation into a single PB-PA message and send the message using
   the Posture Collector Identifier it designates as going with the
   particular implementation.  This approach allows the recipient to
   recognize when attributes in future assessment messages also describe
   the same component implementation.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20PA-TNC%20Messages%20in%20PB-TNC"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  PA-TNC Messages in PB-TNC</span>

   As depicted in <a href="#section-3.2">section 3.2</a>, a PA-TNC message consists of a PA-TNC
   header followed by a sequence of one or more attributes.  The PA-TNC
   message header (described in <a href="#section-3.6">section 3.6</a>) and the header for each of
   the PA-TNC attributes (specified in <a href="#section-4.1">section 4.1</a>) have a fixed type-
   length-value (TLV) format.  Each PA-TNC message MAY contain a mixture
   of standards-based and vendor-defined attributes identifiable using
   the type portion of the attribute header.  All Posture Collectors and



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   Posture Validators compliant with this specification MUST be capable
   of processing multiple attributes in a received PA-TNC message.  A
   Posture Collector or Posture Validator that receives a PA-TNC message
   can use the attribute header's length field to skip any attributes
   that it does not understand, unless the attribute is marked as
   mandatory to process.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.5.%20%20IETF%20Standard%20PA%20Subtypes"></a><a class="selflink" href="#section-3.5" name="section-3.5">3.5</a>.  IETF Standard PA Subtypes</span>

   This section defines several IETF Standard PA Subtypes.  Each PA
   subtype defined here identifies a specific component relevant to the
   endpoint's posture.  This allows a small set of generic PA-TNC
   attributes (e.g., Product Information) to be used to describe a large
   number of different components (e.g., operating system, anti-virus,
   etc.).  It also allows Posture Collectors and Posture Validators to
   specialize in a particular component and only receive PA-TNC messages
   relevant to that component.

   Value    Integer           Definition
   -----    -------           ----------
   0        Testing           Reserved for use in specification
                              examples, experimentation and
                              testing.

   1        Operating System  Operating system running on the
                              endpoint

   2        Anti-Virus        Host-based anti-virus software

   3        Anti-Spyware      Host-based anti-spyware software

   4        Anti-Malware      Host-based anti-malware (e.g., anti-
                              bot) software not included within
                              anti-virus or anti-spyware components

   5        Firewall          Host-based firewall

   6        IDPS              Host-based Intrusion Detection and/or
                              Prevention Software (IDPS)

   7        VPN               Host-based Virtual Private Network
                              (VPN) software

   8        NEA Client        NEA client software

   These PA subtypes must be used in a PB-PA message with a PA Message
   Vendor ID of zero (0) indicating an IETF standard type of component
   (as described in the PB-TNC specification [<a href="#ref-5" title='"PB-TNC: A Posture Broker (PB) Protocol Compatible with Trusted Network Connect (TNC)"'>5</a>]).  If these PA subtype



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   values are used with a different PA Message Vendor ID, they have a
   completely different meaning that is not defined in this
   specification.  Posture Collectors and Posture Validators MUST NOT
   require support for particular vendor-specific PA subtypes and MUST
   interoperate with other parties despite any differences in the set of
   vendor-specific PA subtypes supported (although they MAY permit
   administrators to configure them to require support for specific PA
   subtypes).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.6.%20%20PA-TNC%20Message%20Header%20Format"></a><a class="selflink" href="#section-3.6" name="section-3.6">3.6</a>.  PA-TNC Message Header Format</span>

   This section describes the format and semantics of the PA-TNC header.
   Every PA-TNC message MUST start with a PA-TNC header.  The PA-TNC
   header provides a common context applying to all of the attributes
   contained within the PA-TNC payload.  The payload consists of a
   sequence of assessment attributes described in <a href="#section-4.2">section 4.2</a>.
                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    Version    |                    Reserved                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Message Identifier                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Version

      This field indicates the version of the format for the PA-TNC
      message.  This version is intended to allow for evolution of the
      PA-TNC message header and payload in a manner that can easily be
      detected by message recipients.

      PA-TNC message senders MUST set this field to 0x01 for all PA-TNC
      messages that comply with this specification.  Implementations
      responding to a PA-TNC message containing a supported version MUST
      use the same version number to minimize the risk of version
      incompatibility.  Message recipients MUST respond to a PA-TNC
      message containing an unsupported version by sending a Version Not
      Supported error in a PA-TNC Error attribute that is the only PA-
      TNC attribute in a PA-TNC message with version number 1.

      PA-TNC message initiators supporting multiple PA-TNC protocol
      versions SHOULD be able to alter which version of PA-TNC message
      they send based on prior message exchanges with a particular peer
      Posture Collector or Posture Validator.







<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   Reserved

      Reserved for future use.  This field MUST be set to 0 on
      transmission and ignored upon reception.

   Message Identifier

      This field contains a value that uniquely identifies this message,
      differentiating it from others sent by a particular PA-TNC message
      sender within this assessment.  This value can be included in the
      payload of a response message to indicate which message was
      received and caused the response.  This value is included in the
      payload of PA-TNC error messages so the party who receives the
      error message can determine which of the messages they had sent
      caused the error.

      PA-TNC message senders MUST NOT send the same message identifier
      more than once during an assessment.  Message identifiers may be
      randomly generated or sequenced as long as values are not repeated
      during an assessment message exchange.  PA-TNC message recipients
      are not required to check for duplicate message identifiers.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20PA-TNC%20Attributes"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  PA-TNC Attributes</span>

   This section defines the PA-TNC attributes that can be carried within
   a PA-TNC message.  The initial section defines the standard attribute
   header that appears at the start of each attribute in a PA-TNC
   message.  The second section defines each of the IETF Standard PA-TNC
   Attributes and the final section discusses how vendor-defined PA-TNC
   attributes can be used within a PA-TNC message.  Vendor-defined PA-
   TNC attributes use the vendor's SMI Private Enterprise Number in the
   Attribute Type field.

   A PA-TNC message MUST contain a PA-TNC header (defined in <a href="#section-3.6">section</a>
   <a href="#section-3.6">3.6</a>.  followed by a sequence of zero or more PA-TNC attributes.  All
   PA-TNC attributes MUST begin with a standard PA-TNC attribute header,
   as defined in <a href="#section-4.1">section 4.1</a>.  The contents of PA-TNC attributes vary
   widely, depending on their attribute type.  <a href="#section-4.2">Section 4.2</a> defines the
   IETF Standard PA-TNC Attributes.  <a href="#section-4.3">Section 4.3</a> discusses how vendor-
   specific PA-TNC attributes can be defined.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20PA-TNC%20Attribute%20Header"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  PA-TNC Attribute Header</span>

   Following the PA-TNC message header is a sequence of zero or more
   attributes.  All PA-TNC attributes MUST begin with the standard PA-
   TNC attribute header defined in this subsection.  Each attribute
   described in this specification is represented by a TLV tuple.  The
   TLV tuple includes an attribute identifier comprised of the Vendor ID



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   and Attribute Type (type), the TLV tuple's overall length, and
   finally the attribute's value.  The use of TLV representation was
   chosen due to its flexibility and extensibility and use in other
   standards.  Recipients of an attribute can use the attribute type
   fields to determine the precise syntax and semantics of the attribute
   value field and the length to skip over an unrecognized attribute.
   The length field is also beneficial when a variable-length attribute
   value is provided.

   The TLV format does not contain an explicit TLV format version
   number, so every attribute included in a particular PA-TNC message
   MUST use the same TLV format.  Using the PA-TNC message version
   number to indicate the format of all TLV attributes within a PA-TNC
   message allows for future versioning of the TLV format in a manner
   detectable by PA-TNC message recipients.  Similarly, requiring all
   TLV attribute formats to be the same within a PA-TNC message also
   ensures that recipients compliant with a particular PA-TNC message
   version can at least parse every attribute header and use the length
   to skip over unrecognized attributes.  Finally, all attribute TLVs
   within a PA-TNC message MUST pertain to the same implementation of
   the component.  This restriction is relevant when a single Posture
   Collector is reporting on multiple implementations of a component, so
   must send multiple PA-TNC messages each including only the attributes
   describing a single implementation.  For more information on how
   Posture Collectors should handle multiple implementations, see
   <a href="#section-3.3">section 3.3</a>.

   Every PA-TNC-compliant TLV attribute MUST use the following TLV
   format:
                       1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Flags     |          PA-TNC Attribute Vendor ID           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     PA-TNC Attribute Type                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    PA-TNC Attribute Length                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                 Attribute Value (Variable Length)             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Flags

      This field defines flags impacting the processing of the
      associated attribute.






<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


      Bit 0 (0x80) is the NOSKIP flag.  Any Posture Collector or Posture
      Validator that receives an attribute with this flag set to 1 but
      does not support this attribute MUST NOT process any part of the
      PA-TNC message and SHOULD respond with an Attribute Type Not
      Supported error in a PA-TNC error message.

      In order to avoid taking action on a subset of the attributes only
      to later find an unsupported attribute with the NOSKIP flag set,
      recipients of a multi-attribute PA-TNC message might need to scan
      all of the attributes prior to acting upon any attribute.

      When the NOSKIP flag is set to 0, recipients SHOULD skip any
      unsupported attributes and continue processing the next attribute.

      Bit 1-7 are reserved for future use.  These bits MUST be set to 0
      on transmission and ignored upon reception.

   PA-TNC Attribute Vendor ID

      This field indicates the owner of the namespace associated with
      the PA-TNC Attribute Type.  This is accomplished by specifying the
      24-bit SMI Private Enterprise Number Vendor ID of the party who
      owns the Attribute Type namespace.  IETF Standard PA-TNC Attribute
      Types MUST use zero (0) in this field.

      The PA-TNC Attribute Vendor ID 0xffffff is reserved.  Posture
      Collectors and Posture Validators MUST NOT send PA-TNC messages in
      which the PA-TNC Attribute Vendor ID has this reserved value
      (0xffffff).  If a Posture Collector or Posture Validator receives
      a message in which the PA-TNC Attribute Vendor ID has this
      reserved value (0xffffff), it SHOULD respond with an Invalid
      Parameter error code in a PA-TNC Error attribute.

   PA-TNC Attribute Type

      This field defines the type of the attribute included in the
      Attribute Value field.  This field is qualified by the PA-TNC
      Attribute Vendor ID field so that a particular PA-TNC Attribute
      Type value (e.g., 327) has a completely different meaning
      depending on the value in the PA-TNC Attribute Vendor ID field.
      Posture Collectors and Posture Validators MUST NOT require support
      for particular vendor-specific PA-TNC Attribute Types and MUST
      interoperate with other parties despite any differences in the set
      of vendor-specific PA-TNC Attribute Types supported (although they
      MAY permit administrators to configure them to require support for
      specific PA-TNC attribute types).





<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


      If the PA-TNC Attribute Vendor ID field has the value zero (0),
      then the PA-TNC Attribute Type field contains an IETF Standard PA-
      TNC Attribute Type, as listed in the IANA registry.  IANA
      maintains a registry of PA-TNC Attribute Types.  Entries in this
      registry are added by Expert Review with Specification Required,
      following the guidelines in <a href="#section-7">section 7</a>.  <a href="#section-4.2">Section 4.2</a> of this
      specification defines the initial set of IETF Standard PA-TNC
      Attribute Types.

      The PA-TNC Attribute Type 0xffffffff is reserved.  Posture
      Collectors and Posture Validators MUST NOT send PA-TNC messages in
      which the PA-TNC Attribute Type has this reserved value
      (0xffffffff).  If a Posture Collector or Posture Validator
      receives a message in which the PA-TNC Attribute Type has this
      reserved value (0xffffffff), it SHOULD respond with an Invalid
      Parameter error code in a PA-TNC Error attribute.

   PA-TNC Attribute Length

      This field contains the length in octets of the entire PA-TNC
      attribute including the PA-TNC Attribute Header (the fields Flags,
      PA-TNC Attribute Vendor ID, PA-TNC Attribute Type, and PA-TNC
      Attribute Length).  Therefore, this value MUST always be at least
      12.  Any Posture Collector or Posture Validator that receives a
      message with a PA-TNC Attribute Length field whose value is less
      than 12 SHOULD respond with an Invalid Parameter PA-TNC error
      code.  Similarly, if a Posture Collector or Posture Validator
      receives a PA-TNC message for an Attribute Type that has a well-
      known Attribute Value length (e.g., fixed-length attribute value)
      and the Attribute Length indicates a different value (greater or
      less than the expected value), the recipient SHOULD respond with
      an Invalid Parameter PA-TNC error code.

      Implementations that do not support the specified PA-TNC Attribute
      Type can use this length to skip over this attribute to the next
      attribute.  Note that while this field is 4 octets the maximum
      usable attribute length is less than 2^32-1 due to limitations of
      the underlying protocol stack.  Specifically, PB-TNC TLV header's
      Batch Length field is also 32 bits in length.  Therefore, the
      maximum batch that PB-TNC can carry is 2^32-1, so the largest PA-
      TNC message carried by PB-TNC must be less than 2^32-1 - size of
      the PB-TNC header (see <a href="#section-4.1">section 4.1</a> of PB-TNC for more details).

   Attribute Value

      This field varies depending on the particular type of attribute
      being expressed.  The contents of this field for each of the IETF
      Standard PA-TNC Attribute Types are defined in <a href="#section-4.2">section 4.2</a>.



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20IETF%20Standard%20PA-TNC%20Attribute%20Types"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  IETF Standard PA-TNC Attribute Types</span>

   This section defines an initial set of IETF Standard PA-TNC Attribute
   Types.  These Attribute Types MUST always be used with a PA-TNC
   Vendor ID of zero (0).  If these PA-TNC Attribute Type values are
   used with a different PA-TNC Vendor ID, they have a completely
   different meaning that is not defined in this specification.

   The following table briefly describes each attribute and defines the
   numeric value to be used in the PA-TNC Attribute Type field of the
   PA-TNC Attribute Header.  Later subsections provide detailed
   specifications for each PA-TNC Attribute Value.

   Number  Integer                  Description
   ------  -------                  -----------
   0       Testing                  Reserved for use in
                                    specification examples,
                                    experimentation, and testing.

   1       Attribute Request        Contains a list of attribute
                                    type values defining the
                                    attributes desired from the
                                    Posture Collectors.

   2       Product Information      Manufacturer and product
                                    information for the component.

   3       Numeric Version          Numeric version of the
                                    component.

   4       String Version           String version of the
                                    component.

   5       Operational Status       Describes whether the component
                                    is running on the endpoint.

   6       Port Filter              Lists the set of ports (e.g.,
                                    TCP port 80 for HTTP) that are
                                    allowed or blocked on the
                                    endpoint.

   7       Installed Packages       List of software packages
                                    installed on endpoint that
                                    provide the requested
                                    component.

   8       PA-TNC Error             PA-TNC message or attribute
                                    processing error.



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   9       Assessment Result        Result of the assessment
                                    performed by a Posture
                                    Validator.

   10      Remediation Instructions Instructions for remediation
                                    generated by a Posture
                                    Validator.

   11      Forwarding Enabled       Indicates whether packet
                                    forwarding has been enabled
                                    between different interfaces on
                                    the endpoint.

   12      Factory Default Password Indicates whether the endpoint
           Enabled                  has a factory default password
                                    enabled.

   The following subsections discuss the usage, format, and semantics of
   the Attribute Value field for each IETF Standard PA-TNC Attribute
   Type.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.1.%20%20Attribute%20Request"></a><a class="selflink" href="#section-4.2.1" name="section-4.2.1">4.2.1</a>.  Attribute Request</span>

   This PA-TNC Attribute Type allows a Posture Validator to request
   certain attributes from the registered set of Posture Collectors.

   All Posture Collectors that implement any of the IETF Standard PA
   Subtypes defined in this specification SHOULD support receiving and
   processing this attribute type for at least those PA subtypes.  This
   requirement is only a "should" because there are deployment scenarios
   (e.g., see section A.1) where the Posture Collectors proactively send
   a set of attributes at the start of an assessment (e.g., based upon
   local policy), so does not need to support Posture Validator
   requested attributes.  Posture Collectors that receive but do not
   support the Attribute Request attribute MUST respond with an
   Attribute Type Not Supported PA-TNC error code.  Posture Collectors
   that receive and process this attribute MAY choose to send all, a
   subset, or none of the requested attributes but MUST NOT send
   attributes that were not requested (except Error attributes).  All
   Posture Validators that implement any of the IETF Standard PA
   Subtypes defined in this specification SHOULD support sending this
   attribute type for at least those PA subtypes.

   Posture Validators MUST NOT include this attribute type in an
   Attribute Request attribute.  It does not make sense for a Posture
   Validator to request that a Posture Collector send an Attribute
   Request attribute.




<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   For this attribute type, the PA-TNC Attribute Vendor ID field MUST be
   set to zero (0) and the PA-TNC Attribute Type field MUST be set to 1.

   The following diagram illustrates the format and contents of the
   Attribute Value field for this attribute type.  The text after this
   diagram describes the fields shown here.

   Note that this diagram shows two attribute types.  The actual number
   of attribute types included in an Attribute Request attribute can
   vary from one to a large number (limited only by the maximum message
   and length supported by the underlying PT protocol).  However, each
   Attribute Request MUST contain at least one attribute type.  Because
   the length of a PA-TNC Attribute Vendor ID paired with a PA-TNC
   Attribute Type and a 1-octet Reserved field is always 8 octets, the
   number of requested attributes can be easily computed using the PA-
   TNC Attribute Length field by subtracting the number of octets in the
   PA-TNC Attribute Header and dividing by 8.  If the PA-TNC Attribute
   Length field is invalid, Posture Collectors SHOULD respond with an
   Invalid Parameter PA-TNC error code.

                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Reserved    |           PA-TNC Attribute Vendor ID          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      PA-TNC Attribute Type                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Reserved    |           PA-TNC Attribute Vendor ID          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      PA-TNC Attribute Type                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Reserved

      Reserved for future use.  This field MUST be set to 0 on
      transmission and ignored upon reception.

   PA-TNC Attribute Vendor ID

      This field contains the SMI Private Enterprise Number of the
      organization that controls the namespace for the following PA-TNC
      Attribute Type.  This field enables IETF Standard PA-TNC
      Attributes and vendor-defined PA-TNC attributes to be used without
      potential collisions.







<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


      Any IETF Standard PA-TNC Attribute Types defined in <a href="#section-4.2">section 4.2</a>
      MUST use zero (0) in this field.  Vendor-defined attributes MUST
      use the SMI Private Enterprise Number of the organization that
      defined the attribute.

   PA-TNC Attribute Type

      The PA-TNC Attribute Type field (together with the PA-TNC Vendor
      ID field) indicates the specific attribute requested.  Some IETF
      Standard PA-TNC Attribute Types MUST NOT be requested using this
      field (e.g., requesting a PA-TNC Error attribute).  This is
      explicitly indicated in the description of those PA-TNC Attribute
      Types.  Any Posture Collector or Posture Validator that receives
      an Attribute Request containing one of the prohibited Attribute
      Types SHOULD respond with an Invalid Parameter error in a PA-TNC
      error message.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.2.%20%20Product%20Information"></a><a class="selflink" href="#section-4.2.2" name="section-4.2.2">4.2.2</a>.  Product Information</span>

   This PA-TNC Attribute Type contains identifying information about a
   product that implements the component specified in the PA Subtype
   field, as described in <a href="#section-3.5">section 3.5</a>.  For example, if the PA Subtype
   is Anti-Virus, this attribute would contain information identifying
   an anti-virus product installed on the endpoint.

   All Posture Collectors that implement any of the IETF Standard PA
   Subtypes defined in this specification MUST support sending this
   attribute type, at least for those PA subtypes.  Whether a particular
   Posture Collector actually sends this attribute type SHOULD still be
   governed by local privacy and security policies.  All Posture
   Validators that implement any of the IETF Standard PA Subtypes
   defined in this specification MUST support receiving this attribute
   type, at least for those PA subtypes.  Posture Validators MUST NOT
   send this attribute type.

   For this attribute type, the PA-TNC Attribute Vendor ID field MUST be
   set to zero (0) and the PA-TNC Attribute Type field MUST be set to 2.
   The value in the PA-TNC Attribute Length field will vary, depending
   on the length of the Product Name field.  However, the value in the
   PA-TNC Attribute Length field MUST be at least 17 because this is the
   length of the fixed-length fields in the PA-TNC Attribute Header and
   the fixed-length fields in this attribute type.  If the PA-TNC
   Attribute Length field is less than the size of these fixed-length
   fields, implementations SHOULD respond with an Invalid Parameter PA-
   TNC error code.






<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   This attribute type includes both numeric and textual identifiers for
   the organization that created the product (the "product creator") and
   for the product itself.  For automated processing, numeric
   identifiers are superior because they are less ambiguous and more
   efficient.  However, numeric identifiers are only available if the
   product creator has assigned them.  Therefore, a textual identifier
   is also included.  This textual identifier has the additional benefit
   that it may be easier for humans to read (although this benefit is
   minimal since the primary purpose of this attribute is automated
   assessment).

   The following diagram illustrates the format and contents of the
   Attribute Value field for this attribute type.  The text after this
   diagram describes the fields shown here.

                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |               Product Vendor ID               |  Product ID   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Product ID   |         Product Name (Variable Length)        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Product Vendor ID

      This field contains the SMI Private Enterprise Number for the
      product creator.  If the SMI PEN for the product creator is
      unknown or if the product creator does not have an SMI PEN, the
      Product Vendor ID field MUST be set to 0 and the identity of the
      product creator SHOULD be included in the Product Name along with
      the name of the product.

   Product ID

      This field identifies the product using a numeric identifier
      assigned by the product creator.  If this Product ID value is
      unknown or if the product creator has not assigned such a value,
      this field MUST be set to 0.  If the Product Vendor ID is 0, this
      field MUST be set to 0.  In any case, the name of the product
      SHOULD be included in the Product Name field.

      Note that a particular Product ID value (e.g., 635) will have
      completely different meanings depending on the Product Vendor ID.
      Each Product Vendor ID defines a different space of Product ID
      values.  Product creators are encouraged to publish lists of
      Product ID values for their products.





<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   Product Name

      This variable-length field contains a UTF-8 [<a href="#ref-2" title='"UTF-8, a transformation format of ISO 10646"'>2</a>] string identifying
      the product (e.g., "Symantec Norton AntiVirus(TM) 2008") in enough
      detail to unambiguously distinguish it from other products from
      the product creator.  Products whose creator is known, but does
      not have a registered SMI Private Enterprise Number, SHOULD be
      represented using a combination of the creator name and full
      product name (e.g., "Ubuntu(R) IPtables" for the IPtables firewall
      in the Ubuntu distribution of Linux).  If the product creator's
      SMI Private Enterprise Number is included in the Product Vendor ID
      field, the product creator's name may be omitted from this field.

      The length of this field can be determined by starting with the
      value in the PA-TNC Attribute Length field in the PA-TNC Attribute
      Header and subtracting the size of the fixed-length fields in that
      header (12) and the size of the fixed-length fields in this
      attribute (5).  If the PA-TNC Attribute Length field is less than
      the size of these fixed-length fields, implementations SHOULD
      respond with an Invalid Parameter PA-TNC error code.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.3.%20Numeric%20Version"></a><a class="selflink" href="#section-4.2.3" name="section-4.2.3">4.2.3</a>. Numeric Version</span>

   This PA-TNC Attribute Type contains numeric version information for a
   product on the endpoint that implements the component specified in
   the PA Subtype field, as described in <a href="#section-3.5">section 3.5</a>.  For example, if
   the PA Subtype is Operating System, this attribute would contain
   numeric version information for the operating system installed on the
   endpoint.  The version information in this attribute is associated
   with a particular product, so Posture Validators are expected to also
   possess the corresponding Product Information attribute when
   interpreting this attribute.

   All Posture Collectors that implement the IETF Standard PA Subtype
   for Operating System SHOULD support sending this attribute type, at
   least for the Operating System PA subtype.  Other Posture Collectors
   MAY support sending this attribute type.  Whether a particular
   Posture Collector actually sends this attribute type SHOULD still be
   governed by local privacy and security policies.  All Posture
   Validators that implement the IETF Standard PA Subtype for Operating
   System SHOULD support receiving this attribute type, at least for the
   Operating System PA subtype.  Other Posture Validators MAY support
   receiving this attribute type.  A Posture Validator that does not
   support receiving this attribute type SHOULD simply ignore attributes
   with this type.  Posture Validators MUST NOT send this attribute
   type.





<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   For this attribute type, the PA-TNC Attribute Vendor ID field MUST be
   set to zero (0) and the PA-TNC Attribute Type field MUST be set to 3.
   The value in the PA-TNC Attribute Length field MUST be 28.  If the
   PA-TNC Attribute Length field is less than the size of these fixed-
   length fields, implementations SHOULD respond with an Invalid
   Parameter PA-TNC error code.

   This attribute type includes numeric values for the product version
   information, enabling Posture Validators to do comparative operations
   on the version.  Some Posture Collectors may not be able to determine
   some or all of this information for a product.  However, this
   attribute can be especially useful for describing the version of the
   operating system, where numeric version numbers are generally
   available.

   The following diagram illustrates the format and contents of the
   Attribute Value field for this attribute type.  The text after this
   diagram describes the fields shown here.

                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Major Version Number                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Minor Version Number                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                            Build Number                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Service Pack Major       |      Service Pack Minor       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Major Version Number

      This field contains the major version number for the product, if
      applicable.  If unused or unknown, this field SHOULD be set to 0.

   Minor Version Number

      This field contains the minor version number for the product, if
      applicable.  If unused or unknown, this field SHOULD be set to 0.











<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   Build Number

      This field contains the build number for the product, if
      applicable.  This may provide more granularity than the minor
      version number, as many builds may occur leading up to an official
      release, and all these builds may share a single major and minor
      version number.  If unused or unknown, this field SHOULD be set to
      0.

   Service Pack Major

      This field contains the major version number of the service pack
      for the product, if applicable.  If unused or unknown, this field
      SHOULD be set to 0.

   Service Pack Minor

      This field contains the minor version number of the service pack
      for the product, if applicable.  If unused or unknown, this field
      SHOULD be set to 0.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.4.%20%20String%20Version"></a><a class="selflink" href="#section-4.2.4" name="section-4.2.4">4.2.4</a>.  String Version</span>

   This PA-TNC Attribute Type contains string version information for a
   product on the endpoint that implements the component specified in
   the PA Subtype field, as described in <a href="#section-3.5">section 3.5</a>.  For example, if
   the PA Subtype is Firewall, this attribute would contain string
   version information for a host-based firewall product installed on
   the endpoint (if any).  The version information in this attribute is
   associated with a particular product, so Posture Validators are
   expected to also possess the corresponding Product Information
   attribute when interpreting this attribute.

   All Posture Collectors that implement any of the IETF Standard PA
   Subtypes defined in this document MUST support sending this attribute
   type, at least for those PA subtypes.  Other Posture Collectors MAY
   support sending this attribute type.  Whether a particular Posture
   Collector actually sends this attribute type SHOULD still be governed
   by local privacy and security policies.  All Posture Validators that
   implement any of the IETF Standard PA Subtypes defined in this
   document MUST support receiving this attribute type, at least for
   those PA subtypes.  Other Posture Validators MAY support receiving
   this attribute type.  Posture Validators MUST NOT send this attribute
   type.

   For this attribute type, the PA-TNC Attribute Vendor ID field MUST be
   set to zero (0) and the PA-TNC Attribute Type field MUST be set to 4.
   The value in the PA-TNC Attribute Length field will vary, depending



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   on the length of the Component Version Number, Internal Build Number,
   and Configuration Version Number fields.  However, the value in the
   PA-TNC Attribute Length field MUST be at least 15 because this is the
   length of the fixed-length fields in the PA-TNC Attribute Header and
   the fixed-length fields in this attribute type.  If the PA-TNC
   Attribute Length field is less than the size of these fixed-length
   fields or does not match the length indicated by the sum of the
   fixed-length and variable-length fields, implementations SHOULD
   respond with an Invalid Parameter PA-TNC error code.

   The following diagram illustrates the format and contents of the
   Attribute Value field for this attribute type.  The text after this
   diagram describes the fields shown here.

                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Version Len  |   Product Version Number (Variable Length)    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Build Num Len |   Internal Build Number (Variable Length)     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Config. Len  | Configuration Version Number (Variable Length)|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Version Len

      This field defines the number of octets in the Product Version
      Number field.  If the product version number is unavailable or
      unknown, this field MUST be set to 0 and the Product Version
      Number field will be zero length (effectively not present).

   Product Version Number

      This field contains a UTF-8 string identifying the version of the
      component (e.g., "1.12.23.114").  This field MUST be sized to fit
      the version string and MUST NOT include extra octets for padding
      or NUL character termination.

      Various products use a wide range of different formats and
      semantics for version strings.  Some use alphabetic characters,
      white space, and punctuation.  Some consider version "1.21" to be
      later than version "1.3" and some earlier.  Therefore, the syntax
      and semantics of this string are not defined.








<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   Build Num Len

      This field defines the number of octets in the Internal Build
      Number field.  For products where the internal build number is
      unavailable or unknown, this field MUST be set to 0 and the
      Internal Build Number field will be zero length (effectively not
      present).

   Internal Build Number

      This field contains a UTF-8 string identifying the engineering
      build number of the product.  This field MUST be sized to fit the
      build number string and MUST NOT include extra octets for padding
      or NUL character termination.  The syntax and semantics of this
      string are not defined.

   Config. Len

      This field defines the number of octets in the Configuration
      Version Number field.  If the configuration version number is
      unavailable or unknown, this field MUST be set to 0 and the
      Configuration Version Number field will be zero length
      (effectively not present).

   Configuration Version Number

      This field contains a UTF-8 string identifying the version of the
      configuration used by the component.  This version SHOULD
      represent the overall configuration version even if several
      configuration policy files or settings are used.  Posture
      Collectors MAY include multiple version numbers in this single
      string if a single version is not practical.  This field MUST be
      sized to fit the version string and MUST NOT include extra octets
      for padding or NUL character termination.

      Various products use a wide range of different formats for version
      strings.  Some use alphabetic characters, white space, and
      punctuation.  Some consider version "1.21" to be later than
      version "1.3" and some earlier.  In addition, some Posture
      Collectors may place multiple configuration version numbers in
      this single string.  Therefore, the syntax and semantics of this
      string are not defined.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.5.%20%20Operational%20Status"></a><a class="selflink" href="#section-4.2.5" name="section-4.2.5">4.2.5</a>.  Operational Status</span>

   This PA-TNC Attribute Type describes the operational status of a
   product that can implement the component specified in the PA Subtype
   field, as described in <a href="#section-3.5">section 3.5</a>. For example, if the PA Subtype is



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   Anti-Spyware, this attribute would contain information about the
   operational status of a host-based anti-spyware product that may or
   may not be installed on the endpoint.

   Posture Collectors that implement the IETF Standard PA Subtype for
   Operating System or VPN MAY support sending this attribute type for
   those PA subtypes.  Posture Collectors that implement other IETF
   Standard PA Subtypes defined in this specification SHOULD support
   sending this attribute type for those PA subtypes.  Other Posture
   Collectors MAY support sending this attribute type.  Whether a
   particular Posture Collector actually sends this attribute type
   SHOULD still be governed by local privacy and security policies.
   Posture Validators that implement the IETF Standard PA Subtype for
   Operating System or VPN MAY support receiving this attribute type, at
   least for those PA subtypes.  Posture Validators that implement other
   IETF Standard PA Subtypes defined in this specification SHOULD
   support receiving this attribute type, at least for those PA
   subtypes.  Other Posture Validators MAY support receiving this
   attribute type.  A Posture Validator that does not support receiving
   this attribute type SHOULD simply ignore attributes with this type.
   Posture Validators MUST NOT send this attribute type.

   For this attribute type, the PA-TNC Attribute Vendor ID field MUST be
   set to zero (0) and the PA-TNC Attribute Type field MUST be set to 5.
   The value in the PA-TNC Attribute Length field MUST be 36.  If the
   PA-TNC Attribute Length field does not have this value,
   implementations SHOULD respond with an Invalid Parameter PA-TNC error
   code.

   The following diagram illustrates the format and contents of the
   Attribute Value field for this attribute type.  The text after this
   diagram describes the fields shown here.

                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    Status     |     Result    |         Reserved              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Last Use                             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Last Use (continued)                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Last Use (continued)                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Last Use (continued)                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Last Use (continued)                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   Status

      This field gives the operational status of the product.  The
      following table lists the values currently defined for this field.

      Value   Description
      -----   -----------
      0       Unknown or other
      1       Not installed
      2       Installed but not operational
      3       Operational

      If a Posture Validator receives a value for this field that it
      does not recognize, it SHOULD treat this value as equivalent to
      the value 0.

   Result

      This field contains the result of the last use of the product.
      The following table lists the values currently defined for this
      field.

      Value   Description
      -----   -----------
      0       Unknown or other
      1       Successful use with no errors detected
      2       Successful use with one or more errors detected
      3       Unsuccessful use (e.g., aborted)

      Posture Collectors SHOULD set this field to 0 if the Status field
      contains a value of 1 (Not installed) or 2 (Installed but not
      operational).  If a Posture Validator receives a value for this
      field that it does not recognize, it SHOULD treat this value as
      equivalent to the value 0.

   Reserved

      This field is reserved for future use.  The field MUST be set to 0
      on transmission and ignored upon reception.

   Last Use

      This field contains the date and time of the last use of the
      component.  The Last Use date and time MUST be represented as an
      <a href="rfc3339.html">RFC 3339</a> [<a href="#ref-4" title='"Date and Time on the Internet: Timestamps"'>4</a>] compliant ASCII string in Coordinated Universal Time
      (UTC) time with the additional restrictions that the 't' delimiter
      and the 'z' suffix MUST be capitalized and fractional seconds
      (time-secfrac) MUST NOT be included.



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


      This field conforms to the date-time ABNF production from <a href="rfc3339.html#section-5.6">section</a>
      <a href="rfc3339.html#section-5.6">5.6 of RFC 3339</a> with the above restrictions.  Leap seconds are
      permitted and Posture Validators MUST support them.

      The last use string MUST NOT be NUL terminated or padded in any
      way.  If the last use time is not known, not applicable, or cannot
      be represented in this format, the Posture Collector MUST set this
      field to the value "0000-00-00T00:00:00Z" (allowing this field to
      be fixed length).  Note that this particular reserved value is NOT
      a valid <a href="rfc3339.html">RFC 3339</a> date and time and MUST NOT be used for any other
      purpose in this field.

      This encoding produces a string that is easy to read, parse, and
      interpret.  The format (more precisely defined in <a href="rfc3339.html">RFC 3339</a>) is
      YYYY-MM-DDTHH:MM:SSZ, resulting in one and only one representation
      for each second in UTC time from year 0000 to year 9999.  For
      example, 9:05:00AM EST (GMT-0500) on January 19, 1995 can be
      represented as "1995-01-19T14:05:00Z".  The length of this field
      is always 20 octets.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.6.%20%20Port%20Filter"></a><a class="selflink" href="#section-4.2.6" name="section-4.2.6">4.2.6</a>.  Port Filter</span>

   This PA-TNC Attribute Type provides the list of port numbers and
   associated protocols (e.g., TCP and UDP) that are currently blocked
   or allowed by a host-based firewall on the endpoint.

   Posture Collectors that implement the IETF Standard PA Subtype for
   Firewall or VPN SHOULD support sending this attribute type for those
   PA subtypes.  Posture Collectors that implement other IETF Standard
   PA Subtypes defined in this specification MUST NOT support sending
   this attribute type for those PA subtypes.  Other Posture Collectors
   MAY support sending this attribute type, if it is appropriate to
   their PA subtype.  Whether a particular Posture Collector actually
   sends this attribute type SHOULD still be governed by local privacy
   and security policies.  Posture Validators that implement the IETF
   Standard PA Subtype for Firewall or VPN SHOULD support receiving this
   attribute type, at least for those PA subtypes.  Posture Validators
   that implement other IETF Standard PA Subtypes defined in this
   specification MUST NOT support receiving this attribute type for
   those PA subtypes.  Other Posture Validators MAY support receiving
   this attribute type.  A Posture Validator that does not support
   receiving this attribute type SHOULD simply ignore attributes with
   this type.  Posture Validators MUST NOT send this attribute type.

   For this attribute type, the PA-TNC Attribute Vendor ID field MUST be
   set to zero (0) and the PA-TNC Attribute Type field MUST be set to 6.





<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 29]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   The following diagram illustrates the format and contents of the
   Attribute Value field for this attribute type.  The text after this
   diagram describes the fields shown here.

   Note that this diagram shows two Protocol/Port Number pairs.  The
   actual number of Protocol/Port Number pairs included in a Port Filter
   attribute can vary from one to a large number (limited only by the
   maximum message and length supported by the underlying PT protocol).
   However, each Port Filter attribute MUST contain at least one
   Protocol/Port Number pair.  Because the length of a Protocol/Port
   Number pair with the Reserved field and B flag is always 4 octets,
   the number of Protocol/Port Number pairs can be easily computed using
   the PA-TNC Attribute Length field by subtracting the number of octets
   in the PA-TNC Attribute Header and dividing by 4.  If the PA-TNC
   Attribute Length field is invalid, Posture Validators SHOULD respond
   with an Invalid Parameter PA-TNC error code.

                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Reserved  |B|    Protocol   |         Port Number           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Reserved  |B|    Protocol   |         Port Number           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Reserved

      This field is reserved for future use.  It MUST be set to 0 on
      transmission and ignored upon reception.

   B Flag (Blocked or Allowed Port)

      This single-bit field indicates whether the following port is
      blocked or allowed.  This bit MUST be set to 1 if the protocol and
      port combination is blocked.  Otherwise, this field MUST be set to
      0.  This field was provided to allow for more abbreviated
      reporting of the port filtering policy (e.g., when all ports are
      blocked except a few, the Posture Collector can just list the few
      that are allowed).

      Posture Collectors MUST NOT provide a mixed list of blocked and
      non-blocked ports for a particular protocol.  To be more precise,
      a Posture Collector MUST NOT include two Protocol/Port Number
      pairs in a single Port Filter attribute where the protocol number
      is the same but the B flag is different.  Also, Posture Collectors
      MUST NOT list the same Protocol and Port Number combination twice
      in a Port List attribute.




<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 30]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


      Posture Collectors MAY list all blocked ports for one protocol and
      all allowed ports for a different protocol in a single Port List
      attribute, using the B flag to indicate whether each entry is
      blocked.  For example, a Posture Collector might list all the
      blocked TCP ports but only list the allowed UDP ports.  However,
      it MUST NOT list some blocked TCP ports and some other allowed TCP
      ports.

   Protocol

      This field contains the transport protocol number (e.g., tcp is 6)
      being blocked or allowed.  The values used in this field are the
      same ones used in the IPv4 Protocol and IPv6 Next Header fields.
      The IANA already maintains the Assigned Internet Protocol Numbers
      registry of these values for use in this field.

   Port Number

      This field contains the transport protocol (e.g., tcp) port number
      being blocked or allowed.  The values used in this field are
      specific to the protocol identified by the Protocol field.  The
      IANA maintains registries for well-known and user-requested TCP
      and UDP port numbers for use in this field.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.7.%20%20Installed%20Packages"></a><a class="selflink" href="#section-4.2.7" name="section-4.2.7">4.2.7</a>.  Installed Packages</span>

   This PA-TNC Attribute Type contains a list of the installed packages
   that comprise a product on the endpoint that implements the component
   specified in the PA Subtype field, as described in <a href="#section-3.5">section 3.5</a>.  This
   allows a Posture Validator to check which packages are installed for
   a particular product and which versions of those packages are
   installed.

   Posture Collectors that implement any of the IETF Standard PA
   Subtypes defined in this document SHOULD support sending this
   attribute type for those PA subtypes.  Other Posture Collectors MAY
   support sending this attribute type, if it is appropriate to their PA
   subtype.  Whether a particular Posture Collector actually sends this
   attribute type SHOULD still be governed by local privacy and security
   policies.  Posture Validators that implement any of the IETF Standard
   PA Subtypes defined in this document SHOULD support receiving this
   attribute type, at least for those PA subtypes.  Other Posture
   Validators MAY support receiving this attribute type.  A Posture
   Validator that does not support receiving this attribute type SHOULD
   simply ignore attributes with this type.  Posture Validators MUST NOT
   send this attribute type.





<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 31]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   This attribute type can be quite long, especially for the Operating
   System PA subtype.  This can cause problems, especially with 802.1X
   and other limited transport protocols.  Therefore, Posture Collectors
   SHOULD NOT send this attribute unless specifically requested to do so
   using the Attribute Request attribute or otherwise configured to do
   so.  Also, Posture Validators SHOULD NOT request this attribute
   unless the transport protocol in use can support the large amount of
   data that may be sent in response.

   For this attribute type, the PA-TNC Attribute Vendor ID field MUST be
   set to zero (0) and the PA-TNC Attribute Type field MUST be set to 7.
   The value in the PA-TNC Attribute Length field will vary, depending
   on the number of packages and the length of the Package Name and
   Package Version Number fields for those packages.  However, the value
   in the PA-TNC Attribute Length field MUST be at least 16 because this
   is the length of the fixed-length fields in the PA-TNC Attribute
   Header and the fixed-length fields in this attribute type.  If the
   PA-TNC Attribute Length field is less than the size of these fixed-
   length fields or does not match the length indicated by the sum of
   the fixed-length and variable-length fields, implementations SHOULD
   respond with an Invalid Parameter PA-TNC error code.

   The following diagram illustrates the format and contents of the
   Attribute Value field for this attribute type.  The text after this
   diagram describes the fields shown here.

   Note that this diagram shows an attribute containing information on
   one package.  The actual number of package descriptions included in
   an Installed Packages attribute is indicated by the Package Count
   field.  This value may vary from zero to a large number (up to 65535,
   if the underlying PT protocol can support that many).  If this number
   is not sufficient, specialized patch management software should be
   employed that can simply report compliance with a pre-established
   patch policy.

                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          Reserved             |         Package Count         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Pkg Name Len  |        Package Name (Variable Length)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Version Len  |    Package Version Number (Variable Length)   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+







<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 32]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   Reserved

      This field is reserved for future use.  The field MUST be set to 0
      on transmission and ignored upon reception.

   Package Count

      This field is an unsigned 16-bit integer that indicates the number
      of packages listed in this attribute.  For each package so
      indicated, a Pkg Name Len, Package Name, Version Len, and Package
      Version Number field is included in the attribute.

   Pkg Name Len

      This field is an unsigned 8-bit integer that indicates the length
      of the Package Name field in octets.  This field may be zero if a
      Package Name is not available.

   Package Name

      This field contains the name of the package associated with the
      product.  This field is a UTF-8 encoded character string whose
      octet length is given by the Pkg Name Len field.  This field MUST
      NOT include extra octets for padding or NUL character termination.
      The syntax and semantics of this name are not specified in this
      document, since they may vary across products and/or operating
      systems.  Posture Collectors MAY list two packages with the same
      name in a single Installed Packages attribute.  The meaning of
      doing so is not defined here.

   Version Len

      This field is an unsigned 8-bit integer that indicates the length
      of the Package Version Number field in octets.  This field may be
      zero if a Package Version Number is not available.

   Package Version Number

      This field contains the version string for the package named in
      the previous Package Name field.  This field is a UTF-8 encoded
      character string whose octet length is given by the Version Len
      field.  This field MUST NOT include extra octets for padding or
      NUL character termination.  The syntax and semantics of this
      version string are not specified in this document, since they may
      vary across products and/or operating systems.  Posture Collectors






<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 33]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-34" id="page-34" name="page-34"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


      MAY list two packages with the same Package Version Number (and
      even the same Package Name and Package Version Number) in a single
      Installed Packages attribute.  The meaning of doing so is not
      defined here.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.8.%20%20PA-TNC%20Error"></a><a class="selflink" href="#section-4.2.8" name="section-4.2.8">4.2.8</a>.  PA-TNC Error</span>

   This PA-TNC Attribute Type contains an error code and supplemental
   information regarding an error pertaining to PA-TNC.

   All Posture Collectors and Posture Validators that implement any of
   the IETF Standard PA Subtypes defined in this specification MUST
   support sending and receiving this attribute type, at least for those
   PA subtypes.

   For this attribute type, the PA-TNC Attribute Vendor ID field MUST be
   set to zero (0) and the PA-TNC Attribute Type field MUST be set to 8.
   The value in the PA-TNC Attribute Length field will vary, depending
   on the length of the Error Information field.  However, the value in
   the PA-TNC Attribute Length field MUST be at least 20 because this is
   the length of the fixed-length fields in the PA-TNC Attribute Header
   and the fixed-length fields in this attribute type.

   A PA-TNC error code SHOULD be sent with the same PA Message Vendor ID
   and PA Subtype used by the PA-TNC message that caused the error so
   that the error code is sent to the party who sent the offending PA-
   TNC message.  Other measures (such as setting PB-TNC's EXCL flag and
   Posture Collector Identifier or Posture Validator Identifier fields)
   SHOULD also be taken to attempt to ensure that only the party who
   sent the offending message receives the error.

   When a PA-TNC error code is received, the recipient MUST NOT respond
   with a PA-TNC error code because this could result in an infinite
   loop of errors.  Instead, the recipient MAY log the error, modify its
   behavior to attempt to avoid the error (attempting to avoid loops or
   long strings of errors), ignore the error, terminate the assessment,
   or take other action as appropriate (as long as it is consistent with
   the requirements of this specification).

   Posture Validators MUST NOT include this attribute type in an
   Attribute Request attribute.  It does not make sense for a Posture
   Validator to request that a Posture Collector send a PA-TNC Error
   attribute.








<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 34]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-35" id="page-35" name="page-35"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   The following diagram illustrates the format and contents of the
   Attribute Value field for this attribute type.  The text after this
   diagram describes the fields shown here.

                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    Reserved   |            PA-TNC Error Code Vendor ID        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        PA-TNC Error Code                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                 Error Information (Variable Length)           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Reserved

      This field is reserved for future use.  This field MUST be set to
      0 on transmission and ignored upon reception.

   PA-TNC Error Code Vendor ID

      This field contains the SMI Private Enterprise Number for the
      organization that defined the PA-TNC Error Code that is being used
      in the attribute.  For IETF Standard PA-TNC Error Code values this
      field MUST be set to zero (0).

   PA-TNC Error Code

      This field contains the PA-TNC Error Code being reported in this
      attribute.  Note that a particular PA-TNC Error Code value will
      have completely different meanings depending on the PA-TNC Error
      Code Vendor ID.  Each PA-TNC Error Code Vendor ID defines a
      different space of PA-TNC Error Code values.  Posture Collectors
      and Posture Validators MUST NOT require support for particular
      vendor-specific PA-TNC Error Codes and MUST interoperate with
      other parties despite any differences in the set of vendor-
      specific PA-TNC Error Codes supported (although they MAY permit
      administrators to configure them to require support for specific
      PA-TNC Error Codes).

      When the PA-TNC Error Code Vendor ID is set to zero (0), the PA-
      TNC Error Code is an IETF Standard PA-TNC Error Code.  IANA
      maintains a registry of PA-TNC Error Codes.  Entries in this
      registry are added by Expert Review with Specification Required,
      following the guidelines in <a href="#section-7">section 7</a>.






<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 35]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-36" id="page-36" name="page-36"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


      The following table lists the IETF Standard PA-TNC Error Codes
      defined in this specification:

      Integer   Description
      -------   -----------
      0         Reserved
      1         Invalid Parameter
      2         Version Not Supported
      3         Attribute Type Not Supported

      The next few subsections of this document provide detailed
      definitions of these error codes.

   Error Information

      This field provides additional context for the error.  The
      contents of this field vary based on the PA-TNC Error Code Vendor
      ID and PA-TNC Error Code.  Therefore, whenever a PA-TNC Error Code
      is defined, the format of this field for that error code must also
      be defined.  The definitions of IETF Standard PA-TNC Error Codes
      on the next few pages provide good examples of such definitions.

      The length of this field can be determined by the recipient using
      the PA-TNC Attribute Length field by subtracting the length of the
      fixed-length fields in the PA-TNC Attribute Header and the fixed-
      length fields in this attribute.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.8.1.%20%20Invalid%20Parameter%20Error%20Code"></a><a class="selflink" href="#section-4.2.8.1" name="section-4.2.8.1">4.2.8.1</a>.  Invalid Parameter Error Code</span>

   The Invalid Parameter error code is an IETF Standard PA-TNC Error
   Code (value 1) that indicates that the sender of this error code has
   detected an invalid value in a PA-TNC message sent by the recipient
   of this error code in the current assessment.

   For this error code, the Error Information field contains the first 8
   octets of the PA-TNC message that contained the invalid parameter and
   an offset indicating the position within that message of the invalid
   parameter.













<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 36]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-37" id="page-37" name="page-37"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   The following diagram illustrates the format and contents of the
   Error Information field for this error code.  The text after this
   diagram describes the fields shown here.

                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    Version    |            Copy of Reserved                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Message Identifier                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                             Offset                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Version

      This field MUST contain an exact copy of the Version field in the
      PA-TNC Message Header of the PA-TNC message that caused this
      error.

   Copy of Reserved

      This field MUST contain an exact copy of the Reserved field in the
      PA-TNC Message Header of the PA-TNC message that caused this
      error.

   Message Identifier

      This field MUST contain an exact copy of the Message Identifier
      field in the PA-TNC Message Header of the PA-TNC message that
      caused this error.

   Offset

      This field MUST contain an octet offset from the start of the PA-
      TNC Message Header of the PA-TNC message that caused this error to
      the start of the value that caused this error.  For instance, if
      the first PA-TNC attribute in the message had an invalid PA-TNC
      Attribute Length (e.g., 0), this value would be 16.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.8.2.%20%20Version%20Not%20Supported%20Error%20Code"></a><a class="selflink" href="#section-4.2.8.2" name="section-4.2.8.2">4.2.8.2</a>.  Version Not Supported Error Code</span>

   The Version Not Supported error code is an IETF Standard PA-TNC Error
   Code (value 2) that indicates that the sender of this error code does
   not support the PA-TNC version number included in the PA-TNC Message
   Header of a PA-TNC message sent by the recipient of this error code
   in the current assessment.




<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 37]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-38" id="page-38" name="page-38"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   For this error code, the Error Information field contains the first 8
   octets of the PA-TNC message that contained the unsupported version
   as well as Max Version and Min Version fields that indicate which PA-
   TNC version numbers are supported by the sender of the error code.

   The sender MUST support all PA-TNC versions between the Min Version
   and the Max Version, inclusive (i.e., including the Min Version and
   the Max Version).  When possible, recipients of this error code
   SHOULD send future messages to the Posture Collector or Posture
   Validator that originated this error message with a PA-TNC version
   number within the stated range.

   Any party that is sending the Version Not Supported error code MUST
   include that error code as the only PA-TNC attribute in a PA-TNC
   message with version number 1.  All parties that send PA-TNC messages
   MUST be able to properly process a message that meets this
   description, even if they cannot process any other aspect of PA-TNC
   version 1.  This ensures that a PA-TNC version exchange can proceed
   properly, no matter what versions of PA-TNC the parties implement.

   The following diagram illustrates the format and contents of the
   Error Information field for this error code.  The text after this
   diagram describes the fields shown here.

                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    Version    |                Copy of Reserved               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Message Identifier                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Max Version  |  Min Version  |            Reserved           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Version

      This field MUST contain an exact copy of the Version field in the
      PA-TNC Message Header of the PA-TNC message that caused this
      error.

   Copy of Reserved

      This field MUST contain an exact copy of the Reserved field in the
      PA-TNC Message Header of the PA-TNC message that caused this
      error.






<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 38]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-39" id="page-39" name="page-39"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   Message Identifier

      This field MUST contain an exact copy of the Message Identifier
      field in the PA-TNC Message Header of the PA-TNC message that
      caused this error.

   Max Version

      This field MUST contain the maximum PA-TNC version supported by
      the sender of this error code.

   Min Version

      This field MUST contain the minimum PA-TNC version supported by
      the sender of this error code.

   Reserved

      Reserved for future use.  This field MUST be set to 0 on
      transmission and ignored upon reception.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.8.3.%20%20Attribute%20Type%20Not%20Supported%20Error%20Code"></a><a class="selflink" href="#section-4.2.8.3" name="section-4.2.8.3">4.2.8.3</a>.  Attribute Type Not Supported Error Code</span>

   The Attribute Type Not Supported error code is an IETF Standard PA-
   TNC Error Code (value 3) that indicates that the sender of this error
   code does not support the PA-TNC Attribute Type included in the Error
   Information field.  This PA-TNC Attribute Type was included in a PA-
   TNC message sent by the recipient of this error code in the current
   assessment.

   For this error code, the Error Information field contains the first 8
   octets of the PA-TNC message that contained the unsupported attribute
   type as well as a copy of the attribute type that caused the problem.


















<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 39]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-40" id="page-40" name="page-40"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   The following diagram illustrates the format and contents of the
   Error Information field for this error code.  The text after this
   diagram describes the fields shown here.

                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    Version    |            Copy of Reserved                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Message Identifier                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Flags     |          PA-TNC Attribute Vendor ID           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     PA-TNC Attribute Type                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Version

      This field MUST contain an exact copy of the Version field in the
      PA-TNC Message Header of the PA-TNC message that caused this
      error.

   Copy of Reserved

      This field MUST contain an exact copy of the Reserved field in the
      PA-TNC Message Header of the PA-TNC message that caused this
      error.

   Message Identifier

      This field MUST contain an exact copy of the Message Identifier
      field in the PA-TNC Message Header of the PA-TNC message that
      caused this error.

   Flags

      This field MUST contain an exact copy of the Flags field in the
      PA-TNC Attribute Header of the PA-TNC attribute that caused this
      error.

   PA-TNC Attribute Vendor ID

      This field MUST contain an exact copy of the PA-TNC Attribute
      Vendor ID field in the PA-TNC Attribute Header of the PA-TNC
      attribute that caused this error.






<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 40]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-41" id="page-41" name="page-41"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   PA-TNC Attribute Type

      This field MUST contain an exact copy of the PA-TNC Attribute Type
      field in the PA-TNC Attribute Header of the PA-TNC attribute that
      caused this error.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.9.%20%20Assessment%20Result"></a><a class="selflink" href="#section-4.2.9" name="section-4.2.9">4.2.9</a>.  Assessment Result</span>

   This PA-TNC attribute contains the final assessment result from a
   particular Posture Validator.  This attribute might be returned to a
   Posture Collector for information purposes such as when an endpoint
   is compliant.  Similarly, the Assessment Result attribute could be
   sent to indicate a non-compliant result where specific actions are
   needed to bring an endpoint into compliance with the network's
   policies.  These actions could be defined in other PA-TNC attributes
   such as Remediation Instructions sent to the Posture Collector.

   All Posture Collectors that support an IETF Standard PA Subtype
   defined in this specification SHOULD support receiving and processing
   the Assessment Result attribute.  All Posture Validators that
   implement an IETF Standard PA Subtype defined in this specification
   SHOULD support sending the Assessment Result attribute.

   For this attribute type, the PA-TNC Attribute Vendor ID field MUST be
   set to zero (0) and the PA-TNC Attribute Type field MUST be set to 9.

   The following diagram illustrates the format and contents of the
   Attribute Value field for this attribute type.  The text after this
   diagram describes the fields shown here.

                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Assessment Result                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Assessment Result

      This 32-bit field MUST contain one of the following values;

       Value   Description
       -----   -----------
       0      Posture Validator assessed the endpoint component to
              be compliant with policy.

       1      Posture Validator assessed the endpoint component to
              be non-compliant with policy but the difference from
              compliant was minor.



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 41]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-42" id="page-42" name="page-42"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


       2      Posture Validator assessed the endpoint component to
              be non-compliant with policy and the assessed
              difference was very significant.

       3      Posture Validator was unable to determine policy
              compliance of an endpoint component due to an error.

       4      Posture Validator was unable to determine whether the
              assessed endpoint component was compliant with policy
              based on the attributes provided by the Posture
              Collector.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.10.%20%20Remediation%20Instructions"></a><a class="selflink" href="#section-4.2.10" name="section-4.2.10">4.2.10</a>.  Remediation Instructions</span>

   This PA-TNC attribute sent by the Posture Validator to the Posture
   Collector contains remediation instructions for updating a particular
   component to make the endpoint compliant with the assessment
   policies.  A Posture Validator might choose to send more than one
   Remediation Instructions attribute in some circumstances (e.g., both
   a URI and a human-readable message are necessary) to remediate one or
   more components.  This attribute supports the inclusion of either an
   IETF standard or vendor-specific remediation instruction.

   All Posture Collectors that implement an IETF Standard PA Subtype
   defined in this specification SHOULD support receiving and processing
   the Remediation Instructions attribute.  All Posture Validators that
   implement an IETF Standard PA Subtype defined in this specification
   SHOULD support sending this attribute type.  Posture Collectors and
   Posture Validators supporting other non-IETF standard components MAY
   support this attribute.

   For this attribute type, the PA-TNC Attribute Vendor ID field MUST be
   set to zero (0) and the PA-TNC Attribute Type field MUST be set to
   10.

   The following diagram illustrates the format and contents of the
   Attribute Value field for this attribute type.  The text after this
   diagram describes the fields shown here.

                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    Reserved   |       Remediation Parameters Vendor ID        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                  Remediation Parameters Type                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |            Remediation Parameters (Variable Length)           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 42]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-43" id="page-43" name="page-43"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   Reserved (8 bits)

      The Reserved bits MUST be set to 0 on transmission and ignored on
      reception.

   Remediation Parameters Vendor ID (24 bits)

      The Remediation Parameters Vendor ID field identifies a vendor by
      using the SMI Private Enterprise Number (PEN).  Any organization
      can receive its own unique PEN from IANA, the Internet Assigned
      Numbers Authority.  The Remediation Parameters Vendor ID qualifies
      the Remediation Parameters Type field so that each vendor has 2^32
      separate Remediation Parameters Types available for its use.
      Remediation Parameters Types standardized by the IETF are always
      used with the value zero (0) in this field.

   Remediation Parameters Type (32 bits)

      The Remediation Parameters Type field identifies the different
      types of remediation instructions that can be contained in the
      Remediation Parameters field.  IANA maintains a registry of PA-TNC
      Remediation Parameters Types.  Entries in this registry are added
      by Expert Review with Specification Required, following the
      guidelines in <a href="#section-7">section 7</a>.  A list of IETF Standard PA-TNC
      Remediation Parameters Types defined in this specification appears
      later in this section.

      New vendor-specific remediation instructions can be created by
      adding new Remediation Parameters Types (those used with a non-
      zero Remediation Parameters vendor ID) without IETF or IANA
      involvement.  Posture Collectors and Posture Validators MUST NOT
      require support for particular vendor-specific PA-TNC Remediation
      Parameters Types and MUST interoperate with other parties despite
      any differences in the set of vendor-specific PA-TNC Remediation
      Parameters Types supported (although they MAY permit
      administrators to configure them to require support for specific
      PA-TNC remediation parameter types).

      The following table lists the IETF Standard PA-TNC Remediation
      Parameters Type values defined in this specification:

      Integer   Description
      -------   -----------
      0         Reserved
      1         Remediation URI
      2         Remediation String





<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 43]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-44" id="page-44" name="page-44"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


      The next few subsections of this document provide detailed
      definitions of the contents of the Remediation Parameters field
      used with each Remediation Parameter Type.

   Remediation Parameters (variable length)

      The Remediation Parameters field contains the actual remediation
      instructions for the Posture Collector.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.10.1.%20%20Remediation%20URI%20Parameters%20Type"></a><a class="selflink" href="#section-4.2.10.1" name="section-4.2.10.1">4.2.10.1</a>.  Remediation URI Parameters Type</span>

   The Remediation URI Parameters Type is an IETF Standard Remediation
   Parameters Type (value 1) that indicates that the sending Posture
   Validator is providing a URI to instructions on how to remediate the
   endpoint.

   The following diagram illustrates the format and contents of the
   Remediation Parameters field when carrying a Remediation URI
   parameter.  The text after this diagram describes the fields shown
   here.

                       1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                 Remediation URI (Variable Length)             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Remediation URI

      The Remediation URI field MUST contain a URI, as described in <a href="rfc3986.html">RFC</a>
      <a href="rfc3986.html">3986</a> [<a href="#ref-7" title='"Uniform Resource Identifier (URI): Generic Syntax"'>7</a>].  This URI SHOULD contain instructions to update a
      particular component so that it might result in the component
      being compliant with the policies in future assessments.  Posture
      Collectors should validate that the URI and instructions come from
      a trustworthy source to avoid being tricked into performing
      damaging actions (see security considerations).

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.10.2.%20%20Remediation%20String%20Parameters%20Type"></a><a class="selflink" href="#section-4.2.10.2" name="section-4.2.10.2">4.2.10.2</a>.  Remediation String Parameters Type</span>

   The Remediation String Parameters Type is an IETF Standard
   Remediation Parameters Type (value 2) that indicates that the sending
   Posture Validator is providing a human-readable string containing
   instructions on how to remediate the endpoint.

   The following diagram illustrates the format and contents of the
   Remediation Parameters field when the carrying a Remediation String
   parameter.  The text after this diagram describes the fields shown
   here.



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 44]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-45" id="page-45" name="page-45"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


                       1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                   Remediation String Length                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Remediation String (Variable Length)           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Lang Code Len |  Remediation String Lang Code (Variable Len)  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Remediation String Length

      The Remediation String Length contains the length of the
      Remediation String field in octets.

   Remediation String

      The Remediation String field MUST contain a UTF-8 encoded string.
      This string contains human-readable instructions for remediation
      that MAY be displayed to the user by the Posture Collector.  NUL
      termination MUST NOT be included.  If a Posture Collector receives
      a Remediation String that does contain a NUL termination, it
      SHOULD send an Invalid Parameter error code.

   Lang Code Len (Remediation String Language Code Length)

      The Lang Code Len field contains the length of the Remediation
      String Language Code field in octets.

   Remediation String Lang Code

      The Remediation String Lang(uage) Code field contains a US-ASCII
      string composed of a well-formed <a href="rfc4646.html">RFC 4646</a> [<a href="#ref-6" title='"Tags for Identifying Languages"'>6</a>] language tag that
      indicates the language(s) used in the Remediation String in the
      Remediation Parameters field.  A zero-length string MAY be sent
      for this field (essentially omitting this field) to indicate that
      the language code for the remediation string is not known.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.11.%20%20Forwarding%20Enabled"></a><a class="selflink" href="#section-4.2.11" name="section-4.2.11">4.2.11</a>.  Forwarding Enabled</span>

   This PA-TNC attribute indicates whether the endpoint is forwarding
   traffic between interfaces.  Endpoints that forward traffic between
   networks connected to multiple network interfaces may be considered
   non-compliant (and a security risk) in some enterprise network
   deployments.  For example, an endpoint with multiple connected
   network interfaces might allow traffic from an interface connected to
   a public network to be forwarded through another interface carrying a
   VPN session to a protected enterprise network.  This attribute is



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 45]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-46" id="page-46" name="page-46"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   currently envisioned to be specific to reporting posture for the
   operating system component; however, could be useful for other future
   types of components.

   Posture Collectors that implement the IETF Standard PA Subtype for
   Operating System SHOULD support sending the Forwarding Enabled
   attribute.  Posture Collectors that do not implement the Operating
   System PA Subtype defined in this specification SHOULD NOT send the
   Forwarding Enabled attribute unless it is appropriate to their PA
   Subtype.  Whether a particular Posture Collector actually sends this
   attribute type SHOULD still be governed by local privacy and security
   policies.  Posture Validators that implement the IETF Standard PA
   Subtype for Operating System SHOULD support receiving the Forwarding
   Enabled attribute type.  Posture Validators supporting components
   other than Operating System MAY support receiving this attribute type
   if it is appropriate to their PA Subtype.  A Posture Validator that
   does not support receiving this attribute type SHOULD simply ignore
   attributes with this type.  Posture Validators MUST NOT send this
   attribute type.

   For this attribute type, the PA-TNC Attribute Vendor ID field MUST be
   set to zero (0) and the PA-TNC Attribute Type field MUST be set to
   11.

   The following diagram illustrates the format and contents of the
   Attribute Value field for this attribute type.  The text after this
   diagram describes the fields shown here.

                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Forwarding Enabled                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Forwarding Enabled

      This 32-bit field MUST contain one of the following values;

      Value   Description
      -----   -----------
        0       Disabled - Endpoint is not forwarding traffic.

        1       Enabled -  Endpoint is forwarding traffic.

        2       Unknown -  Unable to determine whether endpoint is
                           forwarding traffic





<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 46]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-47" id="page-47" name="page-47"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.12.%20%20Factory%20Default%20Password%20Enabled"></a><a class="selflink" href="#section-4.2.12" name="section-4.2.12">4.2.12</a>.  Factory Default Password Enabled</span>

   This PA-TNC attribute indicates whether the endpoint has a factory
   default password enabled for use.  Some types of endpoints include a
   default static password for used to gain privileged access to the
   endpoint.  If this password is not changed or disabled before the
   endpoint is accessible on the network, it's often easy to compromise
   the endpoint.

   Posture Collectors that implement the IETF Standard PA Subtype for
   Operating System SHOULD support sending the Factory Default Password
   Enabled attribute.  Posture Collectors that implement other IETF
   Standard PA Subtypes defined in this specification SHOULD NOT support
   sending this attribute type for those PA subtypes.  Other Posture
   Collectors MAY support sending this attribute type, if it is
   appropriate to their PA subtype.  Whether a particular Posture
   Collector actually sends this attribute type SHOULD still be governed
   by local privacy and security policies.  Posture Validators that
   implement the IETF Standard PA Subtype for Operating System SHOULD
   support receiving the Factory Default Password Enabled attribute.
   Other Posture Validators MAY support receiving this attribute type.
   A Posture Validator that does not support receiving this attribute
   type SHOULD simply ignore attributes with this type.  Posture
   Validators MUST NOT send this attribute type.

   For this attribute type, the PA-TNC Attribute Vendor ID field MUST be
   set to zero (0) and the PA-TNC Attribute Type field MUST be set to
   12.

   The following diagram illustrates the format and contents of the
   Attribute Value field for this attribute type.  The text after this
   diagram describes the fields shown here.

                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |              Factory Default Password Enabled                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Factory Default Password Enabled

      This 32-bit field MUST contain one of the following values;

      Value   Description
      -----   -----------
      0       Endpoint does not have factory default password enabled.

      1       Endpoint has a factory default password enabled.



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 47]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-48" id="page-48" name="page-48"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Vendor-Defined%20Attributes"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Vendor-Defined Attributes</span>

   This section discusses the use of vendor-defined attributes within
   PA-TNC.  The PA-TNC protocol was designed to allow for vendor-defined
   attributes to be used as a replacement where a standard attribute
   could be used.  In some cases, even the standard attributes allow for
   vendor-defined information to be included.  It is envisioned that
   over time as particular vendor-defined attributes become popular, an
   equivalent standard attribute could be added allowing for broader
   interoperability.

   This specification does not define vendor-defined attributes, but
   rather highlights how such attributes can be used with PA-TNC without
   the potential for namespace collisions or misinterpretations.  In
   order to avoid collisions, PA-TNC uses the well-established SMI
   Private Enterprise Numbers as vendor IDs to define separate
   namespaces for important fields within a PA-TNC message.  For
   example, to ensure the uniqueness of attribute types while providing
   for vendor extensions, vendor-defined attribute types include the
   vendor's unique vendor ID, to indicate the intended namespace for the
   attribute type, followed by the attribute type.  IETF Standard PA-TNC
   Attribute Types use a vendor ID of zero (0).

   SMI Private Enterprise Numbers are used to provide a separate
   identifier space for each vendor.  The IANA provides a registry for
   SMI Private Enterprise Numbers.  Any organization (including non-
   profit organizations, governmental bodies, etc.) can obtain one of
   these numbers at no charge, and thousands of organizations have done
   so.  Within this document, SMI Private Enterprise Numbers are known
   as "vendor IDs".

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Security%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Security Considerations</span>

   This section discusses the major potential types of security threats
   relevant to the PA-TNC message protocol.  It is envisioned that
   additional attribute types could be defined in the future to
   facilitate the exchange of security capabilities, keys, and security
   protected attributes if future use cases are adopted that require
   such protections.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Trust%20Relationships"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Trust Relationships</span>

   In order to understand where security countermeasures are necessary,
   this section starts with a discussion of where the TNC architecture
   envisions some trust relationships between the processing elements of
   the PA-TNC protocol.  The following subsections discuss the trust
   properties associated with each portion of the NEA reference model
   directly involved with the processing of the PA-TNC protocol.



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 48]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-49" id="page-49" name="page-49"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.1.%20%20Posture%20Collector"></a><a class="selflink" href="#section-5.1.1" name="section-5.1.1">5.1.1</a>.  Posture Collector</span>

   The Posture Collectors are trusted by Posture Validators to:

   o  Collect valid information about the component type associated with
      the Posture Collector

   o  Report upon collected information consistent with local security
      and privacy policies

   o  Accurately report information associated with the type of
      component for the PA-TNC message

   o  Not act maliciously to the Posture Broker Server and Posture
      Validators, including attacks such as denial of service

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.2.%20%20Posture%20Validator"></a><a class="selflink" href="#section-5.1.2" name="section-5.1.2">5.1.2</a>.  Posture Validator</span>

   The Posture Validators are trusted by Posture Collectors to:

   o  Only request information necessary to assess the security state of
      the endpoint

   o  Make assessment decisions based on deployer-defined policies

   o  Discard collected information consistent with data retention and
      privacy policies

   o  Not act maliciously to the Posture Broker Server and Posture
      Collectors, including attacks such as denial of service

   o  Not send malicious remediation instructions that do not fix or
      that cause damage to the endpoint

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.3.%20%20Posture%20Broker%20Client%2C%20Posture%20Broker%20Server"></a><a class="selflink" href="#section-5.1.3" name="section-5.1.3">5.1.3</a>.  Posture Broker Client, Posture Broker Server</span>

   The Posture Broker Client and Posture Broker Server are trusted by
   the Posture Collector and Posture Validator to:

   o  Provide a reliable transport for PA-TNC messages

   o  Deliver messages for a particular PA Subtype only to those Posture
      Collectors and Posture Validators that have registered for them

   o  Not disclose any provided attributes to unauthorized parties






<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 49]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-50" id="page-50" name="page-50"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   o  Not act maliciously to drop messages, duplicate messages, or flood
      Posture Collectors and Posture Validators with unnecessary
      messages

   o  Not observe, fabricate, or alter the contents of a PA-TNC message

   o  Properly place Posture Collector and Posture Validator identifiers
      into the PB-TNC protocol, deliver those identifiers to Posture
      Collectors and Posture Validators as needed, and manage exclusive
      delivery to a particular Posture Collector or Posture Validator
      when requested

   o  Properly expose authentication information from PT security so
      that Posture Collectors and Posture Validators can use the peer's
      identity information to safely make policy decisions

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Security%20Threats"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Security Threats</span>

   Beyond the trusted relationships assumed in <a href="#section-5.1">section 5.1</a>, the PA-TNC
   protocol faces a number of potential security attacks that could
   require security countermeasures.

   Generally, the PA-TNC protocol relies upon the underlying PT
   protocol's security to protect the messages from attack when
   traveling over the network.  Once the message resides on the Posture
   Broker Client or Posture Broker Server, the posture brokers are
   trusted to properly and safely deliver the messages to the
   appropriate Posture Collectors and Posture Validators.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.1.%20%20Attribute%20Theft"></a><a class="selflink" href="#section-5.2.1" name="section-5.2.1">5.2.1</a>.  Attribute Theft</span>

   When PA-TNC messages are sent over unprotected network links or
   spanning local software stacks that are not trusted, the contents of
   the PA-TNC messages may be subject to information theft by an
   intermediary party.  This theft could result in information being
   recorded for future use or analysis by the adversary.  Attributes
   observed by eavesdroppers could contain information that exposes
   potential weaknesses in the security of the endpoint, or system
   fingerprinting information easing the ability of the attacker to
   employ attacks more likely to be successful against the endpoint.
   The eavesdropper might also learn information about the endpoint or
   network policies that either singularly or collectively is considered
   sensitive information (e.g., certain endpoints are lacking patches,
   or particular sub-networks have more lenient policies).

   PA-TNC attributes are not intended to carry privacy-sensitive
   information, but should some exist in a message, the adversary could
   come into possession of the information, which could be used for



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 50]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-51" id="page-51" name="page-51"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   financial gain.  Therefore, it is important that PT provide strong
   confidentiality protection to protect the message from eavesdroppers
   when being sent between the Posture Transport Client and Posture
   Transport Server.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.2.%20%20Message%20Fabrication"></a><a class="selflink" href="#section-5.2.2" name="section-5.2.2">5.2.2</a>.  Message Fabrication</span>

   Attackers on the network or present within the NEA system could
   introduce fabricated PA-TNC messages intending to trick or create a
   denial of service against aspects of an assessment.  For example, an
   adversary could attempt to send a falsified set of remediation
   instructions using the Remediation URI support in hopes of the
   Posture Collector automatically following the instructions.  Posture
   Collectors need to ensure that any requests to take actions on the
   endpoint (such as remediation instructions) received from Posture
   Validators are authentic and trustworthy using strong authentication
   and integrity protections offered by PT.  Posture Collectors should
   not blindly follow remediation instructions received from a trusted
   NEA Server.  At least for patches and other potentially dangerous
   actions, Posture Collectors should validate these actions (e.g., via
   user confirmation) before proceeding.

   Such an attack could occur if an active attacker launches a man-in-
   the-middle (MitM) attack by proxying the PA-TNC messages and was able
   to replace undesired messages with ones easing future attack upon the
   endpoint.  Consider a scenario where PT security protection is not
   used and the Posture Broker Server proxies all assessment traffic to
   a remote Posture Broker Server.  The proxy could eavesdrop and
   replace assessment results attributes, tricking the endpoint into
   thinking it has passed an assessment, when in fact it has not and
   requires remediation.  Because the Posture Collector has no way to
   verify that attributes were actually created by an authentic Posture
   Validator, it is unable to detect the falsified attribute or message.
   Therefore, it is important that PT provides strong authentication and
   integrity protection.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.3.%20%20Attribute%20Modification"></a><a class="selflink" href="#section-5.2.3" name="section-5.2.3">5.2.3</a>.  Attribute Modification</span>

   This attack could allow an active attacker capable of intercepting a
   message to modify a PA-TNC message attribute to a desired value to
   ease the compromise of an endpoint.  Without the ability for message
   recipients to detect whether a received message contains the same
   content as what was originally sent, active attackers can stealthily
   modify the attribute exchange.

   For example, an attacker might wish to change the contents of the
   firewall component's version string attribute to disguise the fact
   that the firewall is running an old, vulnerable version.  The



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 51]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-52" id="page-52" name="page-52"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   attacker would change the version string sent by the firewall Posture
   Collector to the current version number, so the Posture Validator's
   assessment passes while leaving the endpoint vulnerable to attack.
   Similarly, an attacker could achieve widespread denial of service by
   altering large numbers of assessments' version string attributes to
   an old value so they repeatedly fail assessments even after a
   successful remediation.  Upon receiving the lower value, the Posture
   Validator would continue to believe that the endpoint is running old,
   potentially vulnerable versions of the firewall that does not meet
   network compliance policy, so therefore the endpoint would not be
   allowed to join the network.  Use of a PT protocol providing strong
   integrity protection and authentication is essential as
   countermeasures to these attacks.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.4.%20%20Attribute%20Replay"></a><a class="selflink" href="#section-5.2.4" name="section-5.2.4">5.2.4</a>.  Attribute Replay</span>

   Another potential attack against an unprotected PA-TNC message
   attribute exchange is to exploit the lack of a strong binding between
   the attributes sent during an assessment to the specific endpoint.
   Without a strong binding of the endpoint to the posture information,
   an attacker could record the attributes sent during an assessment of
   a compliant endpoint and later replay those attributes so that a non-
   compliant endpoint can now gain access to the network or protected
   resource.  This attack could be employed by a network MitM that is
   able to eavesdrop and proxy message exchanges, or by using local
   rogue agents on the endpoints.  Assessments lacking some form of
   freshness exchange could be subject to replay of prior assessment
   data, even if it no longer reflects the current state of the
   endpoint.  Use of a PT protocol providing strong integrity protection
   and authentication including a freshness exchange is necessary
   countermeasure to these attacks.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.5.%20%20Attribute%20Insertion"></a><a class="selflink" href="#section-5.2.5" name="section-5.2.5">5.2.5</a>.  Attribute Insertion</span>

   Similar to the attribute modification attacks, an adversary wishing
   to include one or more attributes or PA-TNC messages inside a valid
   assessment may be able to insert the attributes or messages without
   detection by the recipient.  For example, an attacker could add
   attributes to the front of a PA-TNC message to cause an assessment to
   succeed even for a non-compliant endpoint, particularly if it knew
   that the recipient ignored repeated attributes within a message.
   Similarly, if a Posture Collector or Posture Validator always
   generated an error if it saw unexpected attributes, the attacker
   could cause failures and denial of service by adding attributes or
   messages to an exchange.  Use of a PT protocol providing strong
   authentication and integrity protection could prevent the adversary
   from inserting attributes into the assessment.




<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 52]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-53" id="page-53" name="page-53"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.6.%20%20Denial%20of%20Service"></a><a class="selflink" href="#section-5.2.6" name="section-5.2.6">5.2.6</a>.  Denial of Service</span>

   A variety of types of denial-of-service attacks are possible against
   the PA-TNC message exchange if left unprotected from untrusted
   parties along the communication path between the Posture Collector
   and Posture Validator.  Normally, the PT exchange is bidirectionally
   authenticated, which helps to prevent a MitM on the network from
   becoming an active proxy, but transparent message routing gateways
   may still exist on the communication path and can modify the
   integrity of the message exchange unless adequate integrity
   protection is provided.  If the MitM or other entities on the network
   can send messages to the Posture Broker Client or Posture Broker
   Server that appear to be part of an assessment, these messages could
   confuse the Posture Collector and Posture Validator or cause them to
   perform unnecessary work or take incorrect action.  Several example
   denial-of-service situations are described in sections <a href="#section-5.2.3">5.2.3</a> and
   5.2.5.  Many potential denial-of-service examples exist, including
   flooding messages to the Posture Collector or Posture Validator,
   sending very large messages containing many attributes, and
   repeatedly asking for resource-intensive operations.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Privacy%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Privacy Considerations</span>

   The PA-TNC protocol is designed to allow for controlled disclosure of
   security-relevant information about an endpoint, specifically for the
   purpose of enabling an assessment of the endpoint's compliance with
   network policy.  The purpose of this protocol is to provide
   visibility into the state of the protective mechanisms on the
   endpoint, in order for the Posture Validators and Posture Broker
   Server to determine whether the endpoint is up to date and thus has
   the best chance of being resilient in the face of malware threats.
   One risk associated with providing visibility into the contents of an
   endpoint is the increased chance for exposure of privacy-sensitive
   information without the consent of the user.

   While this protocol does provide the Posture Validator the ability to
   request specific information about the endpoint, the protocol is not
   open ended, bounding the Posture Validator to only query specific
   information (attributes) about specific security features (component
   types) of the endpoint.  Each PA-TNC message is explicitly about a
   single component from the list of components in <a href="#section-3.5">section 3.5</a>.  These
   components include a list of security-related aspects of the endpoint
   that affect the ability of the endpoint to resist attacks and thus
   are of interest during an assessment.  Discretionary components used
   by the user to create or view content are not on the list, as they
   are more likely to have access to privacy-sensitive information.





<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 53]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-54" id="page-54" name="page-54"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   Similarly, PA-TNC messages contain a set of attributes that describe
   the particular component.  Each attribute contains generic
   information (e.g., product information or versions) about the
   component, so it is unlikely to include any user-specific or
   identifying information.  This combination of a limited set of
   security-related components with non-user-specific attributes greatly
   reduces the risk of exposure of privacy-sensitive information.
   Vendors that choose to define additional component types and/or
   attributes within their namespace are encouraged to provide similar
   constraints.

   Even with the bounding of standard attribute information to specific
   components, it is possible that individuals might wish to share less
   information with different networks they wish to access.  For
   example, a user may wish to share more information when connecting to
   or being reassessed by the user's employer network than what would be
   made available to the local coffee shop wireless network.  While
   these situations do not impact the protocol itself, they do suggest
   that Posture Collector implementations should consider supporting a
   privacy filter allowing the user and/or system owner to restrict
   access to certain attributes based upon the target network.

   The underlying PT protocol authenticates the network's Posture Broker
   Server at the start of an assessment, so identity can be made
   available to the Posture Collector and per-network privacy filtering
   is possible.  Network owners should make available a list of the
   attributes they require to perform an assessment and any privacy
   policy they enforce when handling the data.  Users wishing to use a
   more restricted privacy filter on the endpoint may risk not being
   able to pass an assessment and thus not gain access to the requested
   network or resource.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  IANA Considerations</span>

   This section defines the contents of three new IANA registries: PA-
   TNC Attribute Types, PA-TNC Error Codes, and PA-TNC Remediation
   Parameters Types.  This section explains how these registries work.
   Also, this specification defines several new PA Subtypes for use with
   PA-TNC.

   All of the registries defined in this document support IETF standard
   values and vendor-defined values.  To explain this phenomenon, we
   will use the PA-TNC Attribute Type as an example, but the other three
   registries work the same way.  Whenever a PA-TNC Attribute Type
   appears on a network, it is always accompanied by an SMI Private
   Enterprise Number (PEN), also known as a vendor ID.  If this vendor
   ID is zero, the accompanying PA-TNC Attribute Type is an IETF
   standard value listed in the IANA registry for PA-TNC Attribute



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 54]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-55" id="page-55" name="page-55"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   Types, and its meaning is defined in the specification listed for
   that PA-TNC Attribute Type in that registry.  If the vendor ID is not
   zero, the meaning of the PA-TNC Attribute Type is defined by the
   vendor identified by the vendor ID (as listed in the IANA registry
   for SMI PENs).  The identified vendor is encouraged but not required
   to register with IANA some or all of the PA-TNC Attribute Types used
   with their vendor ID and publish a specification for each of these
   values.

   This delegation of namespace is analogous to the technique used for
   OIDs.  It can result in interoperability problems if vendors require
   support for particular vendor-specific values.  However, such
   behavior is explicitly prohibited by this specification (in <a href="#section-4.1">section</a>
   <a href="#section-4.1">4.1</a>), which dictates that "Posture Collectors and Posture Validators
   MUST NOT require support for particular vendor-specific PA-TNC
   Attribute Types and MUST interoperate with other parties despite any
   differences in the set of vendor-specific PA-TNC Attribute Types
   supported (although they MAY permit administrators to configure them
   to require support for specific PA-TNC Attribute Types)".  Similar
   requirements are included for PA Subtypes, Remediation Parameters
   Types, and PA-TNC Error Codes.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Designated%20Expert%20Guidelines"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Designated Expert Guidelines</span>

   For all of the IANA registries defined by this specification, new
   values are added to the registry by Expert Review with Specification
   Required, using the Designated Expert process defined in <a href="rfc5226.html">RFC 5226</a>
   [<a href="#ref-3" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>3</a>].

   This section provides guidance to designated experts so that they may
   make decisions using a philosophy appropriate for these registries.

   The registries defined in this document have plenty of values.  In
   most cases, the IETF has approximately 2^32 values available for it
   to define and each vendor the same number of values for its use.
   Because there are so many values available, designated experts should
   not be terribly concerned about exhausting the set of values.

   Instead, designated experts should focus on the following
   requirements.  All values in these IANA registries MUST be documented
   in a specification that is permanently and publicly available.  IETF
   standard values MUST also be useful, not harmful to the Internet, and
   defined in a manner that is clear and likely to ensure
   interoperability.

   Designated experts should encourage vendors to avoid defining similar
   but incompatible values and instead agree on a single IETF standard
   value.  However, it is beneficial to document existing practice.



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 55]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-56" id="page-56" name="page-56"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   There are several ways to ensure that a specification is permanently
   and publicly available.  It may be published as an RFC.
   Alternatively, it may be published in another manner that makes it
   freely available to anyone.  However, in this latter case, the vendor
   MUST supply a copy to the IANA and authorize the IANA to archive this
   copy and make it freely available to all if at some point the
   document becomes no longer freely available to all through other
   channels.

   <a href="#section-7.2">Section 7.2</a> defines the new PA Subtypes.  The following three
   sections provide guidance to the IANA in creating and managing the
   new IANA registries defined by this specification.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20PA%20Subtypes"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  PA Subtypes</span>

   <a href="#section-3.5">Section 3.5</a> of this specification defines several new PA Subtypes
   that have been added to the PA Subtypes registry defined in the PB-
   TNC specification.  Here is a list of these assignments:

   PEN  Integer      Name               Defining Specification
   ---  -------      ----               ----------------------
    0     0          Testing                    <a href="rfc5792.html">RFC 5792</a>
    0     1          Operating System           <a href="rfc5792.html">RFC 5792</a>
    0     2          Anti-Virus                 <a href="rfc5792.html">RFC 5792</a>
    0     3          Anti-Spyware               <a href="rfc5792.html">RFC 5792</a>
    0     4          Anti-Malware               <a href="rfc5792.html">RFC 5792</a>
    0     5          Firewall                   <a href="rfc5792.html">RFC 5792</a>
    0     6          IDPS                       <a href="rfc5792.html">RFC 5792</a>
    0     7          VPN                        <a href="rfc5792.html">RFC 5792</a>
    0     8          NEA Client                 <a href="rfc5792.html">RFC 5792</a>

   These PA Subtypes have been added to the registry for PA Subtypes
   defined in the PB-TNC specification, with this RFC as the reference.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.3.%20%20Registry%20for%20PA-TNC%20Attribute%20Types"></a><a class="selflink" href="#section-7.3" name="section-7.3">7.3</a>.  Registry for PA-TNC Attribute Types</span>

   The name for this registry is "PA-TNC Attribute Types".  Each entry
   in this registry should include a human-readable name, an SMI Private
   Enterprise Number, a decimal integer value between 0 and 2^32-1, and
   a reference to the specification where the contents of this attribute
   type are defined.  This specification must define the meaning of this
   PA-TNC attribute type and the format and semantics of the PA-TNC
   Attribute Value field for PA-TNC attributes that include the
   designated Private Enterprise Number in the PA-TNC Attribute Vendor
   ID field and the designated numeric value in the PA-TNC Attribute
   Type field.





<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 56]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-57" id="page-57" name="page-57"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   The following entries for this registry are defined in this document.
   They are the initial entries in the registry for PA-TNC Attribute
   Types.  Additional entries to this registry are added by Expert
   Review with Specification Required, following the guidelines in
   <a href="#section-7.1">section 7.1</a>.

   PEN   Integer    Name                 Defining Specification
   ---   -------    ----                 ----------------------
    0      0        Testing                      <a href="rfc5792.html">RFC 5792</a>
    0      1        Attribute Request            <a href="rfc5792.html">RFC 5792</a>
    0      2        Product Information          <a href="rfc5792.html">RFC 5792</a>
    0      3        Numeric Version              <a href="rfc5792.html">RFC 5792</a>
    0      4        String Version               <a href="rfc5792.html">RFC 5792</a>
    0      5        Operational Status           <a href="rfc5792.html">RFC 5792</a>
    0      6        Port Filter                  <a href="rfc5792.html">RFC 5792</a>
    0      7        Installed Packages           <a href="rfc5792.html">RFC 5792</a>
    0      8        PA-TNC Error                 <a href="rfc5792.html">RFC 5792</a>
    0      9        Assessment Result            <a href="rfc5792.html">RFC 5792</a>
    0     10        Remediation Instructions     <a href="rfc5792.html">RFC 5792</a>
    0     11        Forwarding Enabled           <a href="rfc5792.html">RFC 5792</a>
    0     12        Factory Default Password     <a href="rfc5792.html">RFC 5792</a>
                    Enabled
    0 0xffffffff    Reserved                     <a href="rfc5792.html">RFC 5792</a>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.4.%20%20Registry%20for%20PA-TNC%20Error%20Codes"></a><a class="selflink" href="#section-7.4" name="section-7.4">7.4</a>.  Registry for PA-TNC Error Codes</span>

   The name for this registry is "PA-TNC Error Codes".  Each entry in
   this registry should include a human-readable name, an SMI Private
   Enterprise Number, a decimal integer value between 0 and 2^32-1, and
   a reference to the specification where this error code is defined.
   This specification must define the meaning of this error code and the
   format and semantics of the Error Information field for PA-TNC
   attributes that have a PA-TNC vendor ID of 0, a PA-TNC Attribute Type
   of PA-TNC Error, the designated Private Enterprise Number in the PA-
   TNC Error Code Vendor ID field, and the designated numeric value in
   the PA-TNC Error Code field.

   The following entries for this registry are defined in this document.
   They are the initial entries in the registry for PA-TNC Error Codes.
   Additional entries to this registry are added by Expert Review with
   Specification Required, following the guidelines in <a href="#section-7.1">section 7.1</a>.










<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 57]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-58" id="page-58" name="page-58"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


      PEN  Integer     Name                      Defining Specification
      ---  -------     ----                      ----------------------
       0     0         Reserved                          <a href="rfc5792.html">RFC 5792</a>
       0     1         Invalid Parameter                 <a href="rfc5792.html">RFC 5792</a>
       0     2         Version Not Supported             <a href="rfc5792.html">RFC 5792</a>
       0     3         Attribute Type Not Supported      <a href="rfc5792.html">RFC 5792</a>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.5.%20%20Registry%20for%20PA-TNC%20Remediation%20Parameters%20Types"></a><a class="selflink" href="#section-7.5" name="section-7.5">7.5</a>.  Registry for PA-TNC Remediation Parameters Types</span>

   The name for this registry is "PA-TNC Remediation Parameters Types".
   Each entry in this registry should include a human-readable name, an
   SMI Private Enterprise Number, a decimal integer value between 1 and
   2^32-1, and a reference to the specification where the contents of
   this remediation parameters type are defined.  This specification
   must define the meaning of this PA-TNC Remediation Parameters Type
   and the format and semantics of the Remediation Parameters field for
   PA-TNC attributes that include the designated Private Enterprise
   Number in the Remediation Parameters Vendor ID field and the
   designated numeric value in the Remediation Parameters Type field.

   The following entries for this registry are defined in this document.
   They are the initial entries in the registry for PA-TNC Remediation
   Parameters Types.  Additional entries to this registry are added by
   Expert Review with Specification Required, following the guidelines
   in <a href="#section-7.1">section 7.1</a>.

   PEN   Integer   Name              Defining Specification
   ---   -------   ----              ----------------------
    0      0      Reserved                 <a href="rfc5792.html">RFC 5792</a>
    0      1      URI                      <a href="rfc5792.html">RFC 5792</a>
    0      2      Remediation String       <a href="rfc5792.html">RFC 5792</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Acknowledgments"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Acknowledgments</span>

   Thanks to the Trusted Computing Group for contributing the initial
   text [<a href="#ref-8" title='"IF-M: TLV Binding"'>8</a>] upon which this document was based.  The authors would also
   like to acknowledge the following people who have contributed to or
   provided substantial input on the preparation of this document or
   predecessors to it: Stuart Bailey, Roger Chickering, Lauren Giroux,
   Charles Goldberg, Steve Hanna, Ryan Hurst, Meenakshi Kaushik, Greg
   Kazmierczak, Scott Kelly, PJ Kirner, Houcheng Lee, Lisa Lorenzin,
   Mahalingam Mani, Sung Lee, Ravi Sahita, Mauricio Sanchez, Brad Upson,
   and Han Yin.








<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 58]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-59" id="page-59" name="page-59"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20References"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20Normative%20References"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  Normative References</span>

   [<a id="ref-1" name="ref-1">1</a>]   Bradner, S., "Key words for use in RFCs to Indicate Requirement
         Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-2" name="ref-2">2</a>]   Yergeau, F., "UTF-8, a transformation format of ISO 10646", STD
         63, <a href="rfc3629.html">RFC 3629</a>, November 2003.

   [<a id="ref-3" name="ref-3">3</a>]   Narten, T. and H. Alvestrand, "Guidelines for Writing an IANA
         Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc5226.html">RFC 5226</a>, May 2008.

   [<a id="ref-4" name="ref-4">4</a>]   Klyne, G. and C. Newman, "Date and Time on the Internet:
         Timestamps", <a href="rfc3339.html">RFC 3339</a>, July 2002.

   [<a id="ref-5" name="ref-5">5</a>]   Sahita, R., Hanna, S., Hurst, R., and K. Narayan, "PB-TNC: A
         Posture Broker (PB) Protocol Compatible with Trusted Network
         Connect (TNC)", <a href="rfc5793.html">RFC 5793</a>, March 2010.

   [<a id="ref-6" name="ref-6">6</a>]   Phillips, A., Ed., and M. Davis, Ed., "Tags for Identifying
         Languages", <a href="https://tools.ietf.org/html/bcp47">BCP 47</a>, <a href="rfc5646.html">RFC 5646</a>, September 2009.

   [<a id="ref-7" name="ref-7">7</a>]   Berners-Lee, T., Fielding, R., and L. Masinter, "Uniform
         Resource Identifier (URI): Generic Syntax", STD 66, <a href="rfc3986.html">RFC 3986</a>,
         January 2005.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20Informative%20References"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  Informative References</span>

   [<a id="ref-8" name="ref-8">8</a>]   Trusted Computing Group, "IF-M: TLV Binding",
         <a href="http://www.trustedcomputinggroup.org/resources/tnc_ifm_tlv_binding_specification">http://www.trustedcomputinggroup.org/resources/</a>
         <a href="http://www.trustedcomputinggroup.org/resources/tnc_ifm_tlv_binding_specification">tnc_ifm_tlv_binding_specification</a>, February 2010.

   [<a id="ref-9" name="ref-9">9</a>]   Sangster, P., Khosravi, H., Mani, M., Narayan, K., and J.
         Tardo, "Network Endpoint Assessment (NEA): Overview and
         Requirements", <a href="rfc5209.html">RFC 5209</a>, June 2008.















<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 59]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-60" id="page-60" name="page-60"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Use%20Cases"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Use Cases</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.1.%20%20Initial%20Client-Triggered%20Assessment"></a><a class="selflink" href="#appendix-A.1" name="appendix-A.1">A.1</a>.  Initial Client-Triggered Assessment</span>

   This scenario involves the assessment of an endpoint initiated during
   network join.  The assessment is triggered by the Posture Broker
   Client (PBC) and involves collection of patch information from both
   Standard Operating System (OS) Posture Collector and vendor-specific
   Patch Posture Collector (PC).  The assessment by both the vendor-
   specific Patch Posture Validator (PV) and Standard OS Posture
   Validator result in a compliant assessment decision that results in a
   compliant System Assessment Decision to be returned by the Posture
   Broker Server (PBS).

   +--------+ +-------+ +---------+ +--------+ +-------++--------+
   | Vndr. X| |  Std. | |   Std.  | |  Std.  | | Std.  || Vndr. X|
   |Patch PC| | OS PC | |   PBC   | |  PBS   | | OS PV ||Patch PV|
   +--+-----+ +-+-----+ +---+-----+ +-+------+ +-+------+--+-----+
      |         |   N/W Join|         |          |         |
      |         |     -----&gt;|         |          |         |
      |         | Req Post. |         |          |         |
      |         |&lt;----------|         |          |         |
      |         | Req Post. |         |          |         |
      |&lt;--------------------|         |          |         |
      |Vndr X Patch Posture |         |          |         |
      |--------------------&gt;|         |          |         |
      |         |OS Posture |         |          |         |
      |         |----------&gt;|         |          |         |
      |         |           | Posture |          |         |
      |         |           | Report  |          |         |
      |         |           |--------&gt;|          |         |
      |         |           |         |  Verify  |         |
      |         |           |         |  Posture |         |
      |         |           |         |---------&gt;          |
      |         |           |         |          | Verify  |
      |         |           |         |          | Posture |
      |         |           |         |-------------------&gt;|
      |         |           |         | OS Reslt |         |
      |         |           |         |&lt;---------|         |
      |         |           |         | VndrX Patch Result |
      |         |           | Assess  |&lt;-------------------|
      |         |           | Result  |                    |
      |         |           |&lt;--------|          |         |
      |         | OS Reslt  |         |          |         |
      |         |&lt;----------|         |          |         |
      | VndrX Patch Result  |         |          |         |
      |&lt;--------------------|         |          |         |




<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 60]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-61" id="page-61" name="page-61"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/A.1.1.%20%20Message%20Contents"></a><a class="selflink" href="#appendix-A.1.1" name="appendix-A.1.1">A.1.1</a>.  Message Contents</span>

   This section shows the contents of the key fields in each of the PA
   messages exchanged in this use case.  When necessary, additional
   commentary is provided to explain why certain fields contain the
   shown values.  Note that many of the flows shown are between
   components on the same system so no message contents are shown.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.1.1.1.%20%20N%2FW%20Join"></a><a class="selflink" href="#appendix-A.1.1.1" name="appendix-A.1.1.1">A.1.1.1</a>.  N/W Join</span>

   This flow represents the event that causes the PBC to decide to start
   an assessment of the endpoint in order to gain access to the network.
   This is merely an event and does not include a message being sent.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.1.1.2.%20%20Request%20Posture%20%28Req%20Post.%29"></a><a class="selflink" href="#appendix-A.1.1.2" name="appendix-A.1.1.2">A.1.1.2</a>.  Request Posture (Req Post.)</span>

   This flow illustrates an invocation of the OS and patch posture
   collectors requesting particular posture attributes to be sent.
   Because this use case is triggered locally, the contents of this flow
   aren't specified by NEA.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.1.1.3.%20%20Vendor%20X%20Patch%20Posture%20%28VndrX%20Patch%20Posture%29"></a><a class="selflink" href="#appendix-A.1.1.3" name="appendix-A.1.1.3">A.1.1.3</a>.  Vendor X Patch Posture (VndrX Patch Posture)</span>

   This flow contains the PA message from the Patch Posture Collector:

   Vendor X Patch Posture PA Message  {
      Attribute HDR {Message ID}
      Attribute 1 {
         vendor-id=1 (vendor X)
         type=1 (Vendor X namespace attribute)
         length
         Value = {
            VendorXAttribute1=123
         }
      }
      Attribute 2 {
         vendor-id=1 (vendor X)
         type=2 (Vendor X namespace attribute)
         length
         Value = {
            VendorXAttribute2=456
         }
      }
   }







<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 61]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-62" id="page-62" name="page-62"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.1.1.4.%20%20OS%20Posture"></a><a class="selflink" href="#appendix-A.1.1.4" name="appendix-A.1.1.4">A.1.1.4</a>.  OS Posture</span>

   This flow contains the PA message from the OS Posture Collector:

   OS Posture PA Message  {

      Attribute HDR {Message ID}
      Attribute 1 {
         vendor-id=0
         type=2 (product information)
         length
         Value = {
            Product-vendor-id=311   -- Microsoft's PEN
            Product-name="Windows Vista"
         }
      }
      Attribute 2 {
         vendor-id=0
         type=3 (numeric version)
         length
         Value = {
            major-version=6     -- Vista is version 6.0
            minor-version=0
            build-number=456789
            service-pack-major=0   -- No service packs
            service-pack-minor=0
         }
      }
   }

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.1.1.5.%20%20Posture%20Report"></a><a class="selflink" href="#appendix-A.1.1.5" name="appendix-A.1.1.5">A.1.1.5</a>.  Posture Report</span>

   This flow contains the PB message containing the PA messages from the
   Patch and OS Posture Collectors; the message content is described in
   the PB-TNC specification.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.1.1.6.%20%20Verify%20Posture"></a><a class="selflink" href="#appendix-A.1.1.6" name="appendix-A.1.1.6">A.1.1.6</a>.  Verify Posture</span>

   This flow illustrates an invocation of the OS and patch Posture
   Validators requesting verification of the posture attributes
   received.  Because this flow happens locally within the NEA server,
   NEA does not specify the message contents.









<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 62]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-63" id="page-63" name="page-63"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.1.1.7.%20%20OS%20Posture%20Result%20%28OS%20Reslt%29"></a><a class="selflink" href="#appendix-A.1.1.7" name="appendix-A.1.1.7">A.1.1.7</a>.  OS Posture Result (OS Reslt)</span>

   This flow contains the PA message (Posture Assessment Result) from
   the OS Posture Validator

   OS Posture Result PA Message {
      Attribute HDR {Message ID}
         Attribute 1 {
              vendor-id=0
              type=9 (assessment-result)
              length
              Value = {
                 assessment-result=0 (compliant)
              }
        }
    }

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.1.1.8.%20%20Vendor%20X%20Patch%20Result%20%28VndrX%20Patch%20Result%29"></a><a class="selflink" href="#appendix-A.1.1.8" name="appendix-A.1.1.8">A.1.1.8</a>.  Vendor X Patch Result (VndrX Patch Result)</span>

   This flow contains the PA message (Posture Assessment Result) from
   the Vendor X Patch Posture Validator

   Patch Vendor X Posture Result PA Message {
      Attribute HDR {Message ID}
         Attribute 1 {
              vendor-id=0
              type=9 (assessment-result)
              length
              Value = {
                 assessment-result=0 (compliant)
              }
         }
    }

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.1.1.9.%20%20Assessment%20Result%20%28Assess%20Result%29"></a><a class="selflink" href="#appendix-A.1.1.9" name="appendix-A.1.1.9">A.1.1.9</a>.  Assessment Result (Assess Result)</span>

   This flow contains the PB message containing the system assessment
   result computed by the Posture Broker Server and the PA messages from
   the Patch and OS Posture Validators; the message content is described
   in the PB-TNC specification.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.1.1.10.%20%20Posture%20Result%20%28OS%20PRslt%20%26%20Vndr%20X%20Post%20PResult%29"></a><a class="selflink" href="#appendix-A.1.1.10" name="appendix-A.1.1.10">A.1.1.10</a>.  Posture Result (OS PRslt &amp; Vndr X Post PResult)</span>

   These flows illustrate an invocation of the OS and Vendor X Patch
   Posture Collectors to receive the posture assessment results.
   Because this flow is triggered locally, NEA does not specify the
   contents of this flow.




<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 63]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-64" id="page-64" name="page-64"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.2.%20%20Server-Initiated%20Assessment%20with%20Remediation"></a><a class="selflink" href="#appendix-A.2" name="appendix-A.2">A.2</a>.  Server-Initiated Assessment with Remediation</span>

   This scenario involves the assessment of an endpoint initiated by the
   NEA Server.  The assessment is triggered by the Posture Broker Server
   and involves collection of Anti-Virus attributes for two Anti-Virus
   components running on the endpoint.  The endpoint is assessed to be
   compliant by one of the vendor (Vendor X) anti-virus Posture
   Validators and non-compliant by the other vendor (Vendor Y) anti-
   virus Posture Validator.  Based upon the Posture Broker Server's
   policy, this results in a non-compliant system assessment decision to
   be returned by the Posture Broker Server.  The Posture Broker Server
   also returns remediation instructions for the endpoint as part of the
   response.






































<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 64]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-65" id="page-65" name="page-65"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   +--------+  +-------+ +---------+ +--------+ +-------+ +--------+
   | Vndr Y |  | Vndr X| |   Std.  | |  Std.  | | Vndr X| | Vndr Y |
   |  AV PC |  | AV PC | |   PBC   | |  PBS   | | AV PV | |  AV PV |
   +----+---+  +---+---+ +-----+---+ +---+----+ +---+---+ +----+---+
        |          |           | N/W Join|          |          |
        |          |           | -------&gt;|          |          |
        |          |           |         |  Create  |          |
        |          |           |         |Post. Req |          |
        |          |           |         |---------&gt;|          |
        |          |           |         |Create Posture Req   |
        |          |           |         |----------+---------&gt;|
        |          |           |         | Vndr Y AV Post Req  |
        |          |           |         |&lt;---------+----------|
        |          |           |         |Vndr X AV |          |
        |          |           |         |Post. Req |          |
        |          |           | Posture |&lt;---------|          |
        |          |           | Request |          |          |
        |          | Vndr X AV |&lt;--------|          |          |
        |          | Post. Req |         |          |          |
        |          |&lt;----------|         |          |          |
        |      Vndr Y AV       |         |          |          |
        |     Posture Req      |         |          |          |
        +&lt;---------+-----------|         |          |          |
        |  Vndr Y AV Posture   |         |          |          |
        +----------+----------&gt;|         |          |          |
        |          | Vndr X AV |         |          |          |
        |          |  Posture  |         |          |          |
        |          |----------&gt;| Posture |          |          |
        |          |           |Response |          |          |
        |          |           |--------&gt;|          |          |
        |          |           |         |  Verify  |          |
        |          |           |         |  Posture |          |
        |          |           |         |---------&gt;|          |
        |          |           |         |     Verify Posture  |
        |          |           |         |----------+---------&gt;|
        |          |           |         |Vndr Y AV Post Result|
        |          |           |         |&lt;---------+----------|
        |          |           |         |Vndr X AV |          |
        |          |           |         |Post Reslt|          |
        |          |           |  Assess |&lt;---------|          |
        |          |           |  Result |          |          |
        |          | Vndr X AV |&lt;--------|          |          |
        |          |Post Reslt |&lt;--------|          |          |
        |          |&lt;----------|         |          |          |
        | Vndr Y AV Post Reslt |         |          |          |
        +&lt;---------+-----------|         |          |          |





<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 65]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-66" id="page-66" name="page-66"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/A.2.1.%20%20Message%20Contents"></a><a class="selflink" href="#appendix-A.2.1" name="appendix-A.2.1">A.2.1</a>.  Message Contents</span>

   This section shows the contents of the key fields in each of the PA
   messages exchanged in this use case.  When necessary, additional
   commentary is provided to explain why certain fields contain the
   shown values.  Note that many of the flows shown are between
   components on the same system so no message contents are shown.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.2.1.1.%20%20N%2FW%20Join"></a><a class="selflink" href="#appendix-A.2.1.1" name="appendix-A.2.1.1">A.2.1.1</a>.  N/W Join</span>

   This flow represents the event that causes the PBS to decide to start
   an assessment of the endpoint in order to gain access to the network.
   This is merely an event and does not include a message being sent.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.2.1.2.%20%20Create%20Posture%20Request%20%28Create%20Posture%20Req%29"></a><a class="selflink" href="#appendix-A.2.1.2" name="appendix-A.2.1.2">A.2.1.2</a>.  Create Posture Request (Create Posture Req)</span>

   This flow illustrates an invocation of the Vendor X and Vendor Y
   Anti-Virus Posture Validators enabling posture request attributes to
   be created.  Because this use case is triggered locally, NEA does not
   specify the contents of this flow.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.2.1.3.%20%20Vendor%20Y%20AV%20Posture%20Request%20%28Vndr%20Y%20AV%20Posture%20Req%29"></a><a class="selflink" href="#appendix-A.2.1.3" name="appendix-A.2.1.3">A.2.1.3</a>.  Vendor Y AV Posture Request (Vndr Y AV Posture Req)</span>

   This flow contains the PA message (Posture Request) from the Vendor Y
   Anti-Virus Posture Validator

   Vendor Y AV Posture Request PA Message {
       Attribute HDR {Message ID}
          Attribute 1 {
              vendor-id=0
              type=1 (Attribute Request)
              length
              Value = {
                 Vendor-id=0 (IETF Standard)
                 Type=2 (Standard attribute, Product-Information)
                 Vendor-id=1 (Vendor Y)
                 Type=2 (Vendor Y attribute, Extended-Dat-Version)
               }
          }
   }











<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 66]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-67" id="page-67" name="page-67"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.2.1.4.%20%20Vendor%20X%20AV%20Posture%20Request%20%28Vndr%20X%20AV%20Post.%20Req%29"></a><a class="selflink" href="#appendix-A.2.1.4" name="appendix-A.2.1.4">A.2.1.4</a>.  Vendor X AV Posture Request (Vndr X AV Post. Req)</span>

   This flow contains the PA message (Posture Request) from the Vendor X
   Anti-Virus Posture Validator

   Vendor X AV Posture Request PA Message {
       Attribute HDR {Message ID}
          Attribute 1 {
              vendor-id=0
              type=1 (Attribute Request)
              length
              Value = {
                 Vendor-id=1 (Vendor X)
                 Type=1 (Vendor X attribute, Scan-Engine-Version)
                 Vendor-id=0 (IETF Standard)
                 Type=5 (Standard, Operational-Status)
              }
          }
    }

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.2.1.5.%20%20Posture%20Request"></a><a class="selflink" href="#appendix-A.2.1.5" name="appendix-A.2.1.5">A.2.1.5</a>.  Posture Request</span>

   This flow contains the PB message containing the PA messages from the
   Vendor X and Vendor Y Anti-Virus Posture Validators; the message
   content is described in the PB-TNC specification.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.2.1.6.%20%20Posture%20Request%20%28Vndr%20X%20AV%20Post%20Req%20%26%20Vndr%20Y%20AV%20Post%20Req%29"></a><a class="selflink" href="#appendix-A.2.1.6" name="appendix-A.2.1.6">A.2.1.6</a>.  Posture Request (Vndr X AV Post Req &amp; Vndr Y AV Post Req)</span>

   These flows illustrate an invocation of the Vendor X and Vendor Y
   Anti-Virus Posture Collectors to process the Posture Request and
   return the particular posture attributes requested.  Because this
   flow is triggered locally, NEA does not specify the contents of this
   flow.


















<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 67]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-68" id="page-68" name="page-68"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.2.1.7.%20%20Vendor%20Y%20AV%20Posture%20%28Vndr%20Y%20AV%20Posture%29"></a><a class="selflink" href="#appendix-A.2.1.7" name="appendix-A.2.1.7">A.2.1.7</a>.  Vendor Y AV Posture (Vndr Y AV Posture)</span>

   This flow contains the PA message (response to the Posture Request)
   from the Vendor Y Anti-Virus Posture Collector.

   Vendor Y AV Posture PA Message {
     Attribute HDR {Message ID}
         Attribute 1 {
            vendor-id=0 (IETF Standard)
            Type=2 (Standard attribute, Product-Information)
            length
            Value = {
               product-vendor-id=12345 (vendor Y)
               product-id=987 (AV product id from vendor Y)
               product-name="Vendor Y Anti-Virus"
            }
         }
         Attribute 2 {
            vendor-id=2 (vendor Y)
            type=2 (vendor Y attribute, DAT-Version)
            length
            Value = {
               DAT-version=5678
            }
         }
     }

























<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 68]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-69" id="page-69" name="page-69"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.2.1.8.%20%20Vendor%20X%20AV%20Posture%20%28Vndr%20X%20AV%20Posture%29"></a><a class="selflink" href="#appendix-A.2.1.8" name="appendix-A.2.1.8">A.2.1.8</a>.  Vendor X AV Posture (Vndr X AV Posture)</span>

   This flow contains the PA message (response to the Posture Request)
   from the Vendor X Anti-Virus Posture Collector.

   Vendor X AV Posture PA Message {
      Attribute HDR {Message ID}
         Attribute 1 {
            vendor-id=1
            type=1 (vendor X attribute, Scan-Engine-Version)
            length
            Value = {
               scan-engine-version=1234
            }
         }
         Attribute 2 {
            vendor-id=0 (IETF Standard)
            type=5 (Standard, Operational-Status)
            length
            Value = {
               status=2 (installed but non-operational)
               result=0 (unknown)
               last use="" (never used)
             }
         }
     }

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.2.1.9.%20%20Posture%20Response"></a><a class="selflink" href="#appendix-A.2.1.9" name="appendix-A.2.1.9">A.2.1.9</a>.  Posture Response</span>

   This flow contains the PB message containing the PA messages from the
   Vendor X and Vendor Y Anti-Virus Posture Collectors; the message
   content is described in the PB-TNC specification.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.2.1.10.%20%20Verify%20Posture"></a><a class="selflink" href="#appendix-A.2.1.10" name="appendix-A.2.1.10">A.2.1.10</a>.  Verify Posture</span>

   This flow illustrates an invocation of the Vendor X and Vendor Y
   Anti-Virus Posture Validators requesting verification of the posture
   attributes received.  Because this flow happens locally within the
   NEA server, NEA does not specify the message contents.












<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 69]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-70" id="page-70" name="page-70"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.2.1.11.%20%20Vendor%20Y%20AV%20Posture%20Result%20%28Vndr%20Y%20AV%20Post%20Result%29"></a><a class="selflink" href="#appendix-A.2.1.11" name="appendix-A.2.1.11">A.2.1.11</a>.  Vendor Y AV Posture Result (Vndr Y AV Post Result)</span>

   This flow contains the PA message (Posture Assessment Result) from
   the Vendor Y Anti-Virus Posture Validator

   Vendor Y AV Posture Result PA Message {
      Attribute HDR {Message ID}
        Attribute 1 {
           vendor-id=0
           type=9 (assessment-result)
           length
           Value = {
              assessment-result=0 (compliant)
           }
        }
     }

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.2.1.12.%20%20Vendor%20X%20AV%20Posture%20Result%20%28Vndr%20X%20AV%20Post%20Reslt%29"></a><a class="selflink" href="#appendix-A.2.1.12" name="appendix-A.2.1.12">A.2.1.12</a>.  Vendor X AV Posture Result (Vndr X AV Post Reslt)</span>

   This flow contains the PA message (Posture Assessment Result) from
   the Vendor X Anti-Virus Posture Validator

   Vendor X AV Posture Result PA Message {
       Attribute HDR {Message ID}
         Attribute 1 {
            vendor-id=0
            type=9 (assessment-result)
            length
            Value = {
               assessment-result=1 (non-compliant)
            }
         }
    }

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.2.1.13.%20%20Assessment%20Result%20%28Assess%20Result%29"></a><a class="selflink" href="#appendix-A.2.1.13" name="appendix-A.2.1.13">A.2.1.13</a>.  Assessment Result (Assess Result)</span>

   This flow contains the PB message containing the system assessment
   result computed by the Posture Broker Server and the PA messages from
   the Vendor X and Vendor Y Anti-Virus Posture Validators; the message
   content is described in the PB-TNC specification.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.2.1.14.%20%20Posture%20Result%20%28Vndr%20X%20AV%20Post%20Reslt%20%26%20Vndr%20Y%20AV%20Post%20Reslt%29"></a><a class="selflink" href="#appendix-A.2.1.14" name="appendix-A.2.1.14">A.2.1.14</a>.  Posture Result (Vndr X AV Post Reslt &amp; Vndr Y AV Post Reslt)</span>

   These flows illustrate an invocation of the Vendor X and Vendor Y
   Anti-Virus Posture Collectors to receive the posture assessment
   results.  Because this flow is triggered locally, NEA does not
   specify the contents of this flow.




<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 70]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-71" id="page-71" name="page-71"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.3.%20%20Client-Triggered%20Reassessment"></a><a class="selflink" href="#appendix-A.3" name="appendix-A.3">A.3</a>.  Client-Triggered Reassessment</span>

   This scenario involves the reassessment of an endpoint as a result of
   enabling a software component on the endpoint.  The endpoint has two
   VPN client software components, one from vendor X for the user's home
   network and other from vendor Y for the network that the endpoint is
   currently accessing.  The assessment is triggered when the user tries
   to use the Vendor X VPN client; this is a violation of the assessment
   policy.  The Posture Broker Client triggers the posture assessment
   when it receives a notification from the VPN Posture Collector about
   the change to the operational state of the VPN component on the
   endpoint.  Note that the VPN Posture Collector may support standard
   attributes and some vendor-defined attributes from vendor X's and
   vendor Y's namespaces.  This use case does not leverage vendor-
   defined attributes.  The assessment involves verification of the
   standard VPN posture attributes by the standard VPN Posture Validator
   that results in a non-compliant assessment result.

   This use case relies on the use of multiple Posture Collector IDs for
   a single Posture Collector as described in <a href="#section-3.3">section 3.3</a> of the PA-TNC
   specification.  In this example, the Posture Collector will obtain
   two Posture Collector IDs to a single Posture Collector (Standard VPN
   PC) and the Posture Collector will generate two separate PA messages
   each using a different ID to report the posture for Vendor X and
   Vendor Y VPN Clients.  The Posture Broker Client will associate the
   assigned IDs in the PB message sent to the NEA Server.  This entire
   behavior will be completely opaque to the NEA Server, which will
   handle the PB message as if there were two VPN Posture Collectors on
   the NEA Client.






















<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 71]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-72" id="page-72" name="page-72"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   +--------+  +-------+ +---------+ +--------+ +--------+ +--------+
   |Vndr X  |  |Vndr Y | |Standard | |Standard| |Standard| |Standard|
   |VPNClnt |  |VPNClnt| | VPN PC  | |  PBC   | |  PBS   | | VPN PV |
   +----+---+  +---+---+ +-----+---+ +---+----+ +---+----+ +----+---+
   Enble|          |           |         |          |           |
   ----&gt;|          |           |         |          |           |
        |  VPN Status Change   |         |          |           |
        |---------------------&gt;| Posture |          |           |
        |          |           | Change  |          |           |
        |          |           |--------&gt;|          |           |
        |          |           |Req. Post|          |           |
        |          |           |&lt;--------|          |           |
        |          |Ins/Rq Info|         |          |           |
        |          |&lt;----------|         |          |           |
        | Inspect/Request Info |         |          |           |
        |&lt;---------+-----------|VPNX Post|          |           |
        |          |           |--------&gt;|          |           |
        |          |           |VPNY Post|          |           |
        |          |           |--------&gt;|          |           |
        |          |           |         | Posture  |           |
        |          |           |         |  Report  |           |
        |          |           |         |---------&gt;|           |
        |          |           |         |          |Vrfy Post. |
        |          |           |         |          |----------&gt;|
        |          |           |         |          |VPN PRslt  |
        |          |           |         |  Assess  |&lt;----------|
        |          |           |         |  Result  |           |
        |          |           |         |&lt;---------|           |
        |          |           |VPN PRslt|          |           |
        |          |           |&lt;--------|          |           |

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/A.3.1.%20%20Message%20Contents"></a><a class="selflink" href="#appendix-A.3.1" name="appendix-A.3.1">A.3.1</a>.  Message Contents</span>

   This section shows the contents of the key fields in each of the PA
   messages exchanged in this use case.  When necessary, additional
   commentary is provided to explain why certain fields contain the
   shown values.  Note that many of the flows shown are between
   components on the same system so no message contents are shown.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.3.1.1.%20%20Enable%20VPN%20Client%20%28Enble%29"></a><a class="selflink" href="#appendix-A.3.1.1" name="appendix-A.3.1.1">A.3.1.1</a>.  Enable VPN Client (Enble)</span>

   This flow represents the end user triggered event of starting the VPN
   Client software from Vendor X.  This is merely an event and does not
   include a message being sent.







<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 72]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-73" id="page-73" name="page-73"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.3.1.2.%20%20Notify%20Status%20Change%20%28VPN%20Status%20Change%29"></a><a class="selflink" href="#appendix-A.3.1.2" name="appendix-A.3.1.2">A.3.1.2</a>.  Notify Status Change (VPN Status Change)</span>

   This flow represents the detection of the active state of the Vendor
   X VPN Client software by the VPN Posture Collector.  This is merely
   an event and does not include a message being sent.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.3.1.3.%20%20Notify%20Posture%20Change%20%28Posture%20Change%29"></a><a class="selflink" href="#appendix-A.3.1.3" name="appendix-A.3.1.3">A.3.1.3</a>.  Notify Posture Change (Posture Change)</span>

   This flow represents the notification of the VPN posture change sent
   from the VPN Posture Collector to the Standard Posture Broker Client.
   This is merely an event and does not include a message being sent.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.3.1.4.%20%20Request%20Posture%20%28Req.%20Post%29"></a><a class="selflink" href="#appendix-A.3.1.4" name="appendix-A.3.1.4">A.3.1.4</a>.  Request Posture (Req. Post)</span>

   This flow illustrates an invocation of the VPN Posture Collector
   requesting particular posture attributes to be sent.  Because this
   use case is triggered locally, NEA does not specify the contents of
   this flow.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.3.1.5.%20%20Inspect%2FRequest%20Info%20%28Ins%2FRq%20Info%29"></a><a class="selflink" href="#appendix-A.3.1.5" name="appendix-A.3.1.5">A.3.1.5</a>.  Inspect/Request Info (Ins/Rq Info)</span>

   This flow illustrates the acquisition of the posture information by
   the VPN Posture Collector from the Vendor X and Vendor Y VPN Client
   components.  Because this flow is triggered locally, NEA does not
   specify the message contents.


























<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 73]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-74" id="page-74" name="page-74"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.3.1.6.%20%20Vendor%20X%20VPN%20Posture%20%28VPNX%20Post%29"></a><a class="selflink" href="#appendix-A.3.1.6" name="appendix-A.3.1.6">A.3.1.6</a>.  Vendor X VPN Posture (VPNX Post)</span>

   This flow contains the PA message from the VPN Posture Collector
   describing the Vendor X VPN Client's posture:

   Vendor X VPN Posture PA Message{
      Attribute HDR {Message ID}
        Attribute 1 {
              vendor-id=0
              type=2 (product information)
              length
              Value = {
                 product-vendor-id=9876 (vendor X)
                 product-id=567 (VPN client identifier for Vndr X)
                 product-name="Vendor X VPN Client"
               }
         }
         Attribute 2 {
              vendor-id=0
              type=5 (operational status)
              length
              Value = {
                 Status=3 (Operational)
                 Result=1 (Successful use with no errors detected)
                 last Use="2008-07-07T12:00:00Z"
              }
         }
























<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 74]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-75" id="page-75" name="page-75"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.3.1.7.%20%20Vendor%20Y%20VPN%20Posture%20%28VPNY%20Post%29"></a><a class="selflink" href="#appendix-A.3.1.7" name="appendix-A.3.1.7">A.3.1.7</a>.  Vendor Y VPN Posture (VPNY Post)</span>

   This flow contains the PA message from the VPN Posture Collector
   including the Vendor Y VPN Client's posture:

   Vendor Y VPN Posture PA Message{
      Attribute HDR {Message ID}
          Attribute 1 {
              vendor-id=0
              type=2 (product information)
              length
              Value = {
                 product-vendor-id=Vendor Y
                 product-id=234 (VPN client identifier for Vndr Y)
                 product-name="Vendor Y VPN Client"
               }
         }
         Attribute 2 {
              vendor-id=0
              type=5 (operational status)
              length
              Value = {
                Status=3 (Operational)
                Result=1 (Successful use with no errors detected)
                last Use="2008-07-07T14:05:00Z"
              }
         }
   }

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.3.1.8.%20%20Posture%20Report"></a><a class="selflink" href="#appendix-A.3.1.8" name="appendix-A.3.1.8">A.3.1.8</a>.  Posture Report</span>

   This flow contains the PB message containing the PA message from the
   VPN Posture Collector; the message content is described in the PB-TNC
   specification.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.3.1.9.%20%20Verify%20Posture%20%28Vrfy%20Post.%29"></a><a class="selflink" href="#appendix-A.3.1.9" name="appendix-A.3.1.9">A.3.1.9</a>.  Verify Posture (Vrfy Post.)</span>

   This flow illustrates an invocation of the VPN Posture Validator
   requesting verification of the posture attributes received.  Because
   this flow happens locally within the NEA Server, NEA does not specify
   the message contents.










<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 75]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-76" id="page-76" name="page-76"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.3.1.10.%20%20VPN%20Posture%20Result%20%28VPN%20PRslt%29"></a><a class="selflink" href="#appendix-A.3.1.10" name="appendix-A.3.1.10">A.3.1.10</a>.  VPN Posture Result (VPN PRslt)</span>

   This flow contains the PA message (Posture Assessment Result) from
   the VPN Posture Validator

   VPN Posture Result PA Message {
      Attribute HDR {Message ID}
         Attribute 1 {
              vendor-id=0
              type=9 (assessment-result)
              length
              Value = {
                 assessment-result=1 (non-compliant)
              }
         }
    }

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.3.1.11.%20%20Assessment%20Result%20%28Assess%20Result%29"></a><a class="selflink" href="#appendix-A.3.1.11" name="appendix-A.3.1.11">A.3.1.11</a>.  Assessment Result (Assess Result)</span>

   This flow contains the PB message containing the system assessment
   result computed by the Posture Broker Server and the PA messages from
   the VPN Posture Validator; the message content is described in the
   PB-TNC specification.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/A.3.1.12.%20%20Posture%20Result%20%28VPN%20PRslt%29"></a><a class="selflink" href="#appendix-A.3.1.12" name="appendix-A.3.1.12">A.3.1.12</a>.  Posture Result (VPN PRslt)</span>

   This flow illustrates an invocation of the VPN Posture Collector to
   receive the posture assessment result.  Because this flow is
   triggered locally, NEA does not specify the contents of this flow.






















<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 76]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-77" id="page-77" name="page-77"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20B.%20%20Evaluation%20against%20NEA%20Requirements"></a><a class="selflink" href="#appendix-B" name="appendix-B">Appendix B</a>.  Evaluation against NEA Requirements</span>

   This section evaluates the PA-TNC protocol against the requirements
   defined in the NEA Requirements document.  Each subsection considers
   a separate requirement from the NEA Requirements document.  Only
   common requirements (C-1 through C-10) and PA requirements (PA-1
   through PA-6) are considered, since these are the only ones that
   apply to PA.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.1.%20%20Evaluation%20against%20Requirement%20C-1"></a><a class="selflink" href="#appendix-B.1" name="appendix-B.1">B.1</a>.  Evaluation against Requirement C-1</span>

   Requirement C-1 says:

   C-1   NEA protocols MUST support multiple round trips between the NEA
   Client and NEA Server in a single assessment.

   PA-TNC meets this requirement.  It allows an unlimited number of
   round trips between the NEA Client and NEA Server.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.2.%20%20Evaluation%20against%20Requirement%20C-2"></a><a class="selflink" href="#appendix-B.2" name="appendix-B.2">B.2</a>.  Evaluation against Requirement C-2</span>

   Requirement C-2 says:

   C-2   NEA protocols SHOULD provide a way for both the NEA Client and
   the NEA Server to initiate a posture assessment or reassessment as
   needed.

   PA-TNC meets this requirement.  PA-TNC is designed to work whether
   the NEA Client or the NEA Server initiates a posture assessment or
   reassessment.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.3.%20%20Evaluation%20against%20Requirement%20C-3"></a><a class="selflink" href="#appendix-B.3" name="appendix-B.3">B.3</a>.  Evaluation against Requirement C-3</span>

   Requirement C-3 says:

   C-3   NEA protocols including security capabilities MUST be capable
   of protecting against active and passive attacks by intermediaries
   and endpoints including prevention from replay-based attacks.

   Security for PA-TNC messages being sent over the network is provided
   through PT protocol security.  Therefore, PA-TNC does not include any
   security capabilities.  Since this requirement only applies to NEA
   protocols "including security capabilities", this specification is
   not subject to this requirement (see <a href="#section-5.2">section 5.2</a>).







<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 77]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-78" id="page-78" name="page-78"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.4.%20%20Evaluation%20against%20Requirement%20C-4"></a><a class="selflink" href="#appendix-B.4" name="appendix-B.4">B.4</a>.  Evaluation against Requirement C-4</span>

   Requirement C-4 says:

   C-4   The PA and PB protocols MUST be capable of operating over any
   PT protocol.  For example, the PB protocol must provide a transport-
   independent interface allowing the PA protocol to operate without
   change across a variety of network protocol environments (e.g.,
   EAP/802.1X, PANA, TLS and IKE/IPsec).

   PA-TNC meets this requirement.  PA-TNC can operate over any PT
   protocol that meets the requirements for PT stated in the NEA
   Requirements document.  PA-TNC does not have any dependencies on
   specific details of the underlying PT protocol.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.5.%20%20Evaluation%20against%20Requirement%20C-5"></a><a class="selflink" href="#appendix-B.5" name="appendix-B.5">B.5</a>.  Evaluation against Requirement C-5</span>

   Requirement C-5 says:

   C-5   The selection process for NEA protocols MUST evaluate and
   prefer the reuse of existing open standards that meet the
   requirements before defining new ones.  The goal of NEA is not to
   create additional alternative protocols where acceptable solutions
   already exist.

   Based on this requirement, PA-TNC should receive a strong preference.
   PA-TNC is equivalent with IF-M 1.0, an open TCG specification.  Other
   specifications from TCG and other groups are also under development
   based on the IF-M 1.0 specification.  Selecting PA-TNC as the basis
   for the PA protocol will ensure compatibility with IF-M 1.0, with
   these other specifications, and with their implementations.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.6.%20%20Evaluation%20against%20Requirement%20C-6"></a><a class="selflink" href="#appendix-B.6" name="appendix-B.6">B.6</a>.  Evaluation against Requirement C-6</span>

   Requirement C-6 says:

   C-6   NEA protocols MUST be highly scalable; the protocols MUST
   support many Posture Collectors on a large number of NEA Clients to
   be assessed by numerous Posture Validators residing on multiple NEA
   Servers.

   PA-TNC meets this requirement.  PA-TNC supports an unlimited number
   of Posture Collectors, Posture Validators, NEA Clients, and NEA
   Servers.  It also is quite scalable in many other aspects as well.  A
   PA-TNC message can contain up to 2^32-1 octets and about 2^28 PA-TNC
   attributes.  Each organization with an SMI Private Enterprise Number
   is entitled to define up to 2^32 vendor-specific PA-TNC Attribute
   Types, 2^16 vendor-specific PA-TNC Product IDs, and 2^32 vendor-



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 78]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-79" id="page-79" name="page-79"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   specific PA-TNC Error Codes.  Each attribute can contain almost 2^32
   octets.  It is generally not advisable or necessary to send this much
   data in a NEA assessment, but still PA-TNC is highly scalable and
   meets requirement C-6 easily.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.7.%20%20Evaluation%20against%20Requirement%20C-7"></a><a class="selflink" href="#appendix-B.7" name="appendix-B.7">B.7</a>.  Evaluation against Requirement C-7</span>

   Requirement C-7 says:

   C-7   The protocols MUST support efficient transport of a large
   number of attribute messages between the NEA Client and the NEA
   Server.

   PA-TNC meets this requirement.  Each PA-TNC message can contain about
   2^28 PA-TNC attributes.  PA-TNC supports up to 2^32 round trips in a
   session so the maximum number of attribute messages that can be sent
   in a single session is actually about 2^50.  However, it is generally
   inadvisable and unnecessary to send a large number of messages in a
   NEA assessment.  As for efficiency, PA-TNC adds only 12 octets of
   overhead per attribute and 8 octets per message (which is negligible
   on a per-attribute basis).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.8.%20%20Evaluation%20against%20Requirement%20C-8"></a><a class="selflink" href="#appendix-B.8" name="appendix-B.8">B.8</a>.  Evaluation against Requirement C-8</span>

   Requirement C-8 says:

   C-8   NEA protocols MUST operate efficiently over low bandwidth or
   high latency links.

   PA-TNC meets this requirement.  A PA-TNC exchange is envisioned
   (based on current deployment experience) to involve one or two round
   trips with less than 500 octets of PA-TNC messages.  Of course, use
   of vendor-specific PA-TNC attribute types could expand the
   assessment.  However, PA-TNC itself imposes an overhead of only 8
   octets per PA-TNC message and 12 octets per attribute.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.9.%20%20Evaluation%20against%20Requirement%20C-9"></a><a class="selflink" href="#appendix-B.9" name="appendix-B.9">B.9</a>.  Evaluation against Requirement C-9</span>

   Requirement C-9 says:

   C-9   For any strings intended for display to a user, the protocols
   MUST support adapting these strings to the user's language
   preferences.

   PA-TNC meets this requirement.  The only field included in a PB-TNC
   attribute for display to the user includes a language tag that could
   be selected based upon the user's PB-TNC negotiated preferred
   language for the assessment (see <a href="#section-4.10">section 4.10</a> of the PB-TNC



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 79]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-80" id="page-80" name="page-80"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   specification).  With this exception, all of the strings in the
   standard PA-TNC attributes are intended for logging and programmatic
   comparisons.

   If any vendor-specific PA-TNC attribute types or future IETF Standard
   PA-TNC Attribute Types include strings that are intended for display
   to a user, they should be translated to the user's preferred
   language.  The Posture Broker Server will need to expose the user's
   preferences to the Posture Validators through whatever API or
   protocol is used to connect those components.  However, that is all
   out of scope for this specification.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.10.%20%20Evaluation%20against%20Requirement%20C-10"></a><a class="selflink" href="#appendix-B.10" name="appendix-B.10">B.10</a>.  Evaluation against Requirement C-10</span>

   Requirement C-10 says:

   C-10  NEA protocols MUST support encoding of strings in UTF-8 format.

   PA-TNC meets this requirement.  All strings in the PA-TNC protocol
   are encoded in UTF-8 format.  This allows the protocol to support a
   wide range of languages efficiently.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.11.%20%20Evaluation%20against%20Requirement%20C-11"></a><a class="selflink" href="#appendix-B.11" name="appendix-B.11">B.11</a>.  Evaluation against Requirement C-11</span>

   Requirement C-11 says:

   C-11  Due to the potentially different transport characteristics
   provided by the underlying candidate PT protocols, the NEA Client and
   NEA Server MUST be capable of becoming aware of and adapting to the
   limitations of the available PT protocol.  For example, some PT
   protocol characteristics that might impact the operation of PA and PB
   include restrictions on which end can initiate a NEA connection,
   maximum data size in a message or full assessment, upper bound on
   number of round trips, and ordering (duplex) of messages exchanged.
   The selection process for the PT protocols MUST consider the
   limitations the candidate PT protocol would impose upon the PA and PB
   protocols.

   PA-TNC meets this requirement.  The design of the PA-TNC protocol
   emphasizes efficient transport of information in order to maximize
   its usability in constrained PT environments.  Local APIs could allow
   Posture Collectors and Posture Validators to discover when they are
   operating in a less constrained deployment and then make use of more
   verbose attributes.  Similarly, Posture Collectors could choose not
   to send or use smaller attributes (including assertions from previous
   assessments) when faced with a very constrained network connection.





<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 80]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-81" id="page-81" name="page-81"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.12.%20%20Evaluation%20against%20Requirement%20PA-1"></a><a class="selflink" href="#appendix-B.12" name="appendix-B.12">B.12</a>.  Evaluation against Requirement PA-1</span>

   Requirement PA-1 says:

   PA-1  The PA protocol MUST support communication of an extensible set
   of NEA standards-defined attributes.  These attributes will be
   uniquely identifiable from non-standard attributes.

   PA-TNC meets this requirement.  Each attribute is identified with a
   PA-TNC Attribute Vendor ID and a PA-TNC Attribute Type.  IETF
   Standard PA-TNC Attribute Types use a vendor ID of zero (0), in
   contrast with vendor-specific PA-TNC Attribute Types, which will use
   the vendor's SMI Private Enterprise Number as the vendor ID.  The
   IANA will maintain a registry of PA-TNC Attribute Types with new
   values added by Expert Review with Specification Required, as
   described in the IANA Considerations section of this specification.
   Thus, the set of standard attribute types is extensible, but all
   standard attribute types are uniquely identifiable.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.13.%20%20Evaluation%20against%20Requirement%20PA-2"></a><a class="selflink" href="#appendix-B.13" name="appendix-B.13">B.13</a>.  Evaluation against Requirement PA-2</span>

   Requirement PA-2 says:

   PA-2  The PA protocol MUST support communication of an extensible set
   of vendor-specific attributes.  These attributes will be segmented
   into uniquely identifiable vendor-specific namespaces.

   PA-TNC meets this requirement.  Each attribute is identified with a
   PA-TNC Attribute Vendor ID and a PA-TNC Attribute Type.  Vendor-
   defined PA-TNC Attribute Types use the vendor's SMI Private
   Enterprise Number as the PA-TNC Attribute Vendor ID.  Each vendor can
   define up to 2^32 PA-TNC Attribute Types, using its own internal
   processes to manage its set of attribute types.

   The IANA is not involved, other than the initial assignment of the
   vendor's SMI Private Enterprise Number.  Thus, the set of vendor-
   specific attributes is segmented into uniquely identifiable vendor-
   specific namespaces.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.14.%20%20Evaluation%20against%20Requirement%20PA-3"></a><a class="selflink" href="#appendix-B.14" name="appendix-B.14">B.14</a>.  Evaluation against Requirement PA-3</span>

   Requirement PA-3 says:

   PA-3  The PA protocol MUST enable a Posture Validator to make one or
   more requests for attributes from a Posture Collector within a single
   assessment.  This enables the Posture Validator to reassess the
   posture of a particular endpoint feature or to request additional
   posture including from other parts of the endpoint.



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 81]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-82" id="page-82" name="page-82"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   PA-TNC meets this requirement.  The Attribute Request attribute type
   is an IETF Standard PA-TNC Attribute Type that permits a Posture
   Validator to send to one or more Posture Collectors a request for one
   or more attributes.  This attribute may be sent at any point in the
   posture assessment process and may in fact be sent more than once if
   the Posture Validator needs to first determine the type of operating
   system and then request certain attributes specific to that operating
   system, for example.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.15.%20%20Evaluation%20against%20Requirement%20PA-4"></a><a class="selflink" href="#appendix-B.15" name="appendix-B.15">B.15</a>.  Evaluation against Requirement PA-4</span>

   Requirement PA-4 says:

   PA-4  The PA protocol MUST be capable of returning attributes from a
   Posture Validator to a Posture Collector.  For example, this might
   enable the Posture Collector to learn the specific reason for a
   failed assessment and to aid in remediation and notification of the
   system owner.

   PA-TNC meets this requirement.  A Posture Validator can easily send
   attributes to one or more Posture Collectors.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.16.%20%20Evaluation%20against%20Requirement%20PA-5"></a><a class="selflink" href="#appendix-B.16" name="appendix-B.16">B.16</a>.  Evaluation against Requirement PA-5</span>

   Requirement PA-5 says:

   PA-5  The PA protocol SHOULD provide authentication, integrity, and
   confidentiality of attributes communicated between a Posture
   Collector and Posture Validator.  This enables end-to-end security
   across a NEA deployment that might involve traversal of several
   systems or trust boundaries.

   PA-TNC does not include an explicit PA-level security mechanism but
   does lay a foundation allowing attribute-level security protections
   to be added later.  As an existence proof, the NEA working group
   considered an Internet-Draft proposal capable of encapsulating PA
   attributes within a Cryptographic Message Syntax (CMS) security
   wrapper in a new attribute type.  This proposal offered the
   protections described in this requirement.  However, the NEA WG
   decided that the use cases in scope for the working group did not
   require PA-level security.  The use cases involving PA message
   traversal of multiple systems or trust boundaries were considered out
   of scope; therefore, a Posture Validator to Posture Collector end-to-
   end security protection was considered not to be required.

   Instead, PA-TNC attributes are protected by the PT layer
   authentication, integrity, and confidentiality support.  This
   protects the attributes communicated between the Posture Transport



<span class="grey">Sangster &amp; Narayan           Standards Track                   [Page 82]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-83" id="page-83" name="page-83"> </a>
<span class="grey"><a href="rfc5792.html">RFC 5792</a>                         PA-TNC                       March 2010</span>


   Client and Posture Transport Server.  Because the Posture Collector
   is in the same address space as the Posture Broker Client and Posture
   Transport Client and the Posture Validator is in the same address
   space as the Posture Broker Server and Posture Transport Server, the
   underlying broker and transport components are deemed trusted with
   respect to not tampering with the PA messages (see trust model in
   <a href="#section-5.1">section 5.1</a> for details).  Encrypting the PA-TNC messages would not
   prevent a hostile broker or transport component from attacking the
   messages.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.17.%20%20Evaluation%20against%20Requirement%20PA-6"></a><a class="selflink" href="#appendix-B.17" name="appendix-B.17">B.17</a>.  Evaluation against Requirement PA-6</span>

   Requirement PA-6 says:

   PA-6  The PA protocol MUST be capable of carrying attributes that
   contain non-binary and binary data including encrypted content.

   PA-TNC meets this requirement.  PA-TNC attributes can contain non-
   binary and binary data including encrypted content.  For examples,
   see the attribute type definitions contained in this specification.

Authors' Addresses

   Paul Sangster
   Symantec Corporation
   6825 Citrine Drive
   Carlsbad, CA 92009
   USA
   EMail: Paul_Sangster@symantec.com

   Kaushik Narayan
   Cisco Systems Inc.
   10 West Tasman Drive
   San Jose, CA 95134
   USA
   EMail: kaushik@cisco.com















Sangster &amp; Narayan           Standards Track                   [Page 83]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc5792 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:33 GMT --></html>