<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc5049 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:37 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:5049" name="DC.Identifier"/>
<meta content="This document describes some specifics that apply when Signaling
Compression (SigComp) is applied to the Session Initiation Protocol
(SIP), such as default minimum values of SigComp parameters,
compartment and state management, and a few issues on SigComp over
TCP. Any implementation of SigComp for use with SIP must conform to
this document and SigComp, and in addition, support the SIP and
Session Description Protocol (SDP) static dictionary. [STANDARDS-
TRACK]" name="DC.Description.Abstract"/>
<meta content="Camarillo, Gonzalo" name="DC.Creator"/>
<meta content="Liu, Zhigang" name="DC.Creator"/>
<meta content="Bormann, Carsten" name="DC.Creator"/>
<meta content="Price, Richard" name="DC.Creator"/>
<meta content="December, 2007" name="DC.Date.Issued"/>
<meta content="Applying Signaling Compression (SigComp) to the Session Initiation Protocol (SIP)" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5049 - Applying Signaling Compression (SigComp) to the Session Initiation Protocol (SIP)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc5049.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc5049" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-rohc-sigcomp-sip" title="draft-ietf-rohc-sigcomp-sip">draft-ietf-rohc...</a>] [<a href="https://datatracker.ietf.org/doc/rfc5049" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5049" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc5049" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                         C. Bormann
Request for Comments: 5049                       Universitaet Bremen TZI
Category: Standards Track                                         Z. Liu
                                                   Nokia Research Center
                                                                R. Price
                               EADS Defence and Security Systems Limited
                                                       G. Camarillo, Ed.
                                                                Ericsson
                                                           December 2007


                <span class="h1">Applying Signaling Compression (SigComp)</span>
                <span class="h1">to the Session Initiation Protocol (SIP)</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Abstract

   This document describes some specifics that apply when Signaling
   Compression (SigComp) is applied to the Session Initiation Protocol
   (SIP), such as default minimum values of SigComp parameters,
   compartment and state management, and a few issues on SigComp over
   TCP.  Any implementation of SigComp for use with SIP must conform to
   this document and SigComp, and in addition, support the SIP and
   Session Description Protocol (SDP) static dictionary.




















<span class="grey">Bormann, et al.             Standards Track                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Terminology .....................................................<a href="#page-3">3</a>
   <a href="#section-3">3</a>. Compliance with This Specification ..............................<a href="#page-3">3</a>
   <a href="#section-4">4</a>. Minimum Values of SigComp Parameters for SIP/SigComp ............<a href="#page-3">3</a>
      <a href="#section-4.1">4.1</a>. decompression_memory_size (DMS) for SIP/SigComp ............<a href="#page-4">4</a>
      <a href="#section-4.2">4.2</a>. state_memory_size (SMS) for SIP/SigComp ....................<a href="#page-4">4</a>
      <a href="#section-4.3">4.3</a>. cycles_per_bit (CPB) for SIP/SigComp .......................<a href="#page-5">5</a>
      <a href="#section-4.4">4.4</a>. SigComp_version (SV) for SIP/SigComp .......................<a href="#page-5">5</a>
      <a href="#section-4.5">4.5</a>. locally available state (LAS) for SIP/SigComp ..............<a href="#page-5">5</a>
   <a href="#section-5">5</a>. Delimiting SIP Messages and SigComp Messages on the Same Port ...<a href="#page-5">5</a>
   <a href="#section-6">6</a>. Continuous Mode over TCP ........................................<a href="#page-6">6</a>
   <a href="#section-7">7</a>. Too-Large SIP Messages ..........................................<a href="#page-7">7</a>
   <a href="#section-8">8</a>. SIP Retransmissions .............................................<a href="#page-7">7</a>
   <a href="#section-9">9</a>. Compartment and State Management for SIP/SigComp ................<a href="#page-7">7</a>
      <a href="#section-9.1">9.1</a>. Remote Application Identification ..........................<a href="#page-8">8</a>
      <a href="#section-9.2">9.2</a>. Identifier Comparison Rules ...............................<a href="#page-10">10</a>
      <a href="#section-9.3">9.3</a>. Compartment Opening and Closure ...........................<a href="#page-11">11</a>
      <a href="#section-9.4">9.4</a>. Lack of a Compartment .....................................<a href="#page-13">13</a>
   <a href="#section-10">10</a>. Recommendations for Network Administrators ....................<a href="#page-13">13</a>
   <a href="#section-11">11</a>. Private Agreements ............................................<a href="#page-14">14</a>
   <a href="#section-12">12</a>. Backwards Compatibility .......................................<a href="#page-14">14</a>
   <a href="#section-13">13</a>. Interactions with Transport Layer Security (TLS) ..............<a href="#page-14">14</a>
   <a href="#section-14">14</a>. Example .......................................................<a href="#page-15">15</a>
   <a href="#section-15">15</a>. Security Considerations .......................................<a href="#page-17">17</a>
   <a href="#section-16">16</a>. IANA Considerations ...........................................<a href="#page-17">17</a>
   <a href="#section-17">17</a>. Acknowledgements ..............................................<a href="#page-17">17</a>
   <a href="#section-18">18</a>. References ....................................................<a href="#page-18">18</a>
      <a href="#section-18.1">18.1</a>. Normative References .....................................<a href="#page-18">18</a>
      <a href="#section-18.2">18.2</a>. Informative References ...................................<a href="#page-19">19</a>




















<span class="grey">Bormann, et al.             Standards Track                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   SigComp [<a href="rfc3320.html" title='"Signaling Compression (SigComp)"'>RFC3320</a>] is a solution for compressing messages generated by
   application protocols.  Although its primary driver is to compress
   SIP [<a href="rfc3261.html" title='"SIP: Session Initiation Protocol"'>RFC3261</a>] messages, the solution itself has been intentionally
   designed to be application agnostic so that it can be applied to any
   application protocol; this is denoted as ANY/SigComp.  Consequently,
   many application-dependent specifics are left out of the base
   standard.  It is intended that a separate specification be used to
   describe those specifics when SigComp is applied to a particular
   application protocol.

   This document binds SigComp and SIP; this is denoted as SIP/SigComp.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Compliance%20with%20This%20Specification"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Compliance with This Specification</span>

   Any SigComp implementation that is used for the compression of SIP
   messages MUST conform to this document, as well as to [<a href="rfc3320.html" title='"Signaling Compression (SigComp)"'>RFC3320</a>].
   Additionally, it must support the SIP/SDP static dictionary, as
   specified in [<a href="rfc3485.html" title='"The Session Initiation Protocol (SIP) and Session Description Protocol (SDP) Static Dictionary for Signaling Compression (SigComp)"'>RFC3485</a>], and the mechanism for discovering SigComp
   support at the SIP layer, as specified in [<a href="rfc3486.html" title='"Compressing the Session Initiation Protocol (SIP)"'>RFC3486</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Minimum%20Values%20of%20SigComp%20Parameters%20for%20SIP%2FSigComp"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Minimum Values of SigComp Parameters for SIP/SigComp</span>

   In order to support a wide range of capabilities among endpoints
   implementing SigComp, SigComp defines a few parameters to describe
   SigComp behavior (see <a href="rfc3320.html#section-3.3">Section 3.3 of [RFC3320]</a>).  For each parameter,
   [<a href="rfc3320.html" title='"Signaling Compression (SigComp)"'>RFC3320</a>] specifies a minimum value that any SigComp endpoint MUST
   support for ANY/SigComp.  Those minimum values were determined with
   the consideration of all imaginable devices in which SigComp may be
   implemented.  Scalability was also considered as a key factor.

   However, some of the minimum values specified in [<a href="rfc3320.html" title='"Signaling Compression (SigComp)"'>RFC3320</a>] are too
   small to allow good performance for SIP message compression.
   Therefore, they are increased for SIP/SigComp as specified in the
   following sections.  For completeness, those parameters that are the
   same for SIP/SigComp as they are for ANY/SigComp are also listed.

   The new minimum values are specific to SIP/SigComp and, thus, do not
   apply to any other application protocols.  A SIP/SigComp endpoint MAY
   offer additional resources over and above the minimum values




<span class="grey">Bormann, et al.             Standards Track                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


   specified in this document if available; these resources can be
   advertised to remote endpoints as described in <a href="rfc3320.html#section-9.4.9">Section 9.4.9 of
   [RFC3320]</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20decompression_memory_size%20%28DMS%29%20for%20SIP%2FSigComp"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  decompression_memory_size (DMS) for SIP/SigComp</span>


   Minimum value for ANY/SigComp: 2048 bytes, as specified in <a href="rfc3320.html#section-3.3.1">Section</a>
   <a href="rfc3320.html#section-3.3.1">3.3.1 of [RFC3320]</a>.

   Minimum value for SIP/SigComp: 8192 bytes.

   Reason: a DMS of 2048 bytes is too small for SIP message compression
   as it seriously limits the compression ratio and even makes
   compression impossible for certain messages.  For example, the
   condition set by [<a href="rfc3320.html" title='"Signaling Compression (SigComp)"'>RFC3320</a>] for SigComp over UDP means: C + 2*B + R +
   2*S + 128 &lt; DMS (each term is described below).  Therefore, if DMS is
   too small, at least one of C, B, R, or S will be severely restricted.
   On the other hand, DMS is memory that is only temporarily needed
   during decompression of a SigComp message (the memory can be
   reclaimed when the message has been decompressed).  Therefore, a
   requirement of 8 KB should not cause any problems for an endpoint
   that already implements SIP, SigComp, and applications that use SIP.

   C    size of compressed application message, depending on R
   B    size of bytecode.  Note: two copies -- one as part of the
        SigComp message and one in UDVM (Universal Decompressor Virtual
        Machine) memory.
   R    size of circular buffer in UDVM memory
   S    any additional state uploaded other than that created from the
        content of the circular buffer at the end of decompression
        (similar to B, two copies of S are needed)
   128  the smallest address in UDVM memory to copy bytecode to

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20state_memory_size%20%28SMS%29%20for%20SIP%2FSigComp"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  state_memory_size (SMS) for SIP/SigComp</span>

   Minimum value for ANY/SigComp: 0 (zero) bytes, as specified in
   <a href="rfc3320.html#section-3.3.1">Section 3.3.1 of [RFC3320]</a>.

   Minimum value for SIP/SigComp: 2048 bytes.

   Reason: a non-zero SMS allows an endpoint to upload a state in the
   first SIP message sent to a remote endpoint without the uncertainty
   of whether the remote endpoint will have enough memory to store such
   a state.  A non-zero SMS obviously requires the SIP/SigComp
   implementation to keep state.  Based on the observation that there is
   little gain from stateless SigComp compression, the assumption is
   that purely stateless SIP implementations are unlikely to provide a



<span class="grey">Bormann, et al.             Standards Track                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


   SigComp function.  Stateful implementations should have little
   problem to keep 2K additional state for each compartment (see <a href="#section-9">Section</a>
   <a href="#section-9">9</a>).

   Note: SMS is a parameter that applies to each individual compartment.
   An endpoint MAY offer different SMS values for different compartments
   as long as the SMS value is not less than 2048 bytes.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20cycles_per_bit%20%28CPB%29%20for%20SIP%2FSigComp"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  cycles_per_bit (CPB) for SIP/SigComp</span>

   Minimum value for ANY/SigComp: 16, as specified in <a href="rfc3320.html#section-3.3.1">Section 3.3.1 of
   [RFC3320]</a>.

   Minimum value for SIP/SigComp: 16 (same as above).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.4.%20%20SigComp_version%20%28SV%29%20for%20SIP%2FSigComp"></a><a class="selflink" href="#section-4.4" name="section-4.4">4.4</a>.  SigComp_version (SV) for SIP/SigComp</span>

   For ANY/SigComp: 0x01, as specified in <a href="rfc3320.html#section-3.3.2">Section 3.3.2 of [RFC3320]</a>.

   For SIP/SigComp: &gt;= 0x02 (at least SigComp + NACK).

   Note that this implies that the provisions of [<a href="rfc4077.html" title='"A Negative Acknowledgement Mechanism for Signaling Compression"'>RFC4077</a>] apply.  That
   is, decompression failures result in SigComp NACK messages sent back
   to the originating compressor.  It also implies that the compressor
   need not make use of the methods detailed in <a href="rfc4077.html#section-2.4">Section 2.4 of [RFC4077]</a>
   (Detecting Support for NACK); for example, it can use optimistic
   compression methods right from the outset.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.5.%20%20locally%20available%20state%20%28LAS%29%20for%20SIP%2FSigComp"></a><a class="selflink" href="#section-4.5" name="section-4.5">4.5</a>.  locally available state (LAS) for SIP/SigComp</span>

   Minimum LAS for ANY/SigComp: none, see <a href="rfc3320.html#section-3.3.3">Section 3.3.3 of [RFC3320]</a>.

   Minimum LAS for SIP/SigComp: the SIP/SDP static dictionary as defined
   in [<a href="rfc3485.html" title='"The Session Initiation Protocol (SIP) and Session Description Protocol (SDP) Static Dictionary for Signaling Compression (SigComp)"'>RFC3485</a>].

   Note that, since support for the static SIP/SDP dictionary is
   mandatory, it does not need to be advertised.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Delimiting%20SIP%20Messages%20and%20SigComp%20Messages%20on%20the%20Same%20Port"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Delimiting SIP Messages and SigComp Messages on the Same Port</span>

   In order to limit the number of ports required by a SigComp-aware
   endpoint, it is possible to allow both SigComp messages and 'vanilla'
   SIP messages (i.e., uncompressed SIP messages with no SigComp header)
   to arrive on the same port.

   For a message-based transport such as UDP or Stream Control
   Transmission Protocol (SCTP), distinguishing between SigComp and
   non-SigComp messages can be done per message.  The receiving endpoint



<span class="grey">Bormann, et al.             Standards Track                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


   checks the first octet of the UDP/SCTP payload to determine whether
   the message has been compressed using SigComp.  If the MSBs (Most
   Significant Bits) of the octet are "11111", then the message is
   considered to be a SigComp message and is parsed as per [<a href="rfc3320.html" title='"Signaling Compression (SigComp)"'>RFC3320</a>].
   If the MSBs of the octet take any other value, then the message is
   assumed to be an uncompressed SIP message, and it is passed directly
   to the application with no further effect on the SigComp layer.

   For a stream-based transport such as TCP, distinguishing between
   SigComp and non-SigComp messages has to be done per connection.  The
   receiving endpoint checks the first octet of the TCP data stream to
   determine whether the stream has been compressed using SigComp.  If
   the MSBs of the octet are "11111", then the stream is considered to
   contain SigComp messages and is parsed as per [<a href="rfc3320.html" title='"Signaling Compression (SigComp)"'>RFC3320</a>].  If the MSBs
   of the octet take any other value, then the stream is assumed to
   contain uncompressed SIP messages, and it is passed directly to the
   application with no further effect on the SigComp layer.  Note that
   SigComp message delimiters MUST NOT be used if the stream contains
   uncompressed SIP messages.

   Applications MUST NOT mix SIP messages and SigComp messages on a
   single TCP connection.  If the TCP connection is used to carry
   SigComp messages, then all messages sent over the connection MUST
   have a SigComp header and be delimited by the use of 0xFFFF, as
   described in [<a href="rfc3320.html" title='"Signaling Compression (SigComp)"'>RFC3320</a>].

   <a href="rfc4896.html#section-11">Section 11 of [RFC4896]</a> details a simple set of bytecodes, intended
   to be "well-known", that implement a null decompression algorithm.
   These bytecodes effectively allow SigComp peers to send selected
   SigComp messages with uncompressed data.  If a SIP implementation has
   reason to send both compressed and uncompressed SIP messages on a
   single TCP connection, the compressor can be instructed to use these
   bytecodes to send uncompressed SIP messages that are also valid
   SigComp messages.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Continuous%20Mode%20over%20TCP"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Continuous Mode over TCP</span>

   Continuous Mode is a special feature of SigComp, which is designed to
   improve the overall compression ratio for long-lived connections.
   Its use requires pre-agreement between the SigComp compressor and
   decompressor.  Continuous mode is not used with SIP/SigComp.

   Reason: continuous mode requires the transport itself to provide a
   certain level of protection against denial-of-service attacks.  TCP
   alone is not considered to provide enough protection.






<span class="grey">Bormann, et al.             Standards Track                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Too-Large%20SIP%20Messages"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Too-Large SIP Messages</span>

   SigComp does not support the compression of messages larger than 64k.
   Therefore, if a SIP application sending compressed SIP messages to
   another SIP application over a transport connection (e.g., a TCP
   connection) needs to send a SIP message larger than 64k, the SIP
   application MUST NOT send the message over the same TCP connection.
   The SIP application SHOULD send the message over a different
   transport connection (to do this, the SIP application may need to
   establish a new transport connection).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20SIP%20Retransmissions"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  SIP Retransmissions</span>

   When SIP messages are retransmitted, they need to be re-compressed,
   taking into account any SigComp states that may have been created or
   invalidated since the previous transmission.  Implementations MUST
   NOT cache the result of compressing the message and retransmit such a
   cached result.

   The reason for this behavior is that it is impossible to know whether
   the failure causing the retransmission occurred on the message being
   retransmitted or on the response to that message.  If the response
   was lost, any state changes effected by the first instance of the
   retransmitted message would already have taken place.  If these state
   changes removed a state that the previously transmitted message
   relied upon, then retransmission of the same compressed message would
   lead to a decompression failure.

   Note that a SIP retransmission may be caused by the original message
   or its response being lost by a decompression failure.  In this case,
   a NACK will have been sent by the decompressor to the compressor,
   which may use the information in this NACK message to adjust its
   compression parameters.  Note that, on an unreliable transport, such
   a NACK message may still be lost, so if a compressor used some form
   of optimistic compression, it MAY want to switch to a method less
   likely to cause any form of decompression failure when compressing a
   SIP retransmission.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Compartment%20and%20State%20Management%20for%20SIP%2FSigComp"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Compartment and State Management for SIP/SigComp</span>

   An application exchanging compressed traffic with a remote
   application has a compartment that contains state information needed
   to compress outgoing messages and to decompress incoming messages.
   To increase the compression efficiency, the application must assign
   distinct compartments to distinct remote applications.






<span class="grey">Bormann, et al.             Standards Track                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20Remote%20Application%20Identification"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  Remote Application Identification</span>

   SIP/SigComp applications identify remote applications by their SIP/
   SigComp identifiers.  Each SIP/SigComp application MUST have a SIP/
   SigComp identifier URN (Uniform Resource Name) that uniquely
   identifies the application.  Usage of a URN provides a persistent and
   unique name for the SIP/SigComp identifier.  It also provides an easy
   way to guarantee uniqueness.  This URN MUST be persistent as long as
   the application stores compartment state related to other SIP/SigComp
   applications.

   A SIP/SigComp application SHOULD use a UUID (Universally Unique
   IDentifier) URN as its SIP/SigComp identifier, due to the
   difficulties in equality comparisons for other kinds of URNs.  The
   UUID URN [<a href="rfc4122.html" title='"A Universally Unique IDentifier (UUID) URN Namespace"'>RFC4122</a>] allows for non-centralized computation of a URN
   based on time, unique names (such as a Media Access Control (MAC)
   address), or a random number generator.  If a URN scheme other than
   UUID is used, the URN MUST be selected such that the application can
   be certain that no other SIP/SigComp application would choose the
   same URN value.

   Note that the definition of SIP/SigComp identifier is similar to the
   definition of instance identifier in [<a href="#ref-OUTBOUND" title='"Managing Client Initiated Connections in the Session Initiation Protocol (SIP)"'>OUTBOUND</a>].  One difference is
   that instance identifiers are only required to be unique within their
   AoR (Address of Record) while SIP/SigComp identifiers are required to
   be globally unique.

   Even if instance identifiers are only required to be unique within
   their AoR, devices may choose to generate globally unique instance
   identifiers.  A device with a globally unique instance identifier
   SHOULD use its instance identifier as its SIP/SigComp identifier.

      Note: Using the same value for an entity's instance and
      SIP/SigComp identifiers improves the compression ratio of header
      fields that carry both identifiers (e.g., a Contact header field
      in a REGISTER request).

   Server farms that share SIP/SigComp state across servers MUST use the
   same SIP/SigComp identifier for all their servers.

   SIP/SigComp identifiers are carried in the 'sigcomp-id' SIP URI
   (Uniform Resource Identifier) or Via header field parameter.  The
   'sigcomp-id' SIP URI parameter is a 'uri-parameter', as defined by
   the SIP ABNF (Augmented Backus-Naur Form, <a href="rfc3261.html#section-25.1">Section 25.1 of [RFC3261]</a>).
   The following is its ABNF [<a href="rfc4234.html" title='"Augmented BNF for Syntax Specifications: ABNF"'>RFC4234</a>]:

      uri-sip-sigcomp-id = "sigcomp-id=" 1*paramchar




<span class="grey">Bormann, et al.             Standards Track                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


   The SIP URI 'sigcomp-id' parameter MUST contain a URN [<a href="rfc2141.html" title='"URN Syntax"'>RFC2141</a>].

   The Via 'sigcomp-id' parameter is a 'via-extension', as defined by
   the SIP ABNF (<a href="rfc3261.html#section-25.1">Section 25.1 of [RFC3261]</a>).  The following is its ABNF
   [<a href="rfc4234.html" title='"Augmented BNF for Syntax Specifications: ABNF"'>RFC4234</a>]:

      via-sip-sigcomp-id = "sigcomp-id" EQUAL
                      LDQUOT *( qdtext / quoted-pair ) RDQUOT

   The Via 'sigcomp-id' parameter MUST contain a URN [<a href="rfc2141.html" title='"URN Syntax"'>RFC2141</a>].

   The following is an example of a 'sigcomp-id' SIP URI parameter:

      sigcomp-id=urn:uuid:0C67446E-F1A1-11D9-94D3-000A95A0E128

   The following is an example of a Via header field with a 'sigcomp-id'
   parameter:

      Via: SIP/2.0/UDP server1.example.com:5060
         ;branch=z9hG4bK87a7
         ;comp=sigcomp
         ;sigcomp-id="urn:uuid:0C67446E-F1A1-11D9-94D3-000A95A0E128"

   The following is an example of a REGISTER request that carries
   'sigcomp-id' parameters in a Via entry and in the Contact header
   field.  Additionally, it also carries a '+sip.instance' Contact
   header field parameter.

      REGISTER sip:example.net SIP/2.0
      Via: SIP/2.0/UDP 192.0.2.247:2078;branch=z9hG4bK-et736vsjirav;
        rport;sigcomp-id="urn:uuid:2e5fdc76-00be-4314-8202-1116fa82a473"
      From: "Joe User" &lt;sip:2145550500@example.net&gt;;tag=6to4gh7t5j
      To:  "Joe User" &lt;sip:2145550500@example.net&gt;
      Call-ID: 3c26700c1adb-lu1lz5ri5orr
      CSeq: 215196 REGISTER
      Max-Forwards: 70
      Contact: &lt;sip:2145550500@192.0.2.247:2078;
        sigcomp-id=urn:uuid:2e5fdc76-00be-4314-8202-1116fa82a473&gt;;
        q=1.0; expires=3600;
        +sip.instance="&lt;urn:uuid:2e5fdc76-00be-4314-8202-1116fa82a473&gt;"
      Content-Length: 0

   SIP messages are matched with remote application identifiers as
   follows:

   Outgoing requests: the remote application identifier is the SIP/
      SigComp identifier of the URI to which the request is sent.  If
      the URI does not contain a SIP/SigComp identifier, the remote



<span class="grey">Bormann, et al.             Standards Track                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


      application identifier is the IP address plus port of the datagram
      carrying the request for connectionless transport protocols, and
      the transport connection (e.g., a TCP connection) carrying the
      request for connection-oriented transport protocols (this is to
      support legacy SIP/SigComp applications).

   Incoming responses: the remote application identifier is the same as
      that of the previously sent request that initiated the transaction
      to which the response belongs.

   Incoming requests: the remote application identifier is the SIP/
      SigComp identifier of the top-most Via entry.  If the Via header
      field does not contain a SIP/SigComp identifier, the remote
      application identifier is the source IP address plus port of the
      datagram carrying the request for connectionless transport
      protocols, and the transport connection (e.g., a TCP connection)
      carrying the request for connection-oriented transport protocols
      (this is to support legacy SIP/SigComp applications).

   Outgoing responses: the remote application identifier is the same as
      that of the previously received request that initiated the
      transaction to which the response belongs.  Note that, due to
      standard SIP Via header field processing, this identifier will be
      present in the top-most Via entry in such responses (as long as it
      was present in the top-most Via entry of the previously received
      request).

   A SIP/SigComp application placing its URI with the 'comp=sigcomp'
   parameter in a header field MUST add a 'sigcomp-id' parameter with
   its SIP/SigComp identifier to that URI.

   A SIP/SigComp application generating its own Via entry containing the
   'comp=sigcomp' parameter MUST add a 'sigcomp-id' parameter with its
   SIP/SigComp identifier to that Via entry.

   A given remote application identifier is mapped to a particular
   SigComp compartment ID following the rules given in <a href="#section-9.3">Section 9.3</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20Identifier%20Comparison%20Rules"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  Identifier Comparison Rules</span>

   Equality comparisons between SIP/SigComp identifiers are performed
   using the rules for URN equality that are specific to the scheme in
   the URN.  If the element performing the comparisons does not
   understand the URN scheme, it performs the comparisons using the
   lexical equality rules defined in <a href="rfc2141.html">RFC 2141</a> [<a href="rfc2141.html" title='"URN Syntax"'>RFC2141</a>].  Lexical
   equality may result in two URNs being considered unequal when they
   are actually equal.  In this specific usage of URNs, the only element
   that provides the URN is the SIP/SigComp application identified by



<span class="grey">Bormann, et al.             Standards Track                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


   that URN.  As a result, the SIP/SigComp application SHOULD provide
   lexically equivalent URNs in each registration it generates.  This is
   likely to be normal behavior in any case; applications are not likely
   to modify the value of their SIP/SigComp identifiers so that they
   remain functionally equivalent yet lexicographically different from
   previous identifiers.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.3.%20%20Compartment%20Opening%20and%20Closure"></a><a class="selflink" href="#section-9.3" name="section-9.3">9.3</a>.  Compartment Opening and Closure</span>

   SIP applications need to know when to open a new compartment and when
   to close it.  The lifetime of SIP/SigComp compartments is linked to
   registration state.  Compartments are opened at SIP registration time
   and are typically closed when the registration expires or is
   canceled.

      Note: Linking the lifetime of SIP/SigComp compartments to
      registration state limits the applicability of this specification.
      In particular, SIP user agents that do not register but, for
      example, only handle PUBLISH or SUBSCRIBE/NOTIFY transactions are
      not able create SIP/SigComp compartments following this
      specification.  Previous revisions of this specification also
      defined compartments valid during a SIP transaction or a SIP
      dialog.  Those compartments covered all possible SIP entities,
      including those that do not handle REGISTER transactions.
      However, it was decided to eliminate those types of compartments
      because the complexity they introduced (e.g., edge proxy servers
      were required to keep dialog state) was higher than the benefits
      they brought in most deployment scenarios.

   Usually, any states created during the lifetime of a compartment will
   be "logically" deleted when the compartment is closed.  As described
   in <a href="rfc3320.html#section-6.2">Section 6.2 of [RFC3320]</a>, a logical deletion can become a physical
   deletion only when no compartment continues to exist that created the
   (same) state.

   A SigComp endpoint may offer to keep a state created upon request
   from a SigComp peer endpoint beyond the default lifetime of a
   compartment (i.e., beyond the duration of its associated
   registration).  This may be used to improve compression efficiency of
   subsequent SIP messages generated by the same remote application at
   the SigComp peer endpoint.  To indicate that such state will continue
   to be available, the SigComp endpoint can inform its peer SigComp
   endpoint by announcing the (partial) state ID in the returned SigComp
   parameters at the end of the registration that was supposed to limit
   the lifetime of the SigComp state.  That signals the state will be
   maintained.  The mandatory support for the SigComp Negative





<span class="grey">Bormann, et al.             Standards Track                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


   Acknowledgement (NACK) Mechanism [<a href="rfc4077.html" title='"A Negative Acknowledgement Mechanism for Signaling Compression"'>RFC4077</a>] in SIP/SigComp ensures
   that it is possible to recover from synchronization errors regarding
   compartment lifetimes.

   As an operational concern, bugs in the compartment management
   implementation are likely to lead to sporadic, hard-to-diagnose
   failures.  Decompressors may therefore want to cache old state and,
   if still available, allow access while logging diagnostic
   information.  Both compressors and decompressors use the SigComp
   Negative Acknowledgement (NACK) Mechanism [<a href="rfc4077.html" title='"A Negative Acknowledgement Mechanism for Signaling Compression"'>RFC4077</a>] to recover from
   situations where such old state may no longer be available.

   A REGISTER transaction causes an application to open a new
   compartment to be valid for the duration of the registration
   established by the REGISTER transaction.

   A SIP application that needs to send a compressed SIP REGISTER (i.e.,
   a user agent generating a REGISTER or a proxy server relaying one to
   its next hop) SHOULD open a compartment for the request's remote
   application identifier.  A SIP application that receives a compressed
   SIP REGISTER (i.e., the registrar or a proxy relaying the REGISTER to
   its next-hop) SHOULD open a compartment for the request's remote
   application identifier.

   These compartments MAY be closed if the REGISTER request is responded
   with a non-2xx final response, or when the registration expires or is
   canceled.  However, applications MAY also choose to keep these
   compartments open for a longer period of time, as discussed
   previously.  For a given successful registration, applications SHOULD
   NOT close their associated compartments until the registration is
   over.

      Note: A SIP network can be configured so that regular SIP traffic
      to and from a user agent traverses a different set of proxies than
      the initial REGISTER transaction.  The path the REGISTER
      transaction follows is typically determined by configuration data.
      The path subsequent requests traverse is determined by the Path
      [<a href="rfc3327.html" title='"Session Initiation Protocol (SIP) Extension Header Field for Registering Non-Adjacent Contacts"'>RFC3327</a>] and the Service-Route [<a href="rfc3308.html" title='"Layer Two Tunneling Protocol (L2TP) Differentiated Services Extension"'>RFC3308</a>] header fields in the
      REGISTER transaction and by the Record-Route and the Route header
      fields in dialog-creating transactions.  Previous revisions of
      this document supported the use of different paths for different
      types of traffic.  However, for simplicity reasons, this document
      now assumes that networks using compression will be configured so
      that subsequent requests follow the same path as the initial
      REGISTER transaction in order to achieve the best possible
      compression.  <a href="#section-10">Section 10</a> provides network administrators with
      recommendations so that they can configure the networks properly.




<span class="grey">Bormann, et al.             Standards Track                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


   If, following the rules above, a SIP application is supposed to open
   a compartment for a remote application identifier for which it
   already has a compartment (e.g., the SIP application registers
   towards a second registrar using the same edge proxy server as for
   its registration towards its first registrar), the SIP application
   MUST use the already existing compartment.  That is, the SIP
   application MUST NOT open a new compartment.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.4.%20%20Lack%20of%20a%20Compartment"></a><a class="selflink" href="#section-9.4" name="section-9.4">9.4</a>.  Lack of a Compartment</span>

   The use of stateless compression (i.e., compression without a
   compartment) is not typically worthwhile and may even result in
   message expansion.  Therefore, if a SIP application does not have a
   compartment for a message it needs to send, it MAY choose not to
   compress it even in the presence of the 'comp=sigcomp' parameter.
   <a href="#section-5">Section 5</a> describes how a SIP application can send compressed and
   uncompressed messages over the same TCP connection.  Note that <a href="rfc3486.html">RFC</a>
   <a href="rfc3486.html">3486</a> [<a href="rfc3486.html" title='"Compressing the Session Initiation Protocol (SIP)"'>RFC3486</a>] states the following:

      "If the next-hop URI contains the parameter comp=sigcomp, the
      client SHOULD compress the request using SigComp".

   Experience since <a href="rfc3486.html">RFC 3486</a> [<a href="rfc3486.html" title='"Compressing the Session Initiation Protocol (SIP)"'>RFC3486</a>] was written has shown that
   stateless compression is, in most cases, not worthwhile.  That is why
   it is not recommended to use it any longer.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Recommendations%20for%20Network%20Administrators"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Recommendations for Network Administrators</span>

   Network administrators can configure their networks so that the
   compression efficiency achieved is increased.  The following
   recommendations help network administrators perform their task.

   For a given user agent, the route sets for incoming requests (created
   by a Path header field) and for outgoing requests (created by a
   Service-Route header field) are typically the same.  However,
   registrars can, if they wish, insert proxies in the latter route that
   do not appear in the former route and vice versa.  It is RECOMMENDED
   that registrars are configured so that proxies performing SigComp
   compression appear in both routes.

   The routes described previously apply to requests sent outside a
   dialog.  Requests inside a dialog follow a route constructed using
   Record-Route header fields.  It is RECOMMENDED that the proxies
   performing SigComp that are in the route for requests outside a
   dialog are configured to place themselves (by inserting themselves in
   the Record-Route header fields) in the routes used for requests
   inside dialogs.




<span class="grey">Bormann, et al.             Standards Track                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


   When a user agent's registration expires, proxy servers performing
   compression may close their associated SIP/SigComp compartment.  If
   the user agent is involved in a dialog that was established before
   the registration expired, subsequent requests within the dialog may
   not be compressed any longer.  In order to avoid this situation, it
   is RECOMMENDED that user agents are registered as long as they are
   involved in a dialog.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20Private%20Agreements"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  Private Agreements</span>

   SIP/SigComp implementations that are subject to private agreements
   MAY deviate from this specification, if the private agreements
   unambiguously specify so.  Plausible candidates for such deviations
   include:

   o  Minimum values (<a href="#section-4">Section 4</a>).
   o  Use of continuous mode (<a href="#section-6">Section 6</a>).
   o  Compartment definition (<a href="#section-9">Section 9</a>).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/12.%20%20Backwards%20Compatibility"></a><a class="selflink" href="#section-12" name="section-12">12</a>.  Backwards Compatibility</span>

   SigComp has a number of parameters that can be configured per
   endpoint.  This document specifies a profile for SigComp when used
   for SIP compression that further constrains the range that some of
   these parameters may take.  Examples of this are Decompressor Memory
   Size, State Memory Size, and SigComp Version (support for NACK).
   Additionally, this document specifies how SIP/SigComp applications
   should perform compartment mapping.

   When this document was written, there were already a few existing
   SIP/SigComp deployments.  The rules in this document have been
   designed to maximize interoperability with those legacy SIP/SigComp
   implementations.  Nevertheless, implementers should be aware that
   legacy SIP/SigComp implementations may not conform to this
   specification.  Examples of problems with legacy applications would
   be smaller DMS than mandated in this document, lack of NACK support,
   or a different compartment mapping.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/13.%20%20Interactions%20with%20Transport%20Layer%20Security%20%28TLS%29"></a><a class="selflink" href="#section-13" name="section-13">13</a>.  Interactions with Transport Layer Security (TLS)</span>

   Endpoints exchanging SIP traffic over a TLS [<a href="rfc4346.html" title='"The Transport Layer Security (TLS) Protocol Version 1.1"'>RFC4346</a>] connection can
   use the compression provided by TLS.  Two endpoints exchanging SIP/
   SigComp traffic over a TLS connection that provides compression need
   to first compress the SIP messages using SigComp and then pass them
   to the TLS layer, which will compress them again.  When receiving
   data, the processing order is reversed.





<span class="grey">Bormann, et al.             Standards Track                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


   However, compressing messages this way twice does not typically bring
   significant gains.  Once a message is compressed using SigComp, TLS
   is not usually able to compress it further.  Therefore, TLS will
   normally only be able to compress SigComp code sent between
   compressor and decompressor.  Since the gain of having SigComp code
   compressed should be minimal in most cases, it is NOT RECOMMENDED to
   use TLS compression when SigComp compression is being used.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/14.%20%20Example"></a><a class="selflink" href="#section-14" name="section-14">14</a>.  Example</span>

   Figure 1 shows an example message flow where the user agent and the
   outbound proxy exchange compressed SIP traffic.  Compressed messages
   are marked with a (c).

           User Agent      Outbound Proxy       Registrar

                |(1) REGISTER (c) |                 |
                |----------------&gt;|                 |
                |                 |(2) REGISTER     |
                |                 |----------------&gt;|
                |                 |(3) 200 OK       |
                |                 |&lt;----------------|
                |(4) 200 OK (c)   |                 |
                |&lt;----------------|                 |
                |(5) INVITE (c)   |                 |
                |----------------&gt;|                 |
                |                 |(6) INVITE       |
                |                 |------------------------------&gt;
                |                 |(7) 200 OK       |
                |                 |&lt;------------------------------
                |(8) 200 OK (c)   |                 |
                |&lt;----------------|                 |
                |(9) ACK (c)      |                 |
                |----------------&gt;|                 |
                |                 |(10) ACK         |
                |                 |------------------------------&gt;
                |(11) BYE (c)     |                 |
                |----------------&gt;|                 |
                |                 |(12) BYE         |
                |                 |------------------------------&gt;
                |                 |(13) 200 OK      |
                |                 |&lt;------------------------------
                |(14) 200 OK (c)  |                 |
                |&lt;----------------|                 |

                         Figure 1: Example Message Flow





<span class="grey">Bormann, et al.             Standards Track                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


   The user agent in Figure 1 is initially configured (e.g., using the
   SIP configuration framework [<a href="#ref-CONFIG" title='"A Framework for Session Initiation Protocol User Agent Profile Delivery"'>CONFIG</a>]) with the URI of its outbound
   proxy.  That URI contains the outbound proxy's SIP/SigComp
   identifier, referred to as 'Outbound-id', in a 'sigcomp-id'
   parameter.

   When the user agent sends an initial REGISTER request (1) to the
   outbound proxy's URI, the user agent opens a new compartment for
   'Outbound-id'.  This compartment will be valid for the duration of
   the registration, at least.

   On receiving this REGISTER request (1), the outbound proxy opens a
   new compartment for the SIP/SigComp identifier that appears in the
   'sigcomp-id' parameter of the top-most Via entry.  This identifier,
   which is the user agent's SIP/SigComp identifier, is referred to as
   'UA-id'.  The compartment opened by the outbound proxy will be valid
   for the duration of the registration, at least.  The outbound proxy
   adds a Path header field with its own URI, which contains the
   'Outbound-id' SIP/SigComp identifier, to the REGISTER request and
   relays it to the registrar (2).

   When the registrar receives the REGISTER request (2), it constructs
   the route future incoming requests (to the user agent) will follow
   using the Contact and the Path header fields.  Future incoming
   requests will traverse the outbound proxy before reaching the user
   agent.

   The registrar also constructs the route future outgoing requests
   (from the user agent) will follow and places it in a Service-Route
   header field in a 200 (OK) response (3).  Future outgoing requests
   will always traverse the outbound proxy.  The registrar has ensured
   that the outbound proxy performing compression handles both incoming
   and outgoing requests.

   When the outbound proxy receives a 200 (OK) response (3), it inspects
   the top-most Via entry.  This entry's SIP/SigComp identifier 'UA-id'
   matches that of the compartment created before.  Therefore, the
   outbound proxy uses that compartment to compress it and relay it to
   the user agent.

   On receiving the 200 (OK) response (4), the user agent stores the
   Service-Route header field in order to use it to send future outgoing
   requests.  The Service-Route header field contains the outbound
   proxy's URI, which contains the 'Outbound-id' SIP/SigComp identifier.

   At a later point, the user agent needs to send an INVITE request (5).
   According to the Service-Route header field received previously, the
   user agent sends the INVITE request (5) to the outbound proxy's URI.



<span class="grey">Bormann, et al.             Standards Track                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


   Since this URI's SIP/SigComp identifier 'Outbound-id' matches that of
   the compartment created before, this compartment is used to compress
   the INVITE request.

   On receiving the INVITE request (5), the outbound proxy Record Routes
   and relays the INVITE request (6) forward.  The outbound proxy Record
   Routes to ensure that all SIP messages related to this new dialog are
   routed through the outbound proxy.

   Finally, the dialog is terminated by a BYE transaction (11) that also
   traverses the outbound proxy.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/15.%20%20Security%20Considerations"></a><a class="selflink" href="#section-15" name="section-15">15</a>.  Security Considerations</span>

   The same security considerations as described in [<a href="rfc3320.html" title='"Signaling Compression (SigComp)"'>RFC3320</a>] apply to
   this document.  Note that keeping SigComp states longer than the
   duration of a SIP dialog should not pose new security risks because
   the state has been allowed to be created in the first place.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/16.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-16" name="section-16">16</a>.  IANA Considerations</span>

   The IANA has registered the 'sigcomp-id' Via header field parameter,
   which is defined in <a href="#section-9.1">Section 9.1</a>, under the Header Field Parameters
   and Parameter Values subregistry within the SIP Parameters registry:

                                                  Predefined
   Header Field                  Parameter Name     Values     Reference
   ----------------------------  ---------------   ---------   ---------
   Via                           sigcomp-id           No       [<a href="rfc5049.html">RFC5049</a>]

   The IANA has registered the 'sigcomp-id' SIP URI parameter, which is
   defined in <a href="#section-9.1">Section 9.1</a>, under the SIP/SIPS URI Parameters subregistry
   within the SIP Parameters registry:

   Parameter Name     Predefined Values     Reference
   --------------     -----------------     ---------
   sigcomp-id         No                    [<a href="rfc5049.html">RFC5049</a>]

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/17.%20%20Acknowledgements"></a><a class="selflink" href="#section-17" name="section-17">17</a>.  Acknowledgements</span>

   The authors would like to thank the following people for their
   comments and suggestions: Jan Christoffersson, Joerg Ott, Mark West,
   Pekka Pessi, Robert Sugar, Jonathan Rosenberg, Robert Sparks, Juergen
   Schoenwaelder, and Tuukka Karvonen.  Abigail Surtees and Adam Roach
   performed thorough reviews of this document.






<span class="grey">Bormann, et al.             Standards Track                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/18.%20%20References"></a><a class="selflink" href="#section-18" name="section-18">18</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/18.1.%20%20Normative%20References"></a><a class="selflink" href="#section-18.1" name="section-18.1">18.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC2141" name="ref-RFC2141">RFC2141</a>]  Moats, R., "URN Syntax", <a href="rfc2141.html">RFC 2141</a>, May 1997.

   [<a id="ref-RFC3261" name="ref-RFC3261">RFC3261</a>]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,
              A., Peterson, J., Sparks, R., Handley, M., and E.
              Schooler, "SIP: Session Initiation Protocol", <a href="rfc3261.html">RFC 3261</a>,
              June 2002.

   [<a id="ref-RFC3308" name="ref-RFC3308">RFC3308</a>]  Calhoun, P., Luo, W., McPherson, D., and K. Peirce, "Layer
              Two Tunneling Protocol (L2TP) Differentiated Services
              Extension", <a href="rfc3308.html">RFC 3308</a>, November 2002.

   [<a id="ref-RFC3320" name="ref-RFC3320">RFC3320</a>]  Price, R., Bormann, C., Christoffersson, J., Hannu, H.,
              Liu, Z., and J. Rosenberg, "Signaling Compression
              (SigComp)", <a href="rfc3320.html">RFC 3320</a>, January 2003.

   [<a id="ref-RFC3327" name="ref-RFC3327">RFC3327</a>]  Willis, D. and B. Hoeneisen, "Session Initiation Protocol
              (SIP) Extension Header Field for Registering Non-Adjacent
              Contacts", <a href="rfc3327.html">RFC 3327</a>, December 2002.

   [<a id="ref-RFC3485" name="ref-RFC3485">RFC3485</a>]  Garcia-Martin, M., Bormann, C., Ott, J., Price, R., and A.
              Roach, "The Session Initiation Protocol (SIP) and Session
              Description Protocol (SDP) Static Dictionary for Signaling
              Compression (SigComp)", <a href="rfc3485.html">RFC 3485</a>, February 2003.

   [<a id="ref-RFC3486" name="ref-RFC3486">RFC3486</a>]  Camarillo, G., "Compressing the Session Initiation
              Protocol (SIP)", <a href="rfc3486.html">RFC 3486</a>, February 2003.

   [<a id="ref-RFC4077" name="ref-RFC4077">RFC4077</a>]  Roach, A., "A Negative Acknowledgement Mechanism for
              Signaling Compression", <a href="rfc4077.html">RFC 4077</a>, May 2005.

   [<a id="ref-RFC4122" name="ref-RFC4122">RFC4122</a>]  Leach, P., Mealling, M., and R. Salz, "A Universally
              Unique IDentifier (UUID) URN Namespace", <a href="rfc4122.html">RFC 4122</a>, July
              2005.

   [<a id="ref-RFC4234" name="ref-RFC4234">RFC4234</a>]  Crocker, D., Ed., and P. Overell, "Augmented BNF for
              Syntax Specifications: ABNF", <a href="rfc4234.html">RFC 4234</a>, October 2005.

   [<a id="ref-RFC4346" name="ref-RFC4346">RFC4346</a>]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.1", <a href="rfc4346.html">RFC 4346</a>, April 2006.





<span class="grey">Bormann, et al.             Standards Track                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


   [<a id="ref-RFC4896" name="ref-RFC4896">RFC4896</a>]  Surtees, A., West, M., and A. Roach, "Signaling
              Compression (SigComp) Corrections and Clarifications", <a href="rfc4896.html">RFC</a>
              <a href="rfc4896.html">4896</a>, June 2007.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/18.2.%20%20Informative%20References"></a><a class="selflink" href="#section-18.2" name="section-18.2">18.2</a>.  Informative References</span>

   [<a id="ref-CONFIG" name="ref-CONFIG">CONFIG</a>]   Petrie, D. and S. Channabasappa, "A Framework for Session
              Initiation Protocol User Agent Profile Delivery", Work in
              Progress, June 2007.

   [<a id="ref-OUTBOUND" name="ref-OUTBOUND">OUTBOUND</a>] Jennings, C. and R. Mahy, "Managing Client Initiated
              Connections in the Session Initiation Protocol  (SIP)",
              Work in Progress, March 2007.






































<span class="grey">Bormann, et al.             Standards Track                    [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


Authors' Addresses

   Carsten Bormann
   Universitaet Bremen TZI
   Postfach 330440
   Bremen D-28334
   Germany

   Phone: +49 421 218 63921
   Fax:   +49 421 218 7000
   EMail: cabo@tzi.org


   Zhigang Liu
   Nokia Research Center
   955 Page Mill Road
   Palo Alto, CA 94304
   USA

   Phone: +1 650 796 4578
   EMail: zhigang.c.liu@nokia.com


   Richard Price
   EADS Defence and Security Systems Limited
   Meadows Road
   Queensway Meadows
   Newport, Gwent NP19 4SS

   Phone: +44 (0)1633 637874
   EMail: richard.price@eads.com


   Gonzalo Camarillo (editor)
   Ericsson
   Hirsalantie 11
   Jorvas 02420
   Finland

   EMail: Gonzalo.Camarillo@ericsson.com











<span class="grey">Bormann, et al.             Standards Track                    [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc5049.html">RFC 5049</a>                Applying SigComp to SIP            December 2007</span>


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.












Bormann, et al.             Standards Track                    [Page 21]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc5049 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:37 GMT --></html>