<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7251 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:23 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:7251" name="DC.Identifier"/>
<meta content="This memo describes the use of the Advanced Encryption Standard (AES)
in the Counter and CBC-MAC Mode (CCM) of operation within Transport
Layer Security (TLS) to provide confidentiality and data-origin
authentication. The AES-CCM algorithm is amenable to compact
implementations, making it suitable for constrained environments,
while at the same time providing a high level of security. The cipher
suites defined in this document use Elliptic Curve Cryptography (ECC)
and are advantageous in networks with limited bandwidth." name="DC.Description.Abstract"/>
<meta content="Bailey, Daniel" name="DC.Creator"/>
<meta content="Campagna, Matthew" name="DC.Creator"/>
<meta content="Dugal, Robert" name="DC.Creator"/>
<meta content="McGrew, David" name="DC.Creator"/>
<meta content="June, 2014" name="DC.Date.Issued"/>
<meta content="AES-CCM Elliptic Curve Cryptography (ECC) Cipher Suites for TLS" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7251 - AES-CCM Elliptic Curve Cryptography (ECC) Cipher Suites for TLS</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7251.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7251" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-mcgrew-tls-aes-ccm-ecc" title="draft-mcgrew-tls-aes-ccm-ecc">draft-mcgrew-tl...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7251" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7251" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7251" title="Side-by-side diff">Diff2</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=7251&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>]   </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                         D. McGrew
Request for Comments: 7251                                 Cisco Systems
Category: Informational                                        D. Bailey
ISSN: 2070-1721                                   Ruhr-University Bochum
                                                             M. Campagna
                                                                R. Dugal
                                                          Certicom Corp.
                                                               June 2014


    <span class="h1">AES-CCM Elliptic Curve Cryptography (ECC) Cipher Suites for TLS</span>

Abstract

   This memo describes the use of the Advanced Encryption Standard (AES)
   in the Counter and CBC-MAC Mode (CCM) of operation within Transport
   Layer Security (TLS) to provide confidentiality and data-origin
   authentication.  The AES-CCM algorithm is amenable to compact
   implementations, making it suitable for constrained environments,
   while at the same time providing a high level of security.  The
   cipher suites defined in this document use Elliptic Curve
   Cryptography (ECC) and are advantageous in networks with limited
   bandwidth.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7251">http://www.rfc-editor.org/info/rfc7251</a>.












<span class="grey">McGrew, et al.                Informational                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7251.html">RFC 7251</a>                     AES-CCM ECC TLS                   June 2014</span>


Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-1.1">1.1</a>.  Conventions Used in This Document . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  ECC-Based AES-CCM Cipher Suites . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-2.1">2.1</a>.  AEAD Algorithms . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-2.2">2.2</a>.  Requirements on Curves and Hashes . . . . . . . . . . . .   <a href="#page-5">5</a>
   <a href="#section-3">3</a>.  TLS Versions  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
   <a href="#section-4">4</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-5">5</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-5.1">5.1</a>.  Perfect Forward Secrecy . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-5.2">5.2</a>.  Counter Reuse . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-5.3">5.3</a>.  Hardware Security Modules . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-6">6</a>.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-7">7</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-7.1">7.1</a>.  Normative References  . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-7.2">7.2</a>.  Informative References  . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
   <a href="#appendix-A">Appendix A</a>.  Recommended Curves and Algorithms  . . . . . . . . .   <a href="#page-9">9</a>


















<span class="grey">McGrew, et al.                Informational                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7251.html">RFC 7251</a>                     AES-CCM ECC TLS                   June 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   This document describes the use of Advanced Encryption Standard (AES)
   [<a href="#ref-AES" title='"Specification for the Advanced Encryption Standard (AES)"'>AES</a>] in Counter with CBC-MAC Mode (CCM) [<a href="#ref-CCM" title='"Recommendation for Block Cipher Modes of Operation: The CCM Mode for Authentication and Confidentiality"'>CCM</a>] in several TLS cipher
   suites.  AES-CCM provides both authentication and confidentiality
   (encryption and decryption) and uses as its only primitive the AES
   encrypt block cipher operation.  This makes it amenable to compact
   implementations, which are advantageous in constrained environments.
   Of course, adoption outside of constrained environments is necessary
   to enable interoperability, such as that between web clients and
   embedded servers, or between embedded clients and web servers.  The
   use of AES-CCM has been specified for the IPsec Encapsulating
   Security Payload (ESP) [<a href="rfc4309.html" title='"Using Advanced Encryption Standard (AES) CCM Mode with IPsec Encapsulating Security Payload (ESP)"'>RFC4309</a>] and 802.15.4 wireless networks
   [<a href="#ref-IEEE802154">IEEE802154</a>].

   Authenticated encryption, in addition to providing confidentiality
   for the plaintext that is encrypted, provides a way to check its
   integrity and authenticity.  Authenticated Encryption with Associated
   Data, or AEAD [<a href="rfc5116.html" title='"An Interface and Algorithms for Authenticated Encryption"'>RFC5116</a>], adds the ability to check the integrity and
   authenticity of some associated data that is not encrypted.  This
   memo utilizes the AEAD facility within TLS 1.2 [<a href="rfc5246.html" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>RFC5246</a>] and the AES-
   CCM-based AEAD algorithms defined in [<a href="rfc5116.html" title='"An Interface and Algorithms for Authenticated Encryption"'>RFC5116</a>] and [<a href="rfc6655.html" title='"AES-CCM Cipher Suites for Transport Layer Security (TLS)"'>RFC6655</a>].  All of
   these algorithms use AES-CCM; some have shorter authentication tags
   and are therefore more suitable for use across networks in which
   bandwidth is constrained and message sizes may be small.

   The cipher suites defined in this document use Ephemeral Elliptic
   Curve Diffie-Hellman (ECDHE) as their key establishment mechanism;
   these cipher suites can be used with DTLS [<a href="rfc6347.html" title='"Datagram Transport Layer Security Version 1.2"'>RFC6347</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20ECC-Based%20AES-CCM%20Cipher%20Suites"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  ECC-Based AES-CCM Cipher Suites</span>

   The cipher suites defined in this document are based on the AES-CCM
   Authenticated Encryption with Associated Data (AEAD) algorithms
   AEAD_AES_128_CCM and AEAD_AES_256_CCM described in [<a href="rfc5116.html" title='"An Interface and Algorithms for Authenticated Encryption"'>RFC5116</a>].  The
   following cipher suites are defined:

      CipherSuite TLS_ECDHE_ECDSA_WITH_AES_128_CCM = {0xC0,0xAC}
      CipherSuite TLS_ECDHE_ECDSA_WITH_AES_256_CCM = {0xC0,0xAD}
      CipherSuite TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8 = {0xC0,0xAE}
      CipherSuite TLS_ECDHE_ECDSA_WITH_AES_256_CCM_8 = {0xC0,0xAF}




<span class="grey">McGrew, et al.                Informational                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7251.html">RFC 7251</a>                     AES-CCM ECC TLS                   June 2014</span>


   These cipher suites make use of the AEAD capability in TLS 1.2
   [<a href="rfc5246.html" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>RFC5246</a>].  Note that each of these AEAD algorithms uses AES-CCM.
   Cipher suites ending with "8" use eight-octet authentication tags;
   the other cipher suites have 16-octet authentication tags.

   The HMAC truncation option described in <a href="rfc6066.html#section-7">Section 7 of [RFC6066]</a> (which
   negotiates the "truncated_hmac" TLS extension) does not have an
   effect on the cipher suites defined in this note, because they do not
   use HMAC to protect TLS records.

   The "nonce" input to the AEAD algorithm is as defined in [<a href="rfc6655.html" title='"AES-CCM Cipher Suites for Transport Layer Security (TLS)"'>RFC6655</a>].

   In DTLS, the 64-bit seq_num field is the 16-bit DTLS epoch field
   concatenated with the 48-bit sequence_number field.  The epoch and
   sequence_number appear in the DTLS record layer.

   This construction allows the internal counter to be 32 bits long,
   which is a convenient size for use with CCM.

   These cipher suites make use of the default TLS 1.2 Pseudorandom
   Function (PRF), which uses HMAC with the SHA-256 hash function.

   The ECDHE_ECDSA key exchange is performed as defined in [<a href="rfc4492.html" title='"Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS)"'>RFC4492</a>],
   with the following additional stipulations:

   o  Curves with a cofactor equal to one SHOULD be used; this
      simplifies their use.

   o  The uncompressed point format MUST be supported.  Other point
      formats MAY be used.

   o  The client SHOULD offer the elliptic_curves extension, and the
      server SHOULD expect to receive it.

   o  The client MAY offer the ec_point_formats extension, but the
      server need not expect to receive it.

   o  Fundamental ECC algorithms [<a href="rfc6090.html" title='"Fundamental Elliptic Curve Cryptography Algorithms"'>RFC6090</a>] MAY be used as an
      implementation method.

   o  If the server uses a certificate, then the requirements in <a href="rfc4492.html">RFC</a>
      <a href="rfc4492.html">4492</a> apply: "The server's certificate MUST contain an ECDSA-
      capable public key and be signed with ECDSA."  Guidance on
      acceptable choices of hashes and curves that can be used with each
      cipher suite is detailed in <a href="#section-2.2">Section 2.2</a>.  The Signature Algorithms
      extension (<a href="rfc5246.html#section-7.4.1.4.1">Section 7.4.1.4.1 of [RFC5246]</a>) SHOULD be used to
      indicate support of those signature and hash algorithms.  If a
      client certificate is used, the same criteria SHOULD apply to it.



<span class="grey">McGrew, et al.                Informational                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7251.html">RFC 7251</a>                     AES-CCM ECC TLS                   June 2014</span>


   Implementations of these cipher suites will interoperate with
   [<a href="rfc4492.html" title='"Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS)"'>RFC4492</a>] but can be more compact than a full implementation of that
   RFC.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20AEAD%20Algorithms"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  AEAD Algorithms</span>

   The following AEAD algorithms are used:

      AEAD_AES_128_CCM is used in the TLS_ECDHE_ECDSA_WITH_AES_128_CCM
      cipher suite,

      AEAD_AES_256_CCM is used in the TLS_ECDHE_ECDSA_WITH_AES_256_CCM
      cipher suite,

      AEAD_AES_128_CCM_8 is used in the
      TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8 cipher suite, and

      AEAD_AES_256_CCM_8 is used in the
      TLS_ECDHE_ECDSA_WITH_AES_256_CCM_8 cipher suite.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Requirements%20on%20Curves%20and%20Hashes"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Requirements on Curves and Hashes</span>

   Implementations SHOULD select elliptic curves and hash functions so
   that AES-128 is used with a curve and a hash function supporting a
   128-bit security level, and AES-256 is used with a curve and a hash
   function supporting a 192-bit or 256-bit security level.  More
   detailed guidance on cryptographic parameter selection is given in
   [<a href="#ref-SP800-57" title='"Recommendation for Key Management - Part 1: General (Revision 3)"'>SP800-57</a>] (see especially Tables 2 and 3).

   <a href="#appendix-A">Appendix A</a> describes suitable curves and hash functions that are
   widely available.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20TLS%20Versions"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  TLS Versions</span>

   These cipher suites make use of the authenticated encryption with
   additional data defined in TLS 1.2 [<a href="rfc5288.html" title='"AES Galois Counter Mode (GCM) Cipher Suites for TLS"'>RFC5288</a>].  They MUST NOT be
   negotiated in older versions of TLS.  Clients MUST NOT offer these
   cipher suites if they do not offer TLS 1.2 or later.  Servers that
   select an earlier version of TLS MUST NOT select one of these cipher
   suites.  Earlier versions do not have support for AEAD; for instance,
   the TLSCiphertext structure does not have the "aead" option in TLS
   1.1.  Because TLS has no way for the client to indicate that it
   supports TLS 1.2 but not earlier versions, a non-compliant server
   might potentially negotiate TLS 1.1 or earlier and select one of the
   cipher suites in this document.  Clients MUST check the TLS version
   and generate a fatal "illegal_parameter" alert if they detect an
   incorrect version.




<span class="grey">McGrew, et al.                Informational                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7251.html">RFC 7251</a>                     AES-CCM ECC TLS                   June 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  IANA Considerations</span>

   IANA has assigned the values for the cipher suites defined in
   <a href="#section-2">Section 2</a> from the "TLS Cipher Suite Registry".  The DTLS-OK column
   has been marked as "Y" for each of these algorithms.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Security%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Security Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Perfect%20Forward%20Secrecy"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Perfect Forward Secrecy</span>

   The perfect forward secrecy properties of ephemeral Diffie-Hellman
   cipher suites are discussed in the security analysis of [<a href="rfc5246.html" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>RFC5246</a>].
   This analysis applies to the ECDHE cipher suites.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Counter%20Reuse"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Counter Reuse</span>

   AES-CCM security requires that the counter never be reused.  The IV
   construction in <a href="#section-2">Section 2</a> is designed to prevent counter reuse.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Hardware%20Security%20Modules"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Hardware Security Modules</span>

   A cipher suite can be implemented in such a way that the secret keys
   and private keys are stored inside a Hardware Security Module (HSM),
   and the cryptographic operations involving those keys are performed
   by the HSM on data provided by an application interacting with the
   HSM through an interface such as that defined by the Cryptographic
   Token Interface Standard [<a href="#ref-PKCS11" title='"PKCS #11: Cryptographic Token Interface Standard version 2.20"'>PKCS11</a>].  When an AEAD cipher suite, such
   as those in this note, are implemented in this way, special handling
   of the nonce is required.  This is because the "salt" part of the
   nonce is set to the client_write_IV or server_write_IV, which is a
   function of the TLS master secret.

   Another potential issue with the Cryptographic Token Interface
   Standard is that the use of the DecryptUpdate function is not
   possible with the CCM decrypt operation or the decrypt operation of
   any other authenticated encryption method.  This is because the
   DecryptUpdate requires that post-decryption plaintext be returned
   before the authentication check is completed.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Acknowledgements"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Acknowledgements</span>

   This document borrows heavily from [<a href="rfc5288.html" title='"AES Galois Counter Mode (GCM) Cipher Suites for TLS"'>RFC5288</a>].  Thanks are due to
   Robert Cragie for his great help in making this work complete,
   correct, and useful, and to Peter Dettman for his review.  Thanks
   also to Mike StJohns for pointing out the HSM issues.

   This document is motivated by the considerations raised in the Zigbee
   Smart Energy 2.0 working group.



<span class="grey">McGrew, et al.                Informational                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7251.html">RFC 7251</a>                     AES-CCM ECC TLS                   June 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20References"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Normative%20References"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-AES" name="ref-AES">AES</a>]      National Institute of Standards and Technology,
              "Specification for the Advanced Encryption Standard
              (AES)", FIPS 197, November 2001.

   [<a id="ref-CCM" name="ref-CCM">CCM</a>]      National Institute of Standards and Technology,
              "Recommendation for Block Cipher Modes of Operation: The
              CCM Mode for Authentication and Confidentiality", SP
              800-38C, May 2004.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC4492" name="ref-RFC4492">RFC4492</a>]  Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B.
              Moeller, "Elliptic Curve Cryptography (ECC) Cipher Suites
              for Transport Layer Security (TLS)", <a href="rfc4492.html">RFC 4492</a>, May 2006.

   [<a id="ref-RFC5116" name="ref-RFC5116">RFC5116</a>]  McGrew, D., "An Interface and Algorithms for Authenticated
              Encryption", <a href="rfc5116.html">RFC 5116</a>, January 2008.

   [<a id="ref-RFC5246" name="ref-RFC5246">RFC5246</a>]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.2", <a href="rfc5246.html">RFC 5246</a>, August 2008.

   [<a id="ref-RFC5288" name="ref-RFC5288">RFC5288</a>]  Salowey, J., Choudhury, A., and D. McGrew, "AES Galois
              Counter Mode (GCM) Cipher Suites for TLS", <a href="rfc5288.html">RFC 5288</a>,
              August 2008.

   [<a id="ref-RFC5639" name="ref-RFC5639">RFC5639</a>]  Lochter, M. and J. Merkle, "Elliptic Curve Cryptography
              (ECC) Brainpool Standard Curves and Curve Generation", <a href="rfc5639.html">RFC</a>
              <a href="rfc5639.html">5639</a>, March 2010.

   [<a id="ref-RFC6066" name="ref-RFC6066">RFC6066</a>]  Eastlake, D., "Transport Layer Security (TLS) Extensions:
              Extension Definitions", <a href="rfc6066.html">RFC 6066</a>, January 2011.

   [<a id="ref-RFC6090" name="ref-RFC6090">RFC6090</a>]  McGrew, D., Igoe, K., and M. Salter, "Fundamental Elliptic
              Curve Cryptography Algorithms", <a href="rfc6090.html">RFC 6090</a>, February 2011.

   [<a id="ref-RFC6347" name="ref-RFC6347">RFC6347</a>]  Rescorla, E. and N. Modadugu, "Datagram Transport Layer
              Security Version 1.2", <a href="rfc6347.html">RFC 6347</a>, January 2012.

   [<a id="ref-RFC6655" name="ref-RFC6655">RFC6655</a>]  McGrew, D. and D. Bailey, "AES-CCM Cipher Suites for
              Transport Layer Security (TLS)", <a href="rfc6655.html">RFC 6655</a>, July 2012.






<span class="grey">McGrew, et al.                Informational                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7251.html">RFC 7251</a>                     AES-CCM ECC TLS                   June 2014</span>


   [<a id="ref-SP800-57" name="ref-SP800-57">SP800-57</a>] National Institute of Standards and Technology,
              "Recommendation for Key Management - Part 1: General
              (Revision 3)", SP 800-57 Part 1, July 2012.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Informative%20References"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-IEEE802154" name="ref-IEEE802154">IEEE802154</a>]
              IEEE, "Wireless Personal Area Networks", IEEE Standard
              802.15.4-2006, 2006.

   [<a id="ref-PKCS11" name="ref-PKCS11">PKCS11</a>]   RSA Laboratories, "PKCS #11: Cryptographic Token Interface
              Standard version 2.20", Public Key Cryptography Standards
              PKCS#11-v2.20, 2004.

   [<a id="ref-RFC4309" name="ref-RFC4309">RFC4309</a>]  Housley, R., "Using Advanced Encryption Standard (AES) CCM
              Mode with IPsec Encapsulating Security Payload (ESP)", <a href="rfc4309.html">RFC</a>
              <a href="rfc4309.html">4309</a>, December 2005.


































<span class="grey">McGrew, et al.                Informational                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7251.html">RFC 7251</a>                     AES-CCM ECC TLS                   June 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Recommended%20Curves%20and%20Algorithms"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Recommended Curves and Algorithms</span>

   This memo does not mandate any particular elliptic curves or
   cryptographic algorithms, for the sake of flexibility.  However,
   since the main motivation for the AES-CCM-ECC cipher suites is their
   suitability for constrained environments, it is valuable to identify
   a particular suitable set of curves and algorithms.

   This appendix identifies a set of elliptic curves and cryptographic
   algorithms that meet the requirements of this note and that are
   widely supported and believed to be secure.

   The curves and hash algorithms recommended for each cipher suite are:

      An implementation that includes either
      TLS_ECDHE_ECDSA_WITH_AES_128_CCM or
      TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8 SHOULD support the secp256r1
      curve and the SHA-256 hash function.

      An implementation that includes either
      TLS_ECDHE_ECDSA_WITH_AES_256_CCM or
      TLS_ECDHE_ECDSA_WITH_AES_256_CCM_8 SHOULD support the secp384r1
      curve and the SHA-384 hash function, and MAY support the secp521r1
      curve and the SHA-512 hash function.

   More information about the secp256r1, secp384r1, and secp521r1 curves
   is available in <a href="rfc4492.html#appendix-A">Appendix A of [RFC4492]</a>.

   It is not necessary to implement the above curves and hash functions
   in order to conform to this specification.  Other elliptic curves,
   such as the Brainpool curves [<a href="rfc5639.html" title='"Elliptic Curve Cryptography (ECC) Brainpool Standard Curves and Curve Generation"'>RFC5639</a>], for example, meet the
   criteria laid out in this memo.



















<span class="grey">McGrew, et al.                Informational                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7251.html">RFC 7251</a>                     AES-CCM ECC TLS                   June 2014</span>


Authors' Addresses

   David McGrew
   Cisco Systems
   13600 Dulles Technology Drive
   Herndon, VA  20171
   USA

   EMail: mcgrew@cisco.com


   Daniel V. Bailey
   Ruhr-University Bochum
   Universitatsstr. 150
   44801 Bochum
   Germany

   EMail: danbailey@sth.rub.de


   Matthew Campagna
   Certicom Corp.
   5520 Explorer Drive #400
   Mississauga, Ontario  L4W 5L1
   Canada

   EMail: mcampagna@gmail.com


   Robert Dugal
   Certicom Corp.
   4701 Tahoe Blvd., Building A
   Mississauga, Ontario  L4W 0B5
   Canada

   EMail: rdugal@certicom.com















McGrew, et al.                Informational                    [Page 10]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7251 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:23 GMT --></html>