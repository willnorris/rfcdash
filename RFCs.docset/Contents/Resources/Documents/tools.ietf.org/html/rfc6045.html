<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from tools.ietf.org/html/rfc6045 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.126" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Identifier" content="urn:ietf:rfc:6045" />
<meta name="DC.Description.Abstract" content="Network security incidents, such as system compromises, worms,
viruses, phishing incidents, and denial of service, typically result
in the loss of service, data, and resources both human and system.
Network providers and Computer Security Incident Response Teams need
to be equipped and ready to assist in communicating and tracing
security incidents with tools and procedures in place before the
occurrence of an attack. Real-time Inter-network Defense (RID)
outlines a proactive inter-network communication method to facilitate
sharing incident handling data while integrating existing detection,
tracing, source identification, and mitigation mechanisms for a
complete incident handling solution. Combining these capabilities in a
communication system provides a way to achieve higher security levels
on networks. Policy guidelines for handling incidents are recommended
and can be agreed upon by a consortium using the security
recommendations and considerations.  RID has found use within the
international research communities, but has not been widely adopted in
other sectors. This publication provides the specification to those
communities that have adopted it, and communities currently
considering solutions for real-time inter-network defense. The
specification may also accelerate development of solutions where
different transports or message formats are required by leveraging the
data elements and structures specified here. This document is not an
Internet Standards Track specification; it is published for
informational purposes." />
<meta name="DC.Creator" content="Kathleen M. Moriarty &lt;moriarty@ll.mit.edu&gt;" />
<meta name="DC.Date.Issued" content="November, 2010" />
<meta name="DC.Title" content="Real-time Inter-network Defense (RID)" />

    <link rel="icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 6045 - Real-time Inter-network Defense (RID)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgbrown"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6045.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6045" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-moriarty-post-inch-rid" title="draft-moriarty-post-inch-rid">draft-moriarty-...</a>] [<a href='https://datatracker.ietf.org/doc/rfc6045' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6045" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6045" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=6045">Errata</a>]</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">Obsoleted by: <a href="rfc6545.html">6545</a>                                         INFORMATIONAL</span><br />
<span class="pre noprint docinfo">                                                            <span style='color: #C00;'>Errata Exist</span></span><br />
<pre>
Internet Engineering Task Force (IETF)                       K. Moriarty
Request for Comments: 6045                                           EMC
Category: Informational                                    November 2010
ISSN: 2070-1721


                 <span class="h1">Real-time Inter-network Defense (RID)</span>

Abstract

   Network security incidents, such as system compromises, worms,
   viruses, phishing incidents, and denial of service, typically result
   in the loss of service, data, and resources both human and system.
   Network providers and Computer Security Incident Response Teams need
   to be equipped and ready to assist in communicating and tracing
   security incidents with tools and procedures in place before the
   occurrence of an attack.  Real-time Inter-network Defense (RID)
   outlines a proactive inter-network communication method to facilitate
   sharing incident handling data while integrating existing detection,
   tracing, source identification, and mitigation mechanisms for a
   complete incident handling solution.  Combining these capabilities in
   a communication system provides a way to achieve higher security
   levels on networks.  Policy guidelines for handling incidents are
   recommended and can be agreed upon by a consortium using the security
   recommendations and considerations.

   RID has found use within the international research communities, but
   has not been widely adopted in other sectors.  This publication
   provides the specification to those communities that have adopted it,
   and communities currently considering solutions for real-time inter-
   network defense.  The specification may also accelerate development
   of solutions where different transports or message formats are
   required by leveraging the data elements and structures specified
   here.

















<span class="grey">Moriarty                      Informational                     [Page 1]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">Section&nbsp;2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6045">http://www.rfc-editor.org/info/rfc6045</a>.

Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





















<span class="grey">Moriarty                      Informational                     [Page 2]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-4">4</a>
      <a href="#section-1.1">1.1</a>. Normative and Informative ..................................<a href="#page-6">6</a>
      <a href="#section-1.2">1.2</a>. Terminology ................................................<a href="#page-6">6</a>
      <a href="#section-1.3">1.3</a>. Attack Types and RID Messaging .............................<a href="#page-6">6</a>
   <a href="#section-2">2</a>. RID Integration with Network Provider Technologies ..............<a href="#page-8">8</a>
   <a href="#section-3">3</a>. Characteristics of Attacks ......................................<a href="#page-9">9</a>
      <a href="#section-3.1">3.1</a>. Integrating Trace Approaches ..............................<a href="#page-11">11</a>
      <a href="#section-3.2">3.2</a>. Superset of Packet Information for Traces .................<a href="#page-11">11</a>
   <a href="#section-4">4</a>. Communication between Network Providers ........................<a href="#page-12">12</a>
      <a href="#section-4.1">4.1</a>. Inter-Network Provider RID Messaging ......................<a href="#page-14">14</a>
      <a href="#section-4.2">4.2</a>. RID Network Topology ......................................<a href="#page-16">16</a>
      <a href="#section-4.3">4.3</a>. Message Formats ...........................................<a href="#page-17">17</a>
           <a href="#section-4.3.1">4.3.1</a>. RID Data Types .....................................<a href="#page-17">17</a>
                  <a href="#section-4.3.1.1">4.3.1.1</a>. Boolean ...................................<a href="#page-17">17</a>
           <a href="#section-4.3.2">4.3.2</a>. RID Messages and Transport .........................<a href="#page-18">18</a>
           <a href="#section-4.3.3">4.3.3</a>. IODEF-RID Schema ...................................<a href="#page-19">19</a>
                  <a href="#section-4.3.3.1">4.3.3.1</a>. RequestStatus Class .......................<a href="#page-21">21</a>
                  <a href="#section-4.3.3.2">4.3.3.2</a>. IncidentSource Class ......................<a href="#page-23">23</a>
                  <a href="#section-4.3.3.3">4.3.3.3</a>. RIDPolicy Class ...........................<a href="#page-24">24</a>
           <a href="#section-4.3.4">4.3.4</a>. RID Namespace ......................................<a href="#page-29">29</a>
      <a href="#section-4.4">4.4</a>. RID Messages ..............................................<a href="#page-29">29</a>
           <a href="#section-4.4.1">4.4.1</a>. TraceRequest .......................................<a href="#page-29">29</a>
           <a href="#section-4.4.2">4.4.2</a>. RequestAuthorization ...............................<a href="#page-30">30</a>
           <a href="#section-4.4.3">4.4.3</a>. Result .............................................<a href="#page-31">31</a>
           <a href="#section-4.4.4">4.4.4</a>. Investigation Request ..............................<a href="#page-33">33</a>
           <a href="#section-4.4.5">4.4.5</a>. Report .............................................<a href="#page-35">35</a>
           <a href="#section-4.4.6">4.4.6</a>. IncidentQuery ......................................<a href="#page-36">36</a>
      <a href="#section-4.5">4.5</a>. RID Communication Exchanges ...............................<a href="#page-37">37</a>
           <a href="#section-4.5.1">4.5.1</a>. Upstream Trace Communication Flow ..................<a href="#page-39">39</a>
                  <a href="#section-4.5.1.1">4.5.1.1</a>. RID TraceRequest Example ..................<a href="#page-40">40</a>
                  <a href="#section-4.5.1.2">4.5.1.2</a>. RequestAuthorization Message Example ......<a href="#page-44">44</a>
                  <a href="#section-4.5.1.3">4.5.1.3</a>. Result Message Example ....................<a href="#page-44">44</a>
           <a href="#section-4.5.2">4.5.2</a>. Investigation Request Communication Flow ...........<a href="#page-47">47</a>
                  <a href="#section-4.5.2.1">4.5.2.1</a>. Investigation Request Example .............<a href="#page-48">48</a>
                  <a href="#section-4.5.2.2">4.5.2.2</a>. RequestAuthorization Message Example ......<a href="#page-50">50</a>
           <a href="#section-4.5.3">4.5.3</a>. Report Communication ...............................<a href="#page-51">51</a>
                  <a href="#section-4.5.3.1">4.5.3.1</a>. Report Example ............................<a href="#page-51">51</a>
           <a href="#section-4.5.4">4.5.4</a>. IncidentQuery Communication Flow ...................<a href="#page-54">54</a>
                  <a href="#section-4.5.4.1">4.5.4.1</a>. IncidentQuery Example .....................<a href="#page-54">54</a>
   <a href="#section-5">5</a>. RID Schema Definition ..........................................<a href="#page-55">55</a>









<span class="grey">Moriarty                      Informational                     [Page 3]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   <a href="#section-6">6</a>. Security Considerations ........................................<a href="#page-60">60</a>
      <a href="#section-6.1">6.1</a>. Message Transport .........................................<a href="#page-62">62</a>
      <a href="#section-6.2">6.2</a>. Message Delivery Protocol - Integrity and Authentication ..63
      <a href="#section-6.3">6.3</a>. Transport Communication ...................................<a href="#page-63">63</a>
      <a href="#section-6.4">6.4</a>. Authentication of RID Protocol ............................<a href="#page-64">64</a>
           <a href="#section-6.4.1">6.4.1</a>. Multi-Hop TraceRequest Authentication ..............<a href="#page-65">65</a>
      <a href="#section-6.5">6.5</a>. Consortiums and Public Key Infrastructures ................<a href="#page-66">66</a>
      <a href="#section-6.6">6.6</a>. Privacy Concerns and System Use Guidelines ................<a href="#page-67">67</a>
   <a href="#section-7">7</a>. IANA Considerations ............................................<a href="#page-72">72</a>
   <a href="#section-8">8</a>. Summary ........................................................<a href="#page-72">72</a>
   <a href="#section-9">9</a>. References .....................................................<a href="#page-73">73</a>
      <a href="#section-9.1">9.1</a>. Normative References ......................................<a href="#page-73">73</a>
      <a href="#section-9.2">9.2</a>. Informative References ....................................<a href="#page-74">74</a>
   Acknowledgements ..................................................<a href="#page-75">75</a>
   Sponsor Information ...............................................<a href="#page-75">75</a>

<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   Incident handling involves the detection, reporting, identification,
   and mitigation of an attack, whether it be a system compromise,
   socially engineered phishing attack, or a denial-of-service (DoS)
   attack.  When an attack is detected, the response may include simply
   filing a report, notification to the source of the attack, a request
   for mitigation, or the request to locate the source.  One of the more
   difficult cases is that in which the source of an attack is unknown,
   requiring the ability to trace the attack traffic iteratively
   upstream through the network for the possibility of any further
   actions to take place.  In cases when accurate records of an active
   session between the victim system and the attacker or source system
   are available, the source is easy to identify.  The problem of
   tracing incidents becomes more difficult when the source is obscured
   or spoofed, logs are deleted, and the number of sources is
   overwhelming.  If the source of an attack is known or identified, it
   may be desirable to request actions be taken to stop or mitigate the
   effects of the attack.

   Current approaches to mitigating the effects of security incidents
   are aimed at identifying and filtering or rate-limiting packets from
   attackers who seek to hide the origin of their attack by source
   address spoofing from multiple locations.  Measures can be taken at
   network provider (NP) edge routers providing ingress, egress, and
   broadcast filtering as a recommended best practice in [<a href="rfc2827.html" title="&quot;Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing&quot;">RFC2827</a>].

   Network providers have devised solutions, in-house or commercial, to
   trace attacks across their backbone infrastructure to either identify
   the source on their network or on the next upstream network in the
   path to the source.  Techniques such as collecting packets as traffic
   traverses the network have been implemented to provide the capability



<span class="grey">Moriarty                      Informational                     [Page 4]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   to trace attack traffic after an incident has occurred.  Other
   methods use packet-marking techniques or flow-based traffic analysis
   to trace traffic across the network in real time.  The single-network
   trace mechanisms use similar information across the individual
   networks to trace traffic.  Problems may arise when an attempt is
   made to have a trace continued through the next upstream network
   since the trace mechanism and management may vary.

   In the case in which the traffic traverses multiple networks, there
   is currently no established communication mechanism for continuing
   the trace.  If the next upstream network has been identified, a phone
   call might be placed to contact the network administrators in an
   attempt to have them continue the trace.  A communication mechanism
   is needed to facilitate the transfer of information to continue
   traces accurately and efficiently to upstream networks.  The
   communication mechanism described in this paper, Real-time Inter-
   network Defense (RID), takes into consideration the information
   needed by various single-network trace implementations and the
   requirement for network providers to decide if a TraceRequest should
   be permitted to continue.  The data in RID messages is represented in
   an Extensible Markup Language (XML) [<a href="#ref-XML1.0" title="&quot;Extensible Markup Language (XML) 1.0 (Second Edition)&quot;">XML1.0</a>] document using the
   Incident Object Description Exchange Format (IODEF) and RID.  By
   following this model, integration with other aspects of the network
   for incident handling is simplified.  Finally, methods are
   incorporated into the communication system to indicate what actions
   need to be taken closest to the source in order to halt or mitigate
   the effects of the attack at hand.  RID is intended to provide a
   method to communicate the relevant information between Computer
   Security Incident Response Teams (CSIRTs) while being compatible with
   a variety of existing and possible future detection tracing and
   response approaches.

   At this point, RID has found use within the international research
   communities, but has not been widely adopted in other sectors.  This
   publication provides the specification to those communities that have
   adopted it, and communities currently considering solutions for real-
   time inter-network defense.  The specification may also accelerate
   development of solutions where different transports or message
   formats are required by leveraging the data elements and structures
   specified here.

   Security and privacy considerations are of high concern since
   potentially sensitive information may be passed through RID messages.
   RID messaging takes advantage of XML security and privacy policy
   information set in the RID schema.  The RID schema acts as an XML
   envelope to support the communication of IODEF documents for
   exchanging or tracing information regarding security incidents.  RID
   messages are encapsulated for transport, which is defined in a



<span class="grey">Moriarty                      Informational                     [Page 5]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   separate document [<a href="rfc6046.html" title="&quot;Transport of Real-Time Inter-Network Defense (RID) Messages,&quot;">RFC6046</a>].  The authentication, integrity, and
   authorization features each layer has to offer are used to achieve a
   necessary level of security.

<span class="h3"><a class="selflink" name="section-1.1" href="#section-1.1">1.1</a>.  Normative and Informative</span>

   The XML schema [<a href="#ref-XMLschema" title="&quot;XML Schema&quot;">XMLschema</a>] and transport requirements contained in
   this document are normative; all other information provided is
   intended as informative.  More specifically, the following sections
   of this document are intended as informative: Sections <a href="#section-1">1</a>, <a href="#section-2">2</a>, and <a href="#section-3">3</a>;
   and the sub-sections of 4 including the introduction to 4, 4.1, and
   4.2.  The following sections of this document are normative: The
   sub-sections of 4 including 4.3, 4.4, and 4.5; <a href="#section-5">Section 5</a>; and
   <a href="#section-6">Section 6</a>.

<span class="h3"><a class="selflink" name="section-1.2" href="#section-1.2">1.2</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

<span class="h3"><a class="selflink" name="section-1.3" href="#section-1.3">1.3</a>.  Attack Types and RID Messaging</span>

   RID messaging is intended for use in coordinating incident handling
   to locate the source of an attack and stop or mitigate the effects of
   the attack.  The attack types include system or network compromises,
   denial-of-service attacks, or other malicious network traffic.  RID
   is essentially a messaging system coordinating attack detection,
   tracing mechanisms, and the incident handling responses to locate the
   source of traffic.  If a source address is spoofed, a more detailed
   trace of a packet (RID TraceRequest) would be required to locate the
   true source.  If the source address is valid, the incident handling
   may only involve the use of routing information to determine what
   network provider is closest to the source (RID Investigation request)
   and can assist with the remediation.  The type of RID message used to
   locate a source is determined by the validity of the source address.
   RID message types are discussed in <a href="#section-4.3">Section 4.3</a>.

   DoS [<a href="#ref-DoS" title="&quot;Trends in Denial of Service Attack Technology&quot;">DoS</a>] attacks are characterized by large amounts of traffic
   destined for particular Internet locations and can originate from a
   single or multiple sources.  An attack from multiple sources is known
   as a distributed denial-of-service (DDoS) attack.  Because DDoS
   attacks can originate from multiple sources, tracing such an attack
   can be extremely difficult or nearly impossible.  Many TraceRequests
   may be required to accomplish the task and may require the use of
   dedicated network resources to communicate incident handling
   information to prevent a DoS attack against the RID system and
   network used for tracing and remediation.  Provisions are suggested



<span class="grey">Moriarty                      Informational                     [Page 6]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   to reduce the load and prevent the same trace from occurring twice on
   a single-network backbone discussed in <a href="#section-4">Section 4</a> on communication
   between NPs.  The attacks can be launched from systems across the
   Internet unified in their efforts or by compromised systems enlisted
   as "zombies" that are controlled by servers, thereby providing
   anonymity to the controlling server of the attack.  This scenario may
   require multiple RID traces, one to locate the zombies and an
   additional one to locate the controlling server.  DDoS attacks do not
   necessarily spoof the source of an attack since there are a large
   number of source addresses, which make it difficult to trace anyway.
   DDoS attacks can also originate from a single system or a subset of
   systems that spoof the source address in packet headers in order to
   mask the identity of the attack source.  In this case, an iterative
   trace through the upstream networks in the path of the attack traffic
   may be required.

   RID traces may also be used to locate a system used in an attack to
   compromise another system.  Compromising a system can be accomplished
   through one of many attack vectors, using various techniques from a
   remote host or through local privilege escalation attempts.  The
   attack may exploit a system or application level vulnerability that
   may be the result of a design flaw or a configuration issue.  A
   compromised system, as described above, can be used to later attack
   other systems.  A single RID Investigation request may be used in
   this case since it is probable that the source address is valid.
   Identifying the sources of system compromises may be difficult since
   an attacker may access the compromised system from various sources.
   The attacker may also take measures to hide their tracks by deleting
   log files or by accessing the system through a series of compromised
   hosts.  Iterative RID traces may be required for each of the
   compromised systems used to obscure the source of the attack.  If the
   source address is valid, an Investigation request may be used in lieu
   of a full RID TraceRequest.

   Once an attack has been reported, CSIRTs may want to query other
   CSIRTs if they have detected an attack or simply report that one has
   taken place.  The Report message can be used to file a report without
   an action taken, and an IncidentQuery can be used to ask if an attack
   has been seen by another CSIRT.

   System compromises may result from other security incident types such
   as worms, Trojans, or viruses.  It is often the case that an incident
   goes unreported even if valid source address information is available
   because it is difficult to take any action to mitigate or stop the
   attack.  Incident handling is a difficult task for an NP and even at
   some client locations due to network size and resource limitations.





<span class="grey">Moriarty                      Informational                     [Page 7]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  RID Integration with Network Provider Technologies</span>

   For the purpose of this document, a network provider (NP) shall be
   defined as a backbone infrastructure manager of a network.  The
   network provider's Computer Security Incident Response Team shall be
   referred to as the CSIRT.  The backbone may be that of an
   organization providing network (Internet or private) access to
   commercial, personal, government, or educational institutions, or the
   backbone provider of the connected network.  The connected network
   provider is an extension meant to include Intranet and Extranet
   providers as well as instances such as a business or educational
   institute's private network.

   NPs typically manage and monitor their networks through a centralized
   network management system (NMS).  The acronym "NMS" will be used to
   generically represent management systems on a network used for the
   management of network resources.  An incident handling system (IHS)
   is used to communicate RID messages and may be integrated with an NMS
   as well as other components of the network.  The components of the
   network that may be integrated through the RID messaging system
   include attack or event detection, network tracing, and network
   devices to stop the effects of an attack.

   The detection of security incidents may rely on manual reporting,
   automated intrusion detection tools, and variations in traffic types
   or levels on a network.  Intrusion detection systems (IDSs) may be
   integrated into the IHS to create IODEF documents or RID messages to
   facilitate security incident handling.  Detection of a security
   incident is outside the scope of this paper; however, it should be
   possible to integrate detection methods with RID messaging.

   RID messaging in an IHS is intended to be flexible in order to
   accommodate various traceback systems currently in use as well as
   those that may evolve with technology.  RID is intended to
   communicate the necessary information needed by a trace mechanism to
   the next upstream NP in the path of a trace.  Therefore, a RID
   message must carry the superset of data required for all tracing
   systems.  If possible, the trace may need to inspect packets to
   determine a pattern, which could assist reverse path identification.
   This may be accomplished by inspecting packet header information such
   as the source and destination IP addresses, ports, and protocol flags
   to determine if there is a way to distinguish the packets being
   traced from other packets.  A description of the incident along with
   any available automated trace data should trigger an alert to the
   NP's CSIRT for further investigation.  The various technologies used
   to trace traffic across a network are described in <a href="#section-3.1">Section 3.1</a>.





<span class="grey">Moriarty                      Informational                     [Page 8]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   Another area of integration is the ability to mitigate or stop attack
   traffic once a source has been located.  Any automated solution
   should consider the possible side effects to the network.  A change
   control process or a central point for configuration management might
   be used to ensure that the security of the network and necessary
   functionality are maintained and that equipment configuration changes
   are documented.  Automated solutions may depend upon the capabilities
   and current configuration management solutions on a particular
   network.  The solutions may be based on HTTP/TLS (Transport Layer
   Security) or an appropriate protocol defined in the transport
   specification.

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Characteristics of Attacks</span>

   The goal of tracing a security incident may be to identify the source
   or to find a point on the network as close to the origin of the
   incident as possible.  A security incident may be defined as a system
   compromise, a worm or Trojan infection, or a single- or multiple-
   source denial-of-service attack.  Incident tracing can be used to
   identify the source(s) of an attack in order to halt or mitigate the
   undesired behavior.  The communication system, RID, described in this
   paper can be used to trace any type of security incident and allows
   for actions to be taken when the source of the attack or a point
   closer to the source is known or has been identified.  The purpose of
   tracing an attack would be to halt or mitigate the effects of the
   attack through methods such as filtering or rate-limiting the traffic
   close to the source or by using methods such as taking the host or
   network offline.  Care must also be taken to ensure that the system
   is not abused and to use proper analysis in determining if attack
   traffic is, in fact, attack traffic at each NP along the path of a
   trace.

   Tracing security incidents can be a difficult task since attackers go
   to great lengths to obscure their identity.  In the case of a
   security incident, the true source might be identified through an
   existing established connection to the attacker's point of origin.
   However, the attacker may not connect to the compromised system for a
   long period of time after the initial compromise or may access the
   system through a series of compromised hosts spread across the
   network.  Other methods of obscuring the source may include targeting
   the host with the same attack from multiple sources using both valid
   and spoofed source addresses.  This tactic can be used to compromise
   a machine and leave the difficult task of locating the true origin
   for the administrators.  Security incidents, including DDoS attacks,
   can be difficult or nearly impossible to trace because of the nature
   of the attack.  Some of the difficulties in tracing attacks include
   the following:




<span class="grey">Moriarty                      Informational                     [Page 9]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   o  the attack originates from multiple sources;

   o  the attack may include various types of traffic meant to consume
      server resources, such as a SYN flood attack without a significant
      increase in bandwidth utilization;

   o  the type of traffic could include valid destination services,
      which cannot be blocked since they are essential services to
      business, such as DNS servers at an NP or HTTP requests sent to an
      organization connected to the Internet;

   o  the attack may utilize varying types of packets including TCP,
      UDP, ICMP, or other IP protocols;

   o  the attack may be from "zombies", which then require additional
      searches to locate a controlling server as the true origin of the
      attack;

   o  the attack may use a very small number of packets from any
      particular source, thus making a trace after the fact nearly
      impossible.

   If the source(s) of the attack cannot be determined from IP address
   information or tracing the increased bandwidth utilization, it may be
   possible to trace the traffic based on the type of packets seen by
   the client.  In the case of packets with spoofed source addresses, it
   is no longer a trivial task to identify the source of an attack.  In
   the case of an attack using valid source addresses, methods such as
   the traceroute utility can be used to fairly accurately identify the
   path of the traffic between the source and destination of an attack.
   If the true source has been identified, actions should be taken to
   halt or mitigate the effects of the attack by reporting the incident
   to the NP or the upstream NP closest to the source.  In the case of a
   spoofed source address, other methods can be used to trace back to
   the source of an attack.  The methods include packet filtering,
   packet hash comparisons, IP marking techniques, ICMP traceback, and
   packet flow analysis.  As in the case of attack detection, tracing
   traffic across a single network is a function that can be used with
   RID in order to provide the network with the ability to trace spoofed
   traffic to the source, while RID provides all the necessary
   information to accommodate the approach used on any single network to
   accomplish this task.  RID can also be used to report attack traffic
   close to the source where the IP address used was determined to be
   valid or simply to report that an incident occurred.







<span class="grey">Moriarty                      Informational                    [Page 10]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


<span class="h3"><a class="selflink" name="section-3.1" href="#section-3.1">3.1</a>.  Integrating Trace Approaches</span>

   There have been many separate research initiatives to solve the
   problem of tracing upstream packets to detect the true source of
   attack traffic.  Upstream packet tracing is currently confined to the
   borders of a network or an NP's network.  Traces require access to
   network equipment and resources, thus potentially limiting a trace to
   a specific network.  Once a trace reaches the boundaries of a
   network, the network manager or NP adjacent in the upstream trace
   must be contacted in order to continue the trace.  NPs have been
   working on individual solutions to accomplish upstream tracing within
   their own network environments.  The tracing mechanisms implemented
   thus far have included proprietary or custom solutions requiring
   specific information such as IP packet header data, hash values of
   the attack packets, or marked packets.  Hash values are used to
   compare a packet against a database of packets that have passed
   through the network as described in "Hash-Based IP Traceback"
   [<a href="#ref-HASH-IPtrace" title="&quot;Hash-Based IP Traceback&quot;">HASH-IPtrace</a>].  Other research solutions involve marking packets as
   explained in "ICMP Traceback Messages" [<a href="#ref-ICMPtrace" title="&quot;ICMP Traceback Messages&quot;">ICMPtrace</a>], "Practical
   network support for IP traceback" [<a href="#ref-NTWK-IPtrace" title="&quot;Practical network support for IP traceback&quot;">NTWK-IPtrace</a>], the IP Flow
   Information eXport (IPFIX) protocol [<a href="rfc3917.html" title="&quot;Requirements for IP Flow Information Export (IPFIX)&quot;">RFC3917</a>], and IP marking
   [<a href="#ref-IPtrace" title="&quot;Advanced and Authenticated Marking Schemes for IP Traceback&quot;">IPtrace</a>].  The single-network traceback solutions were considered in
   developing RID to determine the information needed to accomplish an
   inter-network trace where different solutions may be in place.

<span class="h3"><a class="selflink" name="section-3.2" href="#section-3.2">3.2</a>.  Superset of Packet Information for Traces</span>

   In order for network traffic to be traced across a network, an
   example packet from the attack must be sent along with the
   TraceRequest or Investigation request.  According to the research for
   hash-based IP traceback, all of the non-changing fields of an IP
   header along with 8 bytes of payload are required to provide enough
   information to uniquely trace the path of a packet.  The non-changing
   fields of the packet header and the 8 bytes of payload are the
   superset of data required by most single-network tracing systems
   used; limiting the shared data to the superset of the packet header
   and 8 bytes of payload prevents the need for sharing potentially
   sensitive information that may be contained in the data portion of a
   packet.

   The RecordItem class in the IODEF is used to store a hexadecimal
   formatted packet including all packet header information plus 8 bytes
   of payload, or the entire packet contents.  The above trace systems
   do not require a full packet, but it may be useful in some cases, so
   the option is given to allow a full packet to be included in the data
   model.





<span class="grey">Moriarty                      Informational                    [Page 11]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   If a subset of a packet is used, the research presented in "Hash-
   Based IP Traceback" [<a href="#ref-HASH-IPtrace" title="&quot;Hash-Based IP Traceback&quot;">HASH-IPtrace</a>] provides guidelines to establish a
   minimum requirement for distinguishing packets.  The full packet and
   content SHOULD be provided, but the minimum requirement MUST be
   provided.  The research from [<a href="#ref-HASH-IPtrace" title="&quot;Hash-Based IP Traceback&quot;">HASH-IPtrace</a>] found that the first 28
   invariant bytes of a packet (masked IP header plus the first 8 bytes
   of the payload) are sufficient to differentiate almost all non-
   identical IPv4 packets.  RID requires the first 28 invariant bytes of
   an IPv4 packet in order to perform a trace.  RID requires the first
   48 invariant bytes for an IPv6 packet in order to distinguish the
   packet in a trace.  Reference [<a href="#ref-HASH-IPtrace" title="&quot;Hash-Based IP Traceback&quot;">HASH-IPtrace</a>] for additional details.

   The input mechanism for packets to be traced should be flexible to
   allow intrusion detection systems or packet sniffers to provide the
   information.  The system creating the RID message should also use the
   packet information to populate the Incident class information in
   order to avoid human error and also allow a system administrator to
   override the automatically populated information.

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Communication between Network Providers</span>

   Note: The Introduction, and Sub-sections <a href="#section-4.1">4.1</a> and <a href="#section-4.2">4.2</a>, are
   informative, with the exception of references to IODEF/RID Transport
   [<a href="rfc6046.html" title="&quot;Transport of Real-Time Inter-Network Defense (RID) Messages,&quot;">RFC6046</a>].  Sub-sections <a href="#section-4.3">4.3</a>, <a href="#section-4.4">4.4</a>, and <a href="#section-4.5">4.5</a> are normative.

   Expediting the communication between CSIRTs is essential when
   responding to a security-related incident, which may cross network
   access points (Internet backbones) between providers.  As a result of
   the urgency involved in this inter-NP security incident
   communication, there must be an effective system in place to
   facilitate the interaction.  This communication policy or system
   should involve multiple means of communication to avoid a single
   point of failure.  Email is one way to transfer information about the
   incident, packet traces, etc.  However, email may not be received in
   a timely fashion or be acted upon with the same urgency as a phone
   call or other communication mechanism.

   Each NP should dedicate a phone number to reach a member of their
   respective CSIRT.  The phone number could be dedicated to inter-NP
   incident communications and must be a hotline that provides a 24x7
   live response.  The phone line should reach someone who would have
   the authority, expertise, and the means to expedite the necessary
   action to investigate the incident.  This may be a difficult policy
   to establish at smaller NPs due to resource limitations, so another
   solution may be necessary.  An outside group may be able to serve
   this function if given the necessary access to the NP's network.  The
   outside resource should be able to mitigate or alleviate the
   financial limitations and any lack of experienced resource personnel.



<span class="grey">Moriarty                      Informational                    [Page 12]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   A technical solution to trace traffic across a single NP may include
   homegrown or commercial systems for which RID messaging must
   accommodate the input requirements.  The IHS used on the NP's
   backbone by the CSIRT to coordinate the trace across the single
   network requires a method to accept and process RID messages and
   relay TraceRequests to the system, as well as to wait for responses
   from the system to continue the RID request process as appropriate.
   In this scenario, each NP would maintain its own RID/IHS and
   integrate with a management station used for network monitoring and
   analysis.  An alternative for NPs lacking sufficient resources may be
   to have a neutral third party with access to the NP's network
   resources who could be used to perform the incident handling
   functions.  This could be a function of a central organization
   operating as a CSIRT for the Internet as a whole or within a
   consortium that may be able to provide centralized resources.
   Consortiums would consist of a group of NPs and/or CSIRTs that agree
   to participate in the RID communication protocol with an agreed-upon
   policy and communication protocol facilitating the secure transport
   of IODEF/RID XML documents.  Transport for RID messages is specified
   in the IODEF/RID Transport [<a href="rfc6046.html" title="&quot;Transport of Real-Time Inter-Network Defense (RID) Messages,&quot;">RFC6046</a>] document.

   One goal of RID is to prevent the need to permit access to other
   networks' equipment through the use of a standard messaging mechanism
   to enable IHSs to communicate incident handling information to other
   networks in a consortium or in neighboring networks.  The third party
   mentioned above may be used in this technical solution to assist in
   facilitating incident handling and possibly traceback through smaller
   NPs.  The RID messaging mechanism may be a logical or physical out-
   of-band network to ensure that the communication is secure and
   unaffected by the state of the network under attack.  The two
   management methods would accommodate the needs of larger NPs to
   maintain full management of their network, and the third-party option
   could be available to smaller NPs who lack the necessary human
   resources to perform incident handling operations.  The first method
   enables the individual NPs to involve their network operations staff
   to authorize the continuance of a trace or other necessary response
   to a RID communication request through their network via a
   notification and alerting system.  The out-of-band logical solution
   for messaging may be permanent virtual circuits configured with a
   small amount of bandwidth dedicated to RID communications between
   NPs.

   The network used for the communication should consist of out-of-band
   or protected channels (direct communication links) or encrypted
   channels dedicated to the transport of RID messages.  The
   communication links would be direct connections between network peers
   who have agreed-upon use and abuse policies through the use of a
   consortium.  Consortiums might be linked through policy comparisons



<span class="grey">Moriarty                      Informational                    [Page 13]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   and additional agreements to form a larger web or iterative network
   of peers that correlates to the traffic paths available over the
   larger web of networks.  The maintenance of the individual links is
   the responsibility of the two network peers hosting the link.
   Contact information, IP addresses of RID systems, and other
   information must be coordinated between bilateral peers by a
   consortium and may use existing databases, such as the Routing
   Arbiter.  The security, configuration, and Confidence rating schemes
   of the RID messaging peers must be negotiated by peers and must meet
   certain overall requirements of the fully connected network
   (Internet, government, education, etc.) through the peering and/or a
   consortium-based agreement.

   RID messaging established with clients of an NP may be negotiated in
   a contract as part of a value-added service or through a service
   level agreement (SLA).  Further discussion is beyond the scope of
   this document and may be more appropriately handled in network
   peering or service level agreements.

   Procedures for incident handling need to be established and well
   known by anyone that may be involved in incident response.  The
   procedures should also contain contact information for internal
   escalation procedures, as well as for external assistance groups such
   as a CSIRT, CERT Coordination Center (CERT/CC), Global Information
   Assurance Certification (GIAC), and the FBI or other assisting
   government organization in the country of the investigation.

<span class="h3"><a class="selflink" name="section-4.1" href="#section-4.1">4.1</a>.  Inter-Network Provider RID Messaging</span>

   In order to implement a messaging mechanism between RID communication
   systems or IHSs, a standard protocol and format is required to ensure
   inter-operability between vendors.  The messages would have to meet
   several requirements in order to be meaningful as they traverse
   multiple networks.  RID provides the framework necessary for
   communication between networks involved in the incident handling,
   possible traceback, and mitigation of a security incident.  Several
   message types described in <a href="#section-4.3">Section 4.3</a> are necessary to facilitate
   the handling of a security incident.  The message types include the
   Report, IncidentQuery, TraceRequest, RequestAuthorization, Result,
   and the Investigation request message.  The Report message is used
   when an incident is to be filed on a RID system or associated
   database, where no further action is required.  An IncidentQuery
   message is used to request information on a particular incident.  A
   TraceRequest message is used when the source of the traffic may have
   been spoofed.  In that case, each network provider in the upstream
   path who receives a TraceRequest will issue a trace across the
   network to determine the upstream source of the traffic.  The
   RequestAuthorization and Result messages are used to communicate the



<span class="grey">Moriarty                      Informational                    [Page 14]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-15" id="page-15" href="#page-15" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   status and result of a TraceRequest or Investigation request.  The
   Investigation request message would only involve the RID
   communication systems along the path to the source of the traffic and
   not the use of network trace systems.  The Investigation request
   leverages the bilateral relationships or a consortium's
   interconnections to mitigate or stop problematic traffic close to the
   source.  Routes could determine the fastest path to a known source IP
   address in the case of an Investigation request.  A message sent
   between RID systems for a TraceRequest or an Investigation request to
   stop traffic at the source through a bordering network would require
   the information enumerated below:

   1. Enough information to enable the network administrators to make a
      decision about the importance of continuing the trace.

   2. The incident or IP packet information needed to carry out the
      trace or investigation.

   3. Contact information of the origin of the RID communication.  The
      contact information could be provided through the Autonomous
      System Number (ASN) [<a href="rfc1930.html" title="&quot;Guidelines for creation, selection, and registration of an Autonomous System (AS)&quot;">RFC1930</a>] or Network Information Center (NIC)
      handle information listed in the Registry for Internet Numbers or
      other Internet databases.

   4. Network path information to help prevent any routing loops through
      the network from perpetuating a trace.  If a RID system receives a
      TraceRequest containing its own information in the path, the trace
      must cease and the RID system should generate an alert to inform
      the network operations staff that a tracing loop exists.

   5. A unique identifier for a single attack.  This identifier should
      be used to correlate traces to multiple sources in a DDoS attack.

   Use of the communication network and the RID protocol must be for
   pre-approved, authorized purposes only.  It is the responsibility of
   each participating party to adhere to guidelines set forth in both a
   global use policy for this system and one established through the
   peering agreements for each bilateral peer or agreed-upon consortium
   guidelines.  The purpose of such policies is to avoid abuse of the
   system; the policies shall be developed by a consortium of
   participating entities.  The global policy may be dependent on the
   domain it operates under; for example, a government network or a
   commercial network such as the Internet would adhere to different
   guidelines to address the individual concerns.  Privacy issues must
   be considered in public networks such as the Internet.  Privacy
   issues are discussed in the Security Considerations section, along
   with other requirements that must be agreed upon by participating
   entities.



<span class="grey">Moriarty                      Informational                    [Page 15]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-16" id="page-16" href="#page-16" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   RID requests must be legitimate security-related incidents and not
   used for purposes such as sabotage or censorship.  An example of such
   abuse of the system would include a request to rate-limit legitimate
   traffic to prevent information from being shared between users on the
   Internet (restricting access to online versions of papers) or
   restricting access from a competitor's product in order to sabotage a
   business.

   The RID system should be configurable to either require user input or
   automatically continue traces.  This feature would enable a network
   manager to assess the available resources before continuing a trace.
   A trace initiated from a TraceRequest may cause adverse effects on a
   network.  If the Confidence rating is low, it may not be in the NP's
   best interest to continue the trace.  The Confidence ratings must
   adhere to the specifications for selecting the percentage used to
   avoid abuse of the system.  TraceRequests must be issued by
   authorized individuals from the initiating network, set forth in
   policy guidelines established through peering or SLA.

<span class="h3"><a class="selflink" name="section-4.2" href="#section-4.2">4.2</a>.  RID Network Topology</span>

   The most basic topology for communicating RID systems would be a
   direct connection or a bilateral relationship as illustrated below.

         ___________                                  __________
         |         |                                  |        |
         |  RID    |__________-------------___________|  RID   |
         |_________|          | NP Border |           |________|
                              -------------

                      Figure 1.  Direct Peer Topology

   Within the consortium model, several topologies might be agreed upon
   and used.  One would leverage bilateral network peering relationships
   of the members of the consortium.  The peers for RID would match that
   of routing peers, and the logical network borders would be used.
   This approach may be necessary for an iterative trace where the
   source is unknown.  The model would look like the above diagram;
   however, there may be an extensive number of interconnections of
   bilateral relationships formed.  Also within a consortium model, it
   may be useful to establish an integrated mesh of networks to pass RID
   messages.  This may be beneficial when the source address is known,
   and an interconnection may provide a faster route to reach the
   closest upstream peer to the source of the attack traffic.  An
   example is illustrated below.






<span class="grey">Moriarty                      Informational                    [Page 16]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-17" id="page-17" href="#page-17" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


     _______                     _______                     _______
     |     |                     |     |                     |     |
   __| RID |____-------------____| RID |____-------------____| RID |__
     |_____|    | NP Border |    |_____|    | NP Border |    |_____|
        |       -------------               -------------       |
        |_______________________________________________________|

    Direct connection to network that is not an immediate network peer

                       Figure 2.  Mesh Peer Topology

   By using a fully meshed model in a consortium, broadcasting RID
   requests would be possible, but not advisable.  By broadcasting a
   request, RID peers that may not have carried the attack traffic on
   their network would be asked to perform a trace for the potential of
   decreasing the time in which the true source was identified.  As a
   result, many networks would have utilized unnecessary resources for a
   TraceRequest that may have also been unnecessary.

<span class="h3"><a class="selflink" name="section-4.3" href="#section-4.3">4.3</a>.  Message Formats</span>

   <a href="#section-4.3.2">Section 4.3.2</a> describes the six RID message types, which are based on
   the IODEF model [<a href="rfc5070.html" title="&quot;The Incident Object Description Exchange Format&quot;">RFC5070</a>].  The messages are generated and received
   on RID communication systems on the NP's network.  The messages may
   originate from IODEF messages from intrusion detection servers,
   CSIRTs, analysts, etc.  A RID message uses the IODEF framework with
   the RID extension, which is encapsulated for transport [<a href="rfc6046.html" title="&quot;Transport of Real-Time Inter-Network Defense (RID) Messages,&quot;">RFC6046</a>].
   Each RID message type, along with an example, is described in the
   following sections.  The IODEF-RID schema is introduced in
   <a href="#section-4.3.3">Section 4.3.3</a> to support the RID message types in <a href="#section-4.3.2">Section 4.3.2</a>.

<span class="h4"><a class="selflink" name="section-4.3.1" href="#section-4.3.1">4.3.1</a>.  RID Data Types</span>

   RID is derived from the IODEF data model and inherits all of the data
   types defined in the IODEF model.  One data type is added by RID:
   BOOLEAN.

<span class="h5"><a class="selflink" name="section-4.3.1.1" href="#section-4.3.1.1">4.3.1.1</a>.  Boolean</span>

   A boolean value is represented by the BOOLEAN data type.

   The BOOLEAN data type is implemented as "xs:boolean" [<a href="#ref-XMLschema" title="&quot;XML Schema&quot;">XMLschema</a>] in
   the schema.








<span class="grey">Moriarty                      Informational                    [Page 17]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-18" id="page-18" href="#page-18" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


<span class="h4"><a class="selflink" name="section-4.3.2" href="#section-4.3.2">4.3.2</a>.  RID Messages and Transport</span>

   The six RID message types follow:

   1. TraceRequest.  This message is sent to the RID system next in the
      upstream trace.  It is used to initiate a TraceRequest or to
      continue a TraceRequest to an upstream network closer to the
      source address of the origin of the security incident.  The
      TraceRequest would trigger a traceback on the network to locate
      the source of the attack traffic.

   2. RequestAuthorization.  This message is sent to the initiating RID
      system from each of the upstream NPs' RID systems to provide
      information on the request status in the current network.

   3. Result.  This message is sent to the initiating RID system through
      the network of RID systems in the path of the trace as
      notification that the source of the attack was located.  The
      Result message is also used to provide the notification of actions
      taken for an Investigation request.

   4. Investigation.  This message type is used when the source of the
      traffic is believed not to be spoofed.  The purpose of the
      Investigation request message is to leverage the existing peer
      relationships in order to notify the network provider closest to
      the source of the valid traffic of a security-related incident for
      any necessary actions to be taken.

   5. Report.  This message is used to report a security incident, for
      which no action is requested.  This may be used for the purpose of
      correlating attack information by CSIRTs, statistics and trending
      information, etc.

   6. IncidentQuery.  This message is used to request information about
      an incident or incident type from a trusted RID system.  The
      response is provided through the Report message.

   When a system receives a RID message, it must be able to determine
   the type of message and parse it accordingly.  The message type is
   specified in the RIDPolicy class.  The RIDPolicy class may also be
   used by the transport protocol to facilitate the communication of
   security incident data to trace, investigate, query, or report
   information regarding security incidents.








<span class="grey">Moriarty                      Informational                    [Page 18]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-19" id="page-19" href="#page-19" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


<span class="h4"><a class="selflink" name="section-4.3.3" href="#section-4.3.3">4.3.3</a>.  IODEF-RID Schema</span>

   There are three classes included in the RID extension required to
   facilitate RID communications.  The RequestStatus class is used to
   indicate the approval status of a TraceRequest or Investigation
   request; the IncidentSource class is used to report whether or not a
   source was found and to identify the source host(s) or network(s);
   and the RIDPolicy class provides information on the agreed-upon
   policies and specifies the type of communication message being used.

   The RID schema acts as an envelope for the IODEF schema to facilitate
   RID communications.  The intent in maintaining a separate schema and
   not using the AdditionalData extension of IODEF is the flexibility of
   sending messages between RID hosts.  Since RID is a separate schema
   that includes the IODEF schema, the RID information acts as an
   envelope, and then the RIDPolicy class can be easily extracted for
   use by the transport protocol.  The security requirements of sending
   incident information across the network include the use of
   encryption.  The RIDPolicy information is not required to be
   encrypted, so separating out this data from the IODEF extension
   removes the need for decrypting and parsing the entire IODEF and RID
   document to determine how it should be handled at each RID host.

   The purpose of the RIDPolicy class is to specify the message type for
   the receiving host, facilitate the policy needs of RID, and provide
   routing information in the form of an IP address of the destination
   RID system.

   The policy information and guidelines are discussed in <a href="#section-6.6">Section 6.6</a>.
   The policy is defined between RID peers and within or between
   consortiums.  The RIDPolicy is meant to be a tool to facilitate the
   defined policies.  This MUST be used in accordance with policy set
   between clients, peers, consortiums, and/or regions.  Security,
   privacy, and confidentiality MUST be considered as specified in this
   document.
















<span class="grey">Moriarty                      Informational                    [Page 19]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-20" id="page-20" href="#page-20" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   The RID schema is defined as follows:

        +------------------+
        |        RID       |
        +------------------+
        | ANY              |
        |                  |&lt;&gt;---{0..1}----[ RIDPolicy      ]
        | ENUM restriction |
        | ENUM type        |&lt;&gt;---{0..1}----[ RequestStatus  ]
        | STRING meaning   |
        |                  |&lt;&gt;---{0..1}----[ IncidentSource ]
        +------------------+

                         Figure 3.  The RID Schema

   The aggregate classes that constitute the RID schema in the iodef-rid
   namespace are as follows:

   RIDPolicy

      Zero or One.  The RIDPolicy class is used by all message types to
      facilitate policy agreements between peers, consortiums, or
      federations, as well as to properly route messages.

   RequestStatus

      Zero or One.  The RequestStatus class is used only in
      RequestAuthorization messages to report back to the originating
      RID system if the trace will be continued by each RID system that
      received a TraceRequest in the path to the source of the traffic.

   IncidentSource

      Zero or One.  The IncidentSource class is used in the Result
      message only.  The IncidentSource provides the information on the
      identified source host or network of an attack trace or
      investigation.

   Each of the three listed classes may be the only class included in
   the RID class, hence the option for zero or one.  In some cases,
   RIDPolicy MAY be the only class in the RID definition when used by
   the transport protocol [<a href="rfc6046.html" title="&quot;Transport of Real-Time Inter-Network Defense (RID) Messages,&quot;">RFC6046</a>], as that information should be as
   small as possible and may not be encrypted.  The RequestStatus
   message MUST be able to stand alone without the need for an IODEF
   document to facilitate the communication, limiting the data
   transported to the required elements per [<a href="rfc6046.html" title="&quot;Transport of Real-Time Inter-Network Defense (RID) Messages,&quot;">RFC6046</a>].





<span class="grey">Moriarty                      Informational                    [Page 20]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-21" id="page-21" href="#page-21" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


<span class="h5"><a class="selflink" name="section-4.3.3.1" href="#section-4.3.3.1">4.3.3.1</a>.  RequestStatus Class</span>

   The RequestStatus class is an aggregate class in the RID class.

                    +--------------------------------+
                    | RequestStatus                  |
                    +--------------------------------+
                    |                                |
                    | ENUM restriction               |
                    | ENUM AuthorizationStatus       |
                    | ENUM Justification             |
                    | STRING ext-AuthorizationStatus |
                    | STRING ext-Justification       |
                    |                                |
                    +--------------------------------+

                    Figure 4.  The RequestStatus Class

   The RequestStatus class has five attributes:

   restriction

      OPTIONAL.  ENUM.  This attribute indicates the disclosure
      guidelines to which the sender expects the recipient to adhere.
      This guideline provides no real security since it is the choice of
      the recipient of the document to honor it.  This attribute follows
      the same guidelines as "restriction" used in IODEF.

   AuthorizationStatus

      REQUIRED.  ENUM.  The listed values are used to provide a response
      to the requesting CSIRT of the status of a TraceRequest in the
      current network.

      1. Approved.  The trace was approved and will begin in the
         current NP.

      2. Denied.  The trace was denied in the current NP.  The next
         closest NP can use this message to filter traffic from the
         upstream NP using the example packet to help mitigate the
         effects of the attack as close to the source as possible.  The
         RequestAuthorization message must be passed back to the
         originator and a Result message used from the closest NP to the
         source to indicate actions taken in the IODEF History class.







<span class="grey">Moriarty                      Informational                    [Page 21]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-22" id="page-22" href="#page-22" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


      3. Pending.  Awaiting approval; a timeout period has been reached,
         which resulted in this Pending status and RequestAuthorization
         message being generated.

      4. ext-value.  An escape value used to extend this attribute.  See
         IODEF <a href="rfc5070.html#section-5.1">[RFC5070], Section&nbsp;5.1</a>.

   Justification

      OPTIONAL.  ENUM.  Provides a reason for a Denied or Pending
      message.

      1. SystemResource.  A resource issue exists on the systems that
         would be involved in the request.

      2. Authentication.  The enveloped digital signature [<a href="rfc3275.html" title="&quot;(Extensible Markup Language) XML-Signature Syntax and Processing&quot;">RFC3275</a>]
         failed to validate.

      3. AuthenticationOrigin.  The detached digital signature for the
         original requestor on the IP packet failed to validate.

      4. Encryption.  Unable to decrypt the request.

      5. Other.  There were other reasons this request could not be
         processed.

      6. ext-value.  An escape value used to extend this attribute.  See
         IODEF <a href="rfc5070.html#section-5.1">[RFC5070], Section&nbsp;5.1</a>.

   AuthorizationStatus-ext

      OPTIONAL.  STRING.  A means by which to extend the
      AuthorizationStatus attribute.  See IODEF <a href="rfc5070.html#section-5.1">[RFC5070], Section&nbsp;5.1</a>.

   Justification-ext

      OPTIONAL.  STRING.  A means by which to extend the Justification
      attribute.  See IODEF <a href="rfc5070.html#section-5.1">[RFC5070], Section&nbsp;5.1</a>.













<span class="grey">Moriarty                      Informational                    [Page 22]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-23" id="page-23" href="#page-23" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


<span class="h5"><a class="selflink" name="section-4.3.3.2" href="#section-4.3.3.2">4.3.3.2</a>.  IncidentSource Class</span>

   The IncidentSource class is an aggregate class in the RID class.

       +-------------------+
       | IncidentSource    |
       +-------------------+
       |                   |
       | ENUM restriction  |
       |                   |&lt;&gt;-------------[ SourceFound    ]
       |                   |
       |                   |&lt;&gt;---{0..*}----[ Node           ]
       |                   |
       +-------------------+

                    Figure 5.  The IncidentSource Class

   The elements that constitute the IncidentSource class follow:

   SourceFound

      One.  BOOLEAN.  The Source class indicates if a source was
      identified.  If the source was identified, it is listed in the
      Node element of this class.

      True.  Source of incident was identified.
      False.  Source of incident was not identified.

   Node

      One.  The Node class is used to identify a host or network device,
      in this case to identify the system communicating RID messages.

      The base definition of this class is reused from the IODEF
      specification <a href="rfc5070.html#section-3.16">[RFC5070], Section&nbsp;3.16</a>.

   The IncidentSource class has one attribute:

   restriction

      OPTIONAL.  ENUM.  This attribute indicates the disclosure
      guidelines to which the sender expects the recipient to adhere.
      This guideline provides no real security since it is the choice of
      the recipient of the document to honor it.  This attribute follows
      the same guidelines as "restriction" used in IODEF.






<span class="grey">Moriarty                      Informational                    [Page 23]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-24" id="page-24" href="#page-24" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


<span class="h5"><a class="selflink" name="section-4.3.3.3" href="#section-4.3.3.3">4.3.3.3</a>.  RIDPolicy Class</span>

   The RIDPolicy class facilitates the delivery of RID messages and is
   also referenced for transport in the transport document [<a href="rfc6046.html" title="&quot;Transport of Real-Time Inter-Network Defense (RID) Messages,&quot;">RFC6046</a>].

       +------------------------+
       | RIDPolicy              |
       +------------------------+
       |                        |
       | ENUM restriction       |&lt;&gt;-------------[ Node         ]
       | ENUM MsgType           |
       | ENUM MsgDestination    |&lt;&gt;---{0..1}----[ IncidentID   ]
       | ENUM ext-MsgType       |
       | ENUM ext-MsgDestination|&lt;&gt;---{1..*}----[ PolicyRegion ]
       |                        |
       |                        |&lt;&gt;---{1..*}----[ TrafficType  ]
       |                        |
       +------------------------+

                      Figure 6.  The RIDPolicy Class

   The aggregate elements that constitute the RIDPolicy class are as
   follows:

   Node

      One.  The Node class is used to identify a host or network device,
      in this case to identify the system communicating RID messages.

      The base definition of this class is reused from the IODEF
      specification <a href="rfc5070.html#section-3.16">[RFC5070], Section&nbsp;3.16</a>.

   IncidentID

      Zero or one.  Global reference pointing back to the IncidentID
      defined in the IODEF data model.  The IncidentID includes the name
      of the CSIRT, an incident number, and an instance of that
      incident.  The instance number is appended with a dash separating
      the values and is used in cases for which it may be desirable to
      group incidents.  Examples of incidents that may be grouped would
      be botnets, DDoS attacks, multiple hops of compromised systems
      found during an investigation, etc.

   PolicyRegion

      One or many.  REQUIRED.  The values for the attribute "region" are
      used to determine what policy area may require consideration
      before a trace can be approved.  The PolicyRegion may include



<span class="grey">Moriarty                      Informational                    [Page 24]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-25" id="page-25" href="#page-25" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


      multiple selections from the attribute list in order to fit all
      possible policy considerations when crossing regions, consortiums,
      or networks.

   region

      One.  ENUM.

      1. ClientToNP.  An enterprise network initiated the request.

      2. NPToClient.  An NP passed a RID request to a client or an
         enterprise attached network to the NP based on the service
         level agreements.

      3. IntraConsortium.  A trace that should have no restrictions
         within the boundaries of a consortium with the agreed-upon use
         and abuse guidelines.

      4. PeerToPeer.  A trace that should have no restrictions between
         two peers but may require further evaluation before continuance
         beyond that point with the agreed-upon use and abuse
         guidelines.

      5. BetweenConsortiums.  A trace that should have no restrictions
         between consortiums that have established agreed-upon use and
         abuse guidelines.

      6. AcrossNationalBoundaries.  This selection must be set if the
         trace type is anything but a trace of attack traffic with
         malicious intent.  This must also be set if the traffic request
         is based upon regulations of a specific nation that would not
         apply to all nations.  This is different from the
         "BetweenConsortiums" setting since it may be possible to have
         multiple nations as members of the same consortium, and this
         option must be selected if the traffic is of a type that may
         have different restrictions in other nations.

      7. ext-value.  An escape value used to extend this attribute.  See
         IODEF <a href="rfc5070.html#section-5.1">[RFC5070], Section&nbsp;5.1</a>.












<span class="grey">Moriarty                      Informational                    [Page 25]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-26" id="page-26" href="#page-26" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   TrafficType

      One or many.  REQUIRED.  The values for the attribute "type" are
      meant to assist in determining if a trace is appropriate for the
      NP receiving the request to continue the trace.  Multiple values
      may be selected for this element; however, where possible, it
      should be restricted to one value that would most accurately
      describe the traffic type.

   type

      One.  ENUM.

      1. Attack.  This option should only be selected if the traffic is
         related to a network-based attack.  The type of attack MUST
         also be listed in more detail in the IODEF Method and Impact
         classes for further clarification to assist in determining if
         the trace can be continued ([<a href="rfc5070.html" title="&quot;The Incident Object Description Exchange Format&quot;">RFC5070</a>], Sections <a href="#section-3.9">3.9</a> and
         3.10.1).

      2. Network.  This option MUST only be selected when the trace is
         related to NP network traffic or routing issues.

      3. Content.  This category MUST be used only in the case in which
         the request is related to the content and regional restrictions
         on accessing that type of content exist.  This is not malicious
         traffic but may include determining what sources or
         destinations accessed certain materials available on the
         Internet, including, but not limited to, news, technology, or
         inappropriate content.

      4. OfficialBusiness.  This option MUST be used if the traffic
         being traced is requested or is affiliated with any government
         or other official business request.  This would be used during
         an investigation by government authorities or other government
         traces to track suspected criminal or other activities.

      5. Other.  If this option is selected, a description of the
         traffic type MUST be provided so that policy decisions can be
         made to continue or stop the trace.  The information should be
         provided in the IODEF message in the Expectation class or in
         the History class using a HistoryItem log.

      6. ext-value.  An escape value used to extend this attribute.  See
         IODEF <a href="rfc5070.html#section-5.1">[RFC5070], Section&nbsp;5.1</a>.






<span class="grey">Moriarty                      Informational                    [Page 26]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-27" id="page-27" href="#page-27" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   The RIDPolicy class has five attributes:

   restriction

      OPTIONAL.  ENUM.  This attribute indicates the disclosure
      guidelines to which the sender expects the recipient to adhere.
      This guideline provides no real security since it is the choice of
      the recipient of the document to honor it.  This attribute follows
      the same guidelines as "restriction" used in IODEF.

   MsgType

      REQUIRED.  ENUM.  The type of RID message sent.  The six types of
      messages are described in <a href="#section-4.3.2">Section 4.3.2</a> and can be noted as one of
      the six selections below.

      1. TraceRequest.  This message may be used to initiate a
         TraceRequest or to continue a TraceRequest to an upstream
         network closer to the source address of the origin of the
         security incident.

      2. RequestAuthorization.  This message is sent to the initiating
         RID system from each of the upstream RID systems to provide
         information on the request status in the current network.

      3. Result.  This message indicates that the source of the attack
         was located and the message is sent to the initiating RID
         system through the RID systems in the path of the trace.

      4. Investigation.  This message type is used when the source of
         the traffic is believed to be valid.  The purpose of the
         Investigation request is to leverage the existing peer or
         consortium relationships in order to notify the NP closest to
         the source of the valid traffic that some event occurred, which
         may be a security-related incident.

      5. Report.  This message is used to report a security incident,
         for which no action is requested in the IODEF Expectation
         class.  This may be used for the purpose of correlating attack
         information by CSIRTs, statistics and trending information,
         etc.

      6. IncidentQuery.  This message is used to request information
         from a trusted RID system about an incident or incident type.







<span class="grey">Moriarty                      Informational                    [Page 27]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-28" id="page-28" href="#page-28" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


      Additionally, there is an extension attribute to add new
      enumerated values:

      -  ext-value.  An escape value used to extend this attribute.  See
         IODEF <a href="rfc5070.html#section-5.1">[RFC5070], Section&nbsp;5.1</a>.

   MsgDestination

      REQUIRED.  ENUM.  The destination required at this level may
      either be the RID messaging system intended to receive the
      request, or, in the case of an Investigation request, the source
      of the incident.  In the case of an Investigation request, the RID
      system that can help stop or mitigate the traffic may not be
      known, and the message may have to traverse RID messaging systems
      by following the routing path to the RID system closest to the
      source of the attack traffic.  The Node element lists either the
      RID system or the IP address of the source, and the meaning of the
      value in the Node element is determined by the MsgDestination
      element.

      1. RIDSystem.  The address listed in the Node element of the
         RIDPolicy class is the next upstream RID system that will
         receive the RID message.

      2. SourceOfIncident.  The address listed in the Node element of
         the RIDPolicy class is the incident source.  The IP address is
         used to determine the path of RID systems that will be used to
         find the closest RID system to the source of an attack in which
         the IP address used by the source is believed to be valid and
         an Investigation request message is used.  This is not to be
         confused with the IncidentSource class, as the defined value
         here is from an initial trace or Investigation request, not the
         source used in a Result message.

      3. ext-value.  An escape value used to extend this attribute.  See
         IODEF <a href="rfc5070.html#section-5.1">[RFC5070], Section&nbsp;5.1</a>.

   MsgType-ext

      OPTIONAL.  STRING.  A means by which to extend the MsgType
      attribute.  See IODEF <a href="rfc5070.html#section-5.1">[RFC5070], Section&nbsp;5.1</a>.

   MsgDestination-ext

      OPTIONAL.  STRING.  A means by which to extend the MsgDestination
      attribute.  See IODEF <a href="rfc5070.html#section-5.1">[RFC5070], Section&nbsp;5.1</a>.





<span class="grey">Moriarty                      Informational                    [Page 28]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-29" id="page-29" href="#page-29" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


<span class="h4"><a class="selflink" name="section-4.3.4" href="#section-4.3.4">4.3.4</a>.  RID Namespace</span>

   The RID schema declares a namespace of "iodef-rid-1.0" and registers
   it per [<a href="#ref-XMLnames" title="&quot;Namespaces in XML 1.0 (Third Edition)&quot;">XMLnames</a>].  Each IODEF-RID document MUST use the "iodef-
   rid-1.0" namespace in the top-level element RID-Document.  It can be
   referenced as follows:

&lt;RID-Document
   version="1.00" lang="en-US"
   xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-1.0"
   xsi:schemaLocation=http://www.iana.org/assignments/xml-registry/
      schema/iodef-rid-1.0.xsd"&gt;

<span class="h3"><a class="selflink" name="section-4.4" href="#section-4.4">4.4</a>.  RID Messages</span>

   The IODEF model is followed as specified in [<a href="rfc5070.html" title="&quot;The Incident Object Description Exchange Format&quot;">RFC5070</a>] for each of the
   RID message types.  The RID schema is used in combination with IODEF
   documents to facilitate RID communications.  Each message type varies
   slightly in format and purpose; hence, the requirements vary and are
   specified for each.  All classes, elements, attributes, etc., that
   are defined in the IODEF-Document are valid in the context of a RID
   message; however, some listed as optional in IODEF are mandatory for
   RID as listed for each message type.  The IODEF model MUST be fully
   implemented to ensure proper parsing of all RID messages.

   Note: The implementation of the RID system may obtain some of the
   information needed to fill in the content required for each message
   type automatically from packet input to the system or default
   information such as that used in the EventData class.

<span class="h4"><a class="selflink" name="section-4.4.1" href="#section-4.4.1">4.4.1</a>.  TraceRequest</span>

   Description: This message or document is sent to the network
   management station next in the upstream trace once the upstream
   source of the traffic has been identified.

   The following information is required for TraceRequest messages and
   is provided through:

      RID Information:

         RIDPolicy
            RID message type, IncidentID, and destination
            policy information

      IODEF Information:

         Time Stamps (DetectTime, StartTime, EndTime, ReportTime).



<span class="grey">Moriarty                      Informational                    [Page 29]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-30" id="page-30" href="#page-30" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


         Incident Identifier (Incident class, IncidentID).
            Trace number - used for multiple traces of a single
            incident; must be noted.

         Confidence rating of security incident (Impact and Confidence
            class).

         System class is used to list both the Source and Destination
            Information used in the attack and must note if the traffic
            is spoofed, thus requiring an upstream TraceRequest in RID.

         Expectation class should be used to request any specific
            actions to be taken close to the source.

         Path information of nested RID systems, beginning with the
            request originator used in the trace using IODEF EventData
            with category set to "infrastructure".

         Event, Record, and RecordItem classes to include example
            packets and other information related to the incident.
            Note: Event information included here requires a second
            instance of EventData in addition to that used to convey NP
            path contact information.

      Standards for encryption and digital signatures [<a href="rfc3275.html" title="&quot;(Extensible Markup Language) XML-Signature Syntax and Processing&quot;">RFC3275</a>],
         [<a href="#ref-XMLsig" title="&quot;XML-Signature Syntax and Processing (Second Edition)&quot;">XMLsig</a>]:

         Digital signature from initiating RID system, passed to all
         systems in upstream trace using XML digital signature.

   A DDoS attack can have many sources, resulting in multiple traces to
   locate the sources of the attack.  It may be valid to continue
   multiple traces for a single attack.  The path information would
   enable the administrators to determine if the exact trace had already
   passed through a single network.  The Incident Identifier must also
   be used to identify multiple TraceRequests from a single incident.
   If a single TraceRequest results in divergent paths of TraceRequests,
   a separate instance number MUST be used under the same IncidentID.
   The IncidentID instance number of IODEF can be used to correlate
   related incident data that is part of a larger incident.

<span class="h4"><a class="selflink" name="section-4.4.2" href="#section-4.4.2">4.4.2</a>.  RequestAuthorization</span>

   Description: This message is sent to the initiating RID system from
   the next upstream NP's RID system to provide information on the
   request status in the current network.





<span class="grey">Moriarty                      Informational                    [Page 30]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-31" id="page-31" href="#page-31" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   The following information is required for RequestAuthorization
   messages and is provided through:

      RID Information:

         RIDPolicy
            RID message type, IncidentID, and destination
            policy information

         Status of TraceRequest
            RequestStatus class in RID schema

      Standards for encryption and digital signatures [<a href="rfc3275.html" title="&quot;(Extensible Markup Language) XML-Signature Syntax and Processing&quot;">RFC3275</a>],
         [<a href="#ref-XMLsig" title="&quot;XML-Signature Syntax and Processing (Second Edition)&quot;">XMLsig</a>]:

         Digital signature of responding NP for authenticity of Trace
         Status Message, from the NP creating this message using XML
         digital signature.

   A message is sent back to the initiating RID system of the trace as
   status notification.  This message verifies that the next RID system
   in the path has received the message from the previous system in the
   path.  This message also verifies that the trace is now continuing,
   has stopped, or is pending in the next upstream RID system.  The
   Pending status would be automatically generated after a 2-minute
   timeout without system-predefined or administrator action taken to
   approve or disapprove the trace continuance.  If a Request is denied,
   the originator and sending peer (if they are not the same) MUST both
   receive the message.  This enables the sending peer the option to
   take action to stop or mitigate the traffic as close to the source as
   possible.

<span class="h4"><a class="selflink" name="section-4.4.3" href="#section-4.4.3">4.4.3</a>.  Result</span>

   Description: This message indicates that the trace or investigation
   has been completed and provides the result.  The Result message
   includes information on whether or not a source was found and the
   source information through the IncidentSource class.  The Result
   information MUST go back to the originating RID system that began the
   investigation or trace.  An NP may use any number of incident
   handling data sources to ascertain the true source of an attack.  All
   of the possible information sources may or may not be readily tied
   into the RID communications system.








<span class="grey">Moriarty                      Informational                    [Page 31]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-32" id="page-32" href="#page-32" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   The following information is required for Result messages and will be
   provided through:

      RID Information:

         RIDPolicy
            RID message type, IncidentID, and destination
            policy information

         Incident Source
            The IncidentSource class of the RID schema is used to note
            if a source was identified and provide the source
            address(es).

      IODEF Information:

         Time Stamps (DetectTime, StartTime, EndTime, ReportTime).

         Incident Identifier (Incident class, IncidentID).
            Trace number - used for multiple traces of a single
            incident; must be noted.

         Confidence rating of security incident (Impact and Confidence
            class).

         System class is used to list both the Source and Destination
            Information used in the attack and must note if the traffic
            is spoofed, thus requiring an upstream TraceRequest in RID.

         History class "atype" attribute is used to note any actions
            taken.

         History class also notes any other background information
            including notes about the confidence level or rating of the
            result information.

         Path information of nested RID systems, beginning with the
            request originator used in the trace using IODEF EventData
            with category set to "infrastructure".  The last NP listed
            is the NP that located the source of the traffic (the NP
            sending the Result message).

         Event, Record, and RecordItem classes to include example
            packets and other information related to the incident
            (optional).
            Note: Event information included here requires a second
            instance of EventData in addition to that used to convey NP
            path contact information.



<span class="grey">Moriarty                      Informational                    [Page 32]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-33" id="page-33" href="#page-33" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


      Standards for encryption and digital signatures [<a href="rfc3275.html" title="&quot;(Extensible Markup Language) XML-Signature Syntax and Processing&quot;">RFC3275</a>]:

         Digital signature of source NP for authenticity of Result
         Message, from the NP creating this message using XML digital
         signature.

   A message is sent back to the initiating RID system to notify the
   associated CSIRT that the source has been located.  The actual source
   information may or may not be included, depending on the policy of
   the network in which the client or host is attached.  Any action
   taken by the NP to act upon the discovery of the source of a trace
   should be included.  The NP may be able to automate the adjustment of
   filters at their border router to block outbound access for the
   machine(s) discovered as a part of the attack.  The filters may be
   comprehensive enough to block all Internet access until the host has
   taken the appropriate action to resolve any security issues or to
   rate-limit the ingress traffic as close to the source as possible.

   Security and privacy considerations discussed in <a href="#section-6">Section 6</a> MUST be
   taken into account.

   Note: The History class has been expanded in IODEF to accommodate all
   of the possible actions taken as a result of a RID TraceRequest or
   Investigation request using the "iodef:atype", or action type,
   attribute.  The History class should be used to note all actions
   taken close to the source of a trace or incident using the most
   appropriate option for the type of action along with a description.
   The "atype" attribute in the Expectation class can also be used to
   request an appropriate action when a TraceRequest or Investigation
   request is made.

<span class="h4"><a class="selflink" name="section-4.4.4" href="#section-4.4.4">4.4.4</a>.  Investigation Request</span>

   Description: This message type is used when the source of the traffic
   is believed not to be spoofed.  The purpose of the Investigation
   request message is to leverage the existing bilateral peer
   relationships in order to notify the network provider closest to the
   source of the valid traffic that some event occurred, which may be a
   security-related incident.

   The following information is required for Investigation request
   messages and is provided through:

      RID Information:

         RID Policy
            RID message type, IncidentID, and destination
            policy information



<span class="grey">Moriarty                      Informational                    [Page 33]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-34" id="page-34" href="#page-34" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


      IODEF Information:

         Time Stamps (DetectTime, StartTime, EndTime, ReportTime).

         Incident Identifier (Incident class, IncidentID).
            Trace number - used for multiple traces of a single
            incident; must be noted.

         Confidence rating of security incident (Impact and Confidence
            class).

         System class is used to list both the Source and Destination
            Information used in the attack and must note if the traffic
            is spoofed, thus requiring an upstream TraceRequest in RID.

         Expectation class should be used to request any specific
            actions to be taken close to the source.

         Path information of nested RID systems, beginning with the
            request originator used in the trace using IODEF EventData
            with category set to "infrastructure".

         Event, Record, and RecordItem classes to include example
            packets and other information related to the incident.
            Note: Event information included here requires a second
            instance of EventData in addition to that used to convey NP
            path contact information.

      Standards for encryption and digital signatures [<a href="rfc3275.html" title="&quot;(Extensible Markup Language) XML-Signature Syntax and Processing&quot;">RFC3275</a>]:

         Digital signature from initiating RID system, passed to all
         systems in upstream trace using XML digital signature.

   Security considerations would include the ability to encrypt
   [<a href="#ref-XMLencrypt" title="&quot;XML Encryption Syntax and Processing&quot;">XMLencrypt</a>] the contents of the Investigation request message using
   the public key of the destination RID system.  The incident number
   would increase as if it were a TraceRequest message in order to
   ensure uniqueness within the system.  The relaying peers would also
   append their Autonomous System (AS) or RID system information as the
   request message was relayed along the web of network providers so
   that the Result message could utilize the same path as the set of
   trust relationships for the return message, thus indicating any
   actions taken.  The request would also be recorded in the state
   tables of both the initiating and destination NP RID systems.  The
   destination NP is responsible for any actions taken as a result of
   the request in adherence to any service level agreements or internal
   policies.  The NP should confirm that the traffic actually originated
   from the suspected system before taking any action and confirm the



<span class="grey">Moriarty                      Informational                    [Page 34]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-35" id="page-35" href="#page-35" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   reason for the request.  The request may be sent directly to a known
   RID system or routed by the source address of the attack using the
   message destination of RIDPolicy, SourceOfIncident.

   Note: All intermediate parties must be able to view RIDPolicy
   information in order to properly direct RID messages.

<span class="h4"><a class="selflink" name="section-4.4.5" href="#section-4.4.5">4.4.5</a>.  Report</span>

   Description: This message or document is sent to a RID system to
   provide a report of a security incident.  This message does not
   require any actions to be taken, except to file the report on the
   receiving RID system or associated database.

   The following information is required for Report messages and will be
   provided through:

      RID Information:

         RID Policy RID message type, IncidentID, and destination
            policy information

   The following data is recommended if available and can be provided
   through:

      IODEF Information:

         Time Stamps (DetectTime, StartTime, EndTime, ReportTime).

         Incident Identifier (Incident class, IncidentID).
            Trace number - used for multiple traces of a single
            incident; must be noted.

         Confidence rating of security incident (Impact and Confidence
            class).

         System class is used to list both the Source and Destination
            Information used in the attack.

         Event, Record, and RecordItem classes to include example
            packets and other information related to the incident
            (optional).

      Standards for encryption and digital signatures [<a href="rfc3275.html" title="&quot;(Extensible Markup Language) XML-Signature Syntax and Processing&quot;">RFC3275</a>]:

         Digital signature from initiating RID system, passed to all
         systems receiving the report using XML digital signature.




<span class="grey">Moriarty                      Informational                    [Page 35]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-36" id="page-36" href="#page-36" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   Security considerations would include the ability to encrypt
   [<a href="#ref-XMLencrypt" title="&quot;XML Encryption Syntax and Processing&quot;">XMLencrypt</a>] the contents of the Report message using the public key
   of the destination RID system.  Senders of a Report message should
   note that the information may be used to correlate security incident
   information for the purpose of trending, pattern detection, etc., and
   may be shared with other parties unless otherwise agreed upon with
   the receiving RID system.  Therefore, sending parties of a Report
   message may obfuscate or remove destination addresses or other
   sensitive information before sending a Report message.  A Report
   message may be sent either to file an incident report or in response
   to an IncidentQuery, and data sensitivity must be considered in both
   cases.  The NP path information is not necessary for this message, as
   it will be communicated directly between two trusted RID systems.

<span class="h4"><a class="selflink" name="section-4.4.6" href="#section-4.4.6">4.4.6</a>.  IncidentQuery</span>

   Description: The IncidentQuery message is used to request incident
   information from a trusted RID system.  The request can include the
   incident number, if known, or detailed information about the
   incident.  If the incident number is known, the Report message
   containing the incident information can easily be returned to the
   trusted requestor using automated methods.  If an example packet or
   other unique information is included in the IncidentQuery, the return
   report may be automated; otherwise, analyst intervention may be
   required.

   The following information must be used for an IncidentQuery message
   and is provided through:

      RID Information:

         RID Policy
            RID message type, IncidentID, and destination
            policy information

      IODEF Information (optional):

         Time Stamps (DetectTime, StartTime, EndTime, ReportTime).

         Incident Identifier (Incident class, IncidentID).
            Trace number - used for multiple traces of a single
            incident; must be noted.

         Confidence rating of security incident (Impact and Confidence
            class).

         System class is used to list both the Source and Destination
            Information used in the attack.



<span class="grey">Moriarty                      Informational                    [Page 36]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-37" id="page-37" href="#page-37" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


         Event, Record, and RecordItem classes to include example
            packets and other information related to the incident
            (optional).

      Standards for encryption and digital signatures [<a href="rfc3275.html" title="&quot;(Extensible Markup Language) XML-Signature Syntax and Processing&quot;">RFC3275</a>]:

         Digital signature from initiating RID system, passed to all
         systems receiving the IncidentQuery using XML digital
         signature.  If a packet is not included, the signature may be
         based on the RIDPolicy class.

   The proper response to the IncidentQuery message is a Report message.
   Multiple incidents may be returned for a single query if an incident
   type is requested.  In this case, the receiving system would send an
   IODEF document containing multiple incidents or all instances of an
   incident.  The system sending the reply may pre-set a limit to the
   number of documents returned in one report.  The recommended limit
   is 5, to prevent the documents from becoming too large.  Other
   transfer methods may be suited better than RID for large transfers of
   data.  The Confidence rating may be used in the IncidentQuery message
   to select only incidents with an equal or higher Confidence rating
   than what is specified.  This may be used for cases when information
   is gathered on a type of incident but not on specifics about a single
   incident.  Source and Destination Information may not be needed if
   the IncidentQuery is intended to gather data about a specific type of
   incident as well.

<span class="h3"><a class="selflink" name="section-4.5" href="#section-4.5">4.5</a>.  RID Communication Exchanges</span>

   The following section outlines the communication flows for RID and
   also provides examples of messages.  The proper response to a
   TraceRequest is a RequestAuthorization message.  The
   RequestAuthorization message lets the requestor know if the trace
   will continue through the next upstream network.  If there is a
   problem with the request, such as a failure to validate the digital
   signature or decrypt the request, a RequestAuthorization message MUST
   be sent to the requestor and the downstream peer (if they are not one
   and the same) providing the reason why the message could not be
   processed.  Assuming that the trace continued, additional
   TraceRequests with the response of a RequestAuthorization message
   would occur passing the request upstream in the path to the source of
   the traffic related to the incident.  Once a source is found, a
   Result message is sent to the originator of the trace, as determined
   by the NP path information provided through the document instance of
   EventData, where contact is set to "infrastructure".  The NP path
   information is also used when sending the RequestAuthorization
   messages to the first entry (the trace originator) and the last
   nested entry (the downstream peer).  The Result message is encrypted



<span class="grey">Moriarty                      Informational                    [Page 37]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-38" id="page-38" href="#page-38" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   [<a name="ref-XMLencrypt" id="ref-XMLencrypt">XMLencrypt</a>] for the originator providing information about the
   incident source and any actions taken.  If the originator fails to
   decrypt or authenticate the Result message, a RequestAuthorization
   message is sent in response; otherwise, no return message is sent.
   If a RequestAuthorization message is sent with the RequestStatus set
   to Denied, a downstream peer receiving this message may choose to
   take action to stop or mitigate the traffic at that point in the
   network, as close to the source as possible.  If the downstream peer
   chooses this option, it would send a Result message to the trace
   originator.

   Note: For each example listed below, [<a href="rfc5735.html" title="&quot;Special Use IPv4 Addresses&quot;">RFC5735</a>] addresses were used.
   Assume that each IP address listed is actually a separate network
   range held by different NPs.  Addresses were used from /27 network
   ranges.




































<span class="grey">Moriarty                      Informational                    [Page 38]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-39" id="page-39" href="#page-39" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


<span class="h4"><a class="selflink" name="section-4.5.1" href="#section-4.5.1">4.5.1</a>.  Upstream Trace Communication Flow</span>

   The diagram below outlines the RID TraceRequest communication flow
   between RID systems on different networks tracing an attack.

   Attack Dest      NP-1            NP-2        NP-3        Attack Src

   1. Attack    |  Attack
      reported  |  detected

   2.              Initiate trace

   3.              Locate origin
                   through
                   upstream NP

   4.              o---TraceRequest-----&gt;

   5.                              Trace
                                   Initiated

   6.              &lt;-RequestAuthorization-o

   7.                              Locate origin
                                   through
                                   upstream NP

   8.                              o---TraceRequest---&gt;

   9.                                             Trace Initiated

   10.             &lt;----------RequestAuthorization----o
                                    &lt;---RequestAuth---o

   11.                                            Locate attack
                                                  source on network   X

   12.             &lt;------------Result----------------o

                Figure 7.  TraceRequest Communication Flow

   Before a trace is initiated, the RID system should verify if an
   instance of the trace or a similar request is not active.  The traces
   may be resource intensive; therefore, providers need to be able to
   detect potential abuse of the system or unintentional resource
   drains.  Information such as the Source and Destination Information,
   associated packets, and the incident may be desirable to maintain for
   a period of time determined by administrators.



<span class="grey">Moriarty                      Informational                    [Page 39]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-40" id="page-40" href="#page-40" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   The communication flow demonstrates that a RequestAuthorization
   message is sent to both the downstream peer and the original
   requestor.  If a TraceRequest is denied, the downstream peer has the
   option to take an action and respond with a Result message.  The
   originator of the request may follow up with the downstream peer of
   the NP involved using an Investigation request to ensure that an
   action is taken if no response is received.  Nothing precludes the
   originator of the request from initiating a new TraceRequest
   bypassing the NP that denied the request, if a trace is needed beyond
   that point.  Another option may be for the initiator to send an
   Investigation request to an NP upstream of the NP that denied the
   request if enough information was gathered to discern the true source
   of the attack traffic from the incident handling information.

<span class="h5"><a class="selflink" name="section-4.5.1.1" href="#section-4.5.1.1">4.5.1.1</a>.  RID TraceRequest Example</span>

   The example listed is of a TraceRequest based on the incident report
   example from the IODEF document.  The RID extension classes were
   included as appropriate for a TraceRequest message using the
   RIDPolicy class.  The example given is that of a CSIRT reporting a
   DoS attack in progress to the upstream NP.  The request asks the next
   NP to continue the trace and have the traffic mitigated closer to the
   source of the traffic.

   In the following example, use of [<a href="#ref-XMLsig" title="&quot;XML-Signature Syntax and Processing (Second Edition)&quot;">XMLsig</a>] to generate digital
   signatures does not currently provide digest algorithm agility, as
   [<a href="#ref-XMLsig" title="&quot;XML-Signature Syntax and Processing (Second Edition)&quot;">XMLsig</a>] only supports SHA-1.  A future version of [<a href="#ref-XMLsig" title="&quot;XML-Signature Syntax and Processing (Second Edition)&quot;">XMLsig</a>] may
   support additional digest algorithms to support digest algorithm
   agility.

&lt;iodef-rid:RID xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-1.0"
               xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0"&gt;
  &lt;iodef-rid:RIDPolicy MsgType="TraceRequest"
                       MsgDestination="RIDSystem"&gt;
    &lt;iodef-rid:PolicyRegion region="IntraConsortium"/&gt;
    &lt;iodef:Node&gt;
      &lt;iodef:Address category="ipv4-addr"&gt;192.0.2.3&lt;/iodef:Address&gt;
    &lt;/iodef:Node&gt;
    &lt;iodef-rid:TrafficType type="Attack"/&gt;
    &lt;iodef:IncidentID name="CERT-FOR-OUR-DOMAIN"&gt;
      CERT-FOR-OUR-DOMAIN#207-1
    &lt;/iodef:IncidentID&gt;
  &lt;/iodef-rid:RIDPolicy&gt;
&lt;/iodef-rid:RID&gt;







<span class="grey">Moriarty                      Informational                    [Page 40]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-41" id="page-41" href="#page-41" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


&lt;!-- IODEF-Document accompanied by the above RID --&gt;

&lt;iodef:IODEF-Document version="1.00"
                      xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0"&gt;
  &lt;iodef:Incident restriction="need-to-know" purpose="traceback"&gt;
    &lt;iodef:IncidentID name="CERT-FOR-OUR-DOMAIN"&gt;
      CERT-FOR-OUR-DOMAIN#207-1
    &lt;/iodef:IncidentID&gt;
    &lt;iodef:DetectTime&gt;2004-02-02T22:49:24+00:00&lt;/iodef:DetectTime&gt;
    &lt;iodef:StartTime&gt;2004-02-02T22:19:24+00:00&lt;/iodef:StartTime&gt;
    &lt;iodef:ReportTime&gt;2004-02-02T23:20:24+00:00&lt;/iodef:ReportTime&gt;
    &lt;iodef:Description&gt;Host involved in DoS attack&lt;/iodef:Description&gt;
    &lt;iodef:Assessment&gt;
      &lt;iodef:Impact severity="low" completion="failed" type="dos"/&gt;
    &lt;/iodef:Assessment&gt;
    &lt;iodef:Contact role="creator" type="organization"&gt;
      &lt;iodef:ContactName&gt;Constituency-contact for 192.0.2.35
      &lt;/iodef:ContactName&gt;
      &lt;iodef:Email&gt;Constituency-contact@192.0.2.35&lt;/iodef:Email&gt;
    &lt;/iodef:Contact&gt;
    &lt;iodef:EventData&gt;
      &lt;iodef:Flow&gt;
        &lt;iodef:System category="source"&gt;
          &lt;iodef:Node&gt;
            &lt;iodef:Address category="ipv4-addr"&gt;192.0.2.35
            &lt;/iodef:Address&gt;
          &lt;/iodef:Node&gt;
          &lt;iodef:Service&gt;
            &lt;iodef:port&gt;38765&lt;/iodef:port&gt;
          &lt;/iodef:Service&gt;
        &lt;/iodef:System&gt;
        &lt;iodef:System category="target"&gt;
          &lt;iodef:Node&gt;
            &lt;iodef:Address category="ipv4-addr"&gt;192.0.2.67
            &lt;/iodef:Address&gt;
          &lt;/iodef:Node&gt;
          &lt;iodef:Service&gt;
            &lt;iodef:port&gt;80&lt;/iodef:port&gt;
          &lt;/iodef:Service&gt;
        &lt;/iodef:System&gt;
      &lt;/iodef:Flow&gt;
      &lt;iodef:Expectation severity="high" action="rate-limit-host"&gt;
        &lt;iodef:Description&gt;
          Rate-limit traffic close to source
        &lt;/iodef:Description&gt;
      &lt;/iodef:Expectation&gt;





<span class="grey">Moriarty                      Informational                    [Page 41]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-42" id="page-42" href="#page-42" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


      &lt;iodef:Record&gt;
        &lt;iodef:RecordData&gt;
          &lt;iodef:Description&gt;
            The IPv4 packet included was used in the described attack
          &lt;/iodef:Description&gt;
          &lt;iodef:RecordItem dtype="ipv4-packet"&gt;450000522ad9
             0000ff06c41fc0a801020a010102976d0050103e020810d9
             4a1350021000ad6700005468616e6b20796f7520666f7220
             6361726566756c6c792072656164696e6720746869732052
             46432e0a
          &lt;/iodef:RecordItem&gt;
        &lt;/iodef:RecordData&gt;
      &lt;/iodef:Record&gt;
    &lt;/iodef:EventData&gt;
    &lt;iodef:History&gt;
      &lt;iodef:HistoryItem&gt;
        &lt;iodef:DateTime&gt;2001-09-14T08:19:01+00:00&lt;/iodef:DateTime&gt;
        &lt;iodef:IncidentID name="CSIRT-FOR-OUR-DOMAIN"&gt;
          CSIRT-FOR-OUR-DOMAIN#207-1
        &lt;/iodef:IncidentID&gt;
        &lt;iodef:Description&gt;
          Notification sent to next upstream NP closer to 192.0.2.35
        &lt;/iodef:Description&gt;
      &lt;/iodef:HistoryItem&gt;
    &lt;/iodef:History&gt;
  &lt;/iodef:Incident&gt;
&lt;/iodef:IODEF-Document&gt;
























<span class="grey">Moriarty                      Informational                    [Page 42]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-43" id="page-43" href="#page-43" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


&lt;!-- Digital signature accompanied by above RID and IODEF --&gt;

&lt;Envelope xmlns="urn:envelope"
          xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0"
          xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-1.0"&gt;
  &lt;iodef:IODEF-Document&gt;
    &lt;iodef:Incident&gt;
      &lt;iodef:EventData&gt;
        &lt;iodef:Record&gt;
          &lt;iodef:RecordData&gt;
            &lt;iodef:RecordItem type="ipv4-packet"&gt;450000522ad9
             0000ff06c41fc0a801020a010102976d0050103e020810d9
             4a1350021000ad6700005468616e6b20796f7520666f7220
             6361726566756c6c792072656164696e6720746869732052
             46432e0a
            &lt;/iodef:RecordItem&gt;
          &lt;/iodef:RecordData&gt;
        &lt;/iodef:Record&gt;
      &lt;/iodef:EventData&gt;
    &lt;/iodef:Incident&gt;
  &lt;/iodef:IODEF-Document&gt;
  &lt;Signature xmlns="http://www.w3.org/2000/09/xmldsig#"&gt;
    &lt;SignedInfo&gt;
      &lt;CanonicalizationMethod
         Algorithm="http://www.w3.org/TR/2001/
          REC-xml-c14n-20010315#WithComments"/&gt;
      &lt;SignatureMethod
         Algorithm="http://www.w3.org/2000/09/xmldsig#dsa-sha1"/&gt;
      &lt;Reference URI=""&gt;
        &lt;Transforms&gt;
          &lt;Transform Algorithm=
           "<a href="http://www.w3.org/2000/09/xmldsig#enveloped-signature">http://www.w3.org/2000/09/xmldsig#enveloped-signature</a>"/&gt;
        &lt;/Transforms&gt;
        &lt;DigestMethod
           Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/&gt;
        &lt;DigestValue&gt;KiI5+6SnFAs429VNwsoJjHPplmo=&lt;/DigestValue&gt;
      &lt;/Reference&gt;
    &lt;/SignedInfo&gt;
    &lt;SignatureValue&gt;
      VvyXqCzjoW0m2NdxNeToXQcqcSM80W+JMW+Kn01cS3z3KQwCPeswzg==
    &lt;/SignatureValue&gt;










<span class="grey">Moriarty                      Informational                    [Page 43]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-44" id="page-44" href="#page-44" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


    &lt;KeyInfo&gt;
      &lt;KeyValue&gt;
        &lt;DSAKeyValue&gt;
          &lt;P&gt;/KaCzo4Syrom78z3EQ5SbbB4sF7ey80etKII864WF64B81uRpH5t9j
             QTxeEu0ImbzRMqzVDZkVG9xD7nN1kuFw==&lt;/P&gt;
          &lt;Q&gt;li7dzDacuo67Jg7mtqEm2TRuOMU=&lt;/Q&gt;
          &lt;G&gt;Z4Rxsnqc9E7pGknFFH2xqaryRPBaQ01khpMdLRQnG541Awtx/XPaF5
             Bpsy4pNWMOHCBiNU0NogpsQW5QvnlMpA==&lt;/G&gt;
          &lt;Y&gt;VFWTD4I/aKni4YhDyYxAJozmj1iAzPLw9Wwd5B+Z9J5E7lHjcAJ+bs
             HifTyYdnj+roGzy4o09YntYD8zneQ7lw==&lt;/Y&gt;
        &lt;/DSAKeyValue&gt;
      &lt;/KeyValue&gt;
    &lt;/KeyInfo&gt;
  &lt;/Signature&gt;
&lt;/Envelope&gt;

<span class="h5"><a class="selflink" name="section-4.5.1.2" href="#section-4.5.1.2">4.5.1.2</a>.  RequestAuthorization Message Example</span>

   The example RequestAuthorization message is in response to the
   TraceRequest message listed above.  The NP that received the request
   is responding to approve the trace continuance in their network.

&lt;iodef-rid:RID xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-1.0"
               xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0"&gt;
  &lt;iodef-rid:RIDPolicy MsgType="RequestAuthorization"
                       MsgDestination="RIDSystem"&gt;
    &lt;iodef-rid:PolicyRegion region="IntraConsortium"/&gt;
    &lt;iodef:Node&gt;
      &lt;iodef:Address category="ipv4-addr"&gt;192.0.2.67&lt;/iodef:Address&gt;
    &lt;/iodef:Node&gt;
    &lt;iodef-rid:TrafficType type="Attack"/&gt;
    &lt;iodef:IncidentID name="CERT-FOR-OUR-DOMAIN"&gt;
      CERT-FOR-OUR-DOMAIN#207-1
    &lt;/iodef:IncidentID&gt;
  &lt;/iodef-rid:RIDPolicy&gt;
  &lt;iodef-rid:RequestStatus AuthorizationStatus="Approved"/&gt;
&lt;/iodef-rid:RID&gt;

<span class="h5"><a class="selflink" name="section-4.5.1.3" href="#section-4.5.1.3">4.5.1.3</a>.  Result Message Example</span>

   The example Result message is in response to the TraceRequest listed
   above.  This message type only comes after a RequestAuthorization
   within the TraceRequest flow of messages.  It may be a direct
   response to an Investigation request.  This message provides
   information about the source of the attack and the actions taken to
   mitigate the traffic.





<span class="grey">Moriarty                      Informational                    [Page 44]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-45" id="page-45" href="#page-45" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


&lt;iodef-rid:RID xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-1.0"
               xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0"&gt;
  &lt;iodef-rid:RIDPolicy MsgType="Result"
                       MsgDestination="RIDSystem"&gt;
    &lt;iodef-rid:PolicyRegion region="IntraConsortium"/&gt;
    &lt;iodef:Node&gt;
      &lt;iodef:Address category="ipv4-addr"&gt;192.0.2.67&lt;/iodef:Address&gt;
    &lt;/iodef:Node&gt;
    &lt;iodef-rid:TrafficType type="Attack"/&gt;
    &lt;iodef:IncidentID name="CERT-FOR-OUR-DOMAIN"&gt;
      CERT-FOR-OUR-DOMAIN#207-1
    &lt;/iodef:IncidentID&gt;
  &lt;/iodef-rid:RIDPolicy&gt;
  &lt;iodef-rid:IncidentSource&gt;
    &lt;iodef-rid:SourceFound&gt;true&lt;/iodef-rid:SourceFound&gt;
    &lt;iodef:Node&gt;
      &lt;iodef:Address category="ipv4-addr"&gt;192.0.2.37&lt;/iodef:Address&gt;
    &lt;/iodef:Node&gt;
  &lt;/iodef-rid:IncidentSource&gt;
&lt;/iodef-rid:RID&gt;

&lt;!-- IODEF-Document accompanied by the above RID --&gt;

&lt;iodef:IODEF-Document version="1.00"
                      xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0"&gt;
  &lt;iodef:Incident restriction="need-to-know" purpose="traceback"&gt;
    &lt;iodef:IncidentID name="CERT-FOR-OUR-DOMAIN"&gt;
      CERT-FOR-OUR-DOMAIN#207-1
    &lt;/iodef:IncidentID&gt;
    &lt;iodef:DetectTime&gt;2004-02-02T22:49:24+00:00&lt;/iodef:DetectTime&gt;
    &lt;iodef:StartTime&gt;2004-02-02T22:19:24+00:00&lt;/iodef:StartTime&gt;
    &lt;iodef:ReportTime&gt;2004-02-02T23:20:24+00:00&lt;/iodef:ReportTime&gt;
    &lt;iodef:Description&gt;Host involved in DoS attack&lt;/iodef:Description&gt;
    &lt;iodef:Assessment&gt;
      &lt;iodef:Impact severity="low" completion="failed" type="dos"/&gt;
    &lt;/iodef:Assessment&gt;
    &lt;iodef:Contact role="creator" type="organization"&gt;
      &lt;iodef:ContactName&gt;Constituency-contact for 192.0.2.35
      &lt;/iodef:ContactName&gt;
      &lt;iodef:Email&gt;Constituency-contact@192.0.2.35&lt;/iodef:Email&gt;
    &lt;/iodef:Contact&gt;
    &lt;iodef:EventData&gt;
      &lt;iodef:Contact role="admin" type="organization"&gt;
        &lt;iodef:ContactName&gt;Admin-contact for 192.0.2.35
        &lt;/iodef:ContactName&gt;
        &lt;iodef:Email&gt;Admin-contact@10.1.1.2&lt;/iodef:Email&gt;
      &lt;/iodef:Contact&gt;




<span class="grey">Moriarty                      Informational                    [Page 45]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-46" id="page-46" href="#page-46" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


      &lt;iodef:Flow&gt;
        &lt;iodef:System category="intermediate"&gt;
          &lt;iodef:Node&gt;
            &lt;iodef:Address category="ipv4-addr"&gt;192.0.2.35
            &lt;/iodef:Address&gt;
          &lt;/iodef:Node&gt;
        &lt;/iodef:System&gt;
      &lt;/iodef:Flow&gt;
      &lt;iodef:EventData&gt;
        &lt;iodef:Contact role="admin" type="organization"&gt;
          &lt;iodef:ContactName&gt;Admin-contact for 192.0.2.3
          &lt;/iodef:ContactName&gt;
          &lt;iodef:Email&gt;Admin-contact@192.0.2.3&lt;/iodef:Email&gt;
        &lt;/iodef:Contact&gt;
        &lt;iodef:Flow&gt;
          &lt;iodef:System category="intermediate"&gt;
            &lt;iodef:Node&gt;
              &lt;iodef:Address category="ipv4-addr"&gt;192.0.2.3
              &lt;/iodef:Address&gt;
            &lt;/iodef:Node&gt;
          &lt;/iodef:System&gt;
        &lt;/iodef:Flow&gt;
      &lt;/iodef:EventData&gt;
    &lt;/iodef:EventData&gt;
    &lt;iodef:EventData&gt;
      &lt;iodef:Flow&gt;
        &lt;iodef:System category="source"&gt;
          &lt;iodef:Node&gt;
            &lt;iodef:Address category="ipv4-addr"&gt;192.0.2.35
            &lt;/iodef:Address&gt;
          &lt;/iodef:Node&gt;
          &lt;iodef:Service&gt;
            &lt;iodef:port&gt;38765&lt;/iodef:port&gt;
          &lt;/iodef:Service&gt;
        &lt;/iodef:System&gt;
        &lt;iodef:System category="target"&gt;
          &lt;iodef:Node&gt;
            &lt;iodef:Address category="ipv4-addr"&gt;192.0.2.67
            &lt;/iodef:Address&gt;
          &lt;/iodef:Node&gt;
          &lt;iodef:Service&gt;
            &lt;iodef:port&gt;80&lt;/iodef:port&gt;
          &lt;/iodef:Service&gt;
        &lt;/iodef:System&gt;
      &lt;/iodef:Flow&gt;






<span class="grey">Moriarty                      Informational                    [Page 46]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-47" id="page-47" href="#page-47" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


      &lt;iodef:Expectation severity="high" action="rate-limit-host"&gt;
        &lt;iodef:Description&gt;
          Rate-limit traffic close to source
        &lt;/iodef:Description&gt;
      &lt;/iodef:Expectation&gt;
      &lt;iodef:Record&gt;
        &lt;iodef:RecordData&gt;
          &lt;iodef:Description&gt;
            The IPv4 packet included was used in the described attack
          &lt;/iodef:Description&gt;
          &lt;iodef:RecordItem dtype="ipv4-packet"&gt;450000522ad9
          0000ff06c41fc0a801020a010102976d0050103e020810d9
          4a1350021000ad6700005468616e6b20796f7520666f7220
          6361726566756c6c792072656164696e6720746869732052
          46432e0a
          &lt;/iodef:RecordItem&gt;
        &lt;/iodef:RecordData&gt;
      &lt;/iodef:Record&gt;
    &lt;/iodef:EventData&gt;
    &lt;iodef:History&gt;
      &lt;iodef:HistoryItem&gt;
        &lt;iodef:DateTime&gt;2004-02-02T22:53:01+00:00&lt;/iodef:DateTime&gt;
        &lt;iodef:IncidentID name="CSIRT-FOR-OUR-DOMAIN"&gt;
          CSIRT-FOR-OUR-DOMAIN#207-1
        &lt;/iodef:IncidentID&gt;
        &lt;iodef:Description&gt;
          Notification sent to next upstream NP closer to 192.0.2.35
        &lt;/iodef:Description&gt;
      &lt;/iodef:HistoryItem&gt;
      &lt;iodef:HistoryItem action="rate-limit-host"&gt;
        &lt;iodef:DateTime&gt;2004-02-02T23:07:21+00:00&lt;/iodef:DateTime&gt;
        &lt;iodef:IncidentID name="CSIRT-FOR-NP3"&gt;
          CSIRT-FOR-NP3#3291-1
        &lt;/iodef:IncidentID&gt;
        &lt;iodef:Description&gt;
          Host rate-limited for 24 hours
        &lt;/iodef:Description&gt;
      &lt;/iodef:HistoryItem&gt;
    &lt;/iodef:History&gt;
  &lt;/iodef:Incident&gt;
&lt;/iodef:IODEF-Document&gt;

<span class="h4"><a class="selflink" name="section-4.5.2" href="#section-4.5.2">4.5.2</a>.  Investigation Request Communication Flow</span>

   The diagram below outlines the RID Investigation request
   communication flow between RID systems on different networks for a
   security incident with a known source address.  The proper response
   to an Investigation request is a Result message.  If there is a



<span class="grey">Moriarty                      Informational                    [Page 47]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-48" id="page-48" href="#page-48" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   problem with the request, such as a failure to validate the digital
   signature or decrypt the request, a RequestAuthorization message is
   sent to the requestor.  The RequestAuthorization message should
   provide the reason why the message could not be processed.

     Attack Dest      NP-1              NP-2        Attack Src

     1. Attack    |  Attack
        reported  |  detected

     2.              Determine source
                     of security incident

     3.              o---Investigation----&gt;

     4.                              Research
                                     incident and
                                     determine appropriate
                                     actions to take

     5.              &lt;-------Result-------o

                Figure 8.  Investigation Communication Flow

<span class="h5"><a class="selflink" name="section-4.5.2.1" href="#section-4.5.2.1">4.5.2.1</a>.  Investigation Request Example</span>

   The following example only includes the RID-specific details.  The
   IODEF and security measures are similar to the TraceRequest
   information, with the exception that the source is known and the
   receiving RID system is known to be close to the source.  The source
   known is indicated in the IODEF document, which allows for incident
   sources to be listed as spoofed, if appropriate.

&lt;iodef-rid:RID xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-1.0"
               xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0"&gt;
  &lt;iodef-rid:RIDPolicy MsgType="Investigation"
                       MsgDestination="SourceOfIncident"&gt;
    &lt;iodef-rid:PolicyRegion region="PeerToPeer"/&gt;
    &lt;iodef:Node&gt;
      &lt;iodef:Address category="ipv4-addr"&gt;192.0.2.98&lt;/iodef:Address&gt;
    &lt;/iodef:Node&gt;
    &lt;iodef-rid:TrafficType type="Attack"/&gt;
    &lt;iodef:IncidentID name="CERT-FOR-OUR-DOMAIN"&gt;
      CERT-FOR-OUR-DOMAIN#208-1
    &lt;/iodef:IncidentID&gt;
  &lt;/iodef-rid:RIDPolicy&gt;
&lt;/iodef-rid:RID&gt;




<span class="grey">Moriarty                      Informational                    [Page 48]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-49" id="page-49" href="#page-49" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


&lt;!-- IODEF-Document accompanied by the above RID --&gt;

&lt;iodef:IODEF-Document version="1.00"
                      xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0"&gt;
  &lt;iodef:Incident restriction="need-to-know" purpose="other"&gt;
    &lt;iodef:IncidentID name="CERT-FOR-OUR-DOMAIN"&gt;
      CERT-FOR-OUR-DOMAIN#208-1
    &lt;/iodef:IncidentID&gt;
    &lt;iodef:DetectTime&gt;2004-02-05T08:13:33+00:00&lt;/iodef:DetectTime&gt;
    &lt;iodef:StartTime&gt;2004-02-05T08:13:31+00:00&lt;/iodef:StartTime&gt;
    &lt;iodef:EndTime&gt;2004-02-05T08:13:33+00:00&lt;/iodef:EndTime&gt;
    &lt;iodef:ReportTime&gt;2004-02-05T08:13:35+00:00&lt;/iodef:ReportTime&gt;
    &lt;iodef:Description&gt;Host involved in DoS attack&lt;/iodef:Description&gt;
    &lt;iodef:Assessment&gt;
      &lt;iodef:Impact severity="low" completion="failed" type="recon"/&gt;
    &lt;/iodef:Assessment&gt;
    &lt;iodef:Contact role="creator" type="organization"&gt;
      &lt;iodef:ContactName&gt;Constituency-contact for 192.0.2.35
      &lt;/iodef:ContactName&gt;
      &lt;iodef:Email&gt;Constituency-contact@10.1.1.2&lt;/iodef:Email&gt;
    &lt;/iodef:Contact&gt;
    &lt;iodef:EventData&gt;
      &lt;iodef:Flow&gt;
        &lt;iodef:System category="source"&gt;
          &lt;iodef:Node&gt;
            &lt;iodef:Address category="ipv4-addr"&gt;192.0.2.35
            &lt;/iodef:Address&gt;
          &lt;/iodef:Node&gt;
          &lt;iodef:Service&gt;
            &lt;iodef:port&gt;41421&lt;/iodef:port&gt;
          &lt;/iodef:Service&gt;
        &lt;/iodef:System&gt;
        &lt;iodef:System category="target"&gt;
          &lt;iodef:Node&gt;
            &lt;iodef:Address category="ipv4-addr"&gt;192.0.2.67
            &lt;/iodef:Address&gt;
          &lt;/iodef:Node&gt;
          &lt;iodef:Service&gt;
            &lt;iodef:port&gt;80&lt;/iodef:port&gt;
          &lt;/iodef:Service&gt;
        &lt;/iodef:System&gt;
      &lt;/iodef:Flow&gt;
      &lt;iodef:Expectation severity="high" action="investigate"&gt;
        &lt;iodef:Description&gt;
          Investigate whether source has been compromised
        &lt;/iodef:Description&gt;
      &lt;/iodef:Expectation&gt;
    &lt;/iodef:EventData&gt;



<span class="grey">Moriarty                      Informational                    [Page 49]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-50" id="page-50" href="#page-50" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


    &lt;iodef:History&gt;
      &lt;iodef:HistoryItem&gt;
        &lt;iodef:DateTime&gt;2004-02-05T08:19:01+00:00&lt;/iodef:DateTime&gt;
        &lt;iodef:IncidentID name="CSIRT-FOR-OUR-DOMAIN"&gt;
          CSIRT-FOR-OUR-DOMAIN#208-1
        &lt;/iodef:IncidentID&gt;
        &lt;iodef:Description&gt;
          Investigation request sent to NP for 192.0.2.35
        &lt;/iodef:Description&gt;
      &lt;/iodef:HistoryItem&gt;
    &lt;/iodef:History&gt;
  &lt;/iodef:Incident&gt;
&lt;/iodef:IODEF-Document&gt;

<span class="h5"><a class="selflink" name="section-4.5.2.2" href="#section-4.5.2.2">4.5.2.2</a>.  RequestAuthorization Message Example</span>

   The example RequestAuthorization message is in response to the
   Investigation request listed above.  The NP that received the request
   was unable to validate the digital signature used to authenticate the
   sending RID system.

&lt;iodef-rid:RID xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-1.0"
               xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0"&gt;
  &lt;iodef-rid:RIDPolicy MsgType="RequestAuthorization"
                       MsgDestination="RIDSystem"&gt;
    &lt;iodef-rid:PolicyRegion region="IntraConsortium"/&gt;
    &lt;iodef:Node&gt;
      &lt;iodef:Address category="ipv4-addr"&gt;192.0.2.67&lt;/iodef:Address&gt;
    &lt;/iodef:Node&gt;
    &lt;iodef-rid:TrafficType type="Attack"/&gt;
    &lt;iodef:IncidentID name="CERT-FOR-OUR-DOMAIN"&gt;
      CERT-FOR-OUR-DOMAIN#208-1
    &lt;/iodef:IncidentID&gt;
  &lt;/iodef-rid:RIDPolicy&gt;
  &lt;iodef-rid:RequestStatus AuthorizationStatus="Denied"
                           Justification="Authentication"/&gt;
&lt;/iodef-rid:RID&gt;














<span class="grey">Moriarty                      Informational                    [Page 50]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-51" id="page-51" href="#page-51" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


<span class="h4"><a class="selflink" name="section-4.5.3" href="#section-4.5.3">4.5.3</a>.  Report Communication</span>

   The diagram below outlines the RID Report communication flow between
   RID systems on different networks.

        NP-1                           NP-2

     1. Generate incident information
        and prepare Report message

     2.              o-------Report-------&gt;

     3.                              File report in database

                   Figure 9.  Report Communication Flow

   The Report communication flow is used to provide information on
   specific incidents detected on the network.  Incident information may
   be shared between CSIRTs or participating RID hosts using this
   format.  When a report is received, the RID system must verify that
   the report has not already been filed.  The incident number and
   incident data, such as the hexadecimal packet and incident class
   information, can be used to compare with existing database entries.
   The Report message typically does not have a response.  If there is a
   problem with the Report message, such as a failure to validate the
   digital signature [<a href="rfc3275.html" title="&quot;(Extensible Markup Language) XML-Signature Syntax and Processing&quot;">RFC3275</a>] or decrypt the request, a
   RequestAuthorization message is sent to the requestor.  The
   RequestAuthorization message should provide the reason why the
   message could not be processed.

<span class="h5"><a class="selflink" name="section-4.5.3.1" href="#section-4.5.3.1">4.5.3.1</a>.  Report Example</span>

   The following example only includes the RID-specific details.  This
   report is an unsolicited Report message that includes an IPv4 packet.
   The IODEF document and digital signature would be similar to the
   TraceRequest information.















<span class="grey">Moriarty                      Informational                    [Page 51]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-52" id="page-52" href="#page-52" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


&lt;iodef-rid:RID xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-1.0"
               xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0"&gt;
  &lt;iodef-rid:RIDPolicy MsgType="Report" MsgDestination="RIDSystem"&gt;
    &lt;iodef-rid:PolicyRegion region="PeerToPeer"/&gt;
    &lt;iodef:Node&gt;
      &lt;iodef:Address category="ipv4-addr"&gt;192.0.2.130&lt;/iodef:Address&gt;
    &lt;/iodef:Node&gt;
    &lt;iodef-rid:TrafficType type="Attack"/&gt;
    &lt;iodef:IncidentID name="CERT-FOR-OUR-DOMAIN"&gt;
      CERT-FOR-OUR-DOMAIN#209-1
    &lt;/iodef:IncidentID&gt;
  &lt;/iodef-rid:RIDPolicy&gt;
&lt;/iodef-rid:RID&gt;

&lt;!-- IODEF-Document accompanied by the above RID --&gt;

&lt;iodef:IODEF-Document version="1.00"
                      xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0"&gt;
  &lt;iodef:Incident restriction="need-to-know" purpose="reporting"&gt;
    &lt;iodef:IncidentID name="CERT-FOR-OUR-DOMAIN"&gt;
      CERT-FOR-OUR-DOMAIN#209-1
    &lt;/iodef:IncidentID&gt;
    &lt;iodef:DetectTime&gt;2004-02-05T10:21:08+00:00&lt;/iodef:DetectTime&gt;
    &lt;iodef:StartTime&gt;2004-02-05T10:21:05+00:00&lt;/iodef:StartTime&gt;
    &lt;iodef:EndTime&gt;2004-02-05T10:35:00+00:00&lt;/iodef:EndTime&gt;
    &lt;iodef:ReportTime&gt;2004-02-05T10:27:38+00:00&lt;/iodef:ReportTime&gt;
    &lt;iodef:Description&gt;Host illicitly accessed admin account
    &lt;/iodef:Description&gt;
    &lt;iodef:Assessment&gt;
      &lt;iodef:Impact severity="high" completion="succeeded"
                    type="admin"/&gt;
      &lt;iodef:Confidence rating="high"/&gt;
    &lt;/iodef:Assessment&gt;
    &lt;iodef:Contact role="creator" type="organization"&gt;
      &lt;iodef:ContactName&gt;Constituency-contact for 192.0.2.35
      &lt;/iodef:ContactName&gt;
      &lt;iodef:Email&gt;Constituency-contact@10.1.1.2&lt;/iodef:Email&gt;
    &lt;/iodef:Contact&gt;
    &lt;iodef:EventData&gt;
      &lt;iodef:Flow&gt;
        &lt;iodef:System category="source"&gt;
          &lt;iodef:Node&gt;
            &lt;iodef:Address category="ipv4-addr"&gt;192.0.2.35
            &lt;/iodef:Address&gt;
          &lt;/iodef:Node&gt;






<span class="grey">Moriarty                      Informational                    [Page 52]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-53" id="page-53" href="#page-53" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


          &lt;iodef:Service&gt;
            &lt;iodef:port&gt;32821&lt;/iodef:port&gt;
          &lt;/iodef:Service&gt;
        &lt;/iodef:System&gt;
        &lt;iodef:System category="target"&gt;
          &lt;iodef:Node&gt;
            &lt;iodef:Address category="ipv4-addr"&gt;192.0.2.67
            &lt;/iodef:Address&gt;
          &lt;/iodef:Node&gt;
          &lt;iodef:Service&gt;
            &lt;iodef:port&gt;22&lt;/iodef:port&gt;
          &lt;/iodef:Service&gt;
        &lt;/iodef:System&gt;
      &lt;/iodef:Flow&gt;
    &lt;/iodef:EventData&gt;
    &lt;iodef:History&gt;
      &lt;iodef:HistoryItem&gt;
        &lt;iodef:DateTime&gt;2004-02-05T10:28:00+00:00&lt;/iodef:DateTime&gt;
        &lt;iodef:IncidentID name="CSIRT-FOR-OUR-DOMAIN"&gt;
          CSIRT-FOR-OUR-DOMAIN#209-1
        &lt;/iodef:IncidentID&gt;
        &lt;iodef:Description&gt;
          Incident report sent to NP for 192.0.2.35
        &lt;/iodef:Description&gt;
      &lt;/iodef:HistoryItem&gt;
    &lt;/iodef:History&gt;
  &lt;/iodef:Incident&gt;
&lt;/iodef:IODEF-Document&gt;























<span class="grey">Moriarty                      Informational                    [Page 53]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-54" id="page-54" href="#page-54" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


<span class="h4"><a class="selflink" name="section-4.5.4" href="#section-4.5.4">4.5.4</a>.  IncidentQuery Communication Flow</span>

   The diagram below outlines the RID IncidentQuery communication flow
   between RID systems on different networks.

        NP-1                           NP-2

     1. Generate a request for
        information on a specific
        incident number or incident type

     2.              o---IncidentQuery---&gt;

     3.                              Verify policy information
                                     and determine if matches exist
                                     for requested information

     4.              &lt;-------Report------o

     5.  Associate report to request
         by incident number or type
         and file report(s).

               Figure 10.  IncidentQuery Communication Flow

   The IncidentQuery message communication receives a response of a
   Report message.  If the Report message is empty, the responding host
   did not have information available to share with the requestor.  The
   incident number and responding RID system, as well as the transport,
   assist in the association of the request and response since a report
   can be filed and is not always solicited.  If there is a problem with
   the IncidentQuery message, such as a failure to validate the digital
   signature or decrypt the request, a RequestAuthorization message is
   sent to the requestor.  The RequestAuthorization message should
   provide the reason why the message could not be processed.

<span class="h5"><a class="selflink" name="section-4.5.4.1" href="#section-4.5.4.1">4.5.4.1</a>.  IncidentQuery Example</span>

   The IncidentQuery request may be received in several formats as a
   result of the type of query being performed.  If the incident number
   is the only information provided, the IODEF document and IP packet
   data may not be needed to complete the request.  However, if a type
   of incident is requested, the incident number remains NULL, and the








<span class="grey">Moriarty                      Informational                    [Page 54]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-55" id="page-55" href="#page-55" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   IP packet data will not be included in the IODEF RecordItem class;
   the other incident information is the main source for comparison.  In
   the case in which an incident number may not be the same between
   CSIRTs, the incident number and/or IP packet information can be
   provided and used for comparison on the receiving RID system to
   generate (a) Report message(s).

&lt;iodef-rid:RID xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-1.0"
               xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0"&gt;
  &lt;iodef-rid:RIDPolicy MsgType="IncidentQuery"
                       MsgDestination="RIDSystem"&gt;
    &lt;iodef-rid:PolicyRegion region="PeerToPeer"/&gt;
    &lt;iodef:Node&gt;
      &lt;iodef:Address category="ipv4-addr"&gt;192.0.2.3&lt;/iodef:Address&gt;
    &lt;/iodef:Node&gt;
    &lt;iodef-rid:TrafficType type="Attack"/&gt;
    &lt;iodef:IncidentID name="CERT-FOR-OUR-DOMAIN"&gt;
      CERT-FOR-OUR-DOMAIN#210-1
    &lt;/iodef:IncidentID&gt;
  &lt;/iodef-rid:RIDPolicy&gt;
&lt;/iodef-rid:RID&gt;

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  RID Schema Definition</span>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;xs:schema xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-1.0"
 xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0"
 xmlns:xs="http://www.w3.org/2001/XMLSchema"
 xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
 targetNamespace="urn:ietf:params:xml:ns:iodef-rid-1.0"
 elementFormDefault="qualified" attributeFormDefault="unqualified"&gt;
&lt;xs:import namespace="urn:ietf:params:xml:ns:iodef-1.0"
 schemaLocation="http://www.iana.org/assignments/xml-registry/
 schema/iodef-rid-1.0.xsd"/&gt;

&lt;xs:import namespace="http://www.w3.org/2000/09/xmldsig#"
 schemaLocation=
 "<a href="http://www.w3.org/TR/xmldsig-core/xmldsig-core-schema.xsd">http://www.w3.org/TR/xmldsig-core/xmldsig-core-schema.xsd</a>"/&gt;

&lt;!-- ****************************************************************
*********************************************************************
***  Real-time Inter-network Defense - RID XML Schema             ***
***    Namespace - iodef-rid, August 2006                         ***
***    The namespace is defined to support transport of IODEF     ***
***     documents for exchanging incident information.            ***
*********************************************************************
--&gt;




<span class="grey">Moriarty                      Informational                    [Page 55]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-56" id="page-56" href="#page-56" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


&lt;!--RID acts as an envelope for IODEF documents to support the exchange
    of messages--&gt;
&lt;!--
====== Real-Time Inter-network Defense - RID ======
====  Suggested definition for RID messaging ======
 --&gt;

&lt;xs:annotation&gt;
  &lt;xs:documentation&gt;XML Schema wrapper for IODEF&lt;/xs:documentation&gt;
&lt;/xs:annotation&gt;
&lt;xs:element name="RID" type="iodef-rid:RIDType"/&gt;
  &lt;xs:complexType name="RIDType"&gt;
    &lt;xs:sequence&gt;
      &lt;xs:element ref="iodef-rid:RIDPolicy" minOccurs="0"/&gt;
      &lt;xs:element ref="iodef-rid:RequestStatus" minOccurs="0"/&gt;
      &lt;xs:element ref="iodef-rid:IncidentSource" minOccurs="0"/&gt;
    &lt;/xs:sequence&gt;
  &lt;/xs:complexType&gt;

&lt;!--Used in RequestAuthorization Message for RID--&gt;

&lt;xs:element name="RequestStatus" type="iodef-rid:RequestStatusType"/&gt;
  &lt;xs:complexType name="RequestStatusType"&gt;
     &lt;xs:attribute name="AuthorizationStatus" use="required"&gt;
        &lt;xs:simpleType&gt;
          &lt;xs:restriction base="xs:NMTOKEN"&gt;
          &lt;xs:whiteSpace value="collapse"/&gt;
            &lt;xs:enumeration value="Approved"/&gt;
            &lt;xs:enumeration value="Denied"/&gt;
            &lt;xs:enumeration value="Pending"/&gt;
            &lt;xs:enumeration value="ext-value"/&gt;
          &lt;/xs:restriction&gt;
        &lt;/xs:simpleType&gt;
     &lt;/xs:attribute&gt;
     &lt;xs:attribute name="ext-AuthorizationStatus"
                   type="xs:string" use="optional"/&gt;















<span class="grey">Moriarty                      Informational                    [Page 56]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-57" id="page-57" href="#page-57" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


     &lt;xs:attribute name="Justification"&gt;
        &lt;xs:simpleType&gt;
          &lt;xs:restriction base="xs:NMTOKEN"&gt;
          &lt;xs:whiteSpace value="collapse"/&gt;
            &lt;xs:enumeration value="SystemResource"/&gt;
            &lt;xs:enumeration value="Authentication"/&gt;
            &lt;xs:enumeration value="AuthenticationOrigin"/&gt;
            &lt;xs:enumeration value="Encryption"/&gt;
            &lt;xs:enumeration value="Other"/&gt;
            &lt;xs:enumeration value="ext-value"/&gt;
          &lt;/xs:restriction&gt;
        &lt;/xs:simpleType&gt;
     &lt;/xs:attribute&gt;
     &lt;xs:attribute name="ext-Justification"
                   type="xs:string" use="optional"/&gt;
    &lt;xs:attribute name="restriction" type="iodef:restriction-type"/&gt;
  &lt;/xs:complexType&gt;

&lt;!--Incident Source Information for Result Message--&gt;

&lt;xs:element name="IncidentSource" type="iodef-rid:IncidentSourceType"/&gt;
  &lt;xs:complexType name="IncidentSourceType"&gt;
    &lt;xs:sequence&gt;
      &lt;xs:element ref="iodef-rid:SourceFound"/&gt;
      &lt;xs:element ref="iodef:Node" minOccurs="0"
          maxOccurs="unbounded"/&gt;
    &lt;/xs:sequence&gt;
    &lt;xs:attribute name="restriction" type="iodef:restriction-type"/&gt;
  &lt;/xs:complexType&gt;
  &lt;xs:element name="SourceFound" type="xs:boolean"/&gt;

&lt;!--
====== Real-Time Inter-network Defense Policy - RIDPolicy ======
======  Definition for RIDPolicy for messaging
 --&gt;

&lt;xs:annotation&gt;
 &lt;xs:documentation&gt;RID Policy used for transport of
     messages&lt;/xs:documentation&gt;
&lt;/xs:annotation&gt;











<span class="grey">Moriarty                      Informational                    [Page 57]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-58" id="page-58" href="#page-58" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


&lt;!-- RIDPolicy information with setting information listed in RID
     documentation --&gt;

&lt;xs:element name="RIDPolicy" type="iodef-rid:RIDPolicyType"/&gt;
  &lt;xs:complexType name="RIDPolicyType"&gt;
    &lt;xs:sequence&gt;
      &lt;xs:element ref="iodef-rid:PolicyRegion" maxOccurs="unbounded"/&gt;
      &lt;xs:element ref="iodef:Node"/&gt;
      &lt;xs:element ref="iodef-rid:TrafficType" maxOccurs="unbounded"/&gt;
      &lt;xs:element ref="iodef:IncidentID" minOccurs="0"/&gt;
    &lt;/xs:sequence&gt;
   &lt;xs:attribute name="MsgType" use="required"&gt;
    &lt;xs:simpleType&gt;
      &lt;xs:restriction base="xs:NMTOKEN"&gt;
      &lt;xs:whiteSpace value="collapse"/&gt;
        &lt;xs:enumeration value="TraceRequest"/&gt;
        &lt;xs:enumeration value="RequestAuthorization"/&gt;
        &lt;xs:enumeration value="Result"/&gt;
        &lt;xs:enumeration value="Investigation"/&gt;
        &lt;xs:enumeration value="Report"/&gt;
        &lt;xs:enumeration value="IncidentQuery"/&gt;
        &lt;xs:enumeration value="ext-value"/&gt;
      &lt;/xs:restriction&gt;
    &lt;/xs:simpleType&gt;
   &lt;/xs:attribute&gt;
  &lt;xs:attribute name="ext-MsgType" type="xs:string" use="optional"/&gt;
  &lt;xs:attribute name="MsgDestination" use="required"&gt;
    &lt;xs:simpleType&gt;
      &lt;xs:restriction base="xs:NMTOKEN"&gt;
      &lt;xs:whiteSpace value="collapse"/&gt;
        &lt;xs:enumeration value="RIDSystem"/&gt;
        &lt;xs:enumeration value="SourceOfIncident"/&gt;
        &lt;xs:enumeration value="ext-value"/&gt;
      &lt;/xs:restriction&gt;
    &lt;/xs:simpleType&gt;
   &lt;/xs:attribute&gt;
  &lt;xs:attribute name="ext-MsgDestination" type="xs:string"
                use="optional"/&gt;
   &lt;/xs:complexType&gt;












<span class="grey">Moriarty                      Informational                    [Page 58]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-59" id="page-59" href="#page-59" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


  &lt;xs:element name="PolicyRegion"&gt;
    &lt;xs:complexType&gt;
     &lt;xs:attribute name="region" use="required"&gt;
      &lt;xs:simpleType&gt;
       &lt;xs:restriction base="xs:NMTOKEN"&gt;
       &lt;xs:whiteSpace value="collapse"/&gt;
         &lt;xs:enumeration value="ClientToNP"/&gt;
         &lt;xs:enumeration value="NPToClient"/&gt;
         &lt;xs:enumeration value="IntraConsortium"/&gt;
         &lt;xs:enumeration value="PeerToPeer"/&gt;
         &lt;xs:enumeration value="BetweenConsortiums"/&gt;
         &lt;xs:enumeration value="AcrossNationalBoundaries"/&gt;
         &lt;xs:enumeration value="ext-value"/&gt;
       &lt;/xs:restriction&gt;
      &lt;/xs:simpleType&gt;
     &lt;/xs:attribute&gt;
     &lt;xs:attribute name="ext-region"
                   type="xs:string" use="optional"/&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;
  &lt;xs:element name="TrafficType" default="Attack"&gt;
    &lt;xs:complexType&gt;
     &lt;xs:attribute name="type" use="required"&gt;
      &lt;xs:simpleType&gt;
       &lt;xs:restriction base="xs:NMTOKEN"&gt;
       &lt;xs:whiteSpace value="collapse"/&gt;
         &lt;xs:enumeration value="Attack"/&gt;
         &lt;xs:enumeration value="Network"/&gt;
         &lt;xs:enumeration value="Content"/&gt;
         &lt;xs:enumeration value="OfficialBusiness"/&gt;
         &lt;xs:enumeration value="Other"/&gt;
         &lt;xs:enumeration value="ext-value"/&gt;
       &lt;/xs:restriction&gt;
      &lt;/xs:simpleType&gt;
     &lt;/xs:attribute&gt;
     &lt;xs:attribute name="ext-type"
                   type="xs:string" use="optional"/&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;
&lt;/xs:schema&gt;











<span class="grey">Moriarty                      Informational                    [Page 59]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-60" id="page-60" href="#page-60" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Security Considerations</span>

   Communication between NPs' RID systems must be protected.  RID has
   many security considerations built into the design of the protocol,
   several of which are described in the following sub-sections.  For a
   complete view of security, considerations need to include the
   availability, confidentiality, and integrity concerns for the
   transport, storage, and exchange of information.

   When considering the transport of RID messages, an out-of-band
   network, either logical or physical, would prevent outside attacks
   against RID communication.  An out-of-band connection would be ideal,
   but not necessarily practical.  Authenticated encrypted tunnels
   between RID systems MUST be used to provide confidentiality,
   integrity, authenticity, and privacy for the data.  Trust
   relationships are based on consortiums and established trust
   relationships of public key infrastructure (PKI) cross-certifications
   of consortiums.  By using RIDPolicy information, TLS, and the XML
   security features of encryption [<a href="#ref-XMLencrypt" title="&quot;XML Encryption Syntax and Processing&quot;">XMLencrypt</a>] and digital signatures
   [<a href="rfc3275.html" title="&quot;(Extensible Markup Language) XML-Signature Syntax and Processing&quot;">RFC3275</a>], [<a href="#ref-XMLsig" title="&quot;XML-Signature Syntax and Processing (Second Edition)&quot;">XMLsig</a>], RID takes advantage of existing security
   standards.  The standards provide clear methods to ensure that
   messages are secure, authenticated, and authorized, and that the
   messages meet policy and privacy guidelines and maintain integrity.

   As specified in the relevant sections of this document, the XML
   digital signature [<a href="rfc3275.html" title="&quot;(Extensible Markup Language) XML-Signature Syntax and Processing&quot;">RFC3275</a>] and XML encryption [<a href="#ref-XMLencrypt" title="&quot;XML Encryption Syntax and Processing&quot;">XMLencrypt</a>] are used
   in the following cases:

   XML Digital Signature

   o  The originator of the TraceRequest or Investigation request MUST
      use a detached signature to sign at least one of the original IP
      packets included in the RecordItem class data to provide
      authentication to all upstream participants in the trace of the
      origin.  All IP packets provided by the originator may be signed,
      and additional packets added by upstream peers in the trace may be
      signed by the peer adding the data, while maintaining the IP
      packet and detached signature from the original requestor.  This
      signature MUST be passed to all recipients of the TraceRequest.

   o  For all message types, the full IODEF/RID document MUST be signed
      using an enveloped signature by the sending peer to provide
      authentication and integrity to the receiving RID system.








<span class="grey">Moriarty                      Informational                    [Page 60]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-61" id="page-61" href="#page-61" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   XML Encryption

   o  The IODEF/RID document may be encrypted to provide an extra layer
      of security between peers so that the message is not only
      encrypted for the transport, but also while stored.  This behavior
      would be agreed upon between peers or a consortium, or determined
      on a per-message basis, depending on security requirements.  It
      should be noted that there are cases for transport where the
      RIDPolicy class needs to be presented in clear text, as detailed
      in the transport document [<a href="rfc6046.html" title="&quot;Transport of Real-Time Inter-Network Defense (RID) Messages,&quot;">RFC6046</a>].

   o  An Investigation request, or any other message type that may be
      relayed through RID systems other than the intended destination as
      a result of trust relationships, may be encrypted for the intended
      recipient.  This may be necessary if the RID network is being used
      for message transfer, the intermediate parties do not need to have
      knowledge of the request contents, and a direct communication path
      does not exist.  In that case, the RIDPolicy class is used by
      intermediate parties and is maintained in clear text.

   o  The action taken in the Result message may be encrypted using the
      key of the request originator.  In that case, the intermediate
      parties can view the RIDPolicy information and know the trace has
      been completed and do not need to see the action.  If the use of
      encryption were limited to sections of the message, the History
      class information would be encrypted.  Otherwise, it is
      RECOMMENDED to encrypt the entire IODEF/RID document, using an
      enveloped signature, for the originator of the request.  The
      existence of the Result message for an incident would tell any
      intermediate parties used in the path of the incident
      investigation that the incident handling has been completed.

   The formation of policies is a very important aspect of using a
   messaging system like RID to exchange potentially sensitive
   information.  Many considerations should be involved for peering
   parties, and some guidelines to protect the data, systems, and
   transport are covered in this section.  Policies established should
   provide guidelines for communication methods, security, and fall-back
   procedures.

   The security considerations for the storage and exchange of
   information in RID messaging may include adherence to local,
   regional, or national regulations in addition to the obligations to
   protect client information during an investigation.  RID Policy is a
   necessary tool for listing the requirements of messages to provide a
   method to categorize data elements for proper handling.  Controls are
   also provided for the sending entity to protect messages from third
   parties through XML encryption.



<span class="grey">Moriarty                      Informational                    [Page 61]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-62" id="page-62" href="#page-62" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   RID provides a method to exchange incident handling request and
   Report messages to peer networks.  Network administrators, who have
   the ability to base the decision on the available resources and other
   factors of their network, maintain control of incident investigations
   within their own network.  Thus, RID provides the ability for
   participating networks to manage their own security controls,
   leveraging the information listed in RIDPolicy.

<span class="h3"><a class="selflink" name="section-6.1" href="#section-6.1">6.1</a>.  Message Transport</span>

   The transport specifications are fully defined in a separate document
   [<a href="rfc6046.html" title="&quot;Transport of Real-Time Inter-Network Defense (RID) Messages,&quot;">RFC6046</a>].  The specified transport protocols MUST use encryption to
   provide an additional level of security and integrity, while
   supporting mutual authentication through bi-directional certificate
   usage.  Any subsequent transport method defined should take advantage
   of existing standards for ease of implementation and integration of
   RID systems.  Session encryption for the transport of RID messages is
   enforced in the transport specification.  The privacy and security
   considerations are addressed fully in RID to protect sensitive
   portions of documents and provide a method to authenticate the
   messages.  Therefore, RID messages do not rely on the security
   provided by the transport layer alone.  The encryption requirements
   and considerations for RID are discussed at the beginning of
   <a href="#section-6">Section 6</a> of this document.

   XML security functions such as the digital signature [<a href="rfc3275.html" title="&quot;(Extensible Markup Language) XML-Signature Syntax and Processing&quot;">RFC3275</a>] and
   encryption [<a href="#ref-XMLencrypt" title="&quot;XML Encryption Syntax and Processing&quot;">XMLencrypt</a>] provide a standards-based method to encrypt
   and digitally sign RID messages.  RID messages specify system use and
   privacy guidelines through the RIDPolicy class.  A public key
   infrastructure (PKI) provides the base for authentication and
   authorization, encryption, and digital signatures to establish trust
   relationships between members of a RID consortium or a peering
   consortium.

   XML security functions such as the digital signature [<a href="rfc3275.html" title="&quot;(Extensible Markup Language) XML-Signature Syntax and Processing&quot;">RFC3275</a>] and
   encryption [<a href="#ref-XMLencrypt" title="&quot;XML Encryption Syntax and Processing&quot;">XMLencrypt</a>] can be used within the contents of the
   message for privacy and security in cases for which certain elements
   must remain encrypted or signed as they traverse the path of a trace.
   For example, the digital signature on a TraceRequest can be used to
   verify the identity of the trace originator.  The use of the XML
   security features in RID messaging is in accordance with the
   specifications for the IODEF model; however, the use requirements may
   differ since RID also incorporates communication of security incident
   information.







<span class="grey">Moriarty                      Informational                    [Page 62]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-63" id="page-63" href="#page-63" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


<span class="h3"><a class="selflink" name="section-6.2" href="#section-6.2">6.2</a>.  Message Delivery Protocol - Integrity and Authentication</span>

   The RID protocol must be able to guarantee delivery and meet the
   necessary security requirements of a state-of-the-art protocol.  In
   order to guarantee delivery, TCP should be considered as the
   underlying protocol within the current network standard practices.

   Security considerations must include the integrity, authentication,
   privacy, and authorization of the messages sent between RID
   communication systems or IHSs.  The communication between RID systems
   must be authenticated and encrypted to ensure the integrity of the
   messages and the RID systems involved in the trace.  Another concern
   that needs to be addressed is authentication for a request that
   traverses multiple networks.  In this scenario, systems in the path
   of the multi-hop TraceRequest need to authorize a trace from not only
   their neighbor network, but also from the initiating RID system as
   discussed in <a href="#section-6.4">Section 6.4</a>.  Several methods can be used to ensure
   integrity and privacy of the communication.

   The transport mechanism selected MUST follow the defined transport
   protocol [<a href="rfc6046.html" title="&quot;Transport of Real-Time Inter-Network Defense (RID) Messages,&quot;">RFC6046</a>] when using RID messaging to ensure consistency
   among the peers.  Consortiums may vary their selected transport
   mechanisms and thus must decide upon a mutual protocol to use for
   transport when communicating with peers in a neighboring consortium
   using RID.  RID systems MUST implement and deploy HTTPS as defined in
   the transport document [<a href="rfc6046.html" title="&quot;Transport of Real-Time Inter-Network Defense (RID) Messages,&quot;">RFC6046</a>] and optionally support other
   protocols such as the Blocks Extensible Exchange Protocol (BEEP).
   RID, the XML security functions, and transport protocols must
   properly integrate with a public key infrastructure (PKI) managed by
   the consortium or one managed by a trusted entity.  For the Internet,
   an example of an existing effort that could be leveraged to provide
   the supporting PKI could be the American Registry for Internet
   Numbers (ARIN) and the Regional Internet Registry's (RIR's) PKI
   hierarchy.  Security and privacy considerations related to
   consortiums are discussed in Sections <a href="#section-6.5">6.5</a> and <a href="#section-6.6">6.6</a>.

<span class="h3"><a class="selflink" name="section-6.3" href="#section-6.3">6.3</a>.  Transport Communication</span>

   Out-of-band communications dedicated to NP interaction for RID
   messaging would provide additional security as well as guaranteed
   bandwidth during a denial-of-service attack.  For example, an out-of-
   band channel may consist of logical paths defined over the existing
   network.  Out-of-band communications may not be possible between all
   network providers, but should be considered to protect the network
   management systems used for RID messaging.  Methods to protect the
   data transport may also be provided through session encryption.





<span class="grey">Moriarty                      Informational                    [Page 63]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-64" id="page-64" href="#page-64" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   In order to address the integrity and authenticity of messages,
   transport encryption MUST be used to secure the traffic sent between
   RID systems.  Systems with predefined relationships for RID would
   include those who peer within a consortium with agreed-upon
   appropriate use regulations and for peering consortiums.  Trust
   relationships may also be defined through a bridged or hierarchical
   PKI in which both peers belong.

   Systems used to send authenticated RID messages between networks MUST
   use a secured system and interface to connect to a border network's
   RID systems.  Each connection to a RID system MUST meet the security
   requirements agreed upon through the consortium regulations, peering,
   or SLAs.  The RID system MUST only listen for and send RID messages
   on the designated port, which also MUST be over an encrypted tunnel
   meeting the minimum requirement of algorithms and key lengths
   established by the consortium, peering, or SLA.  The selected
   cryptographic algorithms for symmetric encryption, digital
   signatures, and hash functions MUST meet minimum security levels of
   the times.  The encryption strength MUST adhere to import and export
   regulations of the involved countries for data exchange.

<span class="h3"><a class="selflink" name="section-6.4" href="#section-6.4">6.4</a>.  Authentication of RID Protocol</span>

   In order to ensure the authenticity of the RID messages, a message
   authentication scheme is used to secure the protocol.  XML security
   functions utilized in RID require a trust center such as a PKI for
   the distribution of credentials to provide the necessary level of
   security for this protocol.  Layered transport protocols also utilize
   encryption and rely on a trust center.  Public key certificate pairs
   issued by a trusted Certification Authority (CA) MAY be used to
   provide the necessary level of authentication and encryption for the
   RID protocol.  The CA used for RID messaging must be trusted by all
   involved parties and may take advantage of similar efforts, such as
   the Internet2 federated PKI or the ARIN/RIR effort to provide a PKI
   to network providers.  The PKI used for authentication would also
   provide the necessary certificates needed for encryption used for the
   RID transport protocol [<a href="rfc6046.html" title="&quot;Transport of Real-Time Inter-Network Defense (RID) Messages,&quot;">RFC6046</a>].

   The use of pre-shared keys may be considered for authentication.  If
   this option is selected, the specifications set forth in "Pre-Shared
   Key Ciphersuites for Transport Layer Security (TLS)" [<a href="rfc4279.html" title="&quot;Pre-Shared Key Ciphersuites for Transport Layer Security (TLS)&quot;">RFC4279</a>] MUST
   be followed.

   Hosts receiving a RID message MUST be able to verify that the sender
   of the request is valid and trusted.  Using digital signatures on a
   hash of the RID message with an X.509 version 3 certificate issued by
   a trusted party MUST be used to authenticate the request.  The X.509
   version 3 specifications as well as the digital signature



<span class="grey">Moriarty                      Informational                    [Page 64]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-65" id="page-65" href="#page-65" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   specifications and path validation standards set forth in [<a href="rfc5280.html" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC5280</a>]
   MUST be followed in order to interoperate with a PKI designed for
   similar purposes.  The IODEF specification MUST be followed for
   digital signatures to provide the authentication and integrity
   aspects required for secure messaging between network providers.  The
   use of digital signatures in RID XML messages MUST follow the World
   Wide Web Consortium (W3C) recommendations for signature syntax and
   processing when either the XML encryption [<a href="#ref-XMLencrypt" title="&quot;XML Encryption Syntax and Processing&quot;">XMLencrypt</a>] or digital
   signature [<a href="#ref-XMLsig" title="&quot;XML-Signature Syntax and Processing (Second Edition)&quot;">XMLsig</a>], [<a href="rfc3275.html" title="&quot;(Extensible Markup Language) XML-Signature Syntax and Processing&quot;">RFC3275</a>] is used within a document.  Transport
   specifications are detailed in a separate document [<a href="rfc6046.html" title="&quot;Transport of Real-Time Inter-Network Defense (RID) Messages,&quot;">RFC6046</a>].

   It might be helpful to define an extension to the authentication
   scheme that uses attribute certificates [<a href="rfc5755.html" title="&quot;An Internet Attribute Certificate Profile for Authorization&quot;">RFC5755</a>] in such a way that
   an application could automatically determine whether human
   intervention is needed to authorize a request; however, the
   specification of such an extension is out of scope for this document.

<span class="h4"><a class="selflink" name="section-6.4.1" href="#section-6.4.1">6.4.1</a>.  Multi-Hop TraceRequest Authentication</span>

   Bilateral trust relations between network providers ensure the
   authenticity of requests for TraceRequests from immediate peers in
   the web of networks formed to provide the traceback capability.  A
   network provider several hops into the path of the RID trace must
   trust the information from its own trust relationships as well as the
   previous trust relationships in the downstream path.  For practical
   reasons, the NPs may want to prioritize incident handling events
   based upon the immediate peer for a TraceRequest, the originator, and
   the listed Confidence rating for the incident.  In order to provide a
   higher assurance level of the authenticity of the TraceRequest, the
   originating RID system is included in the TraceRequest along with
   contact information and the information of all RID systems in the
   path the trace has taken.  This information is provided through the
   IODEF EventData class nesting the list of systems and contacts
   involved in a trace, while setting the category attribute to
   "infrastructure".

   A second measure MUST be taken to ensure the identity of the
   originating RID system.  The originating RID system MUST include a
   digital signature in the TraceRequest sent to all systems in the
   upstream path.  The digital signature from the RID system is
   performed on the RecordItem class of the IODEF following the XML
   digital signature specifications from W3C [<a href="#ref-XMLsig" title="&quot;XML-Signature Syntax and Processing (Second Edition)&quot;">XMLsig</a>] using a detached
   signature.  The signature MUST be passed to all parties that receive
   a TraceRequest, and each party MUST be able to perform full path
   validation on the digital signature.  Full path validation verifies
   the chaining relationship to a trusted root and also performs a
   certificate revocation check.  In order to accommodate that
   requirement, the IP packet in the RecordItem data MUST remain



<span class="grey">Moriarty                      Informational                    [Page 65]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-66" id="page-66" href="#page-66" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   unchanged as a request is passed along between providers and is the
   only element for which the signature is applied.  If additional
   packets are included in the document at upstream peers, the initial
   packet MUST still remain with the detached signature.  The subsequent
   packets may be signed by the peer adding the incident information for
   the investigation.  A second benefit to this requirement is that the
   integrity of the filter used is ensured as it is passed to subsequent
   NPs in the upstream trace of the packet.  The trusted PKI also
   provides the keys used to digitally sign the RecordItem class for
   TraceRequests to meet the requirement of authenticating the original
   request.  Any host in the path of the trace should be able to verify
   the digital signature using the trusted PKI.

   In the case in which an enterprise network using RID sends a
   TraceRequest to its provider, the signature from the enterprise
   network MUST be included in the initial request.  The NP may generate
   a new request to send upstream to members of the NP consortium to
   continue the trace.  If the original request is sent, the originating
   NP, acting on behalf of the enterprise network under attack, MUST
   also digitally sign, with an enveloped signature, the full IODEF
   document to assure the authenticity of the TraceRequest.  An NP that
   offers RID as a service may be using its own PKI to secure RID
   communications between its RID system and the attached enterprise
   networks.  NPs participating in the trace MUST be able to determine
   the authenticity of RID requests.

<span class="h3"><a class="selflink" name="section-6.5" href="#section-6.5">6.5</a>.  Consortiums and Public Key Infrastructures</span>

   Consortiums of NPs are an ideal way to establish a communication web
   of trust for RID messaging.  The consortium could provide centralized
   resources, such as a PKI, and established guidelines for use of the
   RID protocol.  The consortium would also assist in establishing trust
   relationships between the participating NPs to achieve the necessary
   level of cooperation and experience-sharing among the consortium
   entities.  This may be established through PKI certificate policy
   [<a href="rfc3647.html" title="&quot;Internet X.509 Public Key Infrastructure Certificate Policy and Certification Practices Framework&quot;">RFC3647</a>] reviews to determine the appropriate trust levels between
   organizations or entities.  The consortium may also be used for other
   purposes to better facilitate communication among NPs in a common
   area (Internet, region, government, education, private networks,
   etc.).

   Using a PKI to distribute certificates used by RID systems provides
   an already established method to link trust relationships between NPs
   of consortiums that would peer with NPs belonging to a separate
   consortium.  In other words, consortiums could peer with other
   consortiums to enable communication of RID messages between the





<span class="grey">Moriarty                      Informational                    [Page 66]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-67" id="page-67" href="#page-67" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   participating NPs.  The PKI along with Memorandums of Agreement could
   be used to link border directories to share public key information in
   a bridge, a hierarchy, or a single cross-certification relationship.

   Consortiums also need to establish guidelines for each participating
   NP to adhere to.  The RECOMMENDED guidelines include:

   o  Physical and logical practices to protect RID systems;

   o  Network and application layer protection for RID systems and
      communications;

   o  Proper use guidelines for RID systems, messages, and requests; and

   o  A PKI to provide authentication, integrity, and privacy.

   The functions described for a consortium's role would parallel that
   of a PKI federation.  The PKI federations that currently exist are
   responsible for establishing security guidelines and PKI trust
   models.  The trust models are used to support applications to share
   information using trusted methods and protocols.

   A PKI can also provide the same level of security for communication
   between an end entity (enterprise, educational, or government
   customer network) and the NP.  The PKI may be a subordinate CA or in
   the CA hierarchy from the NP's consortium to establish the trust
   relationships necessary as the request is made to other connected
   networks.

<span class="h3"><a class="selflink" name="section-6.6" href="#section-6.6">6.6</a>.  Privacy Concerns and System Use Guidelines</span>

   Privacy issues raise many concerns when information-sharing is
   required to achieve the goal of stopping or mitigating the effects of
   a security incident.  The RIDPolicy class is used to automate the
   enforcement of the privacy concerns listed within this document.  The
   privacy and system use concerns that MUST be addressed in the RID
   system and other integrated components include the following:

   Network Provider Concerns:

   o  Privacy of data monitored and/or stored on IDSs for attack
      detection.

   o  Privacy of data monitored and stored on systems used to trace
      traffic across a single network.






<span class="grey">Moriarty                      Informational                    [Page 67]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-68" id="page-68" href="#page-68" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   Customer Attached Networks Participating in RID with NP:

   o  Customer networks may include an enterprise, educational,
      government, or other attached networks to an NP participating in
      RID and MUST be made fully aware of the security and privacy
      considerations for using RID.

   o  Customers MUST know the security and privacy considerations in
      place by their NP and the consortium of which the NP is a member.

   o  Customers MUST understand that their data can and will be sent to
      other NPs in order to complete a trace unless an agreement stating
      otherwise is made in the service level agreements between the
      customer and NP.

   Parties Involved in the Attack:

   o  Privacy of the identity of a host involved in an attack.

   o  Privacy of information such as the source and destination used for
      communication purposes over the monitored or RID connected
      network(s).

   o  Protection of data from being viewed by intermediate parties in
      the path of an Investigation request MUST be considered.

   Consortium Considerations:

   o  System use restricted to security incident handling within the
      local region's definitions of appropriate traffic for the network
      monitored and linked via RID in a single consortium also abiding
      by the consortium's use guidelines.

   o  System use prohibiting the consortium's participating NPs from
      inappropriately tracing non-attack traffic to locate sources or
      mitigate traffic unlawfully within the jurisdiction or region.

   Inter-Consortium Considerations:

   o  System use between peering consortiums MUST also adhere to any
      government communication regulations that apply between those two
      regions, such as encryption export and import restrictions.  This
      may include consortiums that are categorized as
      "BetweenConsortiums" or "AcrossNationalBoundaries".

   o  System use between consortiums MUST NOT request traffic traces and
      actions beyond the scope intended and permitted by law or
      inter-consortium agreements.



<span class="grey">Moriarty                      Informational                    [Page 68]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-69" id="page-69" href="#page-69" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   o  System use between consortiums classified as
      "AcrossNationalBoundaries" MUST respect national boundary issues
      and limit requests to appropriate system use and not to achieve
      their own agenda to limit or restrict traffic that is otherwise
      permitted within the country in which the peering consortium
      resides.

   The security and privacy considerations listed above are for the
   consortiums, NPs, and enterprises to agree upon.  The agreed-upon
   policies may be facilitated through use of the RIDPolicy class.  Some
   privacy considerations are addressed through the RID guidelines for
   encryption and digital signatures as described at the beginning of
   <a href="#section-6">Section 6</a>.

   RID is useful in determining the true source of a packet that
   traverses multiple networks or to communicate security incidents and
   automate the response.  The information obtained from the trace may
   determine the identity of the source host or the network provider
   used by the source of the traffic.  It should be noted that the trace
   mechanism used across a single-network provider may also raise
   privacy concerns for the clients of the network.  Methods that may
   raise concern include those that involve storing packets for some
   length of time in order to trace packets after the fact.  Monitoring
   networks for intrusions and for tracing capabilities also raises
   concerns for potentially sensitive valid traffic that may be
   traversing the monitored network.  IDSs and single-network tracing
   are outside of the scope of this document, but the concern should be
   noted and addressed within the use guidelines of the network.  Some
   IDSs and single-network trace mechanisms attempt to properly address
   these issues.  RID is designed to provide the information needed by
   any single-network trace mechanism.  The provider's choice of a
   single trace mechanism depends on resources, existing solutions, and
   local legislation.  Privacy concerns in regard to the single-network
   trace must be dealt with at the client-to-NP level and are out of
   scope for RID messaging.

   The identity of the true source of an attack packet being traced
   through RID could be sensitive.  The true identity listed in a Result
   message can be protected through the use of encryption [<a href="#ref-XMLencrypt" title="&quot;XML Encryption Syntax and Processing&quot;">XMLencrypt</a>]
   enveloping the IODEF document and RID Result information, using the
   public encryption key of the originating NP.  Alternatively, the
   action taken may be listed without the identity being revealed to the
   originating NP.  The ultimate goal of the RID communication system is
   to stop or mitigate attack traffic, not to ensure that the identity
   of the attack traffic is known to involved parties.  The NP that
   identifies the source should deal directly with the involved parties
   and proper authorities in order to determine the guidelines for the
   release of such information, if it is regarded as sensitive.  In some



<span class="grey">Moriarty                      Informational                    [Page 69]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-70" id="page-70" href="#page-70" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   situations, systems used in attacks are compromised by an unknown
   source and, in turn, are used to attack other systems.  In that
   situation, the reputation of a business or organization may be at
   stake, and the action taken may be the only additional information
   reported in the Result message to the originating system.  If the
   security incident is a minor incident, such as a zombie system used
   in part of a large-scale DDoS attack, ensuring the system is taken
   off the network until it has been fixed may be sufficient.  The
   decision is left to the system users and consortiums to determine
   appropriate data to be shared given that the goal of the
   specification is to provide the appropriate technical options to
   remain compliant.  The textual descriptions should include details of
   the incident in order to protect the reputation of the unknowing
   attacker and prevent the need for additional investigation.  Local,
   state, or national laws may dictate the appropriate reporting action
   for specific security incidents.

   Privacy becomes an issue whenever sensitive data traverses a network.
   For example, if an attack occurred between a specific source and
   destination, then every network provider in the path of the trace
   would become aware that the cyber attack occurred.  In a targeted
   attack, it may not be desirable that information about two nation
   states that are battling a cyber war would become general knowledge
   to all intermediate parties.  However, it is important to allow the
   traces to take place in order to halt the activity since the health
   of the networks in the path could also be at stake during the attack.
   This provides a second argument for allowing the Result message to
   only include an action taken and not the identity of the offending
   host.  In the case of an Investigation request, where the originating
   NP is aware of the NP that will receive the request for processing,
   the free-form text areas of the document could be encrypted
   [<a href="#ref-XMLencrypt" title="&quot;XML Encryption Syntax and Processing&quot;">XMLencrypt</a>] using the public key of the destination NP to ensure
   that no other NP in the path can read the contents.  The encryption
   would be accomplished through the W3C [<a href="#ref-XMLencrypt" title="&quot;XML Encryption Syntax and Processing&quot;">XMLencrypt</a>] specification for
   encrypting an element.

   In some situations, all network traffic of a nation may be granted
   through a single network provider.  In that situation, options must
   support sending Result messages from a downstream peer of that
   network provider.  That option provides an additional level of
   abstraction to hide the identity and the NP of the identified source
   of the traffic.  Legal action may override this technical decision
   after the trace has taken place, but that is out of the technical
   scope of this document.

   Privacy concerns when using an Investigation request to request
   action close to the source of valid attack traffic needs to be
   considered.  Although the intermediate NPs may relay the request if



<span class="grey">Moriarty                      Informational                    [Page 70]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-71" id="page-71" href="#page-71" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   there is no direct trust relationship to the closest NP to the
   source, the intermediate NPs do not require the ability to see the
   contents of the packet or the text description field(s) in the
   request.  This message type does not require any action by the
   intermediate RID systems, except to relay the packet to the next NP
   in the path.  Therefore, the contents of the request may be encrypted
   for the destination system.  The intermediate NPs would only need to
   know how to direct the request to the manager of the ASN in which the
   source IP address belongs.

   Traces must be legitimate security-related incidents and not used for
   purposes such as sabotage or censorship.  An example of such abuse of
   the system would include a request to block or rate-limit legitimate
   traffic to prevent information from being shared between users on the
   Internet (restricting access to online versions of papers) or
   restricting access from a competitor's product in order to sabotage a
   business.

   Intra-consortium RID communications raise additional issues,
   especially when the peering consortiums reside in different regions
   or nations.  TraceRequests and requested actions to mitigate traffic
   must adhere to the appropriate use guidelines and yet prevent abuse
   of the system.  First, the peering consortiums MUST identify the
   types of traffic that can be traced between the borders of the
   participating NPs of each consortium.  The traffic traced should be
   limited to security-incident-related traffic.  Second, the traces
   permitted within one consortium if passed to a peering consortium may
   infringe upon the peering consortium's freedom of information laws.
   An example would be a consortium in one country permitting a trace of
   traffic containing objectionable material, outlawed within that
   country.  The RID trace may be a valid use of the system within the
   confines of that country's network border; however, it may not be
   permitted to continue across network boundaries where such content is
   permitted under law.  By continuing the trace in another country's
   network, the trace and response could have the effect of improperly
   restricting access to data.  A continued trace into a second country
   may break the laws and regulations of that nation.  Any such traces
   MUST cease at the country's border.

   The privacy concerns listed in this section address issues among the
   trusted parties involved in a trace within an NP, a RID consortium,
   and peering RID consortiums.  Data used for RID communications must
   also be protected from parties that are not trusted.  This protection
   is provided through the authentication and encryption of documents as
   they traverse the path of trusted servers.  Each RID system MUST
   perform a bi-directional authentication when sending a RID message
   and use the public encryption key of the upstream or downstream peer
   to send a message or document over the network.  This means that the



<span class="grey">Moriarty                      Informational                    [Page 71]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-72" id="page-72" href="#page-72" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   document is decrypted and re-encrypted at each RID system via TLS
   over the transport protocol [<a href="rfc6046.html" title="&quot;Transport of Real-Time Inter-Network Defense (RID) Messages,&quot;">RFC6046</a>].  The RID messages may be
   decrypted at each RID system in order to properly process the request
   or relay the information.  Today's processing power is more than
   sufficient to handle the minimal burden of encrypting and decrypting
   relatively small typical RID messages.

<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  IANA Considerations</span>

   This document uses URNs to describe XML namespaces and XML schemas
   [<a href="#ref-XMLschema" title="&quot;XML Schema&quot;">XMLschema</a>] conforming to a registry mechanism described in
   [<a href="rfc3688.html" title="&quot;The IETF XML Registry&quot;">RFC3688</a>].

   Registration request for the iodef-rid namespace:

   URI: urn:ietf:params:xml:ns:iodef-rid-1.0

   Registrant Contact: See the "Author's Address" section of this
   document.

   XML: None.  Namespace URIs do not represent an XML specification.


   Registration request for the iodef-rid XML schema:

   URI: urn:ietf:params:xml:schema:iodef-rid-1.0

   Registrant Contact: See the "Author's Address" section of this
   document.

   XML: See <a href="#section-5">Section 5</a>, "RID Schema Definition", of this document.

<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  Summary</span>

   Security incidents have always been difficult to trace as a result of
   the spoofed sources, resource limitations, and bandwidth utilization
   problems.  Incident response is often slow even when the IP address
   is known to be valid because of the resources required to notify the
   responsible party of the attack and then to stop or mitigate the
   attack traffic.  Methods to identify and trace attacks near real time
   are essential to thwarting attack attempts.  Network providers need
   policies and automated methods to combat the hacker's efforts.  NPs
   need automated monitoring and response capabilities to identify and
   trace attacks quickly without resource-intensive side effects.
   Integration with a centralized communication system to coordinate the
   detection, tracing, and identification of attack sources on a single
   network is essential.  RID provides a way to integrate NP resources
   for each aspect of attack detection, tracing, and source



<span class="grey">Moriarty                      Informational                    [Page 72]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-73" id="page-73" href="#page-73" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   identification and extends the communication capabilities among
   network providers.  The communication is accomplished through the use
   of flexible IODEF XML-based documents passed between IHSs or RID
   systems.  A TraceRequest or Investigation request is communicated to
   an upstream NP and may result in an upstream trace or in an action to
   stop or mitigate the attack traffic.  The messages are communicated
   among peers with security inherent to the RID messaging scheme
   provided through existing standards such as XML encryption and
   digital signatures.  Policy information is carried in the RID message
   itself through the use of the RIDPolicy.  RID provides the timely
   communication among NPs, which is essential for incident handling.

<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  References</span>

<span class="h3"><a class="selflink" name="section-9.1" href="#section-9.1">9.1</a>.  Normative References</span>

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]      Bradner, S., "Key words for use in RFCs to Indicate
                  Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a name="ref-RFC3275" id="ref-RFC3275">RFC3275</a>]      Eastlake 3rd, D., Reagle, J., and D. Solo,
                  "(Extensible Markup Language) XML-Signature Syntax and
                  Processing", <a href="rfc3275.html">RFC 3275</a>, March 2002.

   [<a name="ref-RFC3688" id="ref-RFC3688">RFC3688</a>]      Mealling, M., "The IETF XML Registry", <a href="https://tools.ietf.org/html/bcp81">BCP 81</a>, <a href="rfc3688.html">RFC</a>
                  <a href="rfc3688.html">3688</a>, January 2004.

   [<a name="ref-RFC4279" id="ref-RFC4279">RFC4279</a>]      Eronen, P., Ed., and H. Tschofenig, Ed., "Pre-Shared
                  Key Ciphersuites for Transport Layer Security (TLS)",
                  <a href="rfc4279.html">RFC 4279</a>, December 2005.

   [<a name="ref-RFC5070" id="ref-RFC5070">RFC5070</a>]      Danyliw, R., Meijer, J., and Y. Demchenko, "The
                  Incident Object Description Exchange Format", <a href="rfc5070.html">RFC</a>
                  <a href="rfc5070.html">5070</a>, December 2007.

   [<a name="ref-RFC5280" id="ref-RFC5280">RFC5280</a>]      Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
                  Housley, R., and W. Polk, "Internet X.509 Public Key
                  Infrastructure Certificate and Certificate Revocation
                  List (CRL) Profile", <a href="rfc5280.html">RFC 5280</a>, May 2008.

   [<a name="ref-RFC5755" id="ref-RFC5755">RFC5755</a>]      Farrell, S., Housley, R., and S. Turner, "An Internet
                  Attribute Certificate Profile for Authorization",
                  <a href="rfc5755.html">RFC 5755</a>, January 2010.

   [<a name="ref-RFC6046" id="ref-RFC6046">RFC6046</a>]      Moriarty, K. and B. Trammell, "Transport of Real-Time
                  Inter-Network Defense (RID) Messages," <a href="rfc6046.html">RFC 6046</a>,
                  November 2010.





<span class="grey">Moriarty                      Informational                    [Page 73]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-74" id="page-74" href="#page-74" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   [<a name="ref-XML1.0" id="ref-XML1.0">XML1.0</a>]       "Extensible Markup Language (XML) 1.0 (Second
                  Edition)".  W3C Recommendation.  T. Bray, E. Maler, J.
                  Paoli, and C.M. Sperberg-McQueen.  October 2000.
                  <a href="http://www.w3.org/TR/2000/REC-xml-20001006">http://www.w3.org/TR/2000/REC-xml-20001006</a>.

   [<a name="ref-XMLnames" id="ref-XMLnames">XMLnames</a>]     "Namespaces in XML 1.0 (Third Edition)".  W3C
                  Recommendation.  T. Bray, D. Hollander, A. Layman, R.
                  Tobin, H. Thompson.  December 2009.
                  <a href="http://www.w3.org/TR/REC-xml-names/">http://www.w3.org/TR/REC-xml-names/</a>.

   [<a name="ref-XMLencrypt" id="ref-XMLencrypt">XMLencrypt</a>]   "XML Encryption Syntax and Processing".  W3C
                  Recommendation.  T. Imamura, B. Dillaway, and E.
                  Simon.  December 2002.
                  <a href="http://www.w3.org/TR/xmlenc-core/">http://www.w3.org/TR/xmlenc-core/</a>.

   [<a name="ref-XMLschema" id="ref-XMLschema">XMLschema</a>]    "XML Schema".  E. Van der Vlist.  O'Reilly.  2002.

   [<a name="ref-XMLsig" id="ref-XMLsig">XMLsig</a>]       "XML-Signature Syntax and Processing (Second
                  Edition)".  W3C Recommendation.  M. Bartel, J. Boyer,
                  B. Fox, B. LaMacchia, and E. Simon.  June 2008.
                  <a href="http://www.w3.org/TR/xmldsig-core/#sec-Design">http://www.w3.org/TR/xmldsig-core/#sec-Design</a>.

<span class="h3"><a class="selflink" name="section-9.2" href="#section-9.2">9.2</a>.  Informative References</span>

   [<a name="ref-RFC1930" id="ref-RFC1930">RFC1930</a>]      Hawkinson, J. and T. Bates, "Guidelines for creation,
                  selection, and registration of an Autonomous System
                  (AS)", <a href="https://tools.ietf.org/html/bcp6">BCP 6</a>, <a href="rfc1930.html">RFC 1930</a>, March 1996.

   [<a name="ref-RFC2827" id="ref-RFC2827">RFC2827</a>]      Ferguson, P. and D. Senie, "Network Ingress Filtering:
                  Defeating Denial of Service Attacks which employ IP
                  Source Address Spoofing", <a href="https://tools.ietf.org/html/bcp38">BCP 38</a>, <a href="rfc2827.html">RFC 2827</a>, May 2000.

   [<a name="ref-RFC3647" id="ref-RFC3647">RFC3647</a>]      Chokhani, S., Ford, W., Sabett, R., Merrill, C., and
                  S. Wu, "Internet X.509 Public Key Infrastructure
                  Certificate Policy and Certification Practices
                  Framework", <a href="rfc3647.html">RFC 3647</a>, November 2003.

   [<a name="ref-RFC3917" id="ref-RFC3917">RFC3917</a>]      Quittek, J., Zseby, T., Claise, B., and S. Zander,
                  "Requirements for IP Flow Information Export (IPFIX)",
                  <a href="rfc3917.html">RFC 3917</a>, October 2004.

   [<a name="ref-RFC5735" id="ref-RFC5735">RFC5735</a>]      Cotton, M. and L. Vegoda, "Special Use IPv4
                  Addresses", <a href="https://tools.ietf.org/html/bcp153">BCP 153</a>, <a href="rfc5735.html">RFC 5735</a>, January 2010.

   [<a name="ref-IPtrace" id="ref-IPtrace">IPtrace</a>]      "Advanced and Authenticated Marking Schemes for IP
                  Traceback".  D. Song and A. Perrig.  IEEE INFOCOM
                  2001.




<span class="grey">Moriarty                      Informational                    [Page 74]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-75" id="page-75" href="#page-75" class="invisible"> </a>
<span class="grey"><a href="rfc6045.html">RFC 6045</a>                           RID                     November 2010</span>


   [<a name="ref-HASH-IPtrace" id="ref-HASH-IPtrace">HASH-IPtrace</a>] "Hash-Based IP Traceback".  A. Snoeren, C. Partridge,
                  L. Sanchez, C. Jones, F. Tchakountio, S. Kent, and W.
                  Strayer.  SIGCOMM'01.  August 2001.

   [<a name="ref-ICMPtrace" id="ref-ICMPtrace">ICMPtrace</a>]    Bellovin, S., Leech, M., and T. Taylor, "ICMP
                  Traceback Messages", Work in Progress, February 2003.

   [<a name="ref-NTWK-IPtrace" id="ref-NTWK-IPtrace">NTWK-IPtrace</a>] "Practical network support for IP traceback".  S.
                  Savage, D. Wetherall, A. Karlin, and T. Anderson.
                  SIGCOMM'00.  August 2000.

   [<a name="ref-DoS" id="ref-DoS">DoS</a>]          "Trends in Denial of Service Attack Technology".  K.
                  Houle, G. Weaver, N. Long, and R. Thomas.  CERT
                  Coordination Center.  October 2001.

Acknowledgements

   Many thanks to coworkers and the Internet community for reviewing and
   commenting on the document as well as providing recommendations to
   simplify and secure the protocol: Robert K. Cunningham, Ph.D, Cynthia
   D. McLain, Dr. William Streilein, Iljitsch van Beijnum, Steve
   Bellovin, Yuri Demchenko, Jean-Francois Morfin, Stephen Northcutt,
   Jeffrey Schiller, Brian Trammell, Roman Danyliw, Tony Tauber, and
   Sandra G. Dykes, Ph.D.

Sponsor Information

   This work was sponsored by the Air Force under Air Force Contract
   FA8721-05-C-0002, while working at MIT Lincoln Laboratory.

   "Opinions, interpretations, conclusions, and recommendations are
   those of the author and are not necessarily endorsed by the United
   States Government".

Author's Address

   Kathleen M. Moriarty
   RSA, The Security Division of EMC
   174 Middlesex Turnpike
   Bedford, MA  01730
   US

   EMail: Moriarty_Kathleen@EMC.com








Moriarty                      Informational                    [Page 75]

</pre><br />
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>
</body>

<!-- Mirrored from tools.ietf.org/html/rfc6045 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:32 GMT -->
</html>
