<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc5563 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:34 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:5563" name="DC.Identifier"/>
<meta content="Mobile IPv4 is a standard mobility protocol that enables an IPv4
device to move among networks while maintaining its IP address. The
mobile device has the Mobile IPv4 client function to signal its
location to the routing anchor, known as the Home Agent. However,
there are many IPv4 devices without such capability due to various
reasons. This document describes Proxy Mobile IPv4 (PMIPv4), a scheme
based on having the Mobile IPv4 client function in a network entity to
provide mobility support for an unaltered and mobility-unaware IPv4
device. This document also describes a particular application of
PMIPv4 as specified in the WiMAX Forum and another application that is
to be adopted in 3GPP2. This document is not an Internet Standards
Track specification; it is published for informational purposes." name="DC.Description.Abstract"/>
<meta content="Kent Leung &lt;kleung@cisco.com&gt;" name="DC.Creator"/>
<meta content="February, 2010" name="DC.Date.Issued"/>
<meta content="WiMAX Forum / 3GPP2 Proxy Mobile IPv4" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5563 - WiMAX Forum / 3GPP2 Proxy Mobile IPv4</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc5563.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc5563" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-leung-mip4-proxy-mode" title="draft-leung-mip4-proxy-mode">draft-leung-mip...</a>] [<a href="https://datatracker.ietf.org/doc/rfc5563" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5563" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc5563" title="Side-by-side diff">Diff2</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=5563&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>]   </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Independent Submission                                          K. Leung
Request for Comments: 5563                                    G. Dommety
Category: Informational                                    Cisco Systems
ISSN: 2070-1721                                                P. Yegani
                                                        Juniper Networks
                                                            K. Chowdhury
                                                        Starent Networks
                                                           February 2010


                 <span class="h1">WiMAX Forum / 3GPP2 Proxy Mobile IPv4</span>

Abstract

   Mobile IPv4 is a standard mobility protocol that enables an IPv4
   device to move among networks while maintaining its IP address.  The
   mobile device has the Mobile IPv4 client function to signal its
   location to the routing anchor, known as the Home Agent.  However,
   there are many IPv4 devices without such capability due to various
   reasons.  This document describes Proxy Mobile IPv4 (PMIPv4), a
   scheme based on having the Mobile IPv4 client function in a network
   entity to provide mobility support for an unaltered and mobility-
   unaware IPv4 device.  This document also describes a particular
   application of PMIPv4 as specified in the WiMAX Forum and another
   application that is to be adopted in 3GPP2.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This is a contribution to the RFC Series, independently of any other
   RFC stream.  The RFC Editor has chosen to publish this document at
   its discretion and makes no statement about its value for
   implementation or deployment.  Documents approved for publication by
   the RFC Editor are not a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc5563">http://www.rfc-editor.org/info/rfc5563</a>.










<span class="grey">Leung, et al.                 Informational                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Conventions Used in This Document ...............................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. Benefits of Proxy Mobile IPv4 ...................................<a href="#page-6">6</a>
   <a href="#section-4">4</a>. Overview of Proxy Mobile IPv4 ...................................<a href="#page-7">7</a>
      <a href="#section-4.1">4.1</a>. Mobility Signaling for Mobile Device .......................<a href="#page-7">7</a>
           4.1.1. Proxy Registration during Initial Network
                  Attachment ..........................................<a href="#page-8">8</a>
           <a href="#section-4.1.2">4.1.2</a>. Proxy Registration Renewal .........................<a href="#page-11">11</a>
           <a href="#section-4.1.3">4.1.3</a>. Proxy Handover Support .............................<a href="#page-12">12</a>
           <a href="#section-4.1.4">4.1.4</a>. Resource Cleanup ...................................<a href="#page-13">13</a>
      <a href="#section-4.2">4.2</a>. Establishment of a Bi-Directional Tunnel ..................<a href="#page-14">14</a>
           <a href="#section-4.2.1">4.2.1</a>. Packet Forwarding ..................................<a href="#page-14">14</a>
           <a href="#section-4.2.2">4.2.2</a>. Broadcast and Multicast ............................<a href="#page-14">14</a>
           <a href="#section-4.2.3">4.2.3</a>. Forwarding between Devices on the Same PMA .........<a href="#page-15">15</a>
      <a href="#section-4.3">4.3</a>. Security Association between the PMA and the HA ...........<a href="#page-15">15</a>
      <a href="#section-4.4">4.4</a>. Registration Sequencing ...................................<a href="#page-15">15</a>
      <a href="#section-4.5">4.5</a>. Mobile Device Interface Configuration .....................<a href="#page-16">16</a>
      <a href="#section-4.6">4.6</a>. Dynamic HA Discovery ......................................<a href="#page-16">16</a>
   <a href="#section-5">5</a>. Proxy Mobile IPv4 Extensions ...................................<a href="#page-16">16</a>
      <a href="#section-5.1">5.1</a>. PMIPv4 Per-Node Authentication Method Extension ...........<a href="#page-17">17</a>
      <a href="#section-5.2">5.2</a>. Proxy Mobile IPv4 Interface ID Extension ..................<a href="#page-18">18</a>
      <a href="#section-5.3">5.3</a>. Proxy Mobile IPv4 Device ID Extension .....................<a href="#page-18">18</a>
      <a href="#section-5.4">5.4</a>. Proxy Mobile IPv4 Subscriber ID Extension .................<a href="#page-19">19</a>
      <a href="#section-5.5">5.5</a>. PMIPv4 Access Technology Type Extension ...................<a href="#page-20">20</a>
   <a href="#section-6">6</a>. Appearance of Being at Home Network ............................<a href="#page-22">22</a>
      <a href="#section-6.1">6.1</a>. ARP Considerations ........................................<a href="#page-22">22</a>
      <a href="#section-6.2">6.2</a>. ICMP Considerations .......................................<a href="#page-23">23</a>
      <a href="#section-6.3">6.3</a>. DHCP Considerations .......................................<a href="#page-23">23</a>
      <a href="#section-6.4">6.4</a>. PPP IPCP Considerations ...................................<a href="#page-24">24</a>
      <a href="#section-6.5">6.5</a>. Link-Local Multicast and Broadcast Considerations .........<a href="#page-24">24</a>
   <a href="#section-7">7</a>. Proxy Mobility Agent Operation .................................<a href="#page-24">24</a>
   <a href="#section-8">8</a>. Home Agent Operation ...........................................<a href="#page-25">25</a>
      <a href="#section-8.1">8.1</a>. Processing Proxy Registration Requests ....................<a href="#page-26">26</a>




<span class="grey">Leung, et al.                 Informational                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


   <a href="#section-9">9</a>. Mobile Device Operation ........................................<a href="#page-26">26</a>
      <a href="#section-9.1">9.1</a>. Initial Network Access ....................................<a href="#page-27">27</a>
      <a href="#section-9.2">9.2</a>. Mobile Device Mobility ....................................<a href="#page-27">27</a>
      <a href="#section-9.3">9.3</a>. Sending and Receiving Packets .............................<a href="#page-27">27</a>
   <a href="#section-10">10</a>. Proxy Mobile IPv4 Use Case in WiMAX ...........................<a href="#page-28">28</a>
      10.1. Proxy Mobile IPv4 Call Flow Examples with Split
            PMA in WiMAX .............................................<a href="#page-31">31</a>
   <a href="#section-11">11</a>. Proxy Mobile IPv4 Use Case in 3GPP2 ...........................<a href="#page-33">33</a>
      <a href="#section-11.1">11.1</a>. Handover Considerations in 3GPP2 .........................<a href="#page-36">36</a>
   <a href="#section-12">12</a>. IANA Considerations ...........................................<a href="#page-37">37</a>
      <a href="#section-12.1">12.1</a>. Mobile IPv4 Extension Types ..............................<a href="#page-38">38</a>
      <a href="#section-12.2">12.2</a>. Mobile IPv4 Error Codes ..................................<a href="#page-38">38</a>
   <a href="#section-13">13</a>. Security Considerations .......................................<a href="#page-38">38</a>
   <a href="#section-14">14</a>. Acknowledgements ..............................................<a href="#page-38">38</a>
   <a href="#section-15">15</a>. References ....................................................<a href="#page-39">39</a>
      <a href="#section-15.1">15.1</a>. Normative References .....................................<a href="#page-39">39</a>
      <a href="#section-15.2">15.2</a>. Informative References ...................................<a href="#page-39">39</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   There are many IPv4 devices that do not have or cannot be enabled
   with Mobile IPv4 [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>] functionality.  Yet, mobility for them is
   essential.  Proxy Mobile IPv4 provides mobility support without
   "touching" these devices.  The scheme is based on network entities
   that perform the mobility-management function for a mobile device.
   The location of the device is signaled by the network element on the
   access network (referred to as the Proxy Mobility Agent (PMA)) to
   inform the network entity on the home network (referred to as the
   Home Agent (HA)) associated with the IPv4 address used by the device.
   Mobile IPv4 messaging is used by the PMA and HA, which correspond to
   the <a href="rfc3344.html">RFC 3344</a> entities Mobile Node (in proxy mode) and Home Agent,
   respectively.

   These are some examples of Proxy Mobile IPv4:

   1.  A Wireless Local Area Network (WLAN) access point or cellular
       base station performs registration with the Home Agent when a
       mobile device is associated on the air-link.

   2.  An access router or Foreign Agent performs registration with the
       Home Agent when a mobile device is detected on the network.

   Mobile IPv4 is used by the network entities because the mobility
   protocol has the functions needed to set up the route and tunneling
   endpoints for the mobile device's IP address and to deliver
   configuration parameters (e.g., DNS server addresses, default
   gateway) for enabling the mobile device's IP stack.  When Mobile IPv4
   is used in this way, the security association is between the PMA and



<span class="grey">Leung, et al.                 Informational                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


   the HA because these entities are the signaling endpoints.  Also,
   when the mobile device moves to a new PMA, the sequencing of messages
   sourced from multiple PMAs needs to be handled properly by the HA.

   This document describes how the network entities, PMA and HA, provide
   mobility management for the mobile device.  It is organized to cover
   the generic functionality of Proxy Mobile IPv4 and also the specifics
   pertaining to WiMAX (<a href="#section-10">Section 10</a>) and 3GPP2 (<a href="#section-11">Section 11</a>).

   Note that Proxy Mobile IPv6 [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>] is an IETF standard for
   network-based mobility management that enables IP mobility for a host
   without requiring its participation in any mobility-related
   signaling.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Conventions Used in This Document</span>

   The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

   The following new terminology and abbreviations are introduced in
   this document; all other general mobility-related terms are as
   defined in Mobile IPv4 specification [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>].

   Mobile Device

      The mobile device is used to refer to an IPv4 device with its
      mobility provided by the network.  The mobile device is not
      required to participate in any mobility-related signaling for
      achieving mobility for an obtained IP address.

   Proxy Mobile IPv4 Client (PMIPv4 Client)

      This network function is responsible for initiating and
      maintaining the Proxy Mobile IPv4 registration on behalf of the
      mobile device.  Essentially, it performs the Mobile IPv4 client
      function but is hosted in the network.  In some cases, this
      function is collocated with the Foreign Agent; in others, it is
      not.  In both cases, Proxy Mobile IPv4 registration still goes via
      the Foreign Agent at all practical effects, even if it is internal
      to the node.

   Home Agent (HA)

      The Home Agent that is defined in Mobile IPv4 [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>] is used in
      the Proxy Mobile IPv4 scheme.  It is the topological anchor point
      for the mobile device's home network and is the entity that
      manages the mobile device's reachability state.  The additional



<span class="grey">Leung, et al.                 Informational                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


      capabilities for supporting Proxy Mobile IPv4 in the Home Agent
      are defined in this document.

   Foreign Agent (FA)

      The Foreign Agent that is defined in [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>] is used in the
      Proxy Mobile IPv4 scheme.  It is either collocated with or
      separate from the PMIPv4 client.  It serves the purpose of tunnel
      endpoint from Proxy Mobile IPv4 perspective.

   Access Router (AR)

      Access Router is a commonly used term that refers to the node in
      the network that connects the hosts to the IP network.

   Proxy Mobility Agent (PMA)

      Proxy Mobility Agent is the logical entity in the network that
      encompasses both the PMIPv4 client and the FA functions.  The
      PMIPv4 client and the FA collocation in the Access Router
      constitute an integrated PMA.  When the PMIPv4 client and the FA
      functions are not collocated in the Access Router, it is referred
      to as a split PMA.  A PMIPv4 client may have association with
      multiple FAs, and vice versa.

   Proxy Registration Request (PRRQ)

      The Registration Request message is sent by the Proxy Mobility
      Agent to the Home Agent in order to set up a mobility binding
      entry for a mobile device.  The message format is identical to
      that of the Mobile IPv4 Registration Request, though the Proxy
      Mobile IPv4 extensions that are defined in this document may be
      included for enhanced features of network-based mobility
      management.

   Proxy Registration Reply (PRRP)

      The Registration Reply message is sent by the Home Agent in
      response to the Proxy Registration Request received from the Proxy
      Mobility Agent.  The message format is identical to that of the
      Mobile IPv4 Registration Reply, though the Proxy Mobile IPv4
      extensions that are defined in this document may be included for
      enhanced features of network-based mobility management.








<span class="grey">Leung, et al.                 Informational                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Benefits%20of%20Proxy%20Mobile%20IPv4"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Benefits of Proxy Mobile IPv4</span>

   Proxy Mobile IPv4 (PMIPv4) is designed to satisfy the requirements
   listed below.  In addition, while this specification and Proxy Mobile
   IPv4 are not standards, they employ a standard: Mobile IPv4.
   Implementations of Mobile IPv4 can be re-used (i.e., a client-based
   mobility protocol can be used "as-is" to support network-based
   mobility).  However, new PMIPv4 extensions that are added to Mobile
   IPv4 improves the flexibility of the solution.  The practical
   advantage of having a common mobility protocol for both client-based
   and network-based mobility is that a Home Agent can anchor all types
   of mobile devices, both ones that have and ones that lack the Mobile
   IPv4 function.

   The network-based mobility management solution defined in this
   document has the following significant reasons for its use in any
   wireless network:

   1.  Support for Unmodified Hosts

       An overwhelming majority of IPv4 hosts do not have Mobile IPv4
       capability.  Providing mobility for them is achievable using
       Proxy Mobile IPv4.  This is accomplished without "touching" the
       user's devices by running on a myriad of operating systems and
       networking stacks.

   2.  Re-Use of Existing Home Agent

       An existing Home Agent implementation can be used for network-
       based mobility as well.  Further enhancements are optional and
       only incremental in nature.  There are many commonalities between
       client-based and network-based mobility, and sharing the same
       protocol is a significant benefit.

   3.  Reduction of Air-Link Resource Consumption

       Mobility-related signaling over the air-link is eliminated.

   4.  Support for Heterogeneous Wireless Link Technologies

       Since Proxy Mobile IPv4 is based on an access, technology-
       independent, mobility protocol, it can be used for any type of
       access network.

       From the network perspective, a mobile device is identified by
       the Network Access Identifier (NAI) and the forwarding is set up
       between the PMA and HA for the mobile device's current point of
       attachment on the network.  The mobile device may be attached to



<span class="grey">Leung, et al.                 Informational                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


       multiple networks concurrently, although the network treats each
       access interface independently.  This feature can be supported
       with the use of the PMIPv4 Access Technology Type Extension
       (<a href="#section-5.5">Section 5.5</a>).

   5.  Support for IPv4 and IPv6 Hosts

       As IPv6 increases in popularity, the host will likely be dual
       stack.  Adding IPv6 support to the host for Proxy Mobile IPv4
       involves the methods defined in [<a href="rfc5454.html" title='"Dual-Stack Mobile IPv4"'>RFC5454</a>].  There are additional
       enhancements needed, which are described in "Proxy Mobile IPv6"
       [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>].  However, support for an IPv6 host is out of the scope
       of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Overview%20of%20Proxy%20Mobile%20IPv4"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Overview of Proxy Mobile IPv4</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Mobility%20Signaling%20for%20Mobile%20Device"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Mobility Signaling for Mobile Device</span>

   After the mobile device completes network-access authentication, the
   PMA exchanges Proxy Mobile IPv4 registration messages with the HA to
   set up proper routing and tunneling of packets from/to the Mobile
   Node.  The PMIPv4 client is responsible for initiating the Proxy
   Mobile IPv4 registration.  For integrated PMA, the PMIPv4 client and
   the FA interaction is all within the node.  In the case of split PMA
   implementation, the interactions between the PMIPv4 client and the FA
   are exposed.  The interface between the PMIP Client and the FA in the
   split PMA scenario is defined in a standards organization
   specification [<a href="#ref-NWG" title='"WiMAX Forum Network Architecture (Stage 3: Detailed Protocols and Procedures)"'>NWG</a>] and is consequently out of the scope of this
   document.

   The following call flows describe the operations of Proxy Mobile
   IPv4.  The initial network attachment, registration renewal, and
   resource cleanup procedures are covered.  Note that the protocols
   that interact with Proxy Mobile IP are identified and explained in
   more detail.  The PPP/IPCP (IP Control Protocol) protocol involves a
   PPP client in the mobile device and a Network Access Server (NAS) in
   the AR.  DHCP involves a DHCP client in the MN and a DHCP server in
   either the AR or the HA.  PMIPv4 involves a PMA in the AR and an HA
   in the router on the home network.  The Authentication,
   Authorization, and Accounting (AAA) protocol involves a AAA client in
   the AR and a AAA server in the network.  The collocation of the
   functional entities in the AR/HA enables parameters to be
   shared/processed among the protocols.

   When the various network entities are not collocated, any sharing of
   parameters or other state information between them is out of the
   scope of this document.




<span class="grey">Leung, et al.                 Informational                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.1.%20%20Proxy%20Registration%20during%20Initial%20Network%20Attachment"></a><a class="selflink" href="#section-4.1.1" name="section-4.1.1">4.1.1</a>.  Proxy Registration during Initial Network Attachment</span>

                +----+        +-------+      +-------+      +-----+
                |    |        | AR /  |      |       |      |     |
                | MN |        | PMA   |      |  AAA  |      |  HA |
                |    |        |       |      |       |      |     |
                +----+        +-------+      +-------+      +-----+
                   |               |             |             |
                   |     1a        |     1b      |             |
   Authentication  |&lt;-------------&gt;|&lt;-----------&gt;|             |
                   |               |             |             |
                   |     2         |             |             |
              +-&gt;  |--------------&gt;|             |             |
              |    |               |       3     |             |
              |    |               |--------------------------&gt;| &lt;-+
   Address    |    |               |             |             |   |PMIP
   Acquisition|    |               |       4     |             |   |
              |    |               |&lt;--------------------------| &lt;-+
              |    |     5         |             |             |
              +-&gt;  |&lt;--------------|             |             |
                   |               |             |             |
                   |     6         |             |             |
   Data Forwarding |&lt;-------------&gt;|&lt;=========================&gt;|
                   |               |             |             |

                    Figure 1: Network Connection Setup

   The initial network-attachment procedure is described below.  There
   are three distinct phases.  First, authentication and authorization
   happen when the mobile device accesses the network.  Then, the mobile
   device attempts to obtain an IP address.  This triggers Proxy Mobile
   IP, which assigns/authorizes the IP address and sets up forwarding
   between the PMA and HA.  The host configuration parameters may be
   passed in the PMIPv4 signaling.  Finally, the mobile device
   configures its IP stack with the IP address and the obtained host
   configuration.  Packets to and from the mobile device transit both
   the PMA and HA.

   1a.  The mobile device establishes a L2 (Layer 2) link with the base
        station (not shown) and performs access
        authentication/authorization with the AR (Access Router).
        During this phase, the mobile device may run either the
        Challenge Handshake Authentication Protocol (CHAP) [<a href="rfc1994.html" title='"PPP Challenge Handshake Authentication Protocol (CHAP)"'>RFC1994</a>] if
        PPP [<a href="rfc1661.html" title='"The Point-to-Point Protocol (PPP)"'>RFC1661</a>] is used or the Extensible Authentication Protocol
        (EAP) [<a href="rfc3748.html" title='"Extensible Authentication Protocol (EAP)"'>RFC3748</a>] over foo (foo being the specific access
        technology, or PANA [<a href="rfc4058.html" title='"Protocol for Carrying Authentication for Network Access (PANA) Requirements"'>RFC4058</a>]).  The AR acts as the NAS (Network
        Access Server) in this step.




<span class="grey">Leung, et al.                 Informational                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


   1b.  The AAA client exchanges AAA messages with the AAA
        infrastructure to perform authentication and authorization of
        the mobile device.  As part of this step, the AAA server may
        download some information about the mobile device (e.g., the
        user's profile, handset type, assigned Home Agent address, and
        other capabilities of the mobile device).

   2.   The mobile device requests an IP address via a PPP/IPCP
        [<a href="rfc1332.html" title='"The PPP Internet Protocol Control Protocol (IPCP)"'>RFC1332</a>] or DHCP [<a href="rfc2131.html" title='"Dynamic Host Configuration Protocol"'>RFC2131</a>].  Specifically for PPP, the PPP
        client sends an IPCP Configure-Request to the NAS.  As for DHCP,
        the DHCP client sends the DHCP Discover message to the DHCP
        relay agent/ server.

        For the DHCP case, the DHCP server or DHCP relay agent sends the
        DHCP Ack message to the DHCP client after PMIPv4 signaling has
        completed.

   3.   Triggered by step 2, the PMA sends a Proxy Registration Request
        (PRRQ) to the HA.  The HA's IP address is either obtained from
        the AAA server at step 1b or discovered by some other method.
        The PRRQ contains the Care-of Address (CoA) of the PMA (the
        collocated FA in this case).  The Home Address field is set to
        zero or the IP address is specified as a hint in the DHCP or
        IPCP message.  The PRRQ MUST be protected by the methods
        described in the Security Considerations (<a href="#section-13">Section 13</a>) of this
        document.  The derivation and distribution of the MN-HA or FA-HA
        key is outside the scope of this document.

   4.   The Home Agent sets up the mobility binding entry for the mobile
        device after assigning an IP address or authorizing the
        requested Home Address.  The Home Agent may also assign a
        Generic Routing Encapsulation (GRE) key in this step (if GRE
        tunneling is used between the PMA and HA).  The HA returns the
        Home Address and the GRE key (if applicable) in the Proxy
        Registration Reply (PRRP) to the PMA.  If the requested Home
        Address is not authorized, the Home Agent denies the
        registration with error code 129 (administratively prohibited).
        After the PMA processes the PRRP, the forwarding path for the
        Home Address between the PMA and HA is established.  A GRE
        tunnel may be used between the PMA and the HA [<a href="#ref-MIP4GREKEY" title='"GRE Key Extension for Mobile IPv4"'>MIP4GREKEY</a>].
        This event completes the Proxy Mobile IPv4 signaling for initial
        network attachment.

   5.   After the Proxy Mobile IPv4 registration exchange, the AR
        provides the IP address to the mobile device in response to step
        2.  For IPCP, the NAS replies to the PPP client with an IPCP
        Configure-Nak, which includes the PMIPv4-assigned Home Address




<span class="grey">Leung, et al.                 Informational                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


        in the IP address configuration option and the DNS server
        address in the IPCP configuration option.

        The following procedure happens when the DHCP server is on the
        AR.  The DHCP server sends a DHCP Offer with the PMIPv4-assigned
        Home Address in the yiaddr field to the DHCP client.  The DHCP
        client sends a DHCP Request to the DHCP server, which replies
        with a DHCP Ack.  The host configuration (such as the DNS server
        address) is included in the DHCP options in the message.  Note
        that the DHCP messages are exchanged directly between the DHCP
        client and the DHCP server.

        In the case when AR acts as a DHCP relay agent, the DHCP
        Discover is relayed to the DHCP server on the HA.  The DHCP
        server sends a DHCP Offer with the PMIPv4-assigned Home Address
        in the yiaddr field to the DHCP relay agent, which forwards it
        to the DHCP client.  The DHCP Request and DHCP Ack messages are
        exchanged between the DHCP client and DHCP server via the DHCP
        relay agent.  Regardless of the sequence of PMIPv4 signaling and
        DHCP exchanges, the interaction between PMIPv4 and DHCP involves
        in the same IP address for Home Address field and yiaddr field,
        respectively.

   6.   At this step, the mobile device's IP stack is configured with an
        IP address that has a forwarding path between the AR/PMA and HA.
        Also, the host configuration (such as DNS servers) is configured
        at this time.  Now that the IPCP or DHCP procedure has
        completed, the mobile device is ready to receive or send IP
        packets.  If DHCP is used, the DHCP client renews the IP address
        by sending a DHCP Request directly to the DHCP server.  The
        lease for the IP address is extended when a DHCP Ack from the
        DHCP server is received by the DHCP client.



















<span class="grey">Leung, et al.                 Informational                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.2.%20%20Proxy%20Registration%20Renewal"></a><a class="selflink" href="#section-4.1.2" name="section-4.1.2">4.1.2</a>.  Proxy Registration Renewal</span>

                    +----+        +-------+                  +-----+
                    |    |        | AR /  |                  |     |
                    | MN |        | PMA   |                  |  HA |
                    |    |        |       |                  |     |
                    +----+        +-------+                  +-----+
                       |               |                        |
                       |               |       1                |
                       |               |-----------------------&gt;|
     PMIPv4            |               |                        |
     Renewal           |               |       2                |
                       |               |&lt;-----------------------|
                       |               |                        |
                       |               |                        |

                 Figure 2: Network Connection Maintenance

   The network-connection maintenance procedure is described below.  As
   long as the mobile device remains attached to the AR, the Proxy
   Mobile IPv4 session is maintained by re-registration exchanges
   between the AR and HA.

   1.  Before the PMIPv4 registration lifetime expires, and assuming the
       AR has not received any indication that the mobile device
       detached from the network, the PMA sends a PRRQ to the HA to
       extend the duration of the mobility binding of the mobile device.
       This PRRQ is similar to the initial PRRQ (i.e., HA field set to
       the assigned HA, and CoA field set to the PMA), though the Home
       Address field is always set to the assigned IP address of the
       mobile device.  The mobile device's IP stack can continue to send
       and receive IP packets using the Home Address anchored at the HA.

   2.  The HA sends the PRRP in response to the PRRQ received from the
       PMA.  After the PMA processes the PRRP, the forwarding path
       between AR and HA remains intact.















<span class="grey">Leung, et al.                 Informational                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.3.%20%20Proxy%20Handover%20Support"></a><a class="selflink" href="#section-4.1.3" name="section-4.1.3">4.1.3</a>.  Proxy Handover Support</span>

                    +----+        +-------+      +-------+      +-----+
                    |    |        | New   |      |  Old  |      |     |
                    | MN |        | AR /  |      |  AR / |      |  HA |
                    |    |        | PMA   |      |  PMA  |      |     |
                    +----+        +-------+      +-------+      +-----+
                       |               |             |             |
                       |     1         |             |             |
     Authentication    |&lt;-------------&gt;|             |             |
                       |               |             |             |
                       |               |       2     |             |
                  +-&gt;  |               |--------------------------&gt;|
     PMIPv4       |    |               |             |             |
                  |    |               |       3     |             |
                  +-&gt;  |               |&lt;--------------------------|
                       |               |             |             |
                       |     4         |             |             |
     Data Forwarding   |&lt;-------------&gt;|&lt;=========================&gt;|
                       |               |             |             |

                           Figure 3: AR Handover

   The AR handover procedure is described below.  There are three
   phases.  First, authentication and authorization happen when the
   mobile device attaches to the new AR in the network.  The successful
   authentication triggers the Proxy Mobile IPv4 signaling.  In the last
   phase, the forwarding path between the new AR and HA is set up for
   the mobile device to send and receive IP packets using the same Home
   Address anchored at the HA.

   1.  The mobile device establishes L2 link with the base station (not
       shown) and performs access authentication/authorization with the
       new AR, using the security method for network re-attachment.

   2.  Triggered by successful authentication, the PMA sends a PRRQ to
       the HA.  The HA's IP address is typically obtained or is known by
       the method used for fast re-authentication during AR handover
       (e.g., context transfer between the two ARs), though other
       methods may be used.  The PRRQ contains the CoA of the new PMA.
       The Home Address field is set to zero or the assigned IP address
       of the mobile device.  The IP address is also obtained/known by
       the same method mentioned before.

   3.  The Home Agent updates the existing mobility binding entry for
       the mobile device upon processing the PRRQ.  The Home Agent
       returns the Home Address, fetched from the binding, in the PRRP
       to the new PMA.  After the PMA processes the PRRP, the forwarding



<span class="grey">Leung, et al.                 Informational                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


       path for the Home Address between the new AR and HA is
       established.  The event completes the Proxy Mobile IPv4 signaling
       for AR handover.

   4.  At this step, which happens around the same time as step 2, the
       mobile device's IP stack may detect L2 link going down and up
       after access re-authentication.  The mobile device's IP stack may
       attempt to validate its IP address connectivity.  See Sections
       6.1, 6.2, and 6.3 of this document for considerations on ARP
       [<a href="#ref-RFCARP" title='"Ethernet Address Resolution Protocol: Or Converting Network Protocol Addresses to 48.bit Ethernet Address for Transmission on Ethernet Hardware"'>RFCARP</a>], ICMP [<a href="#ref-RFCICMP" title='"Internet Control Message Protocol"'>RFCICMP</a>], and DHCP [<a href="rfc2131.html" title='"Dynamic Host Configuration Protocol"'>RFC2131</a>], respectively.
       Because the forwarding path is established between the new PMA
       and HA, the mobile device can receive or send IP packets using
       the Home Address.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.4.%20%20Resource%20Cleanup"></a><a class="selflink" href="#section-4.1.4" name="section-4.1.4">4.1.4</a>.  Resource Cleanup</span>

                    +----+        +-------+      +-------+      +-----+
                    |    |        | New   |      |  Old  |      |     |
                    | MN |        | AR /  |      |  AR / |      |  HA |
                    |    |        | PMA   |      |  PMA  |      |     |
                    +----+        +-------+      +-------+      +-----+
                       |               |             |             |
                       |               |             |      1      |
                  +-&gt;  |               |             |&lt;------------|
                  |    |               |             |             |
     Revocation   |    |               |             o 2           |
                  |    |               |             |             |
                  |    |               |             |      3      |
                  +-&gt;  |               |             |------------&gt;|
                       |               |             |             |

            Figure 4: Registration Revocation for Previous PMA

   The resource cleanup procedure for the old AR is described below.
   This cleanup is necessary when the old AR needs to delete its PMIPv4
   and other associated states for a mobile device that has moved to
   another AR.  Therefore, this is an optional procedure for Proxy
   Mobile IP.  The alternative method is based on the new PMA notifying
   the old PMA to clean up resources.  The alternative method is out of
   the scope of this document.

   1.  Triggered by the update of the mobility binding entry for a
       mobile device that has moved to a new AR, the HA may send a
       Registration Revocation (as specified in <a href="rfc3543.html">RFC 3543</a> [<a href="rfc3543.html" title='"Registration Revocation in Mobile IPv4"'>RFC3543</a>]) to
       the old PMA (i.e., specifically to the Foreign Agent entity) in
       order to clean up unused resources in an expeditious manner.





<span class="grey">Leung, et al.                 Informational                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


   2.  The old PMA removes the PMIPv4 states for the mobile device.

   3.  The old PMA sends revocation acknowledgement to the HA.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Establishment%20of%20a%20Bi-Directional%20Tunnel"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Establishment of a Bi-Directional Tunnel</span>

   The PMA and HA set up a tunnel between them for the Home Address
   after the PMIPv4 registration message exchange.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.1.%20%20Packet%20Forwarding"></a><a class="selflink" href="#section-4.2.1" name="section-4.2.1">4.2.1</a>.  Packet Forwarding</span>

   The bi-directional tunnel between the PMA and the HA allows packets
   to flow in both directions, while the mobile device is connected on
   the visited network.  All traffic to and from the mobile device
   travels through this tunnel.

   While the PMA is serving a mobile device, it MUST be able to
   intercept all packets sent from the mobile device and forward them
   out the tunnel created for supporting that mobile device.  Typically,
   forwarding is based on layer 2 information such as the source Media
   Access Control (MAC) address or ingress interface.  This allows
   overlapping IP addresses to be supported for the packet from the
   mobile device.  For example, the PMA forwards packets from mobile
   devices with the same IP address to the tunnel associated with each
   mobile device, based on the source MAC address.

   The PMA de-encapsulates any packets received on the tunnel from the
   HA before forwarding to the mobile device on its link.  Typically,
   the forwarding is based on the destination IP address and ingress HA
   tunnel (which may have a GRE key).  This allows overlapping IP
   addresses to be supported for the packet destined to the mobile
   device.  For example, the PMA forwards packets to mobile devices with
   the same IP address to the link associated with each mobile device,
   based on the GRE key value of the tunnel created for the HA that
   serves these mobile devices.

   The tunnel operation between the PMA and HA is the same as between
   the FA and HA in <a href="rfc3344.html">RFC 3344</a>.  The IP TTL (Time to Live), fragmentation,
   re-assembly, etc. logic remain the same.  The tunnel mode is IPinIP
   by default or GRE as an option.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.2.%20%20Broadcast%20and%20Multicast"></a><a class="selflink" href="#section-4.2.2" name="section-4.2.2">4.2.2</a>.  Broadcast and Multicast</span>

   Broadcast packet processing for DHCP and ARP (Address Resolution
   Protocol) messages are described in <a href="#section-6.3">Section 6.3</a> and <a href="#section-6.1">Section 6.1</a>,
   respectively.  For other types of broadcast packets, the PMA and HA





<span class="grey">Leung, et al.                 Informational                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


   process them in accordance to [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>], [<a href="rfc3024.html" title='"Reverse Tunneling for Mobile IP, revised"'>RFC3024</a>], and [<a href="#ref-MIP4MCBC" title='"IPv4 Mobility extension for Multicast and Broadcast Packets"'>MIP4MCBC</a>].
   Only the Direct Encapsulation Delivery Style is supported, as there
   is no encapsulation for the packets between the mobile device and
   PMA.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.3.%20%20Forwarding%20between%20Devices%20on%20the%20Same%20PMA"></a><a class="selflink" href="#section-4.2.3" name="section-4.2.3">4.2.3</a>.  Forwarding between Devices on the Same PMA</span>

   When the communication peers are both attached to the same PMA, the
   packet is forwarded as specified in <a href="#section-4.2.1">Section 4.2.1</a>.  The traffic
   between them should be routed via the HA without taking a local
   shortcut on the PMA.  This ensures that data-traffic enforcement at
   the HA is not bypassed.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Security%20Association%20between%20the%20PMA%20and%20the%20HA"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Security Association between the PMA and the HA</span>

   The security relationship for protecting the control message
   exchanges between the PMA and the HA may be either per node (i.e.,
   same security association for all mobile devices) or per MN (i.e.,
   unique security association per mobile device).  The method of
   obtaining the security association is outside the scope of this
   document.

   For per-node SA support, the FA-HA Authentication extension or IPsec
   (indicated in the PMIPv4 extension) is used to authenticate the
   signaling messages (including Registration Revocation [<a href="rfc3543.html" title='"Registration Revocation in Mobile IPv4"'>RFC3543</a>])
   between PMA and HA.  In the case of IPsec, Encapsulating Security
   Payload (ESP) [<a href="rfc4303.html" title='"IP Encapsulating Security Payload (ESP)"'>RFC4303</a>] in transport mode with mandatory integrity
   protection should be used.  The IPsec endpoints are the IP addresses
   of the PMA and HA.

   For per-MN SA support, the MN-HA Authentication extension and/or MN-
   AAA Authentication extension are used to authenticate the signaling.

   The creation of the security association may be assisted by the AAA
   server at the time of access authentication.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.4.%20%20Registration%20Sequencing"></a><a class="selflink" href="#section-4.4" name="section-4.4">4.4</a>.  Registration Sequencing</span>

   The Identification field in the registration message provides replay
   protection and sequencing when the timestamp method is used.  This
   mechanism allows the HA to know the sequence of messages from the
   same PMA or different PMAs based on the Identification field.  The HA
   can also synchronize the PMA's clock by using the Identification
   mismatch error code in the Proxy Registration Reply.  This reply
   message would not be necessary when the PMA's clocks are synchronized
   using the Network Time Protocol [<a href="rfc1305.html" title='"Network Time Protocol (Version 3) Specification, Implementation and Analysis"'>RFC1305</a>] or some other method.  Note
   that the use of nonce for sequencing and replay protection is outside
   the scope of this document.



<span class="grey">Leung, et al.                 Informational                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


   The method above is sufficient when there is a single source for
   signaling as in the split PMA case.  However, in the integrated PMA
   case, the Proxy Registration Request is sent from different sources
   (i.e., different PMAs).  If the previous PMA is unaware that the
   mobile device has moved away and continues to send re-registration,
   then the HA would be misinformed on the location of the device.
   Therefore, an integrated PMA MUST confirm that the mobile device is
   still attached before sending a Proxy Registration Request.

   Note that, for the split PMA model as used in WiMAX Forum (see
   <a href="#section-10">Section 10</a>), the PMIPv4 client remains anchored during handover (see
   <a href="#section-10.1">Section 10.1</a>).  In this case, the PMIPv4 client is the only source of
   the PRRQ.  However, there are cases (such as PMIPv4 client relocation
   and uncontrolled handover events) when more than one PMA performs
   registration.  The same method for the integrated PMA is used to
   ensure proper sequencing of registration on the HA.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.5.%20%20Mobile%20Device%20Interface%20Configuration"></a><a class="selflink" href="#section-4.5" name="section-4.5">4.5</a>.  Mobile Device Interface Configuration</span>

   Typically, the mobile device's interface needs to be configured with
   an IP address, network prefix, default gateway, and DNS server
   addresses before the network connection can be enabled to be used for
   communication.  For some IP stacks, the default gateway IP address
   has to be on the same subnet as the mobile device's IP address.  When
   the Home Agent's IP address is not on the same subnet as the Home
   Address, vendor-specific extensions (e.g., [<a href="rfc4332.html" title="&quot;Cisco's Mobile IPv4 Host Configuration Extensions&quot;">RFC4332</a>]) or other
   methods MAY be used by the PMA to obtain the default gateway.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.6.%20%20Dynamic%20HA%20Discovery"></a><a class="selflink" href="#section-4.6" name="section-4.6">4.6</a>.  Dynamic HA Discovery</span>

   The PMA can perform dynamic HA discovery by sending the registration
   with Home Agent field set to 0.0.0.0 or 255.255.255.255.  The Home
   Agent responds with its IP address in the Home Agent field as
   specified in "Mobile IPv4 Dynamic Home Agent (HA) Assignment"
   [<a href="rfc4433.html" title='"Mobile IPv4 Dynamic Home Agent (HA) Assignment"'>RFC4433</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Proxy%20Mobile%20IPv4%20Extensions"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Proxy Mobile IPv4 Extensions</span>

   The following PMIPv4 extensions are not required for base
   functionality but may be used in some cases where such features are
   applicable.  They are included before the authentication extension
   (e.g., MN-HA or FA-HA Authentication extension) in the registration
   message.








<span class="grey">Leung, et al.                 Informational                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20PMIPv4%20Per-Node%20Authentication%20Method%20Extension"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  PMIPv4 Per-Node Authentication Method Extension</span>

   The Proxy Mobile IPv4 Authentication Method extension indicates
   alternative methods for authenticating the registration besides the
   default MN-HA Authentication extension as specified in <a href="rfc3344.html">RFC 3344</a>.
   This extension MUST be included in the Registration Request and
   Registration Reply when the security association for authenticating
   the message is between the PMA and HA on a per-node basis.  This
   means that a common key or set of keys (indexed by the SPI) are used
   for message authentication by the PMA and HA.  The key is independent
   of the mobile device, which is identified in the registration.

      0               1               2               3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |   Sub-Type    |             Length            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Method     |
     +-+-+-+-+-+-+-+-+

              PMIPv4 Per-Node Authentication Method Extension

      Type

         47 (Proxy Mobile IPv4 Non-Skippable Extension)

      Sub-Type

         1 (PMIPv4 Per-Node Authentication Method)

      Length

         1

      Method

         An 8-bit field that specifies the authentication type for
         protecting the signaling messages.

         The values (0 - 255) are allocated and managed by IANA.  The
         following values have been assigned to the specified method
         types.

         0: Reserved

         1: FA-HA Authentication

         2: IPsec Authentication



<span class="grey">Leung, et al.                 Informational                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Proxy%20Mobile%20IPv4%20Interface%20ID%20Extension"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Proxy Mobile IPv4 Interface ID Extension</span>

   The Proxy Mobile IPv4 Interface ID extension identifies the interface
   address of the device used to attach to the network.  The information
   MAY be included in the Registration Request when the PMA is aware of
   it.

     0               1               2               3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     Type      |   Length      | Sub-Type      | Identifier ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                       PMIPv4 Interface ID Extension

      Type

         147 (Proxy Mobile IPv4 Skippable Extension)

      Length

         The length of the extension in octets, excluding Type and
         Length fields.

      Sub-Type

         1 (PMIPv4 Interface ID)

      Identifier

         A variable-length octet sequence that contains an identifier of
         the interface.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Proxy%20Mobile%20IPv4%20Device%20ID%20Extension"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Proxy Mobile IPv4 Device ID Extension</span>

   The Proxy Mobile IPv4 Device ID extension identifies the device used
   to connect to the network.  The information MAY be included in the
   Registration Request when the PMA is aware of it.

     0               1               2               3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     Type      |   Length      | Sub-Type      |    ID-Type    |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                           Identifier ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                        PMIPv4 Device ID Extension



<span class="grey">Leung, et al.                 Informational                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


      Type

         147 (Proxy Mobile IPv4 Skippable Extension)

      Length

         The length of the extension in octets, excluding Type and
         Length fields.

      Sub-Type

         2 (PMIPv4 Device ID)

      ID-Type

         An 8-bit field that specifies the device ID type.

         The values (0 - 255) are allocated and managed by IANA.  The
         following values have been assigned to the specified device ID
         types.

         0: Reserved

         1: Ethernet MAC address

         2: Mobile Equipment Identifier (MEID)

         3: International Mobile Equipment Identity (IMEI)

         4: Electronic Serial Number (ESN)

      Identifier

         A variable-length octet sequence that contains an identifier of
         the type indicated by the ID-Type field.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20Proxy%20Mobile%20IPv4%20Subscriber%20ID%20Extension"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  Proxy Mobile IPv4 Subscriber ID Extension</span>

   The Proxy Mobile IPv4 Subscriber ID extension identifies the mobile
   subscription.  The information MAY be included in the Registration
   Request when the PMA is aware of it.










<span class="grey">Leung, et al.                 Informational                    [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


     0               1               2               3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     Type      |   Length      | Sub-Type      |    ID-Type    |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                           Identifier ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                      PMIPv4 Subscriber ID Extension

      Type

         147 (Proxy Mobile IPv4 Skippable Extension)

      Length

         The length of the extension in octets, excluding Type and
         Length fields.

      Sub-Type

         3 (PMIPv4 Subscriber ID)

      ID-Type

         An 8-bit field that specifies the subscriber ID type.

         The values (0 - 255) are allocated and managed by IANA.  The
         following values have been assigned to the specified subscriber
         ID types.

         0: Reserved

         1: International Mobile Subscriber Identity (IMSI)

      Identifier

         A variable-length octet sequence that contains an identifier of
         the type indicated by the ID-Type field.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.5.%20%20PMIPv4%20Access%20Technology%20Type%20Extension"></a><a class="selflink" href="#section-5.5" name="section-5.5">5.5</a>.  PMIPv4 Access Technology Type Extension</span>

   The Proxy Mobile IPv4 Access Technology Type extension indicates the
   type of radio-access technology on which the mobile device is
   attached.  This extension MAY be included in the Registration Request
   when the PMA is aware of the information.  The HA can provide
   mobility on the same access technology type for a mobile device with




<span class="grey">Leung, et al.                 Informational                    [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


   multiple interfaces, assuming each interface is connected on a
   different access technology type.  The HA does not include the
   extension in the associated Registration Reply.

     0               1               2               3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     Type      |   Length      | Sub-Type      |   Tech-Type   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                  PMIPv4 Access Technology Type Extension

      Type

         147 (Proxy Mobile IPv4 Skippable Extension)

      Length

         2

      Sub-Type

         4 (Access Technology Type)

      Tech-Type

         An 8-bit field that specifies the access technology through
         which the mobile device is connected to the access network.

         The values (0 - 255) are allocated and managed by IANA.  The
         following values have been assigned to the specified access
         technology types.

         0: Reserved

         1: 802.3

         2: 802.11a/b/g

         3: 802.16e

         4: 802.16m

         5: 3GPP EUTRAN/LTE

         6: 3GPP UTRAN/GERAN





<span class="grey">Leung, et al.                 Informational                    [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


         7: 3GPP2 1xRTT/HRPD

         8: 3GPP2 UMB

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Appearance%20of%20Being%20at%20Home%20Network"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Appearance of Being at Home Network</span>

   Since the Mobile Node is not aware of its mobility and does not
   participate in handover signaling, the network entities emulate the
   home network to the mobile device attached on the network.  From the
   mobile device's perspective, it operates as if it were at the home
   network.  However, the network is directing the mobile device's
   traffic to and from its current location and will continue to do so
   when it moves to a new location.

   An unmodified mobile device on a shared link learns the MAC address
   of another host on the home network via ARP ([<a href="#ref-RFCARP" title='"Ethernet Address Resolution Protocol: Or Converting Network Protocol Addresses to 48.bit Ethernet Address for Transmission on Ethernet Hardware"'>RFCARP</a>]), obtains an IP
   address and other host configuration via DHCP ([<a href="rfc2131.html" title='"Dynamic Host Configuration Protocol"'>RFC2131</a>]), and sends
   link-local multicast and broadcast packets.  The network's response
   to the host is equivalent to the situation when a host is on the home
   network.  When the link state changes, some hosts use ARP, ICMP,
   and/or DHCP to detect if it has changed the point of attachment on
   the network.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20ARP%20Considerations"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  ARP Considerations</span>

   For IEEE 802 type of access networks (e.g., WLAN, WiMAX Ethernet
   Convergence Sublayer), the mobile device sends ARP requests for the
   Corresponding Node (CN) and default gateway on the same network.  The
   purpose of maintaining an ARP entry is to allow the delivery of the
   packet from the mobile device to the CN using the destination MAC
   address.  The ARP procedure for resolving IP and MAC address mapping
   is not needed for 3GPP2's cdma2000 and WiMAX IP Convergence Sublayer
   networks.

   The access router is always the L2 endpoint for the mobile device.
   The destination MAC address in the packet does not need to be set to
   the CN's MAC address.  As long as the packet can be received by the
   access router, it will be forwarded toward the CN via the home
   network node (further details in <a href="#section-4.2.1">Section 4.2.1</a>).  The ARP table in
   the mobile device does not need to be populated with CNs' MAC
   addresses in order for the packet to reach the CNs.

   A mobile device has ARP entries for the default gateway and hosts on
   the same subnet.  Regardless of what the MAC addresses are, the AR
   receives the packets sent from the mobile device.






<span class="grey">Leung, et al.                 Informational                    [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20ICMP%20Considerations"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  ICMP Considerations</span>

   For movement detection, certain types of network stack on the mobile
   device will send an ICMP request [<a href="#ref-RFCICMP" title='"Internet Control Message Protocol"'>RFCICMP</a>] to the default gateway
   after detecting the link went down and up.  The IP TTL in the message
   is set to 1 to check if the default gateway is still directly
   reachable on the access network.  The PMA MAY send an ICMP reply when
   it is providing Proxy Mobile IPv4 service for the mobile device.
   This response confirms to the mobile device that it has remained on
   the home network after link state change.  This behavior is observed
   on existing client implementation.  "Detecting Network Attachment in
   IPv4 (DNAv4)" [<a href="rfc4436.html" title='"Detecting Network Attachment in IPv4 (DNAv4)"'>RFC4436</a>] can be employed.

   General ICMP traffic is handled as normal IP packets and tunneled
   between the PMA and HA.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20DHCP%20Considerations"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  DHCP Considerations</span>

   DHCP [<a href="rfc2131.html" title='"Dynamic Host Configuration Protocol"'>RFC2131</a>] is used to obtain an IP address and other host
   configuration parameters for a mobile device.  The mobile device is
   expected to behave as a normal DHCP client when connected to the
   network with Proxy Mobile IPv4 service.  There are two DHCP phases:
   bootup and renewal/release.  The bootup procedure relies on the DHCP
   relay agent to obtain a lease on the IP address for the DHCP client
   from the DHCP server.  The DHCP client directly renews and releases
   the lease with the DHCP server.

   In Proxy Mobile IPv4, the mobile device boots up on a network that is
   not the home network associated with the leased IP address.  Also,
   the mobile device can move to other networks that are not related to
   that IP address.  Yet, the DHCP client on the mobile device continues
   to operate as a stationary device that is directly on the network
   associated with its IP address.  The PMA and HA create the
   transparency of the remote home network and mobility events by
   providing the expected network response to the DHCP client.

   There are several methods for the network infrastructure to interface
   with the mobile device such that the mobile device believes it is
   always fixed on the same network.  The following methods are
   identified here, though others may be used as well.

   DHCP Server in the AR:

      The mobile device boots up and initiates DHCP.  The procedure is
      described in Figure 1.  The DHCP client renews or releases the IP
      address directly with the DHCP server in the AR.  When the mobile
      device is on a different AR than the AR/DHCP server, the DHCP
      message from the client needs to be able to either be forwarded to



<span class="grey">Leung, et al.                 Informational                    [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


      the DHCP server in the previous AR or handled by the DHCP server
      in the new AR.  When the DHCP lease time expires for the mobile
      device's IP address or the DHCP release message is received on the
      current AR, the AR sends PMIPv4 de-registration to the HA.

   DHCP Relay Agent in the AR:

      The mobile device boots up and initiates DHCP.  The procedure is
      described in Figure 1.  The DHCP client renews or releases the IP
      address directly with the DHCP server in the HA.  When the mobile
      device is on a different AR, DHCP messages from the client are
      relayed to the DHCP server in the HA.  When the DHCP lease time
      expires for the mobile device's IP address or the DHCP release
      message is received on the HA, the HA deletes the mobility binding
      entry for the mobile device and sends registration revocation
      [<a href="rfc3543.html" title='"Registration Revocation in Mobile IPv4"'>RFC3543</a>] to the AR.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.4.%20%20PPP%20IPCP%20Considerations"></a><a class="selflink" href="#section-6.4" name="section-6.4">6.4</a>.  PPP IPCP Considerations</span>

   When the mobile device accesses the network via PPP [<a href="rfc1661.html" title='"The Point-to-Point Protocol (PPP)"'>RFC1661</a>], LCP
   (Link Control Protocol) CHAP is used to authenticate the user.  After
   authentication, the NAS (which is the AR/PMA) sends the Proxy Mobile
   IPv4 Registration Request to the HA.  The HA responds with the Home
   Address in the Proxy Registration Reply.  The NAS informs the mobile
   device to use the Home Address during IPCP [<a href="rfc1332.html" title='"The PPP Internet Protocol Control Protocol (IPCP)"'>RFC1332</a>].  When the
   mobile device moves to a new NAS, the same procedure happens and that
   mobile device has the same IP address for communication.

   The message exchange is illustrated in Figure 1.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.5.%20%20Link-Local%20Multicast%20and%20Broadcast%20Considerations"></a><a class="selflink" href="#section-6.5" name="section-6.5">6.5</a>.  Link-Local Multicast and Broadcast Considerations</span>

   Depending on configuration policies, the PMA may tunnel all packets
   destined to Link-Local Multicast or Broadcast to the HA.  The HA
   looks up the hosts that are in the same subnet and sends a duplicated
   packet to each of them.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Proxy%20Mobility%20Agent%20Operation"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Proxy Mobility Agent Operation</span>

   The PMA performs the functions of a Mobile Node entity as described
   in <a href="rfc3344.html">RFC 3344</a>, with the exceptions identified below.

   -  No agent discovery (i.e., agent solicitation and advertisement) is
      supported.

   -  The D-bit (De-encapsulation by MN) in the Registration Request is
      always set to zero.




<span class="grey">Leung, et al.                 Informational                    [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


   The main responsibility of the PMA is to set up and maintain the
   routing path between itself and the HA for a mobile device that is
   attached on the network.  When it detects a mobile device is no
   longer attached, the routing path is torn down.  It is possible that
   the PMA functions may be split up in implementations such as WiMAX
   (<a href="#section-10">Section 10</a>).

   The PMA needs to know the following information, at a minimum, for
   sending a proxy registration:

   1.  NAI of the mobile device.

   2.  MN-HA security association, when per-mobile device security
       association is used.

   3.  FA-HA Mobility security association or IPsec security association
       when per-node security association is used.  Note that these
       associations are specific only between PMA and HA, and are
       cryptographically unrelated to the associations between the MN
       and other network nodes.

   4.  HA Address.

   This information is typically downloaded from the AAA server during
   access authentication.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Home%20Agent%20Operation"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Home Agent Operation</span>

   The Home Agent has the functionality described in <a href="rfc3344.html">RFC 3344</a> [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>].
   In addition, the following features are introduced by Proxy Mobile
   IPv4:

   1.  Sequencing between PRRQs from multiple PMAs.  For the integrated
       PMA case, there is a period after handover that may result in
       both the new PMA and old PMA sending PRRQs.  It is imperative
       that the old PMA confirm that the mobile device is attached
       before sending a PRRQ when the re-registration timer expires.
       This would ensure that the HA only receives registration from the
       PMA that is serving the mobile device.

   2.  Authentication of PRRQs based on per-node security associations
       (FA-HA AE or IPsec AH/ESP) is applicable in the integrated PMA
       case.  The presence of MN-HA AE or MN-AAA AE in the PRRQ is not
       necessary in this case.  Since PMIPv4 is based on signaling
       between the PMA and the HA, the security for the message can be
       authenticated based on the peers' relationship.  The HA can
       authorize PMIPv4 service for the mobile device at the PMA by
       contacting the AAA server.



<span class="grey">Leung, et al.                 Informational                    [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


   3.  The ability to process the Proxy Mobile IPv4 extensions defined
       in this document for enhanced capabilities of PMIPv4.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Processing%20Proxy%20Registration%20Requests"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Processing Proxy Registration Requests</span>

   When a Proxy Registration Request is received, the HA looks up the
   mobility binding entry indexed by the NAI.  If the entry exists, HA
   compares the sequence numbers between the message and mobility
   binding entry (MBE), if present.  If the value in the message is zero
   or greater than or equal to the one in the MBE, HA accepts the
   registration.  The HA replies with a sequence number that is one
   greater than the larger value of either the MBE or Proxy Registration
   Request.  If the registration is denied, then HA sends error code
   "Administratively prohibited (65)".  If the HA is not enabled with
   Proxy Mobile IPv4 or cannot process the Proxy Mobile IPv4 Extensions
   defined in this document, it sends a Registration Reply with error
   code PMIP_UNSUPPORTED ("Proxy Registration not supported by the HA").
   In the case when the PMA is not allowed to send a Proxy Registration
   Request to the HA, the HA sends a Proxy Registration Reply with error
   code PMIP_DISALLOWED ("Proxy Registrations from this PMA are not
   allowed").

   A PMA receiving these error codes SHOULD NOT retry sending Proxy
   Mobile IPv4 messages to the HA that sent replies with these error
   codes.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Mobile%20Device%20Operation"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Mobile Device Operation</span>

   As per this specification, a mobile device would function as a normal
   IPv4 host.  The required behavior of the node will be consistent with
   the base IPv4 specification [<a href="https://tools.ietf.org/html/rfc0791" title='"Internet Protocol"'>RFC0791</a>].  The mobile station will have
   the ability to retain its IPv4 address as it moves from one point of
   network attachment to the other without ever requiring it to
   participate in any mobility-related signaling.

   When booting up for the first time, a mobile device obtains an IPv4
   address using DHCP or IPCP.

   As the mobile device roams, it is always able to communicate using
   the obtained IP address on the home network.  The PMA on the
   currently attached network signals to the HA to ensure a proper
   forwarding path for the mobile device's traffic.









<span class="grey">Leung, et al.                 Informational                    [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20Initial%20Network%20Access"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  Initial Network Access</span>

   When the mobile device accesses the network for the first time and
   attaches to a network on the PMA, it will present its identity in the
   form of an NAI to the network as part of the network-access
   authentication process.

   Once the address configuration is complete, the mobile device will
   always be able to use that IP address anywhere in the network.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20Mobile%20Device%20Mobility"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  Mobile Device Mobility</span>

   When a mobile device moves to a new PMA from another PMA, the
   following occurs:

   The mobile device may perform a network-access authentication with
   the new AR/PMA.  If the authentication fails, the mobile device will
   not be able to use the link.  After a successful authentication, the
   new PMA will have the identifier and the other profile data of the
   mobile device.  The new PMA can also obtain the mobile device's
   information using a context-transfer mechanism, which is out of the
   scope of this document.

   Once the network-access authentication process is complete, the
   mobile device may sense a change in the Link Layer and use ARP, DHCP,
   and/or ICMP to detect if it is still on the same subnet.  These
   mechanisms are handled by the network as described in "Appearance of
   Being At Home Network" (<a href="#section-6">Section 6</a>).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.3.%20%20Sending%20and%20Receiving%20Packets"></a><a class="selflink" href="#section-9.3" name="section-9.3">9.3</a>.  Sending and Receiving Packets</span>

   All packets that are to be sent from the mobile device to the
   Corresponding Node (CN) will be sent as normal IPv4 packets, setting
   the Source Address of the IPv4 header to the Home Address and the
   Destination Address to the Corresponding Node's IP address.  In Proxy
   Mobile IPv4 operation, the default gateway for the mobile device is
   set up to reach the PMA.

   Similarly, all packets sent to the mobile device's IP address by the
   Corresponding Node will be received by the mobile device in the
   original form (without any tunneling overhead).

   For Proxy Mobile IP, the packet from the mobile device is transported
   to the HA to reach the destination, regardless of the destination IP
   address.  For a CN with an IP address on the same network as the
   mobile device but that is physically located elsewhere, the HA will
   tunnel the packet to the CN.  Otherwise, the HA forwards the traffic
   via normal routing.



<span class="grey">Leung, et al.                 Informational                    [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


   No special operation is required by the mobile device to either send
   or receive packets.

   Mobile devices attached to the same PMA may be using different HAs
   for transporting their traffic.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Proxy%20Mobile%20IPv4%20Use%20Case%20in%20WiMAX"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Proxy Mobile IPv4 Use Case in WiMAX</span>

   WiMAX Forum Network Working Group (NWG) uses the Proxy Mobile IPv4
   scheme to provide IPv4 connectivity and IP mobility.  The relevant
   specification from WiMAX Forum is [<a href="#ref-NWG" title='"WiMAX Forum Network Architecture (Stage 3: Detailed Protocols and Procedures)"'>NWG</a>].

   The Proxy Mobile IPv4 protocol is used over NWG reference point 3
   (R3).  Most of the Proxy Mobile IPv4 related procedures and
   requirements are described in reference to mobility management over
   R3.

   The Proxy Mobile IPv4 use case in the WiMAX Forum specification is
   illustrated in the following diagram:
































<span class="grey">Leung, et al.                 Informational                    [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


                                            |
                                            |            CSN
                                            |
                                            |
                     +-------+              |            +-------+
                     |       |              |            |       |
                     |AAAV   |--------------|------------| AAAH  |
                     |       |              |            |       |
                     |       |              |            |       |
                     +-------+              |            +-------+
                          |                 |                |
                          |                 |                |
                          |                 |                |
                  +------------------+      |                |
                  |   +-------+      |      |                |
                  |   | NAS   |      |      |                |
                  |   | PMIP  | ASN1 |      |                |
                  |   | Client|      |      |                |
                  |   +-------+      |      |                |
                  |       |          |      |                |
                  |       | R4       |      |                |
                  |   +-------+      |      |             +------+
         +----+   |   | FA,   |      |      |    PMIPv4   |      |
         | MN |-------| DHCP  |---------------------------|  HA  |
         +----+   |   | Relay/|      |      |     R3      |      |
                  |   | Server| ASN2 |      |             +------+
                  |   +-------+      |      |
                  |                  |      |
                  +------------------+
                     Split PMA

         Figure 5: WiMAX NWG Network Configuration for PMIPv4 Use

   As shown in the figure above, WiMAX NWG uses the split PMA model.
   The PMIPv4 client is collocated with the NAS in ASN1 (aka,
   Authenticator ASN).  The NWG architecture divides the network into
   two parts.  The Access part is termed the "Access Service Network"
   (ASN).  The Core part is termed the "Connectivity Service Network"
   (CSN).  The MN attaches to an 802.16 radio in the ASN2 (aka, Anchor
   Data Path Function).  The radio (base station) connects to the Anchor
   Data Path Function (A_DPF) in ASN2, which in turn connects to the
   Authenticator ASN (NAS) in ASN1.  ASN1 authenticates and authorizes
   the MN.  The AAA infrastructure is used to authenticate and authorize
   the MN.

   Note that, during initial network entry by the MN, the PMA can be an
   integrated PMA with all the functions collocated in ASN1.  Due to
   mobility, the FA part of the PMA may have to be relocated to a more



<span class="grey">Leung, et al.                 Informational                    [Page 29]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


   optimized location for better bearer management.  However, to
   describe the WiMAX specific use case for Proxy Mobile IPv4, we will
   use the split PMA model since it is a more generic representation of
   the WiMAX NWG mobility framework.

   The WiMAX NWG specification [<a href="#ref-NWG" title='"WiMAX Forum Network Architecture (Stage 3: Detailed Protocols and Procedures)"'>NWG</a>] defines a key bootstrapping scheme
   for use with Proxy Mobile IPv4.  The specification uses per-MN
   security association for Proxy Mobile IPv4 operation.  The relevant
   keys (e.g., MN-HA key) are derived using EAP authentication as
   specified in this document.  For more information, please refer to
   Section 4.3 of [<a href="#ref-NWG" title='"WiMAX Forum Network Architecture (Stage 3: Detailed Protocols and Procedures)"'>NWG</a>], stage-3 specification.

   Mobile IPv4 Registration Revocation is optionally supported in WiMAX.
   The security association for this is per node.  It is provided with
   FA-HA AE.  The FA-HA key is also bootstrapped via the same key
   hierarchy that is described in Section 4.3 of [<a href="#ref-NWG" title='"WiMAX Forum Network Architecture (Stage 3: Detailed Protocols and Procedures)"'>NWG</a>].

   The Proxy Mobile IPv4 operation in WiMAX NWG is aligned with the
   basic Proxy Mobile IPv4 operation as described in <a href="#section-4">Section 4</a> of this
   document.  There are specific considerations for WiMAX NWG 1.0.0 use
   of Proxy Mobile IPv4.  These are listed below:

   1.  Use of per-MS SA for Proxy Mobile IPv4 registration.  In this
       case, MN-HA AE is used.

   2.  Use of split PMA to handle FA relocation while the PMIPv4 client
       remains anchored with the NAS (Authenticator ASN).

   3.  Only the Proxy Mobile IPv4 Access Technology Type extension
       defined in this document is used in the NWG specification [<a href="#ref-NWG" title='"WiMAX Forum Network Architecture (Stage 3: Detailed Protocols and Procedures)"'>NWG</a>].

   4.  GRE key identifier is optionally used between the HA and the PMA.

   5.  The PMIPv4 client and the FA interact via the WiMAX specific
       reference point and protocol (aka, R4).  For more information,
       please refer to the NWG specification [<a href="#ref-NWG" title='"WiMAX Forum Network Architecture (Stage 3: Detailed Protocols and Procedures)"'>NWG</a>].

   6.  In order to handle inter-ASN (inter Access Router) handover and
       still allow the MN to use the same DHCP server's IP address that
       was sent in DHCPOFFER/ACK, the DHCP server (aka, proxy) functions
       in the ASN are required to be configured with the same IP
       address.

   7.  The MN - AR (trigger for Proxy Mobile IPv4) interaction is based
       on DHCP.  DHCPDISCOVER from the MN triggers the Proxy Mobile IPv4
       process in the ASN.





<span class="grey">Leung, et al.                 Informational                    [Page 30]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Proxy%20Mobile%20IPv4%20Call%20Flow%20Examples%20with%20Split%20PMA%20in%20WiMAX"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Proxy Mobile IPv4 Call Flow Examples with Split PMA in WiMAX</span>

   Since WiMAX uses the split PMA model, the call flows involve WiMAX
   proprietary signaling between the PMIPv4 client and FA within the
   PMA.  The following call flows illustrate this.

                     Split PMA
                     +-----------------------------------+
            +----+   | +------+     +------+     +-----+ |    +-----+
            |    |   | | NAS/ |     |  Old |     | New | |    |     |
            | MN |   | | PMIP |     |  FA  |     |  FA | |    | HA  |
            |    |   | |Client|     |      |     |     | |    |     |
            +----+   | +------+     +------+     +-----+ |    +-----+
               |     +----|------------|------------|----+       |
               |          |            |       PMIP Tunnel       |
               |          |            |&lt;=======================&gt;|
               |          |            |            |            |
               |          |            |  R4 tunnel |            |
               |          |            |&lt;==========&gt;|            |
               |          |       1    |            |            |
               |&lt;----------------------------------&gt;|            |
               |          |            |            |            |
               |          |            |     2      |            |
               |          |            |&lt;----------&gt;|            |
               |          |       3    |            |            |
               |          |&lt;----------------------- |            |
               |          |            |            |            |
               |          |       4    |            |            |
          +-&gt;  |          |------------------------&gt;|            |
          |    |          |            |            |     5      |
          |    |          |            |            |-----------&gt;|
          |    |          |            |            |            |
   PMIP   |    |          |            |            |     6      |
          |    |          |            |            |&lt;-----------|
          |    |          |            |            |            |
          |    |          |       7    |            |            |
          +-&gt;  |          |&lt;------------------------|            |
               |          |            |            |            |
               |          |            |     8      |            |
               |          |            |&lt;----------&gt;|            |
               |          |            |            |            |
               |     9    |            |            |PMIP Tunnel |
   Data        |&lt;----------------------------------&gt;|&lt;==========&gt;|
   Forwarding  |          |            |            |            |

        Figure 6: Proxy Handover Operation in WiMAX with Split PMA





<span class="grey">Leung, et al.                 Informational                    [Page 31]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


   In this scenario, the MN has moved to a new FA's area (known as the
   Data Path Function in WiMAX).  The old FA and the new FA interact
   with each other and also with the PMIPv4 client over a WiMAX-
   specified R4 reference point to perform the handover.  The steps are
   described below:

   1.  The mobile device establishes a L2 link with a base station (not
       shown), which connects to a new FA (aka, new Data Path Function
       in WiMAX).  Note that, in this case, the MN does not perform
       authentication and authorization.  The PMIPv4 tunnel remains
       between the old FA (aka, old Data Path Function in WiMAX).  The
       data flows through the PMIPv4 tunnel between the HA and the old
       FA, and through the WiMAX-specific R4 tunnel between the old FA
       and the new FA and from the new FA to the MN.

   2.  The new FA interacts with the old FA using a WiMAX-specific R4
       reference point to initiate the handover process.

   3.  The new FA uses the WiMAX-specific R4 reference point to request
       the PMIPv4 client to begin the PMIPv4 handover.

   4.  Triggered by step 3, the PMIPv4 client sends a PRRQ to the new
       FA.  The PRRQ contains the FA-CoA of the new FA.  The Home
       Address field is set to the address of the assigned IP address of
       the Mobile Node.  The PRRQ is embedded in the WiMAX-specific R4
       packet.

   5.  The new FA forwards the PRRQ to the HA.

   6.  The Home Agent updates the existing mobility binding entry for
       the mobile device upon processing the PRRQ.  The Home Agent
       responds back to the new FA with PRRP.

   7.  The new FA forwards the PRRP after encapsulating it in a WiMAX-
       specific R4 packet to the PMIPv4 client.

   8.  The new FA and the old FA exchange WiMAX-specific R4 messages
       between them to confirm the handover.  The old FA cleans up its
       resources for the MN.  The R4 bearer forwarding also stops at
       this point.

   9.  The forward and reverse direction traffic flows via the new FA.
       The handover is complete at this point.








<span class="grey">Leung, et al.                 Informational                    [Page 32]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20Proxy%20Mobile%20IPv4%20Use%20Case%20in%203GPP2"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  Proxy Mobile IPv4 Use Case in 3GPP2</span>

   3GPP2 uses the Proxy Mobile IPv4 scheme to provide mobility service
   for the following scenarios (as shown in the figures below):

   1.  Mobility between the base station (BS) and access gateway (AGW)

   2.  Mobility between the AGW and the Home Agent (HA).

   As shown in the diagrams below, in use case 1, the BS acts as the PMA
   and the AGW acts as the HA for Proxy Mobile IPv4 operation.  In use
   case 2, the AGW acts as the PMA while the HA assumes the role of the
   Home Agent.

                     RAN                            Core

                  +-------+                       +------+
      +----+      | BS/   |             PMIPv4    |      |
      | MN |------| PMA   |-----------------------| AGW/ |
      +----+      |       |                       |  HA  |
                  |       |                       +------+
                  +-------+

                Integrated PMA

      Figure 7: 3GPP2's PMIPv4 Use Case 1 - BS-AGW Interface Mobility

                     RAN                            Core

                  +-------+                       +------+
      +----+      | AGW/  |             PMIPv4    |      |
      | MN |------| PMA   |-----------------------|  HA  |
      +----+      |       |                       |      |
                  |       |                       +------+
                  +-------+

                Integrated PMA

      Figure 8: 3GPP2's PMIPv4 Use Case 2 - AGW-HA Interface Mobility

   The figure below shows a simplified 3GPP2 architecture.  For details,
   please refer to the 3GPP2 Converged Access Network (CAN) architecture
   ([<a href="#ref-3GPP2" title='"3GPP2 Basic IP Service for Converged Access Network"'>3GPP2</a>]).








<span class="grey">Leung, et al.                 Informational                    [Page 33]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-34" id="page-34" name="page-34"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


                           RAN                    Core
                 -----------^------------   -------^-------------
                |                        | |                     |
                V                        V V                     V

                  +------+            +------+           +-----+
      +----+      |      |  PMIPv4    |      |  PMIPv4   |     |
      | MN |------| BS   |------------| AGW  |-----------| HA  |
      +----+      |      |            |      |           |     |
                  +------+            +------+           +-----+

                  Figure 9: Simplified 3GPP2 Architecture

   The Proxy Mobile IPv4 usage scenario in 3GPP2 (case 1) is illustrated
   in the following diagram:

         +----+        +-------+      +-------+   +------+
         |    |        |       |      |       |   |      |
         | MN |        |  BS/  |      | HAAA  |   | AGW/ |
         |    |        |  PMA  |      |       |   | HA   |
         +----+        +-------+      +-------+   +------+
           |               |             |          |
           |     1a        |     1b      |          |
           |&lt;-------------&gt;|&lt;-----------&gt;|          |
           |               |             |          |
           |     2         |             |          |
           |--------------&gt;|             |          |
           |               |       3     |          |
           |               |-----------------------&gt;|
           |               |             |          |
           |               |       4     |          |
           |               |&lt;-----------------------|
           |     5         |             |          |
           |&lt;--------------|             |          |
           |               |             |          |
           |     6         |             |          |
           |&lt;======================================&gt;|
           |               |             |          |

             Figure 10: Network Connection Setup (use case 1)

   Description of the steps:

   1a.  MN performs layer 2 establishment with the BS/PMA and performs
        access authentication/authorization.  During this phase, the MN
        runs EAP over Ultra Mobile Broadband (UMB).  The BS acts as the
        NAS in this phase.




<span class="grey">Leung, et al.                 Informational                    [Page 34]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-35" id="page-35" name="page-35"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


   1b.  The BS exchanges AAA messages with the Home AAA server via the
        AR (not shown in the figure) to authenticate the MN.  As part of
        this step, the AR may download some information about the MN
        (e.g., user's profile, handset type, assigned Home Agent
        address, and other capabilities of the MN).  This information is
        passed to the PMA/BS (as necessary) to set up the PMIPv4 tunnel
        in the next step(s).

   2.   The MN sends layer 2 signaling messages to the BS/PMA to trigger
        the PMIPv4 tunnel setup process.

   3.   Triggered by step 2, the PMA/BS sends a PRRQ to the AGW/HA.  The
        HA's address is either received at step 1b from the Home AAA
        server (HAAA) or is discovered by other means.  The PRRQ
        contains the Care-of Address (CoA) of the PMA (collocated FA in
        this case).  The HoA field is set to all zeros (or all ones).
        The PRRQ is protected by the method described in this document.
        The derivation and distribution of the MN-HA or FA-HA key is
        outside the scope of this document.

   4.   The AGW/HA registers the MN's session, assigns a symmetric GRE
        key, and returns this key in the PRRP to the BS/PMA.

   5.   The BS/PMA responds back to the MN with a layer 2 signaling
        message.

   6.   At this step, the MN is assigned an IP address and is connected
        to the network (via the AGW).

   In use case 2, the same procedures are followed except the PMIPv4
   tunnel is established between the AGW and the HA.  In this case, GRE
   tunneling may not be used.



















<span class="grey">Leung, et al.                 Informational                    [Page 35]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-36" id="page-36" name="page-36"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.1.%20%20Handover%20Considerations%20in%203GPP2"></a><a class="selflink" href="#section-11.1" name="section-11.1">11.1</a>.  Handover Considerations in 3GPP2</span>

   There are some special handover considerations in 3GPP2's Proxy
   Mobile IPv4 use case.  Below is an illustration of the specific use
   case:

      +----+        +-------+      +-------+   +-------+
      |    |        |       |      |       |   |       |
      | MN |        | New   |      |  AGW/ |   | Old   |
      |    |        | PMA/BS|      |  HA   |   | PMA/BS|
      +----+        +-------+      +-------+   +-------+
        |               |              |          |
        |               |      1       |          |
        |               |-------------&gt;|          |
        |               |              |          |
        |               |              |          |
        |               |              o 2        |
        |               |              |          |
        |               |              |          |
        |               |      3       |          |
        |               |&lt;-------------|          |
        |               |              |          |
        |               |              |          |
        |               |         4    |          |
        |               |&lt;-----------------------&gt;|
        |               |              |          |
        |               |              |          |
        |               |              |          o  5
        |               |              |          |
        |               |              |          |

         Figure 11: 3GPP2 Registration Revocation for Previous PMA

   Description of the steps:

   1.  MN attaches to the new BS (L2 gets established).  There is an
       ongoing mobility binding entry (MBE) in the AGW for the MN.  The
       PMA in the new BS sends a PRRQ to the AGW.

   2.  The AGW receives a Proxy Registration Request for a Mobile Node
       and detects that it has an existing Mobility Binding Entry (MBE).
       The AGW validates the PRRQ from the new BS and updates the MBE
       for the MN.  The MBE is kept tentative at this point.

   3.  The AGW sends a Proxy Registration Reply to the new BS.  No
       Registration Revocation is used in the 3GPP2's use case.





<span class="grey">Leung, et al.                 Informational                    [Page 36]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-37" id="page-37" name="page-37"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


   4.  A 3GPP2's proprietary PMA movement notification message may be
       exchanged between the AGW and the old BS.

   5.  The MBE update with the new BS is committed at this step.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/12.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-12" name="section-12">12</a>.  IANA Considerations</span>

   This specification registers 47 for the Proxy Mobile IPv4
   Non-Skippable Extension and 147 for Proxy Mobile IPv4 Skippable
   Extension, both of which are described in <a href="#section-5">Section 5</a>.  The ranges for
   Mobile IPv4 [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>] extension types are defined at
   <a href="http://www.iana.org/">http://www.iana.org</a>.  This specification also creates a new subtype
   space for the type number of the extensions.  The subtype value 1 is
   defined for the PMIPv4 Non-Skippable Extension.  The subtype values 1
   to 4 are defined for the PMIPv4 Skippable Extension.  Similar to the
   procedures specified for Mobile IPv4 number spaces, future
   allocations from the number space require expert review [<a href="rfc5226.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC5226</a>].

   The PMIPv4 Per-Node Authentication Method extension defined in
   <a href="#section-5.1">Section 5.1</a> of this document, introduces a new authentication method
   numbering space, where the values from 0 to 2 have been assigned per
   this document.  Approval of new Access Technology type values are to
   be made through IANA Expert Review.

   The PMIPv4 Device ID extension defined in <a href="#section-5.3">Section 5.3</a> of this
   document, introduces a new ID type numbering space, where the values
   from 0 to 4 have been assigned per this document.  Approval of new
   Access Technology type values are to be made through IANA Expert
   Review.

   The PMIPv4 Subscriber ID extension defined in <a href="#section-5.4">Section 5.4</a> of this
   document, introduces a new ID type numbering space, where the values
   from 0 to 1 have been reserved by this document.  Approval of new
   Access Technology type values are to be made through IANA Expert
   Review.

   The PMIPv4 Access Technology Type extension defined in <a href="#section-5.5">Section 5.5</a> of
   this document, introduces a new technology type numbering space,
   where the values from 0 to 8 have been reserved by this document.
   Approval of new Access Technology type values are to be made through
   IANA Expert Review.










<span class="grey">Leung, et al.                 Informational                    [Page 37]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-38" id="page-38" name="page-38"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.1.%20%20Mobile%20IPv4%20Extension%20Types"></a><a class="selflink" href="#section-12.1" name="section-12.1">12.1</a>.  Mobile IPv4 Extension Types</span>

   This document introduces the following Mobile IP extension types.

   Name       : Proxy Mobile IPv4 Non-Skippable Extension
   Type Value : 47
   Section    : 5

   Name       : Proxy Mobile IPv4 Skippable Extension
   Type Value : 147
   Section    : 5

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.2.%20%20Mobile%20IPv4%20Error%20Codes"></a><a class="selflink" href="#section-12.2" name="section-12.2">12.2</a>.  Mobile IPv4 Error Codes</span>

   This document introduces the following error code that can be
   returned by the HA in a Proxy Registration Reply.

   Name                    Value    First referenced
   ----                    -----    ----------------
   PMIP_UNSUPPORTED         149     <a href="rfc5563.html#section-8.1">Section 8.1 of RFC 5563</a>
   PMIP_DISALLOWED          150     <a href="rfc5563.html#section-8.1">Section 8.1 of RFC 5563</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/13.%20%20Security%20Considerations"></a><a class="selflink" href="#section-13" name="section-13">13</a>.  Security Considerations</span>

   The functionality in this document is protected by the authentication
   extensions described in <a href="rfc3344.html">RFC 3344</a> [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>] or IPsec [<a href="rfc4301.html" title='"Security Architecture for the Internet Protocol"'>RFC4301</a>].  Each
   PMA needs to have an security association (e.g., MN-HA, FA-HA, IPsec
   AH/ESP) with the HA to register the MN's IP address.  The security
   association can be provisioned by the administrator or dynamically
   derived.  The dynamic key derivation and distribution for this scheme
   is outside the scope of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/14.%20%20Acknowledgements"></a><a class="selflink" href="#section-14" name="section-14">14</a>.  Acknowledgements</span>

   The authors would like to thank the following individuals for their
   review, comments, and suggestions to improve the content of this
   document.

   Shahab Sayeedi (Motorola), Alper Yegin (Samsung), Premec Domagoj
   (Siemens), Michael Hammer (Cisco), Jun Wang (Qualcomm), Jayshree
   Bharatia (Nortel), Semyon Mizikovsky (Alcatel-Lucent), Federico De
   Juan Huarte (Alcatel-Lucent), Paula Tjandra (Motorola), Alice Qinxia
   (Huawei), Howie Koh (Greenpacket), John Zhao (Huawei), Pete McCann
   (Motorola), and Sri Gundavelli (Cisco).







<span class="grey">Leung, et al.                 Informational                    [Page 38]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-39" id="page-39" name="page-39"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/15.%20%20References"></a><a class="selflink" href="#section-15" name="section-15">15</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.1.%20%20Normative%20References"></a><a class="selflink" href="#section-15.1" name="section-15.1">15.1</a>.  Normative References</span>

   [<a id="ref-3GPP2" name="ref-3GPP2">3GPP2</a>]      "3GPP2 Basic IP Service for Converged Access Network",
                X.S0054-100-0 Version 2.0, August 2008.

   [<a id="ref-NWG" name="ref-NWG">NWG</a>]        "WiMAX Forum Network Architecture (Stage 3: Detailed
                Protocols and Procedures)" Release 1, Version 1.2.3,
                July 2008.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]    Bradner, S., "Key words for use in RFCs to Indicate
                Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC2131" name="ref-RFC2131">RFC2131</a>]    Droms, R., "Dynamic Host Configuration Protocol", <a href="rfc2131.html">RFC</a>
                <a href="rfc2131.html">2131</a>, March 1997.

   [<a id="ref-RFC3024" name="ref-RFC3024">RFC3024</a>]    Montenegro, G., Ed., "Reverse Tunneling for Mobile IP,
                revised", <a href="rfc3024.html">RFC 3024</a>, January 2001.

   [<a id="ref-RFC3344" name="ref-RFC3344">RFC3344</a>]    Perkins, C., Ed., "IP Mobility Support for IPv4", <a href="rfc3344.html">RFC</a>
                <a href="rfc3344.html">3344</a>, August 2002.

   [<a id="ref-RFC3543" name="ref-RFC3543">RFC3543</a>]    Glass, S. and M. Chandra, "Registration Revocation in
                Mobile IPv4", <a href="rfc3543.html">RFC 3543</a>, August 2003.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.2.%20%20Informative%20References"></a><a class="selflink" href="#section-15.2" name="section-15.2">15.2</a>.  Informative References</span>

   [<a id="ref-MIP4GREKEY" name="ref-MIP4GREKEY">MIP4GREKEY</a>] Yegani, P., <a href="https://www.google.com/search?sitesearch=tools.ietf.org%2Fhtml%2F&amp;q=inurl:draft-+%22GRE+Key+Extension+for+Mobile+IPv4%22" style="text-decoration: none">"GRE Key Extension for Mobile IPv4"</a>, Work in
                Progress, June 2007.

   [<a id="ref-MIP4MCBC" name="ref-MIP4MCBC">MIP4MCBC</a>]   Chakrabarti, S., "IPv4 Mobility extension for Multicast
                and Broadcast Packets", Work in Progress, November 2007.

   [<a id="ref-RFC0791" name="ref-RFC0791">RFC0791</a>]    Postel, J., "Internet Protocol", STD 5, <a href="rfc791.html">RFC 791</a>,
                September 1981.

   [<a id="ref-RFC1305" name="ref-RFC1305">RFC1305</a>]    Mills, D., "Network Time Protocol (Version 3)
                Specification, Implementation and Analysis", <a href="rfc1305.html">RFC 1305</a>,
                March 1992.

   [<a id="ref-RFC1332" name="ref-RFC1332">RFC1332</a>]    McGregor, G., "The PPP Internet Protocol Control
                Protocol (IPCP)", <a href="rfc1332.html">RFC 1332</a>, May 1992.

   [<a id="ref-RFC1661" name="ref-RFC1661">RFC1661</a>]    Simpson, W., Ed., "The Point-to-Point Protocol (PPP)",
                STD 51, <a href="rfc1661.html">RFC 1661</a>, July 1994.





<span class="grey">Leung, et al.                 Informational                    [Page 39]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-40" id="page-40" name="page-40"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


   [<a id="ref-RFC1994" name="ref-RFC1994">RFC1994</a>]    Simpson, W., "PPP Challenge Handshake Authentication
                Protocol (CHAP)", <a href="rfc1994.html">RFC 1994</a>, August 1996.

   [<a id="ref-RFC3748" name="ref-RFC3748">RFC3748</a>]    Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and
                H. Levkowetz, Ed., "Extensible Authentication Protocol
                (EAP)", <a href="rfc3748.html">RFC 3748</a>, June 2004.

   [<a id="ref-RFC4058" name="ref-RFC4058">RFC4058</a>]    Yegin, A., Ed., Ohba, Y., Penno, R., Tsirtsis, G., and
                C. Wang, "Protocol for Carrying Authentication for
                Network Access (PANA) Requirements", <a href="rfc4058.html">RFC 4058</a>, May 2005.

   [<a id="ref-RFC4301" name="ref-RFC4301">RFC4301</a>]    Kent, S. and K. Seo, "Security Architecture for the
                Internet Protocol", <a href="rfc4301.html">RFC 4301</a>, December 2005.

   [<a id="ref-RFC4303" name="ref-RFC4303">RFC4303</a>]    Kent, S., "IP Encapsulating Security Payload (ESP)", <a href="rfc4303.html">RFC</a>
                <a href="rfc4303.html">4303</a>, December 2005.

   [<a id="ref-RFC4332" name="ref-RFC4332">RFC4332</a>]    Leung, K., Patel, A., Tsirtsis, G., and E. Klovning,
                "Cisco's Mobile IPv4 Host Configuration Extensions", <a href="rfc4332.html">RFC</a>
                <a href="rfc4332.html">4332</a>, December 2005.

   [<a id="ref-RFC4433" name="ref-RFC4433">RFC4433</a>]    Kulkarni, M., Patel, A., and K. Leung, "Mobile IPv4
                Dynamic Home Agent (HA) Assignment", <a href="rfc4433.html">RFC 4433</a>, March
                2006.

   [<a id="ref-RFC4436" name="ref-RFC4436">RFC4436</a>]    Aboba, B., Carlson, J., and S. Cheshire, "Detecting
                Network Attachment in IPv4 (DNAv4)", <a href="rfc4436.html">RFC 4436</a>, March
                2006.

   [<a id="ref-RFC5213" name="ref-RFC5213">RFC5213</a>]    Gundavelli, S., Ed., Leung, K., Devarapalli, V.,
                Chowdhury, K., and B. Patil, "Proxy Mobile IPv6", <a href="rfc5213.html">RFC</a>
                <a href="rfc5213.html">5213</a>, August 2008.

   [<a id="ref-RFC5226" name="ref-RFC5226">RFC5226</a>]    Narten, T. and H. Alvestrand, "Guidelines for Writing an
                IANA Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc5226.html">RFC 5226</a>,
                May 2008.

   [<a id="ref-RFC5454" name="ref-RFC5454">RFC5454</a>]    Tsirtsis, G., Park, V., and H. Soliman, "Dual-Stack
                Mobile IPv4", <a href="rfc5454.html">RFC 5454</a>, March 2009.

   [<a id="ref-RFCARP" name="ref-RFCARP">RFCARP</a>]     Plummer, D., "Ethernet Address Resolution Protocol: Or
                Converting Network Protocol Addresses to 48.bit Ethernet
                Address for Transmission on Ethernet Hardware", STD 37,
                <a href="rfc826.html">RFC 826</a>, November 1982.

   [<a id="ref-RFCICMP" name="ref-RFCICMP">RFCICMP</a>]    Postel, J., "Internet Control Message Protocol", STD 5,
                <a href="rfc792.html">RFC 792</a>, September 1981.




<span class="grey">Leung, et al.                 Informational                    [Page 40]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-41" id="page-41" name="page-41"> </a>
<span class="grey"><a href="rfc5563.html">RFC 5563</a>               WiMAX Forum / 3GPP2 PMIPv4          February 2010</span>


Authors' Addresses

   Kent Leung
   Cisco Systems
   170 West Tasman Drive
   San Jose, CA  95134
   US

   EMail: kleung@cisco.com


   Gopal Dommety
   Cisco Systems
   170 West Tasman Drive
   San Jose, CA  95134
   US

   EMail: gdommety@cisco.com


   Parviz Yegani
   Juniper Networks
   1194 North Mathilda Ave.
   Sunnyvale, CA 94089-1206

   EMail: pyegani@juniper.net


   Kuntal Chowdhury
   Starent Networks
   30 International Place
   Tewksbury, MA  01876
   USA

   EMail: kchowdhury@starentnetworks.com
















Leung, et al.                 Informational                    [Page 41]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc5563 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:34 GMT --></html>