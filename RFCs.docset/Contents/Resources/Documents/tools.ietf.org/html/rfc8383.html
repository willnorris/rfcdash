<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc8383 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Aug 2018 13:47:37 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.127" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-hao-trill-address-flush" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:8383" name="DC.Identifier"/>
<meta content="May, 2018" name="DC.Date.Issued"/>
<meta content="Mohammed Umair &lt;mohammed.umair2@gmail.com&gt;" name="DC.Creator"/>
<meta content="The TRILL (TRansparent Interconnection of Lots of Links) protocol, by
default, learns end station addresses from observing the data plane.
In particular, it learns local MAC addresses and edge switch port of
attachment from the receipt of local data frames and learns remote MAC
addresses and edge switch of attachment from the decapsulation of
remotely sourced TRILL Data packets.  This document specifies a
message by which a TRILL switch can explicitly request other TRILL
switches to flush certain MAC reachability learned through the
decapsulation of TRILL Data packets. This is a supplement to the TRILL
automatic address forgetting and can assist in achieving more rapid
convergence in case of topology or configuration change." name="DC.Description.Abstract"/>
<meta content="Transparent Interconnection of Lots of Links (TRILL): Address Flush Message" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 8383 - Transparent Interconnection of Lots of Links (TRILL): Address Flush Message</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc8383.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc8383" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-trill-address-flush" title="draft-ietf-trill-address-flush">draft-ietf-tril...</a>] [<a href="https://datatracker.ietf.org/doc/rfc8383" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc8383" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc8383" title="Side-by-side diff">Diff2</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=8383&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>]   </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                            W. Hao
Request for Comments: 8383                              D. Eastlake, 3rd
Category: Standards Track                                          Y. Li
ISSN: 2070-1721                                                   Huawei
                                                                M. Umair
                                                                   Cisco
                                                                May 2018


         <span class="h1">Transparent Interconnection of Lots of Links (TRILL):</span>
                         <span class="h1">Address Flush Message</span>

Abstract

   The TRILL (Transparent Interconnection of Lots of Links) protocol, by
   default, learns end station addresses from observing the data plane.
   In particular, it learns local Media Access Control (MAC) addresses
   and the edge switch port of attachment from the receipt of local data
   frames and learns remote MAC addresses and the edge switch port of
   attachment from the decapsulation of remotely sourced TRILL Data
   packets.

   This document specifies a message by which a TRILL switch can
   explicitly request other TRILL switches to flush certain MAC
   reachability learned through the decapsulation of TRILL Data packets.
   This is a supplement to the TRILL automatic address forgetting (see
   <a href="rfc6325.html#section-4.8.3">Section 4.8.3 of RFC 6325</a>) and can assist in achieving more rapid
   convergence in case of topology or configuration change.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc7841.html#section-2">Section 2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8383">https://www.rfc-editor.org/info/rfc8383</a>.









<span class="grey">Hao, et al.                  Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc8383.html">RFC 8383</a>               TRILL Address Flush Message              May 2018</span>


Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-1.1">1.1</a>.  Terminology and Abbreviations . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Address Flush Message Details . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-2.1">2.1</a>.  VLAN Block Only Case  . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-2.2">2.2</a>.  Extensible Case . . . . . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
       <a href="#section-2.2.1">2.2.1</a>.  Blocks of VLANs . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
       <a href="#section-2.2.2">2.2.2</a>.  Bit Map of VLANs  . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
       <a href="#section-2.2.3">2.2.3</a>.  Blocks of FGLs  . . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
       <a href="#section-2.2.4">2.2.4</a>.  list of FGLs  . . . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
       <a href="#section-2.2.5">2.2.5</a>.  Big Map of FGLs . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
       <a href="#section-2.2.6">2.2.6</a>.  All Data Labels . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
       <a href="#section-2.2.7">2.2.7</a>.  MAC Address List  . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
       <a href="#section-2.2.8">2.2.8</a>.  MAC Address Blocks  . . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
   <a href="#section-3">3</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
     <a href="#section-3.1">3.1</a>.  Address Flush RBridge Channel Protocol Number . . . . . .  <a href="#page-17">17</a>
     <a href="#section-3.2">3.2</a>.  TRILL Address Flush TLV Types . . . . . . . . . . . . . .  <a href="#page-17">17</a>
   <a href="#section-4">4</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
   <a href="#section-5">5</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>
     <a href="#section-5.1">5.1</a>.  Normative References  . . . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>
     <a href="#section-5.2">5.2</a>.  Informative References  . . . . . . . . . . . . . . . . .  <a href="#page-19">19</a>
   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-19">19</a>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-20">20</a>












<span class="grey">Hao, et al.                  Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc8383.html">RFC 8383</a>               TRILL Address Flush Message              May 2018</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   By default, edge TRILL (Transparent Interconnection of Lots of Links)
   switches [<a href="rfc6325.html" title='"Routing Bridges (RBridges): Base Protocol Specification"'>RFC6325</a>] [<a href="rfc7780.html" title='"Transparent Interconnection of Lots of Links (TRILL): Clarifications, Corrections, and Updates"'>RFC7780</a>], also called edge Routing Bridges
   (RBridges), learn end station MAC address reachability from observing
   the data plane.  On receipt of a native frame from an end station,
   they would learn the local MAC address attachment of the source end
   station.  And on egressing (decapsulating) a remotely originated
   TRILL Data packet, they learn the remote MAC address and remote
   attachment TRILL switch.  Such learning is all scoped by data label
   (VLAN or Fine-Grained Label (FGL) [<a href="rfc7172.html" title='"Transparent Interconnection of Lots of Links (TRILL): Fine-Grained Labeling"'>RFC7172</a>]).

   TRILL has mechanisms for timing out such learning and appropriately
   clearing it based on some network connectivity and configuration
   changes; however, there are circumstances under which it would be
   helpful for a TRILL switch to be able to explicitly flush (purge)
   certain learned end station reachability information in remote
   RBridges to achieve more-rapid convergence.  <a href="rfc4762.html#section-6.2">Section 6.2 of [RFC4762]</a>
   is an example of the use of such a mechanism.

   Another example, based on <a href="rfc6325.html#appendix-A.3">Appendix A.3 of [RFC6325]</a> ("Wiring Closet
   Topology"), presents a bridged LAN connected to a TRILL network via
   multiple RBridge ports.  For optimum paths, <a href="#appendix-A.3.3">Appendix A.3.3</a> suggests
   configuring the RBridge ports to be like one Spanning Tree Protocol
   (STP) tree root in the bridged LAN.  The Address Flush message in
   this document could also be triggered in this case when one of the
   edge RBridges receives Topology Change (TC) information (e.g., TC in
   STP, Topology Change Notification (TCN) in Multiple Spanning Tree
   Protocol (MSTP)) in order to rapidly flush the MAC addresses for
   specific VLANs learned at the other edge RBridge ports.

   A TRILL switch can easily flush any locally learned addresses it
   wants.  This document specifies an RBridge Channel Support protocol
   [<a href="rfc7178.html" title='"Transparent Interconnection of Lots of Links (TRILL): RBridge Channel Support"'>RFC7178</a>] message to request flushing address information for
   specific VLANs or FGLs ([<a href="rfc7172.html" title='"Transparent Interconnection of Lots of Links (TRILL): Fine-Grained Labeling"'>RFC7172</a>]) learned from decapsulating TRILL
   Data packets.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Terminology%20and%20Abbreviations"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Terminology and Abbreviations</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>] [<a href="rfc8174.html" title='"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"'>RFC8174</a>]
   when, and only when, they appear in all capitals, as shown here.








<span class="grey">Hao, et al.                  Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc8383.html">RFC 8383</a>               TRILL Address Flush Message              May 2018</span>


   This document uses the terms and abbreviations defined in [<a href="rfc6325.html" title='"Routing Bridges (RBridges): Base Protocol Specification"'>RFC6325</a>]
   and [<a href="rfc7178.html" title='"Transparent Interconnection of Lots of Links (TRILL): RBridge Channel Support"'>RFC7178</a>] as well as the following:

   Data Label:  A VLAN or FGL

   Edge TRILL Switch:  A TRILL switch attached to one or more links that
      provide end station service

   FCS:  Frame Check Sequence

   FGL:  Fine-Grained Label [<a href="rfc7172.html" title='"Transparent Interconnection of Lots of Links (TRILL): Fine-Grained Labeling"'>RFC7172</a>]

   Management VLAN:  A VLAN in which all TRILL switches in a campus
      indicate interest so that multi-destination TRILL Data packets,
      including RBridge Channel protocol messages [<a href="rfc7178.html" title='"Transparent Interconnection of Lots of Links (TRILL): RBridge Channel Support"'>RFC7178</a>], sent with
      that VLAN as the Inner.VLAN will be delivered to all TRILL
      switches in the campus.  Usually, no end station service is
      offered in the Management VLAN.

   MAC:  Media Access Control

   RBridge:  An alternative name for a TRILL switch

   STP:  Spanning Tree Protocol

   TC:  Topology Change message

   TCN:  Topology Change Notification message

   TRILL switch:  A device implementing the TRILL protocol [<a href="rfc6325.html" title='"Routing Bridges (RBridges): Base Protocol Specification"'>RFC6325</a>]
      [<a href="rfc7780.html" title='"Transparent Interconnection of Lots of Links (TRILL): Clarifications, Corrections, and Updates"'>RFC7780</a>]




















<span class="grey">Hao, et al.                  Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc8383.html">RFC 8383</a>               TRILL Address Flush Message              May 2018</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Address%20Flush%20Message%20Details"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Address Flush Message Details</span>

   The Address Flush message is an RBridge Channel protocol message
   [<a href="rfc7178.html" title='"Transparent Interconnection of Lots of Links (TRILL): RBridge Channel Support"'>RFC7178</a>].

   The general structure of an RBridge Channel packet on a link between
   TRILL switches is shown in Figure 1.  The Protocol field in the
   RBridge Channel Header gives the type of RBridge Channel packet and
   indicates how to interpret the Channel-Protocol-Specific Payload
   [<a href="rfc7178.html" title='"Transparent Interconnection of Lots of Links (TRILL): RBridge Channel Support"'>RFC7178</a>].


                      +-----------------------------------+
                      |            Link Header            |
                      +-----------------------------------+
                      |            TRILL Header           |
                      +-----------------------------------+
                      |      Inner Ethernet Addresses     |
                      +-----------------------------------+
                      |      Data Label (VLAN or FGL)     |
                      +-----------------------------------+
                      |       RBridge Channel Header      |
                      +-----------------------------------+
                      | Channel-Protocol-Specific Payload |
                      +-----------------------------------+
                      |   Link Trailer (FCS if Ethernet)  |
                      +-----------------------------------+

           Figure 1: RBridge Channel Protocol Message Structure

   By default, an Address Flush RBridge Channel protocol message applies
   to addresses within the Data Label that appear right after the Inner
   Ethernet Addresses.  Address Flush protocol messages are usually sent
   as multi-destination packets (TRILL Header M bit equal to one) so as
   to reach all TRILL switches offering end station service in the VLAN
   or FGL specified by that Data Label.  Both multi-destination and
   unicast Address Flush messages SHOULD be sent at priority 6 since
   they are important control messages but are lower priority than
   control messages that establish or maintain adjacency.

   Nevertheless:

   -  There are provisions for optionally indicating the Data Label(s)
      to be flushed for cases where the Address Flush message is sent
      over a Management VLAN or the like.

   -  An Address Flush message can be sent unicast, if it is desired to
      clear addresses at one TRILL switch only.



<span class="grey">Hao, et al.                  Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc8383.html">RFC 8383</a>               TRILL Address Flush Message              May 2018</span>


   -  An Address Flush message can be sent selectively to the RBridges
      that have at least one access port configured as one of the VLANs
      or FGLs specified in the Address Flush message payload.

   Implementations should consider logging Address Flush messages
   received with appropriate protections against packet storms.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20VLAN%20Block%20Only%20Case"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  VLAN Block Only Case</span>

   Figure 2 expands the RBridge Channel Header and Channel-Protocol-
   Specific Payload from Figure 1 for the case of the VLAN-only-based
   Address Flush message.  This form of the Address Flush message is
   optimized for flushing MAC addresses based on nickname and blocks of
   VLANs. 0x8946 is the Ethertype assigned by IEEE for the RBridge
   Channel protocol [<a href="rfc7178.html" title='"Transparent Interconnection of Lots of Links (TRILL): RBridge Channel Support"'>RFC7178</a>].

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   RBridge Channel Header:
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |    RBridge-Channel (0x8946)   |  0x0  |Channel Protocol= 0x009|
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |          Flags        |  ERR  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   Address Flush Protocol Specific:
      +-+-+-+-+-+-+-+-+
      | K-nicks       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Nickname 1                    | Nickname 2                    |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Nickname ...                  | Nickname K-nicks              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | K-VLBs        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | RESV  | Start.VLAN 1          | RESV  | End.VLAN 1            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | RESV  | Start.VLAN 2          | RESV  | End.VLAN 2            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | RESV  | Start.VLAN ...        | RESV  | End.VLAN ...          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | RESV  | Start.VLAN K-VLBs     | RESV  | End.VLAN K-VLBs       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

             Figure 2: Address Flush Message - VLAN Block Case







<span class="grey">Hao, et al.                  Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc8383.html">RFC 8383</a>               TRILL Address Flush Message              May 2018</span>


   The fields in Figure 2 related to the Address Flush message are as
   follows:

   Channel Protocol:  The RBridge Channel Protocol value allocated for
      Address Flush (see <a href="#section-3">Section 3</a>).

   K-nicks:  The number of nicknames listed as an unsigned integer.  If
      this is zero, the ingress nickname in the TRILL Header [<a href="rfc6325.html" title='"Routing Bridges (RBridges): Base Protocol Specification"'>RFC6325</a>]
      is considered to be the only nickname to which the message
      applies.  If non-zero, it gives the number of nicknames listed
      right after K-nicks to which the message applies, and, in this
      non-zero case, the flush does not apply to the ingress nickname in
      the TRILL Header unless it is also listed.  The message flushes
      address learning due to egressing TRILL Data packets that had an
      ingress nickname to which the message applies.

   Nickname:  A listed nickname to which it is intended that the Address
      Flush message apply.  If an unknown or reserved nickname occurs in
      the list, it is ignored, but the address flush operation is still
      executed with the other nicknames.  If an incorrect nickname
      occurs in the list, so that some address learning is flushed that
      should not have been flushed, the network will still operate
      correctly; however, it will be less efficient as the incorrectly
      flushed learning is relearned.

   K-VLBs:  The number of VLAN blocks present as an unsigned integer.
      If this byte is zero, the message is the more general format
      specified in <a href="#section-2.2">Section 2.2</a>.  If it is non-zero, it gives the number
      of blocks of VLANs present.  Thus, in the VLAN Block address flush
      case, K-VLBs will be at least one.

   RESV:  4 reserved bits.  MUST be sent as zero and ignored on receipt.

   Start.VLAN, End.VLAN:  These 12-bit fields give the beginning and
      ending VLAN IDs of a block of VLANs.  The block includes both the
      starting and ending values; so, a block of size one is indicated
      by setting End.VLAN equal to Start.VLAN.  If Start.VLAN is 0x000,
      it is treated as if it was 0x001.  If End.VLAN is 0xFFF, it is
      treated as if it was 0xFFE.  If End.VLAN is smaller than
      Start.VLAN, considering both as unsigned integers, that VLAN block
      is ignored, but the address flush operation is still executed with
      other VLAN blocks in the message.  VLAN blocks may overlap, in
      which case, the address flush operation is applicable to a VLAN
      covered by any one or more of the blocks in the message.







<span class="grey">Hao, et al.                  Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc8383.html">RFC 8383</a>               TRILL Address Flush Message              May 2018</span>


   This message flushes all addresses in an applicable VLAN learned from
   egressing TRILL Data packets with an applicable nickname as ingress.
   To flush addresses for all VLANs, it is easy to specify a block
   covering all valid VLAN IDs (i.e., from 0x001 to 0xFFE).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Extensible%20Case"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Extensible Case</span>

   A more general form of the Address Flush message is provided to
   support flushing by FGL and more efficient encodings of VLANs and
   FGLs where using a set of contiguous blocks is cumbersome.  It also
   supports optionally specifying the MAC addresses to clear.  This form
   is extensible.

   The extensible case is indicated by a zero in the byte shown in
   Figure 2 as "K-VLBs" followed by other information encoded as TLVs.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   RBridge Channel Header:
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |    RBridge-Channel (0x8946)   |  0x0  |Channel Protocol=0x009 |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |          Flags        |  ERR  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   Address Flush Protocol Specific:
      +-+-+-+-+-+-+-+-+
      | K-nicks       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Nickname 1                    | Nickname 2                    |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Nickname ...                  | Nickname K-nicks              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | 0             |  TLVs ...
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+...

             Figure 3: Address Flush Message - Extensible Case

   Channel Protocol, K-nicks, Nickname:  These fields are as specified
      in <a href="#section-2.1">Section 2.1</a>.












<span class="grey">Hao, et al.                  Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc8383.html">RFC 8383</a>               TRILL Address Flush Message              May 2018</span>


   TLVs:  If the byte immediately before the TLVs field, which is the
      byte labeled "K-VLBs" in Figure 2, is zero, as shown in Figure 3,
      the remainder of the message consists of TLVs encoded as shown in
      Figure 4.

             0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7
            +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
            |  Type         |  Length       |  Value
            +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

                       Figure 4: Type, Length, Value

   Type:  The 8-bit TLV type as shown in the table below.  See
      subsections of <a href="#section-2.2">Section 2.2</a> for details on each type assigned
      below.  If the type is reserved or not known by a receiving
      RBridge, that receiving RBridge ignores the value and skips to the
      next TLV by use of the Length byte.  There is no provision for a
      list of VLAN ID TLVs as there are few enough of them that an
      arbitrary subset of VLAN IDs can be represented as a bit map.

                Type       Description       Reference
               ------   ------------------  -----------------
                   0     Reserved            [<a href="rfc8383.html">RFC8383</a>]
                   1     Blocks of VLANs     [<a href="rfc8383.html">RFC8383</a>]
                   2     Bit Map of VLANs    [<a href="rfc8383.html">RFC8383</a>]
                   3     Blocks of FGLs      [<a href="rfc8383.html">RFC8383</a>]
                   4     List of FGLs        [<a href="rfc8383.html">RFC8383</a>]
                   5     Bit Map of FGLs     [<a href="rfc8383.html">RFC8383</a>]
                   6     All Data Labels     [<a href="rfc8383.html">RFC8383</a>]
                   7     MAC Address List    [<a href="rfc8383.html">RFC8383</a>]
                   8     MAC Address Blocks  [<a href="rfc8383.html">RFC8383</a>]
               9-254     Unassigned
                 255     Reserved            [<a href="rfc8383.html">RFC8383</a>]

   Length:  The 8-bit unsigned integer length in bytes of the remaining
      information in the TLV after the Length byte.  The Length MUST NOT
      imply that the value extends beyond the end of the RBridge
      Channel-Protocol-Specific Payload area.  If it does, the Address
      Flush message is corrupt and MUST be ignored.

   Value:  Depends on the TLV type.










<span class="grey">Hao, et al.                  Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc8383.html">RFC 8383</a>               TRILL Address Flush Message              May 2018</span>


   In an extensible Address Flush message, when the TLVs are parsed,
   those TLVs having unknown types are ignored by the receiving RBridge.
   There may be multiple instances of TLVs with the same Type in the
   same Address Flush message, and TLVs are not required to be in any
   particular order.

   -  All RBridges implementing the Address Flush RBridge Channel
      protocol message MUST implement types 1 and 2, the VLAN types, and
      Type 6, which indicates addresses are to be flushed for all Data
      Labels.

   -  RBridges that implement the Address Flush message and implement
      FGL ingress/egress MUST implement types 3, 4, and 5, the FGL
      types.  (An RBridge that is merely FGL safe [<a href="rfc7172.html" title='"Transparent Interconnection of Lots of Links (TRILL): Fine-Grained Labeling"'>RFC7172</a>], but cannot
      egress FGL TRILL Data packets, SHOULD ignore the FGL types, as it
      will not learn any FGL-scoped MAC addresses from the data plane.)

   -  RBridges that implement the Address Flush message SHOULD implement
      types 7 and 8 so that specific MAC addresses can be flushed.  If
      they do not, the effect will be to flush all MAC addresses for the
      indicated Data Labels, which may be inefficient as any MAC
      addresses not intended to be flushed will have to be relearned.

   The parsing of the TLVs by a receiving RBridge results in three
   pieces of information:

      1.  a flag indicating whether one or more Type 6 TLVs (All Data
          Labels) were encountered;

      2.  a set of Data Labels accumulated from VLAN and/or FGL
          specifying TLVs in the message; and,

      3.  if the MAC address TLV types are implemented, a set of MAC
          addresses accumulated from MAC-address-specifying TLVs in the
          message.

   VLANs/FGLs might be indicated more than once due to overlapping
   blocks or the like, and a VLAN/FGL is included in the above set of
   VLANs/FGLs if it occurs in any TLV in the Address Flush message.  A
   MAC address might be indicated more than once due to overlapping
   blocks or the like, and a particular MAC address is included in the
   above set of MAC addresses if it occurs in any TLV in the Address
   Flush message.

   After the above information has been accumulated by parsing the TLVs,
   three sets are derived as described below: a set of nicknames, a set
   of Data Labels, and a set of MAC addresses.  The address flush
   operation at the receiver applies to the cross product of these



<span class="grey">Hao, et al.                  Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc8383.html">RFC 8383</a>               TRILL Address Flush Message              May 2018</span>


   derived sets.  That is, a { Data Label, MAC address, nickname }
   triple is flushed if and only if the Data Label matches an element in
   the derived set of Data Labels, the MAC address matches an element in
   the derived set of MAC address, and the nickname matches an element
   in the derived set of nicknames.  In the case of Data Labels and MAC
   addresses, a special value of the set, {ALL}, is permitted, which
   matches all values.

   The sets are derived as follows:

      Data Labels set:
         If the Type 6 TLV has been encountered, the set is {ALL}, else,
         if any Data Labels have been accumulated by processing Data
            Label TLVs (Types 1, 2, 3, 4, and 5), the set is those
            accumulated Data Labels, else,
         the Data Labels set is null and the Address Flush message does
            nothing.

      MAC Addresses set:
         In the receiver does not implement the MAC address types (Types
            7 and 8) or it does implement those types but no MAC
            addresses are accumulated in parsing the TLVs, then the MAC
            Address set is {ALL},
         else, the MAC Addresses set is the set of MAC addresses
            accumulated in processing the TLVs.

      Nicknames set:
         If the K-nicks field in the Address Flush message was zero,
            then the ingress nickname in the TRILL Header of the message
            is the sole nickname set member, else,
         the nicknames set members are the K-nicks nicknames listed in
            the Address Flush message.

   The various formats below are provided for encoding efficiency.  A
   block of values is most efficient when there are a number of
   consecutive values.  A bit map is most efficient if there are
   scattered values within a limited range.  And a list of single values
   is most efficient if there are widely scattered values.













<span class="grey">Hao, et al.                  Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc8383.html">RFC 8383</a>               TRILL Address Flush Message              May 2018</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.1.%20%20Blocks%20of%20VLANs"></a><a class="selflink" href="#section-2.2.1" name="section-2.2.1">2.2.1</a>.  Blocks of VLANs</span>

   If the TLV Type is 1, the value is a list of blocks of VLANs as
   follows:

      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Type = 1      | Length        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | RESV  | Start.VLAN 1          | RESV  | End.VLAN 1            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | RESV  | Start.VLAN 2          | RESV  | End.VLAN 2            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | RESV  | Start.VLAN ...        | RESV  | End.VLAN ...          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The meaning of Start.VLAN and End.VLAN is as specified in
   <a href="#section-2.1">Section 2.1</a>.  Length MUST be a multiple of 4.  If Length is not a
   multiple of 4, the TLV is corrupt and the Address Flush message MUST
   be discarded.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.2.%20%20Bit%20Map%20of%20VLANs"></a><a class="selflink" href="#section-2.2.2" name="section-2.2.2">2.2.2</a>.  Bit Map of VLANs</span>

   If the TLV Type is 2, the value is a bit map of VLANs as follows:

      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Type = 2      | Length        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
      | RESV  | Start.VLAN            | Bits...
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

   The value portion of the TLV begins with two bytes having the 12-bit
   starting VLAN ID right justified (the top 4 bits are as specified in
   <a href="#section-2.1">Section 2.1</a> RESV).  This is followed by bytes with one bit per VLAN
   ID.  The high order bit of the first byte is for VLAN N.  The next-
   to-the-highest order bit is for VLAN N+1.  The low order bit of the
   first byte is for VLAN N+7.  The high order bit of the second byte,
   if there is a second byte, is for VLAN N+8, and so on.  If that bit
   is a one, the Address Flush message applies to that VLAN.  If that
   bit is a zero, then addresses that have been learned in that VLAN are
   not flushed.  Note that Length MUST be at least 2.  If Length is 0 or
   1, the TLV is corrupt and the Address Flush message MUST be
   discarded.  VLAN IDs do not wrap around.  If there are enough bytes
   so that some bits correspond to VLAN ID 0xFFF or higher, those bits
   are ignored, but the message is still processed for bits
   corresponding to valid VLAN IDs.






<span class="grey">Hao, et al.                  Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc8383.html">RFC 8383</a>               TRILL Address Flush Message              May 2018</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.3.%20%20Blocks%20of%20FGLs"></a><a class="selflink" href="#section-2.2.3" name="section-2.2.3">2.2.3</a>.  Blocks of FGLs</span>

   If the TLV Type is 3, the value is a list of blocks of FGLs as
   follows:

      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Type = 3      | Length        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Start.FGL 1                                   |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | End.FGL 1                                     |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Start.FGL 2                                   |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | End.FGL 2                                     |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Start.FGL ...                                 |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | End.FGL ...                                   |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The TLV value consists of sets of Start.FGL and End.FGL numbers.  The
   Address Flush information applies to the FGLs in that range,
   inclusive.  A single FGL is indicated by setting both Start.FGL and
   End.FGL to the same value.  If End.FGL is less than Start.FGL,
   considering them as unsigned integers, that block is ignored, but the
   Address Flush message is still processed for any other blocks
   present.  For this Type, Length MUST be a multiple of 6; if it is
   not, the TLV is corrupt and the Address Flush message MUST be
   discarded if the receiving RBridge implements Type 3.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.4.%20%20list%20of%20FGLs"></a><a class="selflink" href="#section-2.2.4" name="section-2.2.4">2.2.4</a>.  list of FGLs</span>

   If the TLV Type is 4, the value is a list of FGLs as follows:

      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Type = 4      | Length        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | FGL 1                                         |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | FGL 2                                         |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | FGL ...                                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+







<span class="grey">Hao, et al.                  Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc8383.html">RFC 8383</a>               TRILL Address Flush Message              May 2018</span>


   The TLV value consists of FGL numbers each in 3 bytes.  The Address
   Flush message applies to those FGLs.  For this Type, Length MUST be a
   multiple of 3; if it is not, the TLV is corrupt and the Address Flush
   message MUST be discarded if the receiving RBridge implements Type 4.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.5.%20%20Big%20Map%20of%20FGLs"></a><a class="selflink" href="#section-2.2.5" name="section-2.2.5">2.2.5</a>.  Big Map of FGLs</span>

   If the TLV Type is 5, the value is a bit map of FGLs as follows:

      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Type = 5      | Length        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Start.FGL                                     |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Bits...
      +-+-+-+-+-+-+-+-

   The TLV value consists of three bytes with the 24-bit starting FGL
   value N.  This is followed by bytes with one bit per FGL.  The high
   order bit of the first byte is for FGL N.  The next-to-the-highest
   order bit is for FGL N+1.  The low order bit of the first byte is for
   FGL N+7.  The high order bit of the second byte, if there is a second
   byte, is for FGL N+8, and so on.  If that bit is a one, the Address
   Flush message applies to that FGL.  If that bit is a zero, then
   addresses that have been learned in that FGL are not flushed.  Note
   that Length MUST be at least 3.  If Length is 0, 1, or 2 for a Type 5
   TLV, the TLV is corrupt and the Address Flush message MUST be
   discarded if Type 5 is implemented.  FGLs do not wrap around.  If
   there are enough bytes so that some bits correspond to an FGL higher
   than 0xFFFFFF, those bits are ignored, but the message is still
   processed for bits corresponding to valid FGLs.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.6.%20%20All%20Data%20Labels"></a><a class="selflink" href="#section-2.2.6" name="section-2.2.6">2.2.6</a>.  All Data Labels</span>

   If the TLV Type is 6, the value is null as follows:

      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Type = 6      | Length = 0    |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   This type is used when an RBridge wants to withdraw all addresses for
   all the Data Labels (all VLANs and FGLs).  Length MUST be zero.  If
   Length is any other value, the TLV is corrupt and the Address Flush
   message MUST be discarded.







<span class="grey">Hao, et al.                  Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc8383.html">RFC 8383</a>               TRILL Address Flush Message              May 2018</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.7.%20%20MAC%20Address%20List"></a><a class="selflink" href="#section-2.2.7" name="section-2.2.7">2.2.7</a>.  MAC Address List</span>

   If the TLV Type is 7, the value is a list of MAC addresses as
   follows:

      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Type = 7      | Length        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | MAC 1 upper half                              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | MAC 1 lower half                              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | MAC 2 upper half                              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | MAC 2 lower half                              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | MAC ... upper half                            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | MAC ... lower half                            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The TLV value consists of a list of 48-bit MAC addresses.  Length
   MUST be a multiple of 6.  If it is not, the TLV is corrupt, and the
   Address Flush message MUST be discarded if the receiving RBridge
   implements Type 7.


























<span class="grey">Hao, et al.                  Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc8383.html">RFC 8383</a>               TRILL Address Flush Message              May 2018</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.8.%20%20MAC%20Address%20Blocks"></a><a class="selflink" href="#section-2.2.8" name="section-2.2.8">2.2.8</a>.  MAC Address Blocks</span>

   If the TLV Type is 8, the value is a list of blocks of MAC addresses
   as follows:

      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Type = 8      | Length        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | MAC.start 1 upper half                        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | MAC.start 1 lower half                        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | MAC.end 1 upper half                          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | MAC.end 1 lower half                          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | MAC.start 2 upper half                        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | MAC.start 2 lower half                        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | MAC.end 2 upper half                          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | MAC.end 2 lower half                          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | MAC.start ... upper half                      |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | MAC.start ... lower half                      |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | MAC.end ... upper half                        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | MAC.end ... lower half                        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The TLV value consists of sets of Start.MAC and End.MAC numbers.  The
   Address Flush information applies to the 48-bit MAC Addresses in that
   range, inclusive.  A single MAC address is indicated by setting both
   Start.MAC and End.MAC to the same value.  If End.MAC is less than
   Start.MAC, considering them as unsigned integers, that block is
   ignored but the Address Flush message is still processed for any
   other blocks present.  For this Type, Length MUST be a multiple of
   12; if it is not, the TLV is corrupt and the Address Flush message
   MUST be discarded if the receiving RBridge implements Type 7.









<span class="grey">Hao, et al.                  Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc8383.html">RFC 8383</a>               TRILL Address Flush Message              May 2018</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  IANA Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Address%20Flush%20RBridge%20Channel%20Protocol%20Number"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Address Flush RBridge Channel Protocol Number</span>

   IANA has assigned 0x009 as the Address Flush RBridge Channel Protocol
   number from the range of RBridge Channel protocols allocated by
   Standards Action [<a href="rfc7178.html" title='"Transparent Interconnection of Lots of Links (TRILL): RBridge Channel Support"'>RFC7178</a>] [<a href="rfc8126.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC8126</a>].

   The added entry to the "RBridge Channel Protocols" registry at
   &lt;<a href="https://www.iana.org/assignments/trill-parameters/">https://www.iana.org/assignments/trill-parameters/</a>&gt; is as follows:

         Protocol  Description       Reference
         --------  --------------    ------------------
           0x009    Address Flush     [<a href="rfc8383.html">RFC8383</a>]

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20TRILL%20Address%20Flush%20TLV%20Types"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  TRILL Address Flush TLV Types</span>

   IANA has created the "TRILL Address Flush TLV Types" registry at
   &lt;<a href="https://www.iana.org/assignments/trill-parameters/">https://www.iana.org/assignments/trill-parameters/</a>&gt; as a subregistry
   of the "RBridge Channel Protocols" registry.  Registry headers are as
   below.  The initial entries are as in the table in <a href="#section-2.2">Section 2.2</a>.

         Registry:  TRILL Address Flush TLV Types
         Registration Procedures: IETF Review
         Reference:  [<a href="rfc8383.html">RFC8383</a>]

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Security%20Considerations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Security Considerations</span>

   The Address Flush RBridge Channel Protocol itself provides no
   security assurances or features.  However, Address Flush protocol
   messages can be secured by use of the RBridge Channel Header
   Extension [<a href="rfc7978.html" title='"Transparent Interconnection of Lots of Links (TRILL): RBridge Channel Header Extension"'>RFC7978</a>].  It is RECOMMENDED that all RBridges that
   implement the Address Flush message be configured to ignore such
   messages unless they have been secured with an RBridge Channel Header
   Extension that meets local security policy.

   If RBridges receiving Address Flush messages do not require them to
   be at least authenticated, they are relatively easy to forge.  In
   that case, such forged Address Flush messages can reduce network
   efficiency, by purging useful learned information that will have to
   be relearned.  This provides a denial-of-service attack, but cannot
   cause incorrect operation in the sense that it cannot cause a frame
   to be improperly delivered.

   See [<a href="rfc7178.html" title='"Transparent Interconnection of Lots of Links (TRILL): RBridge Channel Support"'>RFC7178</a>] for general RBridge Channel Security Considerations.

   See [<a href="rfc6325.html" title='"Routing Bridges (RBridges): Base Protocol Specification"'>RFC6325</a>] for general TRILL Security Considerations.




<span class="grey">Hao, et al.                  Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc8383.html">RFC 8383</a>               TRILL Address Flush Message              May 2018</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20References"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Normative%20References"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC6325" name="ref-RFC6325">RFC6325</a>]  Perlman, R., Eastlake 3rd, D., Dutt, D., Gai, S., and A.
              Ghanwani, "Routing Bridges (RBridges): Base Protocol
              Specification", <a href="rfc6325.html">RFC 6325</a>, DOI 10.17487/RFC6325, July 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6325">https://www.rfc-editor.org/info/rfc6325</a>&gt;.

   [<a id="ref-RFC7172" name="ref-RFC7172">RFC7172</a>]  Eastlake 3rd, D., Zhang, M., Agarwal, P., Perlman, R., and
              D. Dutt, "Transparent Interconnection of Lots of Links
              (TRILL): Fine-Grained Labeling", <a href="rfc7172.html">RFC 7172</a>,
              DOI 10.17487/RFC7172, May 2014,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7172">https://www.rfc-editor.org/info/rfc7172</a>&gt;.

   [<a id="ref-RFC7178" name="ref-RFC7178">RFC7178</a>]  Eastlake 3rd, D., Manral, V., Li, Y., Aldrin, S., and D.
              Ward, "Transparent Interconnection of Lots of Links
              (TRILL): RBridge Channel Support", <a href="rfc7178.html">RFC 7178</a>,
              DOI 10.17487/RFC7178, May 2014,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7178">https://www.rfc-editor.org/info/rfc7178</a>&gt;.

   [<a id="ref-RFC7780" name="ref-RFC7780">RFC7780</a>]  Eastlake 3rd, D., Zhang, M., Perlman, R., Banerjee, A.,
              Ghanwani, A., and S. Gupta, "Transparent Interconnection
              of Lots of Links (TRILL): Clarifications, Corrections, and
              Updates", <a href="rfc7780.html">RFC 7780</a>, DOI 10.17487/RFC7780, February 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7780">https://www.rfc-editor.org/info/rfc7780</a>&gt;.

   [<a id="ref-RFC7978" name="ref-RFC7978">RFC7978</a>]  Eastlake 3rd, D., Umair, M., and Y. Li, "Transparent
              Interconnection of Lots of Links (TRILL): RBridge Channel
              Header Extension", <a href="rfc7978.html">RFC 7978</a>, DOI 10.17487/RFC7978,
              September 2016, &lt;<a href="https://www.rfc-editor.org/info/rfc7978">https://www.rfc-editor.org/info/rfc7978</a>&gt;.

   [<a id="ref-RFC8174" name="ref-RFC8174">RFC8174</a>]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in <a href="rfc2119.html">RFC</a>
              <a href="rfc2119.html">2119</a> Key Words", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc8174.html">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.











<span class="grey">Hao, et al.                  Standards Track                   [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc8383.html">RFC 8383</a>               TRILL Address Flush Message              May 2018</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Informative%20References"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Informative References</span>

   [<a id="ref-RFC4762" name="ref-RFC4762">RFC4762</a>]  Lasserre, M., Ed. and V. Kompella, Ed., "Virtual Private
              LAN Service (VPLS) Using Label Distribution Protocol (LDP)
              Signaling", <a href="rfc4762.html">RFC 4762</a>, DOI 10.17487/RFC4762, January 2007,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4762">https://www.rfc-editor.org/info/rfc4762</a>&gt;.

   [<a id="ref-RFC8126" name="ref-RFC8126">RFC8126</a>]  Cotton, M., Leiba, B., and T. Narten, "Guidelines for
              Writing an IANA Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>,
              <a href="rfc8126.html">RFC 8126</a>, DOI 10.17487/RFC8126, June 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;.

Acknowledgements

   The following are thanked for their contributions:

      Ramkumar Parameswaran, Henning Rogge


































<span class="grey">Hao, et al.                  Standards Track                   [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc8383.html">RFC 8383</a>               TRILL Address Flush Message              May 2018</span>


Authors' Addresses

   Weiguo Hao
   Huawei Technologies
   101 Software Avenue,
   Nanjing 210012
   China

   Phone: +86-25-56623144
   Email: haoweiguo@huawei.com


   Donald Eastlake 3rd
   Huawei Technologies
   155 Beaver Street
   Milford, MA 01757
   United States of America

   Phone: +1-508-333-2270
   Email: d3e3e3@gmail.com


   Yizhou Li
   Huawei Technologies
   101 Software Avenue,
   Nanjing 210012
   China

   Phone: +86-25-56624629
   Email: liyizhou@huawei.com


   Mohammed Umair
   Cisco
   Cessna Business Park, Kadubeesanahalli Village, Hobli,
   Sarjapur, Varthur Main Road, Marathahalli,
   Bengaluru, Karnataka 560087
   India

   Email: mohammed.umair2@gmail.com











Hao, et al.                  Standards Track                   [Page 20]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.127, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc8383 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Aug 2018 13:47:37 GMT --></html>