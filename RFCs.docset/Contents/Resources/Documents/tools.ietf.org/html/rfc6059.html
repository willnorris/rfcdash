<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6059 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:32 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-krishnan-dna-simple" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:6059" name="DC.Identifier"/>
<meta content="November, 2010" name="DC.Date.Issued"/>
<meta content="Daley, Greg" name="DC.Creator"/>
<meta content="Krishnan, Suresh" name="DC.Creator"/>
<meta content="Detecting Network Attachment allows hosts to assess if its existing
addressing or routing configuration is valid for a newly connected
network. This document provides simple procedures for detecting
network attachment in IPv6 hosts, and procedures for routers to
support such services." name="DC.Description.Abstract"/>
<meta content="Simple procedures for Detecting Network Attachment in IPv6" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6059 - Simple procedures for Detecting Network Attachment in IPv6</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6059.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6059" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-dna-simple" title="draft-ietf-dna-simple">draft-ietf-dna-...</a>] [<a href="https://datatracker.ietf.org/doc/rfc6059" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6059" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6059" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                       S. Krishnan
Request for Comments: 6059                                      Ericsson
Category: Standards Track                                       G. Daley
ISSN: 2070-1721                                        Netstar Logicalis
                                                           November 2010


       <span class="h1">Simple Procedures for Detecting Network Attachment in IPv6</span>

Abstract

   Detecting Network Attachment allows hosts to assess if its existing
   addressing or routing configuration is valid for a newly connected
   network.  This document provides simple procedures for Detecting
   Network Attachment in IPv6 hosts, and procedures for routers to
   support such services.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6059">http://www.rfc-editor.org/info/rfc6059</a>.

Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.






<span class="grey">Krishnan &amp; Daley             Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6059.html">RFC 6059</a>                       Simple DNA                  November 2010</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-1.1">1.1</a>.  Goals  . . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-1.2">1.2</a>.  Applicability  . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-1.3">1.3</a>.  Link Identification Model  . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-1.4">1.4</a>.  DNA Overview . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-1.5">1.5</a>.  Working Assumptions  . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
   <a href="#section-2">2</a>.  Requirements Notation  . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
   <a href="#section-3">3</a>.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
   <a href="#section-4">4</a>.  The Simple DNA Address Table (SDAT)  . . . . . . . . . . . . .  <a href="#page-7">7</a>
   <a href="#section-5">5</a>.  Host Operations  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-5.1">5.1</a>.  On Receipt of a Router Advertisement . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-5.2">5.2</a>.  After Assignment of a DHCPv6 Address . . . . . . . . . . .  <a href="#page-8">8</a>
     <a href="#section-5.3">5.3</a>.  Steps Involved in Detecting Link Change  . . . . . . . . .  <a href="#page-8">8</a>
     <a href="#section-5.4">5.4</a>.  Link-Layer Indication  . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
     <a href="#section-5.5">5.5</a>.  Sending Neighbor Discovery probes  . . . . . . . . . . . .  <a href="#page-9">9</a>
       <a href="#section-5.5.1">5.5.1</a>.  Sending Router Solicitations . . . . . . . . . . . . .  <a href="#page-9">9</a>
       <a href="#section-5.5.2">5.5.2</a>.  Sending Neighbor Solicitations . . . . . . . . . . . .  <a href="#page-9">9</a>
       <a href="#section-5.5.3">5.5.3</a>.  Concurrent Sending of RS and NS Probes . . . . . . . .  <a href="#page-9">9</a>
       <a href="#section-5.5.4">5.5.4</a>.  Initiating DHCPv6 Exchange . . . . . . . . . . . . . .  <a href="#page-9">9</a>
     <a href="#section-5.6">5.6</a>.  Contents of the Neighbor Discovery Messages  . . . . . . . <a href="#page-10">10</a>
       <a href="#section-5.6.1">5.6.1</a>.  Neighbor Solicitation Messages . . . . . . . . . . . . <a href="#page-10">10</a>
       <a href="#section-5.6.2">5.6.2</a>.  Router Solicitation Messages . . . . . . . . . . . . . <a href="#page-10">10</a>
     <a href="#section-5.7">5.7</a>.  Response Gathering . . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
       <a href="#section-5.7.1">5.7.1</a>.  Receiving Neighbor Advertisements  . . . . . . . . . . <a href="#page-11">11</a>
       <a href="#section-5.7.2">5.7.2</a>.  Receiving Router Advertisements  . . . . . . . . . . . <a href="#page-11">11</a>
       <a href="#section-5.7.3">5.7.3</a>.  Conflicting Results  . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
     <a href="#section-5.8">5.8</a>.  Further Host Operations  . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
     <a href="#section-5.9">5.9</a>.  On Connecting to a New Point of Attachment . . . . . . . . <a href="#page-12">12</a>
     <a href="#section-5.10">5.10</a>. Periodic Maintenance of the SDAT . . . . . . . . . . . . . <a href="#page-12">12</a>
     <a href="#section-5.11">5.11</a>. Recommended Retransmission Behavior  . . . . . . . . . . . <a href="#page-12">12</a>
   <a href="#section-6">6</a>.  Pseudocode for Simple DNA  . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
   <a href="#section-7">7</a>.  Constants  . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
   <a href="#section-8">8</a>.  Relationship to DNAv4  . . . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
   <a href="#section-9">9</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
   <a href="#section-10">10</a>. Acknowledgments  . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
   <a href="#section-11">11</a>. References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#section-11.1">11.1</a>. Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#section-11.2">11.2</a>. Informative References . . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
   <a href="#appendix-A">Appendix A</a>.  Issues with Confirming Manually Assigned Addresses  . 18










<span class="grey">Krishnan &amp; Daley             Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6059.html">RFC 6059</a>                       Simple DNA                  November 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   Hosts require procedures to simply and reliably identify if they have
   moved to a network to which they had been recently connected.  In
   order to detect reconnection to a previously visited network, router
   and neighbor discovery messages are used to collect reachability and
   configuration information.  This information is used to detect if the
   host has attached to a link for which it may still have valid address
   and other configuration information, and which it can use until it
   receives confirmation through either the Neighbor Discovery protocol
   or DHCPv6.

   This document incorporates feedback from host and router operating
   systems implementors, which seeks to make implementation and adoption
   of IPv6 change detection procedures simple for general use.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Goals"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Goals</span>

   The goal of this document is to specify a simple procedure for
   Detecting Network Attachment (Simple DNA) that has the following
   characteristics.

   o  Routers do not have to be modified to support this scheme.

   o  The most common use cases are optimized.

   o  In the worst case, detection latency is equal to that of standard
      neighbor discovery so that performance is never degraded.

   o  False positives are not acceptable.  A host must not wrongly
      conclude that it has reattached to a previously visited network.

   o  False negatives are acceptable.  A host may fail to identify a
      previously visited link correctly and attempt to acquire fresh
      addressing and configuration information.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Applicability"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Applicability</span>

   The Simple DNA protocol provides substantial benefits over standard
   neighbor discovery procedures [<a href="rfc4861.html" title='"Neighbor Discovery for IP version 6 (IPv6)"'>RFC4861</a>] in some scenarios and does
   not provide any benefit at all in certain other scenarios.  This is
   intentional as Simple DNA was designed for simplicity rather than
   completeness.  In particular, the Simple DNA protocol provides
   maximum benefits when a host moves between a small set of known
   links.  When a host moves to a completely new link that is previously
   unknown, the performance of the Simple DNA protocol will be identical
   to that using standard neighbor discovery procedures [<a href="rfc4861.html" title='"Neighbor Discovery for IP version 6 (IPv6)"'>RFC4861</a>].  In
   this case, the main benefit of the Simple DNA protocol is to



<span class="grey">Krishnan &amp; Daley             Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6059.html">RFC 6059</a>                       Simple DNA                  November 2010</span>


   immediately flush out the inoperable addresses and configuration
   instead of timing them out.  The Simple DNA procedure provides
   support for addresses configured using either IPv6 Stateless Address
   Autoconfiguration [<a href="rfc4862.html" title='"IPv6 Stateless Address Autoconfiguration"'>RFC4862</a>] or DHCPv6 [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>].  It does not support
   manually configured addresses since they are not widely used and can
   cause unpredictable results and/or aggressive probing behavior (see
   <a href="#appendix-A">Appendix A</a>).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20Link%20Identification%20Model"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  Link Identification Model</span>

   Earlier methods of Detecting Network Attachment, e.g., the procedure
   defined in [<a href="#ref-DNA-PROTOCOL" title='"Design Alternative for Detecting Network Attachment in IPv6 Networks (DNAv6 Design Alternative)"'>DNA-PROTOCOL</a>], relied on detecting whether the host was
   still connected to the same link.  If the host was attached to the
   same link, all information related to the link such as the routers,
   prefixes, and configuration parameters was considered to be valid.
   The Simple DNA protocol follows an alternate approach where it relies
   on probing each previously known router to determine whether to use
   information learnt from THAT router.  This allows Simple DNA to probe
   routers learnt from multiple earlier attachments to optimize movement
   between a known set of links.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.4.%20%20DNA%20Overview"></a><a class="selflink" href="#section-1.4" name="section-1.4">1.4</a>.  DNA Overview</span>

   Detecting Network Attachment is performed by hosts after detecting a
   link-layer "up" indication.  The host uses a combination of unicast
   Neighbor Solicitations (NSs) and multicast Router Solicitations (RSs)
   in order to determine whether previously encountered routers are
   present on the link, in which case an existing configuration can be
   reused.  If previously encountered routers are not present, then
   either IPv6 Stateless Address Autoconfiguration and/or DHCPv6 is used
   for configuration.

   Hosts implementing Simple DNA may also send DHCPv6 packets, as
   described in <a href="#section-5.5.4">Section 5.5.4</a>.  Since Simple DNA does not modify the
   DHCPv6 protocol or state machine, the operation of DHCPv6 is
   unchanged.

   Routers that follow the standard neighbor discovery procedure
   described in [<a href="rfc4861.html" title='"Neighbor Discovery for IP version 6 (IPv6)"'>RFC4861</a>] will delay the router advertisement (RA) by a
   random period between 0 and MAX_RA_DELAY_TIME (defined to be 500 ms)
   as described in <a href="rfc4861.html#section-6.2.6">Section 6.2.6 of [RFC4861]</a>.  In addition, consecutive
   RAs sent to the all-nodes multicast address are rate limited to no
   more than one advertisement every MIN_DELAY_BETWEEN_RAS (defined to
   be 3 seconds).  This will result in a worst-case delay of 3.5 seconds
   in the absence of any packet loss.






<span class="grey">Krishnan &amp; Daley             Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6059.html">RFC 6059</a>                       Simple DNA                  November 2010</span>


   Hosts implementing Simple DNA can detect the presence of a previously
   encountered router using unicast Neighbor Solicitations.  As a
   result, where the host with a valid configuration is returning to a
   previously encountered link, delays in the sending of a Router
   Advertisement (RA) will not delay configuration as long as NS probing
   is successful.  However, in situations where the host is attaching to
   a link for the first time, or where it does not have a valid IP
   address on the link, it will be dependent on the receipt of an RA for
   stateless autoconfiguration.  In these situations, delays in the
   receipt of an RA can be significant and may result in service
   disruption.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.5.%20%20Working%20Assumptions"></a><a class="selflink" href="#section-1.5" name="section-1.5">1.5</a>.  Working Assumptions</span>

   There are a series of assumptions about the network environment that
   underpin these procedures.

   o  The combination of the link-layer address and the link-local IPv6
      address of a router is unique across links.

   o  Hosts receive indications when a link layer comes up.  Without
      this, they would not know when to commence the DNA procedure.

   If these assumptions do not hold, host change detection systems will
   not function optimally.  In that case, they may occasionally detect
   change spuriously or experience some delay in Detecting Network
   Attachment.  The delays so experienced will be no longer than those
   caused by following the standard neighbor discovery procedure
   described in [<a href="rfc4861.html" title='"Neighbor Discovery for IP version 6 (IPv6)"'>RFC4861</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Requirements%20Notation"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Requirements Notation</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].
















<span class="grey">Krishnan &amp; Daley             Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6059.html">RFC 6059</a>                       Simple DNA                  November 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Terminology"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Terminology</span>

   +---------------------+---------------------------------------------+
   |         Term        | Definition                                  |
   +---------------------+---------------------------------------------+
   |  Valid IPv6 address | An IPv6 address configured on the node that |
   |                     | has a valid lifetime greater than zero.     |
   |                     |                                             |
   |    Operable IPv6    | An IPv6 address configured on the node that |
   |       address       | can be used safely on the current link.     |
   |                     |                                             |
   |  Router identifier  | Identifier formed using the link-local      |
   |                     | address of a router along with its          |
   |                     | link-layer address.                         |
   |                     |                                             |
   |        D-Flag       | Flag indicating whether the address was     |
   |                     | obtained using Stateless Address            |
   |                     | Autoconfiguration (SLAAC) or DHCPv6.  If it |
   |                     | is set to 0, then SLAAC was used to         |
   |                     | configure the address.  If it is set to 1,  |
   |                     | then DHCPv6 was used to configure the       |
   |                     | address.                                    |
   |                     |                                             |
   |        O-Flag       | Flag indicating whether the address is      |
   |                     | operable.  If it is set to 0, the address   |
   |                     | is inoperable.  If it is set to 1, the      |
   |                     | address is operable.                        |
   |                     |                                             |
   |        S-Flag       | Flag indicating whether SEND [<a href="rfc3971.html" title='"SEcure Neighbor Discovery (SEND)"'>RFC3971</a>] was  |
   |                     | used in the Router Advertisement that       |
   |                     | resulted in the creation/modification of    |
   |                     | this SDAT entry.  If it is set to 0, then   |
   |                     | SEND was not used.  If it is set to 1, then |
   |                     | SEND was used.                              |
   |                     |                                             |
   |   Candidate Router  | A router address in the SDAT that is        |
   |       Address       | associated with at least one valid address. |
   |                     |                                             |
   |   Candidate Router  | A set of router addresses that has been     |
   |         Set         | identified for NS-based probing.            |
   +---------------------+---------------------------------------------+

                      Table 1: Simple DNA Terminology








<span class="grey">Krishnan &amp; Daley             Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6059.html">RFC 6059</a>                       Simple DNA                  November 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20The%20Simple%20DNA%20Address%20Table%20%28SDAT%29"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  The Simple DNA Address Table (SDAT)</span>

   In order to correctly perform the procedure described in this
   document, the host needs to maintain a data structure called the
   Simple DNA address table (SDAT).  The host needs to maintain this
   data structure for each interface on which it performs Simple DNA.
   Each entry in the SDAT table will be indexed by the router identifier
   (link-local + link-layer address of the router) and consists of at
   least the following parameters.  Fields tagged as [S] are used for
   addresses configured using SLAAC.  Fields tagged as [D] are used for
   addresses obtained using DHCPv6.  Fields tagged as [S+D] are used in
   both cases.

   o  [S+D] Link-local IPv6 address of the router(s)

   o  [S+D] Link-layer (MAC) address of the router(s)

   o  [S+D] Flag indicating whether the address was obtained using SLAAC
      or DHCPv6.  (The D-Flag)

   o  [S+D] IPv6 address and its related parameters like valid lifetime,
      preferred lifetime, etc.

   o  [S] Prefix from which the address was formed.

   o  [S] Flag indicating whether SEND was used.  (The S-Flag)

   o  [D] DHCP-specific information in case DHCPv6 [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>] was used to
      acquire the address.  This information includes the DUID, the
      IAID, a flag indicating IA_NA/IA_TA, and configuration information
      such as DNS server address, NTP server address, etc.

   o  [S+D] Flag indicating whether the address is operable.  (The
      O-Flag)

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Host%20Operations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Host Operations</span>

   On connecting to a new point of attachment, the host performs the
   Detecting Network Attachment procedure in order to determine whether
   the existing addressing and configuration information are still
   valid.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20On%20Receipt%20of%20a%20Router%20Advertisement"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  On Receipt of a Router Advertisement</span>

   When the host receives a Router Advertisement and the router
   identifier of the sending router is not present in the SDAT, the host
   processes the Router Advertisement as specified in <a href="rfc4861.html#section-6.3.4">Section 6.3.4 of
   [RFC4861]</a>.  Additionally, the host performs the following operations.



<span class="grey">Krishnan &amp; Daley             Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6059.html">RFC 6059</a>                       Simple DNA                  November 2010</span>


   If the Router Advertisement is protected by SEND, the S-Flag MUST be
   set to 1 in the SDAT entries created/modified by this RA.

   o  The host configures addresses out of the autoconfigurable prefixes
      advertised in the RA, as specified in [<a href="rfc4862.html" title='"IPv6 Stateless Address Autoconfiguration"'>RFC4862</a>].  The host MUST
      add an SDAT entry (indexed by this router identifier) for each
      such address the host configures.

   o  The host might have already configured addresses out of the
      autoconfigurable prefixes advertised in the RA.  This could be a
      result of receiving the prefix in an RA from another router on the
      same link.  The host MUST add an SDAT entry (indexed by this
      router identifier) for each such address the host had already
      configured.

   o  The host might have DHCPv6-assigned addresses that are known to be
      operable on the link.  The host MUST add an SDAT entry (indexed by
      this router identifier) for each such DHCPv6 address.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20After%20Assignment%20of%20a%20DHCPv6%20Address"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  After Assignment of a DHCPv6 Address</span>

   After the host is assigned an address by a DHCPv6 server, it needs to
   associate the address with the routers on link.  The host MUST create
   one SDAT entry for each of the on-link routers associated with the
   DHCPv6-assigned address.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Steps%20Involved%20in%20Detecting%20Link%20Change"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Steps Involved in Detecting Link Change</span>

   The steps involved in basic detection of network attachment are:

   o  Link-layer indication

   o  Sending of neighbor discovery probes

   o  Response gathering and assessment

   These steps are described below.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20Link-Layer%20Indication"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  Link-Layer Indication</span>

   In order to start detection of network attachment procedures, a host
   typically requires a link-layer indication that the medium has become
   available [<a href="rfc4957.html" title='"Link-Layer Event Notifications for Detecting Network Attachments"'>RFC4957</a>].

   After the indication is received, the host MUST mark all currently
   configured (non-tentative) IP addresses as inoperable until the
   change detection process completes.  It MUST also set all Neighbor




<span class="grey">Krishnan &amp; Daley             Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6059.html">RFC 6059</a>                       Simple DNA                  November 2010</span>


   Cache (NC) entries for the routers on its Default Router List to
   STALE.  This is done to speed up the acquisition of a new default
   router in case the host attaches to a previously unvisited link.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.5.%20%20Sending%20Neighbor%20Discovery%20probes"></a><a class="selflink" href="#section-5.5" name="section-5.5">5.5</a>.  Sending Neighbor Discovery probes</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.5.1.%20%20Sending%20Router%20Solicitations"></a><a class="selflink" href="#section-5.5.1" name="section-5.5.1">5.5.1</a>.  Sending Router Solicitations</span>

   When a host receives a link-layer "up" indication, it SHOULD
   immediately send a Router Solicitation (as specified in <a href="rfc4861.html#section-6.3.7">Section 6.3.7
   of [RFC4861]</a>).  The Router Solicitation is sent to the all-routers
   multicast address using a link-local address as the source address
   [<a href="rfc4861.html" title='"Neighbor Discovery for IP version 6 (IPv6)"'>RFC4861</a>].  Even if the host is in possession of more than one valid
   IPv6 address, it MUST send only one router solicitation using a valid
   link-local address as the source address.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.5.2.%20%20Sending%20Neighbor%20Solicitations"></a><a class="selflink" href="#section-5.5.2" name="section-5.5.2">5.5.2</a>.  Sending Neighbor Solicitations</span>

   The host iterates through the SDAT to identify a set of candidate
   routers for NS-based probing.  Each router in the SDAT that is
   associated with at least one valid address is added to the candidate
   router set exactly once.  For each router in the candidate router
   set, the host MUST send a unicast Neighbor Solicitation to the
   router's link-local address it obtained from the lookup on the SDAT.
   The host MUST set the link-layer destination address in each of these
   neighbor solicitations to the link-layer address of the router stored
   in the SDAT.  The host MUST NOT send unicast Neighbor Solicitations
   to a router that is not associated to a valid address in the SDAT.
   If at least one entry in the SDAT for a given router had the S-Flag
   set, the host SHOULD use SEND to secure the NS probe being sent to
   the router.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.5.3.%20%20Concurrent%20Sending%20of%20RS%20and%20NS%20Probes"></a><a class="selflink" href="#section-5.5.3" name="section-5.5.3">5.5.3</a>.  Concurrent Sending of RS and NS Probes</span>

   The host SHOULD send the Neighbor-Solicitation-based unicast probes
   in parallel with the multicast Router Solicitation.  Since sending
   NSs is just an optimization, doing the NSs and the RS in parallel
   ensures that the procedure does not run slower than it would if it
   only used a Router Solicitation.

   NOTE: A Simple DNA implementation SHOULD limit its NS-based probing
   to at most six previously seen routers.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.5.4.%20%20Initiating%20DHCPv6%20Exchange"></a><a class="selflink" href="#section-5.5.4" name="section-5.5.4">5.5.4</a>.  Initiating DHCPv6 Exchange</span>

   On receiving a link-layer "up" indication, the host will initiate a
   DHCPv6 exchange (with the timing and protocol as specified in
   [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>]) in order to verify whether the addresses and configuration



<span class="grey">Krishnan &amp; Daley             Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6059.html">RFC 6059</a>                       Simple DNA                  November 2010</span>


   obtained using DHCPv6 are still usable on the link.  Note that
   DHCPv6, as specified today, only attempts to confirm addresses
   obtained on the most recently attached link.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.6.%20%20Contents%20of%20the%20Neighbor%20Discovery%20Messages"></a><a class="selflink" href="#section-5.6" name="section-5.6">5.6</a>.  Contents of the Neighbor Discovery Messages</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.6.1.%20%20Neighbor%20Solicitation%20Messages"></a><a class="selflink" href="#section-5.6.1" name="section-5.6.1">5.6.1</a>.  Neighbor Solicitation Messages</span>

   This section describes the contents of the neighbor solicitation
   probe messages sent during the probing procedure.

   Source Address:           A link-local address assigned to the
                             probing host.

   Destination Address:      The link-local address of the router being
                             probed as learned from the SDAT.

   Hop Limit:                255

   ND Options:

      Target Address:        The link-local address of the router being
                             probed as learnt from the SDAT.

   Link-Layer Header:

      Destination Address:   The link-layer (MAC) address of the router
                             being probed as learnt from the SDAT.

   The probing node SHOULD include the source link-layer address option
   in the probe messages.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.6.2.%20%20Router%20Solicitation%20Messages"></a><a class="selflink" href="#section-5.6.2" name="section-5.6.2">5.6.2</a>.  Router Solicitation Messages</span>

   This section describes the contents of the router solicitation probe
   message sent during the probing procedure.

   Source Address:           A link-local address assigned to the
                             probing host.

   Destination Address:      The all-routers multicast address.

   Hop Limit:                255

   The probing node SHOULD NOT include the source link-layer address
   option in the probe messages.





<span class="grey">Krishnan &amp; Daley             Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc6059.html">RFC 6059</a>                       Simple DNA                  November 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.7.%20%20Response%20Gathering"></a><a class="selflink" href="#section-5.7" name="section-5.7">5.7</a>.  Response Gathering</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.7.1.%20%20Receiving%20Neighbor%20Advertisements"></a><a class="selflink" href="#section-5.7.1" name="section-5.7.1">5.7.1</a>.  Receiving Neighbor Advertisements</span>

   When a Neighbor Advertisement is received from a router in response
   to an NS probe, the host MUST verify that both the IPv6 and link-
   layer (MAC) addresses of the router match the expected values before
   utilizing the configuration associated with the detected network
   (prefixes, MTU, etc.).  The host MUST then go through the SDAT and
   mark the addresses (both SLAAC and DHCPv6 acquired) associated with
   the router as operable.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.7.2.%20%20Receiving%20Router%20Advertisements"></a><a class="selflink" href="#section-5.7.2" name="section-5.7.2">5.7.2</a>.  Receiving Router Advertisements</span>

   On reception of a Router Advertisement, the host MUST go through the
   SDAT and mark all the addresses associated with the router (both
   SLAAC and DHCPv6 acquired) as inoperable.  The host MUST then process
   the Router Advertisement as specified in <a href="rfc4861.html#section-6.3.4">Section 6.3.4 of [RFC4861]</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.7.3.%20%20Conflicting%20Results"></a><a class="selflink" href="#section-5.7.3" name="section-5.7.3">5.7.3</a>.  Conflicting Results</span>

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/5.7.3.1.%20%20Conflicting%20Results%20between%20RS%20and%20NS%20Probes"></a><a class="selflink" href="#section-5.7.3.1" name="section-5.7.3.1">5.7.3.1</a>.  Conflicting Results between RS and NS Probes</span>

   Where the conclusions obtained from the Neighbor Solicitation/
   Advertisement from a given router and the RS/RA exchange with the
   same router differ, the results obtained from the RS/RA will be
   considered definitive.  In case the Neighbor Advertisement was
   secured using SEND and the Router Advertisement was not, the host
   MUST wait for SEND_NA_GRACE_TIME to see if a SEND-secured RA is
   received.  If a SEND-secured RA is not received, the conclusions
   obtained from the NS/NA exchange will be considered definitive.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/5.7.3.2.%20%20Conflicting%20Results%20between%20DHCPv6%20and%20NS%20Probes"></a><a class="selflink" href="#section-5.7.3.2" name="section-5.7.3.2">5.7.3.2</a>.  Conflicting Results between DHCPv6 and NS Probes</span>

   Where the conclusions obtained from the Neighbor Solicitation/
   Advertisement for a given DHCPv6-assigned address and the conclusions
   obtained from the DHCPv6 exchange differ, the results obtained from
   the DHCPv6 exchange will be considered definitive.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.8.%20%20Further%20Host%20Operations"></a><a class="selflink" href="#section-5.8" name="section-5.8">5.8</a>.  Further Host Operations</span>

   Operations subsequent to Detecting Network Attachment depend upon
   whether or not the host has reconnected to a previously visited
   network.

   After confirming the reachability of the associated router using an
   NS/NA pair, the host performs the following steps.




<span class="grey">Krishnan &amp; Daley             Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc6059.html">RFC 6059</a>                       Simple DNA                  November 2010</span>


   o  The host SHOULD rejoin any solicited nodes' multicast groups for
      addresses it continues to use.

   o  The host SHOULD select a default router as described in <a href="rfc4861.html#section-6.3.6">Section</a>
      <a href="rfc4861.html#section-6.3.6">6.3.6 of [RFC4861]</a>.

   If the host has determined that it has reattached to a previously
   visited link, it SHOULD NOT perform duplicate address detection on
   the addresses that have been confirmed to be operable.

   If the NS-based probe with a router did not complete or if the RS-
   based probe on the same router completed with different prefixes than
   the ones in the SDAT, the host MUST begin address configuration
   techniques, as indicated in a received Router Advertisement [<a href="rfc4861.html" title='"Neighbor Discovery for IP version 6 (IPv6)"'>RFC4861</a>]
   [<a href="rfc4862.html" title='"IPv6 Stateless Address Autoconfiguration"'>RFC4862</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.9.%20%20On%20Connecting%20to%20a%20New%20Point%20of%20Attachment"></a><a class="selflink" href="#section-5.9" name="section-5.9">5.9</a>.  On Connecting to a New Point of Attachment</span>

   A host usually maintains SDAT entries from some number of previously
   visited networks.  When the host attaches to a previously unknown
   network, it MAY need to discard some older SDAT entries.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.10.%20%20Periodic%20Maintenance%20of%20the%20SDAT"></a><a class="selflink" href="#section-5.10" name="section-5.10">5.10</a>.  Periodic Maintenance of the SDAT</span>

   The host SHOULD maintain the SDAT table by removing entries when the
   valid lifetime for the prefix and address expires, that is, at the
   same time that the prefix is removed from the Prefix List in
   [<a href="rfc4861.html" title='"Neighbor Discovery for IP version 6 (IPv6)"'>RFC4861</a>].  The host SHOULD also remove a router from an SDAT entry
   when that router stops advertising a particular prefix.  When three
   consecutive RAs from a particular router have not included a prefix,
   then the router should be removed from the corresponding SDAT entry.
   Likewise, if a router starts advertising a prefix for which there
   already exists an SDAT entry,then that router should be added to the
   SDAT entry.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.11.%20%20Recommended%20Retransmission%20Behavior"></a><a class="selflink" href="#section-5.11" name="section-5.11">5.11</a>.  Recommended Retransmission Behavior</span>

   Where the NS probe does not complete successfully, it usually implies
   that the host is not attached to the network whose configuration is
   being tested.  In such circumstances, there is typically little value
   in aggressively retransmitting unicast neighbor solicitations that do
   not elicit a response.

   Where unicast Neighbor Solicitations and Router Solicitations are
   sent in parallel, one strategy is to forsake retransmission of
   Neighbor Solicitations and to allow retransmission only of Router
   Solicitations or DHCPv6.  In order to reduce competition between
   unicast Neighbor Solicitations and Router Solicitations and DHCPv6



<span class="grey">Krishnan &amp; Daley             Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc6059.html">RFC 6059</a>                       Simple DNA                  November 2010</span>


   retransmissions, a DNAv6 implementation that retransmits may utilize
   the retransmission strategy described in the DHCPv6 specification
   [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>], scheduling DNAv6 retransmissions between Router
   Solicitations or DHCPv6 retransmissions.

   If a response is received to any unicast Neighbor Solicitation,
   pending retransmissions of the same MUST be canceled.  A Simple DNA
   implementation SHOULD NOT retransmit a Neighbor Solicitation more
   than twice.  To provide damping in the case of spurious link-up
   indications, the host SHOULD NOT perform the Simple DNA procedure
   more than once a second.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Pseudocode%20for%20Simple%20DNA"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Pseudocode for Simple DNA</span>

   /* Link-up indication received on INTERFACE */
   /* Start Simple DNA process */

   /* Mark all addresses as inoperable */
   Configured_Address_List=Get_Address_List(INTERFACE);
   for each Configured_Address in Configured_Address_List
   {
     if (Get_Address_State(Configured_Address)!=AS_TENTATIVE)
     {
       Set_Address_State(Configured_Address,AS_INOPERABLE);
     }
   }

   /* Mark all routers' NC entries as STALE to speed up */
   /* acquisition of new router if link change has occurred */
   for each Router_Address in DEFAULT_ROUTER_LIST
   {
     NCEntry=Get_Neighbor_Cache_Entry(Router_Address);
     Set_Neighbor_Cache_Entry_State(NCEntry,NCS_STALE);
   }

   /* Thread A : Send Router Solicitation */
   RS_Target_Address=FF02::2;
   RS_Source_Address=Get_Any_Link_Local_Address(INTERFACE);
   Send_Router_Solicitation(RS_Source_Address,RS_Target_Address);

   /* Thread B : Send Neighbor Solicitation(s) */
   Previously_Known_Router_List=Get_Router_List_from_SDAT();
   NS_Source_Address=Get_Any_Link_Local_Address(INTERFACE);








<span class="grey">Krishnan &amp; Daley             Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc6059.html">RFC 6059</a>                       Simple DNA                  November 2010</span>


   for each Router_Address in Previously_Known_Router_List
   {
     if (Get_Any_Valid_Address_from_SDAT(Router_Address))
     {
       Send_Neighbor_Solicitation(NS_Source_Address,
                                  Router_Address.L3_Address,
                                  Router_Address.L2_Address);
     }
   }

   /* Thread C : Response collection of RAs */

   /* Received Router Advertisement processing */
   /* Only for RAs received from routers in the SDAT */

   L3_Source=Get_L3_Source(RECEIVED_MESSAGE);
   L2_Source=Get_L2_Source(RECEIVED_MESSAGE);
   SDAT_Entry_List=Get_Entries_from_SDAT_L2L3(L3_Source,L2_Source));

   /* Mark all the addresses associated with the router as inoperable */
   for each SDAT_Entry in SDAT_Entry_List
   {
       Set_Address_State(SDAT_Entry,AS_INOPERABLE);
   }

   /* Ignore further NAs from this router */
   /* after delaying for x milliseconds */
   Add_Router_to_NA_Ignore_List(L3_Source,SEND_NA_GRACE_PERIOD);

   /* Perform Standard RA processing as per <a href="rfc4861.html">RFC 4861</a> / <a href="rfc4862.html">RFC 4862</a> */


   /* Thread D : Response collection of NAs */

   /* Received Neighbor Advertisement processing */
   /* Only for NAs received as response to DNA NSs */

   L3_Source=Get_L3_Source(RECEIVED_MESSAGE);
   L2_Source=Get_L2_Source(RECEIVED_MESSAGE);

   if (Is_Router_on_NA_Ignore_List(L3_Source)) {
     /* Ignore message and wait for next message */
     continue;
   }

   SDAT_Entry_List=Get_Entries_from_SDAT_L2L3(L3_Source,L2_Source));





<span class="grey">Krishnan &amp; Daley             Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc6059.html">RFC 6059</a>                       Simple DNA                  November 2010</span>


   for each SDAT_Entry in SDAT_Entry_List
   {
       /* Address is operable. */
       Set_Address_State(SDAT_Entry,AS_OPERABLE);
       /* Configure on Interface */
   }

                    Figure 1: Pseudocode for Simple DNA

   NOTE: This section does not include any pseudocode for sending of the
   DHCPv6 packets since the DHCPv6 exchange is orthogonal to the Simple
   DNA process.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Constants"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Constants</span>

      SEND_NA_GRACE_TIME

         Definition: An optional period to wait after Neighbor
         Solicitation before adopting a non-SEND RA's link change
         information.

         Value: 40 milliseconds

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Relationship%20to%20DNAv4"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Relationship to DNAv4</span>

   DNAv4 [<a href="rfc4436.html" title='"Detecting Network Attachment in IPv4 (DNAv4)"'>RFC4436</a>] specifies a set of steps that optimize the (common)
   case of reattachment to an IPv4 network that a host has been
   connected to previously by attempting to reuse a previous (but still
   valid) configuration.  This document shares the same goal as DNAv4
   (that of minimizing the handover latency in moving between points of
   attachment) but differs in the steps it performs to achieve this
   goal.  Another difference is that this document supports stateless
   autoconfiguration of addresses in addition to addresses configured
   using DHCPv6.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Security%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Security Considerations</span>

   A host may receive Router Advertisements from non-SEND devices, after
   receiving a link-layer indication.  While it is necessary to assess
   quickly whether a host has moved to another network, it is important
   that the host's current secured SEND [<a href="rfc3971.html" title='"SEcure Neighbor Discovery (SEND)"'>RFC3971</a>] router information is
   not replaced by an attacker that spoofs an RA and purports to change
   the link.

   As such, the host SHOULD send a Neighbor Solicitation to the existing
   SEND router upon link-up indication as described above in
   <a href="#section-5.4">Section 5.4</a>.  The host SHOULD then ensure that unsecured router




<span class="grey">Krishnan &amp; Daley             Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc6059.html">RFC 6059</a>                       Simple DNA                  November 2010</span>


   information does not cause deletion of existing SEND state, within
   MIN_DELAY_BETWEEN_RAS, in order to allow for a present SEND router to
   respond.

   If the current default router is a SEND-secured router, the host
   SHOULD wait SEND_NA_GRACE_TIME after transmission before adopting a
   new default router.

   Even if SEND signatures on RAs are used, it may not be immediately
   clear if the router is authorized to make such advertisements.  As
   such, a host SHOULD NOT treat such devices as secure until and unless
   authorization delegation discovery is successful.

   Unless SEND or another form of secure address configuration is used,
   the DNA procedure does not in itself provide positive, secure
   authentication of the router(s) on the network, or authentication of
   the network itself, as would be provided, e.g., by mutual
   authentication at the link layer.  Therefore, when such assurance is
   not available, the host MUST NOT make any security-sensitive
   decisions based on the DNA procedure alone.  In particular, it MUST
   NOT decide that it has moved from an untrusted to a trusted network,
   and MUST NOT make any security decisions that depend on the
   determination that such a transition has occurred.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Acknowledgments"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Acknowledgments</span>

   This document is the product of a discussion the authors had with
   Bernard Aboba, Thomas Narten, Erik Nordmark, and Dave Thaler at IETF
   69.  The authors would like to thank them for clearly detailing the
   requirements of the solution and the goals it needed to meet and for
   helping to explore the solution space.  The authors would like to
   thank the authors and editors of the complete DNA specification for
   detailing the overall problem space and solutions.  The authors would
   like to thank Jari Arkko for driving the evolution of a simple and
   probabilistic DNA solution.  The authors would like to thank Bernard
   Aboba, Thomas Narten, Jari Arkko, Sathya Narayan, Julien Laganier,
   Domagoj Premec, Jin Hyeock-Choi, Alfred Hoenes, Frederic Rossi, Ralph
   Droms, Ted Lemon, Erik Nordmark, Lars Eggert, Brian Carpenter, and
   Yaron Sheffer for performing reviews on the document and providing
   valuable comments to drive the document forward.











<span class="grey">Krishnan &amp; Daley             Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc6059.html">RFC 6059</a>                       Simple DNA                  November 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20References"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.1.%20%20Normative%20References"></a><a class="selflink" href="#section-11.1" name="section-11.1">11.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]       Bradner, S., "Key words for use in RFCs to Indicate
                   Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC3315" name="ref-RFC3315">RFC3315</a>]       Droms, R., Bound, J., Volz, B., Lemon, T., Perkins,
                   C., and M. Carney, "Dynamic Host Configuration
                   Protocol for IPv6 (DHCPv6)", <a href="rfc3315.html">RFC 3315</a>, July 2003.

   [<a id="ref-RFC3971" name="ref-RFC3971">RFC3971</a>]       Arkko, J., Kempf, J., Zill, B., and P. Nikander,
                   "SEcure Neighbor Discovery (SEND)", <a href="rfc3971.html">RFC 3971</a>, March
                   2005.

   [<a id="ref-RFC4861" name="ref-RFC4861">RFC4861</a>]       Narten, T., Nordmark, E., Simpson, W., and H.
                   Soliman, "Neighbor Discovery for IP version 6
                   (IPv6)", <a href="rfc4861.html">RFC 4861</a>, September 2007.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.2.%20%20Informative%20References"></a><a class="selflink" href="#section-11.2" name="section-11.2">11.2</a>.  Informative References</span>

   [<a id="ref-DNA-PROTOCOL" name="ref-DNA-PROTOCOL">DNA-PROTOCOL</a>]  Narayanan, S., Ed., "Design Alternative for Detecting
                   Network Attachment in IPv6 Networks (DNAv6 Design
                   Alternative)", Work in Progress, November 2009.

   [<a id="ref-RFC4436" name="ref-RFC4436">RFC4436</a>]       Aboba, B., Carlson, J., and S. Cheshire, "Detecting
                   Network Attachment in IPv4 (DNAv4)", <a href="rfc4436.html">RFC 4436</a>, March
                   2006.

   [<a id="ref-RFC4862" name="ref-RFC4862">RFC4862</a>]       Thomson, S., Narten, T., and T. Jinmei, "IPv6
                   Stateless Address Autoconfiguration", <a href="rfc4862.html">RFC 4862</a>,
                   September 2007.

   [<a id="ref-RFC4957" name="ref-RFC4957">RFC4957</a>]       Krishnan, S., Montavont, N., Njedjou, E., Veerepalli,
                   S., and A. Yegin, "Link-Layer Event Notifications for
                   Detecting Network Attachments", <a href="rfc4957.html">RFC 4957</a>, August
                   2007.














<span class="grey">Krishnan &amp; Daley             Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc6059.html">RFC 6059</a>                       Simple DNA                  November 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Issues%20with%20Confirming%20Manually%20Assigned%20Addresses"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Issues with Confirming Manually Assigned Addresses</span>

   Even though DNAv4 [<a href="rfc4436.html" title='"Detecting Network Attachment in IPv4 (DNAv4)"'>RFC4436</a>] supports verification of manually
   assigned addresses, this feature of DNAv4 has not been widely
   implemented or used.  There are two major issues that come up with
   confirming manually assigned addresses using Simple DNA.

   o  When DHCPv6 or SLAAC addresses are used for probing, there is no
      need to aggressively retransmit lost probes.  This is because the
      address configuration falls back to vanilla DHCPv6 or SLAAC, and
      the host will eventually obtain an address.  This is not the case
      with manually assigned addresses.  If the probes are lost, the
      host runs the risk of ending up with no addresses at all.  Hence,
      aggressive retransmissions are necessary.

   o  Another issue comes up when the host moves between two networks,
      one where manual addressing is being used (say, NET1) and the
      other where dynamic addressing (stateless autoconfiguration or
      DHCPv6) is being used (say, NET2).  Since the host can obtain a
      dynamic address in some situations, it will need to send Simple
      DNA probes and may also engage in a DHCPv6 exchange.  In a
      situation where the host moves to NET1 and the NS probes are lost
      and in addition an RA is not received, the host will not be able
      to confirm that it attached to NET1, and therefore that it should
      use the manual configuration for that network.  As a result, if
      DHCPv6 is enabled on NET1, then the host could mistakenly obtain a
      dynamic address and configuration instead of using the manual
      configuration.  To prevent this problem, Simple DNA probing needs
      to continue even after the DHCPv6 exchange has completed, and DNA
      probes need to take precedence over DHCPv6, contrary to the advice
      provided in <a href="#section-5.7.3">Section 5.7.3</a>.

   Given these issues, it is NOT RECOMMENDED to use manual addressing
   with Simple DNA.

















<span class="grey">Krishnan &amp; Daley             Standards Track                   [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc6059.html">RFC 6059</a>                       Simple DNA                  November 2010</span>


Authors' Addresses

   Suresh Krishnan
   Ericsson
   8400 Decarie Blvd.
   Town of Mount Royal, QC
   Canada

   Phone: +1 514 345 7900 x42871
   EMail: suresh.krishnan@ericsson.com


   Greg Daley
   Netstar Logicalis
   Level 6/616 St Kilda Road
   Melbourne, Victoria  3004
   Australia

   Phone: +61 401 772 770
   EMail: hoskuld@hotmail.com































Krishnan &amp; Daley             Standards Track                   [Page 19]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc6059 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:32 GMT --></html>