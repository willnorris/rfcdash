<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from tools.ietf.org/html/rfc8361 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:14:53 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.129c" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Relation.Replaces" content="draft-hao-trill-centralized-replication" />
<meta name="DC.Identifier" content="urn:ietf:rfc:8361" />
<meta name="DC.Date.Issued" content="April, 2018" />
<meta name="DC.Creator" content="Qu, Andrew" />
<meta name="DC.Creator" content="Gupta, Sujay" />
<meta name="DC.Creator" content="Durrani, Muhammad" />
<meta name="DC.Description.Abstract" content="In Transparent Interconnection of Lots of Links (TRILL) active-active
access, a Reverse Path Forwarding (RPF) check failure issue may occur
when using the pseudo-nickname mechanism specified in RFC 7781. This
document describes a solution to resolve this RPF check failure issue
through centralized replication. All ingress Routing Bridges
(RBridges) send Broadcast, Unknown Unicast, and Multicast (BUM)
traffic to a centralized node with unicast TRILL encapsulation. When
the centralized node receives the BUM traffic, it decapsulates the
packets and forwards them to their destination RBridges using a
distribution tree established per the TRILL base protocol (RFC 6325).
To avoid RPF check failure on an RBridge sitting between the ingress
RBridge and the centralized replication node, some change in the RPF
calculation algorithm is required. RPF checks on each RBridge MUST be
calculated as if the centralized node was the ingress RBridge, instead
of being calculated using the actual ingress RBridge. This document
updates RFC 6325." />
<meta name="DC.Title" content="Transparent Interconnection of Lots of Links (TRILL): Centralized Replication for Active-Active Broadcast, Unknown Unicast, and Multicast (BUM) Traffic" />

    <link rel="icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 8361 - Transparent Interconnection of Lots of Links (TRILL): Centralized Replication for Active-Active Broadcast, Unknown Unicast, and Multicast (BUM) Traffic</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgblue"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc8361.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc8361" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-trill-centralized-replication" title="draft-ietf-trill-centralized-replication">draft-ietf-tril...</a>] [<a href='https://datatracker.ietf.org/doc/rfc8361' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc8361" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc8361" title="Side-by-side diff">Diff2</a>]         </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Internet Engineering Task Force (IETF)                            W. Hao
Request for Comments: 8361                                         Y. Li
Updates: <a href="rfc6325.html">6325</a>                                        Huawei Technologies
Category: Standards Track                                     M. Durrani
ISSN: 2070-1721                                                  Equinix
                                                                S. Gupta
                                                             IP Infusion
                                                                   A. Qu
                                                                MediaTec
                                                              April 2018


         <span class="h1">Transparent Interconnection of Lots of Links (TRILL):</span>
               <span class="h1">Centralized Replication for Active-Active</span>
        <span class="h1">Broadcast, Unknown Unicast, and Multicast (BUM) Traffic</span>

Abstract

   In Transparent Interconnection of Lots of Links (TRILL) active-active
   access, a Reverse Path Forwarding (RPF) check failure issue may occur
   when using the pseudo-nickname mechanism specified in <a href="rfc7781.html">RFC 7781</a>.  This
   document describes a solution to resolve this RPF check failure issue
   through centralized replication.  All ingress Routing Bridges
   (RBridges) send Broadcast, Unknown Unicast, and Multicast (BUM)
   traffic to a centralized node with unicast TRILL encapsulation.  When
   the centralized node receives the BUM traffic, it decapsulates the
   packets and forwards them to their destination RBridges using a
   distribution tree established per the TRILL base protocol (<a href="rfc6325.html">RFC 6325</a>).
   To avoid RPF check failure on an RBridge sitting between the ingress
   RBridge and the centralized replication node, some change in the RPF
   calculation algorithm is required.  RPF checks on each RBridge MUST
   be calculated as if the centralized node was the ingress RBridge,
   instead of being calculated using the actual ingress RBridge.  This
   document updates <a href="rfc6325.html">RFC 6325</a>.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc7841.html#section-2">Section&nbsp;2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8361">https://www.rfc-editor.org/info/rfc8361</a>.



<span class="grey">Hao, et al.                  Standards Track                    [Page 1]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc8361.html">RFC 8361</a>         Centralized Replication for BUM Traffic      April 2018</span>


Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
   <a href="#section-2">2</a>. Conventions Used in This Document ...............................<a href="#page-3">3</a>
   <a href="#section-3">3</a>. Centralized Replication Solution Overview .......................<a href="#page-4">4</a>
   <a href="#section-4">4</a>. Frame Duplication from Remote RBridge ...........................<a href="#page-6">6</a>
   <a href="#section-5">5</a>. Local Forwarding Behavior on Ingress RBridge ....................<a href="#page-6">6</a>
   <a href="#section-6">6</a>. Loop Prevention among RBridges in an Edge Group .................<a href="#page-8">8</a>
   <a href="#section-7">7</a>. Centralized Replication Forwarding Process ......................<a href="#page-9">9</a>
   <a href="#section-8">8</a>. BUM Traffic Load-Balancing among Multiple Centralized Nodes ....<a href="#page-10">10</a>
   <a href="#section-9">9</a>. Coexisting with the CMT Solution (<a href="rfc7783.html">RFC 7783</a>) ....................<a href="#page-11">11</a>
   <a href="#section-10">10</a>. Network Upgrade Analysis ......................................<a href="#page-12">12</a>
   <a href="#section-11">11</a>. TRILL Protocol Extensions .....................................<a href="#page-13">13</a>
      <a href="#section-11.1">11.1</a>. "R" and "C" Flag in the Nickname Flags APPsub-TLV ........<a href="#page-13">13</a>
   <a href="#section-12">12</a>. Security Considerations .......................................<a href="#page-14">14</a>
   <a href="#section-13">13</a>. IANA Considerations ...........................................<a href="#page-14">14</a>
   <a href="#section-14">14</a>. References ....................................................<a href="#page-15">15</a>
      <a href="#section-14.1">14.1</a>. Normative References .....................................<a href="#page-15">15</a>
      <a href="#section-14.2">14.2</a>. Informative References ...................................<a href="#page-16">16</a>
   Acknowledgments ...................................................<a href="#page-17">17</a>
   Authors' Addresses ................................................<a href="#page-17">17</a>

<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   The IETF TRILL protocol [<a href="rfc6325.html" title="&quot;Routing Bridges (RBridges): Base Protocol Specification&quot;">RFC6325</a>] provides multipath data forwarding
   that is loop free and per-hop based with minimum configuration.
   TRILL uses IS-IS [<a href="rfc6165.html" title="&quot;Extensions to IS-IS for Layer-2 Systems&quot;">RFC6165</a>] [<a href="rfc7176.html" title="&quot;Transparent Interconnection of Lots of Links (TRILL) Use of IS-IS&quot;">RFC7176</a>] as its control plane routing
   protocol and defines a TRILL-specific header for user data.

   Customer Equipment (CE) devices can be multihomed to a set of edge
   RBridges forming an edge group where active-active service can be
   provided.  In that case, all of the uplinks from a CE are handled via
   a Local Active-Active Link Protocol (LAALP) [<a href="rfc7379.html" title="&quot;Problem Statement and Goals for Active-Active Connection at the Transparent Interconnection of Lots of Links (TRILL) Edge&quot;">RFC7379</a>] such as Multi-



<span class="grey">Hao, et al.                  Standards Track                    [Page 2]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc8361.html">RFC 8361</a>         Centralized Replication for BUM Traffic      April 2018</span>


   Chassis Link Aggregation (MC-LAG) or Distributed Resilient Network
   Interconnect (DRNI) [<a href="#ref-IEEE802.1AX" title="&quot;IEEE Standard for Local and metropolitan area networks -- Link Aggregation&quot;">IEEE802.1AX</a>].  An active-active flow-based load-
   sharing mechanism can achieve better load-balancing and high
   reliability.  A CE device can be a Layer 3 (L3) end system by itself
   or a bridge switch through which L3 end systems access the TRILL
   campus.

   In active-active access, the pseudo-nickname solution in [<a href="rfc7781.html" title="&quot;Transparent Interconnection of Lots of Links (TRILL): Pseudo-Nickname for Active-Active Access&quot;">RFC7781</a>]
   can be used to avoid Media Access Control (MAC) flip-flop on remote
   RBridges.  The basic idea is to use a virtual RBridge (RBv) with a
   single pseudo-nickname to represent an edge group.  Any member
   RBridge of that edge group uses this pseudo-nickname rather than its
   own nickname as the ingress nickname when it injects TRILL data
   frames to the TRILL campus.  The use of the nickname solves the
   address flip-flop issue by setting the nickname learned by a remote
   RBridge to be the pseudo-nickname.  However, it introduces another
   issue of incorrect packet dropping as follows: When a pseudo-nickname
   is used by an edge RBridge as the ingress nickname to forward BUM
   traffic, any RBridges (RBn) sitting between the ingress RBridge and
   the distribution tree root will treat the traffic as if it were
   ingressed from the RBv.  If the same distribution tree is used by
   different edge RBridges of the same RBv, the traffic may arrive at
   some RBn from different ports.  Then, the Reverse Path Forwarding
   (RPF) check required by TRILL [<a href="rfc6325.html" title="&quot;Routing Bridges (RBridges): Base Protocol Specification&quot;">RFC6325</a>] fails, and the BUM traffic
   received on unexpected ports will be dropped by RBn.

   This document specifies a centralized replication solution for BUM
   traffic forwarding to resolve the issue of incorrect packet drop
   caused by the RPF check failure in the virtual RBridge case.  The
   basic idea is that all ingress RBridges send BUM traffic to a
   centralized node, which MUST be a distribution tree root, using
   unicast TRILL encapsulation.  When the centralized node receives the
   packets, it decapsulates and forwards them to their destination
   RBridges using a distribution tree established as per the TRILL base
   protocol.  This document updates [<a href="rfc6325.html" title="&quot;Routing Bridges (RBridges): Base Protocol Specification&quot;">RFC6325</a>]; per [<a href="rfc6325.html" title="&quot;Routing Bridges (RBridges): Base Protocol Specification&quot;">RFC6325</a>], multi-
   destination traffic is ingressed to a multi-destination TRILL data
   packet.  However, per this document, when using the centralized
   replication feature, multi-destination traffic is initially ingressed
   to a unicast TRILL data packet.

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in <a href="https://tools.ietf.org/html/bcp14">BCP</a>
   <a href="https://tools.ietf.org/html/bcp14">14</a> [<a href="rfc2119.html" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>] [<a href="rfc8174.html" title="&quot;Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words&quot;">RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.




<span class="grey">Hao, et al.                  Standards Track                    [Page 3]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc8361.html">RFC 8361</a>         Centralized Replication for BUM Traffic      April 2018</span>


   The abbreviations and terminology in [<a href="rfc6325.html" title="&quot;Routing Bridges (RBridges): Base Protocol Specification&quot;">RFC6325</a>] are used herein with
   the following additions:

   BUM:           Broadcast, Unknown unicast, and Multicast

   CE:            Customer Equipment (as in [<a href="rfc7783.html" title="&quot;Coordinated Multicast Trees (CMT) for Transparent Interconnection of Lots of Links (TRILL)&quot;">RFC7783</a>]), as relates to a
                  device (end station or bridge).  The device can be
                  either physical or virtual equipment.

   Data Label:    VLAN or Fine-Grained Labeled (FGL) [<a href="rfc7172.html" title="&quot;Transparent Interconnection of Lots of Links (TRILL): Fine-Grained Labeling&quot;">RFC7172</a>]

   DF:            Designated Forwarder [<a href="rfc7781.html" title="&quot;Transparent Interconnection of Lots of Links (TRILL): Pseudo-Nickname for Active-Active Access&quot;">RFC7781</a>]

   FGL:           Fine-Grained Label [<a href="rfc7172.html" title="&quot;Transparent Interconnection of Lots of Links (TRILL): Fine-Grained Labeling&quot;">RFC7172</a>]

   LAALP:         Local Active-Active Link Protocol [<a href="rfc7379.html" title="&quot;Problem Statement and Goals for Active-Active Connection at the Transparent Interconnection of Lots of Links (TRILL) Edge&quot;">RFC7379</a>]

   MAC flip flop: A problem where the attachment point of a MAC address
                  appears to a remote switch to keep changing.  See
                  <a href="rfc7379.html#section-3.3">Section&nbsp;3.3 of [RFC7379]</a>.

   MC-LAG:        Multi-Chassis Link Aggregation

   RPF:           Reverse Path Forwarding

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Centralized Replication Solution Overview</span>

   When an edge RBridge receives BUM traffic from a CE device, it uses
   unicast TRILL encapsulation instead of multicast encapsulation to
   send the packets to a centralized node.  The centralized node MUST be
   a distribution tree root.  Distribution tree roots are normally
   chosen to be high-capacity core RBridges with many high-bandwidth
   adjacencies.  This constraint makes it practical, as described below,
   to support centralized replication with only software changes to
   transit RBridges.

   The TRILL header of the unicast TRILL encapsulation contains an
   "ingress RBridge nickname" field and an "egress RBridge nickname"
   field [<a href="rfc6325.html" title="&quot;Routing Bridges (RBridges): Base Protocol Specification&quot;">RFC6325</a>].  If the ingress RBridge receives the BUM packet from
   a port that is in an active-active edge group using [<a href="rfc7781.html" title="&quot;Transparent Interconnection of Lots of Links (TRILL): Pseudo-Nickname for Active-Active Access&quot;">RFC7781</a>], it
   sets the ingress RBridge nickname to be the pseudo-nickname rather
   than its own nickname to avoid MAC flip-flop (see <a href="rfc7379.html#section-3.3">Section&nbsp;3.3 of
   [RFC7379]</a>) on remote RBridges.  The egress RBridge nickname is set to
   a special nickname of the centralized node that is used to
   differentiate the centralized replication purpose unicast TRILL
   encapsulation from a normal unicast TRILL encapsulation.  This
   special nickname is called an "R-nickname".




<span class="grey">Hao, et al.                  Standards Track                    [Page 4]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc8361.html">RFC 8361</a>         Centralized Replication for BUM Traffic      April 2018</span>


   When the centralized RBridge receives a unicast TRILL-encapsulated
   packet with its R-nickname as the egress nickname, it decapsulates
   the packet.  Then, the centralized RBridge replicates and forwards
   the BUM packet to the packet's destination RBridges using one of the
   distribution trees established per the TRILL base protocol [<a href="rfc6325.html" title="&quot;Routing Bridges (RBridges): Base Protocol Specification&quot;">RFC6325</a>].
   It MUST use a distribution tree whose tree root is the centralized
   RBridge itself.  (An RBridge may be the root of more than one tree.)
   When the centralized RBridge forwards the BUM traffic, it simply
   sends it on the distribution tree as if it were a locally ingressed
   frame, except that the ingress nickname remains the same as that in
   the packet it received to ensure that the MAC address learning by all
   egress RBridges is bound to the pseudo-nickname.

   When the replicated packet is forwarded by each RBridge along the
   distribution tree starting from the centralized node, an RPF check is
   performed per [<a href="rfc6325.html" title="&quot;Routing Bridges (RBridges): Base Protocol Specification&quot;">RFC6325</a>].  For any RBridge sitting between the ingress
   RBridge and the centralized replication node, the incoming port of
   such a BUM packet should be the centralized-node-facing port, as the
   multicast traffic always comes from the centralized node in this
   solution.  However, the RPF port as the result of distribution tree
   calculation as specified in [<a href="rfc6325.html" title="&quot;Routing Bridges (RBridges): Base Protocol Specification&quot;">RFC6325</a>] will be the real ingress
   RBridge-facing port, as it uses the edge group's virtual RBridge as
   the ingress RBridge, so the RPF check will fail.

   To solve this problem, some change in the RPF test is required.  In
   this case, the RPF calculation on each RBridge should use the
   centralized node as the ingress RBridge for each tree for which that
   node is the root instead of the real ingress virtual RBridge to
   perform the calculation.  As a result, the RPF check will accept
   traffic on the centralized-node-facing port of the RBridge for multi-
   destination traffic.  This prevents incorrect frame drops by the RPF
   check.

   The change in the actual RPF check on a received multi-destination
   TRILL data packet is easy.  The RPF check from [<a href="rfc6325.html" title="&quot;Routing Bridges (RBridges): Base Protocol Specification&quot;">RFC6325</a>] is a check
   to see if a triple of {ingress nickname, tree, receiving RBridge
   port} is allowed.  (The tree is indicated by the nickname of its
   root, which is stored in the TRILL Header "egress nickname" field.)
   When determining the RPF check, if "ingress nickname" is using
   centralized replication (indicated by a C-nickname, see <a href="#section-9">Section 9</a>),
   then the check is based on distribution from the tree root.  If
   "ingress nickname" is not using centralized replication, then the
   check is based on distribution from the RBridge having the ingress
   nickname.

   To differentiate the centralized replication unicast TRILL
   encapsulation from normal unicast TRILL encapsulation, the R-nickname
   is introduced for centralized replication.  When the centralized node



<span class="grey">Hao, et al.                  Standards Track                    [Page 5]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc8361.html">RFC 8361</a>         Centralized Replication for BUM Traffic      April 2018</span>


   receives unicast TRILL encapsulation traffic with the egress nickname
   R-nickname, it decapsulates the packet and then forwards the packet
   to the destination RBridges through a distribution tree for which it
   is the root by re-encapsulation as aforementioned.  In TRILL,
   RBridges can hold multiple nicknames, so the centralized RBridge
   simply obtains another nickname to use as the R-nickname.  The
   centralized RBridge or RBridges should announce their R-nickname to
   all TRILL campuses through the TRILL Link State PDU (LSP) extension
   specified in <a href="#section-11">Section 11</a>.

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Frame Duplication from Remote RBridge</span>

   Frame duplication may occur when a remote host sends a multi-
   destination frame to a local CE that has an active-active connection
   to the TRILL campus.  To avoid the local CE receiving multiple copies
   from a remote RBridge, the Designated Forwarder (DF) mechanism is
   supported for egress-direction multicast traffic.

   The DF election mechanism [<a href="rfc7781.html" title="&quot;Transparent Interconnection of Lots of Links (TRILL): Pseudo-Nickname for Active-Active Access&quot;">RFC7781</a>] allows only one port of one
   RBridge in an active-active group to forward multicast traffic from
   the TRILL campus to the local access side for each VLAN.  The basic
   idea of using DF is to elect one RBridge per VLAN from an edge group
   to be responsible for egressing the BUM traffic.  [<a href="rfc7781.html" title="&quot;Transparent Interconnection of Lots of Links (TRILL): Pseudo-Nickname for Active-Active Access&quot;">RFC7781</a>] describes
   the DF election mechanism among member RBridges involved in an edge
   group.

   If the DF election mechanism is used for frame-duplication
   prevention, access ports on an RBridge are categorized as one of
   three types: non-group, group DF port, and group non-DF port.  The
   last two types can be called group ports.  Each of the group ports is
   associated with a pseudo-nickname.  If consistent nickname allocation
   to edge group RBridges is used, it is possible that the same pseudo-
   nickname is associated with more than one port on a single RBridge.
   A typical scenario is that CE1 is connected to RB1 and RB2 by LAALP1,
   whereas CE2 is connected to RB1 and RB2 by LAALP2.  In order to
   conserve the number of pseudo-nicknames used, member ports for both
   LAALP1 and LAALP2 on RB1 and RB2 are all associated with the same
   pseudo-nickname.

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  Local Forwarding Behavior on Ingress RBridge</span>

   When an ingress RBridge (RB1) receives BUM traffic from a local
   active-active connected CE (CE1) device, the traffic will be injected
   into the TRILL campus with TRILL encapsulation; it will be replicated
   and forwarded to all destination RBridges through central
   replication, including the ingress RBridge itself, along a TRILL





<span class="grey">Hao, et al.                  Standards Track                    [Page 6]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc8361.html">RFC 8361</a>         Centralized Replication for BUM Traffic      April 2018</span>


   distribution tree.  To avoid the traffic looping back to the original
   sender CE, an ingress nickname of the CE group's pseudo-nickname is
   used for traffic filtering.

   However, if there are two CEs, say CE1 and CE2, connecting to the
   ingress RB1 and each associated with the same pseudo-nickname, RB1
   needs to locally replicate and forward to CE2, because another copy
   of the BUM traffic between CE1 and CE2 through the TRILL campus will
   be blocked by the traffic filtering.

   If CE1 and CE2 are not associated with the same pseudo-nickname, the
   copy of the BUM traffic between CE1 and CE2 through the TRILL campus
   won't be blocked by the traffic filtering.  To avoid duplicated
   traffic on receiver CE, there cannot be local replicated BUM traffic
   between these two CEs on ingress RB1.

   In summary, to ensure correct BUM traffic forwarding behavior for
   each CE, the local replication behavior on the ingress RBridge is as
   follows:

   1.  Replicate to the active-active group ports associated with the
       same pseudo-nickname as that associated with the incoming port.

   2.  Do not replicate to active-active group ports associated with
       other pseudo-nicknames.

   3.  Do not replicate to non-edge-group ports.

   The above local forwarding behavior on the ingress RBridge of RB1 can
   be called "centralized replication local forwarding behavior A".

   If ingress RBridge RB1 itself is the centralized replication node,
   BUM traffic injected by RB1 into the TRILL campus won't loop back to
   RB1.  In this case, the local forwarding behavior is called
   centralized replication local forwarding behavior B.  Behavior B on
   RB1 is as follows:

   1.  Local replication to the ports associated with the same pseudo-
       nickname as that associated with the incoming port.

   2.  Local replication to the group DF port associated with different
       pseudo-nicknames.  Do not replicate to group non-DF ports
       associated with different pseudo-nicknames.

   3.  Local replication to non-edge-group ports.






<span class="grey">Hao, et al.                  Standards Track                    [Page 7]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc8361.html">RFC 8361</a>         Centralized Replication for BUM Traffic      April 2018</span>


<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Loop Prevention among RBridges in an Edge Group</span>

   If a CE sends a BUM packet through a DF port to an ingress RBridge,
   that RBridge will forward that packet to all or a subset of the other
   RBridges that only have non-DF ports for that active-active group.
   Because BUM traffic forwarding to non-DF ports isn't allowed, in this
   case, the frame won't loop back to the CE.

   If a CE sends a BUM packet through a non-DF port to an ingress
   RBridge, say RB1, then RB1 will forward that packet to other RBridges
   that have a DF port for that active-active group.  In this case, the
   frame will loop back to the CE and the traffic split-horizon
   filtering mechanism is used to avoid looping back among RBridges in
   the edge group.

   This split-horizon mechanism relies on the ingress nickname field in
   the TRILL header to check if a packet's egress port belongs to the
   same active-active group as the packet's incoming port to the TRILL
   campus.

   When the ingress RBridge receives BUM traffic from an active-active
   connected CE device, the traffic will be sent through the TRILL
   campus with TRILL encapsulation to a centralized RBridge.  There it
   will be replicated and forwarded to its destination RBridges, which
   include the ingress RBridge itself, through a TRILL distribution
   tree.  If the same pseudo-nickname is used for two active-active
   access CEs as the ingress nickname, an egress RBridge can use that
   nickname to filter traffic forwarding to all local CEs.  In this
   case, the traffic between these two CEs goes through the local
   RBridge and another copy of the traffic from the TRILL campus is
   filtered.  If different ingress nicknames are used for two connecting
   CE devices, the access ports connecting to these two CEs should be
   isolated from each other.  The BUM traffic between these two CEs
   should go through the TRILL campus; otherwise, the destination CE
   connected to same RBridge with the sender CE will receive two copies
   of the traffic.















<span class="grey">Hao, et al.                  Standards Track                    [Page 8]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc8361.html">RFC 8361</a>         Centralized Replication for BUM Traffic      April 2018</span>


<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  Centralized Replication Forwarding Process</span>

                             +-----------+
                             |   (RB5)   |
                             +-----------+
                                   |
                             +-----------+
                             |   (RB4)   |
                             +-----------+

                              |     |    |
                      --------      |     --------
                     |              |             |
                   +------+      +------+      +------+
                   |(RB1) |      |(RB2) |      | (RB3)|
                   +------+      +------+      +------+
                     *   |         *  |          * |  ^
                     *   |         *  |          * |   ^
                     *   ----------*-------------*--    ^
                     ***************************** |     ^
                     *                             |      ^
              LAALP1 *                      LAALP2 |       ^
                 +------+                    +------+    +------+
                 |  CE1 |                    | CE2  |    | CE3  |
                 +------+                    +------+    +------+

                   Figure 1: TRILL Active-Active Access

   Note: The asterisk line, hyphen &amp; vertical bar line, and circumflex
   line in this figure indicate the connection of the various CEs to the
   various RBs.

   Assuming the centralized replication solution is used in the example
   network of above Figure 1: RB5 is the distribution tree root and
   centralized replication node; CE1 and CE2 are active-active accessed
   to RB1, RB2, and RB3 through LAALP1 and LAALP2, respectively; and CE3
   is single-homed to RB3.  The RBridge's own nicknames of RB1 to RB5
   are nick1 to nick5, respectively.  RB1, RB2, and RB3 use the same
   pseudo-nickname for LAALP1 and LAALP2; that pseudo-nickname is
   P-nick.  The R-nickname on the centralized replication node of RB5 is
   S-nick.










<span class="grey">Hao, et al.                  Standards Track                    [Page 9]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc8361.html">RFC 8361</a>         Centralized Replication for BUM Traffic      April 2018</span>


   The BUM traffic forwarding process from CE1 to CE2 and CE3 is as
   follows:

   1.  CE1 sends BUM traffic to RB3.

   2.  RB3 replicates and sends the BUM traffic to CE2 locally.  RB2
       also sends the traffic to RB5 using unicast TRILL encapsulation.
       In the TRILL Header, the ingress nickname is set as P-nick and
       the egress nickname is set as S-nick.

   3.  RB5 decapsulates the unicast TRILL data packet.  Then, it uses a
       distribution tree for which it is the root to forward the packet
       as a multi-destination TRILL data packet.  The egress nickname in
       the multi-destination TRILL Header is the nick5 and the ingress
       nickname is still P-nick.  If RB3 had sent the unicast to some
       nickname that was not an R-nickname, the packet would not be
       re-encapsulated.  If it is sent to an R-nickname that is not a
       tree root, it either will not be forwarded at all or, if it is
       re-encapsulated and forwarded, will be subject to incorrect
       pruning and will not be delivered to all of its intended
       recipients.

   4.  RB4 receives multicast TRILL traffic from RB5.  The incoming
       traffic port is the up port facing the distribution tree root.
       RB4's RPF check will be correct based on the changed RPF port
       calculation algorithm in this document.  After the RPF check is
       performed, it forwards the traffic to all other egress RBridges
       (RB1, RB2, and RB3).

   5.  RB3 receives multicast TRILL traffic from RB4.  It decapsulates
       the multi-destination TRILL data packet.  Because the ingress
       nickname of P-nick is equivalent to the nickname of local LAALPs
       connecting to CE1 and CE2, RB3 doesn't forward the traffic to CE1
       and CE2 to avoid a duplicated frame.  RB3 only forwards the
       packet to CE3.

   6.  RB1 and RB2 receive multicast TRILL traffic from RB4.  The
       forwarding process is similar to the process on RB3, i.e.,
       because the ingress nickname of P-nick is equivalent to the
       nickname of the local LAALPs connecting CE1 and CE2, they also
       don't forward the traffic to local CE1 and CE2.

<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  BUM Traffic Load-Balancing among Multiple Centralized Nodes</span>

   To support unicast TRILL encapsulation BUM traffic load-balancing,
   multiple centralized replication nodes can be deployed and the
   traffic can be spread over these nodes based on data label (VLAN or
   FGL).  Furthermore, if it was desirable for a centralized node to be



<span class="grey">Hao, et al.                  Standards Track                   [Page 10]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc8361.html">RFC 8361</a>         Centralized Replication for BUM Traffic      April 2018</span>


   sent more of this BUM traffic, it could hold two or more R-nicknames.
   The share of BUM traffic it would receive would be proportional to
   the number of R-nicknames it held.

   Assuming there are k different R-nicknames held by centralized nodes
   in a TRILL campus, the VLAN-based (or FGL-based [<a href="rfc7172.html" title="&quot;Transparent Interconnection of Lots of Links (TRILL): Fine-Grained Labeling&quot;">RFC7172</a>]) load-
   balancing algorithm used by an ingress active-active access RBridge
   is as follows:

   1.  All R-nicknames are ordered and numbered from 0 to k-1 in
       ascending order, treating the nicknames as unsigned 16-bit
       integers.

   2.  For data label ID m, choose the R-nickname whose index is given
       by (m mod k) as egress nickname for BUM traffic unicast TRILL
       encapsulation.

   For example, there are three R-Nicknames (RNs).  The RNs will be
   ordered RN0 to RN2.  Assuming there are five VLANs from VLAN ID1 to
   ID5 spreading among edge RBridges, the traffic in VLAN1 will go to
   RN1, VLAN2 will go to RN2, and so on.

   When an ingress RBridge participating in an active-active connection
   receives BUM traffic from a local CE, the RBridge decides which
   R-nickname to send the traffic to based on the VLAN-based load-
   spreading algorithm; thus, data-label-based load-balancing for the
   BUM traffic can be achieved using multiple centralized nodes/multiple
   R-nicknames.

<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  Coexisting with the CMT Solution (<a href="rfc7783.html">RFC 7783</a>)</span>

                    +------+    +------+
                    |(RB6) |    |(RB7) |
                    +------+    +------+
      ------------------|-----------|----------------------
      |            |              |          |            |
   +------+    +------+       +------+    +------+     +------+
   |(RB1) |    |(RB2) |       |(RB3) |    |(RB4) |     |(RB5) |
   +------+    +------+       +------+    +------+     +------+
       |          |               |          |            |
       ------------               -------------------------
             |                               |
         +------+                         +------+
         |  CE1 |                         |  CE2 |
         +------+                         +------+

       Figure 2: CMT and Centralized Replication Coexisting Scenario




<span class="grey">Hao, et al.                  Standards Track                   [Page 11]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc8361.html">RFC 8361</a>         Centralized Replication for BUM Traffic      April 2018</span>


   Both the centralized replication solution and the Coordinated
   Multicast Trees (CMT) solution from [<a href="rfc7783.html" title="&quot;Coordinated Multicast Trees (CMT) for Transparent Interconnection of Lots of Links (TRILL)&quot;">RFC7783</a>] rely on using pseudo-
   nicknames to avoid MAC flip-flop on remote RBridges.  These two
   solutions can coexist in a single TRILL campus.  Each solution can be
   selected by each active-active edge group of RBridges independently.

   As illustrated in Figure 2, RB1 and RB2 use CMT for CE1's active-
   active access; RB3, RB4, and RB5 use the centralized replication for
   CE2's active-active access.

   For the centralized replication solution, edge group RBridges MUST
   announce the local pseudo-nickname using the Nickname Flags APPsub-
   TLV with C flag set.  A nickname with the C flag set is called a
   "C-nickname".  A transit RBridge will perform the centralized
   replication-specific RPF check algorithm if it receives TRILL data
   packets with a C-nickname as the ingress nickname.

   An edge group using CMT [<a href="rfc7783.html" title="&quot;Coordinated Multicast Trees (CMT) for Transparent Interconnection of Lots of Links (TRILL)&quot;">RFC7783</a>] MUST NOT set the C flag on the
   pseudo-nickname it is using.  This is already mandatory behavior
   because any RBridge originating a Nickname Flags APPsub-TLV is
   required by [<a href="rfc7780.html" title="&quot;Transparent Interconnection of Lots of Links (TRILL): Clarifications, Corrections, and Updates&quot;">RFC7780</a>] to set any flag bit it does not know about to
   zero.  If an edge RBridge using CMT [<a href="rfc7783.html" title="&quot;Coordinated Multicast Trees (CMT) for Transparent Interconnection of Lots of Links (TRILL)&quot;">RFC7783</a>] nevertheless set the
   C-bit for an edge group pseudo-nickname, it is very likely that BUM
   traffic encapsulated with that nickname as ingress would be
   incorrectly pruned early in its distribution and would, thus, reach
   few (possibly none) of its intended targets.  To avoid confusion, a
   pseudo-nickname MUST NOT be shared between a centralized replication
   edge group and a CMT-based edge group.

<span class="h2"><a class="selflink" name="section-10" href="#section-10">10</a>.  Network Upgrade Analysis</span>

   Centralized nodes will typically need software and hardware upgrades
   to support centralized replication, which stitches together the TRILL
   unicast traffic decapsulation process and the process of normal TRILL
   multicast traffic forwarding along the distribution tree.

   Active-active connection edge RBridges will typically need software
   and hardware upgrades to support unicast TRILL encapsulation for BUM
   traffic; the process is similar to other head-end replication
   processes.

   Transit nodes typically need only a software upgrade to support the
   changed RPF port calculation algorithm.








<span class="grey">Hao, et al.                  Standards Track                   [Page 12]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey"><a href="rfc8361.html">RFC 8361</a>         Centralized Replication for BUM Traffic      April 2018</span>


<span class="h2"><a class="selflink" name="section-11" href="#section-11">11</a>.  TRILL Protocol Extensions</span>

   Two new flags, "R" and "C", are specified in the Nickname Flags
   APPsub-TLV [<a href="rfc7780.html" title="&quot;Transparent Interconnection of Lots of Links (TRILL): Clarifications, Corrections, and Updates&quot;">RFC7780</a>].  A nickname with the R flag set is called an
   "R-nickname" and a nickname with the C flag set is called a
   "C-nickname".  The R-nickname is a specialized nickname attached to a
   centralized node to differentiate unicast TRILL-encapsulated BUM
   traffic from normal unicast TRILL traffic.  The C-nickname flag is
   set on the pseudo-nickname for each edge group that uses the
   centralized replication.  A C-nickname is a specialized pseudo-
   nickname for which transit RBridges perform a different RPF check
   algorithm for TRILL data packets with the C-nickname in the ingress
   nickname field.

   When active-active edge RBridges use centralized replication to
   forward BUM traffic, the R-nickname is used as the egress nickname
   and the C-nickname is used as ingress nickname in the TRILL header
   for the unicast TRILL encapsulation of BUM traffic.

<span class="h3"><a class="selflink" name="section-11.1" href="#section-11.1">11.1</a>.  "R" and "C" Flag in the Nickname Flags APPsub-TLV</span>

   If this APPsub-TLV is being advertised by an RBridge that does not
   have the nickname appearing in the Nickname Flags APPsub-TLV, the R
   and C flag bits in the APPsub-TLV MUST be treated as if they were
   zero.  If an RBridge that is not a distribution tree root advertises
   an R-nickname, that nickname MUST NOT be treated as an R-nickname but
   rather as an ordinary nickname; that is, the R-nickname flag is
   ignored for all purposes if the nickname is held by an RBridge that
   is not a tree root.

              0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
             +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
             |   Nickname                                    |
             +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
             |IN|SE|R | C|    RESV                           |
             +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
                             NICKFLAG RECORD

   o  R = If the R flag is one, it indicates that the advertising TRILL
      switch holding Nickname is a centralized replication node, and
      Nickname is used as egress nickname for edge group RBridges to
      inject BUM traffic into the TRILL campus when the edge group
      RBridges use this centralized replication solution for active-
      active access.  If the R flag is zero, that nickname will not be
      used for that purpose.






<span class="grey">Hao, et al.                  Standards Track                   [Page 13]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey"><a href="rfc8361.html">RFC 8361</a>         Centralized Replication for BUM Traffic      April 2018</span>


   o  C = If C flag is one, it indicates that the TRILL traffic with
      this nickname as an ingress nickname requires the special RPF
      check algorithm specified in <a href="#section-3">Section 3</a>.  If the C flag is zero,
      that nickname will not be used for that purpose.

   Due to errors or due to transient inconsistent LSPs when the link
   state database is converging after a configuration change or the
   like, it is possible for there to be inconsistent Nickname Flags
   APPsub-TLVs for the same nickname.  In this case, it is RECOMMENDED
   that the nickname be treated as if the R / C flag were set if any
   Nickname Flags APPsub-TLV for that nickname has the R / C flag set.

<span class="h2"><a class="selflink" name="section-12" href="#section-12">12</a>.  Security Considerations</span>

   This document does not introduce any extra security risks.  A rogue
   RBridge that is a tree root can attract traffic by advertising an
   R-nickname.  However, this does not represent a substantial increase
   in risk as RBridges could cause problems in a number of other ways by
   advertising low-cost adjacencies or making themselves the highest
   priority tree root or the like.  In general, the protection against
   an untrusted device acting as an RBridge and wrecking havoc is to use
   IS-IS authentication [<a href="rfc5310.html" title="&quot;IS-IS Generic Cryptographic Authentication&quot;">RFC5310</a>] and configure and administer the TRILL
   campus so that only trusted RBridges have the authentication key.

   For general TRILL security considerations, see [<a href="rfc6325.html" title="&quot;Routing Bridges (RBridges): Base Protocol Specification&quot;">RFC6325</a>].  For
   security considerations related to pseudo-nickname active-active, see
   [<a href="rfc7781.html" title="&quot;Transparent Interconnection of Lots of Links (TRILL): Pseudo-Nickname for Active-Active Access&quot;">RFC7781</a>].

<span class="h2"><a class="selflink" name="section-13" href="#section-13">13</a>.  IANA Considerations</span>

   IANA has assigned two bits in the Nickname Flags APPsubTLV flags for
   the R and C bits discussed in <a href="#section-11.1">Section 11.1</a> and update the "NickFlags
   Bits" subregistry of the "Transparent Interconnection of Lots of
   Links (TRILL) Parameters" registry as follows:

              Bit  Mnemonic   Description          Reference
             ---  --------  --------------------  -----------
               2    R        Replication Nickname  [<a href="rfc8361.html">RFC8361</a>]
               3    C        Special RPF Check     [<a href="rfc8361.html">RFC8361</a>]












<span class="grey">Hao, et al.                  Standards Track                   [Page 14]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-15" id="page-15" href="#page-15" class="invisible"> </a>
<span class="grey"><a href="rfc8361.html">RFC 8361</a>         Centralized Replication for BUM Traffic      April 2018</span>


<span class="h2"><a class="selflink" name="section-14" href="#section-14">14</a>.  References</span>

<span class="h3"><a class="selflink" name="section-14.1" href="#section-14.1">14.1</a>.  Normative References</span>

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a name="ref-RFC5310" id="ref-RFC5310">RFC5310</a>]  Bhatia, M., Manral, V., Li, T., Atkinson, R., White, R.,
              and M. Fanto, "IS-IS Generic Cryptographic
              Authentication", <a href="rfc5310.html">RFC 5310</a>, DOI 10.17487/RFC5310, February
              2009, &lt;<a href="https://www.rfc-editor.org/info/rfc5310">https://www.rfc-editor.org/info/rfc5310</a>&gt;.

   [<a name="ref-RFC6165" id="ref-RFC6165">RFC6165</a>]  Banerjee, A. and D. Ward, "Extensions to IS-IS for Layer-2
              Systems", <a href="rfc6165.html">RFC 6165</a>, DOI 10.17487/RFC6165, April 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6165">https://www.rfc-editor.org/info/rfc6165</a>&gt;.

   [<a name="ref-RFC6325" id="ref-RFC6325">RFC6325</a>]  Perlman, R., Eastlake 3rd, D., Dutt, D., Gai, S., and A.
              Ghanwani, "Routing Bridges (RBridges): Base Protocol
              Specification", <a href="rfc6325.html">RFC 6325</a>, DOI 10.17487/RFC6325, July 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6325">https://www.rfc-editor.org/info/rfc6325</a>&gt;.

   [<a name="ref-RFC7172" id="ref-RFC7172">RFC7172</a>]  Eastlake 3rd, D., Zhang, M., Agarwal, P., Perlman, R., and
              D. Dutt, "Transparent Interconnection of Lots of Links
              (TRILL): Fine-Grained Labeling", <a href="rfc7172.html">RFC 7172</a>,
              DOI 10.17487/RFC7172, May 2014,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7172">https://www.rfc-editor.org/info/rfc7172</a>&gt;.

   [<a name="ref-RFC7176" id="ref-RFC7176">RFC7176</a>]  Eastlake 3rd, D., Senevirathne, T., Ghanwani, A., Dutt,
              D., and A. Banerjee, "Transparent Interconnection of Lots
              of Links (TRILL) Use of IS-IS", <a href="rfc7176.html">RFC 7176</a>,
              DOI 10.17487/RFC7176, May 2014,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7176">https://www.rfc-editor.org/info/rfc7176</a>&gt;.

   [<a name="ref-RFC7780" id="ref-RFC7780">RFC7780</a>]  Eastlake 3rd, D., Zhang, M., Perlman, R., Banerjee, A.,
              Ghanwani, A., and S. Gupta, "Transparent Interconnection
              of Lots of Links (TRILL): Clarifications, Corrections, and
              Updates", <a href="rfc7780.html">RFC 7780</a>, DOI 10.17487/RFC7780, February 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7780">https://www.rfc-editor.org/info/rfc7780</a>&gt;.

   [<a name="ref-RFC8174" id="ref-RFC8174">RFC8174</a>]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in <a href="rfc2119.html">RFC</a>
              <a href="rfc2119.html">2119</a> Key Words", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc8174.html">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.







<span class="grey">Hao, et al.                  Standards Track                   [Page 15]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-16" id="page-16" href="#page-16" class="invisible"> </a>
<span class="grey"><a href="rfc8361.html">RFC 8361</a>         Centralized Replication for BUM Traffic      April 2018</span>


<span class="h3"><a class="selflink" name="section-14.2" href="#section-14.2">14.2</a>.  Informative References</span>

   [<a name="ref-RFC7781" id="ref-RFC7781">RFC7781</a>]  Zhai, H., Senevirathne, T., Perlman, R., Zhang, M., and Y.
              Li, "Transparent Interconnection of Lots of Links (TRILL):
              Pseudo-Nickname for Active-Active Access", <a href="rfc7781.html">RFC 7781</a>,
              DOI 10.17487/RFC7781, February 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7781">https://www.rfc-editor.org/info/rfc7781</a>&gt;.

   [<a name="ref-RFC7379" id="ref-RFC7379">RFC7379</a>]  Li, Y., Hao, W., Perlman, R., Hudson, J., and H. Zhai,
              "Problem Statement and Goals for Active-Active Connection
              at the Transparent Interconnection of Lots of Links
              (TRILL) Edge", <a href="rfc7379.html">RFC 7379</a>, DOI 10.17487/RFC7379, October
              2014, &lt;<a href="https://www.rfc-editor.org/info/rfc7379">https://www.rfc-editor.org/info/rfc7379</a>&gt;.

   [<a name="ref-RFC7783" id="ref-RFC7783">RFC7783</a>]  Senevirathne, T., Pathangi, J., and J. Hudson,
              "Coordinated Multicast Trees (CMT) for Transparent
              Interconnection of Lots of Links (TRILL)", <a href="rfc7783.html">RFC 7783</a>,
              DOI 10.17487/RFC7783, February 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7783">https://www.rfc-editor.org/info/rfc7783</a>&gt;.

   [<a name="ref-IEEE802.1AX" id="ref-IEEE802.1AX">IEEE802.1AX</a>]
              IEEE, "IEEE Standard for Local and metropolitan area
              networks -- Link Aggregation", IEEE 802.1AX,
              DOI 10.1109/IEEESTD.2017.7888436, March 2017,
              &lt;<a href="http://ieeexplore.ieee.org/document/7888436/">http://ieeexplore.ieee.org/document/7888436/</a>&gt;.


























<span class="grey">Hao, et al.                  Standards Track                   [Page 16]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-17" id="page-17" href="#page-17" class="invisible"> </a>
<span class="grey"><a href="rfc8361.html">RFC 8361</a>         Centralized Replication for BUM Traffic      April 2018</span>


Acknowledgments

   The authors wish to acknowledge the important contributions of Donald
   Eastlake, Hongjun Zhai, Xiaomin Wu, Liang Xia, and Francis Dupont.

Authors' Addresses

   Weiguo Hao
   Huawei Technologies
   101 Software Avenue,
   Nanjing 210012
   China

   Email: haoweiguo@huawei.com


   Yizhou Li
   Huawei Technologies
   101 Software Avenue,
   Nanjing 210012
   China

   Email: liyizhou@huawei.com


   Muhammad Durrani
   Equinix

   Email: mdurrani@equinix.com


   Sujay Gupta
   IP Infusion
   RMZ Centennial
   Mahadevapura Post
   Bangalore - 560048
   India

   Email: sujay.gupta@ipinfusion.com


   Andrew Qu
   MediaTec

   Email: laodulaodu@gmail.com






Hao, et al.                  Standards Track                   [Page 17]

</pre><br />
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.129c, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>
</body>

<!-- Mirrored from tools.ietf.org/html/rfc8361 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:14:53 GMT -->
</html>
