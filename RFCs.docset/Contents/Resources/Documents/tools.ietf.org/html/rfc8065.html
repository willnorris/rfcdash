<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from tools.ietf.org/html/rfc8065 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:19:51 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.129c" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Relation.Replaces" content="draft-thaler-6lo-privacy-considerations" />
<meta name="DC.Identifier" content="urn:ietf:rfc:8065" />
<meta name="DC.Date.Issued" content="February, 2017" />
<meta name="DC.Creator" content="Dave Thaler &lt;dthaler@microsoft.com&gt;" />
<meta name="DC.Description.Abstract" content="This document discusses how a number of privacy threats apply to
technologies designed for IPv6 over various link-layer protocols, and
it provides advice to protocol designers on how to address such
threats in adaptation-layer specifications for IPv6 over such links." />
<meta name="DC.Title" content="Privacy Considerations for IPv6 Adaptation-Layer Mechanisms" />

    <link rel="icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 8065 - Privacy Considerations for IPv6 Adaptation-Layer Mechanisms</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgorange"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc8065.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc8065" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-6lo-privacy-considerations" title="draft-ietf-6lo-privacy-considerations">draft-ietf-6lo-...</a>] [<a href='https://datatracker.ietf.org/doc/rfc8065' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc8065" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc8065" title="Side-by-side diff">Diff2</a>]         </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Internet Engineering Task Force (IETF)                         D. Thaler
Request for Comments: 8065                                     Microsoft
Category: Informational                                    February 2017
ISSN: 2070-1721


      <span class="h1">Privacy Considerations for IPv6 Adaptation-Layer Mechanisms</span>

Abstract

   This document discusses how a number of privacy threats apply to
   technologies designed for IPv6 over various link-layer protocols, and
   it provides advice to protocol designers on how to address such
   threats in adaptation-layer specifications for IPv6 over such links.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see <a href="rfc7841.html#section-2">Section&nbsp;2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc8065">http://www.rfc-editor.org/info/rfc8065</a>.

Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.






<span class="grey">Thaler                        Informational                     [Page 1]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc8065.html">RFC 8065</a>          IPv6-over-foo Privacy Considerations     February 2017</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
   <a href="#section-2">2</a>.  Amount of Entropy Needed in Global Addresses  . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  Potential Approaches  . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-3.1">3.1</a>.  IEEE-Identifier-Based Addresses . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-3.2">3.2</a>.  Short Addresses . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
   <a href="#section-4">4</a>.  Recommendations . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-5">5</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
   <a href="#section-6">6</a>.  Informative References  . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>

<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   <a href="rfc6973.html">RFC 6973</a> [<a href="rfc6973.html" title="&quot;Privacy Considerations for Internet Protocols&quot;">RFC6973</a>] discusses privacy considerations for Internet
   protocols, and <a href="#section-5.2">Section 5.2</a> of that document covers a number of
   privacy-specific threats.  In the context of IPv6 addresses, <a href="rfc7721.html#section-3">Section</a>
   <a href="rfc7721.html#section-3">3 of [RFC7721]</a> provides further elaboration on the applicability of
   the privacy threats.

   When interface identifiers (IIDs) are generated without sufficient
   entropy compared to the link lifetime, devices and users can become
   vulnerable to the various threats discussed there, including:

   o  Correlation of activities over time, if the same identifier is
      used for traffic over period of time

   o  Location tracking, if the same interface identifier is used with
      different prefixes as a device moves between different networks

   o  Device-specific vulnerability exploitation, if the identifier
      helps identify a vendor or version or protocol and hence suggests
      what types of attacks to try

   o  Address scanning, which enables all of the above attacks by
      off-link attackers.  (On some Non-Broadcast Multi-Access (NBMA)
      links where all nodes aren't already privy to all on-link
      addresses, address scans might also be done by on-link attackers;
      however, in most cases, address scans are not an interesting
      threat from on-link attackers and thus address scans generally
      apply only to routable addresses.)

   For example, for links that may last for years, "enough" bits of
   entropy means at least 46 or so bits (see <a href="#section-2">Section 2</a> for why) in a
   routable address; ideally all 64 bits of the IID should be used,
   although historically some bits have been excluded for reasons





<span class="grey">Thaler                        Informational                     [Page 2]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc8065.html">RFC 8065</a>          IPv6-over-foo Privacy Considerations     February 2017</span>


   discussed in [<a href="rfc7421.html" title="&quot;Analysis of the 64-bit Boundary in IPv6 Addressing&quot;">RFC7421</a>].  Link-local addresses can also be susceptible
   to the same privacy threats from off-link attackers, since experience
   shows they are often leaked by upper-layer protocols such as SMTP,
   SIP, or DNS.

   For these reasons, [<a href="rfc8064.html" title="&quot;Recommendation on Stable IPv6 Interface Identifiers&quot;">RFC8064</a>] recommends using an address generation
   scheme in [<a href="rfc7217.html" title="&quot;A Method for Generating Semantically Opaque Interface Identifiers with IPv6 Stateless Address Autoconfiguration (SLAAC)&quot;">RFC7217</a>], rather than addresses generated from a fixed
   link-layer address.

   Furthermore, to mitigate the threat of correlation of activities over
   time on long-lived links, [<a href="rfc4941.html" title="&quot;Privacy Extensions for Stateless Address Autoconfiguration in IPv6&quot;">RFC4941</a>] specifies the notion of a
   "temporary" address to be used for transport sessions (typically
   locally initiated outbound traffic to the Internet) that should not
   be linkable to a more permanent identifier such as a DNS name, user
   name, or fixed link-layer address.  Indeed, the default address
   selection rules [<a href="rfc6724.html" title="&quot;Default Address Selection for Internet Protocol Version 6 (IPv6)&quot;">RFC6724</a>] now prefer temporary addresses by default
   for outgoing connections.  If a device needs to simultaneously
   support unlinkable traffic as well as traffic that is linkable to
   such a stable identifier, supporting simultaneous use of multiple
   addresses per device is necessary.

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Amount of Entropy Needed in Global Addresses</span>

   In terms of privacy threats discussed in [<a href="rfc7721.html" title="&quot;Security and Privacy Considerations for IPv6 Address Generation Mechanisms&quot;">RFC7721</a>], the one with the
   need for the most entropy is address scans of routable addresses.  To
   mitigate address scans, one needs enough entropy to make the
   probability of a successful address probe be negligible.  Typically,
   this is measured in the length of time it would take to have a 50%
   probability of getting at least one hit.  Address scans often rely on
   sending a packet such as a TCP SYN or ICMP Echo Request, then
   determining whether the reply is a) an ICMP unreachable error (if no
   host exists with that address), b) a TCP response or ICMP Echo Reply
   (if a host exists), or c) none of those, in which case nothing is
   known for certain.

   Many privacy-sensitive devices support a "stealth mode" as discussed
   in <a href="rfc7288.html#section-5">Section&nbsp;5 of [RFC7288]</a> or are behind a network firewall that will
   drop unsolicited inbound traffic (e.g., TCP SYNs, ICMP Echo Requests,
   etc.) and thus no TCP RST or ICMP Echo Reply will be sent.  In such
   cases, and when the device does not listen on a well-known TCP or UDP
   port known to the scanner, the effectiveness of an address scan is
   limited by the ability to get ICMP unreachable errors, since the
   attacker can only infer the presence of a host based on the absence
   of an ICMP unreachable error.







<span class="grey">Thaler                        Informational                     [Page 3]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc8065.html">RFC 8065</a>          IPv6-over-foo Privacy Considerations     February 2017</span>


   Generation of ICMP unreachable errors is typically rate limited to 2
   per second (the default in routers such as Cisco routers running IOS
   12.0 or later).  Such a rate results in taking about a year to
   completely scan 26 bits of space.

   The actual math is as follows.  Let 2^N be the number of devices on
   the subnet.  Let 2^M be the size of the space to scan (i.e., M bits
   of entropy).  Let S be the number of scan attempts.  The formula for
   a 50% chance of getting at least one hit in S attempts is:
   P(at least one success) = 1 - (1 - 2^N/2^M)^S = 1/2.
   Assuming 2^M &gt;&gt; S, this simplifies to:
   S * 2^N/2^M = 1/2, giving S = 2^(M-N-1), or M = N + 1 + log_2(S).
   Using a scan rate of 2 per second, this results in the following rule
   of thumb:

      Bits of entropy needed =
         log_2(# devices per link) + log_2(seconds of link lifetime) + 2

   For example, for a network with at most 2^16 devices on the same
   long-lived link, where the average lifetime of a link is 8 years
   (2^28 seconds) or less, this results in a need for at least 46 bits
   of entropy (16+28+2) so that an address scan would need to be
   sustained for longer than the lifetime of the link to have a 50%
   chance of getting a hit.

   Although 46 bits of entropy may be enough to provide privacy in such
   cases, 59 or more bits of entropy would be needed if addresses are
   used to provide security against attacks such as spoofing, as CGAs
   [<a href="rfc3972.html" title="&quot;Cryptographically Generated Addresses (CGA)&quot;">RFC3972</a>] and HBAs [<a href="rfc5535.html" title="&quot;Hash-Based Addresses (HBA)&quot;">RFC5535</a>] do, since attacks are not limited by
   ICMP rate limiting but by the processing power of the attacker.  See
   those RFCs for more discussion.

   If, on the other hand, the devices being scanned for respond to
   unsolicited inbound packets, then the address scan is not limited by
   the ICMP unreachable rate limit in routers, since an adversary can
   determine the presence of a host without them.  In such cases, more
   bits of entropy would be needed to provide the same level of
   protection.













<span class="grey">Thaler                        Informational                     [Page 4]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc8065.html">RFC 8065</a>          IPv6-over-foo Privacy Considerations     February 2017</span>


<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Potential Approaches</span>

   The table below shows the number of bits of entropy currently
   available in various technologies:

      +---------------+--------------------------+--------------------+
      | Technology    | Reference                | Bits of Entropy    |
      +---------------+--------------------------+--------------------+
      | 802.15.4      | [<a href="rfc4944.html" title="&quot;Transmission of IPv6 Packets over IEEE 802.15.4 Networks&quot;">RFC4944</a>]                | 16+ or any EUI-64  |
      | Bluetooth LE  | [<a href="rfc7668.html" title="&quot;IPv6 over BLUETOOTH(R) Low Energy&quot;">RFC7668</a>]                | 48                 |
      | DECT ULE      | [<a href="#ref-DECT-ULE" title="&quot;Transmission of IPv6 Packets over DECT Ultra Low Energy&quot;">DECT-ULE</a>]               | 40 or any EUI-48   |
      | MS/TP         | [<a href="#ref-IPv6-over-MSTP" title="&quot;Transmission of IPv6 over MS/TP Networks&quot;">IPv6-over-MSTP</a>]         | 7 or 64            |
      | ITU-T G.9959  | [<a href="rfc7428.html" title="&quot;Transmission of IPv6 Packets over ITU-T G.9959 Networks&quot;">RFC7428</a>]                | 8                  |
      | NFC           | [<a href="#ref-IPv6-over-NFC" title="&quot;Transmission of IPv6 Packets over Near Field Communication&quot;">IPv6-over-NFC</a>]          | 5                  |
      +---------------+--------------------------+--------------------+

   Such technologies generally support either IEEE identifiers or so
   called "Short Addresses", or both, as link-layer addresses.  We
   discuss each in turn.

<span class="h3"><a class="selflink" name="section-3.1" href="#section-3.1">3.1</a>.  IEEE-Identifier-Based Addresses</span>

   Some technologies allow the use of IEEE EUI-48 or EUI-64 identifiers
   or allow the use of an arbitrary 64-bit identifier.  Using such an
   identifier to construct IPv6 addresses makes it easy to use the
   normal LOWPAN_IPHC encoding [<a href="rfc6282.html" title="&quot;Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks&quot;">RFC6282</a>] with stateless compression,
   which allows such IPv6 addresses to be fully elided in common cases.

   Global addresses with interface identifiers formed from IEEE
   identifiers can have insufficient entropy to mitigate address scans
   unless the IEEE identifier itself has sufficient entropy and enough
   bits of entropy are carried over into the IPv6 address to
   sufficiently mitigate the threats.  Privacy threats other than
   "Correlation over time" can be mitigated using per-network randomized
   link-layer addresses with enough entropy compared to the link
   lifetime.  A number of such proposals can be found at
   &lt;<a href="https://mentor.ieee.org/privecsg/documents">https://mentor.ieee.org/privecsg/documents</a>&gt;, and Section 10.8 of
   [<a href="#ref-BTCorev4.1" title="&quot;Specification of the Bluetooth System&quot;">BTCorev4.1</a>] specifies one for Bluetooth.  Using routable IPv6
   addresses derived from such link-layer addresses would be roughly
   equivalent to those specified in [<a href="rfc7217.html" title="&quot;A Method for Generating Semantically Opaque Interface Identifiers with IPv6 Stateless Address Autoconfiguration (SLAAC)&quot;">RFC7217</a>].

   Correlation over time (for all addresses, not just routable
   addresses) can be mitigated if the link-layer address itself changes
   often enough, such as each time the link is established, if the link
   lifetime is short.  For further discussion, see [<a href="#ref-RANDOM-ADDR" title="&quot;Implications of Randomized Link Layers Addresses for IPv6 Address Assignment&quot;">RANDOM-ADDR</a>].






<span class="grey">Thaler                        Informational                     [Page 5]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc8065.html">RFC 8065</a>          IPv6-over-foo Privacy Considerations     February 2017</span>


   Another potential concern is that of efficiency, such as avoiding
   Duplicate Address Detection (DAD) altogether when IPv6 addresses are
   based on IEEE identifiers.  <a href="rfc4429.html#appendix-A">Appendix&nbsp;A of [RFC4429]</a> provides an
   analysis of address-collision probability based on the number of bits
   of entropy.  A simple web search on "duplicate MAC addresses" will
   show that collisions do happen with MAC addresses; thus, based on the
   analysis in [<a href="rfc4429.html" title="&quot;Optimistic Duplicate Address Detection (DAD) for IPv6&quot;">RFC4429</a>], using sufficient bits of entropy in random
   addresses can provide greater protection against collision than using
   MAC addresses.

<span class="h3"><a class="selflink" name="section-3.2" href="#section-3.2">3.2</a>.  Short Addresses</span>

   A routable IPv6 address with an interface identifier formed from the
   combination of a "Short Address" and a set of well-known constant
   bits (such as padding with 0's) lacks sufficient entropy to mitigate
   address scanning unless the link lifetime is extremely short.
   Furthermore, an adversary could also use statistical methods to
   determine the size of the L2 address space and thereby make some
   inference regarding the underlying technology on a given link, and
   target further attacks accordingly.

   When Short Addresses are desired on links that are not guaranteed to
   have a short enough lifetime, the mechanism for constructing an IPv6
   interface identifier from a Short Address could be designed to
   sufficiently mitigate the problem.  For example, if all nodes on a
   given L2 network have a shared secret (such as the key needed to get
   on the layer-2 network), the 64-bit IID might be generated using a
   one-way hash that includes (at least) the shared secret together with
   the Short Address.  The use of such a hash would result in the IIDs
   being spread out among the full range of IID address space, thus
   mitigating address scans while still allowing full stateless
   compression/elision.

   For long-lived links, "temporary" addresses might even be generated
   in the same way by (for example) also including in the hash the
   Version Number from the Authoritative Border Router Option (<a href="rfc6775.html#section-4.3">Section</a>
   <a href="rfc6775.html#section-4.3">4.3 of [RFC6775]</a>), if any.  This would allow changing temporary
   addresses whenever the Version Number is changed, even if the set of
   prefix or context information is unchanged.

   In summary, any specification using Short Addresses should carefully
   construct an IID generation mechanism so as to provide sufficient
   entropy compared to the link lifetime.








<span class="grey">Thaler                        Informational                     [Page 6]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc8065.html">RFC 8065</a>          IPv6-over-foo Privacy Considerations     February 2017</span>


<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Recommendations</span>

   The following are recommended for adaptation-layer specifications:

   o  Security (privacy) sections should say how address scans are
      mitigated.  An address scan might be mitigated by having a link
      always be short-lived, by having a large number of bits of entropy
      in routable addresses, or by some combination thereof.  Thus, a
      specification should explain what the maximum lifetime of a link
      is in practice and show how the number of bits of entropy is
      sufficient given that lifetime.

   o  Technologies should define a way to include sufficient bits of
      entropy in the IPv6 interface identifier, based on the maximum
      link lifetime.  Specifying that randomized link-layer addresses
      can be used is one easy way to do so, for technologies that
      support such identifiers.

   o  Specifications should not simply construct an IPv6 interface
      identifier by padding a Short Address with a set of other well-
      known constant bits, unless the link lifetime is guaranteed to be
      extremely short or the Short Address is allocated by the network
      (rather than being constant in the node).  This also applies to
      link-local addresses if the same Short Address is used independent
      of network and is unique enough to allow location tracking.

   o  Specifications should make sure that an IPv6 address can change
      over long periods of time.  For example, the interface identifier
      might change each time a device connects to the network (if
      connections are short) or might change each day (if connections
      can be long).  This is necessary to mitigate correlation over
      time.

   o  If a device can roam between networks and more than a few bits of
      entropy exist in the IPv6 interface identifier, then make sure
      that the interface identifier can vary per network as the device
      roams.  This is necessary to mitigate location tracking.

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  Security Considerations</span>

   This entire document is about security considerations and how to
   specify possible mitigations.









<span class="grey">Thaler                        Informational                     [Page 7]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc8065.html">RFC 8065</a>          IPv6-over-foo Privacy Considerations     February 2017</span>


<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Informative References</span>

   [<a name="ref-BTCorev4.1" id="ref-BTCorev4.1">BTCorev4.1</a>]
              Bluetooth, "Specification of the Bluetooth System",
              Covered Core Package version: 4.1, December 2013,
              &lt;<a href="https://www.bluetooth.org/DocMan/handlers/DownloadDoc.ashx?doc_id=282159">https://www.bluetooth.org/DocMan/handlers/</a>
              <a href="https://www.bluetooth.org/DocMan/handlers/DownloadDoc.ashx?doc_id=282159">DownloadDoc.ashx?doc_id=282159</a>&gt;.

   [<a name="ref-DECT-ULE" id="ref-DECT-ULE">DECT-ULE</a>] Mariager, P., Petersen, J., Ed., Shelby, Z., Van de Logt,
              M., and D. Barthel, "Transmission of IPv6 Packets over
              DECT Ultra Low Energy", <a href="https://tools.ietf.org/html/draft-ietf-6lo-dect-ule-09">draft-ietf-6lo-dect-ule-09</a>,
              Work in Progress, December 2016.

   [<a name="ref-IPv6-over-MSTP" id="ref-IPv6-over-MSTP">IPv6-over-MSTP</a>]
              Lynn, K., Ed., Martocci, J., Neilson, C., and S.
              Donaldson, "Transmission of IPv6 over MS/TP Networks",
              <a href="https://tools.ietf.org/html/draft-ietf-6lo-6lobac-06">draft-ietf-6lo-6lobac-06</a>, Work in Progress, October 2016.

   [<a name="ref-IPv6-over-NFC" id="ref-IPv6-over-NFC">IPv6-over-NFC</a>]
              Choi, Y-H., Hong, Y-G., Youn, J-S., Kim, D-K., and J-H.
              Choi, "Transmission of IPv6 Packets over Near Field
              Communication", <a href="https://tools.ietf.org/html/draft-ietf-6lo-nfc-05">draft-ietf-6lo-nfc-05</a>, Work in Progress,
              October 2016.

   [<a name="ref-RANDOM-ADDR" id="ref-RANDOM-ADDR">RANDOM-ADDR</a>]
              Huitema, C., "Implications of Randomized Link Layers
              Addresses for IPv6 Address Assignment",
              <a href="https://tools.ietf.org/html/draft-huitema-6man-random-addresses-03">draft-huitema-6man-random-addresses-03</a>, Work in Progress,
              March 2016.

   [<a name="ref-RFC3972" id="ref-RFC3972">RFC3972</a>]  Aura, T., "Cryptographically Generated Addresses (CGA)",
              <a href="rfc3972.html">RFC 3972</a>, DOI 10.17487/RFC3972, March 2005,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3972">http://www.rfc-editor.org/info/rfc3972</a>&gt;.

   [<a name="ref-RFC4429" id="ref-RFC4429">RFC4429</a>]  Moore, N., "Optimistic Duplicate Address Detection (DAD)
              for IPv6", <a href="rfc4429.html">RFC 4429</a>, DOI 10.17487/RFC4429, April 2006,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4429">http://www.rfc-editor.org/info/rfc4429</a>&gt;.

   [<a name="ref-RFC4941" id="ref-RFC4941">RFC4941</a>]  Narten, T., Draves, R., and S. Krishnan, "Privacy
              Extensions for Stateless Address Autoconfiguration in
              IPv6", <a href="rfc4941.html">RFC 4941</a>, DOI 10.17487/RFC4941, September 2007,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4941">http://www.rfc-editor.org/info/rfc4941</a>&gt;.

   [<a name="ref-RFC4944" id="ref-RFC4944">RFC4944</a>]  Montenegro, G., Kushalnagar, N., Hui, J., and D. Culler,
              "Transmission of IPv6 Packets over IEEE 802.15.4
              Networks", <a href="rfc4944.html">RFC 4944</a>, DOI 10.17487/RFC4944, September 2007,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4944">http://www.rfc-editor.org/info/rfc4944</a>&gt;.




<span class="grey">Thaler                        Informational                     [Page 8]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc8065.html">RFC 8065</a>          IPv6-over-foo Privacy Considerations     February 2017</span>


   [<a name="ref-RFC5535" id="ref-RFC5535">RFC5535</a>]  Bagnulo, M., "Hash-Based Addresses (HBA)", <a href="rfc5535.html">RFC 5535</a>,
              DOI 10.17487/RFC5535, June 2009,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5535">http://www.rfc-editor.org/info/rfc5535</a>&gt;.

   [<a name="ref-RFC6282" id="ref-RFC6282">RFC6282</a>]  Hui, J., Ed., and P. Thubert, "Compression Format for IPv6
              Datagrams over IEEE 802.15.4-Based Networks", <a href="rfc6282.html">RFC 6282</a>,
              DOI 10.17487/RFC6282, September 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6282">http://www.rfc-editor.org/info/rfc6282</a>&gt;.

   [<a name="ref-RFC6724" id="ref-RFC6724">RFC6724</a>]  Thaler, D., Ed., Draves, R., Matsumoto, A., and T. Chown,
              "Default Address Selection for Internet Protocol Version 6
              (IPv6)", <a href="rfc6724.html">RFC 6724</a>, DOI 10.17487/RFC6724, September 2012,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6724">http://www.rfc-editor.org/info/rfc6724</a>&gt;.

   [<a name="ref-RFC6775" id="ref-RFC6775">RFC6775</a>]  Shelby, Z., Ed., Chakrabarti, S., Nordmark, E., and C.
              Bormann, "Neighbor Discovery Optimization for IPv6 over
              Low-Power Wireless Personal Area Networks (6LoWPANs)",
              <a href="rfc6775.html">RFC 6775</a>, DOI 10.17487/RFC6775, November 2012,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6775">http://www.rfc-editor.org/info/rfc6775</a>&gt;.

   [<a name="ref-RFC6973" id="ref-RFC6973">RFC6973</a>]  Cooper, A., Tschofenig, H., Aboba, B., Peterson, J.,
              Morris, J., Hansen, M., and R. Smith, "Privacy
              Considerations for Internet Protocols", <a href="rfc6973.html">RFC 6973</a>,
              DOI 10.17487/RFC6973, July 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6973">http://www.rfc-editor.org/info/rfc6973</a>&gt;.

   [<a name="ref-RFC7217" id="ref-RFC7217">RFC7217</a>]  Gont, F., "A Method for Generating Semantically Opaque
              Interface Identifiers with IPv6 Stateless Address
              Autoconfiguration (SLAAC)", <a href="rfc7217.html">RFC 7217</a>,
              DOI 10.17487/RFC7217, April 2014,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7217">http://www.rfc-editor.org/info/rfc7217</a>&gt;.

   [<a name="ref-RFC7288" id="ref-RFC7288">RFC7288</a>]  Thaler, D., "Reflections on Host Firewalls", <a href="rfc7288.html">RFC 7288</a>,
              DOI 10.17487/RFC7288, June 2014,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7288">http://www.rfc-editor.org/info/rfc7288</a>&gt;.

   [<a name="ref-RFC7421" id="ref-RFC7421">RFC7421</a>]  Carpenter, B., Ed., Chown, T., Gont, F., Jiang, S.,
              Petrescu, A., and A. Yourtchenko, "Analysis of the 64-bit
              Boundary in IPv6 Addressing", <a href="rfc7421.html">RFC 7421</a>,
              DOI 10.17487/RFC7421, January 2015,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7421">http://www.rfc-editor.org/info/rfc7421</a>&gt;.

   [<a name="ref-RFC7428" id="ref-RFC7428">RFC7428</a>]  Brandt, A. and J. Buron, "Transmission of IPv6 Packets
              over ITU-T G.9959 Networks", <a href="rfc7428.html">RFC 7428</a>,
              DOI 10.17487/RFC7428, February 2015,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7428">http://www.rfc-editor.org/info/rfc7428</a>&gt;.





<span class="grey">Thaler                        Informational                     [Page 9]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc8065.html">RFC 8065</a>          IPv6-over-foo Privacy Considerations     February 2017</span>


   [<a name="ref-RFC7668" id="ref-RFC7668">RFC7668</a>]  Nieminen, J., Savolainen, T., Isomaki, M., Patil, B.,
              Shelby, Z., and C. Gomez, "IPv6 over BLUETOOTH(R) Low
              Energy", <a href="rfc7668.html">RFC 7668</a>, DOI 10.17487/RFC7668, October 2015,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7668">http://www.rfc-editor.org/info/rfc7668</a>&gt;.

   [<a name="ref-RFC7721" id="ref-RFC7721">RFC7721</a>]  Cooper, A., Gont, F., and D. Thaler, "Security and Privacy
              Considerations for IPv6 Address Generation Mechanisms",
              <a href="rfc7721.html">RFC 7721</a>, DOI 10.17487/RFC7721, March 2016,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7721">http://www.rfc-editor.org/info/rfc7721</a>&gt;.

   [<a name="ref-RFC8064" id="ref-RFC8064">RFC8064</a>]  Gont, F., Cooper, A., Thaler, D., and W. Liu,
              "Recommendation on Stable IPv6 Interface Identifiers",
              <a href="rfc8064.html">RFC 8064</a>, February 2017,
              &lt;<a href="http://www.rfc-editor.org/info/rfc8064">http://www.rfc-editor.org/info/rfc8064</a>&gt;.

Author's Address

   Dave Thaler
   Microsoft
   One Microsoft Way
   Redmond, WA  98052
   United States of America

   Email: dthaler@microsoft.com



























Thaler                        Informational                    [Page 10]

</pre><br />
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.129c, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>
</body>

<!-- Mirrored from tools.ietf.org/html/rfc8065 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:19:51 GMT -->
</html>
