<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6327 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:30 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:6327" name="DC.Identifier"/>
<meta content="The IETF TRILL (TRansparent Interconnection of Lots of Links) protocol
provides optimal pair-wise data forwarding without configuration, safe
forwarding even during periods of temporary loops, and support for
multipathing of both unicast and multicast traffic. TRILL accomplishes
this by using IS-IS (Intermediate System to Intermediate System) link
state routing and by encapsulating traffic using a header that
includes a hop count. Devices that implement TRILL are called Routing
Bridges (RBridges).  TRILL supports multi-access LAN (Local Area
Network) links that can have multiple end stations and RBridges
attached. This document describes four aspects of the TRILL LAN Hello
protocol used on such links, particularly adjacency, designated
RBridge selection, and MTU (Maximum Transmission Unit) and pseudonode
procedures, with state machines. There is no change for IS-IS point-
to-point Hellos used on links configured as point-to-point in TRILL.
[STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="Dutt, Dinesh G." name="DC.Creator"/>
<meta content="3rd, Donald E. Eastlake" name="DC.Creator"/>
<meta content="Perlman, Radia" name="DC.Creator"/>
<meta content="Manral, Vishwas" name="DC.Creator"/>
<meta content="Ghanwani, Anoop" name="DC.Creator"/>
<meta content="July, 2011" name="DC.Date.Issued"/>
<meta content="Routing Bridges (RBridges): Adjacency" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6327 - Routing Bridges (RBridges): Adjacency</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgbrown" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6327.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6327" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-trill-adj" title="draft-ietf-trill-adj">draft-ietf-tril...</a>] [<a href="https://datatracker.ietf.org/doc/rfc6327" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6327" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6327" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">Obsoleted by: <a href="rfc7177.html">7177</a>                                     PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">Updated by: <a href="rfc7180.html">7180</a>                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                   D. Eastlake 3rd
Request for Comments: 6327                                        Huawei
Updates: <a href="rfc6325.html">6325</a>                                                 R. Perlman
Category: Standards Track                                     Intel Labs
ISSN: 2070-1721                                              A. Ghanwani
                                                                 Brocade
                                                                 D. Dutt
                                                           Cisco Systems
                                                               V. Manral
                                                     Hewlett Packard Co.
                                                               July 2011


                 <span class="h1">Routing Bridges (RBridges): Adjacency</span>

Abstract

   The IETF TRILL (TRansparent Interconnection of Lots of Links)
   protocol provides optimal pair-wise data forwarding without
   configuration, safe forwarding even during periods of temporary
   loops, and support for multipathing of both unicast and multicast
   traffic.  TRILL accomplishes this by using IS-IS (Intermediate System
   to Intermediate System) link state routing and by encapsulating
   traffic using a header that includes a hop count.  Devices that
   implement TRILL are called Routing Bridges (RBridges).

   TRILL supports multi-access LAN (Local Area Network) links that can
   have multiple end stations and RBridges attached.  This document
   describes four aspects of the TRILL LAN Hello protocol used on such
   links, particularly adjacency, designated RBridge selection, and MTU
   (Maximum Transmission Unit) and pseudonode procedures, with state
   machines.  There is no change for IS-IS point-to-point Hellos used on
   links configured as point-to-point in TRILL.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6327">http://www.rfc-editor.org/info/rfc6327</a>.




<span class="grey">Perlman, et al.              Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


Copyright Notice

   Copyright (c) 2011 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





































<span class="grey">Perlman, et al.              Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-4">4</a>
      <a href="#section-1.1">1.1</a>. Content and Precedence .....................................<a href="#page-4">4</a>
      <a href="#section-1.2">1.2</a>. Terminology and Acronyms ...................................<a href="#page-5">5</a>
   <a href="#section-2">2</a>. The TRILL Hello Environment and Purposes ........................<a href="#page-5">5</a>
      <a href="#section-2.1">2.1</a>. Incrementally Replacing 802.1Q-2005 Bridges ................<a href="#page-5">5</a>
      <a href="#section-2.2">2.2</a>. Handling Native Frames .....................................<a href="#page-6">6</a>
      <a href="#section-2.3">2.3</a>. Zero or Minimal Configuration ..............................<a href="#page-7">7</a>
      <a href="#section-2.4">2.4</a>. MTU Robustness .............................................<a href="#page-7">7</a>
      <a href="#section-2.5">2.5</a>. Purposes of the TRILL Hello Protocol .......................<a href="#page-8">8</a>
   <a href="#section-3">3</a>. Adjacency State Machinery .......................................<a href="#page-9">9</a>
      <a href="#section-3.1">3.1</a>. TRILL LAN Hellos, MTU Test, and VLANs ......................<a href="#page-9">9</a>
      <a href="#section-3.2">3.2</a>. Adjacency Table Entries and States ........................<a href="#page-10">10</a>
      <a href="#section-3.3">3.3</a>. Adjacency and Hello Events ................................<a href="#page-11">11</a>
      <a href="#section-3.4">3.4</a>. Adjacency State Diagram and Table .........................<a href="#page-13">13</a>
      <a href="#section-3.5">3.5</a>. Multiple Parallel Links ...................................<a href="#page-14">14</a>
      <a href="#section-3.6">3.6</a>. Insufficient Space in Adjacency Table .....................<a href="#page-15">15</a>
   <a href="#section-4">4</a>. RBridge LAN Ports and DRB State ................................<a href="#page-15">15</a>
      <a href="#section-4.1">4.1</a>. Port Table Entries and DRB Election State .................<a href="#page-16">16</a>
      <a href="#section-4.2">4.2</a>. DRB Election Events .......................................<a href="#page-16">16</a>
           <a href="#section-4.2.1">4.2.1</a>. DRB Election Details ...............................<a href="#page-17">17</a>
           <a href="#section-4.2.2">4.2.2</a>. Change in DRB ......................................<a href="#page-18">18</a>
           <a href="#section-4.2.3">4.2.3</a>. Change in Designated VLAN ..........................<a href="#page-18">18</a>
      <a href="#section-4.3">4.3</a>. State Table and Diagram ...................................<a href="#page-18">18</a>
   <a href="#section-5">5</a>. MTU Matching ...................................................<a href="#page-20">20</a>
   <a href="#section-6">6</a>. Pseudonodes ....................................................<a href="#page-21">21</a>
   <a href="#section-7">7</a>. TRILL Hello Reception and Transmission .........................<a href="#page-21">21</a>
      <a href="#section-7.1">7.1</a>. Transmitting TRILL Hellos .................................<a href="#page-22">22</a>
      <a href="#section-7.2">7.2</a>. Receiving TRILL Hellos ....................................<a href="#page-23">23</a>
   <a href="#section-8">8</a>. Multiple Ports on the Same Link ................................<a href="#page-24">24</a>
   <a href="#section-9">9</a>. Security Considerations ........................................<a href="#page-24">24</a>
   <a href="#section-10">10</a>. References ....................................................<a href="#page-24">24</a>
      <a href="#section-10.1">10.1</a>. Normative References .....................................<a href="#page-24">24</a>
      <a href="#section-10.2">10.2</a>. Informative References ...................................<a href="#page-25">25</a>
   <a href="#section-11">11</a>. Acknowledgements ..............................................<a href="#page-25">25</a>















<span class="grey">Perlman, et al.              Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>. Introduction</span>

   The IETF TRILL (TRansparent Interconnection of Lots of Links)
   protocol [<a href="rfc6325.html" title='"RBridges: Base Protocol Specification"'>RFC6325</a>] provides optimal pair-wise data frame forwarding
   without configuration, safe forwarding even during periods of
   temporary loops, and support for multipathing of both unicast and
   multicast traffic.  TRILL accomplishes this by using [<a href="#ref-IS-IS" title='"Intermediate System to Intermediate System Intra-Domain Routing Exchange Protocol for use in Conjunction with the Protocol for Providing the Connectionless-mode Network Service (ISO 8473)"'>IS-IS</a>]
   (Intermediate System to Intermediate System) link state routing and
   encapsulating traffic using a header that includes a hop count.  The
   design supports VLANs (Virtual Local Area Networks) and optimization
   of the distribution of multi-destination frames based on VLANs and
   IP-derived multicast groups.  Devices that implement TRILL are called
   RBridges (Routing Bridges).

   The purpose of this document is to improve the quality of the
   description of four aspects of the TRILL LAN (Local Area Network)
   Hello protocol that RBridges use on broadcast (LAN) links.  It
   includes reference implementation details.  Alternative
   implementations that interoperate on the wire are permitted.  There
   is no change for IS-IS point-to-point Hellos used on links configured
   as point-to-point in TRILL.

   The scope of this document is limited to the following aspects of the
   TRILL LAN Hello protocol:

      - Adjacency formation

      - DRB (Designated RBridge aka DIS (Designated Intermediate
        System)) election

      - Rules for 2-way and MTU (Maximum Transmission Unit) matching for
        advertisements

      - Creation and use of pseudonodes

   For other aspects of the TRILL base protocol, see [<a href="rfc6325.html" title='"RBridges: Base Protocol Specification"'>RFC6325</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Content%20and%20Precedence"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Content and Precedence</span>

   <a href="#section-2">Section 2</a> below explains the rationale for the differences between
   the TRILL LAN Hello protocol and the Layer 3 IS-IS LAN Hello protocol
   [<a href="#ref-IS-IS" title='"Intermediate System to Intermediate System Intra-Domain Routing Exchange Protocol for use in Conjunction with the Protocol for Providing the Connectionless-mode Network Service (ISO 8473)"'>IS-IS</a>] [<a href="rfc1195.html" title='"Use of OSI IS-IS for routing in TCP/IP and dual environments"'>RFC1195</a>] in light of the environment for which the TRILL
   protocol is designed.  It also describes the purposes of the TRILL
   LAN Hello protocol.

   <a href="#section-3">Section 3</a> describes the adjacency state machine and its states and
   relevant events.




<span class="grey">Perlman, et al.              Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


   <a href="#section-4">Section 4</a> describes the Designated RBridge (DRB) election state
   machine for RBridge ports and its states and relevant events.

   <a href="#section-5">Section 5</a> describes MTU testing and matching on a TRILL link.

   <a href="#section-6">Section 6</a> discusses pseudonode creation and use.

   <a href="#section-7">Section 7</a> provides more details on the reception and transmission of
   TRILL LAN Hellos.

   <a href="#section-8">Section 8</a> discusses multiple ports from one RBridge on the same link.

   In case of conflict between this document and [<a href="rfc6325.html" title='"RBridges: Base Protocol Specification"'>RFC6325</a>], this
   document prevails.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Terminology%20and%20Acronyms"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Terminology and Acronyms</span>

   This document uses the acronyms defined in [<a href="rfc6325.html" title='"RBridges: Base Protocol Specification"'>RFC6325</a>] supplemented by
   the following additional acronym:

      SNPA - Subnetwork Point of Attachment

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20The%20TRILL-Hello%20Environment%20and%20Purposes"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  The TRILL-Hello Environment and Purposes</span>

   [<a id="ref-IS-IS" name="ref-IS-IS">IS-IS</a>] has subnetwork-independent functions and subnetwork-dependent
   functions.  Currently, Layer 3 use of IS-IS supports two types of
   subnetworks: (1) point-to-point link subnetworks between routers and
   (2) general broadcast (LAN) subnetworks.  Because of the differences
   between the environment of Layer 3 routers and the environment of
   TRILL RBridges, instead of the broadcast (LAN) subnetwork-dependent
   functions encountered at Layer 3, which are specified in [<a href="#ref-IS-IS" title='"Intermediate System to Intermediate System Intra-Domain Routing Exchange Protocol for use in Conjunction with the Protocol for Providing the Connectionless-mode Network Service (ISO 8473)"'>IS-IS</a>]
   <a href="#section-8.4">Section 8.4</a>, the TRILL protocol uses modified subnetwork-dependent
   functions for a LAN subnetwork.  The environmental differences are
   described in Sections <a href="#section-2.1">2.1</a> through <a href="#section-2.4">2.4</a>, followed by a summation, in
   <a href="#section-2.5">Section 2.5</a>, of the purposes of the TRILL LAN Hello protocol.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Incrementally%20Replacing%20802.1Q-2005%20Bridges"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Incrementally Replacing 802.1Q-2005 Bridges</span>

   RBridges can incrementally replace IEEE [<a href="#ref-802.1Q-2005" title='"IEEE Standard for Local and metropolitan area networks / Virtual Bridged Local Area Networks"'>802.1Q-2005</a>] bridges.  Thus,
   RBridges need to provide similar services, including delivery of
   frames only to links in the frame's VLAN and priority queuing of
   frames, to the extent that multiple queues are implemented at any
   particular RBridge port.




<span class="grey">Perlman, et al.              Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


   RBridge ports are IEEE [<a href="#ref-802.1Q-2005" title='"IEEE Standard for Local and metropolitan area networks / Virtual Bridged Local Area Networks"'>802.1Q-2005</a>] ports in terms of their frame
   VLAN and priority configuration and processing as described in
   <a href="rfc6325.html#section-2.6">Section 2.6 of [RFC6325]</a>.  When a frame is received through an
   RBridge port, like a frame received through any [<a href="#ref-802.1Q-2005" title='"IEEE Standard for Local and metropolitan area networks / Virtual Bridged Local Area Networks"'>802.1Q-2005</a>] port,
   it has an associated VLAN ID and frame priority.  When a frame is
   presented to an [<a href="#ref-802.1Q-2005" title='"IEEE Standard for Local and metropolitan area networks / Virtual Bridged Local Area Networks"'>802.1Q-2005</a>] port for queuing and transmission, it
   must be accompanied by a VLAN ID and frame priority.  However,
   whether the frame, if actually transmitted, will be VLAN tagged is
   determined by whether or not the port is configured to "strip VLAN
   tags".  Furthermore, in the general case, a broadcast (LAN) link
   between RBridges can be a VLAN-capable bridged LAN that may be
   configured to partition VLANs.

   Because devices that restrict VLAN connectivity, such as bridged LANs
   or provider bridging equipment, can be part of the link between
   RBridges, TRILL Data and TRILL IS-IS frames between RBridges use the
   link's Designated VLAN.  The Designated VLAN is dictated for a link
   by the elected Designated RBridge (equivalent to the Designated
   Intermediate System at Layer 3).  Because TRILL Data frames flow
   between RBridges on a link only in the link's Designated VLAN,
   adjacency for routing calculations is based only on connectivity
   characteristics in that VLAN.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Handling%20Native%20Frames"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Handling Native Frames</span>

   Ordinary Layer 3 data packets are already "tamed" when they are
   originated by an end station: they include a hop count and Layer 3
   source and destination address fields.  Furthermore, for ordinary
   data packets, there is no requirement to preserve their outer Layer 2
   addressing and, at least if the packets are unicast, they are
   addressed to their first hop router.  In contrast, RBridges running
   TRILL must accept, transport, and deliver untamed "native" frames (as
   defined in <a href="rfc6325.html#section-1.4">Section 1.4 of [RFC6325]</a>).  Native frames lack a TRILL hop
   count field.  Native frames also have Layer 2 addresses that indicate
   their source and are used as the basis for their forwarding.  These
   Layer 2 addresses must be preserved for delivery to the native
   frame's Layer 2 destination.  One resulting difference is that
   RBridge ports providing native frame service must receive in
   promiscuous MAC (Media Access Control) address mode, while Layer 3
   router ports typically receive in a regularly selective MAC address
   mode.

   TRILL handles this by having, on the link where an end station
   originated a native frame, one RBridge "ingress" such a locally
   originated native frame by adding a TRILL Header that includes a hop
   count, thus converting it to a TRILL Data frame.  This augmented
   frame is then routed to one RBridge on the link having the
   destination end station for the frame (or one RBridge on each such



<span class="grey">Perlman, et al.              Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


   link if it is a multi-destination frame).  Such final RBridges
   perform an "egress" function, removing the TRILL Header and
   delivering the original frame to its destination(s).  (For the
   purposes of TRILL, a Layer 3 router is an end station.)

   Care must be taken to avoid a loop that would involve egressing a
   native frame and then re-ingressing it because, while it is in native
   form, it would not be protected by a hop count.  Such a loop could
   involve multiplication of the number of frames each time around and
   would likely saturate all links involved within milliseconds.  For
   TRILL, safety against such loops for a link is more important than
   data connectivity on that link.

   The primary TRILL defense mechanism against such loops, which is
   mandatory, is to assure that, as far as practically possible, there
   is only a single RBridge on each link that is in charge of ingressing
   and egressing native frames from and to that link.  This is the
   Designated RBridge that is elected using TRILL LAN Hellos as further
   described in Sections <a href="#section-2.5">2.5</a> and <a href="#section-4">4</a> below.

   Because bridged LANs between RBridges can be configured in complex
   ways (e.g., so that some VLANs pass frames unidirectionally) and loop
   safety is important, there are additional TRILL defenses against
   loops that are beyond the scope of this document.  Specifically,
   these defend against the occurrence of looping traffic that is in
   native format for part of the loop.  These additional defenses have
   no effect on adjacency states or the receipt or forwarding of TRILL
   Data frames; they only affect native frame ingress and egress.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20Zero%20or%20Minimal%20Configuration"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  Zero or Minimal Configuration</span>

   RBridges are expected to provide service with zero configuration,
   except for services such as non-default VLAN or priority that require
   configuration when offered by [<a href="#ref-802.1Q-2005" title='"IEEE Standard for Local and metropolitan area networks / Virtual Bridged Local Area Networks"'>802.1Q-2005</a>] bridges.  This differs
   from Layer 3 routing where routers typically need to be configured as
   to the subnetworks connected to each port, etc., to provide service.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.4.%20%20MTU%20Robustness"></a><a class="selflink" href="#section-2.4" name="section-2.4">2.4</a>.  MTU Robustness</span>

   TRILL IS-IS needs to be robust against links with reasonably
   restricted MTUs, including links that accommodate only classic
   Ethernet frames, despite the addition of reasonable headers such as
   VLAN tags.  This is particularly true for TRILL LAN Hellos so as to
   assure that a unique DRB is elected.

   TRILL will also be used inside data centers where it is not uncommon
   for all or most of the links and switches to support frames
   substantially larger than the classic Ethernet maximum.  For example,



<span class="grey">Perlman, et al.              Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


   they may have an MTU adequate to comfortably handle Fiber Channel
   over Ethernet frames, for which T11 recommends a 2,500-byte MTU
   [<a href="#ref-FCoE" title='"FCoE Max Size"'>FCoE</a>].  It would be beneficial for an RBridge campus with such a
   large MTU to be able to safely make use of it.

   These needs are met by limiting the size of TRILL LAN Hellos and by
   the use of MTU testing as described below.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.5.%20%20Purposes%20of%20the%20TRILL-Hello%20Protocol"></a><a class="selflink" href="#section-2.5" name="section-2.5">2.5</a>.  Purposes of the TRILL-Hello Protocol</span>

   There are three purposes for the TRILL-Hello protocol as listed below
   along with a reference to the section of this document in which each
   is discussed:

   a) To determine which RBridge neighbors have acceptable connectivity
      to be reported as part of the topology (<a href="#section-3">Section 3</a>)

   b) To elect a unique Designated RBridge on the link (<a href="#section-4">Section 4</a>)

   c) To determine the MTU with which it is possible to communicate with
      each RBridge neighbor (<a href="#section-5">Section 5</a>)

   In Layer 3 IS-IS, all three of these functions are combined.  Hellos
   may be padded to the maximum length (see <a href="rfc3719.html#section-6">[RFC3719], Section 6</a>) so
   that a router neighbor is not even discovered if it is impossible to
   communicate with it using maximum-sized packets.  Also, even if
   Hellos from a neighbor R2 are received by R1, if connectivity to R2
   is not 2-way (i.e., R2 does not list R1 in R2's Hello), then R1 does
   not consider R2 as a Designated Router candidate.  Because of this
   logic, it is possible at Layer 3 for multiple Designated Routers to
   be elected on a LAN, with each representing the LAN as a pseudonode.
   It appears to the topology as if the LAN is now two or more separate
   LANs.  Although this is surprising, it does not disrupt Layer 3
   IS-IS.

   In contrast, this behavior is not acceptable for TRILL, since in
   TRILL it is important that all RBridges on the link know about each
   other, and choose a single RBridge to be the DRB and to control the
   native frame ingress and egress on that link.  Otherwise, multiple
   RBridges might encapsulate/decapsulate the same native frame, forming
   loops that are not protected by the hop count in the TRILL header as
   discussed above.

   So, the TRILL-Hello protocol is best understood by focusing on each
   of these functions separately.






<span class="grey">Perlman, et al.              Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


   One other issue with TRILL LAN Hellos is to ensure that subsets of
   the information can appear in any single message, and be processable,
   in the spirit of IS-IS Link State PDUs (LSPs) and Complete Sequence
   Number PDUs (CSNPs).  TRILL-Hello frames, even though they are not
   padded, can become very large.  An example where this might be the
   case is when some sort of backbone technology interconnects hundreds
   of TRILL sites over what would appear to TRILL to be a giant
   Ethernet, where the RBridges connected to that cloud will perceive
   that backbone to be a single link with hundreds of neighbors.  Thus,
   the TRILL Hello uses a different Neighbor TLV [<a href="rfc6326.html" title='"TRILL Use of IS-IS"'>RFC6326</a>] that lists
   neighbors seen for a range of MAC (SNPA) addresses.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Adjacency%20State%20Machinery"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Adjacency State Machinery</span>

   Each RBridge port has associated with it a port state, as discussed
   in <a href="#section-4">Section 4</a>, and a table of zero or more adjacencies as discussed in
   this section.  The states such adjacencies can have, the events that
   cause state changes, the actions associated with those state changes,
   and a state table and diagram are given below.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20TRILL%20LAN%20Hellos%2C%20MTU%20Test%2C%20and%20VLANs"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  TRILL LAN Hellos, MTU Test, and VLANs</span>

   The determination of LSP-reported adjacencies on links that are not
   configured as point-to-point is made using TRILL LAN Hellos (see also
   <a href="#section-7">Section 7</a>) and an optional MTU test.  Appropriate TRILL LAN Hello
   exchange and the satisfaction of the MTU test, if the MTU test is
   enabled (see <a href="#section-5">Section 5</a>), is required for there to be an adjacency
   that will be reported in an LSP of the RBridge in question.

   Because bridges acting as glue on the LAN might be configured in such
   a way that some VLANs are partitioned, it is necessary for RBridges
   to transmit Hellos with multiple VLAN tags.  The conceptually
   simplest solution may have been to have all RBridges transmit up to
   4,094 times as many Hellos, one with each legal VLAN ID enabled at
   each port, but this would obviously have deleterious performance
   implications.  So, the TRILL protocol specifies that if RB1 knows it
   is not the DRB, it transmits its Hellos on only a limited set of
   VLANs, and only an RBridge that believes itself to be the DRB on a
   port "sprays" its TRILL Hellos on all of its enabled VLANs at a port
   (with the ability to configure to send on only a subset of those).
   The details are given in <a href="rfc6325.html#section-4.4.3">[RFC6325], Section 4.4.3</a>.

   If the MAC (SNPA) address of more than one RBridge port on a link are
   the same, all but one of such ports are put in the Suspended state
   (see <a href="#section-4">Section 4</a>) and do not participate in the link except to monitor
   whether they should stay suspended.





<span class="grey">Perlman, et al.              Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


   All TRILL LAN Hellos issued by an RBridge on a particular port MUST
   have the same source MAC address, priority, desired Designated VLAN,
   and Port ID, regardless of the VLAN in which the Hello is sent.  Of
   course, the priority and desired Designated VLAN can change on
   occasion, but then the new value must similarly be used in all TRILL
   Hellos on the port, regardless of VLAN.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Adjacency%20Table%20Entries%20and%20States"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Adjacency Table Entries and States</span>

   Each adjacency is in one of the following four states:

      Down:
         This is a virtual state for convenience in creating state
         diagrams and tables.  It indicates that the adjacency is non-
         existent, and there is no entry in the adjacency table for it.

      Detect:
         An adjacent neighbor has been detected either (1) not on the
         Designated VLAN or (2) on the Designated VLAN, but neither
         2-way connectivity nor the MTU of such connectivity has been
         confirmed.

      2-Way:
         2-way connectivity to the neighbor has been found on the
         Designated VLAN but MTU testing is enabled and has not yet
         confirmed that the connectivity meets the campus minimum MTU
         requirement.

      Report:
         There is 2-way connectivity to the neighbor on the Designated
         VLAN and either MTU testing has confirmed that the connectivity
         meets the campus minimum MTU requirement or MTU testing is not
         enabled.  This connectivity will be reported in an LSP (with
         appropriate provision for the link pseudonode, if any, as
         described in <a href="#section-6">Section 6</a>).

   For an adjacency in any of the three non-down states (Detect, 2-Way,
   or Report), there will be an adjacency table entry.  That entry will
   give the state of the adjacency and will also include the information
   listed below.

      o  The address of the neighbor (that is, its SNPA address, usually
         a 48-bit MAC address), and the Port ID and the System ID in the
         received Hellos.  Together, these three quantities uniquely
         identify the adjacency.






<span class="grey">Perlman, et al.              Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


      o  Exactly two Hello holding timers, each consisting of a 16-bit
         unsigned integer number of seconds: a Designated VLAN holding
         timer and a non-Designated VLAN holding timer.

      o  The 7-bit unsigned priority of the neighbor to be the DRB.

      o  The VLAN that the neighbor RBridge wants to be the Designated
         VLAN on the link, called the desired Designated VLAN.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Adjacency%20and%20Hello%20Events"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Adjacency and Hello Events</span>

   The following events can change the state of an adjacency:

      A0.  Receive a TRILL Hello whose source MAC address (SNPA) is
           equal to that of the port on which it is received.  This is a
           special event that is handled as described immediately after
           this list of events.  It does not appear in the state
           transition table or diagram.

      A1.  Receive a TRILL Hello (other than an A0 event) on the
           Designated VLAN with a TRILL Neighbor TLV that explicitly
           lists the receiver's (SNPA) address.

      A2.  Receive a TRILL Hello (other than an A0 event) that either
           (1) is not on the Designated VLAN (any TRILL Neighbor TLV in
           such a Hello is ignored) or (2) is on the Designated VLAN but
           does not contain a TRILL Neighbor TLV covering an address
           range that includes the receiver's (SNPA) address.

      A3.  Receive a TRILL Hello (other than an A0 event) on the
           Designated VLAN with one or more TRILL Neighbor TLVs covering
           an address range that includes the receiver's (SNPA) address
           -- and none of which lists the receiver.

      A4.  The expiration of one or both Hello holding timers results in
           them both being expired.

      A5.  The Designated VLAN Hello holding timer expires, but the non-
           Designated VLAN Hello holding timer still has time left until
           it expires.

      A6.  MTU test successful.

      A7.  MTU test was successful but now fails.

      A8.  The RBridge port goes operationally down.





<span class="grey">Perlman, et al.              Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


   For the special A0 event, the Hello is examined to determine if it is
   higher priority to be the DRB than the port on which it is received
   as described in <a href="#section-4.2.1">Section 4.2.1</a>.  If the Hello is of lower priority
   than the receiving port, it is discarded with no further action.  If
   it is of higher priority than the receiving port, then any
   adjacencies for that port are discarded (transitioned to the Down
   state), and the port is suspended as described in <a href="#section-4.2">Section 4.2</a>.

   The receipt of a TRILL LAN Hello with a source MAC (SNPA) address
   different from that of the receiving port (that is, the occurrence of
   events A1, A2, or A3), causes the following actions (except where the
   Hello would create a new adjacency table entry, the table is full, or
   the Hello is too low priority to displace an existing entry as
   described in <a href="#section-3.6">Section 3.6</a>).  The Designated VLAN used in these actions
   is the Designated VLAN dictated by the DRB determined without taking
   the received TRILL LAN Hello into account (see <a href="#section-4">Section 4</a>).

      o  If the receipt of the Hellos creates a new adjacency table
         entry, the neighbor RBridge MAC (SNPA) address, Port ID, and
         System ID are set from the Hello.

      o  The appropriate Hello holding timer for the adjacency,
         depending on whether or not the Hello was received on the
         Designated VLAN, is set to the Holding Time field of the Hello.
         If the receipt of the Hello is creating a new adjacency table
         entry, the other timer is set to expired.

      o  The priority of the neighbor RBridge to be the DRB is set to
         the priority field of the Hello.

      o  The VLAN that the neighbor RBridge wants to be the Designated
         VLAN on the link is set from the Hello.

      o  If the creation of a new adjacency table entry or the priority
         update above changes the results of the DRB election on the
         link, the appropriate RBridge port event (D2 or D3) occurs,
         after the above actions, as described in <a href="#section-4.2">Section 4.2</a>.

      o  If there is no change in the DRB, but the neighbor Hello is
         from the DRB and has a changed Designated VLAN from the
         previous Hello received from the DRB, the result is a change in
         Designated VLAN for the link as specified in <a href="#section-4.2.3">Section 4.2.3</a>.

   An event A4 resulting in both Hello Holding timers for an adjacency
   being expired and the adjacency going Down may also result in an
   event D3 as described in <a href="#section-4.2">Section 4.2</a>.





<span class="grey">Perlman, et al.              Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


   Concerning events A6 and A7, if MTU testing is not enabled, A6 is
   considered to occur immediately upon the adjacency entering the 2-Way
   state, and A7 cannot occur.

   See further TRILL LAN Hello receipt details in <a href="#section-7">Section 7</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Adjacency%20State%20Diagram%20and%20Table"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Adjacency State Diagram and Table</span>

   The table below shows the transitions between the states defined
   above based on the events defined above:

               | Event |  Down  | Detect | 2-Way  | Report |
               +-------+--------+--------+--------+--------+
               |  A1   | 2-Way  | 2-Way  | 2-Way  | Report |
               |  A2   | Detect | Detect | 2-Way  | Report |
               |  A3   | Detect | Detect | Detect | Detect |
               |  A4   |  N/A   | Down   | Down   | Down   |
               |  A5   |  N/A   | Detect | Detect | Detect |
               |  A6   |  N/A   |  N/A   | Report | Report |
               |  A7   |  N/A   |  N/A   | 2-Way  | 2-Way  |
               |  A8   | Down   | Down   | Down   | Down   |

   N/A indicates that the event to the left is Not Applicable in the
   state at the top of the column.  These events affect only a single
   adjacency.  The special A0 event transitions all adjacencies to Down,
   as explained immediately after the list of adjacency events above.

























<span class="grey">Perlman, et al.              Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


   The diagram below presents the same information as that in the state
   table:

                            +---------------+
                            |     Down      |&lt;--------+
                            +---------------+         |
                              |     |  ^  |           |
                         A2,A3|     |A8|  |A1         |
                              |     +--+  |           |
                              |           +-----------|---+
                              V                       |   |
                            +----------------+ A4,A8  |   |
                     +-----&gt;|      Detect    |-------&gt;|   |
                     |      +----------------+        |   |
                     |        |  |         ^          |   |
                     |      A1|  |A2,A3,A5 |          |   |
                     |        |  +---------+          |   |
                     |        |                       |   |
                     |        |          +------------|---+
                     |        |          |            |
                     |        V          V            |
                     |A3,A5 +----------------+ A4,A8  |
                     |&lt;-----|     2-Way      |-------&gt;|
                     |      +----------------+        |
                     |       |   ^ |        ^         |
                     |     A6|   | |A1,A2,A7|         |
                     |       |   | +--------+         |
                     |       |   |                    |
                     |       |   |A7                  |
                     |       V   |                    |
                     |A3,A5 +-------------+ A4,A8     |
                     |&lt;-----|   Report    |----------&gt;|
                            +-------------+
                              |         ^
                              |A1,A2,A6 |
                              +---------+

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.5.%20%20Multiple%20Parallel%20Links"></a><a class="selflink" href="#section-3.5" name="section-3.5">3.5</a>.  Multiple Parallel Links</span>

   There can be multiple parallel adjacencies between neighbor RBridges
   that are visible to TRILL.  (Multiple low-level links that have been
   bonded together by technologies such as link aggregation [<a href="#ref-802.1AX" title='"IEEE Standard for Local and metropolitan area networks / Link Aggregation"'>802.1AX</a>]
   appear to TRILL as a single link over which only a single TRILL
   adjacency could be established.)

   Any such links that have pseudonodes (see <a href="#section-6">Section 6</a>) are
   distinguished in the topology; such adjacencies, if they are in the
   Report state, appear in LSPs as per <a href="#section-6">Section 6</a>.  However, there can be



<span class="grey">Perlman, et al.              Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


   multiple parallel adjacencies without pseudonodes because they are
   point-to-point adjacencies or LAN adjacencies for which a pseudonode
   is not being created.  Such parallel, non-pseudonode adjacencies in
   the Report state appear in LSPs as a single adjacency.  The cost of
   such an adjacency MAY be adjusted downwards to account for the
   parallel paths.  Multipathing across such parallel connections can be
   freely done for unicast TRILL Data traffic on a per-flow basis but is
   restricted for multi-destination traffic, as described in <a href="#section-4.5.2">Section</a>
   <a href="#section-4.5.2">4.5.2</a> (point 3) and <a href="rfc6325.html#appendix-C">Appendix C of [RFC6325]</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.6.%20%20Insufficient%20Space%20in%20Adjacency%20Table"></a><a class="selflink" href="#section-3.6" name="section-3.6">3.6</a>.  Insufficient Space in Adjacency Table</span>

   If the receipt of a TRILL LAN Hello would create a new adjacency
   table entry (that is, would transition an adjacency out of the Down
   state), there may be no space for the new entry.  In that case, the
   DRB election priority (see <a href="#section-4.2.1">Section 4.2.1</a>) of the new entry that would
   be created is compared with that priority for the existing entries.
   If the new entry is higher priority than the lowest priority existing
   entry, it replaces the lowest priority existing entry, which is
   transitioned to the Down state.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20RBridge%20LAN%20Ports%20and%20DRB%20State"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  RBridge LAN Ports and DRB State</span>

   The information at an RBridge associated with each of its LAN ports
   includes the following:

      o  Enablement bit, which defaults to enabled.

      o  SNPA address (usually a 48-bit MAC address) of the port.

      o  Port ID, used in TRILL Hellos sent on the port.

      o  The Holding Time, used in TRILL Hellos sent on the port.

      o  The Priority to be the DRB, used in TRILL Hellos sent on the
         port.

      o  The DRB status of the port, determined as specified below.

      o  A 16-bit unsigned Suspension timer, measured in seconds.

      o  The desired Designated VLAN.  The VLAN this RBridge wants to be
         the Designated VLAN for the link out this port, used in TRILL
         Hellos sent on the port.

      o  A table of zero or more adjacencies (see <a href="#section-3">Section 3</a>).





<span class="grey">Perlman, et al.              Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Port%20Table%20Entries%20and%20DRB%20Election%20State"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Port Table Entries and DRB Election State</span>

   The TRILL equivalent of the DIS (Designated Intermediate System) on a
   link is the DRB or Designated RBridge.  The DRB election state
   machinery is described below.

   Each RBridge port is in one of the following four DRB states:

      Down:
         The port is operationally down.  It might be administratively
         disabled or down at the link layer.  In this state, there will
         be no adjacency table entries for the port, and no TRILL Hellos
         or other IS-IS PDUs or TRILL Data frames are accepted or
         transmitted.

      Suspended:
         Operation of the port is suspended because there is a higher
         priority port on the link with the same MAC (SNPA) address.
         This is the same as the down state with the exception that
         TRILL Hellos are accepted for the sole purpose of determining
         whether to change the value of the Suspension timer for the
         port as described below.

      DRB:
         The port is the DRB and can receive and transmit TRILL Data
         frames.

      Not DRB:
         The port is deferring to another port on the link, which it
         believes is the DRB, but can still receive and transmit TRILL
         Data frames.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20DRB%20Election%20Events"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  DRB Election Events</span>

   The following events can change the DRB state of a port:

      D1.  Expiration of the suspension timer while the port is in the
           Suspended state or the enablement of the port.

      D2.  Adjacency table for the port changes, and there are now
           entries for one or more other RBridge ports on the link that
           appear to be higher priority to be the DRB than the local
           port.

      D3.  The port is not Down or Suspended, and the adjacency table
           for the port changes, so there are now no entries for other
           RBridge ports on the link that appear to be higher priority
           to be the DRB than the local port.



<span class="grey">Perlman, et al.              Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


      D4.  Receipt of a TRILL Hello with the same MAC address (SNPA) as
           the receiving port and higher priority to be the DRB as
           described for event A0.

      D5.  The port becomes operationally down.

   Event D1 is considered to occur on RBridge boot if the port is
   administratively and link-layer enabled.

   Event D4 causes the port to enter the Suspended state and all
   adjacencies for the port to be discarded (transitioned to the Down
   state).  If the port was in some state other than Suspended, the
   suspension timer is set to the Holding Time in the Hello that causes
   event D4.  If it was in the Suspended state, the suspension timer is
   set to the maximum of its current value and the Holding Time in the
   Hello that causes event D4.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.1.%20%20DRB%20Election%20Details"></a><a class="selflink" href="#section-4.2.1" name="section-4.2.1">4.2.1</a>.  DRB Election Details</span>

   Events D2 and D3 constitute losing and winning the DRB election at
   the port, respectively.

   The candidates for election are the local RBridge and all RBridges
   with which there is an adjacency on the port in an adjacency state
   other than Down state.  The winner is the RBridge with highest
   priority to be the DRB, as determined from the 7-bit priority field
   in that RBridge's Hellos received and the local port's priority to be
   the DRB field, with MAC (SNPA) address as a tiebreaker, Port ID as a
   secondary tiebreaker, and System ID as a tertiary tiebreaker.  These
   fields are compared as unsigned integers with the larger magnitude
   being considered higher priority.

   Resort to the secondary and tertiary tiebreakers should only be
   necessary in rare circumstances when multiple ports have the same
   priority and MAC (SNPA) address and some of them are not yet
   suspended.  For example, RB1, that has low priority to be the DRB on
   the link, could receive Hellos from two other ports on the link that
   have the same MAC address as each other and are higher priority to be
   the DRB.  One of these two ports with the same MAC address will be
   suspended, cease sending Hellos, and the Hello from it received by
   RB1 will eventually time out.  But, in the meantime, RB1 can use the
   tiebreakers to determine which port is the DRB and thus which port's
   Hello to believe for such purposes as setting the Designated VLAN on
   the link.







<span class="grey">Perlman, et al.              Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.2.%20%20Change%20in%20DRB"></a><a class="selflink" href="#section-4.2.2" name="section-4.2.2">4.2.2</a>.  Change in DRB</span>

   Events D2 and D3 result from a change in the apparent DRB on the
   link.  Unnecessary DRB changes should be avoided, especially on links
   offering native frame service, as a DRB change will generally cause a
   transient interruption to native frame service.

   If a change in the DRB on the link changes the Designated VLAN on the
   link, the actions specified in <a href="#section-4.2.3">Section 4.2.3</a> are taken.

   If an RBridge changes in either direction between being the
   Designated RBridge and not being the Designated RBridge at a port,
   this will generally change the VLANs on which Hellos are sent by that
   RBridge on that port as specified in <a href="rfc6325.html#section-4.4.3">Section 4.4.3 of [RFC6325]</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.3.%20%20Change%20in%20Designated%20VLAN"></a><a class="selflink" href="#section-4.2.3" name="section-4.2.3">4.2.3</a>.  Change in Designated VLAN</span>

   Unnecessary changes in the Designated VLAN on a link should be
   avoided because a change in the Designated VLAN can cause a transient
   interruption to TRILL Data forwarding on the link.  When practical,
   all RBridge ports on a link should be configured with the same
   desired Designated VLAN so that, in case the winner of the DRB
   election changes, for any reason, the Designated VLAN will remain the
   same.

   If an RBridge detects a change in Designated VLAN on a link, then,
   for all adjacency table entries for a port to that link, the RBridge
   takes the following steps in the order given:

      o  The non-Designated VLAN Hello Holding timer is set to the
         maximum of its time to expiration and the current time to
         expiration of the Designated VLAN Hello Holding timer.

      o  The Designated VLAN Hello Holding timer is then set to expired
         (if necessary), and an event A5 occurs for the adjacency (see
         <a href="#section-3.3">Section 3.3</a>).

   If the Designated VLAN for a link changes, this will generally change
   the VLANs on which Hellos are sent by an RBridge port on that link as
   specified in <a href="rfc6325.html#section-4.4.3">Section 4.4.3 of [RFC6325]</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20State%20Table%20and%20Diagram"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  State Table and Diagram</span>

   The table below shows the transitions between the DRB states defined
   above based on the events defined above:






<span class="grey">Perlman, et al.              Standards Track                   [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


             | Event | Down   | Suspend |  DRB    | Not DRB |
             +-------+--------+---------+---------+---------+
             |  D1   | DRB    | DRB     |  N/A    |  N/A    |
             |  D2   |  N/A   |  N/A    | Not DRB | Not DRB |
             |  D3   |  N/A   |  N/A    | DRB     | DRB     |
             |  D4   |  N/A   | Suspend | Suspend | Suspend |
             |  D5   | Down   | Down    | Down    | Down    |

   N/A indicates that the event to the left is Not Applicable in the
   state at the top of the column.

   The diagram below presents the same information as in the state
   table:

                 +-------------+
                 |  Down       |&lt;--------------+
                 +-+---+-------+     ^         |
                   |   |   ^         |         |
                 D1|   |D5 |         |         |
                   |   +---+         |D5       |
                   |                 |         |
                   |        +--------+----+    |
                   |        |  Suspended  |&lt;---|---+
                   |        +-+-----+-----+    |   |
                   |        D1|  ^  |   ^      |   |
                   |          |  |  |D4 |      |   |
                   |          |  |  +---+      |   |
                   |          |  |             |   |
                   |          |  |D4           |   |
                   V          V  |             |   |
                 +---------------+-+ D5        |   |
                 |          DRB    |----------&gt;|   |
                 +--------+--+-----+           |   |
                     ^    |  |  ^              |   |
                     |  D2|  |D3|              |   |
                     |    |  +--+              |   |
                     |    |         D4         |   |
                     |D3  |  +-----------------|---+
                     |    V  |                 |
                +----+-------+-+ D5            |
                |   Not DRB    |--------------&gt;|
                +----+---------+
                     |    ^
                     |D2  |
                     +----+






<span class="grey">Perlman, et al.              Standards Track                   [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20MTU%20Matching"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  MTU Matching</span>

   The purpose of MTU testing is to ensure that the links used in the
   campus topology can pass TRILL IS-IS and Data frames at the RBridge
   campus MTU.

   An RBridge, RB1, determines the desired campus link MTU by
   calculating the minimum of its originatingL1LSPBufferSize and the
   originatingL1LSPBufferSize of other RBridges in the campus, as
   advertised in the link state database, but not less than 1,470 bytes.
   Although originatingL1LSPBufferSize in Layer 3 [<a href="#ref-IS-IS" title='"Intermediate System to Intermediate System Intra-Domain Routing Exchange Protocol for use in Conjunction with the Protocol for Providing the Connectionless-mode Network Service (ISO 8473)"'>IS-IS</a>] is limited to
   the range 512 to 1,492 bytes inclusive, in TRILL it is limited to the
   range 1,470 to 65,535 bytes inclusive.

   Although MTU testing is optional, it is mandatory for an RBridge to
   respond to an MTU-probe PDU with an MTU-ack PDU [<a href="rfc6325.html" title='"RBridges: Base Protocol Specification"'>RFC6325</a>] [<a href="rfc6326.html" title='"TRILL Use of IS-IS"'>RFC6326</a>].
   Use of multicast or unicast for MTU-probe and MTU-ack is an
   implementation choice.  However, the burden on the link is generally
   minimized by multicasting MTU-probes when a response from all other
   RBridges on the link is desired, such as when initializing or re-
   confirming MTU, unicasting MTU-probes when a response from a single
   RBridge is desired, such as one that has just been detected on the
   link, and unicasting all MTU-ack frames.

   RB1 can test the MTU size to RB2 as described in <a href="rfc6325.html#section-4.3.2">Section 4.3.2 of
   [RFC6325]</a>.  For this purpose, MTU testing is only done in the
   Designated VLAN.  An adjacency that fails the MTU test at the campus
   MTU will not enter the Report state or, if the adjacency is in that
   state, it leaves that state.  Thus, an adjacency failing the MTU test
   will not be reported by the RBridge performing the test.  Since
   inclusion in least-cost route computation requires the adjacency to
   be reported by both ends, as long as the MTU failure is noticed by
   the RBridge at either end of the adjacency, it will not be so used.

   If it tests MTU, RB1 reports the largest size for which the MTU test
   succeeds or a flag indicating that it fails at the campus MTU.  This
   report always appears with the neighbor in RB1's TRILL Neighbor TLV.
   RB1 MAY also report this with the adjacency in an Extended
   Reachability TLV in RB1's LSP.  RB1 MAY choose to test MTU sizes
   greater than the desired campus MTU as well as the desired campus
   MTU.

   Most types of TRILL IS-IS frames, such as LSPs, can make use of the
   campus MTU.  The exceptions are TRILL Hellos, which must be kept
   small for loop safety, and the MTU PDUs, whose size must be adjusted
   appropriately for the tests being performed.





<span class="grey">Perlman, et al.              Standards Track                   [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Pseudonodes"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Pseudonodes</span>

   The Designated RBridge (DRB), determined as described above, controls
   whether a pseudonode will be used on a link.

   If the DRB sets the bypass pseudonode bit in its TRILL LAN Hellos,
   the RBridges on the link (including the DRB) just directly report all
   their adjacencies on the LAN that are in the Report state.  If the
   DRB does not set the bypass pseudonode bit in its TRILL Hellos, then
   (1) the DRB reports in its LSP its adjacency to the pseudonode, (2)
   the DRB sends LSPs on behalf of the pseudonode in which it reports
   adjacency to all other RBridges on the link where it sees that
   adjacency in the Report state, and (3) all other RBridges on the link
   report their adjacency to the pseudonode if they see their adjacency
   to the DRB as being in the Report state and do not report any other
   adjacencies on the link.  Setting the bypass pseudonode bit has no
   effect on how LSPs are flooded on a link.  It only affects what LSPs
   are generated.

   It is anticipated that many links between RBridges will actually be
   point-to-point, in which case using a pseudonode merely adds to the
   complexity.  For example, if RB1 and RB2 are the only RBridges on the
   link, and RB1 is DRB, then if RB1 creates a pseudonode that is used,
   there are 3 LSPs: for, say, RB1.25 (the pseudonode), RB1, and RB2,
   where RB1.25 reports connectivity to RB1 and RB2, and RB1 and RB2
   each just say they are connected to RB1.25.  Whereas if DRB RB1 sets
   the bypass pseudonode bit in its Hellos, then there will be only 2
   LSPs: RB1 and RB2 each reporting connectivity to each other.

   A DRB SHOULD set the bypass pseudonode bit in its Hellos if it has
   not seen at least two simultaneous adjacencies in the Report state
   since it last rebooted or was reset by network management.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20TRILL-Hello%20Reception%20and%20Transmission"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  TRILL-Hello Reception and Transmission</span>

   This section provides further details on the receipt and transmission
   of TRILL LAN Hellos.

   TRILL LAN Hellos, like all TRILL IS-IS frames, are primarily
   distinguished from Layer 3 IS-IS frames by being sent to the
   All-IS-IS-RBridges multicast address (01-80-C2-00-00-41).  TRILL
   IS-IS frames also have the L2-IS-IS Ethertype (0x22F4) and are
   Ethertype encoded.

   Although future extensions to TRILL may include use of Level 2 IS-IS,
   [<a href="rfc6325.html" title='"RBridges: Base Protocol Specification"'>RFC6325</a>] specifies TRILL using a single Level 1 Area with Area
   Address zero (see <a href="rfc6326.html#section-4.2">Section 4.2 of [RFC6326]</a>).




<span class="grey">Perlman, et al.              Standards Track                   [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


   IS-IS Layer 3 routers are frequently connected to other Layer 3
   routers that are part of a different routing domain.  In that case,
   the externalDomain flag (see [<a href="#ref-IS-IS" title='"Intermediate System to Intermediate System Intra-Domain Routing Exchange Protocol for use in Conjunction with the Protocol for Providing the Connectionless-mode Network Service (ISO 8473)"'>IS-IS</a>]) is normally set for the port
   through which such a connection is made.  The setting of this flag to
   "true" causes no IS-IS PDUs to be sent out the port and any IS-IS
   PDUs received to be discarded, including Hellos.  RBridges operate in
   a different environment where all neighbor RBridges merge into a
   single campus.  For loop safety, RBridges do not implement the
   externalDomain flag or implement it with the fixed value "false".
   They send and receive TRILL LAN Hellos on every port that is not
   disabled or configured as point-to-point.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Transmitting%20TRILL%20Hellos"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Transmitting TRILL Hellos</span>

   TRILL LAN Hellos are sent with the same timing as Layer 3 IS-IS LAN
   Hellos [<a href="#ref-IS-IS" title='"Intermediate System to Intermediate System Intra-Domain Routing Exchange Protocol for use in Conjunction with the Protocol for Providing the Connectionless-mode Network Service (ISO 8473)"'>IS-IS</a>]; however, no Hellos are sent if a port is in the
   Suspended or Down states.

   TRILL-Hello PDUs SHOULD NOT be padded and MUST NOT be sent exceeding
   1,470 octets; however, a received TRILL Hello longer than 1,470
   octets is processed normally.

   TRILL-Hello PDU headers MUST conform to the following:

      o  Maximum Area Addresses equal to 1.

      o  Circuit Type equal to 1.

   Each TRILL Hello MUST contain an Area Addresses TLV listing only the
   single Area zero, and an MT Port Capabilities TLV containing a VLAN-
   FLAGS sub-TLV [<a href="rfc6326.html" title='"TRILL Use of IS-IS"'>RFC6326</a>].  If a Protocols Supported TLV is present, it
   MUST list the TRILL NLPID (0xC0).

   The TRILL Neighbor TLV sent in a Hello MUST show the neighbor
   information, as sensed by the transmitting RBridge, for the VLAN on
   which the Hello is sent.  Since implementations conformant to this
   document maintain such information on a per-VLAN basis only for the
   Designated VLAN, such implementations only send the TRILL Neighbor
   TLV in TRILL Hellos on the Designated VLAN.

   It is RECOMMENDED that, if there is sufficient room, a TRILL Neighbor
   TLV or TLVs, as described in <a href="rfc6325.html#section-4.4.2.1">Section 4.4.2.1 of [RFC6325]</a>, covering
   the entire range of MAC addresses and listing all adjacencies with a
   non-zero Designated VLAN Hello Holding time, or an empty list of
   neighbors if there are no such adjacencies, be in TRILL Hellos sent
   on the Designated VLAN.  If this is not possible, then TRILL Neighbor
   TLV's covering sub-ranges of MAC addresses should be sent so that the
   entire range is covered reasonably promptly.  Delays in sending TRILL



<span class="grey">Perlman, et al.              Standards Track                   [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


   Neighbor TLVs will delay the advancement of adjacencies to the Report
   state and the discovery of some link failures.  Rapid (for example,
   sub-second) detection of link or node failures is best addressed with
   a protocol designed for that purpose, such as Bidirectional
   Forwarding Detection (BFD) [<a href="rfc5880.html" title='"Bidirectional Forwarding Detection (BFD)"'>RFC5880</a>], use of which with TRILL will be
   specified in a separate document.

   To ensure that any RBridge RB2 can definitively determine whether RB1
   can hear RB2, RB1's neighbor list MUST eventually cover every
   possible range of IDs, that is, within a period that depends on RB1's
   policy and not necessarily within any specific period such as its
   Holding Time.  In other words, if X1 is the smallest ID reported in
   one of RB1's neighbor lists, and the "smallest" flag is not set, then
   X1 MUST appear in a different neighbor list as well, as the largest
   ID reported in that fragment.  Or lists may overlap, as long as there
   is no gap, such that some range, say between Xi and Xj, never appears
   in any list.

   A TRILL Hello MAY also contain any TLV permitted in a Layer 3 IS-IS
   Hello.  TLVs that are unsupported/unknown are ignored.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Receiving%20TRILL%20Hellos"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Receiving TRILL Hellos</span>

   Assuming a frame has the All-IS-IS-RBridges multicast address and
   L2-IS-IS Ethertype, it will be examined to see if it appears to be an
   IS-IS PDU.  If so, and it appears to be a LAN Hello PDU, the
   following tests are performed.

      o  If the Circuit Type field is not 1, the PDU is discarded.

      o  If the PDU does not contain an Area Address TLV or it contains
         an Area Address TLV that is not the single Area Address zero,
         it is discarded.

      o  If the Hello includes a Protocols Supported TLV that does not
         list the TRILL NLPID (0xC0), it is discarded.  It is acceptable
         if there is no Protocols Supported TLV present.

      o  If the Hello does not contain an MT Port Capabilities TLV
         containing a VLAN-FLAGS sub-TLV [<a href="rfc6326.html" title='"TRILL Use of IS-IS"'>RFC6326</a>], it is discarded.

      o  If the maximumAreaAddresses field of the PDU is not 1, it is
         discarded.

      o  If IS-IS authentication is in use on the link and the PDU
         either has no Authentication TLV or validation of that
         Authentication TLV fails, it is discarded.




<span class="grey">Perlman, et al.              Standards Track                   [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


   If none of the rules in the list above has been satisfied, and the
   frame is parseable, it is assumed to be a well-formed TRILL Hello
   received on the link.  It is treated as an event A0, A1, A2, or A3
   based on the criteria listed in <a href="#section-3.3">Section 3.3</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Multiple%20Ports%20on%20the%20Same%20Link"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Multiple Ports on the Same Link</span>

   It is possible for an RBridge RB1 to have multiple ports on the same
   link that are not in the Suspended state.  It is important for RB1 to
   recognize which of its ports are on the same link.  RB1 can detect
   this condition based on receiving TRILL LAN Hello messages with the
   same LAN ID on multiple ports.

   The DRB election is port-based (see <a href="#section-4">Section 4</a>) and only the Hellos
   from the elected port can perform certain functions such as dictating
   the Designated VLAN or whether a pseudonode will be used; however,
   the election also designates the RBridge with that port as DRB for
   the link.  An RBridge may choose to load split some tasks among its
   ports on the link if it has more than one and it is safe to do so as
   described in <a href="rfc6325.html#section-4.4.4">Section 4.4.4 of [RFC6325]</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Security%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Security Considerations</span>

   This memo provides improved documentation of some aspects of the
   TRILL base protocol standard, particularly four aspects of the TRILL
   LAN Hello protocol.  It does not change the security considerations
   of the TRILL base protocol.  See <a href="rfc6325.html#section-6">Section 6 of [RFC6325]</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20References"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Normative%20References"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Normative References</span>

   [<a id="ref-IS-IS" name="ref-IS-IS">IS-IS</a>]       ISO/IEC 10589:2002, Second Edition, "Intermediate
                 System to Intermediate System Intra-Domain Routing
                 Exchange Protocol for use in Conjunction with the
                 Protocol for Providing the Connectionless-mode Network
                 Service (ISO 8473)", 2002.

   [<a id="ref-RFC1195" name="ref-RFC1195">RFC1195</a>]     Callon, R., "Use of OSI IS-IS for routing in TCP/IP and
                 dual environments", <a href="rfc1195.html">RFC 1195</a>, December 1990.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]     Bradner, S., "Key words for use in RFCs to Indicate
                 Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC6325" name="ref-RFC6325">RFC6325</a>]     Perlman, R., D. Eastlake, D. Dutt, S. Gai, and A.
                 Ghanwani, "RBridges: Base Protocol Specification", <a href="rfc6325.html">RFC</a>
                 <a href="rfc6325.html">6325</a>, July 2011.




<span class="grey">Perlman, et al.              Standards Track                   [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


   [<a id="ref-RFC6326" name="ref-RFC6326">RFC6326</a>]     Eastlake, D., Banerjee, A., Dutt, D., Perlman, R., and
                 A. Ghanwani, "TRILL Use of IS-IS", <a href="rfc6326.html">RFC 6326</a>, July 2011.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.2.%20%20Informative%20References"></a><a class="selflink" href="#section-10.2" name="section-10.2">10.2</a>.  Informative References</span>

   [<a id="ref-802.1AX" name="ref-802.1AX">802.1AX</a>]     "IEEE Standard for Local and metropolitan area networks
                 / Link Aggregation", 802.1AX-2008, 1 January 2008.

   [<a id="ref-802.1Q-2005" name="ref-802.1Q-2005">802.1Q-2005</a>] "IEEE Standard for Local and metropolitan area networks
                 / Virtual Bridged Local Area Networks", 802.1Q-2005, 19
                 May 2006.

   [<a id="ref-FCoE" name="ref-FCoE">FCoE</a>]        From www.t11.org discussion of "FCoE Max Size"
                 generated from T11/09-251v1, 04/27/2009, "FCoE frame or
                 FCoE PDU".

   [<a id="ref-RFC3719" name="ref-RFC3719">RFC3719</a>]     Parker, J., Ed., "Recommendations for Interoperable
                 Networks using Intermediate System to Intermediate
                 System (IS-IS)", February 2004.

   [<a id="ref-RFC5880" name="ref-RFC5880">RFC5880</a>]     Katz, D. and D. Ward, "Bidirectional Forwarding
                 Detection (BFD)", <a href="rfc5880.html">RFC 5880</a>, June 2010.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20Acknowledgements"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  Acknowledgements</span>

   The authors of [<a href="rfc6325.html" title='"RBridges: Base Protocol Specification"'>RFC6325</a>], those listed in the Acknowledgements
   section of [<a href="rfc6325.html" title='"RBridges: Base Protocol Specification"'>RFC6325</a>], and the contributions of Jari Arkko, Ayan
   Banerjee, Les Ginsberg, Sujay Gupta, David Harrington, Pete McCann,
   Erik Nordmark, and Mike Shand, to this document, are hereby
   acknowledged.





















<span class="grey">Perlman, et al.              Standards Track                   [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc6327.html">RFC 6327</a>                   RBridges: Adjacency                 July 2011</span>


Authors' Addresses

   Donald E. Eastlake, 3rd
   Huawei Technologies
   155 Beaver Street
   Milford, MA 01757 USA

   Phone: +1-508-333-2270
   EMail: d3e3e3@gmail.com


   Radia Perlman
   Intel Labs
   2200 Mission College Blvd.
   Santa Clara, CA 95054-1549 USA

   Phone: +1-408-765-8080
   EMail: Radia@alum.mit.edu


   Anoop Ghanwani
   Brocade
   130 Holger Way
   San Jose, CA 95134 USA

   Phone: +1-408-333-7149
   EMail: anoop@alumni.duke.edu


   Dinesh G. Dutt
   Cisco Systems
   170 Tasman Drive
   San Jose, CA 95134-1706 USA

   Phone: +1-408-527-0955
   EMail: ddutt@cisco.com


   Vishwas Manral
   Hewlett Packard Co.
   19111 Pruneridge Ave,
   Cupertino, CA 95014 USA

   Phone: +1-408-447-1497
   EMail: vishwas.manral@hp.com






Perlman, et al.              Standards Track                   [Page 26]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc6327 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:30 GMT --></html>