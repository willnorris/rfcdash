<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc4868 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:39 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:4868" name="DC.Identifier"/>
<meta content="This specification describes the use of Hashed Message Authentication
Mode (HMAC) in conjunction with the SHA-256, SHA-384, and SHA-512
algorithms in IPsec. These algorithms may be used as the basis for
data origin authentication and integrity verification mechanisms for
the Authentication Header (AH), Encapsulating Security Payload (ESP),
Internet Key Exchange Protocol (IKE), and IKEv2 protocols, and also as
Pseudo-Random Functions (PRFs) for IKE and IKEv2. Truncated output
lengths are specified for the authentication-related variants, with
the corresponding algorithms designated as HMAC-SHA-256-128, HMAC-
SHA-384-192, and HMAC-SHA-512-256. The PRF variants are not truncated,
and are called PRF-HMAC-SHA-256, PRF-HMAC-SHA-384, and PRF-HMAC-
SHA-512. [STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="Frankel, Sheila" name="DC.Creator"/>
<meta content="Kelly, Scott G." name="DC.Creator"/>
<meta content="May, 2007" name="DC.Date.Issued"/>
<meta content="Using HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 with IPsec" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 4868 - Using HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 with IPsec</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc4868.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc4868" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-kelly-ipsec-ciph-sha2" title="draft-kelly-ipsec-ciph-sha2">draft-kelly-ips...</a>] [<a href="https://datatracker.ietf.org/doc/rfc4868" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4868" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc4868" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=4868">Errata</a>]</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Network Working Group                                           S. Kelly
Request for Comments: 4868                                Aruba Networks
Category: Standards Track                                     S. Frankel
                                                                    NIST
                                                                May 2007


     <span class="h1">Using HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 with IPsec</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The IETF Trust (2007).

Abstract

   This specification describes the use of Hashed Message Authentication
   Mode (HMAC) in conjunction with the SHA-256, SHA-384, and SHA-512
   algorithms in IPsec.  These algorithms may be used as the basis for
   data origin authentication and integrity verification mechanisms for
   the Authentication Header (AH), Encapsulating Security Payload (ESP),
   Internet Key Exchange Protocol (IKE), and IKEv2 protocols, and also
   as Pseudo-Random Functions (PRFs) for IKE and IKEv2.  Truncated
   output lengths are specified for the authentication-related variants,
   with the corresponding algorithms designated as HMAC-SHA-256-128,
   HMAC-SHA-384-192, and HMAC-SHA-512-256.  The PRF variants are not
   truncated, and are called PRF-HMAC-SHA-256, PRF-HMAC-SHA-384, and
   PRF-HMAC-SHA-512.
















<span class="grey">Kelly &amp; Frankel             Standards Track                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  The HMAC-SHA-256+ Algorithms . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-2.1">2.1</a>.  Keying Material  . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
       2.1.1.  Data Origin Authentication and Integrity
               Verification Usage . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
       <a href="#section-2.1.2">2.1.2</a>.  Pseudo-Random Function (PRF) Usage . . . . . . . . . .  <a href="#page-4">4</a>
       <a href="#section-2.1.3">2.1.3</a>.  Randomness and Key Strength  . . . . . . . . . . . . .  <a href="#page-5">5</a>
       <a href="#section-2.1.4">2.1.4</a>.  Key Distribution . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
       <a href="#section-2.1.5">2.1.5</a>.  Refreshing Keys  . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-2.2">2.2</a>.  Padding  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-2.3">2.3</a>.  Truncation . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-2.4">2.4</a>.  Using HMAC-SHA-256+ as PRFs in IKE and IKEv2 . . . . . . .  <a href="#page-7">7</a>
     2.5.  Interactions with the ESP, IKE, or IKEv2 Cipher
           Mechanisms . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-2.6">2.6</a>.  HMAC-SHA-256+ Parameter Summary  . . . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-2.7">2.7</a>.  Test Vectors . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
       <a href="#section-2.7.1">2.7.1</a>.  PRF Test Vectors . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
       <a href="#section-2.7.2">2.7.2</a>.  Authenticator Test Vectors . . . . . . . . . . . . . . <a href="#page-11">11</a>
   <a href="#section-3">3</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#section-3.1">3.1</a>.  HMAC Key Length vs Truncation Length . . . . . . . . . . . <a href="#page-17">17</a>
   <a href="#section-4">4</a>.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . <a href="#page-18">18</a>
   <a href="#section-5">5</a>.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-19">19</a>
   <a href="#section-6">6</a>.  References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-19">19</a>
     <a href="#section-6.1">6.1</a>.  Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-19">19</a>
     <a href="#section-6.2">6.2</a>.  Informative References . . . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
























<span class="grey">Kelly &amp; Frankel             Standards Track                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   This document specifies the use of SHA-256, SHA-384, and SHA-512
   [<a href="#ref-SHA2-1" title="&quot;FIPS PUB 180-2 'Specifications for the Secure Hash Standard'&quot;">SHA2-1</a>] combined with HMAC [<a href="#ref-HMAC" title='"HMAC: Keyed- Hashing for Message Authentication"'>HMAC</a>] as data origin authentication and
   integrity verification mechanisms for the IPsec AH [<a href="#ref-AH" title='"IP Authentication Header"'>AH</a>], ESP [<a href="#ref-ESP" title='"IP Encapsulating Security Payload (ESP)"'>ESP</a>],
   IKE [<a href="#ref-IKE" title='"The Internet Key Exchange (IKE)"'>IKE</a>], and IKEv2 [<a href="#ref-IKEv2" title='"Internet Key Exchange (IKEv2) Protocol"'>IKEv2</a>] protocol.  Output truncation is
   specified for these variants, with the corresponding algorithms
   designated as HMAC-SHA-256-128, HMAC-SHA-384-192, and HMAC-SHA-512-
   256.  These truncation lengths are chosen in accordance with the
   birthday bound for each algorithm.

   This specification also describes untruncated variants of these
   algorithms as Pseudo-Random Functions (PRFs) for use with IKE and
   IKEv2, and those algorithms are called PRF-HMAC-SHA-256, PRF-HMAC-
   SHA-384, and PRF-HMAC-SHA-512.  For ease of reference, these PRF
   algorithms and the authentication variants described above are
   collectively referred to below as "the HMAC-SHA-256+ algorithms".

   The goal of the PRF variants are to provide secure pseudo-random
   functions suitable for generation of keying material and other
   protocol-specific numeric quantities, while the goal of the
   authentication variants is to ensure that packets are authentic and
   cannot be modified in transit.  The relative security of HMAC-SHA-
   256+ when used in either case is dependent on the distribution scope
   and unpredictability of the associated secret key.  If the key is
   unpredictable and known only by the sender and recipient, these
   algorithms ensure that only parties holding an identical key can
   derive the associated values.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20The%20HMAC-SHA-256%2B%20Algorithms"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  The HMAC-SHA-256+ Algorithms</span>

   [<a id="ref-SHA2-1" name="ref-SHA2-1">SHA2-1</a>] and [<a href="#ref-SHA2-2" title='"Descriptions of SHA-256, SHA-384, and SHA-512"'>SHA2-2</a>] describe the underlying SHA-256, SHA-384, and
   SHA-512 algorithms, while [<a href="#ref-HMAC" title='"HMAC: Keyed- Hashing for Message Authentication"'>HMAC</a>] describes the HMAC algorithm.  The
   HMAC algorithm provides a framework for inserting various hashing
   algorithms such as SHA-256, and [SHA256+] describes combined usage of
   these algorithms.  The following sections describe the various
   characteristics and requirements of the HMAC-SHA-256+ algorithms when
   used with IPsec.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Keying%20Material"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Keying Material</span>

   Requirements for keying material vary depending on whether the
   algorithm is functioning as a PRF or as an authentication/integrity
   mechanism.  In the case of authentication/integrity, key lengths are
   fixed according to the output length of the algorithm in use.  In the






<span class="grey">Kelly &amp; Frankel             Standards Track                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


   case of PRFs, key lengths are variable, but guidance is given to
   ensure interoperability.  These distinctions are described further
   below.

   Before describing key requirements for each usage, it is important to
   clarify some terms we use below:

   Block size:  the size of the data block the underlying hash algorithm
      operates upon.  For SHA-256, this is 512 bits, for SHA-384 and
      SHA-512, this is 1024 bits.

   Output length:  the size of the hash value produced by the underlying
      hash algorithm.  For SHA-256, this is 256 bits, for SHA-384 this
      is 384 bits, and for SHA-512, this is 512 bits.

   Authenticator length:  the size of the "authenticator" in bits.  This
      only applies to authentication/integrity related algorithms, and
      refers to the bit length remaining after truncation.  In this
      specification, this is always half the output length of the
      underlying hash algorithm.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.1.%20%20Data%20Origin%20Authentication%20and%20Integrity%20Verification%20Usage"></a><a class="selflink" href="#section-2.1.1" name="section-2.1.1">2.1.1</a>.  Data Origin Authentication and Integrity Verification Usage</span>

   HMAC-SHA-256+ are secret key algorithms.  While no fixed key length
   is specified in [<a href="#ref-HMAC" title='"HMAC: Keyed- Hashing for Message Authentication"'>HMAC</a>], this specification requires that when used as
   an integrity/authentication algorithm, a fixed key length equal to
   the output length of the hash functions MUST be supported, and key
   lengths other than the output length of the associated hash function
   MUST NOT be supported.

   These key length restrictions are based in part on the
   recommendations in [<a href="#ref-HMAC" title='"HMAC: Keyed- Hashing for Message Authentication"'>HMAC</a>] (key lengths less than the output length
   decrease security strength, and keys longer than the output length do
   not significantly increase security strength), and in part because
   allowing variable length keys for IPsec authenticator functions would
   create interoperability issues.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.2.%20%20Pseudo-Random%20Function%20%28PRF%29%20Usage"></a><a class="selflink" href="#section-2.1.2" name="section-2.1.2">2.1.2</a>.  Pseudo-Random Function (PRF) Usage</span>

   IKE and IKEv2 use PRFs for generating keying material and for
   authentication of the IKE Security Association.  The IKEv2
   specification differentiates between PRFs with fixed key sizes and
   those with variable key sizes, and so we give some special guidance
   for this below.







<span class="grey">Kelly &amp; Frankel             Standards Track                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


   When a PRF described in this document is used with IKE or IKEv2, it
   is considered to have a variable key length, and keys are derived in
   the following ways (note that we simply reiterate that which is
   specified in [<a href="#ref-HMAC" title='"HMAC: Keyed- Hashing for Message Authentication"'>HMAC</a>]):

   o  If the length of the key is exactly the algorithm block size, use
      it as-is.

   o  If the key is shorter than the block size, lengthen it to exactly
      the block size by padding it on the right with zero bits.
      However, note that [<a href="#ref-HMAC" title='"HMAC: Keyed- Hashing for Message Authentication"'>HMAC</a>] strongly discourages a key length less
      than the output length.  Nonetheless, we describe handling of
      shorter lengths here in recognition of shorter lengths typically
      chosen for IKE or IKEv2 pre-shared keys.

   o  If the key is longer than the block size, shorten it by computing
      the corresponding hash algorithm output over the entire key value,
      and treat the resulting output value as your HMAC key.  Note that
      this will always result in a key that is less than the block size
      in length, and this key value will therefore require zero-padding
      (as described above) prior to use.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.3.%20%20Randomness%20and%20Key%20Strength"></a><a class="selflink" href="#section-2.1.3" name="section-2.1.3">2.1.3</a>.  Randomness and Key Strength</span>

   [<a id="ref-HMAC" name="ref-HMAC">HMAC</a>] discusses requirements for key material, including a
   requirement for strong randomness.  Therefore, a strong pseudo-random
   function MUST be used to generate the required key for use with HMAC-
   SHA-256+.  At the time of this writing there are no published weak
   keys for use with any HMAC-SHA-256+ algorithms.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.4.%20%20Key%20Distribution"></a><a class="selflink" href="#section-2.1.4" name="section-2.1.4">2.1.4</a>.  Key Distribution</span>

   [<a id="ref-ARCH" name="ref-ARCH">ARCH</a>] describes the general mechanism for obtaining keying material
   when multiple keys are required for a single SA (e.g., when an ESP SA
   requires a key for confidentiality and a key for authentication).  In
   order to provide data origin authentication and integrity
   verification, the key distribution mechanism must ensure that unique
   keys are allocated and that they are distributed only to the parties
   participating in the communication.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.5.%20%20Refreshing%20Keys"></a><a class="selflink" href="#section-2.1.5" name="section-2.1.5">2.1.5</a>.  Refreshing Keys</span>

   Currently, there are no practical attacks against the algorithms
   recommended here, and especially against the key sizes recommended
   here.  However, as noted in [<a href="#ref-HMAC" title='"HMAC: Keyed- Hashing for Message Authentication"'>HMAC</a>] "...periodic key refreshment is a
   fundamental security practice that helps against potential weaknesses
   of the function and keys, and limits the damage of an exposed key".




<span class="grey">Kelly &amp; Frankel             Standards Track                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


   Putting this into perspective, this specification requires 256, 384,
   or 512-bit keys produced by a strong PRF for use as a MAC.  A brute
   force attack on such keys would take longer to mount than the
   universe has been in existence.  On the other hand, weak keys (e.g.,
   dictionary words) would be dramatically less resistant to attack.  It
   is important to take these points, along with the specific threat
   model for your particular application and the current state of the
   art with respect to attacks on SHA-256, SHA-384, and SHA-512 into
   account when determining an appropriate upper bound for HMAC key
   lifetimes.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Padding"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Padding</span>

   The HMAC-SHA-256 algorithms operate on 512-bit blocks of data, while
   the HMAC-SHA-384 and HMAC-SHA-512 algorithms operate on 1024-bit
   blocks of data.  Padding requirements are specified in [<a href="#ref-SHA2-1" title="&quot;FIPS PUB 180-2 'Specifications for the Secure Hash Standard'&quot;">SHA2-1</a>] as
   part of the underlying SHA-256, SHA-384, and SHA-512 algorithms, so
   if you implement according to [<a href="#ref-SHA2-1" title="&quot;FIPS PUB 180-2 'Specifications for the Secure Hash Standard'&quot;">SHA2-1</a>], you do not need to add any
   additional padding as far as the HMAC-SHA-256+ algorithms specified
   here are concerned.  With regard to "implicit packet padding" as
   defined in [<a href="#ref-AH" title='"IP Authentication Header"'>AH</a>], no implicit packet padding is required.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20Truncation"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  Truncation</span>

   The HMAC-SHA-256+ algorithms each produce an nnn-bit value, where nnn
   corresponds to the output bit length of the algorithm, e.g., HMAC-
   SHA-nnn.  For use as an authenticator, this nnn-bit value can be
   truncated as described in [<a href="#ref-HMAC" title='"HMAC: Keyed- Hashing for Message Authentication"'>HMAC</a>].  When used as a data origin
   authentication and integrity verification algorithm in ESP, AH, IKE,
   or IKEv2, a truncated value using the first nnn/2 bits -- exactly
   half the algorithm output size -- MUST be supported.  No other
   authenticator value lengths are supported by this specification.

   Upon sending, the truncated value is stored within the authenticator
   field.  Upon receipt, the entire nnn-bit value is computed and the
   first nnn/2 bits are compared to the value stored in the
   authenticator field, with the value of 'nnn' depending on the
   negotiated algorithm.

   [<a id="ref-HMAC" name="ref-HMAC">HMAC</a>] discusses potential security benefits resulting from
   truncation of the output MAC value, and in general, encourages HMAC
   users to perform MAC truncation.  In the context of IPsec, a
   truncation length of nnn/2 bits is selected because it corresponds to
   the birthday attack bound for each of the HMAC-SHA-256+ algorithms,
   and it simultaneously serves to minimize the additional bits on the
   wire resulting from use of this facility.





<span class="grey">Kelly &amp; Frankel             Standards Track                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.4.%20%20Using%20HMAC-SHA-256%2B%20as%20PRFs%20in%20IKE%20and%20IKEv2"></a><a class="selflink" href="#section-2.4" name="section-2.4">2.4</a>.  Using HMAC-SHA-256+ as PRFs in IKE and IKEv2</span>

   The PRF-HMAC-SHA-256 algorithm is identical to HMAC-SHA-256-128,
   except that variable-length keys are permitted, and the truncation
   step is NOT performed.  Likewise, the implementations of PRF-HMAC-
   SHA-384 and PRF-HMAC-SHA-512 are identical to those of HMAC-SHA-384-
   192 and HMAC-SHA-512-256 respectively, except that again, variable-
   length keys are permitted, and truncation is NOT performed.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.5.%20%20Interactions%20with%20the%20ESP%2C%20IKE%2C%20or%20IKEv2%20Cipher%20Mechanisms"></a><a class="selflink" href="#section-2.5" name="section-2.5">2.5</a>.  Interactions with the ESP, IKE, or IKEv2 Cipher Mechanisms</span>

   As of this writing, there are no known issues that preclude the use
   of the HMAC-SHA-256+ algorithms with any specific cipher algorithm.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.6.%20%20HMAC-SHA-256%2B%20Parameter%20Summary"></a><a class="selflink" href="#section-2.6" name="section-2.6">2.6</a>.  HMAC-SHA-256+ Parameter Summary</span>

   The following table serves to summarize the various quantities
   associated with the HMAC-SHA-256+ algorithms.  In this table, "var"
   stands for "variable".

   +------------------+--------+--------+--------+--------+------------+
   |    Algorithm     | Block  | Output | Trunc. |  Key   | Algorithm  |
   |       ID         |  Size  | Length | Length | Length |   Type     |
   +==================+========+========+========+========+============+
   | HMAC-SHA-256-128 |   512  |   256  |  128   |  256   | auth/integ |
   +------------------+--------+--------+--------+--------+------------+
   | HMAC-SHA-384-192 |  1024  |   384  |  192   |  384   | auth/integ |
   +------------------+--------+--------+--------+--------+------------+
   | HMAC-SHA-512-256 |  1024  |   512  |  256   |  512   | auth/integ |
   +------------------+--------+--------+--------+--------+------------+
   | PRF-HMAC-SHA-256 |   512  |   256  | (none) |  var   |     PRF    |
   +------------------+--------+--------+--------+--------+------------+
   | PRF-HMAC-SHA-384 |  1024  |   384  | (none) |  var   |     PRF    |
   +------------------+--------+--------+--------+--------+------------+
   | PRF-HMAC-SHA-512 |  1024  |   512  | (none) |  var   |     PRF    |
   +------------------+--------+--------+--------+--------+------------+


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.7.%20%20Test%20Vectors"></a><a class="selflink" href="#section-2.7" name="section-2.7">2.7</a>.  Test Vectors</span>

   The following test cases include the key, the data, and the resulting
   authenticator, and/or PRF values for each algorithm.  The values of
   keys and data are either ASCII character strings (surrounded by
   double quotes) or hexadecimal numbers.  If a value is an ASCII
   character string, then the HMAC computation for the corresponding
   test case DOES NOT include the trailing null character ('\0') of the
   string.  The computed HMAC values are all hexadecimal numbers.




<span class="grey">Kelly &amp; Frankel             Standards Track                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.7.1.%20%20PRF%20Test%20Vectors"></a><a class="selflink" href="#section-2.7.1" name="section-2.7.1">2.7.1</a>.  PRF Test Vectors</span>

   These test cases were borrowed from <a href="rfc4231.html">RFC 4231</a> [<a href="#ref-HMAC-TEST" title='"Identifiers and Test Vectors for HMAC-SHA- 224, HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512"'>HMAC-TEST</a>].  For
   reference implementations of the underlying hash algorithms, see
   [SHA256+].  Note that for testing purposes, PRF output is considered
   to be simply the untruncated algorithm output.

   Test Case PRF-1:
   Key =          0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
                  0b0b0b0b                          (20 bytes)

   Data =         4869205468657265                  ("Hi There")

   PRF-HMAC-SHA-256 = b0344c61d8db38535ca8afceaf0bf12b
                      881dc200c9833da726e9376c2e32cff7

   PRF-HMAC-SHA-384 = afd03944d84895626b0825f4ab46907f
                      15f9dadbe4101ec682aa034c7cebc59c
                      faea9ea9076ede7f4af152e8b2fa9cb6

   PRF-HMAC-SHA-512 = 87aa7cdea5ef619d4ff0b4241a1d6cb0
                      2379f4e2ce4ec2787ad0b30545e17cde
                      daa833b7d6b8a702038b274eaea3f4e4
                      be9d914eeb61f1702e696c203a126854


   Test Case PRF-2:
   Key =          4a656665                          ("Jefe")

   Data =         7768617420646f2079612077616e7420  ("what do ya want ")
                  666f72206e6f7468696e673f          ("for nothing?")

   PRF-HMAC-SHA-256 = 5bdcc146bf60754e6a042426089575c7
                      5a003f089d2739839dec58b964ec3843

   PRF-HMAC-SHA-384 = af45d2e376484031617f78d2b58a6b1b
                      9c7ef464f5a01b47e42ec3736322445e
                      8e2240ca5e69e2c78b3239ecfab21649

   PRF-HMAC-SHA-512 = 164b7a7bfcf819e2e395fbe73b56e0a3
                      87bd64222e831fd610270cd7ea250554
                      9758bf75c05a994a6d034f65f8f0e6fd
                      caeab1a34d4a6b4b636e070a38bce737








<span class="grey">Kelly &amp; Frankel             Standards Track                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


   Test Case PRF-3:
   Key            aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaa                          (20 bytes)

   Data =         dddddddddddddddddddddddddddddddd
                  dddddddddddddddddddddddddddddddd
                  dddddddddddddddddddddddddddddddd
                  dddd                              (50 bytes)

   PRF-HMAC-SHA-256 = 773ea91e36800e46854db8ebd09181a7
                      2959098b3ef8c122d9635514ced565fe

   PRF-HMAC-SHA-384 = 88062608d3e6ad8a0aa2ace014c8a86f
                      0aa635d947ac9febe83ef4e55966144b
                      2a5ab39dc13814b94e3ab6e101a34f27

   PRF-HMAC-SHA-512 = fa73b0089d56a284efb0f0756c890be9
                      b1b5dbdd8ee81a3655f83e33b2279d39
                      bf3e848279a722c806b485a47e67c807
                      b946a337bee8942674278859e13292fb


   Test Case PRF-4:
   Key =          0102030405060708090a0b0c0d0e0f10
                  111213141516171819                (25 bytes)

   Data =         cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd
                  cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd
                  cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd
                  cdcd                              (50 bytes)

   PRF-HMAC-SHA-256 = 82558a389a443c0ea4cc819899f2083a
                      85f0faa3e578f8077a2e3ff46729665b

   PRF-HMAC-SHA-384 = 3e8a69b7783c25851933ab6290af6ca7
                      7a9981480850009cc5577c6e1f573b4e
                      6801dd23c4a7d679ccf8a386c674cffb

   PRF-HMAC-SHA-512 = b0ba465637458c6990e5a8c5f61d4af7
                      e576d97ff94b872de76f8050361ee3db
                      a91ca5c11aa25eb4d679275cc5788063
                      a5f19741120c4f2de2adebeb10a298dd









<span class="grey">Kelly &amp; Frankel             Standards Track                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


   Test Case PRF-5:
   Key =          aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaa                            (131 bytes)

   Data =         54657374205573696e67204c61726765  ("Test Using Large")
                  72205468616e20426c6f636b2d53697a  ("r Than Block-Siz")
                  65204b6579202d2048617368204b6579  ("e Key - Hash Key")
                  204669727374                      (" First")


   PRF-HMAC-SHA-256 = 60e431591ee0b67f0d8a26aacbf5b77f
                      8e0bc6213728c5140546040f0ee37f54

   PRF-HMAC-SHA-384 = 4ece084485813e9088d2c63a041bc5b4
                      4f9ef1012a2b588f3cd11f05033ac4c6
                      0c2ef6ab4030fe8296248df163f44952

   PRF-HMAC-SHA-512 = 80b24263c7c1a3ebb71493c1dd7be8b4
                      9b46d1f41b4aeec1121b013783f8f352
                      6b56d037e05f2598bd0fd2215d6a1e52
                      95e64f73f63f0aec8b915a985d786598























<span class="grey">Kelly &amp; Frankel             Standards Track                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


   Test Case PRF-6:

   Key =          aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaa                            (131 bytes)

   Data =         54686973206973206120746573742075  ("This is a test u")
                  73696e672061206c6172676572207468  ("sing a larger th")
                  616e20626c6f636b2d73697a65206b65  ("an block-size ke")
                  7920616e642061206c61726765722074  ("y and a larger t")
                  68616e20626c6f636b2d73697a652064  ("han block-size d")
                  6174612e20546865206b6579206e6565  ("ata. The key nee")
                  647320746f2062652068617368656420  ("ds to be hashed ")
                  6265666f7265206265696e6720757365  ("before being use")
                  642062792074686520484d414320616c  ("d by the HMAC al")
                  676f726974686d2e                  ("gorithm.")

   PRF-HMAC-SHA-256 = 9b09ffa71b942fcb27635fbcd5b0e944
                      bfdc63644f0713938a7f51535c3a35e2

   PRF-HMAC-SHA-384 = 6617178e941f020d351e2f254e8fd32c
                      602420feb0b8fb9adccebb82461e99c5
                      a678cc31e799176d3860e6110c46523e

   PRF-HMAC-SHA-512 = e37b6a775dc87dbaa4dfa9f96e5e3ffd
                      debd71f8867289865df5a32d20cdc944
                      b6022cac3c4982b10d5eeb55c3e4de15
                      134676fb6de0446065c97440fa8c6a58


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.7.2.%20%20Authenticator%20Test%20Vectors"></a><a class="selflink" href="#section-2.7.2" name="section-2.7.2">2.7.2</a>.  Authenticator Test Vectors</span>

   The following sections are test cases for HMAC-SHA256-128, HMAC-
   SHA384-192, and HMAC-SHA512-256.  PRF outputs are also included for
   convenience.  These test cases were generated using the SHA256+
   reference code provided in [SHA256+].









<span class="grey">Kelly &amp; Frankel             Standards Track                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/2.7.2.1.%20%20SHA256%20Authentication%20Test%20Vectors"></a><a class="selflink" href="#section-2.7.2.1" name="section-2.7.2.1">2.7.2.1</a>.  SHA256 Authentication Test Vectors</span>

   Test Case AUTH256-1:
   Key =          0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
                  0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b  (32 bytes)

   Data =         4869205468657265                  ("Hi There")

   PRF-HMAC-SHA-256 = 198a607eb44bfbc69903a0f1cf2bbdc5
                      ba0aa3f3d9ae3c1c7a3b1696a0b68cf7

   HMAC-SHA-256-128 = 198a607eb44bfbc69903a0f1cf2bbdc5



   Test Case AUTH256-2:
   Key =          4a6566654a6566654a6566654a656665  ("JefeJefeJefeJefe")
                  4a6566654a6566654a6566654a656665  ("JefeJefeJefeJefe")

   Data =         7768617420646f2079612077616e7420  ("what do ya want ")
                  666f72206e6f7468696e673f          ("for nothing?")

   PRF-HMAC-SHA-256 = 167f928588c5cc2eef8e3093caa0e87c
                      9ff566a14794aa61648d81621a2a40c6

   HMAC-SHA-256-128 = 167f928588c5cc2eef8e3093caa0e87c



   Test Case AUTH256-3:
   Key =          aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa  (32 bytes)

   Data =         dddddddddddddddddddddddddddddddd
                  dddddddddddddddddddddddddddddddd
                  dddddddddddddddddddddddddddddddd
                  dddd                              (50 bytes)

   PRF-HMAC-SHA-256 = cdcb1220d1ecccea91e53aba3092f962
                      e549fe6ce9ed7fdc43191fbde45c30b0

   HMAC-SHA-256-128 = cdcb1220d1ecccea91e53aba3092f962









<span class="grey">Kelly &amp; Frankel             Standards Track                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


   Test Case AUTH256-4:
   Key =          0102030405060708090a0b0c0d0e0f10
                  1112131415161718191a1b1c1d1e1f20  (32 bytes)

   Data =         cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd
                  cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd
                  cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd
                  cdcd                              (50 bytes)

   PRF-HMAC-SHA-256 = 372efcf9b40b35c2115b1346903d2ef4
                      2fced46f0846e7257bb156d3d7b30d3f

   HMAC-SHA-256-128 = 372efcf9b40b35c2115b1346903d2ef4


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/2.7.2.2.%20%20SHA384%20Authentication%20Test%20Vectors"></a><a class="selflink" href="#section-2.7.2.2" name="section-2.7.2.2">2.7.2.2</a>.  SHA384 Authentication Test Vectors</span>

   Test Case AUTH384-1:
   Key =          0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
                  0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
                  0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b  (48 bytes)

   Data =         4869205468657265                  ("Hi There")

   PRF-HMAC-SHA-384 = b6a8d5636f5c6a7224f9977dcf7ee6c7
                      fb6d0c48cbdee9737a959796489bddbc
                      4c5df61d5b3297b4fb68dab9f1b582c2

   HMAC-SHA-384-128 = b6a8d5636f5c6a7224f9977dcf7ee6c7
                      fb6d0c48cbdee973


   Test Case AUTH384-2:
   Key =          4a6566654a6566654a6566654a656665  ("JefeJefeJefeJefe")
                  4a6566654a6566654a6566654a656665  ("JefeJefeJefeJefe")
                  4a6566654a6566654a6566654a656665  ("JefeJefeJefeJefe")

   Data =         7768617420646f2079612077616e7420  ("what do ya want ")
                  666f72206e6f7468696e673f          ("for nothing?")

   PRF-HMAC-SHA-384 = 2c7353974f1842fd66d53c452ca42122
                      b28c0b594cfb184da86a368e9b8e16f5
                      349524ca4e82400cbde0686d403371c9

   HMAC-SHA-384-192 = 2c7353974f1842fd66d53c452ca42122
                      b28c0b594cfb184d





<span class="grey">Kelly &amp; Frankel             Standards Track                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


   Test Case AUTH384-3:
   Key =          aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa  (48 bytes)

   Data =         dddddddddddddddddddddddddddddddd
                  dddddddddddddddddddddddddddddddd
                  dddddddddddddddddddddddddddddddd
                  dddd                              (50 bytes)

   PRF-HMAC-SHA-384 = 809f439be00274321d4a538652164b53
                      554a508184a0c3160353e3428597003d
                      35914a18770f9443987054944b7c4b4a

   HMAC-SHA-384-192 = 809f439be00274321d4a538652164b53
                      554a508184a0c316


   Test Case AUTH384-4:
   Key =          0102030405060708090a0b0c0d0e0f10
                  1112131415161718191a1b1c1d1e1f20
                  0a0b0c0d0e0f10111213141516171819  (48 bytes)

   Data =         cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd
                  cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd
                  cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd
                  cdcd                              (50 bytes)

   PRF-HMAC-SHA-384 = 5b540085c6e6358096532b2493609ed1
                      cb298f774f87bb5c2ebf182c83cc7428
                      707fb92eab2536a5812258228bc96687

   HMAC-SHA-384-192 = 5b540085c6e6358096532b2493609ed1
                      cb298f774f87bb5c

















<span class="grey">Kelly &amp; Frankel             Standards Track                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/2.7.2.3.%20%20SHA512%20Authentication%20Test%20Vectors"></a><a class="selflink" href="#section-2.7.2.3" name="section-2.7.2.3">2.7.2.3</a>.  SHA512 Authentication Test Vectors</span>

   Test Case AUTH512-1:
   Key =          0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
                  0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
                  0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
                  0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b  (64 bytes)

   Data =         4869205468657265                  ("Hi There")

   PRF-HMAC-SHA-512 = 637edc6e01dce7e6742a99451aae82df
                      23da3e92439e590e43e761b33e910fb8
                      ac2878ebd5803f6f0b61dbce5e251ff8
                      789a4722c1be65aea45fd464e89f8f5b

   HMAC-SHA-512-256 = 637edc6e01dce7e6742a99451aae82df
                      23da3e92439e590e43e761b33e910fb8


   Test Case AUTH512-2:
   Key =          4a6566654a6566654a6566654a656665  ("JefeJefeJefeJefe")
                  4a6566654a6566654a6566654a656665  ("JefeJefeJefeJefe")
                  4a6566654a6566654a6566654a656665  ("JefeJefeJefeJefe")
                  4a6566654a6566654a6566654a656665  ("JefeJefeJefeJefe")

   Data =         7768617420646f2079612077616e7420  ("what do ya want ")
                  666f72206e6f7468696e673f          ("for nothing?")

   PRF-HMAC-SHA-512 = cb370917ae8a7ce28cfd1d8f4705d614
                      1c173b2a9362c15df235dfb251b15454
                      6aa334ae9fb9afc2184932d8695e397b
                      fa0ffb93466cfcceaae38c833b7dba38

   HMAC-SHA-512-256 = cb370917ae8a7ce28cfd1d8f4705d614
                      1c173b2a9362c15df235dfb251b15454
















<span class="grey">Kelly &amp; Frankel             Standards Track                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


   Test Case AUTH512-3:
   Key =          aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa  (64 bytes)

   Data =         dddddddddddddddddddddddddddddddd
                  dddddddddddddddddddddddddddddddd
                  dddddddddddddddddddddddddddddddd
                  dddd                              (50 bytes)

   PRF-HMAC-SHA-512 = 2ee7acd783624ca9398710f3ee05ae41
                      b9f9b0510c87e49e586cc9bf961733d8
                      623c7b55cebefccf02d5581acc1c9d5f
                      b1ff68a1de45509fbe4da9a433922655

   HMAC-SHA-512-256 = 2ee7acd783624ca9398710f3ee05ae41
                      b9f9b0510c87e49e586cc9bf961733d8


   Test Case AUTH512-4:
   Key =          0a0b0c0d0e0f10111213141516171819
                  0102030405060708090a0b0c0d0e0f10
                  1112131415161718191a1b1c1d1e1f20
                  2122232425262728292a2b2c2d2e2f30
                  3132333435363738393a3b3c3d3e3f40  (64 bytes)

   Data =         cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd
                  cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd
                  cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd
                  cdcd                              (50 bytes)

   PRF-HMAC-SHA-512 = 5e6688e5a3daec826ca32eaea224eff5
                      e700628947470e13ad01302561bab108
                      b8c48cbc6b807dcfbd850521a685babc
                      7eae4a2a2e660dc0e86b931d65503fd2

   HMAC-SHA-512-256 = 5e6688e5a3daec826ca32eaea224eff5
                      e700628947470e13ad01302561bab108












<span class="grey">Kelly &amp; Frankel             Standards Track                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Security%20Considerations"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Security Considerations</span>

   In a general sense, the security provided by the HMAC-SHA-256+
   algorithms is based both upon the strength of the underlying hash
   algorithm, and upon the additional strength derived from the HMAC
   construct.  At the time of this writing, there are no practical
   cryptographic attacks against SHA-256, SHA-384, SHA-512, or HMAC.
   However, as with any cryptographic algorithm, an important component
   of these algorithms' strength lies in the correctness of the
   algorithm implementation, the security of the key management
   mechanism, the strength of the associated secret key, and upon the
   correctness of the implementation in all of the participating
   systems.  This specification contains test vectors to assist in
   verifying the correctness of the algorithm implementation, but these
   in no way verify the correctness (or security) of the surrounding
   security infrastructure.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20HMAC%20Key%20Length%20vs%20Truncation%20Length"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  HMAC Key Length vs Truncation Length</span>

   There are important differences between the security levels afforded
   by HMAC-SHA1-96 [<a href="#ref-HMAC-SHA1" title='"The Use of HMAC-SHA-1-96 within ESP and AH"'>HMAC-SHA1</a>] and the HMAC-SHA-256+ algorithms, but
   there are also considerations that are somewhat counter-intuitive.
   There are two different axes along which we gauge the security of
   these algorithms: HMAC output length and HMAC key length.  If we
   assume the HMAC key is a well-guarded secret that can only be
   determined through offline attacks on observed values, and that its
   length is less than or equal to the output length of the underlying
   hash algorithm, then the key's strength is directly proportional to
   its length.  And if we assume an adversary has no knowledge of the
   HMAC key, then the probability of guessing a correct MAC value for
   any given packet is directly proportional to the HMAC output length.

   This specification defines truncation to output lengths of either 128
   192, or 256 bits.  It is important to note that at this time, it is
   not clear that HMAC-SHA-256 with a truncation length of 128 bits is
   any more secure than HMAC-SHA1 with the same truncation length,
   assuming the adversary has no knowledge of the HMAC key.  This is
   because in such cases, the adversary must predict only those bits
   that remain after truncation.  Since in both cases that output length
   is the same (128 bits), the adversary's odds of correctly guessing
   the value are also the same in either case: 1 in 2^128.  Again, if we
   assume the HMAC key remains unknown to the attacker, then only a bias
   in one of the algorithms would distinguish one from the other.
   Currently, no such bias is known to exist in either HMAC-SHA1 or
   HMAC-SHA-256+.

   If, on the other hand, the attacker is focused on guessing the HMAC
   key, and we assume that the hash algorithms are indistinguishable



<span class="grey">Kelly &amp; Frankel             Standards Track                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


   when viewed as PRF's, then the HMAC key length provides a direct
   measure of the underlying security: the longer the key, the harder it
   is to guess.  This means that with respect to passive attacks on the
   HMAC key, size matters - and the HMAC-SHA-256+ algorithms provide
   more security in this regard than HMAC-SHA1-96.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  IANA Considerations</span>

   This document does not specify the conventions for using SHA256+ for
   IKE Phase 1 negotiations, except to note that IANA has made the
   following IKE hash algorithm attribute assignments:

   SHA2-256:  4

   SHA2-384:  5

   SHA2-512:  6

   For IKE Phase 2 negotiations, IANA has assigned the following
   authentication algorithm identifiers:

   HMAC-SHA2-256:  5

   HMAC-SHA2-384:  6

   HMAC-SHA2-512:  7

   For use of HMAC-SHA-256+ as a PRF in IKEv2, IANA has assigned the
   following IKEv2 Pseudo-random function (type 2) transform
   identifiers:

   PRF_HMAC_SHA2_256  5

   PRF_HMAC_SHA2_384  6

   PRF_HMAC_SHA2_512  7

   For the use of HMAC-SHA-256+ algorithms for data origin
   authentication and integrity verification in IKEv2, ESP, or AH, IANA
   has assigned the following IKEv2 integrity (type 3) transform
   identifiers:

   AUTH_HMAC_SHA2_256_128  12

   AUTH_HMAC_SHA2_384_192  13

   AUTH_HMAC_SHA2_512_256  14




<span class="grey">Kelly &amp; Frankel             Standards Track                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Acknowledgements"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Acknowledgements</span>

   Portions of this text were unabashedly borrowed from [<a href="#ref-HMAC-SHA1" title='"The Use of HMAC-SHA-1-96 within ESP and AH"'>HMAC-SHA1</a>] and
   [<a href="#ref-HMAC-TEST" title='"Identifiers and Test Vectors for HMAC-SHA- 224, HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512"'>HMAC-TEST</a>].  Thanks to Hugo Krawczyk for comments and
   recommendations on early revisions of this document, and thanks also
   to Russ Housley and Steve Bellovin for various security-related
   comments and recommendations.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20References"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Normative%20References"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Normative References</span>

   [<a id="ref-AH" name="ref-AH">AH</a>]         Kent, S., "IP Authentication Header", <a href="rfc4302.html">RFC 4302</a>,
                December 2005.

   [<a id="ref-ARCH" name="ref-ARCH">ARCH</a>]       Kent, S. and K. Seo, "Security Architecture for the
                Internet Protocol", <a href="rfc4301.html">RFC 4301</a>, December 2005.

   [<a id="ref-ESP" name="ref-ESP">ESP</a>]        Kent, S., "IP Encapsulating Security Payload (ESP)",
                <a href="rfc4303.html">RFC 4303</a>, December 2005.

   [<a id="ref-HMAC" name="ref-HMAC">HMAC</a>]       Krawczyk, H., Bellare, M., and R. Canetti, "HMAC: Keyed-
                Hashing for Message Authentication", <a href="rfc2104.html">RFC 2104</a>,
                February 1997.

   [<a id="ref-HMAC-SHA1" name="ref-HMAC-SHA1">HMAC-SHA1</a>]  Madsen, C. and R. Glenn, "The Use of HMAC-SHA-1-96
                within ESP and AH", <a href="rfc2404.html">RFC 2404</a>, November 1998.

   [<a id="ref-HMAC-TEST" name="ref-HMAC-TEST">HMAC-TEST</a>]  Nystrom, M., "Identifiers and Test Vectors for HMAC-SHA-
                224, HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512",
                <a href="rfc4231.html">RFC 4231</a>, December 2005.

   [<a id="ref-IKE" name="ref-IKE">IKE</a>]        Harkins, D. and D. Carrel, "The Internet Key Exchange
                (IKE)", <a href="rfc2409.html">RFC 2409</a>, November 1998.

   [<a id="ref-IKEv2" name="ref-IKEv2">IKEv2</a>]      Kaufman, C., "Internet Key Exchange (IKEv2) Protocol",
                <a href="rfc4306.html">RFC 4306</a>, December 2005.

   [<a id="ref-SHA2-1" name="ref-SHA2-1">SHA2-1</a>]     NIST, "FIPS PUB 180-2 'Specifications for the Secure
                Hash Standard'", 2004 FEB, &lt;<a href="http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf">http://csrc.nist.gov/</a>
                <a href="http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf">publications/fips/fips180-2/</a>
                <a href="http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf">fips180-2withchangenotice.pdf</a>&gt;.

   [SHA256+]    Eastlake, D. and T. Hansen, "US Secure Hash Algorithms
                (SHA and HMAC-SHA)", <a href="rfc4634.html">RFC 4634</a>, July 2006.






<span class="grey">Kelly &amp; Frankel             Standards Track                    [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Informative%20References"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Informative References</span>

   [<a id="ref-SHA2-2" name="ref-SHA2-2">SHA2-2</a>]     NIST, "Descriptions of SHA-256, SHA-384, and SHA-512",
                2001 MAY,
                &lt;<a href="http://csrc.nist.gov/cryptval/shs/sha256-384-512.pdf">http://csrc.nist.gov/cryptval/shs/sha256-384-512.pdf</a>&gt;.

Authors' Addresses

   Scott G. Kelly
   Aruba Networks
   1322 Crossman Ave
   Sunnyvale, CA  94089
   US

   EMail: scott@hyperthought.com


   Sheila Frankel
   NIST
   Bldg. 222 Room B264
   Gaithersburg, MD  20899
   US

   EMail: sheila.frankel@nist.gov



























<span class="grey">Kelly &amp; Frankel             Standards Track                    [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc4868.html">RFC 4868</a>        HMAC-SHA256, SHA384, and SHA512 in IPsec        May 2007</span>


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.







Kelly &amp; Frankel             Standards Track                    [Page 21]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc4868 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:39 GMT --></html>