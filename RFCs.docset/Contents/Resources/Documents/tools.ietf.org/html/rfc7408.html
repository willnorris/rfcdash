<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7408 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Aug 2018 14:01:06 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.127" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-haleplidis-forces-model-extension" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:7408" name="DC.Identifier"/>
<meta content="November, 2014" name="DC.Date.Issued"/>
<meta content="Evangelos Haleplidis &lt;ehalep@ece.upatras.gr&gt;" name="DC.Creator"/>
<meta content="This memo extends the Forwarding and Control Element Separation
(ForCES) model defined in RFC 5812 and updates that RFC to allow
complex data types for metadata, optional default values for data
types, and optional access types for structures. It also fixes an
issue with Logical Functional Block (LFB) inheritance and introduces
two new features: a new event condition called eventBecomesEqualTo and
LFB properties. The changes introduced in this memo do not alter the
protocol and retain backward compatibility with older LFB models." name="DC.Description.Abstract"/>
<meta content="Forwarding and Control Element Separation (ForCES) Model Extension" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7408 - Forwarding and Control Element Separation (ForCES) Model Extension</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7408.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7408" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-forces-model-extension" title="draft-ietf-forces-model-extension">draft-ietf-forc...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7408" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7408" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7408" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                     E. Haleplidis
Request for Comments: 7408                          University of Patras
Updates: <a href="rfc5812.html">5812</a>                                              November 2014
Category: Standards Track
ISSN: 2070-1721


   <span class="h1">Forwarding and Control Element Separation (ForCES) Model Extension</span>

Abstract

   This memo extends the Forwarding and Control Element Separation
   (ForCES) model defined in <a href="rfc5812.html">RFC 5812</a> and updates that RFC to allow
   complex data types for metadata, optional default values for data
   types, and optional access types for structures.  It also fixes an
   issue with Logical Functional Block (LFB) inheritance and introduces
   two new features: a new event condition called eventBecomesEqualTo
   and LFB properties.  The changes introduced in this memo do not alter
   the protocol and retain backward compatibility with older LFB models.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7408">http://www.rfc-editor.org/info/rfc7408</a>.

Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



<span class="grey">Haleplidis                   Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
      <a href="#section-1.1">1.1</a>. Requirements Language ......................................<a href="#page-3">3</a>
      <a href="#section-1.2">1.2</a>. Terminology ................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. ForCES Model Extensions .........................................<a href="#page-3">3</a>
      <a href="#section-2.1">2.1</a>. Complex Data Types for Metadata ............................<a href="#page-3">3</a>
      <a href="#section-2.2">2.2</a>. Optional Default Values for Data Types .....................<a href="#page-5">5</a>
      <a href="#section-2.3">2.3</a>. Optional Access Types for Structs ..........................<a href="#page-8">8</a>
      <a href="#section-2.4">2.4</a>. New Event Condition: eventBecomesEqualTo ..................<a href="#page-11">11</a>
      <a href="#section-2.5">2.5</a>. LFB Properties ............................................<a href="#page-12">12</a>
      <a href="#section-2.6">2.6</a>. LFB Class Inheritance .....................................<a href="#page-14">14</a>
      <a href="#section-2.7">2.7</a>. Enhancing XML Validation ..................................<a href="#page-15">15</a>
   <a href="#section-3">3</a>. XML Extension Schema for LFB Class Library Documents ...........<a href="#page-15">15</a>
   <a href="#section-4">4</a>. IANA Considerations ............................................<a href="#page-29">29</a>
   <a href="#section-5">5</a>. Security Considerations ........................................<a href="#page-29">29</a>
   <a href="#section-6">6</a>. References .....................................................<a href="#page-30">30</a>
      <a href="#section-6.1">6.1</a>. Normative References ......................................<a href="#page-30">30</a>
      <a href="#section-6.2">6.2</a>. Informative References ....................................<a href="#page-30">30</a>
   Acknowledgements ..................................................<a href="#page-31">31</a>
   Author's Address ..................................................<a href="#page-31">31</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The ForCES model [<a href="rfc5812.html" title='"Forwarding and Control Element Separation (ForCES) Forwarding Element Model"'>RFC5812</a>] presents a formal way to define Forwarding
   Element (FE) Logical Functional Blocks (LFBs) using the eXtensible
   Markup Language (XML).  [<a href="rfc5812.html" title='"Forwarding and Control Element Separation (ForCES) Forwarding Element Model"'>RFC5812</a>] was published several years before
   this document, and experience with its use has demonstrated the need
   to add new modeling concepts and change existing ones.

   Specifically, this document updates the ForCES model [<a href="rfc5812.html" title='"Forwarding and Control Element Separation (ForCES) Forwarding Element Model"'>RFC5812</a>] to
   allow complex data types for metadata (<a href="#section-2.1">Section 2.1</a>), optional default
   values for data types (<a href="#section-2.2">Section 2.2</a>), and optional access types for
   structures (<a href="#section-2.3">Section 2.3</a>).  It also fixes an issue with LFB class
   inheritance (<a href="#section-2.6">Section 2.6</a>).  Additionally, the document introduces two
   new features: a new event condition named eventBecomesEqualTo
   (<a href="#section-2.4">Section 2.4</a>) and LFB properties (<a href="#section-2.5">Section 2.5</a>).

   These extensions are an update to the ForCES model [<a href="rfc5812.html" title='"Forwarding and Control Element Separation (ForCES) Forwarding Element Model"'>RFC5812</a>] and do
   not require any changes to the ForCES protocol [<a href="rfc5810.html" title='"Forwarding and Control Element Separation (ForCES) Protocol Specification"'>RFC5810</a>] as they are
   simply changes to the schema definition.  Additionally, backward
   compatibility is ensured as XML libraries produced with the earlier
   schema are still valid with the new one.  In order for XML libraries
   produced by the new schema to be compatible with existing ForCES
   implementations, the XML libraries MUST NOT include any of the
   features described in this document.





<span class="grey">Haleplidis                   Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


   Extensions to the schema and excerpts of the schema include the tags
   &lt;!-- Extension <a href="rfc7408.html">RFC 7408</a> --&gt; and &lt;!-- /Extension <a href="rfc7408.html">RFC 7408</a> --&gt;, which
   designate the beginning and ending of extension text specified by
   this document in respect to the schema in the original ForCES model
   [<a href="rfc5812.html" title='"Forwarding and Control Element Separation (ForCES) Forwarding Element Model"'>RFC5812</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Requirements%20Language"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Requirements Language</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Terminology"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Terminology</span>

   This document uses the terminology defined in the ForCES model
   [<a href="rfc5812.html" title='"Forwarding and Control Element Separation (ForCES) Forwarding Element Model"'>RFC5812</a>].  In particular, the reader is expected to be familiar with
   the following terms:

      FE Model

      LFB (Logical Functional Block) Class (or type)

      LFB Instance

      LFB Model

      Element

      Attribute

      LFB Metadata

      ForCES Component

      LFB Class Library

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20ForCES%20Model%20Extensions"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  ForCES Model Extensions</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Complex%20Data%20Types%20for%20Metadata"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Complex Data Types for Metadata</span>

   <a href="#section-4.6">Section 4.6</a> ("&lt;metadataDefs&gt; Element for Metadata Definitions") of
   the ForCES model [<a href="rfc5812.html" title='"Forwarding and Control Element Separation (ForCES) Forwarding Element Model"'>RFC5812</a>] limits the data type use in metadata to
   only atomic types.  Figure 1 shows the XML schema excerpt where only
   typeRef and atomic are allowed for a metadata definition.







<span class="grey">Haleplidis                   Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


     &lt;xsd:complexType name="metadataDefsType"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="metadataDef" maxOccurs="unbounded"&gt;
           &lt;xsd:complexType&gt;
             &lt;xsd:sequence&gt;
               &lt;xsd:element name="name" type="xsd:NMTOKEN"/&gt;
               &lt;xsd:element ref="synopsis"/&gt;
               &lt;xsd:element name="metadataID" type="xsd:integer"/&gt;
               &lt;xsd:element ref="description" minOccurs="0"/&gt;
               &lt;xsd:choice&gt;
                 &lt;xsd:element name="typeRef" type="typeRefNMTOKEN"/&gt;
                 &lt;xsd:element name="atomic" type="atomicType"/&gt;
               &lt;/xsd:choice&gt;
             &lt;/xsd:sequence&gt;
           &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;
       &lt;/xsd:sequence&gt;
     &lt;/xsd:complexType&gt;

        Figure 1: Initial metadataDefsType Definition in the Schema

   However, there are cases where complex metadata are used in the
   datapath: for example, two simple use cases are described in version
   1.1.0 (and subsequent versions) of the OpenFlow Switch Specification
   [<a href="#ref-OpenFlowSpec1.1" title='"OpenFlow Switch Specification"'>OpenFlowSpec1.1</a>]:

   1.  The Action Set metadata is an array of actions descriptors, which
       traverses the processing pipeline along with the packet data.

   2.  When a packet is received from a controller, it may be
       accompanied by a list of actions, as metadata, to be performed on
       it prior to being sent on the processing pipeline.  This list of
       actions is also an array.

   With the extension shown in Figure 2, complex data types are also
   allowed, specifically structs and arrays as metadata.  The key
   declarations are required to check for validity of content keys in
   arrays and componentIDs in structs.













<span class="grey">Haleplidis                   Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


     &lt;xsd:complexType name="metadataDefsType"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="metadataDef" maxOccurs="unbounded"&gt;
           &lt;xsd:complexType&gt;
             &lt;xsd:sequence&gt;
               &lt;xsd:element name="name" type="xsd:NMTOKEN"/&gt;
               &lt;xsd:element ref="synopsis"/&gt;
               &lt;xsd:element name="metadataID" type="xsd:integer"/&gt;
               &lt;xsd:element ref="description" minOccurs="0"/&gt;
               &lt;xsd:choice&gt;
                 &lt;xsd:element name="typeRef" type="typeRefNMTOKEN"/&gt;
                 &lt;xsd:element name="atomic" type="atomicType"/&gt;
                 &lt;!-- Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
                 &lt;xsd:element name="array" type="arrayType"&gt;
                   &lt;xsd:key name="contentKeyID1"&gt;
                     &lt;xsd:selector xpath="lfb:contentKey"/&gt;
                     &lt;xsd:field xpath="@contentKeyID"/&gt;
                   &lt;/xsd:key&gt;
                 &lt;/xsd:element&gt;
                 &lt;xsd:element name="struct" type="structType"&gt;
                   &lt;xsd:key name="structComponentID1"&gt;
                     &lt;xsd:selector xpath="lfb:component"/&gt;
                     &lt;xsd:field xpath="@componentID"/&gt;
                   &lt;/xsd:key&gt;
                 &lt;/xsd:element&gt;
                 &lt;!-- /Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
               &lt;/xsd:choice&gt;
             &lt;/xsd:sequence&gt;
           &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;
       &lt;/xsd:sequence&gt;
     &lt;/xsd:complexType&gt;

          Figure 2: New metadataDefsType Definition in the Schema

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Optional%20Default%20Values%20for%20Data%20Types"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Optional Default Values for Data Types</span>

   In the original schema, default values can only be defined for data
   types defined inside LFB components and not inside structures or
   arrays.  Therefore, default values for data types that are constantly
   being reused, e.g., counters with default value of 0, have to be
   constantly respecified.  Additionally, data types inside complex data
   types cannot be defined with a default value, e.g., a counter inside
   a struct that has a default value of 0.

   This extension allows the option to add default values to data types.
   These data types can then be referenced as simple components or
   within complex data types such as structs.  A simple use case would



<span class="grey">Haleplidis                   Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


   be to have a struct component where one of the components is a
   counter with a default value of zero.  To achieve that, the counter
   must first be defined as a data type with the required default value
   and then referenced in the struct.  Default values MUST adhere the
   following formal restrictions:

   1.  Default values MUST be ignored if the data type is not an atomic
       or a base data type.

   2.  When a data type X with default value A is referenced from a data
       type Y with a default value B, the default value of the data type
       that references overrides the referenced default value, e.g., in
       this case, Y's default value will be B.

   3.  Default values of LFB components override any default value
       specified from the dataTypeDef definition.

   4.  Default values of data types referenced in capabilities or
       metadata MUST be ignored.

   This extension simply adds to the definition of dataTypeDefsType in
   the XML schema shown in Figure 3 to allow default values for
   dataTypeDefsType.  The new definition is shown in Figure 4.

     &lt;xsd:complexType name="dataTypeDefsType"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="dataTypeDef" maxOccurs="unbounded"&gt;
           &lt;xsd:complexType&gt;
             &lt;xsd:sequence&gt;
               &lt;xsd:element name="name" type="xsd:NMTOKEN"/&gt;
               &lt;xsd:element name="derivedFrom" type="xsd:NMTOKEN"
                  minOccurs="0"/&gt;
               &lt;xsd:element ref="synopsis"/&gt;
               &lt;xsd:element ref="description" minOccurs="0"/&gt;
               &lt;xsd:group ref="typeDeclarationGroup"/&gt;
             &lt;/xsd:sequence&gt;
           &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;
       &lt;/xsd:sequence&gt;
     &lt;/xsd:complexType&gt;

      Figure 3: Initial Excerpt of dataTypeDefsType Definition in the
                                  Schema








<span class="grey">Haleplidis                   Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


     &lt;xsd:complexType name="dataTypeDefsType"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="dataTypeDef" maxOccurs="unbounded"&gt;
           &lt;xsd:complexType&gt;
             &lt;xsd:sequence&gt;
               &lt;xsd:element name="name" type="xsd:NMTOKEN"/&gt;
               &lt;xsd:element name="derivedFrom" type="xsd:NMTOKEN"
                  minOccurs="0"/&gt;
               &lt;xsd:element ref="synopsis"/&gt;
               &lt;xsd:element ref="description" minOccurs="0"/&gt;
               &lt;xsd:group ref="typeDeclarationGroup"/&gt;
               &lt;!-- Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
               &lt;xsd:element name="defaultValue" type="xsd:token"
                  minOccurs="0"/&gt;
               &lt;!-- /Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
             &lt;/xsd:sequence&gt;
           &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;
       &lt;/xsd:sequence&gt;
     &lt;/xsd:complexType&gt;

    Figure 4: New Excerpt of dataTypeDefsType Definition in the Schema





























<span class="grey">Haleplidis                   Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


   Examples of using default values is depicted in Figure 5.

     &lt;dataTypeDef&gt;
       &lt;name&gt;ZeroCounter&lt;/name&gt;
       &lt;synopsis&gt;A counter with default 0&lt;/synopsis&gt;
       &lt;typeRef&gt;uint32&lt;/typeRef&gt;
       &lt;defaultValue&gt;0&lt;/defaultValue&gt;
     &lt;/dataTypeDef&gt;
     &lt;dataTypeDef&gt;
       &lt;name&gt;CounterValues&lt;/name&gt;
       &lt;synopsis&gt;Example default values in struct&lt;/synopsis&gt;
       &lt;struct&gt;
         &lt;component componentID="1"&gt;
           &lt;name&gt;GoodPacketCounter&lt;/name&gt;
           &lt;synopsis&gt;A counter for good packets&lt;/synopsis&gt;
           &lt;typeRef&gt;ZeroCounter&lt;/typeRef&gt;
         &lt;/component&gt;
         &lt;component componentID="2"&gt;
           &lt;name&gt;BadPacketCounter&lt;/name&gt;
           &lt;synopsis&gt;A counter for bad packets&lt;/synopsis&gt;
           &lt;typeRef&gt;ZeroCounter&lt;/typeRef&gt;
         &lt;/component&gt;
       &lt;/struct&gt;
     &lt;/dataTypeDef&gt;

               Figure 5: Example of Optional Default Values

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20Optional%20Access%20Types%20for%20Structs"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  Optional Access Types for Structs</span>

   In the original schema, the access type can only be defined on
   components of an LFB and not on components within structs or arrays.
   That means that when it is a struct data type, it is not possible to
   fine-tune access type per component within the struct.  A simple use
   case would be to have a read-write struct component where one of the
   components is a counter with an access type that could be read-reset
   or read-only, e.g., a read-reset or a read-only counter inside a
   struct.

   This extension allows the definition of the access type for a struct
   component either in the data type definitions or in the LFB component
   definitions.

   When optional access types for components within a struct are
   defined, the access types for these components MUST override the
   access type of the struct.  For example, if a struct has an access
   type of read-write but has a component that is a read-only counter,
   the counter's access type MUST be read-only.




<span class="grey">Haleplidis                   Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


   Per [<a href="rfc5812.html" title='"Forwarding and Control Element Separation (ForCES) Forwarding Element Model"'>RFC5812</a>], the access type for a component in a capability is
   always read-only.  If an access type is provided for a component in a
   capability, the access type MUST be ignored.  Similarly, if an access
   type is provided for a struct in a metadata, the access type MUST be
   ignored.

   This extension alters the definition of the struct in the XML schema
   from the initial definition shown in Figure 6 to the new shown in
   Figure 7.

     &lt;xsd:complexType name="structType"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="derivedFrom" type="typeRefNMTOKEN"
           minOccurs="0"/&gt;
         &lt;xsd:element name="component" maxOccurs="unbounded"&gt;
           &lt;xsd:complexType&gt;
             &lt;xsd:sequence&gt;
               &lt;xsd:element name="name" type="xsd:NMTOKEN"/&gt;
               &lt;xsd:element ref="synopsis"/&gt;
               &lt;xsd:element ref="description" minOccurs="0"/&gt;
               &lt;xsd:element name="optional" minOccurs="0"/&gt;
               &lt;xsd:group ref="typeDeclarationGroup"/&gt;
             &lt;/xsd:sequence&gt;
             &lt;xsd:attribute name="componentID" type="xsd:unsignedInt"
              use="required"/&gt;
           &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;
       &lt;/xsd:sequence&gt;
     &lt;/xsd:complexType&gt;

       Figure 6: Initial XML for the Struct Definition in the Schema




















<span class="grey">Haleplidis                   Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


     &lt;xsd:complexType name="structType"&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="derivedFrom" type="typeRefNMTOKEN"
           minOccurs="0"/&gt;
         &lt;xsd:element name="component" maxOccurs="unbounded"&gt;
           &lt;xsd:complexType&gt;
             &lt;xsd:sequence&gt;
               &lt;xsd:element name="name" type="xsd:NMTOKEN"/&gt;
               &lt;xsd:element ref="synopsis"/&gt;
               &lt;xsd:element ref="description" minOccurs="0"/&gt;
               &lt;xsd:element name="optional" minOccurs="0"/&gt;
               &lt;xsd:group ref="typeDeclarationGroup"/&gt;
             &lt;/xsd:sequence&gt;
             &lt;!-- Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
             &lt;xsd:attribute name="access" use="optional"
               default="read-write"&gt;
               &lt;xsd:simpleType&gt;
                 &lt;xsd:list itemType="accessModeType"/&gt;
               &lt;/xsd:simpleType&gt;
             &lt;/xsd:attribute&gt;
             &lt;!-- /Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
             &lt;xsd:attribute name="componentID" type="xsd:unsignedInt"
               use="required"/&gt;
           &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;
       &lt;/xsd:sequence&gt;
     &lt;/xsd:complexType&gt;

         Figure 7: New XML for the Struct Definition in the Schema






















<span class="grey">Haleplidis                   Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


   An example of using optional access types for structs is depicted in
   Figure 8.

      &lt;component componentID="1" access="read-write"&gt;
         &lt;name&gt;PacketFlows&lt;/name&gt;
         &lt;synopsis&gt;Packet Flows, match and counter&lt;/synopsis&gt;
         &lt;struct&gt;
          &lt;component componentID="1"&gt;
            &lt;name&gt;FlowMatch&lt;/name&gt;
            &lt;synopsis&gt;Flow Match&lt;/synopsis&gt;
            &lt;typeRef&gt;MatchType&lt;/typeRef&gt;
          &lt;/component&gt;
          &lt;component componentID="2" access="read-only"&gt;
            &lt;name&gt;MatchCounter&lt;/name&gt;
            &lt;synopsis&gt;Packets matching the flow match&lt;/synopsis&gt;
            &lt;typeRef&gt;ZeroCounter&lt;/typeRef&gt;
          &lt;/component&gt;
        &lt;/struct&gt;
      &lt;/component&gt;

           Figure 8: Example of Optional Access Types for Struct

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.4.%20%20New%20Event%20Condition%3A%20eventBecomesEqualTo"></a><a class="selflink" href="#section-2.4" name="section-2.4">2.4</a>.  New Event Condition: eventBecomesEqualTo</span>

   This extension adds one more event condition in the model schema,
   eventBecomesEqualTo.  eventBecomesEqualTo is different from
   eventGreaterThan and eventLessThan because the event is triggered
   when the value is exactly that of the eventBecomesEqualTo threshold.
   This event condition is particularly useful when there is a need to
   monitor one or more states of an LFB or the FE.  For example, in the
   Control Element High Availability (CEHA) document [<a href="rfc7121.html" title='"High Availability within a Forwarding and Control Element Separation (ForCES) Network Element"'>RFC7121</a>], it may
   be useful for the master CE to know which backup CEs have just become
   associated in order to connect to them and begin synchronizing the
   state of the FE.  The master CE could always poll for such
   information, but getting such an event will speed up the process, and
   the event may be useful in other cases as well for monitoring state.

   The event MUST be triggered only when the value of the targeted
   component becomes equal to the event condition value.
   Implementations MUST NOT generate subsequent events while the
   targeted component's value remains equal to the event condition's
   value.









<span class="grey">Haleplidis                   Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


   eventBecomesEqualTo is appended to the schema as shown in Figure 9.

     &lt;xsd:element name="eventBecomesEqualTo"
       substitutionGroup="eventCondition"/&gt;

       Figure 9: New Excerpt of eventBecomesEqualTo Event Condition
                         Definition in the Schema

   It can become useful for the CE to be notified when the state has
   changed once the eventBecomesEqualTo event has been triggered, e.g.,
   the CE may need to know when a backup CE has lost association.  Such
   an event can be generated either by defining a second event on the
   same component (namely, an eventChanged) or by simply reusing
   eventBecomesEqualTo and using event properties (in particular,
   eventHysteresis).  We append the following definition to the
   eventHysteresis defined in <a href="rfc5812.html#section-4.8.5.2">Section 4.8.5.2 of [RFC5812]</a>, with V being
   the hysteresis value:

   o  For an eventBecomesEqualTo condition, after the last notification,
      a new eventBecomesEqualTo notification MUST be generated only one
      time once the value has changed by +/- V.

   For example, using the value of 1 for V will, in effect, create a
   singular event that will notify the CE that the value has changed by
   at least 1.

   A developer of a CE should consider using count or time filtering to
   avoid being overrun by messages, e.g., in the case of rapid state
   changes.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.5.%20%20LFB%20Properties"></a><a class="selflink" href="#section-2.5" name="section-2.5">2.5</a>.  LFB Properties</span>

   The previous model definition specifies properties for components of
   LFBs.  Experience has shown that, at least for debug reasons, it
   would be useful to have statistics per LFB instance to monitor sent
   and received messages and errors in communication between a CE and
   FE.  These properties are read-only.

   In order to avoid ambiguity on protocol path semantics, this document
   specifies that the LFB componentID 0 specifically MUST refer to LFB
   properties and ID 0 MUST NOT be used for any component definition.
   This disallowance is backward compatible as no known LFB definition
   uses an LFB componentID 0.  Any command with a path starting from LFB
   componentID 0 refers to LFB properties.  Figures 10 and 11 illustrate
   the change in the XML schema that disallows usage of LFB componentID
   0:





<span class="grey">Haleplidis                   Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


      &lt;xsd:attribute name="componentID" type="xsd:unsignedInt"
       use="required"&gt;

                Figure 10: Initial XML for LFB componentIDs

      &lt;!-- Extension added restriction to componentID --&gt;
      &lt;xsd:attribute name="componentID" use="required"&gt;
        &lt;xsd:simpleType&gt;
          &lt;xsd:restriction base="xsd:unsignedInt"&gt;
            &lt;xsd:minExclusive value="0"/&gt;
          &lt;/xsd:restriction&gt;
        &lt;/xsd:simpleType&gt;
      &lt;/xsd:attribute&gt;
      &lt;!-- End of extension --&gt;

         Figure 11: New XML to Disallow Usage of LFB componentID 0

   The following data type definitions are to be used as properties for
   LFB instances.

      &lt;dataTypeDef&gt;
         &lt;name&gt;LFBProperties&lt;/name&gt;
         &lt;synopsis&gt;LFB Properties definition&lt;/synopsis&gt;
         &lt;struct&gt;
            &lt;component componentID="1"&gt;
               &lt;name&gt;PacketsSentToCE&lt;/name&gt;
               &lt;synopsis&gt;Packets sent to CE&lt;/synopsis&gt;
               &lt;typeRef&gt;uint32&lt;/typeRef&gt;
            &lt;/component&gt;
            &lt;component componentID="2"&gt;
               &lt;name&gt;SentErrorPacketsToCE&lt;/name&gt;
               &lt;synopsis&gt;Error Packets sent to CE&lt;/synopsis&gt;
               &lt;typeRef&gt;uint32&lt;/typeRef&gt;
            &lt;/component&gt;
            &lt;component componentID="3"&gt;
               &lt;name&gt;BytesSentToCE&lt;/name&gt;
               &lt;synopsis&gt;Bytes sent to CE&lt;/synopsis&gt;
               &lt;typeRef&gt;uint32&lt;/typeRef&gt;
            &lt;/component&gt;
            &lt;component componentID="4"&gt;
               &lt;name&gt;SentErrorBytesToCE&lt;/name&gt;
               &lt;synopsis&gt;Error Bytes sent to CE&lt;/synopsis&gt;
               &lt;typeRef&gt;uint32&lt;/typeRef&gt;
            &lt;/component&gt;
            &lt;component componentID="5"&gt;
               &lt;name&gt;PacketsReceivedFromCE&lt;/name&gt;
               &lt;synopsis&gt;Packets received from CE&lt;/synopsis&gt;
               &lt;typeRef&gt;uint32&lt;/typeRef&gt;



<span class="grey">Haleplidis                   Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


            &lt;/component&gt;
            &lt;component componentID="6"&gt;
               &lt;name&gt;ReceivedErrorPacketsFromCE&lt;/name&gt;
               &lt;synopsis&gt;Error Packets received from CE&lt;/synopsis&gt;
               &lt;typeRef&gt;uint32&lt;/typeRef&gt;
            &lt;/component&gt;
            &lt;component componentID="7"&gt;
               &lt;name&gt;BytesReceivedFromCE&lt;/name&gt;
               &lt;synopsis&gt;Bytes received from CE&lt;/synopsis&gt;
               &lt;typeRef&gt;uint32&lt;/typeRef&gt;
            &lt;/component&gt;
            &lt;component componentID="8"&gt;
               &lt;name&gt;ReceivedErrorBytesFromCE&lt;/name&gt;
               &lt;synopsis&gt;Error Bytes received from CE&lt;/synopsis&gt;
               &lt;typeRef&gt;uint32&lt;/typeRef&gt;
            &lt;/component&gt;
         &lt;/struct&gt;
      &lt;/dataTypeDef&gt;

                  Figure 12: Properties for LFB Instances

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.6.%20%20LFB%20Class%20Inheritance"></a><a class="selflink" href="#section-2.6" name="section-2.6">2.6</a>.  LFB Class Inheritance</span>

   The ForCES model [<a href="rfc5812.html" title='"Forwarding and Control Element Separation (ForCES) Forwarding Element Model"'>RFC5812</a>] allows inheritance for LFB classes.
   However, the XML schema defines only the LFB class from which an LFB
   class inherits.  Recent implementations have identified an issue
   where ambiguity rises when different versions of the parent LFB class
   exist.  This document augments the derivedFrom part of the LFB class
   definition with an optional version attribute when the derivedFrom
   field is used.

   Having the version attribute as optional was a decision based on the
   need to maintain backward compatibility with the XML schema defined
   in [<a href="rfc5812.html" title='"Forwarding and Control Element Separation (ForCES) Forwarding Element Model"'>RFC5812</a>].  However, if the version is omitted, then derivedFrom
   will always specify the first version of the parent LFB class, which
   usually is version 1.0.

   This extension alters the definition of derivedFrom in the XML schema
   from the initial definition shown in Figure 13 to the new shown in
   Figure 14.

      &lt;xsd:element name="derivedFrom" minOccurs="0"/&gt;

             Figure 13: Initial XML for LFB Class Inheritance







<span class="grey">Haleplidis                   Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


      &lt;xsd:element name="derivedFrom" minOccurs="0"&gt;
        &lt;xsd:complexType&gt;
          &lt;xsd:simpleContent&gt;
            &lt;xsd:extension base="xsd:NMTOKEN"&gt;
              &lt;xsd:attribute name="version"
                type="versionType" use="optional"/&gt;
            &lt;/xsd:extension&gt;
          &lt;/xsd:simpleContent&gt;
        &lt;/xsd:complexType&gt;
      &lt;/xsd:element&gt;

               Figure 14: New XML for LFB Class Inheritance

   An example of the use of the version attribute is given in Figure 15.

      &lt;derivedFrom version="1.0"&gt;EtherPHYCop&lt;/derivedFrom&gt;

      Figure 15: Example of Use of New XML for LFB Class Inheritance

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.7.%20%20Enhancing%20XML%20Validation"></a><a class="selflink" href="#section-2.7" name="section-2.7">2.7</a>.  Enhancing XML Validation</span>

   As specified earlier, this is not an extension but an enhancement of
   the schema to provide additional validation rules.  This includes
   adding new key declarations to provide uniqueness as defined by the
   ForCES model [<a href="rfc5812.html" title='"Forwarding and Control Element Separation (ForCES) Forwarding Element Model"'>RFC5812</a>].  Such validations work only within the same
   XML file.

   This document introduces the following validation rules that did not
   exist in the original schema in [<a href="rfc5812.html" title='"Forwarding and Control Element Separation (ForCES) Forwarding Element Model"'>RFC5812</a>]:

   1.  Each metadataID must be unique.

   2.  LFBClassIDs must be unique.

   3.  componentID, capabilityID, and Event baseID must be unique per
       LFB.

   4.  eventIDs must be unique per LFB.

   5.  Special values in atomic data types must be unique per atomic
       data type.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20XML%20Extension%20Schema%20for%20LFB%20Class%20Library%20Documents"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  XML Extension Schema for LFB Class Library Documents</span>

   This section includes the new XML schema.  Note that the namespace
   number has been updated from 1.0 to 1.1.





<span class="grey">Haleplidis                   Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


   The extensions described in this document are backwards compatible in
   terms of the operation of the ForCES protocol.  In terms of the XML,
   any definitions that were valid under the old namespace are valid
   under the new namespace.  It is to be noted that any auxiliary tools
   that are processing XML definitions written under both namespaces
   will need to be able to understand both.

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
   xmlns="urn:ietf:params:xml:ns:forces:lfbmodel:1.1"
   xmlns:lfb="urn:ietf:params:xml:ns:forces:lfbmodel:1.1"
   targetNamespace="urn:ietf:params:xml:ns:forces:lfbmodel:1.1"
   elementFormDefault="qualified" attributeFormDefault="unqualified"&gt;
   &lt;xsd:annotation&gt;
      &lt;xsd:documentation xml:lang="en"&gt;
         Schema for Defining LFB Classes and associated types
         (frames, data types for LFB attributes, and metadata).
      &lt;/xsd:documentation&gt;
   &lt;/xsd:annotation&gt;
   &lt;xsd:element name="description" type="xsd:string"/&gt;
   &lt;xsd:element name="synopsis" type="xsd:string"/&gt;
   &lt;!-- Document root element: LFBLibrary --&gt;
   &lt;xsd:element name="LFBLibrary"&gt;
      &lt;xsd:complexType&gt;
         &lt;xsd:sequence&gt;
            &lt;xsd:element ref="description" minOccurs="0"/&gt;
            &lt;xsd:element name="load" type="loadType"
               minOccurs="0" maxOccurs="unbounded"/&gt;
            &lt;xsd:element name="frameDefs" type="frameDefsType"
               minOccurs="0"/&gt;
            &lt;xsd:element name="dataTypeDefs" type="dataTypeDefsType"
               minOccurs="0"/&gt;
            &lt;xsd:element name="metadataDefs" type="metadataDefsType"
               minOccurs="0"/&gt;
            &lt;xsd:element name="LFBClassDefs" type="LFBClassDefsType"
               minOccurs="0"/&gt;
         &lt;/xsd:sequence&gt;
         &lt;xsd:attribute name="provides" type="xsd:Name"
            use="required"/&gt;
      &lt;/xsd:complexType&gt;
      &lt;!-- Uniqueness constraints --&gt;
      &lt;xsd:key name="frame"&gt;
         &lt;xsd:selector xpath="lfb:frameDefs/lfb:frameDef"/&gt;
         &lt;xsd:field xpath="lfb:name"/&gt;
      &lt;/xsd:key&gt;
      &lt;xsd:key name="dataType"&gt;
         &lt;xsd:selector xpath="lfb:dataTypeDefs/lfb:dataTypeDef"/&gt;
         &lt;xsd:field xpath="lfb:name"/&gt;



<span class="grey">Haleplidis                   Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


      &lt;/xsd:key&gt;
      &lt;xsd:key name="metadataDef"&gt;
         &lt;xsd:selector xpath="lfb:metadataDefs/lfb:metadataDef"/&gt;
         &lt;xsd:field xpath="lfb:name"/&gt;
      &lt;/xsd:key&gt;
      &lt;xsd:key name="metadataDefID"&gt;
         &lt;xsd:selector xpath="lfb:metadataDefs/lfb:metadataDef"/&gt;
         &lt;xsd:field xpath="lfb:metadataID"/&gt;
      &lt;/xsd:key&gt;
      &lt;xsd:key name="LFBClassDef"&gt;
         &lt;xsd:selector xpath="lfb:LFBClassDefs/lfb:LFBClassDef"/&gt;
         &lt;xsd:field xpath="lfb:name"/&gt;
      &lt;/xsd:key&gt;
      &lt;xsd:key name="LFBClassDefID"&gt;
         &lt;xsd:selector xpath="lfb:LFBClassDefs/lfb:LFBClassDef"/&gt;
         &lt;xsd:field xpath="@LFBClassID"/&gt;
      &lt;/xsd:key&gt;
   &lt;/xsd:element&gt;
   &lt;xsd:complexType name="loadType"&gt;
      &lt;xsd:attribute name="library" type="xsd:Name" use="required"/&gt;
      &lt;xsd:attribute name="location" type="xsd:anyURI"
         use="optional"/&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="frameDefsType"&gt;
      &lt;xsd:sequence&gt;
         &lt;xsd:element name="frameDef" maxOccurs="unbounded"&gt;
            &lt;xsd:complexType&gt;
               &lt;xsd:sequence&gt;
                  &lt;xsd:element name="name" type="xsd:NMTOKEN"/&gt;
                  &lt;xsd:element ref="synopsis"/&gt;
                  &lt;xsd:element ref="description"
                     minOccurs="0"/&gt;
               &lt;/xsd:sequence&gt;
            &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;
      &lt;/xsd:sequence&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="dataTypeDefsType"&gt;
      &lt;xsd:sequence&gt;
         &lt;xsd:element name="dataTypeDef" maxOccurs="unbounded"&gt;
            &lt;xsd:complexType&gt;
               &lt;xsd:sequence&gt;
                  &lt;xsd:element name="name" type="xsd:NMTOKEN"/&gt;
                  &lt;xsd:element name="derivedFrom" type="xsd:NMTOKEN"
                     minOccurs="0"/&gt;
                  &lt;xsd:element ref="synopsis"/&gt;
                  &lt;xsd:element ref="description"
                     minOccurs="0"/&gt;



<span class="grey">Haleplidis                   Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


                  &lt;xsd:group ref="typeDeclarationGroup"/&gt;
                  &lt;!-- Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
                  &lt;xsd:element name="defaultValue" type="xsd:token"
                     minOccurs="0"/&gt;
                  &lt;!-- /Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
               &lt;/xsd:sequence&gt;
            &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;
      &lt;/xsd:sequence&gt;
   &lt;/xsd:complexType&gt;
   &lt;!-- Predefined (built-in) atomic data-types are: char, uchar,
   int16, uint16, int32, uint32, int64, uint64, string[N], string,
   byte[N], boolean, octetstring[N], float32, float64 --&gt;
   &lt;xsd:group name="typeDeclarationGroup"&gt;
      &lt;xsd:choice&gt;
         &lt;xsd:element name="typeRef" type="typeRefNMTOKEN"/&gt;
         &lt;xsd:element name="atomic" type="atomicType"/&gt;
         &lt;xsd:element name="array" type="arrayType"&gt;
            &lt;!-- Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
            &lt;!-- declare keys to have unique IDs --&gt;
            &lt;xsd:key name="contentKeyID"&gt;
               &lt;xsd:selector xpath="lfb:contentKey"/&gt;
               &lt;xsd:field xpath="@contentKeyID"/&gt;
            &lt;/xsd:key&gt;
            &lt;!-- /Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
         &lt;/xsd:element&gt;
         &lt;xsd:element name="struct" type="structType"&gt;
            &lt;!-- Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
            &lt;!-- key declaration to make componentIDs
              unique in a struct --&gt;
            &lt;xsd:key name="structComponentID"&gt;
               &lt;xsd:selector xpath="lfb:component"/&gt;
               &lt;xsd:field xpath="@componentID"/&gt;
            &lt;/xsd:key&gt;
            &lt;!-- /Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
         &lt;/xsd:element&gt;
         &lt;xsd:element name="union" type="structType"/&gt;
         &lt;xsd:element name="alias" type="typeRefNMTOKEN"/&gt;
      &lt;/xsd:choice&gt;
   &lt;/xsd:group&gt;
   &lt;xsd:simpleType name="typeRefNMTOKEN"&gt;
      &lt;xsd:restriction base="xsd:token"&gt;
         &lt;xsd:pattern value="\c+"/&gt;
         &lt;xsd:pattern value="string\[\d+\]"/&gt;
         &lt;xsd:pattern value="byte\[\d+\]"/&gt;
         &lt;xsd:pattern value="octetstring\[\d+\]"/&gt;
      &lt;/xsd:restriction&gt;
   &lt;/xsd:simpleType&gt;



<span class="grey">Haleplidis                   Standards Track                   [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


   &lt;xsd:complexType name="atomicType"&gt;
      &lt;xsd:sequence&gt;
         &lt;xsd:element name="baseType" type="typeRefNMTOKEN"/&gt;
         &lt;xsd:element name="rangeRestriction"
           type="rangeRestrictionType" minOccurs="0"/&gt;
         &lt;xsd:element name="specialValues" type="specialValuesType"
            minOccurs="0"&gt;
            &lt;!-- Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
            &lt;xsd:key name="SpecialValue"&gt;
               &lt;xsd:selector xpath="specialValue"/&gt;
               &lt;xsd:field xpath="@value"/&gt;
            &lt;/xsd:key&gt;
            &lt;!-- /Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
         &lt;/xsd:element&gt;
      &lt;/xsd:sequence&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="rangeRestrictionType"&gt;
      &lt;xsd:sequence&gt;
         &lt;xsd:element name="allowedRange" maxOccurs="unbounded"&gt;
            &lt;xsd:complexType&gt;
               &lt;xsd:attribute name="min" type="xsd:integer"
                  use="required"/&gt;
               &lt;xsd:attribute name="max" type="xsd:integer"
                  use="required"/&gt;
            &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;
      &lt;/xsd:sequence&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="specialValuesType"&gt;
      &lt;xsd:sequence&gt;
         &lt;xsd:element name="specialValue" maxOccurs="unbounded"&gt;
            &lt;xsd:complexType&gt;
               &lt;xsd:sequence&gt;
                  &lt;xsd:element name="name" type="xsd:NMTOKEN"/&gt;
                  &lt;xsd:element ref="synopsis"/&gt;
               &lt;/xsd:sequence&gt;
               &lt;xsd:attribute name="value" type="xsd:token"/&gt;
            &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;
      &lt;/xsd:sequence&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="arrayType"&gt;
      &lt;xsd:sequence&gt;
         &lt;xsd:group ref="typeDeclarationGroup"/&gt;
         &lt;xsd:element name="contentKey" minOccurs="0"
            maxOccurs="unbounded"&gt;
            &lt;xsd:complexType&gt;
               &lt;xsd:sequence&gt;



<span class="grey">Haleplidis                   Standards Track                   [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


                  &lt;xsd:element name="contentKeyField"
                     type="xsd:string" maxOccurs="unbounded"/&gt;
               &lt;/xsd:sequence&gt;
               &lt;xsd:attribute name="contentKeyID" type="xsd:integer"
                  use="required"/&gt;
            &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;
      &lt;/xsd:sequence&gt;
      &lt;xsd:attribute name="type" use="optional" default="variable-size"&gt;
         &lt;xsd:simpleType&gt;
            &lt;xsd:restriction base="xsd:string"&gt;
               &lt;xsd:enumeration value="fixed-size"/&gt;
               &lt;xsd:enumeration value="variable-size"/&gt;
            &lt;/xsd:restriction&gt;
         &lt;/xsd:simpleType&gt;
      &lt;/xsd:attribute&gt;
      &lt;xsd:attribute name="length" type="xsd:integer"
         use="optional"/&gt;
      &lt;xsd:attribute name="maxLength" type="xsd:integer"
         use="optional"/&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="structType"&gt;
      &lt;xsd:sequence&gt;
         &lt;xsd:element name="derivedFrom" type="typeRefNMTOKEN"
            minOccurs="0"/&gt;
         &lt;xsd:element name="component" maxOccurs="unbounded"&gt;
            &lt;xsd:complexType&gt;
               &lt;xsd:sequence&gt;
                  &lt;xsd:element name="name" type="xsd:NMTOKEN"/&gt;
                  &lt;xsd:element ref="synopsis"/&gt;
                  &lt;xsd:element ref="description"
                     minOccurs="0"/&gt;
                  &lt;xsd:element name="optional" minOccurs="0"/&gt;
                  &lt;xsd:group ref="typeDeclarationGroup"/&gt;
               &lt;/xsd:sequence&gt;
               &lt;!-- Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
               &lt;xsd:attribute name="access" use="optional"
                  default="read-write"&gt;
                  &lt;xsd:simpleType&gt;
                     &lt;xsd:list itemType="accessModeType"/&gt;
                  &lt;/xsd:simpleType&gt;
               &lt;/xsd:attribute&gt;
               &lt;!-- Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
               &lt;xsd:attribute name="componentID" type="xsd:unsignedInt"
                  use="required"/&gt;
            &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;
      &lt;/xsd:sequence&gt;



<span class="grey">Haleplidis                   Standards Track                   [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="metadataDefsType"&gt;
      &lt;xsd:sequence&gt;
         &lt;xsd:element name="metadataDef" maxOccurs="unbounded"&gt;
            &lt;xsd:complexType&gt;
               &lt;xsd:sequence&gt;
                  &lt;xsd:element name="name" type="xsd:NMTOKEN"/&gt;
                  &lt;xsd:element ref="synopsis"/&gt;
                  &lt;xsd:element name="metadataID" type="xsd:integer"/&gt;
                  &lt;xsd:element ref="description"
                     minOccurs="0"/&gt;
                  &lt;xsd:choice&gt;
                     &lt;xsd:element name="typeRef" type="typeRefNMTOKEN"/&gt;
                     &lt;xsd:element name="atomic" type="atomicType"/&gt;
                     &lt;!-- Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
                     &lt;xsd:element name="array" type="arrayType"&gt;
                        &lt;!--declare keys to have unique IDs --&gt;
                        &lt;xsd:key name="contentKeyID1"&gt;
                           &lt;xsd:selector xpath="lfb:contentKey"/&gt;
                           &lt;xsd:field xpath="@contentKeyID"/&gt;
                        &lt;/xsd:key&gt;
                        &lt;!-- /Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
                     &lt;/xsd:element&gt;
                     &lt;xsd:element name="struct" type="structType"&gt;
                        &lt;!-- Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
                        &lt;!-- key declaration to make componentIDs
                           unique in a struct --&gt;
                        &lt;xsd:key name="structComponentID1"&gt;
                           &lt;xsd:selector xpath="lfb:component"/&gt;
                           &lt;xsd:field xpath="@componentID"/&gt;
                        &lt;/xsd:key&gt;
                        &lt;!-- /Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
                     &lt;/xsd:element&gt;
                  &lt;/xsd:choice&gt;
               &lt;/xsd:sequence&gt;
            &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;
      &lt;/xsd:sequence&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="LFBClassDefsType"&gt;
      &lt;xsd:sequence&gt;
         &lt;xsd:element name="LFBClassDef" maxOccurs="unbounded"&gt;
            &lt;xsd:complexType&gt;
               &lt;xsd:sequence&gt;
                  &lt;xsd:element name="name" type="xsd:NMTOKEN"/&gt;
                  &lt;xsd:element ref="synopsis"/&gt;
                  &lt;xsd:element name="version" type="versionType"/&gt;
                  &lt;xsd:element name="derivedFrom" minOccurs="0"&gt;



<span class="grey">Haleplidis                   Standards Track                   [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


                    &lt;xsd:complexType&gt;
                      &lt;xsd:simpleContent&gt;
                        &lt;xsd:extension base="xsd:NMTOKEN"&gt;
                          &lt;xsd:attribute name="version"
                            type="versionType" use="optional"/&gt;
                        &lt;/xsd:extension&gt;
                      &lt;/xsd:simpleContent&gt;
                    &lt;/xsd:complexType&gt;
                  &lt;/xsd:element&gt;
                  &lt;xsd:element name="inputPorts"
                   type="inputPortsType" minOccurs="0"/&gt;
                  &lt;xsd:element name="outputPorts"
                   type="outputPortsType" minOccurs="0"/&gt;
                  &lt;xsd:element name="components"
                   type="LFBComponentsType" minOccurs="0"/&gt;
                  &lt;xsd:element name="capabilities"
                   type="LFBCapabilitiesType" minOccurs="0"/&gt;
                  &lt;xsd:element name="events" type="eventsType"
                     minOccurs="0"/&gt;
                  &lt;xsd:element ref="description"
                     minOccurs="0"/&gt;
               &lt;/xsd:sequence&gt;
               &lt;xsd:attribute name="LFBClassID" type="xsd:unsignedInt"
                  use="required"/&gt;
            &lt;/xsd:complexType&gt;
            &lt;!-- Key constraint to ensure unique attribute names
            within a class: --&gt;
            &lt;xsd:key name="components"&gt;
               &lt;xsd:selector xpath="lfb:components/lfb:component"/&gt;
               &lt;xsd:field xpath="lfb:name"/&gt;
            &lt;/xsd:key&gt;
            &lt;xsd:key name="capabilities"&gt;
               &lt;xsd:selector xpath="lfb:capabilities/lfb:capability"/&gt;
               &lt;xsd:field xpath="lfb:name"/&gt;
            &lt;/xsd:key&gt;
            &lt;xsd:key name="events"&gt;
               &lt;xsd:selector xpath="lfb:events/lfb:event"/&gt;
               &lt;xsd:field xpath="lfb:name"/&gt;
            &lt;/xsd:key&gt;
            &lt;xsd:key name="eventsIDs"&gt;
               &lt;xsd:selector xpath="lfb:events/lfb:event"/&gt;
               &lt;xsd:field xpath="@eventID"/&gt;
            &lt;/xsd:key&gt;
            &lt;xsd:key name="componentIDs"&gt;
               &lt;xsd:selector xpath="lfb:components/lfb:component"/&gt;
               &lt;xsd:field xpath="@componentID"/&gt;
            &lt;/xsd:key&gt;
            &lt;xsd:key name="capabilityIDs"&gt;



<span class="grey">Haleplidis                   Standards Track                   [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


               &lt;xsd:selector xpath="lfb:capabilities/lfb:capability"/&gt;
               &lt;xsd:field xpath="@componentID"/&gt;
            &lt;/xsd:key&gt;
            &lt;xsd:key name="ComponentCapabilityComponentIDUniqueness"&gt;
               &lt;xsd:selector
                  xpath="lfb:components/lfb:component|
                  lfb:capabilities/lfb:capability|lfb:events"/&gt;
               &lt;xsd:field xpath="@componentID|@baseID"/&gt;
            &lt;/xsd:key&gt;
         &lt;/xsd:element&gt;
      &lt;/xsd:sequence&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:simpleType name="versionType"&gt;
      &lt;xsd:restriction base="xsd:NMTOKEN"&gt;
         &lt;xsd:pattern value="[1-9][0-9]*\.([1-9][0-9]*|0)"/&gt;
      &lt;/xsd:restriction&gt;
   &lt;/xsd:simpleType&gt;
   &lt;xsd:complexType name="inputPortsType"&gt;
      &lt;xsd:sequence&gt;
         &lt;xsd:element name="inputPort" type="inputPortType"
            maxOccurs="unbounded"/&gt;
      &lt;/xsd:sequence&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="inputPortType"&gt;
      &lt;xsd:sequence&gt;
         &lt;xsd:element name="name" type="xsd:NMTOKEN"/&gt;
         &lt;xsd:element ref="synopsis"/&gt;
         &lt;xsd:element name="expectation" type="portExpectationType"/&gt;
         &lt;xsd:element ref="description" minOccurs="0"/&gt;
      &lt;/xsd:sequence&gt;
      &lt;xsd:attribute name="group" type="xsd:boolean"
         use="optional" default="0"/&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="portExpectationType"&gt;
      &lt;xsd:sequence&gt;
         &lt;xsd:element name="frameExpected" minOccurs="0"&gt;
            &lt;xsd:complexType&gt;
               &lt;xsd:sequence&gt;
                  &lt;!-- ref must refer to a name of a defined
                    frame type --&gt;
                  &lt;xsd:element name="ref" type="xsd:string"
                     maxOccurs="unbounded"/&gt;
               &lt;/xsd:sequence&gt;
            &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;
         &lt;xsd:element name="metadataExpected" minOccurs="0"&gt;
            &lt;xsd:complexType&gt;
               &lt;xsd:choice maxOccurs="unbounded"&gt;



<span class="grey">Haleplidis                   Standards Track                   [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


                  &lt;!--ref must refer to a name of a defined metadata--&gt;
                  &lt;xsd:element name="ref" type="metadataInputRefType"/&gt;
                  &lt;xsd:element name="one-of"
                     type="metadataInputChoiceType"/&gt;
               &lt;/xsd:choice&gt;
            &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;
      &lt;/xsd:sequence&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="metadataInputChoiceType"&gt;
      &lt;xsd:choice minOccurs="2" maxOccurs="unbounded"&gt;
         &lt;!-- ref must refer to a name of a defined metadata --&gt;
         &lt;xsd:element name="ref" type="xsd:NMTOKEN"/&gt;
         &lt;xsd:element name="one-of" type="metadataInputChoiceType"/&gt;
         &lt;xsd:element name="metadataSet" type="metadataInputSetType"/&gt;
      &lt;/xsd:choice&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="metadataInputSetType"&gt;
      &lt;xsd:choice minOccurs="2" maxOccurs="unbounded"&gt;
         &lt;!-- ref must refer to a name of a defined metadata --&gt;
         &lt;xsd:element name="ref" type="metadataInputRefType"/&gt;
         &lt;xsd:element name="one-of" type="metadataInputChoiceType"/&gt;
      &lt;/xsd:choice&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="metadataInputRefType"&gt;
      &lt;xsd:simpleContent&gt;
         &lt;xsd:extension base="xsd:NMTOKEN"&gt;
            &lt;xsd:attribute name="dependency" use="optional"
               default="required"&gt;
               &lt;xsd:simpleType&gt;
                  &lt;xsd:restriction base="xsd:string"&gt;
                     &lt;xsd:enumeration value="required"/&gt;
                     &lt;xsd:enumeration value="optional"/&gt;
                  &lt;/xsd:restriction&gt;
               &lt;/xsd:simpleType&gt;
            &lt;/xsd:attribute&gt;
            &lt;xsd:attribute name="defaultValue" type="xsd:token"
               use="optional"/&gt;
         &lt;/xsd:extension&gt;
      &lt;/xsd:simpleContent&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="outputPortsType"&gt;
      &lt;xsd:sequence&gt;
         &lt;xsd:element name="outputPort" type="outputPortType"
            maxOccurs="unbounded"/&gt;
      &lt;/xsd:sequence&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="outputPortType"&gt;



<span class="grey">Haleplidis                   Standards Track                   [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


      &lt;xsd:sequence&gt;
         &lt;xsd:element name="name" type="xsd:NMTOKEN"/&gt;
         &lt;xsd:element ref="synopsis"/&gt;
         &lt;xsd:element name="product" type="portProductType"/&gt;
         &lt;xsd:element ref="description" minOccurs="0"/&gt;
      &lt;/xsd:sequence&gt;
      &lt;xsd:attribute name="group" type="xsd:boolean"
         use="optional" default="0"/&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="portProductType"&gt;
      &lt;xsd:sequence&gt;
         &lt;xsd:element name="frameProduced" minOccurs="0"&gt;
            &lt;xsd:complexType&gt;
               &lt;xsd:sequence&gt;
                  &lt;!-- ref must refer to a name of a defined
                     frame type --&gt;
                  &lt;xsd:element name="ref" type="xsd:NMTOKEN"
                     maxOccurs="unbounded"/&gt;
               &lt;/xsd:sequence&gt;
            &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;
         &lt;xsd:element name="metadataProduced" minOccurs="0"&gt;
            &lt;xsd:complexType&gt;
               &lt;xsd:choice maxOccurs="unbounded"&gt;
                  &lt;!-- ref must refer to a name of a
                     defined metadata --&gt;
                  &lt;xsd:element name="ref"
                     type="metadataOutputRefType"/&gt;
                  &lt;xsd:element name="one-of"
                     type="metadataOutputChoiceType"/&gt;
               &lt;/xsd:choice&gt;
            &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;
      &lt;/xsd:sequence&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="metadataOutputChoiceType"&gt;
      &lt;xsd:choice minOccurs="2" maxOccurs="unbounded"&gt;
         &lt;!-- ref must refer to a name of a defined metadata --&gt;
         &lt;xsd:element name="ref" type="xsd:NMTOKEN"/&gt;
         &lt;xsd:element name="one-of" type="metadataOutputChoiceType"/&gt;
         &lt;xsd:element name="metadataSet" type="metadataOutputSetType"/&gt;
      &lt;/xsd:choice&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="metadataOutputSetType"&gt;
      &lt;xsd:choice minOccurs="2" maxOccurs="unbounded"&gt;
         &lt;!-- ref must refer to a name of a defined metadata --&gt;
         &lt;xsd:element name="ref" type="metadataOutputRefType"/&gt;
         &lt;xsd:element name="one-of" type="metadataOutputChoiceType"/&gt;



<span class="grey">Haleplidis                   Standards Track                   [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


      &lt;/xsd:choice&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="metadataOutputRefType"&gt;
      &lt;xsd:simpleContent&gt;
         &lt;xsd:extension base="xsd:NMTOKEN"&gt;
            &lt;xsd:attribute name="availability" use="optional"
               default="unconditional"&gt;
               &lt;xsd:simpleType&gt;
                  &lt;xsd:restriction base="xsd:string"&gt;
                     &lt;xsd:enumeration value="unconditional"/&gt;
                     &lt;xsd:enumeration value="conditional"/&gt;
                  &lt;/xsd:restriction&gt;
               &lt;/xsd:simpleType&gt;
            &lt;/xsd:attribute&gt;
         &lt;/xsd:extension&gt;
      &lt;/xsd:simpleContent&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="LFBComponentsType"&gt;
      &lt;xsd:sequence&gt;
         &lt;xsd:element name="component" maxOccurs="unbounded"&gt;
            &lt;xsd:complexType&gt;
               &lt;xsd:sequence&gt;
                  &lt;xsd:element name="name" type="xsd:NMTOKEN"/&gt;
                  &lt;xsd:element ref="synopsis"/&gt;
                  &lt;xsd:element ref="description"
                     minOccurs="0"/&gt;
                  &lt;xsd:element name="optional" minOccurs="0"/&gt;
                  &lt;xsd:group ref="typeDeclarationGroup"/&gt;
                  &lt;xsd:element name="defaultValue" type="xsd:token"
                     minOccurs="0"/&gt;
               &lt;/xsd:sequence&gt;
               &lt;xsd:attribute name="access" use="optional"
                  default="read-write"&gt;
                  &lt;xsd:simpleType&gt;
                     &lt;xsd:list itemType="accessModeType"/&gt;
                  &lt;/xsd:simpleType&gt;
               &lt;/xsd:attribute&gt;
               &lt;!-- Extension added restriction to componentID --&gt;
               &lt;xsd:attribute name="componentID" use="required"&gt;
                  &lt;xsd:simpleType&gt;
                     &lt;xsd:restriction base="xsd:unsignedInt"&gt;
                        &lt;xsd:minExclusive value="0"/&gt;
                     &lt;/xsd:restriction&gt;
                  &lt;/xsd:simpleType&gt;
               &lt;/xsd:attribute&gt;
               &lt;!-- End of extension --&gt;
            &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;



<span class="grey">Haleplidis                   Standards Track                   [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


      &lt;/xsd:sequence&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:simpleType name="accessModeType"&gt;
      &lt;xsd:restriction base="xsd:NMTOKEN"&gt;
         &lt;xsd:enumeration value="read-only"/&gt;
         &lt;xsd:enumeration value="read-write"/&gt;
         &lt;xsd:enumeration value="write-only"/&gt;
         &lt;xsd:enumeration value="read-reset"/&gt;
         &lt;xsd:enumeration value="trigger-only"/&gt;
      &lt;/xsd:restriction&gt;
   &lt;/xsd:simpleType&gt;
   &lt;xsd:complexType name="LFBCapabilitiesType"&gt;
      &lt;xsd:sequence&gt;
         &lt;xsd:element name="capability" maxOccurs="unbounded"&gt;
            &lt;xsd:complexType&gt;
               &lt;xsd:sequence&gt;
                  &lt;xsd:element name="name" type="xsd:NMTOKEN"/&gt;
                  &lt;xsd:element ref="synopsis"/&gt;
                  &lt;xsd:element ref="description"
                     minOccurs="0"/&gt;
                  &lt;xsd:element name="optional" minOccurs="0"/&gt;
                  &lt;xsd:group ref="typeDeclarationGroup"/&gt;
               &lt;/xsd:sequence&gt;
               &lt;xsd:attribute name="componentID" type="xsd:integer"
                  use="required"/&gt;
            &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;
      &lt;/xsd:sequence&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:complexType name="eventsType"&gt;
      &lt;xsd:sequence&gt;
         &lt;xsd:element name="event" maxOccurs="unbounded"&gt;
            &lt;xsd:complexType&gt;
               &lt;xsd:sequence&gt;
                  &lt;xsd:element name="name" type="xsd:NMTOKEN"/&gt;
                  &lt;xsd:element ref="synopsis"/&gt;
                  &lt;xsd:element name="eventTarget"
                    type="eventPathType"/&gt;
                  &lt;xsd:element ref="eventCondition"/&gt;
                  &lt;xsd:element name="eventReports"
                   type="eventReportsType" minOccurs="0"/&gt;
                  &lt;xsd:element ref="description"
                     minOccurs="0"/&gt;
               &lt;/xsd:sequence&gt;
               &lt;xsd:attribute name="eventID" type="xsd:integer"
                  use="required"/&gt;
            &lt;/xsd:complexType&gt;
         &lt;/xsd:element&gt;



<span class="grey">Haleplidis                   Standards Track                   [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


      &lt;/xsd:sequence&gt;
      &lt;xsd:attribute name="baseID" type="xsd:integer"
         use="optional"/&gt;
   &lt;/xsd:complexType&gt;
   &lt;!-- the substitution group for the event conditions --&gt;
   &lt;xsd:element name="eventCondition" abstract="true"/&gt;
   &lt;xsd:element name="eventCreated"
    substitutionGroup="eventCondition"/&gt;
   &lt;xsd:element name="eventDeleted"
    substitutionGroup="eventCondition"/&gt;
   &lt;xsd:element name="eventChanged"
    substitutionGroup="eventCondition"/&gt;
   &lt;xsd:element name="eventGreaterThan"
    substitutionGroup="eventCondition"/&gt;
   &lt;xsd:element name="eventLessThan"
    substitutionGroup="eventCondition"/&gt;
   &lt;!-- Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
   &lt;xsd:element name="eventBecomesEqualTo"
      substitutionGroup="eventCondition"/&gt;
   &lt;!-- /Extension <a href="rfc7408.html">RFC 7408</a> --&gt;
   &lt;xsd:complexType name="eventPathType"&gt;
      &lt;xsd:sequence&gt;
         &lt;xsd:element ref="eventPathPart" maxOccurs="unbounded"/&gt;
      &lt;/xsd:sequence&gt;
   &lt;/xsd:complexType&gt;
   &lt;!-- the substitution group for the event path parts --&gt;
   &lt;xsd:element name="eventPathPart" type="xsd:string"
      abstract="true"/&gt;
   &lt;xsd:element name="eventField" type="xsd:string"
      substitutionGroup="eventPathPart"/&gt;
   &lt;xsd:element name="eventSubscript" type="xsd:string"
      substitutionGroup="eventPathPart"/&gt;
   &lt;xsd:complexType name="eventReportsType"&gt;
      &lt;xsd:sequence&gt;
         &lt;xsd:element name="eventReport" type="eventPathType"
            maxOccurs="unbounded"/&gt;
      &lt;/xsd:sequence&gt;
   &lt;/xsd:complexType&gt;
   &lt;xsd:simpleType name="booleanType"&gt;
      &lt;xsd:restriction base="xsd:string"&gt;
         &lt;xsd:enumeration value="0"/&gt;
         &lt;xsd:enumeration value="1"/&gt;
      &lt;/xsd:restriction&gt;
   &lt;/xsd:simpleType&gt;
&lt;/xsd:schema&gt;

                           ForCES LFB XML Schema




<span class="grey">Haleplidis                   Standards Track                   [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  IANA Considerations</span>

   IANA has registered a new XML namespace, as per the guidelines in <a href="rfc3688.html">RFC</a>
   <a href="rfc3688.html">3688</a> [<a href="rfc3688.html" title='"The IETF XML Registry"'>RFC3688</a>].

   URI: The URI for this namespace is:

      urn:ietf:params:xml:ns:forces:lfbmodel:1.1

   Registrant Contact: IESG

   XML: none, this is an XML namespace

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Security%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Security Considerations</span>

   This specification adds only a few constructs to the initial model
   defined in [<a href="rfc5812.html" title='"Forwarding and Control Element Separation (ForCES) Forwarding Element Model"'>RFC5812</a>], namely, a new event, some new properties, and a
   way to define optional access types and complex metadata.  In
   addition, this document addresses and clarifies an issue with the
   inheritance model by introducing the version of the derivedFrom LFB
   class.  These constructs and the update to the inheritance model do
   not change the nature of the initial model.

   Thus, the security considerations defined in [<a href="rfc5812.html" title='"Forwarding and Control Element Separation (ForCES) Forwarding Element Model"'>RFC5812</a>] apply to this
   specification as well, as the changes proposed here are simply
   constructs to write XML library definitions, as [<a href="rfc5812.html" title='"Forwarding and Control Element Separation (ForCES) Forwarding Element Model"'>RFC5812</a>] does.
   These changes, as well as the clarification of the inheritance issue
   of the initial model, have no effect on the security semantics of the
   protocol.

   In regard to pervasive monitoring (PM), as discussed in [<a href="rfc7258.html" title='"Pervasive Monitoring Is an Attack"'>RFC7258</a>],
   this specification defines ways to expose more complex information
   (namely, metadata) exchanged between LFBs and between CEs and FEs and
   a new event.  These changes have very little or no effect in terms of
   making PM simpler or more effective to an attacker who controls the
   LFBs.  The new metadata might make for slightly more elegant PM, but
   does not enable any new ways to (ab)use LFBs for PM.  The same
   applies for the new event.

   Finally, this document does not provide any protocol specification
   and, as such, does not specify how information will be transmitted
   between respective entities.  Thus, PM mitigation for a passive
   attacker that simply wants to eavesdrop on the information exchanged
   is out of the scope of this document.







<span class="grey">Haleplidis                   Standards Track                   [Page 29]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20References"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Normative%20References"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC3688" name="ref-RFC3688">RFC3688</a>]  Mealling, M., "The IETF XML Registry", <a href="https://tools.ietf.org/html/bcp81">BCP 81</a>, <a href="rfc3688.html">RFC 3688</a>,
              January 2004, &lt;<a href="http://www.rfc-editor.org/info/rfc3688">http://www.rfc-editor.org/info/rfc3688</a>&gt;.

   [<a id="ref-RFC5810" name="ref-RFC5810">RFC5810</a>]  Doria, A., Hadi Salim, J., Haas, R., Khosravi, H., Wang,
              W., Dong, L., Gopal, R., and J. Halpern, "Forwarding and
              Control Element Separation (ForCES) Protocol
              Specification", <a href="rfc5810.html">RFC 5810</a>, March 2010,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5810">http://www.rfc-editor.org/info/rfc5810</a>&gt;.

   [<a id="ref-RFC5812" name="ref-RFC5812">RFC5812</a>]  Halpern, J. and J. Hadi Salim, "Forwarding and Control
              Element Separation (ForCES) Forwarding Element Model", <a href="rfc5812.html">RFC</a>
              <a href="rfc5812.html">5812</a>, March 2010,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5812">http://www.rfc-editor.org/info/rfc5812</a>&gt;.

   [<a id="ref-RFC7121" name="ref-RFC7121">RFC7121</a>]  Ogawa, K., Wang, W., Haleplidis, E., and J. Hadi Salim,
              "High Availability within a Forwarding and Control Element
              Separation (ForCES) Network Element", <a href="rfc7121.html">RFC 7121</a>, February
              2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7121">http://www.rfc-editor.org/info/rfc7121</a>&gt;.

   [<a id="ref-RFC7258" name="ref-RFC7258">RFC7258</a>]  Farrell, S. and H. Tschofenig, "Pervasive Monitoring Is an
              Attack", <a href="https://tools.ietf.org/html/bcp188">BCP 188</a>, <a href="rfc7258.html">RFC 7258</a>, May 2014,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7258">http://www.rfc-editor.org/info/rfc7258</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Informative%20References"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Informative References</span>

   [<a id="ref-OpenFlowSpec1.1" name="ref-OpenFlowSpec1.1">OpenFlowSpec1.1</a>]
              ONF, "OpenFlow Switch Specification", February 2011,
              &lt;<a href="https://www.opennetworking.org/images/stories/downloads/sdn-resources/onf-specifications/openflow/openflow-spec-v1.1.0.pdf">https://www.opennetworking.org/images/stories/downloads/</a>
              <a href="https://www.opennetworking.org/images/stories/downloads/sdn-resources/onf-specifications/openflow/openflow-spec-v1.1.0.pdf">sdn-resources/onf-specifications/openflow/</a>
              <a href="https://www.opennetworking.org/images/stories/downloads/sdn-resources/onf-specifications/openflow/openflow-spec-v1.1.0.pdf">openflow-spec-v1.1.0.pdf</a>&gt;.













<span class="grey">Haleplidis                   Standards Track                   [Page 30]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc7408.html">RFC 7408</a>                 ForCES Model Extension            November 2014</span>


Acknowledgements

   The author would like to acknowledge Joel Halpern, Jamal Hadi Salim,
   and Dave Hood for their comments and discussion that helped shape
   this document for the better.  Special acknowledgements to Joel
   Halpern for resolving the issue with the default values, Adrian
   Farrel for his AD review, Ben Campbell for his Gen-ART review, and
   Tom Yu for his security review, all of which improved the quality of
   this document.  Additionally, reviews and comments by the following
   members of the IESG shaped the final version of this document:
   Stephen Farrel, Barry Leiba, and Ted Lemon.  Finally, the author
   would like to acknowledge Julian Reschke for input regarding the
   namespace change issue and Joel Halpern for helping to resolve it.

Author's Address

   Evangelos Haleplidis
   University of Patras
   Department of Electrical and Computer Engineering
   Patras  26500
   Greece

   EMail: ehalep@ece.upatras.gr




























Haleplidis                   Standards Track                   [Page 31]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.127, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7408 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Aug 2018 14:01:06 GMT --></html>