<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc8295 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:15 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:8295" name="DC.Identifier"/>
<meta content="The EST (Enrollment over Secure Transport) protocol defines the Well-
Known URI (Uniform Resource Identifier) -- /.well-known/est -- along
with a number of other path components that clients use for PKI
(Public Key Infrastructure) services, namely certificate enrollment
(e.g., /simpleenroll). This document defines a number of other PKI
services as additional path components -- specifically, firmware and
trust anchors as well as symmetric, asymmetric, and encrypted keys.
This document also specifies the PAL (Package Availability List),
which is an XML (Extensible Markup Language) file or JSON (JavaScript
Object Notation) object that clients use to retrieve packages
available and authorized for them. This document extends the EST
server path components to provide these additional services." name="DC.Description.Abstract"/>
<meta content="Sean Turner &lt;sean@sn3rd.com&gt;" name="DC.Creator"/>
<meta content="January, 2018" name="DC.Date.Issued"/>
<meta content="EST (Enrollment over Secure Transport) Extensions" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 8295 - EST (Enrollment over Secure Transport) Extensions</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc8295.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc8295" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-turner-est-extensions" title="draft-turner-est-extensions">draft-turner-es...</a>] [<a href="https://datatracker.ietf.org/doc/rfc8295" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc8295" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc8295" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                         S. Turner
Request for Comments: 8295                                         sn3rd
Category: Standards Track                                   January 2018
ISSN: 2070-1721


           <span class="h1">EST (Enrollment over Secure Transport) Extensions</span>

Abstract

   The EST (Enrollment over Secure Transport) protocol defines the Well-
   Known URI (Uniform Resource Identifier) -- /.well-known/est -- along
   with a number of other path components that clients use for PKI
   (Public Key Infrastructure) services, namely certificate enrollment
   (e.g., /simpleenroll).  This document defines a number of other PKI
   services as additional path components -- specifically, firmware and
   trust anchors as well as symmetric, asymmetric, and encrypted keys.
   This document also specifies the PAL (Package Availability List),
   which is an XML (Extensible Markup Language) file or JSON (JavaScript
   Object Notation) object that clients use to retrieve packages
   available and authorized for them.  This document extends the EST
   server path components to provide these additional services.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc7841.html#section-2">Section 2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8295">https://www.rfc-editor.org/info/rfc8295</a>.















<span class="grey">Turner                       Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-4">4</a>
      <a href="#section-1.1">1.1</a>. Definitions ................................................<a href="#page-6">6</a>
      <a href="#section-1.2">1.2</a>. Authentication and Authorization ...........................<a href="#page-7">7</a>
      <a href="#section-1.3">1.3</a>. TLS Cipher Suites ..........................................<a href="#page-7">7</a>
      <a href="#section-1.4">1.4</a>. URI Configuration ..........................................<a href="#page-7">7</a>
      <a href="#section-1.5">1.5</a>. Message Types ..............................................<a href="#page-8">8</a>
      <a href="#section-1.6">1.6</a>. Key Words .................................................<a href="#page-10">10</a>
   <a href="#section-2">2</a>. Locate Available Packages ......................................<a href="#page-10">10</a>
      <a href="#section-2.1">2.1</a>. PAL Format ................................................<a href="#page-12">12</a>
           <a href="#section-2.1.1">2.1.1</a>. PAL Package Types ..................................<a href="#page-14">14</a>
           <a href="#section-2.1.2">2.1.2</a>. PAL XML Schema .....................................<a href="#page-19">19</a>
           <a href="#section-2.1.3">2.1.3</a>. PAL JSON Object ....................................<a href="#page-23">23</a>
      <a href="#section-2.2">2.2</a>. Request PAL ...............................................<a href="#page-23">23</a>
      <a href="#section-2.3">2.3</a>. Provide PAL ...............................................<a href="#page-24">24</a>
   <a href="#section-3">3</a>. Distribute EE Certificates .....................................<a href="#page-25">25</a>
      <a href="#section-3.1">3.1</a>. EE Certificate Request ....................................<a href="#page-25">25</a>
      <a href="#section-3.2">3.2</a>. EE Certificate Response ...................................<a href="#page-26">26</a>
   <a href="#section-4">4</a>. Distribute CRLs and ARLs .......................................<a href="#page-26">26</a>
      <a href="#section-4.1">4.1</a>. CRL Request ...............................................<a href="#page-26">26</a>
      <a href="#section-4.2">4.2</a>. CRL Response ..............................................<a href="#page-26">26</a>
   <a href="#section-5">5</a>. Symmetric Keys, Receipts, and Errors ...........................<a href="#page-27">27</a>
      <a href="#section-5.1">5.1</a>. Symmetric Keys ............................................<a href="#page-27">27</a>
           <a href="#section-5.1.1">5.1.1</a>. Distribute Symmetric Keys ..........................<a href="#page-28">28</a>
           <a href="#section-5.1.2">5.1.2</a>. Symmetric Key Response .............................<a href="#page-28">28</a>
      <a href="#section-5.2">5.2</a>. Symmetric Key Receipts and Errors .........................<a href="#page-29">29</a>
           <a href="#section-5.2.1">5.2.1</a>. Provide Symmetric Key Receipt or Error .............<a href="#page-30">30</a>
           <a href="#section-5.2.2">5.2.2</a>. Symmetric Key Receipt or Error Response ............<a href="#page-31">31</a>







<span class="grey">Turner                       Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   <a href="#section-6">6</a>. Firmware, Receipts, and Errors .................................<a href="#page-31">31</a>
      <a href="#section-6.1">6.1</a>. Firmware ..................................................<a href="#page-31">31</a>
           <a href="#section-6.1.1">6.1.1</a>. Distribute Firmware ................................<a href="#page-32">32</a>
           <a href="#section-6.1.2">6.1.2</a>. Firmware Response ..................................<a href="#page-32">32</a>
      <a href="#section-6.2">6.2</a>. Firmware Receipts and Errors ..............................<a href="#page-33">33</a>
           <a href="#section-6.2.1">6.2.1</a>. Provide Firmware Receipt or Error ..................<a href="#page-33">33</a>
           <a href="#section-6.2.2">6.2.2</a>. Firmware Receipt or Error Response .................<a href="#page-33">33</a>
   <a href="#section-7">7</a>. Trust Anchor Management Protocol ...............................<a href="#page-34">34</a>
      7.1. TAMP Status Query, Trust Anchor Update,
           Apex Trust Anchor Update, Community Update,
           and Sequence Number Adjust ................................<a href="#page-34">34</a>
           <a href="#section-7.1.1">7.1.1</a>. Request TAMP Packages ..............................<a href="#page-34">34</a>
           <a href="#section-7.1.2">7.1.2</a>. Return TAMP Packages ...............................<a href="#page-35">35</a>
      <a href="#section-7.2">7.2</a>. TAMP Responses, Confirms, and Errors ......................<a href="#page-35">35</a>
           <a href="#section-7.2.1">7.2.1</a>. Provide TAMP Responses, Confirms, or Errors ........<a href="#page-36">36</a>
           <a href="#section-7.2.2">7.2.2</a>. TAMP Responses, Confirms, and Error Responses ......<a href="#page-36">36</a>
   <a href="#section-8">8</a>. Asymmetric Keys, Receipts, and Errors ..........................<a href="#page-36">36</a>
      <a href="#section-8.1">8.1</a>. Asymmetric Key Encapsulation ..............................<a href="#page-37">37</a>
      <a href="#section-8.2">8.2</a>. Asymmetric Key Package Receipts and Errors ................<a href="#page-38">38</a>
      <a href="#section-8.3">8.3</a>. PKCS #12 ..................................................<a href="#page-39">39</a>
           <a href="#section-8.3.1">8.3.1</a>. Server-Side Key Generation Request .................<a href="#page-39">39</a>
           <a href="#section-8.3.2">8.3.2</a>. Server-Side Key Generation Response ................<a href="#page-39">39</a>
   <a href="#section-9">9</a>. PAL and Certificate Enrollment .................................<a href="#page-40">40</a>
   <a href="#section-10">10</a>. Security Considerations .......................................<a href="#page-43">43</a>
   <a href="#section-11">11</a>. IANA Considerations ...........................................<a href="#page-44">44</a>
      <a href="#section-11.1">11.1</a>. PAL Name Space ...........................................<a href="#page-44">44</a>
      <a href="#section-11.2">11.2</a>. PAL XML Schema ...........................................<a href="#page-44">44</a>
      <a href="#section-11.3">11.3</a>. PAL Package Types ........................................<a href="#page-44">44</a>
   <a href="#section-12">12</a>. References ....................................................<a href="#page-45">45</a>
      <a href="#section-12.1">12.1</a>. Normative References .....................................<a href="#page-45">45</a>
      <a href="#section-12.2">12.2</a>. Informative References ...................................<a href="#page-50">50</a>
   <a href="#appendix-A">Appendix A</a>. Example Use of PAL ....................................<a href="#page-51">51</a>
   <a href="#appendix-B">Appendix B</a>. Additional CSR Attributes .............................<a href="#page-53">53</a>
   Acknowledgements ..................................................<a href="#page-54">54</a>
   Author's Address ..................................................<a href="#page-54">54</a>
















<span class="grey">Turner                       Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The EST (Enrollment over Secure Transport) protocol [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>] defines
   the Well-Known URI (Uniform Resource Identifier) -- /.well-known/est
   -- to support selected services related to the PKI (Public Key
   Infrastructure), with such PCs (path components) as simple enrollment
   with /simpleenroll, rekey or renew with /simplereenroll, etc.  A
   server that wishes to support additional PKI-related services and
   other security-related packages could use the same .well-known URI by
   defining additional PCs.  This document defines six such PCs:

   o  /pal - The PAL (Package Availability List) provides a list of all
      known packages available and authorized for a client.  By
      accessing the service provided by this PC first, the client can
      walk through the PAL and download all the packages necessary to
      begin operating securely.  The PAL essentially points to other
      PCs, including the PCs defined in this document as well as those
      defined in [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>] (e.g., /cacerts, /simpleenroll,
      /simplereenroll, /fullcmc, /serverkeygen, and /csrattrs).  The
      /pal PC is described in <a href="#section-2">Section 2</a>.

   o  /eecerts - EE (End-Entity) certificates [<a href="rfc5280.html" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>] are needed by
      the client when they invoke a security protocol for communicating
      with a peer (i.e., they become operational and do something
      meaningful as opposed to just communicating with the
      infrastructure).  If the infrastructure knows the certificate(s)
      needed by the client, then providing the peer's certificate avoids
      the client having to discover the peer's certificate.  This
      service is not meant to be a general-purpose repository to which
      clients query a "repository" and then get a response; this is
      purely a push mechanism.  The /eecerts PC is described in
      <a href="#section-3">Section 3</a>.

   o  /crls - CRLs (Certificate Revocation Lists) and ARLs (Authority
      Revocation Lists) [<a href="rfc5280.html" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>] are also needed by the client when
      they validate certificate paths.  CRLs (and ARLs) from TAs (Trust
      Anchors) and intermediate CAs (Certification Authorities) are
      needed to validate the certificates used to generate the client's
      certificate or the peer's certificate, which is provided by the
      /eecerts PC, and providing them saves the client from having to
      "discover" them and then retrieve them.  CRL "discovery" is
      greatly aided by the inclusion of the CRL Distribution Point
      certificate extension [<a href="rfc5280.html" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>], but this extension is not always
      present in certificates and requires another connection to
      retrieve them.  Like the /eecerts PC, this service is not meant to
      be a general-purpose repository to which clients query a
      repository and then get a response; this is purely a push
      mechanism.  The /crls PC is described in <a href="#section-4">Section 4</a>.



<span class="grey">Turner                       Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   o  /symmetrickeys - In some cases, clients use symmetric keys
      [<a href="rfc6031.html" title='"Cryptographic Message Syntax (CMS) Symmetric Key Package Content Type"'>RFC6031</a>] when communicating with their peers.  If the client's
      peers are known by the server a priori, then providing them saves
      the client or an administrator from later having to find,
      retrieve, and install them.  Like the /eecerts and /crls PCs, this
      service is not meant to be a general-purpose repository to which
      clients query a repository and then get a response; this is purely
      a push mechanism for the keys themselves.  However, things do not
      always go as planned, and clients need to inform the server about
      any errors.  If things did go well, then the client, if requested,
      needs to provide a receipt [<a href="rfc7191.html" title='"Cryptographic Message Syntax (CMS) Key Package Receipt and Error Content Types"'>RFC7191</a>].  The /symmetrickeys and
      /symmetrickeys/return PCs are described in <a href="#section-5">Section 5</a>.

   o  /firmware - Some client firmware and software support automatic
      update mechanisms, and some do not.  For those that do not, the
      /firmware PC provides a mechanism for the infrastructure to inform
      the client that firmware and software updates [<a href="rfc4108.html" title='"Using Cryptographic Message Syntax (CMS) to Protect Firmware Packages"'>RFC4108</a>] are
      available.  Because updates do not always go as planned and
      because sometimes the server needs to know whether the firmware
      was received and processed, this PC also provides a mechanism to
      return errors and receipts.  The /firmware and /firmware/return
      PCs are defined in <a href="#section-6">Section 6</a>.

   o  /tamp - To control the TAs in client TA databases, servers use the
      /tamp PC to request that clients retrieve TAMP (Trust Anchor
      Management Protocol) query, update, and adjust packages [<a href="rfc5934.html" title='"Trust Anchor Management Protocol (TAMP)"'>RFC5934</a>],
      and clients use the /tamp/return PC to return TAMP responses,
      confirms, and errors [<a href="rfc5934.html" title='"Trust Anchor Management Protocol (TAMP)"'>RFC5934</a>].  The /tamp and /tamp/return PCs
      are defined in <a href="#section-7">Section 7</a>.

   This document also extends the /est/serverkeygen PC [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>] to
   support the following (see <a href="#section-8">Section 8</a>):

   o  Returning asymmetric key package receipts and errors [<a href="rfc7191.html" title='"Cryptographic Message Syntax (CMS) Key Package Receipt and Error Content Types"'>RFC7191</a>].

   o  Encapsulating returned asymmetric keys in additional CMS
      (Cryptographic Message Syntax) content types [<a href="rfc7193.html" title='"The application/cms Media Type"'>RFC7193</a>].

   o  Returning server-generated public key pairs encapsulated in
      PKCS #12 (Public Key Cryptography Standard #12) [<a href="rfc7292.html" title='"PKCS #12: Personal Information Exchange Syntax v1.1"'>RFC7292</a>].

   While the motivation is to provide packages to clients during
   enrollment so that they can perform securely after enrollment, the
   services defined in this specification can be used after enrollment.







<span class="grey">Turner                       Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Definitions"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Definitions</span>

   Familiarity with the following specifications is assumed:

   o  "Using Cryptographic Message Syntax (CMS) to Protect Firmware
      Packages" [<a href="rfc4108.html" title='"Using Cryptographic Message Syntax (CMS) to Protect Firmware Packages"'>RFC4108</a>]

   o  "Certificate Management over CMS (CMC)" [<a href="rfc5272.html" title='"Certificate Management over CMS (CMC)"'>RFC5272</a>]

   o  "Cryptographic Message Syntax (CMS) Encrypted Key Package Content
      Type" [<a href="rfc6032.html" title='"Cryptographic Message Syntax (CMS) Encrypted Key Package Content Type"'>RFC6032</a>]

   o  "Cryptographic Message Syntax (CMS)" [<a href="rfc5652.html" title='"Cryptographic Message Syntax (CMS)"'>RFC5652</a>]

   o  "Additional New ASN.1 Modules for the Cryptographic Message Syntax
      (CMS) and the Public Key Infrastructure Using X.509 (PKIX)"
      [<a href="rfc6268.html" title='"Additional New ASN.1 Modules for the Cryptographic Message Syntax (CMS) and the Public Key Infrastructure Using X.509 (PKIX)"'>RFC6268</a>]

   o  "Trust Anchor Management Protocol (TAMP)" [<a href="rfc5934.html" title='"Trust Anchor Management Protocol (TAMP)"'>RFC5934</a>]

   o  "Cryptographic Message Syntax (CMS) Content Constraints Extension"
      [<a href="rfc6010.html" title='"Cryptographic Message Syntax (CMS) Content Constraints Extension"'>RFC6010</a>]

   o  "Cryptographic Message Syntax (CMS) Symmetric Key Package Content
      Type" [<a href="rfc6031.html" title='"Cryptographic Message Syntax (CMS) Symmetric Key Package Content Type"'>RFC6031</a>]

   o  "Enrollment over Secure Transport" [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>]

   o  "Cryptographic Message Syntax (CMS) Key Package Receipt and Error
      Content Types" [<a href="rfc7191.html" title='"Cryptographic Message Syntax (CMS) Key Package Receipt and Error Content Types"'>RFC7191</a>]

   Also, familiarity with the CMS protecting content types signed-data
   and encrypted-data [<a href="rfc5652.html" title='"Cryptographic Message Syntax (CMS)"'>RFC5652</a>] is assumed.  The CMS encrypted key
   package is defined in [<a href="rfc6032.html" title='"Cryptographic Message Syntax (CMS) Encrypted Key Package Content Type"'>RFC6032</a>].

   In addition to the definitions found in [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>], the following
   definitions are used in this document:

   Agent: An entity that performs functions on behalf of a client.
      Agents can service a) one or more clients on the same network as
      the server, b) clients on non-IP-based networks, or c) clients
      that have a non-electronic air gap [<a href="rfc4949.html" title='"Internet Security Glossary, Version 2"'>RFC4949</a>] between themselves
      and the server.  Interactions between the agent and client in the
      last two cases are beyond the scope of this document.  Before an
      agent can service clients, the agent must have a trust
      relationship with the server (i.e., be authorized to act on behalf
      of clients).




<span class="grey">Turner                       Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   Client: A device that ultimately consumes and uses the packages to
      enable communications.  In other words, the client is the endpoint
      for the packages, and an agent may have one or more clients.  To
      avoid confusion, this document henceforth uses the term "client"
      to refer to both agents and clients.

   Package: An object that contains one or more content types.  There
      are numerous types of packages, e.g., packages for asymmetric
      keys, symmetric keys, encrypted keys, CRLs, firmware, and TAMP.
      See <a href="#section-2.1.1">Section 2.1.1</a>.  All of these packages are digitally signed by
      their creator and encapsulated in a CMS signed-data [<a href="rfc5652.html" title='"Cryptographic Message Syntax (CMS)"'>RFC5652</a>]
      [<a href="rfc6268.html" title='"Additional New ASN.1 Modules for the Cryptographic Message Syntax (CMS) and the Public Key Infrastructure Using X.509 (PKIX)"'>RFC6268</a>] (except the public key certificates and CRLs that are
      already digitally signed by a CA): firmware receipts and errors;
      TAMP responses, confirms, and errors; and "key package" receipts
      and errors that can be optionally signed.  Certificates and CRLs
      are included in a package that uses signed-data, which is often
      referred to as a "degenerate CMS", or as a "certs-only" [<a href="rfc5751.html" title='"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.2 Message Specification"'>RFC5751</a>]
      [<a href="rfc6268.html" title='"Additional New ASN.1 Modules for the Cryptographic Message Syntax (CMS) and the Public Key Infrastructure Using X.509 (PKIX)"'>RFC6268</a>] or "crls-only" message (see <a href="#section-4.2">Section 4.2</a>), but no
      signature or content is present -- hence the names "certs-only"
      and "crls-only".

      Note: As per [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>], the creator may or may not be the EST
      server or the EST CA.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Authentication%20and%20Authorization"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Authentication and Authorization</span>

   Client and server authentication as well as client and server
   authorization are as defined in [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>].  The requirements for each
   are discussed in the "request" and "response" sections (e.g.,
   Sections <a href="#section-3.1">3.1</a> and <a href="#section-3.2">3.2</a> of this document) of each of the PCs defined
   herein.

   The requirements for the TA databases are as specified in [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>]
   as well.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20TLS%20Cipher%20Suites"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  TLS Cipher Suites</span>

   TLS (Transport Layer Security) cipher suites and issues associated
   with them are as defined in [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.4.%20%20URI%20Configuration"></a><a class="selflink" href="#section-1.4" name="section-1.4">1.4</a>.  URI Configuration</span>

   As specified in <a href="rfc7030.html#section-3.1">Section 3.1 of [RFC7030]</a>, the client is configured
   with sufficient information to form the server URI [<a href="rfc3986.html" title='"Uniform Resource Identifier (URI): Generic Syntax"'>RFC3986</a>].  Like
   EST, this configuration mechanism is beyond the scope of this
   document.





<span class="grey">Turner                       Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.5.%20%20Message%20Types"></a><a class="selflink" href="#section-1.5" name="section-1.5">1.5</a>.  Message Types</span>

   This document uses existing media types for the messages as specified
   by "Internet X.509 Public Key Infrastructure Operational Protocols:
   FTP and HTTP" [<a href="rfc2585.html" title='"Internet X.509 Public Key Infrastructure Operational Protocols: FTP and HTTP"'>RFC2585</a>], "The application/pkcs10 Media Type"
   [<a href="rfc5967.html" title='"The application/pkcs10 Media Type"'>RFC5967</a>], and "Certificate Management over CMS (CMC)" [<a href="rfc5272.html" title='"Certificate Management over CMS (CMC)"'>RFC5272</a>].

   For consistency with [<a href="rfc5273.html" title='"Certificate Management over CMS (CMC): Transport Protocols"'>RFC5273</a>], each distinct EST message type uses
   an HTTP Content-Type header with a specific media type.

   The EST messages, their corresponding media types for each operation,
   and the sections that provide request and response information are as
   follows:

 +-------------------+---------------------------------+---------------+
 | Message type      | Request media type              | Request       |
 |                   | Response media type(s)          | Response      |
 | (per operation)   | Source(s) of types              |               |
 +===================+=================================+===============+
 | Locate Available  | N/A                             | <a href="#section-2.2">Section 2.2</a>   |
 | Packages          | application/xml or              | <a href="#section-2.3">Section 2.3</a>   |
 |                   | application/json                |               |
 |                   | [<a href="rfc7303.html" title='"XML Media Types"'>RFC7303</a>] [<a href="rfc8259.html" title='"The JavaScript Object Notation (JSON) Data Interchange Format"'>RFC8259</a>]             |               |
 | /pal              |                                 |               |
 +===================+=================================+===============+
 | Distribute EE     | N/A                             | <a href="#section-3.1">Section 3.1</a>   |
 | Certificates      | application/pkcs7-mime          | <a href="#section-3.2">Section 3.2</a>   |
 |                   | [<a href="rfc5751.html" title='"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.2 Message Specification"'>RFC5751</a>]                       |               |
 | /eecerts          |                                 |               |
 +===================+=================================+===============+
 | Distribute CRLs   | N/A                             | <a href="#section-4.1">Section 4.1</a>   |
 |                   | application/pkcs7-mime          | <a href="#section-4.2">Section 4.2</a>   |
 |                   | [<a href="rfc5751.html" title='"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.2 Message Specification"'>RFC5751</a>]                       |               |
 | /crls             |                                 |               |
 +===================+=================================+===============+
 | Symmetric Key     | N/A                             | <a href="#section-5.1.1">Section 5.1.1</a> |
 | Distribution      | application/cms                 | <a href="#section-5.1.2">Section 5.1.2</a> |
 |                   | [<a href="rfc7193.html" title='"The application/cms Media Type"'>RFC7193</a>]                       |               |
 | /symmetrickeys    |                                 |               |
 +===================+=================================+===============+
 | Return Symmetric  | application/cms                 | <a href="#section-5.2.1">Section 5.2.1</a> |
 | Key               | N/A                             | <a href="#section-5.2.2">Section 5.2.2</a> |
 | Receipts/Errors   | [<a href="rfc7193.html" title='"The application/cms Media Type"'>RFC7193</a>]                       |               |
 |                   |                                 |               |
 | /symmetrickeys/   |                                 |               |
 |    return         |                                 |               |





<span class="grey">Turner                       Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


 +===================+=================================+===============+
 | Firmware          | N/A                             | <a href="#section-6.1.1">Section 6.1.1</a> |
 | Distribution      | application/cms                 | <a href="#section-6.1.2">Section 6.1.2</a> |
 |                   | [<a href="rfc7193.html" title='"The application/cms Media Type"'>RFC7193</a>]                       |               |
 | /firmware         |                                 |               |
 +===================+=================================+===============+
 | Return Firmware   | application/cms                 | <a href="#section-6.2.1">Section 6.2.1</a> |
 | Receipts/Errors   | N/A                             | <a href="#section-6.2.2">Section 6.2.2</a> |
 |                   | [<a href="rfc7193.html" title='"The application/cms Media Type"'>RFC7193</a>]                       |               |
 | /firmware/return  |                                 |               |
 +===================+=================================+===============+
 | Trust Anchor      | N/A                             | <a href="#section-7.1.1">Section 7.1.1</a> |
 | Management        | application/                    | <a href="#section-7.1.2">Section 7.1.2</a> |
 |                   |   tamp-status-query             |               |
 |                   |   tamp-update                   |               |
 |                   |   tamp-apex-update              |               |
 |                   |   tamp-community-update         |               |
 |                   |   tamp-sequence-adjust          |               |
 |                   | [<a href="rfc5934.html" title='"Trust Anchor Management Protocol (TAMP)"'>RFC5934</a>]                       |               |
 | /tamp             |                                 |               |
 +===================+=================================+===============+
 | Return TAMP       | application/                    | <a href="#section-7.2.1">Section 7.2.1</a> |
 | Responses/        |   tamp-status-response          |               |
 | Confirms/         |   tamp-update-confirm           |               |
 | Errors            |   tamp-apex-update-confirm      |               |
 |                   |   tamp-community-update-confirm |               |
 |                   |   tamp-sequence-adjust-confirm  |               |
 |                   |   tamp-error                    |               |
 |                   | N/A                             | <a href="#section-7.2.2">Section 7.2.2</a> |
 |                   | [<a href="rfc5934.html" title='"Trust Anchor Management Protocol (TAMP)"'>RFC5934</a>]                       |               |
 | /tamp/return      |                                 |               |
 +===================+=================================+===============+
 | Server-Side Key   | application/pkcs10 with         | <a href="#section-8.1">Section 8.1</a>   |
 | Generation        | content type attribute          |               |
 |                   | CSR*                            |               |
 |                   | application/cms                 | <a href="#section-8.1">Section 8.1</a>   |
 | /serverkeygen     | [<a href="rfc5967.html" title='"The application/pkcs10 Media Type"'>RFC5967</a>] [<a href="rfc7193.html" title='"The application/cms Media Type"'>RFC7193</a>] [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>]   |               |














<span class="grey">Turner                       Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


 +===================+=================================+===============+
 | Return Asymmetric | application/cms                 | <a href="#section-8.2">Section 8.2</a>   |
 | Key               | N/A                             | <a href="#section-8.2">Section 8.2</a>   |
 | Receipts/Errors   | [<a href="rfc7193.html" title='"The application/cms Media Type"'>RFC7193</a>]                       |               |
 |                   |                                 |               |
 | /serverkeygen/    |                                 |               |
 |    return         |                                 |               |
 +===================+=================================+===============+
 | Server-Side Key   | application/pkcs10              | <a href="#section-8.3.1">Section 8.3.1</a> |
 | Generation:       | application/pkcs12              | <a href="#section-8.3.2">Section 8.3.2</a> |
 | PKCS #12          | [<a href="rfc5967.html" title='"The application/pkcs10 Media Type"'>RFC5967</a>] [<a href="rfc7193.html" title='"The application/cms Media Type"'>RFC7193</a>] [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>]   |               |
 |                   |                                 |               |
 | /serverkeygen     |                                 |               |
 +===================+=================================+===============+

    * Certificate Signing Request

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.6.%20%20Key%20Words"></a><a class="selflink" href="#section-1.6" name="section-1.6">1.6</a>.  Key Words</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   <a href="https://tools.ietf.org/html/bcp14">BCP 14</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>] [<a href="rfc8174.html" title='"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"'>RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Locate%20Available%20Packages"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Locate Available Packages</span>

   The PAL (Package Availability List) is either an XML (Extensible
   Markup Language) [<a href="#ref-XML" title='"Extensible Markup Language (XML) 1.0 (Fifth Edition)"'>XML</a>] or JSON (JavaScript Object Notation) [<a href="rfc8259.html" title='"The JavaScript Object Notation (JSON) Data Interchange Format"'>RFC8259</a>]
   object available through the /pal PC, which furnishes the following
   information to clients:

   o  Advertisements for available packages that can be retrieved from
      the server;

   o  Notifications to begin public key certificate management or to
      return package receipts and errors; and

   o  Advertisement for another PAL.

   After being configured (see <a href="#section-1.4">Section 1.4</a>), the client can use this
   service to retrieve its PAL (see <a href="#section-2.1">Section 2.1</a>), which, if properly
   constructed (see <a href="#section-2.3">Section 2.3</a>), allows the client to determine some or
   all of the security-related packages needed for bootstrapping.  Each
   PAL entry refers to other PCs (as defined in this document and in
   [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>]) that clients use to a) retrieve packages that are
   available to them (e.g., CA certificates, firmware, trust anchors,
   symmetric keys, and asymmetric keys) or b) receive notifications to



<span class="grey">Turner                       Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   initiate public key certificate enrollment.  PAL entries can also be
   used to notify clients that they are to return receipts or errors for
   certain packages (see <a href="#section-2.1.1">Section 2.1.1</a>).  Placing these entries after
   entries that clients used to retrieve the packages is the same as
   requesting receipts in the originally distributed package.  Figure 1
   provides a ladder diagram for the /pal PC protocol flow.  <a href="#appendix-A">Appendix A</a>
   provides a detailed example.

                           |                      |
                 Client    |     Establish TLS    |    Server
                           |        Session       |
                           |&lt;--------------------&gt;|
                           |                      |
                           |          Request PAL |
                           |   (HTTP GET Request) |
                           |---------------------&gt;|
                           |&lt;---------------------|
                           | Deliver PAL          |
                           | (HTTP GET Response)  |
                           |                      |
                           | Request package by   |
                           | specified URI        |
                           | (HTTP GET or POST    |
                           |  Request)            |
                           |---------------------&gt;|
                           |&lt;---------------------|
                           | Deliver requested    |
                           | CMS package product  |
                           | (HTTP GET or POST    |
                           |  Response)           |
                           |                      |

                             Repeat as necessary.

                      Figure 1: /pal Message Sequence

   PALs are designed to support an arbitrary number of entries, but for
   PALs that need to be divided for any reason, there is a special PAL
   entry type that constitutes a collection of "PAL package types".
   Package type 0001 ("Additional PAL value present") refers to another
   PAL.  See Sections <a href="#section-2.1">2.1</a> and <a href="#section-2.1.1">2.1.1</a>.  If present, the 0001 package type
   is always last because other entries after it are ignored.  Also, in
   order to avoid needlessly dereferencing URIs, the 0001 package type
   cannot be the only PAL entry.  In addition to using the PAL during
   bootstrapping, clients can be configured to periodically poll the
   server to determine if updated packages are available for them.  Note
   that the mechanism to configure how often clients poll the server is
   beyond the scope of this document.  However, there are some services



<span class="grey">Turner                       Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   that support indicating when a client should retry its request (e.g.,
   simple enrollment and re-enroll responses include the Retry-After
   header [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>]).

   As noted earlier, the PAL supports two variants: XML and JSON.
   Clients include the HTTP Accept header [<a href="rfc7231.html" title='"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"'>RFC7231</a>] when they connect to
   the server to indicate whether they support XML or JSON.

   The client MUST authenticate the server as specified in [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>],
   and the client MUST check the server's authorization as specified in
   [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>].

   The server MUST authenticate the client as specified in [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>],
   and the server MUST check the client's authorization as specified in
   [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>].

   PAL support is OPTIONAL.  It is shown in figures throughout this
   document, but clients need not support the PAL to access services
   offered by the server.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20PAL%20Format"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  PAL Format</span>

   Each PAL is composed of zero or more entries.  Each entry is composed
   of four fields -- type, date, size, and info -- whose semantics
   follow:

   Note: Both XML elements and JSON values are described below.  XML
   elements are enclosed in angle brackets (&lt;&gt;), and JSON values are
   enclosed in single quotes ('').  When described together, they are
   enclosed in square brackets ([]) separated by a vertical bar (|).

   o  [&lt;type&gt; | 'type'] uniquely identifies each package that a client
      may retrieve from the server with a 4-digit string.
      [&lt;type&gt; | 'type'] MUST be present.  The PAL package types are
      defined in <a href="#section-2.1.1">Section 2.1.1</a>.

   o  [&lt;date&gt; | 'date'] indicates one of the following:

      *  The date and time that the client last successfully downloaded
         the identified package from the server.  [&lt;date&gt; | 'date'] MUST
         be represented as Generalized Time with 20 characters:
         YYYY-MM-DDTHH:MM:SSZ; &lt;date&gt; matches the dateTime production in
         "canonical representation" [<a href="#ref-XMLSCHEMA">XMLSCHEMA</a>]; 'date' is a string.
         Implementations SHOULD NOT rely on time resolution finer than
         seconds and MUST NOT generate time instants that specify
         leap seconds.





<span class="grey">Turner                       Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


      *  The omission of [&lt;date&gt; | 'date'] indicates the following:

         -  There is no indication that the client has successfully
            downloaded the identified package, or

         -  The PAL entry corresponds to a pointer to the next PAL, or
            the server is requesting a package from the client (e.g.,
            certification request, receipt, error).

   o  [&lt;size&gt; | 'size'] indicates the size in bytes of the package;
      &lt;size&gt; is a nonNegativeInteger, and 'size' is a number.  A package
      size of zero (i.e., "0" without the quotes) indicates that the
      client needs to begin a transaction, return an error, or return a
      receipt.  [&lt;size&gt; | 'size'] MUST be present.

   o  [&lt;info&gt; | 'info'] provides an SKI (Subject Key Identifier), a DN
      (Distinguished Name), an Issuer and Serial Number tuple, or a URI,
      i.e., it is a choice between these four items, all of which are
      defined in [<a href="rfc5280.html" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>].  When a URI [<a href="rfc3986.html" title='"Uniform Resource Identifier (URI): Generic Syntax"'>RFC3986</a>] is included,
      [&lt;uri&gt; | 'uri'] indicates the location where the identified
      package can be retrieved.  When a DN, an SKI, or an Issuer Name
      and Serial Number tuple is included, it points to a certificate
      that is the subject of the notification (i.e., the certificate to
      be rekeyed or renewed); [&lt;dn&gt; | 'dn'] is encoded as a string with
      the format defined in [<a href="rfc4514.html" title='"Lightweight Directory Access Protocol (LDAP): String Representation of Distinguished Names"'>RFC4514</a>]; &lt;ski&gt; is a hexBinary, and 'ski'
      is a string of hex digits (i.e., 0-9, a-f, and A-F);
      [&lt;iasn&gt; | 'iasn'] includes both [&lt;issuer&gt; | 'issuer'] and
      [&lt;serial&gt; | 'serial'] as a complexType in XML and an object in
      JSON.  [&lt;issuer&gt; | 'issuer'] is a DN encoded as a string with the
      format defined in [<a href="rfc4514.html" title='"Lightweight Directory Access Protocol (LDAP): String Representation of Distinguished Names"'>RFC4514</a>]; &lt;serial&gt; is a positiveInteger, and
      'serial' is a number.  [&lt;info&gt; | 'info'] MUST be present, and
      [&lt;info&gt; | 'info'] MUST include exactly one [&lt;dn&gt; | 'dn'],
      [&lt;ski&gt; | 'ski'], [&lt;iasn&gt; | 'iasn'], or [&lt;uri&gt; | 'uri'].

   Clients are often limited by the size of objects they can consume;
   the PAL is not immune to these limitations.  As opposed to picking a
   limit for all clients, a special package type (0001) is defined (see
   <a href="#section-2.1.1">Section 2.1.1</a>) to indicate that another PAL is available.  Servers
   can use this value to limit the size of the PALs provided to clients.
   The mechanism for servers to know client PAL size limits is beyond
   the scope of this document; one possible solution is through
   provisioned information.









<span class="grey">Turner                       Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.1.%20%20PAL%20Package%20Types"></a><a class="selflink" href="#section-2.1.1" name="section-2.1.1">2.1.1</a>.  PAL Package Types</span>

   Table 1 lists the PAL package types that are defined by this
   document:

   Package    Package Description
   Number
   --------   ---------------------------------------------------
   0000       Reserved
   0001       Additional PAL value present
   0002       X.509 CA certificate
   0003       X.509 EE certificate
   0004       X.509 ARL
   0005       X.509 CRL
   0006       Start DS certificate enrollment with CSR attribute
   0007       Start DS certificate enrollment
   0008       DS certificate enrollment (success)
   0009       DS certificate enrollment (failure)
   0010       Start DS certificate re-enrollment
   0011       DS certificate re-enrollment (success)
   0012       DS certificate re-enrollment (failure)
   0013       Start KE certificate enrollment with CSR attribute
   0014       Start KE certificate enrollment
   0015       KE certificate enrollment (success)
   0016       KE certificate enrollment (failure)
   0017       Start KE certificate re-enrollment
   0018       KE certificate re-enrollment (success)
   0019       KE certificate re-enrollment (failure)
   0020       Asymmetric Key Package (PKCS #8)
   0021       Asymmetric Key Package (CMS)
   0022       Asymmetric Key Package (PKCS #12)
   0023       Asymmetric Key Package Receipt or Error
   0024       Symmetric Key Package
   0025       Symmetric Key Package Receipt or Error
   0026       Firmware Package
   0027       Firmware Package Receipt or Error
   0028       TAMP Status Query
   0029       TAMP Status Query Response or Error
   0030       Trust Anchor Update
   0031       Trust Anchor Update Confirm or Error
   0032       Apex Trust Anchor Update
   0033       Apex Trust Anchor Update Confirm or Error
   0034       Community Update
   0035       Community Update Confirm or Error
   0036       Sequence Number Adjust
   0037       Sequence Number Adjust Confirm or Error

                        Table 1: PAL Package Types



<span class="grey">Turner                       Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   Note: "CSR" is Certificate Signing Request, "DS" is Digital
   Signature, and "KE" is Key Establishment.

   PAL package types are essentially hints about the type of package the
   client is about to retrieve or is asked to return.  Savvy clients can
   parse the packages to determine what has been provided, but in some
   instances it is better to know before retrieving the package.  The
   hint provided here does not obviate the need for clients to check the
   type of package provided before they store it, possibly in specially
   allocated locations (i.e., some clients might store Root ARLs
   separately from intermediate CRLs).  For packages provided by the
   client, the server is asking the client to provide an enrollment
   package, receipt, response, confirm, or error.

   The PAL package types have the following meanings:

   Note: The semantics behind Codes 0002 and 0006-0021 are defined in
   [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>].

   0000 Reserved: Reserved for future use.

   0001 Additional PAL value present: Indicates that this PAL entry
        refers to another PAL by referring to another /pal URI, which is
        defined in this section.  This PAL package type limits the size
        of PALs to a more manageable size for clients.  If this PAL
        package type appears, it MUST be the last entry in the PAL.

        Additionally, in order to avoid needlessly dereferencing URIs,
        this PAL package type MUST NOT be the only entry.

   0002 X.509 CA certificate: Indicates that one or more CA certificates
        [<a href="rfc5280.html" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>] are available for the client by pointing to a
        /cacerts URI, which is defined in [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>].

   0003 X.509 EE certificate: Indicates that one or more EE certificates
        [<a href="rfc5280.html" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>] are available for the client by pointing to an
        /eecerts URI, which is defined in <a href="#section-3">Section 3</a>.

   0004 X.509 ARL: Indicates that one or more ARLs (Authority Revocation
        Lists) [<a href="rfc5280.html" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>] are available for the client by pointing to a
        /crls URI, which is defined in <a href="#section-4">Section 4</a>.

   0005 X.509 CRL: Indicates that one or more CRLs (Certificate
        Revocation Lists) [<a href="rfc5280.html" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>] are available for the client by
        pointing to a /crls URI, which is defined in <a href="#section-4">Section 4</a>.






<span class="grey">Turner                       Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   Note: See <a href="#section-9">Section 9</a> for additional information about PAL and
   certificate enrollment interaction.  See <a href="#appendix-B">Appendix B</a> for additional
   informative information.

   0006 Start DS certificate enrollment with CSR: Indicates that the
        client needs to begin enrolling its DS certificate (i.e., any
        certificate for which the key usage extension will have a
        digital signature set), using a template provided by the server
        with a CSR (Certificate Signing Request) attribute (see
        <a href="#appendix-B">Appendix B</a>).  The PAL entry points to a /csrattrs URI, which is
        defined in [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>].

   0007 Start DS certificate enrollment: Indicates that the client needs
        to begin enrolling its DS certificate.  The PAL entry points to
        a /simpleenroll URI, which is defined in [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>].

   0008 DS certificate enrollment (success): Indicates that the client
        needs to retrieve a successful certification response.  The PAL
        entry points to a /simpleenroll or a /fullcmc URI, both of which
        are defined in [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>].

   0009 DS certificate enrollment (failure): Indicates that the client
        needs to retrieve a failed certification response for a DS
        certificate.  This PAL entry points to a /simpleenroll or a
        /fullcmc URI.

   0010 Start DS certificate re-enrollment: Indicates that the client
        needs to rekey or renew a DS certificate.  The PAL entry points
        to a /simplereenroll or a /fullcmc URI.

   0011 DS certificate re-enrollment (success): See PAL package
        type 0008.

   0012 DS certificate re-enrollment (failure): See PAL package
        type 0009.

   Note: The KE (Key Establishment) responses that follow use the same
   URIs as DS certificates, except that the certificates' key usage
   extension is set to only key agreement or key transport.

   0013 Start KE certificate enrollment with CSR: See PAL package
        type 0006.

   0014 Start KE certificate enrollment: See PAL package type 0007.

   0015 KE certificate enrollment (success): See PAL package type 0008.

   0016 KE certificate enrollment (failure): See PAL package type 0009.



<span class="grey">Turner                       Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   0017 Start KE certificate re-enrollment: See PAL package type 0010.

   0018 KE certificate re-enrollment (success): See PAL package
        type 0008.

   0019 KE certificate re-enrollment (failure): See PAL package
        type 0009.

   Note: The variations in the asymmetric key packages are due to the
   number of CMS content types that can be used to protect the
   asymmetric key; the syntax for the asymmetric key is the same, but
   additional ASN.1 is needed to include it in a signed-data (i.e., the
   ASN.1 needs to be a CMS content type and not the private key info
   type).  See <a href="#section-8">Section 8</a> of this document for additional information.

   0020 Asymmetric Key Package (PKCS #8): Indicates that an asymmetric
        key generated by the server is available for the client; the
        package is an asymmetric key without additional encryption as
        specified in <a href="rfc7030.html#section-4.4.2">Section 4.4.2 of [RFC7030]</a>.  The PAL entry points
        to a /serverkeygen or a /fullcmc URI, which are defined in
        [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>].

   0021 Asymmetric Key Package (CMS): See PAL package type 0020 (the
        difference being that the package available is an asymmetric key
        package [<a href="rfc5958.html" title='"Asymmetric Key Packages"'>RFC5958</a>] that is signed and encapsulated in a
        signed-data content type, as specified in <a href="rfc7030.html#section-4.4.2">Section 4.4.2 of
        [RFC7030]</a>).  Also, see <a href="#section-8.1">Section 8.1</a> of this document.

   0022 Asymmetric Key Package (PKCS #12): See PAL package type 0020
        (the difference being that the package available is the PKCS #12
        [<a href="rfc7292.html" title='"PKCS #12: Personal Information Exchange Syntax v1.1"'>RFC7292</a>] content type).  See <a href="#section-8.3">Section 8.3</a> of this document.

   0023 Asymmetric Key Package Receipt or Error: Indicates that the
        server wants the client to return a key package receipt or error
        [<a href="rfc7191.html" title='"Cryptographic Message Syntax (CMS) Key Package Receipt and Error Content Types"'>RFC7191</a>] to the /serverkeygen/return URI, which is defined in
        <a href="#section-8">Section 8</a>.

   0024 Symmetric Key Package: Indicates that a symmetric key package
        [<a href="rfc6031.html" title='"Cryptographic Message Syntax (CMS) Symmetric Key Package Content Type"'>RFC6031</a>] is available for the client by pointing to a
        /symmetrickeys URI, which is defined in <a href="#section-5">Section 5</a>.

   0025 Symmetric Key Package Receipt or Error: Indicates that the
        server wants the client to return a key package receipt or error
        [<a href="rfc7191.html" title='"Cryptographic Message Syntax (CMS) Key Package Receipt and Error Content Types"'>RFC7191</a>] to the /symmetrickeys/return URI, which is defined in
        <a href="#section-5">Section 5</a>.






<span class="grey">Turner                       Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   0026 Firmware Package: Indicates that a firmware package [<a href="rfc4108.html" title='"Using Cryptographic Message Syntax (CMS) to Protect Firmware Packages"'>RFC4108</a>] is
        available for the client, using the /firmware URI, which is
        defined in <a href="#section-6">Section 6</a>.

   0027 Firmware Package Receipt or Error: Indicates that the server
        wants the client to return a firmware package load receipt or
        error [<a href="rfc4108.html" title='"Using Cryptographic Message Syntax (CMS) to Protect Firmware Packages"'>RFC4108</a>] to the /firmware/return URI, which is defined in
        <a href="#section-6">Section 6</a>.

   Note: The /tamp and tamp/return URIs are defined in <a href="#section-7">Section 7</a>.

   0028 TAMP Status Query: Indicates that a TAMP Status Query package
        [<a href="rfc5934.html" title='"Trust Anchor Management Protocol (TAMP)"'>RFC5934</a>] is available for the client, using the /tamp URI.

   0029 TAMP Status Query Response or Error: Indicates that the server
        wants the client to return a TAMP Status Query Response or Error
        [<a href="rfc5934.html" title='"Trust Anchor Management Protocol (TAMP)"'>RFC5934</a>] to the /tamp/return URI.

   0030 Trust Anchor Update: Indicates that a Trust Anchor Update
        package [<a href="rfc5934.html" title='"Trust Anchor Management Protocol (TAMP)"'>RFC5934</a>] is available for the client, using the /tamp
        URI.

   0031 Trust Anchor Update Confirm or Error: Indicates that the server
        wants the client to return a Trust Anchor Update Confirm or
        Error [<a href="rfc5934.html" title='"Trust Anchor Management Protocol (TAMP)"'>RFC5934</a>] to the /tamp/return URI.

   0032 Apex Trust Anchor Update: Indicates that an Apex Trust Anchor
        Update package [<a href="rfc5934.html" title='"Trust Anchor Management Protocol (TAMP)"'>RFC5934</a>] is available for the client, using the
        /tamp URI.

   0033 Apex Trust Anchor Update Confirm or Error: Indicates that the
        server wants the client to return an Apex Trust Anchor Update
        Confirm or Error [<a href="rfc5934.html" title='"Trust Anchor Management Protocol (TAMP)"'>RFC5934</a>] to the /tamp/return URI.

   0034 Community Update: Indicates that a Community Update package
        [<a href="rfc5934.html" title='"Trust Anchor Management Protocol (TAMP)"'>RFC5934</a>] is available for the client, using the /tamp URI.

   0035 Community Update Confirm or Error: Indicates that the server
        wants the client to return a Community Update Confirm or Error
        [<a href="rfc5934.html" title='"Trust Anchor Management Protocol (TAMP)"'>RFC5934</a>] to the /tamp/return URI.

   0036 Sequence Number Adjust: Indicates that a Sequence Number Adjust
        package [<a href="rfc5934.html" title='"Trust Anchor Management Protocol (TAMP)"'>RFC5934</a>] is available for the client, using the /tamp
        URI.

   0037 Sequence Number Adjust Confirm or Error: Indicates that the
        server wants the client to return a Sequence Number Adjust
        Confirm or Error [<a href="rfc5934.html" title='"Trust Anchor Management Protocol (TAMP)"'>RFC5934</a>] to the /tamp/return URI.



<span class="grey">Turner                       Standards Track                   [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.2.%20%20PAL%20XML%20Schema"></a><a class="selflink" href="#section-2.1.2" name="section-2.1.2">2.1.2</a>.  PAL XML Schema</span>

   The namespace is specified in <a href="#section-11.1">Section 11.1</a>.  The fields in the schema
   were discussed earlier, in Sections <a href="#section-2.1">2.1</a> and <a href="#section-2.1.1">2.1.1</a>.

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;
   &lt;xsd:schema xmlns:xsd="https://www.w3.org/2001/XMLSchema"
     xmlns:pal="urn:ietf:params:xml:ns:pal"
     targetNamespace="urn:ietf:params:xml:ns:pal"
     elementFormDefault="qualified" attributeFormDefault="unqualified"
     version="1.0"&gt;
     &lt;xsd:annotation&gt;
       &lt;xsd:documentation&gt;
         This schema defines the types and elements needed
         to retrieve client packages from the server or for the
         client to post packages to the server.
       &lt;/xsd:documentation&gt;
     &lt;/xsd:annotation&gt;

     &lt;!-- ===== Element Declarations ===== --&gt;

     &lt;xsd:element name="pal" type="pal:PAL" /&gt;

     &lt;!-- ===== Complex Data Element Type Definitions ===== --&gt;

     &lt;xsd:complexType name="PAL"&gt;
       &lt;xsd:annotation&gt;
         &lt;xsd:documentation&gt;
           This type defines the Package Availability List (PAL).
         &lt;/xsd:documentation&gt;
       &lt;/xsd:annotation&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="message" type="pal:PALEntry"
           minOccurs="0" maxOccurs="unbounded"&gt;
           &lt;xsd:annotation&gt;
             &lt;xsd:documentation&gt;
               This item contains information about the package
               and a link that the client uses to download or post
               the package.
             &lt;/xsd:documentation&gt;
           &lt;/xsd:annotation&gt;
         &lt;/xsd:element&gt;
       &lt;/xsd:sequence&gt;
     &lt;/xsd:complexType&gt;







<span class="grey">Turner                       Standards Track                   [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


     &lt;xsd:complexType name="PALEntry"&gt;
       &lt;xsd:annotation&gt;
         &lt;xsd:documentation&gt;
           This type defines a product in the PAL.
         &lt;/xsd:documentation&gt;
       &lt;/xsd:annotation&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="type" type="pal:PackageType" /&gt;
         &lt;xsd:element name="date" type="pal:GeneralizedTimeType"
           minOccurs="0" /&gt;
         &lt;xsd:element name="size" type="xsd:nonNegativeInteger"&gt;
           &lt;xsd:annotation&gt;
             &lt;xsd:documentation&gt;
               This item indicates the package's size.
             &lt;/xsd:documentation&gt;
           &lt;/xsd:annotation&gt;
         &lt;/xsd:element&gt;
         &lt;xsd:element name="info" type="pal:PackageInfoType" /&gt;
       &lt;/xsd:sequence&gt;
     &lt;/xsd:complexType&gt;

     &lt;xsd:complexType name="PackageInfoType"&gt;
       &lt;xsd:annotation&gt;
         &lt;xsd:documentation&gt;
           This type allows a choice of X.500 Distinguished Name,
           Subject Key Identifier, Issuer and Serial Number tuple,
           or URI.
         &lt;/xsd:documentation&gt;
       &lt;/xsd:annotation&gt;
       &lt;xsd:choice&gt;
         &lt;xsd:element name="dn"   type="pal:DistinguishedName" /&gt;
         &lt;xsd:element name="ski"  type="pal:SubjectKeyIdentifier" /&gt;
         &lt;xsd:element name="iasn" type="pal:IssuerAndSerialNumber" /&gt;
         &lt;xsd:element name="uri"  type="pal:ThisURI" /&gt;
       &lt;/xsd:choice&gt;
     &lt;/xsd:complexType&gt;















<span class="grey">Turner                       Standards Track                   [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


     &lt;xsd:complexType name="IssuerAndSerialNumber"&gt;
       &lt;xsd:annotation&gt;
         &lt;xsd:documentation&gt;
           This type holds the issuer Distinguished Name and
           serial number of a referenced certificate.
         &lt;/xsd:documentation&gt;
       &lt;/xsd:annotation&gt;
       &lt;xsd:sequence&gt;
         &lt;xsd:element name="issuer" type="pal:DistinguishedName" /&gt;
         &lt;xsd:element name="serial" type="xsd:positiveInteger" /&gt;
       &lt;/xsd:sequence&gt;
     &lt;/xsd:complexType&gt;

     &lt;!-- ===== Simple Data Element Type Definitions ===== --&gt;

     &lt;xsd:simpleType name="PackageType"&gt;
       &lt;xsd:annotation&gt;
         &lt;xsd:documentation&gt;
           This type identifies each package that a client may retrieve
           from the server with a 4-digit string.
         &lt;/xsd:documentation&gt;
       &lt;/xsd:annotation&gt;
       &lt;xsd:restriction base="xsd:string"&gt;
         &lt;xsd:pattern value="d{4}" /&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;xsd:simpleType name="GeneralizedTimeType"&gt;
       &lt;xsd:annotation&gt;
         &lt;xsd:documentation&gt;
           This type indicates the date and time (YYYY-MM-DDTHH:MM:SSZ)
           that the client last acknowledged successful receipt of the
           package; it is absent if a) there is no indication that the
           package has been downloaded or b) the PAL entry corresponds
           to a pointer to the next PAL.
         &lt;/xsd:documentation&gt;
       &lt;/xsd:annotation&gt;
       &lt;xsd:restriction base="xsd:dateTime"&gt;
         &lt;xsd:pattern value=".*:d{2}Z" /&gt;
         &lt;xsd:minInclusive value="2013-05-23T00:00:00Z" /&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;









<span class="grey">Turner                       Standards Track                   [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


     &lt;xsd:simpleType name="DistinguishedName"&gt;
       &lt;xsd:annotation&gt;
         &lt;xsd:documentation&gt;
           This type holds an X.500 Distinguished Name.
         &lt;/xsd:documentation&gt;
       &lt;/xsd:annotation&gt;
       &lt;xsd:restriction base="xsd:string"&gt;
         &lt;xsd:maxLength value="1024" /&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;xsd:simpleType name="SubjectKeyIdentifier"&gt;
       &lt;xsd:annotation&gt;
         &lt;xsd:documentation&gt;
           This type holds a hex string representing the value of a
           certificate's SubjectKeyIdentifier.
         &lt;/xsd:documentation&gt;
       &lt;/xsd:annotation&gt;
       &lt;xsd:restriction base="xsd:hexBinary"&gt;
         &lt;xsd:maxLength value="1024" /&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

     &lt;xsd:simpleType name="ThisURI"&gt;
       &lt;xsd:annotation&gt;
         &lt;xsd:documentation&gt;
           This type holds a URI but is length limited.
         &lt;/xsd:documentation&gt;
       &lt;/xsd:annotation&gt;
       &lt;xsd:restriction base="xsd:anyURI"&gt;
       &lt;xsd:maxLength value="1024" /&gt;
       &lt;/xsd:restriction&gt;
     &lt;/xsd:simpleType&gt;

   &lt;/xsd:schema&gt;
















<span class="grey">Turner                       Standards Track                   [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.3.%20%20PAL%20JSON%20Object"></a><a class="selflink" href="#section-2.1.3" name="section-2.1.3">2.1.3</a>.  PAL JSON Object</span>

   The following is an example PAL JSON object.  The fields in the
   object were discussed earlier, in Sections <a href="#section-2.1">2.1</a> and <a href="#section-2.1.1">2.1.1</a>.

   [
     {
       "type": "0003",
       "date": "2016-12-29T09:28:00Z",
       "size": 1234,
       "info":
        {
         "uri": "https://www.example.com/.well-known/est/eecerts/1234"
        }
     },

     {
       "type": "0006",
       "date": "2016-12-29T09:28:00Z",
       "size": 1234,
       "info":
        {
         "iasn":
          {
           "issuer": "CN=Sean Turner,O=sn3rd,C=US",
           "serial": 0
          }
        }
     }
   ]

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Request%20PAL"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Request PAL</span>

   Clients request their PAL with an HTTP GET [<a href="rfc7231.html" title='"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"'>RFC7231</a>], using an
   operation path of "/pal".  Clients indicate whether they would prefer
   XML or JSON by including the HTTP Accept header [<a href="rfc7231.html" title='"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"'>RFC7231</a>] with either
   "application/xml" or "application/json", respectively.














<span class="grey">Turner                       Standards Track                   [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20Provide%20PAL"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  Provide PAL</span>

   If the server has a PAL for the client, the server response MUST
   contain an HTTP 200 response code with a Content-Type of
   "application/xml" [<a href="rfc7303.html" title='"XML Media Types"'>RFC7303</a>] or "application/json" [<a href="rfc8259.html" title='"The JavaScript Object Notation (JSON) Data Interchange Format"'>RFC8259</a>].

   When the server constructs a PAL, an order of precedence for PAL
   offerings is based on the following rationale:

   o  /cacerts and /crls packages are the most important because they
      support validation decisions on certificates used to sign and
      encrypt other listed PAL items.

   o  /csrattrs are the next in importance, since they provide
      information that the server would like the client to include in
      its certificate enrollment request.

   o  /simpleenroll, /simplereenroll, and /fullcmc packages are next in
      importance, since they can impact a certificate used by the client
      to sign CMS content or a certificate to establish keys for
      encrypting content exchanged with the client.

      *  A client engaged in certificate management SHOULD accept and
         process CA-provided transactions as soon as possible to avoid
         undue delays that might lead to protocol failure.

   o  /symmetrickeys, /firmware, /tamp, and /eecerts packages containing
      keys and other types of products are last.  Precedence SHOULD be
      given to packages that the client has not previously downloaded.
      The items listed in a PAL may not identify all of the packages
      available for a device.  This can be for any of the following
      reasons:

      *  The server may temporarily withhold some outstanding PAL items
         to simplify client processing.

      *  If a CA has more than one certificate ready for the client, the
         server will provide a notice for one at a time.  Pending
         notices will be serviced in order, according to the date when
         the certificate will be used (earliest date first).

   When rejecting a request, the server specifies either an HTTP 4xx
   error or an HTTP 5xx error.

   All other return codes are handled as specified in <a href="rfc7030.html#section-4.2.3">Section 4.2.3 of
   [RFC7030]</a> (i.e., 202 handling and all other HTTP response codes).





<span class="grey">Turner                       Standards Track                   [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Distribute%20EE%20Certificates"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Distribute EE Certificates</span>

   Numerous mechanisms exist for clients to query repositories for
   certificates.  The service provided by the /eecerts PC is different
   in that it is not a general-purpose query for client certificates;
   instead, it allows the server to provide peer certificates to a
   client that the server knows through an out-of-band mechanism that
   the client will be communicating with.  For example, a router being
   provisioned that connects to two peers can be provisioned with not
   only its certificate but also with the peers' certificates.

   The server need not authenticate or authorize the client for
   distributing an EE certificate, because the package contents are
   already signed by a CA (i.e., the certificate(s) in a certs-only
   message has already been signed by a CA).  The message flow is
   similar to Figure 1, except that the connection need not be HTTPS:

                          |                      |
                Client    |    Establish TLS     |    Server
                          |       Session        |
                          |&lt;--------------------&gt;|
                          |                      |
                          |          Request PAL |
                          |   (HTTP GET Request) |
                          |---------------------&gt;|
                          |&lt;---------------------|
                          | Deliver PAL          |
                          | (HTTP GET Response)  |
                          |                      |
                          |   Request EE Cert(s) |
                          |   (HTTP GET Request) |
                          |---------------------&gt;|
                          |&lt;---------------------|
                          | Deliver EE Cert(s)   |
                          | (HTTP GET Response)  |
                          |                      |

                    Figure 2: /eecerts Message Sequence

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20EE%20Certificate%20Request"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  EE Certificate Request</span>

   Clients request EE certificates with an HTTP GET [<a href="rfc7231.html" title='"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"'>RFC7231</a>], using an
   operation path of "/eecerts".








<span class="grey">Turner                       Standards Track                   [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20EE%20Certificate%20Response"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  EE Certificate Response</span>

   The response and processing of the returned error codes are identical
   to what is described in <a href="rfc7030.html#section-4.1.3">Section 4.1.3 of [RFC7030]</a>, except that the
   certificate provided is not the one issued to the client; instead,
   one or more client's peer certificates are returned in the certs-only
   message.

   Clients MUST reject EE certificates that do not validate to an
   authorized TA.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Distribute%20CRLs%20and%20ARLs"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Distribute CRLs and ARLs</span>

   CRLs (and ARLs) are needed in many instances to perform certificate
   path validation [<a href="rfc5280.html" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>].  They can be obtained from repositories if
   their location is provided in the certificate.  However, the client
   needs to parse the certificate and perform an additional round trip
   to retrieve them.  Providing CRLs during bootstrapping obviates the
   need for the client to parse the certificate and aids those clients
   who might be unable to retrieve the CRL.  Clients are free to obtain
   CRLs on which they rely from sources other than the server (e.g., a
   local directory).  The /crls PC allows servers to distribute CRLs at
   the same time that clients retrieve their certificate(s) and CA
   certificate(s) as well as peer certificates.

   The server need not authenticate or authorize the client for
   distributing a CRL, because the package contents are already signed
   by a CA (i.e., the CRLs in a crls-only message have already been
   signed by a CA).  The message flow is as depicted in Figure 2 but
   with "CRL(s)" instead of "EE Cert(s)".

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20CRL%20Request"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  CRL Request</span>

   Clients request CRLs with an HTTP GET [<a href="rfc7231.html" title='"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"'>RFC7231</a>], using an operation
   path of "/crls".

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20CRL%20Response"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  CRL Response</span>

   The response, and the processing of that response, are identical to
   what is described in <a href="rfc7030.html#section-4.1.3">Section 4.1.3 of [RFC7030]</a>, except that instead
   of providing the issued certificate one of more CRLs are returned in
   the crls-only message.

   Clients MUST reject CRLs that do not validate to an authorized TA.







<span class="grey">Turner                       Standards Track                   [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Symmetric%20Keys%2C%20Receipts%2C%20and%20Errors"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Symmetric Keys, Receipts, and Errors</span>

   In addition to public keys, clients often need one or more symmetric
   keys to communicate with their peers.  The /symmetrickeys PC allows
   the server to distribute symmetric keys to clients.

   Distribution of keys does not always work as planned, and clients
   need a way to inform the server that something has gone wrong; they
   also need a way to inform the server, if asked, that the distribution
   process has successfully completed.  The /symmetrickeys/return PC
   allows clients to provide errors and receipts.

   Clients MUST authenticate the server, and clients MUST check the
   server's authorization.

   The server MUST authenticate clients, and the server MUST check the
   client's authorization.

   HTTP GET [<a href="rfc7231.html" title='"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"'>RFC7231</a>] is used when the server provides the key to the
   client (see <a href="#section-5.1">Section 5.1</a>), using the /symmetrickeys PC; HTTP POST
   [<a href="rfc7231.html" title='"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"'>RFC7231</a>] is used when the client provides a receipt (see
   <a href="#section-5.2">Section 5.2</a>) or an error (see <a href="#section-5.2">Section 5.2</a>) to the server with the
   /symmetrickeys/return PC.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Symmetric%20Keys"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Symmetric Keys</span>

   Servers use /symmetrickeys to provide symmetric keys to clients; the
   symmetric key package is defined in [<a href="rfc6031.html" title='"Cryptographic Message Syntax (CMS) Symmetric Key Package Content Type"'>RFC6031</a>].

   As with the /serverkeygen PC defined in [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>], the default method
   for distributing the symmetric key uses the encryption mode of the
   negotiated TLS cipher suite.  Keys are not protected by preferred
   key-wrapping methods such as AES Key Wrap [<a href="rfc3394.html" title='"Advanced Encryption Standard (AES) Key Wrap Algorithm"'>RFC3394</a>] or AES Key Wrap
   with Padding [<a href="rfc5649.html" title='"Advanced Encryption Standard (AES) Key Wrap with Padding Algorithm"'>RFC5649</a>], because encryption of the symmetric key
   beyond that provided by TLS is OPTIONAL.  Therefore, the cipher suite
   used to return the symmetric key MUST offer cryptographic strength
   that is commensurate with the symmetric key being delivered to the
   client.  The cipher suite used MUST NOT have the NULL encryption
   algorithm, as this will disclose the unprotected symmetric key.  It
   is strongly RECOMMENDED that servers always return encrypted
   symmetric keys.










<span class="grey">Turner                       Standards Track                   [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   The following depicts the protocol flow:

                         |                       |
               Client    |    Establish TLS      |    Server
                         |       Session         |
                         |&lt;---------------------&gt;|
                         |                       |
                         |          Request PAL  |
                         |   (HTTP GET Request)  |
                         |----------------------&gt;|
                         |&lt;----------------------|
                         | Deliver PAL           |
                         | (HTTP GET Response)   |
                         |                       |
                         |    Req Symmetric Key  |
                         |   (HTTP GET Request)  |
                         |----------------------&gt;|
                         |&lt;----------------------|
                         | Deliver Symmetric Key |
                         | (HTTP GET Response)   |
                         |                       |

                 Figure 3: /symmetrickeys Message Sequence

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.1.%20%20Distribute%20Symmetric%20Keys"></a><a class="selflink" href="#section-5.1.1" name="section-5.1.1">5.1.1</a>.  Distribute Symmetric Keys</span>

   Clients request the symmetric key from the server with an HTTP GET
   [<a href="rfc7231.html" title='"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"'>RFC7231</a>], using an operation path of "/symmetrickeys".

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.2.%20%20Symmetric%20Key%20Response"></a><a class="selflink" href="#section-5.1.2" name="section-5.1.2">5.1.2</a>.  Symmetric Key Response</span>

   If the request is successful, the server response MUST have an
   HTTP 200 response code with a Content-Type of "application/cms"
   [<a href="rfc7193.html" title='"The application/cms Media Type"'>RFC7193</a>].  The optional application/cms encapsulatingContent and
   innerContent parameters SHOULD be included with the Content-Type to
   indicate the protection afforded to the returned symmetric key.  The
   returned content varies:

   o  If additional encryption is not being employed, the content
      associated with application/cms is a DER-encoded [<a href="#ref-X.690" title='"Information technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"'>X.690</a>] symmetric
      key package.

   o  If additional encryption is employed, the content associated with
      application/cms is DER-encoded enveloped-data that encapsulates a
      signed-data that further encapsulates a symmetric key package.






<span class="grey">Turner                       Standards Track                   [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   o  If additional encryption and origin authentication are employed,
      the content associated with application/cms is a DER-encoded
      signed-data that encapsulates an enveloped-data that encapsulates
      a signed-data that further encapsulates a symmetric key package.

   o  If CCC (CMS Content Constraints) [<a href="rfc6010.html" title='"Cryptographic Message Syntax (CMS) Content Constraints Extension"'>RFC6010</a>] is supported, the
      content associated with application/cms is a DER-encoded encrypted
      key package [<a href="rfc6032.html" title='"Cryptographic Message Syntax (CMS) Encrypted Key Package Content Type"'>RFC6032</a>].  The encrypted key package provides three
      choices to encapsulate keys: EncryptedData, EnvelopedData, and
      AuthEnvelopedData.  Prior to employing one of these three
      encryption choices, the key package can be encapsulated in a
      signed-data.

   How the server knows whether the client supports the encrypted key
   package is beyond the scope of this document.

   When rejecting a request, the server specifies either an HTTP 4xx
   error or an HTTP 5xx error.

   If a symmetric key package (which might be signed) or an encrypted
   key package (which might be signed before and after encryption) is
   digitally signed, the client MUST reject it if the digital signature
   does not validate back to an authorized TA.

   Note: Absent a policy on the client side requiring a signature, a
   malicious EST server can simply strip the signature, thus bypassing
   that check.  In that case, this requirement is merely a sanity check,
   serving to detect mis-signed packages or misconfigured clients.

   [<a href="rfc3370.html" title='"Cryptographic Message Syntax (CMS) Algorithms"'>RFC3370</a>], [<a href="rfc5753.html" title='"Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)"'>RFC5753</a>], [<a href="rfc5754.html" title='"Using SHA2 Algorithms with Cryptographic Message Syntax"'>RFC5754</a>], [<a href="rfc6033.html" title='"Algorithms for Cryptographic Message Syntax (CMS) Encrypted Key Package Content Type"'>RFC6033</a>], [<a href="rfc6160.html" title='"Algorithms for Cryptographic Message Syntax (CMS) Protection of Symmetric Key Package Content Types"'>RFC6160</a>], and [<a href="rfc6161.html" title='"Elliptic Curve Algorithms for Cryptographic Message Syntax (CMS) Encrypted Key Package Content Type"'>RFC6161</a>]
   provide algorithm details for use when protecting the symmetric key
   package and encrypted key package.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Symmetric%20Key%20Receipts%20and%20Errors"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Symmetric Key Receipts and Errors</span>

   Clients use /symmetrickeys/return to provide symmetric key package
   receipts; the key package receipt content type is defined in
   [<a href="rfc7191.html" title='"Cryptographic Message Syntax (CMS) Key Package Receipt and Error Content Types"'>RFC7191</a>].  Clients can be configured to automatically return
   receipts after processing a symmetric key package, return receipts
   based on processing of the key-package-identifier-and-receipt-request
   attribute [<a href="rfc7191.html" title='"Cryptographic Message Syntax (CMS) Key Package Receipt and Error Content Types"'>RFC7191</a>], or return receipts when prompted by a PAL entry.

   Servers can indicate that clients return a receipt by including the
   key-package-identifier-and-receipt-request attribute in a signed-data
   as a signed attribute.  However, this attribute only appears when
   additional encryption is employed (see <a href="#section-5.1.2">Section 5.1.2</a>).





<span class="grey">Turner                       Standards Track                   [Page 29]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   Clients also use /symmetrickeys/return to return symmetric key
   package errors; the key package error content type is defined in
   [<a href="rfc7191.html" title='"Cryptographic Message Syntax (CMS) Key Package Receipt and Error Content Types"'>RFC7191</a>].  Clients can be configured to automatically return errors
   after processing a symmetric key package or based on a PAL entry.

   The following depicts the protocol flow:

                        |                      |
              Client    |    Establish TLS     |    Server
                        |       Session        |
                        |&lt;--------------------&gt;|
                        |                      |
                        |          Request PAL |
                        |   (HTTP GET Request) |
                        |---------------------&gt;|
                        |&lt;---------------------|
                        | Deliver PAL          |
                        | (HTTP GET Response)  |
                        |                      |
                        | Return Receipt/Error |
                        |  (HTTP POST Request) |
                        |---------------------&gt;|
                        |&lt;---------------------|
                        | (HTTP POST Response) |
                        | status code only     |
                        | no content           |
                        |                      |

             Figure 4: /symmetrickeys/return Message Sequence

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.1.%20%20Provide%20Symmetric%20Key%20Receipt%20or%20Error"></a><a class="selflink" href="#section-5.2.1" name="section-5.2.1">5.2.1</a>.  Provide Symmetric Key Receipt or Error</span>

   Clients return symmetric key receipts and errors to the server with
   an HTTP POST [<a href="rfc7231.html" title='"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"'>RFC7231</a>], using an operation path of
   "/symmetrickeys/return".  The returned content varies:

   o  The key package receipt is digitally signed [<a href="rfc7191.html" title='"Cryptographic Message Syntax (CMS) Key Package Receipt and Error Content Types"'>RFC7191</a>]; the
      Content-Type is "application/cms" [<a href="rfc7193.html" title='"The application/cms Media Type"'>RFC7193</a>]; and the associated
      content is signed-data, which encapsulates a key package receipt.

   o  If the key package error is not digitally signed, the Content-Type
      is "application/cms" and the associated content is a key package
      error.  If the key package error is digitally signed, the
      Content-Type is "application/cms" and the associated content is
      signed-data, which encapsulates a key package error.






<span class="grey">Turner                       Standards Track                   [Page 30]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   The optional application/cms encapsulatingContent and innerContent
   parameters SHOULD be included with the Content-Type to indicate the
   protection afforded to the receipt or error.

   [<a href="rfc3370.html" title='"Cryptographic Message Syntax (CMS) Algorithms"'>RFC3370</a>], [<a href="rfc5753.html" title='"Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)"'>RFC5753</a>], [<a href="rfc5754.html" title='"Using SHA2 Algorithms with Cryptographic Message Syntax"'>RFC5754</a>], and [<a href="rfc7192.html" title='"Algorithms for Cryptographic Message Syntax (CMS) Key Package Receipt and Error Content Types"'>RFC7192</a>] provide algorithm
   details for use when protecting the key package receipt or key
   package error.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.2.%20%20Symmetric%20Key%20Receipt%20or%20Error%20Response"></a><a class="selflink" href="#section-5.2.2" name="section-5.2.2">5.2.2</a>.  Symmetric Key Receipt or Error Response</span>

   If the client successfully provides a receipt or error, the server
   response has an HTTP 204 response code (i.e., no content is
   returned).

   When rejecting a request, the server specifies either an HTTP 4xx
   error or an HTTP 5xx error.

   If a key package receipt or key package error is digitally signed,
   the server MUST reject it if the digital signature does not validate
   back to an authorized TA.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Firmware%2C%20Receipts%2C%20and%20Errors"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Firmware, Receipts, and Errors</span>

   Servers can distribute object code for cryptographic algorithms and
   software with the firmware package [<a href="rfc4108.html" title='"Using Cryptographic Message Syntax (CMS) to Protect Firmware Packages"'>RFC4108</a>].

   Clients MUST authenticate the server, and clients MUST check the
   server's authorization.

   The server MUST authenticate the client, and the server MUST check
   the client's authorization.

   The /firmware PC uses an HTTP GET [<a href="rfc7231.html" title='"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"'>RFC7231</a>], and the /firmware/return
   PC uses an HTTP POST [<a href="rfc7231.html" title='"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"'>RFC7231</a>].  GET is used when the client
   retrieves firmware from the server (see <a href="#section-6.1">Section 6.1</a>); POST is used
   when the client provides a receipt (see <a href="#section-6.2">Section 6.2</a>) or an error (see
   <a href="#section-6.2">Section 6.2</a>).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Firmware"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Firmware</span>

   The /firmware URI is used by servers to provide firmware packages to
   clients.

   The message flow is as depicted in Figure 3 modulo replacing
   "Symmetric Key" with "Firmware Package".






<span class="grey">Turner                       Standards Track                   [Page 31]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.1.%20%20Distribute%20Firmware"></a><a class="selflink" href="#section-6.1.1" name="section-6.1.1">6.1.1</a>.  Distribute Firmware</span>

   Clients request firmware from the server with an HTTP GET [<a href="rfc7231.html" title='"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"'>RFC7231</a>],
   using an operation path of "/firmware".

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.2.%20%20Firmware%20Response"></a><a class="selflink" href="#section-6.1.2" name="section-6.1.2">6.1.2</a>.  Firmware Response</span>

   If the request is successful, the server response MUST have an
   HTTP 200 response code with a Content-Type of "application/cms"
   [<a href="rfc7193.html" title='"The application/cms Media Type"'>RFC7193</a>].  The optional encapsulatingContent and innerContent
   parameters SHOULD be included with the Content-Type to indicate the
   protection afforded to the returned firmware.  The returned content
   varies:

   o  If the firmware is unprotected, then the Content-Type is
      "application/cms" and the content is the DER-encoded [<a href="#ref-X.690" title='"Information technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"'>X.690</a>]
      firmware package.

   o  If the firmware is compressed, then the Content-Type is
      "application/cms" and the content is the DER-encoded [<a href="#ref-X.690" title='"Information technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"'>X.690</a>]
      compressed data that encapsulates the firmware package.

   o  If the firmware is encrypted, then the Content-Type is
      "application/cms" and the content is the DER-encoded [<a href="#ref-X.690" title='"Information technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"'>X.690</a>]
      encrypted-data that encapsulates the firmware package (which might
      be compressed prior to encryption).

   o  If the firmware is signed, then the Content-Type is
      "application/cms" and the content is the DER-encoded [<a href="#ref-X.690" title='"Information technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"'>X.690</a>]
      signed-data that encapsulates the firmware package (which might be
      compressed, encrypted, or compressed and then encrypted prior to
      signature).

   How the server knows whether the client supports the unprotected,
   signed, compressed, and/or encrypted firmware package is beyond the
   scope of this document.

   When rejecting a request, the server specifies either an HTTP 4xx
   error or an HTTP 5xx error.

   If a firmware package is digitally signed, the client MUST reject it
   if the digital signature does not validate back to an authorized TA.

   [<a href="rfc3370.html" title='"Cryptographic Message Syntax (CMS) Algorithms"'>RFC3370</a>], [<a href="rfc5753.html" title='"Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)"'>RFC5753</a>], and [<a href="rfc5754.html" title='"Using SHA2 Algorithms with Cryptographic Message Syntax"'>RFC5754</a>] provide algorithm details for use
   when protecting the firmware package.






<span class="grey">Turner                       Standards Track                   [Page 32]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Firmware%20Receipts%20and%20Errors"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Firmware Receipts and Errors</span>

   Clients use the /firmware/return PC to provide firmware package load
   receipts and errors [<a href="rfc4108.html" title='"Using Cryptographic Message Syntax (CMS) to Protect Firmware Packages"'>RFC4108</a>].  Clients can be configured to
   automatically return receipts and errors after processing a firmware
   package or based on a PAL entry.

   The message flow is as depicted in Figure 4 modulo the receipt or
   error is for a firmware package.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.2.1.%20%20Provide%20Firmware%20Receipt%20or%20Error"></a><a class="selflink" href="#section-6.2.1" name="section-6.2.1">6.2.1</a>.  Provide Firmware Receipt or Error</span>

   Clients return firmware receipts and errors to the server with an
   HTTP POST [<a href="rfc7231.html" title='"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"'>RFC7231</a>], using an operation path of "/firmware/return".
   The optional encapsulatingContent and innerContent parameters SHOULD
   be included with the Content-Type to indicate the protection afforded
   to the returned firmware receipt or error.  The returned content
   varies:

   o  If the firmware receipt is not digitally signed, the Content-Type
      is "application/cms" [<a href="rfc7193.html" title='"The application/cms Media Type"'>RFC7193</a>] and the content is the DER-encoded
      firmware receipt.

   o  If the firmware receipt is digitally signed, the Content-Type is
      "application/cms" and the content is the DER-encoded signed-data
      encapsulating the firmware receipt.

   o  If the firmware error is not digitally signed, the Content-Type is
      "application/cms" and the content is the DER-encoded firmware
      error.

   o  If the firmware error is digitally signed, the Content-Type is
      "application/cms" and the content is the DER-encoded signed-data
      encapsulating the firmware error.

   [<a href="rfc3370.html" title='"Cryptographic Message Syntax (CMS) Algorithms"'>RFC3370</a>], [<a href="rfc5753.html" title='"Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)"'>RFC5753</a>], and [<a href="rfc5754.html" title='"Using SHA2 Algorithms with Cryptographic Message Syntax"'>RFC5754</a>] provide algorithm details for use
   when protecting the firmware receipt or firmware error.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.2.2.%20%20Firmware%20Receipt%20or%20Error%20Response"></a><a class="selflink" href="#section-6.2.2" name="section-6.2.2">6.2.2</a>.  Firmware Receipt or Error Response</span>

   If the request is successful, the server response MUST have an
   HTTP 204 response code (i.e., no content is returned).

   When rejecting a request, the server MUST specify either an HTTP 4xx
   error or an HTTP 5xx error.






<span class="grey">Turner                       Standards Track                   [Page 33]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-34" id="page-34" name="page-34"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   If a firmware receipt or firmware error is digitally signed, the
   server MUST reject it if the digital signature does not validate back
   to an authorized TA.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Trust%20Anchor%20Management%20Protocol"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Trust Anchor Management Protocol</span>

   Servers distribute TAMP packages to manage TAs in a client's trust
   anchor databases; TAMP packages are defined in [<a href="rfc5934.html" title='"Trust Anchor Management Protocol (TAMP)"'>RFC5934</a>].  TAMP will
   allow the flexibility for a device to load TAs while maintaining an
   operational state.  Unlike other systems that require new software
   loads when new PKI Roots are authorized for use, TAMP allows for
   automated management of roots for provisioning or replacement
   as needed.

   Clients MUST authenticate the server, and clients MUST check the
   server's authorization.

   The server MUST authenticate the client, and the server MUST check
   the client's authorization.

   The /tamp PC uses an HTTP GET [<a href="rfc7231.html" title='"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"'>RFC7231</a>], and the tamp/return PC uses
   an HTTP POST [<a href="rfc7231.html" title='"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"'>RFC7231</a>].  GET is used when the server requests that
   the client retrieve a TAMP package (see <a href="#section-7.1">Section 7.1</a>); POST is used
   when the client provides a confirm (see <a href="#section-7.2">Section 7.2</a>), provides a
   response (see <a href="#section-7.2">Section 7.2</a>), or provides an error (see <a href="#section-7.2">Section 7.2</a>)
   for the TAMP package.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20TAMP%20Status%20Query%2C%20Trust%20Anchor%20Update%2C%20Apex%20Trust%20Anchor%20Update%2C"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  TAMP Status Query, Trust Anchor Update, Apex Trust Anchor Update,</span>
<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/Community%20Update%2C%20and%20Sequence%20Number%20Adjust"></a>      Community Update, and Sequence Number Adjust</span>

   Clients use the /tamp PC to retrieve the TAMP packages: TAMP Status
   Query, Trust Anchor Update, Apex Trust Anchor Update, Community
   Update, and Sequence Number Adjust.  Clients can be configured to
   periodically poll the server for these packages or contact the server
   based on a PAL entry.

   The message flow is as depicted in Figure 3 modulo replacing
   "Symmetric Key" with the appropriate TAMP message.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.1.1.%20%20Request%20TAMP%20Packages"></a><a class="selflink" href="#section-7.1.1" name="section-7.1.1">7.1.1</a>.  Request TAMP Packages</span>

   Clients request the TAMP packages from the server with an HTTP GET
   [<a href="rfc7231.html" title='"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"'>RFC7231</a>], using an operation path of "/tamp".








<span class="grey">Turner                       Standards Track                   [Page 34]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-35" id="page-35" name="page-35"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.1.2.%20%20Return%20TAMP%20Packages"></a><a class="selflink" href="#section-7.1.2" name="section-7.1.2">7.1.2</a>.  Return TAMP Packages</span>

   If the request is successful, the server response MUST have an
   HTTP 200 response code and a Content-Type of:

   o  application/tamp-status-query for TAMP Status Query

   o  application/tamp-update for Trust Anchor Update

   o  application/tamp-apex-update for Apex Trust Anchor Update

   o  application/tamp-community-update for Community Update

   o  application/tamp-sequence-adjust for Sequence Number Adjust

   As specified in [<a href="rfc5934.html" title='"Trust Anchor Management Protocol (TAMP)"'>RFC5934</a>], these content types are digitally signed
   and clients must support validating the packages directly signed by
   TAs.  For this specification, clients MUST support validation with a
   certificate and clients MUST reject it if the digital signature does
   not validate back to an authorized TA.

   [<a href="rfc3370.html" title='"Cryptographic Message Syntax (CMS) Algorithms"'>RFC3370</a>], [<a href="rfc5753.html" title='"Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)"'>RFC5753</a>], and [<a href="rfc5754.html" title='"Using SHA2 Algorithms with Cryptographic Message Syntax"'>RFC5754</a>] provide algorithm details for use
   when protecting the TAMP packages.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20TAMP%20Responses%2C%20Confirms%2C%20and%20Errors"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  TAMP Responses, Confirms, and Errors</span>

   Clients return the TAMP Status Query Response, Trust Anchor Update
   Confirm, Apex Trust Anchor Update Confirm, Community Update Confirm,
   Sequence Number Adjust Confirm, and TAMP Error to servers, using the
   /tamp/return PC.  Clients can be configured to automatically return
   responses, confirms, and errors after processing a TAMP package or
   based on a PAL entry.

   The message flow is as depicted in Figure 4 modulo replacing
   "Receipt/Error" with the appropriate TAMP response, confirm, or
   error.















<span class="grey">Turner                       Standards Track                   [Page 35]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-36" id="page-36" name="page-36"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.2.1.%20%20Provide%20TAMP%20Responses%2C%20Confirms%2C%20or%20Errors"></a><a class="selflink" href="#section-7.2.1" name="section-7.2.1">7.2.1</a>.  Provide TAMP Responses, Confirms, or Errors</span>

   Clients provide the TAMP responses, confirms, and errors to the
   server with an HTTP POST, using an operation path of "/tamp/return".
   The Content-Type is:

   o  application/tamp-status-response for TAMP Status Query Response

   o  application/tamp-update-confirm for Trust Anchor Update Confirm

   o  application/tamp-apex-update-confirm for Apex Trust Anchor Update
      Confirm

   o  application/tamp-community-update-confirm for Community Update
      Confirm

   o  application/tamp-sequence-adjust-confirm for Sequence Number
      Adjust Confirm

   o  application/tamp-error for TAMP Error

   As specified in [<a href="rfc5934.html" title='"Trust Anchor Management Protocol (TAMP)"'>RFC5934</a>], these content types should be signed.  If
   signed, a signed-data encapsulates the TAMP content.

   [<a href="rfc3370.html" title='"Cryptographic Message Syntax (CMS) Algorithms"'>RFC3370</a>], [<a href="rfc5753.html" title='"Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)"'>RFC5753</a>], and [<a href="rfc5754.html" title='"Using SHA2 Algorithms with Cryptographic Message Syntax"'>RFC5754</a>] provide algorithm details for use
   when protecting the TAMP packages.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.2.2.%20%20TAMP%20Responses%2C%20Confirms%2C%20and%20Error%20Responses"></a><a class="selflink" href="#section-7.2.2" name="section-7.2.2">7.2.2</a>.  TAMP Responses, Confirms, and Error Responses</span>

   If the request is successful, the server response MUST have an
   HTTP 204 response code (i.e., no content is returned).

   When rejecting a request, the server MUST specify either an HTTP 4xx
   error or an HTTP 5xx error.

   If the package is digitally signed, the server MUST reject it if the
   digital signature does not validate back to an authorized TA.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Asymmetric%20Keys%2C%20Receipts%2C%20and%20Errors"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Asymmetric Keys, Receipts, and Errors</span>

   [<a id="ref-RFC7030" name="ref-RFC7030">RFC7030</a>] defines the /serverkeygen PC to support server-side
   generation of asymmetric keys.  Keys are returned as either a) an
   unprotected PKCS #8 when additional security beyond TLS is not
   employed or b) a CMS asymmetric key package content type that is
   encapsulated in a signed-data content type that is further
   encapsulated in an enveloped-data content type when additional
   security beyond TLS is requested.




<span class="grey">Turner                       Standards Track                   [Page 36]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-37" id="page-37" name="page-37"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   Some implementations prefer the use of other CMS content types to
   encapsulate the asymmetric key package.  This document extends the
   content types that can be returned; see <a href="#section-8.1">Section 8.1</a>.

   [<a id="ref-RFC7191" name="ref-RFC7191">RFC7191</a>] defines content types for key package receipts and errors.
   This document defines the /serverkeygen/return PC to add support for
   returning receipts and errors for asymmetric key packages; see
   <a href="#section-8.2">Section 8.2</a>.

   PKCS #12 [<a href="rfc7292.html" title='"PKCS #12: Personal Information Exchange Syntax v1.1"'>RFC7292</a>] (sometimes referred to as "PFX" (Personal
   Information Exchange) or "P12") is often used to distribute
   asymmetric private keys and associated certificates.  This document
   extends the /serverkeygen PC to allow servers to distribute
   server-generated asymmetric private keys and the associated
   certificate to clients using PKCS #12; see <a href="#section-8.3">Section 8.3</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Asymmetric%20Key%20Encapsulation"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Asymmetric Key Encapsulation</span>

   CMS supports a number of content types to encapsulate other CMS
   content types; [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>] includes one such possibility.  Note that
   when only relying on TLS the returned key is not a CMS content type.
   This document extends the CMS content types that can be returned.

   If the client supports CCC [<a href="rfc6010.html" title='"Cryptographic Message Syntax (CMS) Content Constraints Extension"'>RFC6010</a>], then the client can indicate
   that it supports encapsulated asymmetric keys in the encrypted key
   package [<a href="rfc5958.html" title='"Asymmetric Key Packages"'>RFC5958</a>] by including the encrypted key package's OID in a
   content type attribute [<a href="rfc2985.html" title='"PKCS #9: Selected Object Classes and Attribute Types Version 2.0"'>RFC2985</a>] in the CSR (Certificate Signing
   Request) -- aka the certification request -- that it provides to the
   server.  If the client knows a priori that the server supports the
   encrypted key package content type, then the client need not include
   the content type attribute in the CSR.

   In all instances defined herein, the Content-Type is
   "application/cms" [<a href="rfc7193.html" title='"The application/cms Media Type"'>RFC7193</a>].  The optional encapsulatingContent and
   innerContent parameters SHOULD be included with the Content-Type to
   indicate the protection afforded to the returned asymmetric key
   package.

   If additional encryption and origin authentication are employed, the
   content associated with application/cms is a DER-encoded signed-data
   that encapsulates an enveloped-data that encapsulates a signed-data
   that further encapsulates an asymmetric key package.

   If CCC is supported and additional encryption is employed, the
   content associated with application/cms is a DER-encoded encrypted
   key package [<a href="rfc6032.html" title='"Cryptographic Message Syntax (CMS) Encrypted Key Package Content Type"'>RFC6032</a>] content type that encapsulates a signed-data
   that further encapsulates an asymmetric key package.




<span class="grey">Turner                       Standards Track                   [Page 37]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-38" id="page-38" name="page-38"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   If CCC is supported and if additional encryption and additional
   origin authentication are employed, the content associated with
   application/cms is a DER-encoded signed-data that encapsulates an
   encrypted key package content type that encapsulates a signed-data
   that further encapsulates an asymmetric key package.

   The encrypted key package [<a href="rfc6032.html" title='"Cryptographic Message Syntax (CMS) Encrypted Key Package Content Type"'>RFC6032</a>] provides three choices to
   encapsulate keys: EncryptedData, EnvelopedData, and
   AuthEnvelopedData, with EnvelopedData being the
   mandatory-to-implement choice.

   When rejecting a request, the server specifies either an HTTP 4xx
   error or an HTTP 5xx error.

   If an asymmetric key package or an encrypted key package is digitally
   signed, the client MUST reject it if the digital signature does not
   validate back to an authorized TA.

   Note: Absent a policy on the client side requiring a signature, a
   malicious EST server can simply strip the signature, thus bypassing
   that check.  In that case, this requirement is merely a sanity check,
   serving to detect mis-signed packages or misconfigured clients.

   [<a href="rfc3370.html" title='"Cryptographic Message Syntax (CMS) Algorithms"'>RFC3370</a>], [<a href="rfc5753.html" title='"Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)"'>RFC5753</a>], [<a href="rfc5754.html" title='"Using SHA2 Algorithms with Cryptographic Message Syntax"'>RFC5754</a>], [<a href="rfc6033.html" title='"Algorithms for Cryptographic Message Syntax (CMS) Encrypted Key Package Content Type"'>RFC6033</a>], [<a href="rfc6161.html" title='"Elliptic Curve Algorithms for Cryptographic Message Syntax (CMS) Encrypted Key Package Content Type"'>RFC6161</a>], and [<a href="rfc6162.html" title='"Elliptic Curve Algorithms for Cryptographic Message Syntax (CMS) Asymmetric Key Package Content Type"'>RFC6162</a>]
   provide algorithm details for use when protecting the asymmetric key
   package and encrypted key package.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Asymmetric%20Key%20Package%20Receipts%20and%20Errors"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Asymmetric Key Package Receipts and Errors</span>

   Clients can be configured to automatically return receipts after
   processing an asymmetric key package, return receipts based on
   processing of the key-package-identifier-and-receipt-request
   attribute [<a href="rfc7191.html" title='"Cryptographic Message Syntax (CMS) Key Package Receipt and Error Content Types"'>RFC7191</a>], or return receipts when prompted by a PAL entry.
   Servers can indicate that clients return a receipt by including the
   key-package-identifier-and-receipt-request attribute [<a href="rfc7191.html" title='"Cryptographic Message Syntax (CMS) Key Package Receipt and Error Content Types"'>RFC7191</a>] in a
   signed-data as a signed attribute.

   The protocol flow is identical to that depicted in Figure 4 modulo
   the receipt or error is for asymmetric keys.

   The server and client processing is as described in Sections <a href="#section-5.2.1">5.2.1</a>
   and 5.2.2 modulo the PC, which, for Asymmetric Key Packages, is
   "/serverkeygen/return".








<span class="grey">Turner                       Standards Track                   [Page 38]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-39" id="page-39" name="page-39"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.3.%20%20PKCS%20%2312"></a><a class="selflink" href="#section-8.3" name="section-8.3">8.3</a>.  PKCS #12</span>

   PFX is widely deployed and supports protecting keys in the same
   fashion as CMS, but it does so differently.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.3.1.%20%20Server-Side%20Key%20Generation%20Request"></a><a class="selflink" href="#section-8.3.1" name="section-8.3.1">8.3.1</a>.  Server-Side Key Generation Request</span>

   Similar to the other server-generated asymmetric keys provided
   through the /serverkeygen PC:

   o  The certificate request is HTTPS POSTed and is the same format as
      for the "/simpleenroll" and "/simplereenroll" path extensions with
      the same content type.

   o  In all respects, the server SHOULD treat the CSR as it would any
      enroll or re-enroll CSR; the only distinction here is that the
      server MUST ignore the public key values and signature in the CSR.
      These are included in the request only to allow the reuse of
      existing codebases for generating and parsing such requests.

   PBE (password-based encryption) shrouding of PKCS #12 is supported,
   and this specification makes no attempt to alter this de facto
   standard.  As such, there is no support of the DecryptKeyIdentifier
   specified in [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>] for use with PKCS #12 (i.e., "enveloping"
   is not supported).  Note: The use of PBE requires that the password
   be distributed to the client; methods to distribute this password are
   beyond the scope of this document.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.3.2.%20%20Server-Side%20Key%20Generation%20Response"></a><a class="selflink" href="#section-8.3.2" name="section-8.3.2">8.3.2</a>.  Server-Side Key Generation Response</span>

   If the request is successful, the server response MUST have an
   HTTP 200 response code with a Content-Type of "application/pkcs12"
   [<a href="#ref-PKCS12" title='"PKCS #12"'>PKCS12</a>] that consists of a base64-encoded DER-encoded [<a href="#ref-X.690" title='"Information technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"'>X.690</a>]
   PFX [<a href="rfc7292.html" title='"PKCS #12: Personal Information Exchange Syntax v1.1"'>RFC7292</a>].

   Note that this response is different than the response returned as
   described in <a href="rfc7030.html#section-4.4.2">Section 4.4.2 of [RFC7030]</a>, because here the private key
   and the certificate are included in the same PFX.

   When rejecting a request, the server MUST specify either an HTTP 4xx
   error or an HTTP 5xx error.  The response data's Content-Type MAY be
   "text/plain" [<a href="rfc2046.html" title='"Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types"'>RFC2046</a>] to convey human-readable error messages.









<span class="grey">Turner                       Standards Track                   [Page 39]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-40" id="page-40" name="page-40"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20PAL%20and%20Certificate%20Enrollment"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  PAL and Certificate Enrollment</span>

   The /fullcmc PC is defined in [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>]; the CMC (Certificate
   Management over Cryptographic Message Syntax) requirements and
   packages are defined in [<a href="rfc5272.html" title='"Certificate Management over CMS (CMC)"'>RFC5272</a>], [<a href="rfc5273.html" title='"Certificate Management over CMS (CMC): Transport Protocols"'>RFC5273</a>], [<a href="rfc5274.html" title='"Certificate Management Messages over CMS (CMC): Compliance Requirements"'>RFC5274</a>], and
   [<a href="rfc6402.html" title='"Certificate Management over CMS (CMC) Updates"'>RFC6402</a>].  This section describes PAL interactions.

   Under normal circumstances, the client-server interactions for PKI
   enrollment are as follows:

           Client                       Server
                 ---------------------&gt;
             POST req: PKIRequest
             Content-Type: application/pkcs10
            or
             POST req: PKIRequest
             Content-Type: application/pkcs7-mime
                           smime-type=CMC-request

                  &lt;--------------------
                         POST res: PKIResponse
                         Content-Type: application/pkcs7-mime
                                       smime-type=certs-only
                        or
                         POST res: PKIResponse
                         Content-Type: application/pkcs7-mime
                                       smime-type=CMC-response

   If the response is rejected during the same session:

           Client                       Server
                  ---------------------&gt;
              POST req: PKIRequest
              Content-Type: application/pkcs10
             or
              POST req: PKIRequest
              Content-Type: application/pkcs7-mime
                            smime-type=CMC-request

                  &lt;--------------------
                         POST res: empty
                         HTTPS Status Code
                        or
                         POST res: PKIResponse
                         Content-Type: application/pkcs7-mime
                                       smime-type=CMC-response





<span class="grey">Turner                       Standards Track                   [Page 40]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-41" id="page-41" name="page-41"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   If the request is to be filled later:

           Client                       Server
                  ---------------------&gt;
              POST req: PKIRequest
              Content-Type: application/pkcs10
             or
              POST req: PKIRequest
              Content-Type: application/pkcs7-mime
                            smime-type=CMC-request

                  &lt;--------------------
                         POST res: empty
                         HTTPS Status Code
                         + Retry-After
                        or
                         POST res: PKIResponse (pending)
                         Content-Type: application/pkcs7-mime
                                       smime-type=CMC-response

                  ---------------------&gt;
              POST req: PKIRequest (same request)
              Content-Type: application/pkcs10
             or
              POST req: PKIRequest (CMC Status Info only)
              Content-Type: application/pkcs7-mime
                            smime-type=CMC-request

                  &lt;--------------------
                         POST res: PKIResponse
                         Content-Type: application/pkcs7-mime
                                       smime-type=certs-only
                        or
                         POST res: PKIResponse
                         Content-Type: application/pkcs7-mime
                                       smime-type=CMC-response















<span class="grey">Turner                       Standards Track                   [Page 41]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-42" id="page-42" name="page-42"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   With the PAL, the client begins after pulling the PAL and a Start
   Issuance PAL package type, essentially adding the following before
   the request:

           Client                       Server
                 ---------------------&gt;
             GET req: PAL
                  &lt;--------------------
                         GET res: PAL
                         Content-Type: application/xml

   The client then proceeds as above with a simple PKI enrollment or a
   full CMC enrollment, or it begins enrollment assisted by a CSR:

           Client                       Server
                 ---------------------&gt;
             GET req: DS certificate with CSR

                  &lt;--------------------
                         GET res: PAL
                         Content-Type: application/csrattrs

   For immediately rejected requests, CMC works well.  If the server
   prematurely closes the connection, then the procedures in
   <a href="rfc7230.html#section-6.3.1">Section 6.3.1 of [RFC7230]</a> apply.  But this might leave the client
   and server in a different state.  The client could merely resubmit
   the request, but another option, documented herein, is for the client
   to instead download the PAL to see if the server has processed the
   request.  Clients might also use this process when they are unable to
   remain connected to the server for the entire enrollment process; if
   the server does not or is not able to return a PKIData indicating a
   status of pending, then the client will not know whether the request
   was received.  If a client uses the PAL and reconnects to determine
   if the certification or rekey or renew request was processed:

   o  Clients MUST authenticate the server, and clients MUST check the
      server's authorization.

   o  The server MUST authenticate the client, and the server MUST check
      the client's authorization.

   o  Clients retrieve the PAL, using the /pal URI.

   o  Clients and servers use the operation path of "/simpleenroll",
      "simplereenroll", or "/fullcmc", based on the PAL entry, with an
      HTTP GET [<a href="rfc7231.html" title='"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"'>RFC7231</a>] to get the success or failure response.

   Responses are as specified in [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>].



<span class="grey">Turner                       Standards Track                   [Page 42]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-43" id="page-43" name="page-43"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Security%20Considerations"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Security Considerations</span>

   This document relies on many other specifications; however, all of
   the security considerations in [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>] apply.  Refer also to the
   following:

   o  For HTTP, HTTPS, and TLS security considerations, see [<a href="rfc7231.html" title='"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"'>RFC7231</a>],
      [<a href="rfc2818.html" title='"HTTP Over TLS"'>RFC2818</a>], and [<a href="rfc5246.html" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>RFC5246</a>].

   o  For URI security considerations, see [<a href="rfc3986.html" title='"Uniform Resource Identifier (URI): Generic Syntax"'>RFC3986</a>].

   o  For content type security considerations, see [<a href="rfc4073.html" title='"Protecting Multiple Contents with the Cryptographic Message Syntax (CMS)"'>RFC4073</a>],
      [<a href="rfc4108.html" title='"Using Cryptographic Message Syntax (CMS) to Protect Firmware Packages"'>RFC4108</a>], [<a href="rfc5272.html" title='"Certificate Management over CMS (CMC)"'>RFC5272</a>], [<a href="rfc5652.html" title='"Cryptographic Message Syntax (CMS)"'>RFC5652</a>], [<a href="rfc5751.html" title='"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.2 Message Specification"'>RFC5751</a>], [<a href="rfc5934.html" title='"Trust Anchor Management Protocol (TAMP)"'>RFC5934</a>], [<a href="rfc5958.html" title='"Asymmetric Key Packages"'>RFC5958</a>],
      [<a href="rfc6031.html" title='"Cryptographic Message Syntax (CMS) Symmetric Key Package Content Type"'>RFC6031</a>], [<a href="rfc6032.html" title='"Cryptographic Message Syntax (CMS) Encrypted Key Package Content Type"'>RFC6032</a>], [<a href="rfc6268.html" title='"Additional New ASN.1 Modules for the Cryptographic Message Syntax (CMS) and the Public Key Infrastructure Using X.509 (PKIX)"'>RFC6268</a>], [<a href="rfc6402.html" title='"Certificate Management over CMS (CMC) Updates"'>RFC6402</a>], [<a href="rfc7191.html" title='"Cryptographic Message Syntax (CMS) Key Package Receipt and Error Content Types"'>RFC7191</a>], and
      [<a href="rfc7292.html" title='"PKCS #12: Personal Information Exchange Syntax v1.1"'>RFC7292</a>].

   o  For algorithms used to protect packages, see [<a href="rfc3370.html" title='"Cryptographic Message Syntax (CMS) Algorithms"'>RFC3370</a>], [<a href="rfc5649.html" title='"Advanced Encryption Standard (AES) Key Wrap with Padding Algorithm"'>RFC5649</a>],
      [<a href="rfc5753.html" title='"Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)"'>RFC5753</a>], [<a href="rfc5754.html" title='"Using SHA2 Algorithms with Cryptographic Message Syntax"'>RFC5754</a>], [<a href="rfc5959.html" title='"Algorithms for Asymmetric Key Package Content Type"'>RFC5959</a>], [<a href="rfc6033.html" title='"Algorithms for Cryptographic Message Syntax (CMS) Encrypted Key Package Content Type"'>RFC6033</a>], [<a href="rfc6160.html" title='"Algorithms for Cryptographic Message Syntax (CMS) Protection of Symmetric Key Package Content Types"'>RFC6160</a>], [<a href="rfc6161.html" title='"Elliptic Curve Algorithms for Cryptographic Message Syntax (CMS) Encrypted Key Package Content Type"'>RFC6161</a>],
      [<a href="rfc6162.html" title='"Elliptic Curve Algorithms for Cryptographic Message Syntax (CMS) Asymmetric Key Package Content Type"'>RFC6162</a>], and [<a href="rfc7192.html" title='"Algorithms for Cryptographic Message Syntax (CMS) Key Package Receipt and Error Content Types"'>RFC7192</a>].

   o  For random numbers, see [<a href="rfc4086.html" title='"Randomness Requirements for Security"'>RFC4086</a>].

   o  For server-generated asymmetric key pairs, see [<a href="rfc7030.html" title='"Enrollment over Secure Transport"'>RFC7030</a>].




























<span class="grey">Turner                       Standards Track                   [Page 43]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-44" id="page-44" name="page-44"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  IANA Considerations</span>

   IANA has created the "PAL Package Types" registry and performed three
   registrations: PAL Name Space, PAL XML Schema, and PAL Package Types.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.1.%20%20PAL%20Name%20Space"></a><a class="selflink" href="#section-11.1" name="section-11.1">11.1</a>.  PAL Name Space</span>

   This section registers a new XML namespace [<a href="#ref-XMLNS" title='"Namespaces in XML 1.0 (Third Edition)"'>XMLNS</a>],
   "urn:ietf:params:xml:ns:pal", per the guidelines in [<a href="rfc3688.html" title='"The IETF XML Registry"'>RFC3688</a>]:

      URI: urn:ietf:params:xml:ns:pal
      Registrant Contact: Sean Turner (sean@sn3rd.com)
      XML:
         BEGIN
            &lt;?xml version="1.0"?&gt;
            &lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "<a href="https://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">https://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd</a>"&gt;
            &lt;html xmlns="https://www.w3.org/1999/xhtml" xml:lang="en"&gt;
            &lt;head&gt;
               &lt;title&gt;Package Availability List&lt;/title&gt;
            &lt;/head&gt;
            &lt;body&gt;
               &lt;h1&gt;Namespace for Package Availability List&lt;/h1&gt;
               &lt;h2&gt;urn:ietf:params:xml:ns:pal&lt;/h2&gt;
               &lt;p&gt;See <a href="rfc8295.html">RFC 8295</a>&lt;/p&gt;
            &lt;/body&gt;
            &lt;/html&gt;
         END

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.2.%20%20PAL%20XML%20Schema"></a><a class="selflink" href="#section-11.2" name="section-11.2">11.2</a>.  PAL XML Schema</span>

   This section registers an XML schema as per the guidelines in
   [<a href="rfc3688.html" title='"The IETF XML Registry"'>RFC3688</a>].

      URI: urn:ietf:params:xml:schema:pal
      Registrant Contact: Sean Turner (sean@sn3rd.com)
      XML: See <a href="#section-2.1.2">Section 2.1.2</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.3.%20%20PAL%20Package%20Types"></a><a class="selflink" href="#section-11.3" name="section-11.3">11.3</a>.  PAL Package Types</span>

   IANA has created a new registry named "PAL Package Types".  This
   registry is for PAL package types whose initial values are found in
   <a href="#section-2.1.1">Section 2.1.1</a>.  Future registrations of PAL package types are subject
   to Expert Review, as defined in <a href="rfc8126.html">RFC 8126</a> [<a href="rfc8126.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC8126</a>].  Package types
   MUST be paired with a media type; package types specify the path
   components to be used that in turn specify the media type used.





<span class="grey">Turner                       Standards Track                   [Page 44]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-45" id="page-45" name="page-45"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/12.%20%20References"></a><a class="selflink" href="#section-12" name="section-12">12</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.1.%20%20Normative%20References"></a><a class="selflink" href="#section-12.1" name="section-12.1">12.1</a>.  Normative References</span>

   [<a id="ref-RFC2046" name="ref-RFC2046">RFC2046</a>]  Freed, N. and N. Borenstein, "Multipurpose Internet Mail
              Extensions (MIME) Part Two: Media Types", <a href="rfc2046.html">RFC 2046</a>,
              DOI 10.17487/RFC2046, November 1996,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2046">https://www.rfc-editor.org/info/rfc2046</a>&gt;.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC2585" name="ref-RFC2585">RFC2585</a>]  Housley, R. and P. Hoffman, "Internet X.509 Public Key
              Infrastructure Operational Protocols: FTP and HTTP",
              <a href="rfc2585.html">RFC 2585</a>, DOI 10.17487/RFC2585, May 1999,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2585">https://www.rfc-editor.org/info/rfc2585</a>&gt;.

   [<a id="ref-RFC2818" name="ref-RFC2818">RFC2818</a>]  Rescorla, E., "HTTP Over TLS", <a href="rfc2818.html">RFC 2818</a>,
              DOI 10.17487/RFC2818, May 2000,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2818">https://www.rfc-editor.org/info/rfc2818</a>&gt;.

   [<a id="ref-RFC2985" name="ref-RFC2985">RFC2985</a>]  Nystrom, M. and B. Kaliski, "PKCS #9: Selected Object
              Classes and Attribute Types Version 2.0", <a href="rfc2985.html">RFC 2985</a>,
              DOI 10.17487/RFC2985, November 2000,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2985">https://www.rfc-editor.org/info/rfc2985</a>&gt;.

   [<a id="ref-RFC3370" name="ref-RFC3370">RFC3370</a>]  Housley, R., "Cryptographic Message Syntax (CMS)
              Algorithms", <a href="rfc3370.html">RFC 3370</a>, DOI 10.17487/RFC3370, August 2002,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3370">https://www.rfc-editor.org/info/rfc3370</a>&gt;.

   [<a id="ref-RFC3394" name="ref-RFC3394">RFC3394</a>]  Schaad, J. and R. Housley, "Advanced Encryption Standard
              (AES) Key Wrap Algorithm", <a href="rfc3394.html">RFC 3394</a>, DOI 10.17487/RFC3394,
              September 2002, &lt;<a href="https://www.rfc-editor.org/info/rfc3394">https://www.rfc-editor.org/info/rfc3394</a>&gt;.

   [<a id="ref-RFC3688" name="ref-RFC3688">RFC3688</a>]  Mealling, M., "The IETF XML Registry", <a href="https://tools.ietf.org/html/bcp81">BCP 81</a>, <a href="rfc3688.html">RFC 3688</a>,
              DOI 10.17487/RFC3688, January 2004,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3688">https://www.rfc-editor.org/info/rfc3688</a>&gt;.

   [<a id="ref-RFC3986" name="ref-RFC3986">RFC3986</a>]  Berners-Lee, T., Fielding, R., and L. Masinter, "Uniform
              Resource Identifier (URI): Generic Syntax", STD 66,
              <a href="rfc3986.html">RFC 3986</a>, DOI 10.17487/RFC3986, January 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;.







<span class="grey">Turner                       Standards Track                   [Page 45]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-46" id="page-46" name="page-46"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   [<a id="ref-RFC4073" name="ref-RFC4073">RFC4073</a>]  Housley, R., "Protecting Multiple Contents with the
              Cryptographic Message Syntax (CMS)", <a href="rfc4073.html">RFC 4073</a>,
              DOI 10.17487/RFC4073, May 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4073">https://www.rfc-editor.org/info/rfc4073</a>&gt;.

   [<a id="ref-RFC4108" name="ref-RFC4108">RFC4108</a>]  Housley, R., "Using Cryptographic Message Syntax (CMS) to
              Protect Firmware Packages", <a href="rfc4108.html">RFC 4108</a>,
              DOI 10.17487/RFC4108, August 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4108">https://www.rfc-editor.org/info/rfc4108</a>&gt;.

   [<a id="ref-RFC4514" name="ref-RFC4514">RFC4514</a>]  Zeilenga, K., Ed., "Lightweight Directory Access Protocol
              (LDAP): String Representation of Distinguished Names",
              <a href="rfc4514.html">RFC 4514</a>, DOI 10.17487/RFC4514, June 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4514">https://www.rfc-editor.org/info/rfc4514</a>&gt;.

   [<a id="ref-RFC5246" name="ref-RFC5246">RFC5246</a>]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.2", <a href="rfc5246.html">RFC 5246</a>,
              DOI 10.17487/RFC5246, August 2008,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5246">https://www.rfc-editor.org/info/rfc5246</a>&gt;.

   [<a id="ref-RFC5272" name="ref-RFC5272">RFC5272</a>]  Schaad, J. and M. Myers, "Certificate Management over CMS
              (CMC)", <a href="rfc5272.html">RFC 5272</a>, DOI 10.17487/RFC5272, June 2008,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5272">https://www.rfc-editor.org/info/rfc5272</a>&gt;.

   [<a id="ref-RFC5273" name="ref-RFC5273">RFC5273</a>]  Schaad, J. and M. Myers, "Certificate Management over CMS
              (CMC): Transport Protocols", <a href="rfc5273.html">RFC 5273</a>,
              DOI 10.17487/RFC5273, June 2008,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5273">https://www.rfc-editor.org/info/rfc5273</a>&gt;.

   [<a id="ref-RFC5274" name="ref-RFC5274">RFC5274</a>]  Schaad, J. and M. Myers, "Certificate Management Messages
              over CMS (CMC): Compliance Requirements", <a href="rfc5274.html">RFC 5274</a>,
              DOI 10.17487/RFC5274, June 2008,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5274">https://www.rfc-editor.org/info/rfc5274</a>&gt;.

   [<a id="ref-RFC5280" name="ref-RFC5280">RFC5280</a>]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
              Housley, R., and W. Polk, "Internet X.509 Public Key
              Infrastructure Certificate and Certificate Revocation List
              (CRL) Profile", <a href="rfc5280.html">RFC 5280</a>, DOI 10.17487/RFC5280, May 2008,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;.

   [<a id="ref-RFC5649" name="ref-RFC5649">RFC5649</a>]  Housley, R. and M. Dworkin, "Advanced Encryption Standard
              (AES) Key Wrap with Padding Algorithm", <a href="rfc5649.html">RFC 5649</a>,
              DOI 10.17487/RFC5649, September 2009,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5649">https://www.rfc-editor.org/info/rfc5649</a>&gt;.

   [<a id="ref-RFC5652" name="ref-RFC5652">RFC5652</a>]  Housley, R., "Cryptographic Message Syntax (CMS)", STD 70,
              <a href="rfc5652.html">RFC 5652</a>, DOI 10.17487/RFC5652, September 2009,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5652">https://www.rfc-editor.org/info/rfc5652</a>&gt;.



<span class="grey">Turner                       Standards Track                   [Page 46]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-47" id="page-47" name="page-47"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   [<a id="ref-RFC5751" name="ref-RFC5751">RFC5751</a>]  Ramsdell, B. and S. Turner, "Secure/Multipurpose Internet
              Mail Extensions (S/MIME) Version 3.2 Message
              Specification", <a href="rfc5751.html">RFC 5751</a>, DOI 10.17487/RFC5751,
              January 2010, &lt;<a href="https://www.rfc-editor.org/info/rfc5751">https://www.rfc-editor.org/info/rfc5751</a>&gt;.

   [<a id="ref-RFC5753" name="ref-RFC5753">RFC5753</a>]  Turner, S. and D. Brown, "Use of Elliptic Curve
              Cryptography (ECC) Algorithms in Cryptographic Message
              Syntax (CMS)", <a href="rfc5753.html">RFC 5753</a>, DOI 10.17487/RFC5753,
              January 2010, &lt;<a href="https://www.rfc-editor.org/info/rfc5753">https://www.rfc-editor.org/info/rfc5753</a>&gt;.

   [<a id="ref-RFC5754" name="ref-RFC5754">RFC5754</a>]  Turner, S., "Using SHA2 Algorithms with Cryptographic
              Message Syntax", <a href="rfc5754.html">RFC 5754</a>, DOI 10.17487/RFC5754,
              January 2010, &lt;<a href="https://www.rfc-editor.org/info/rfc5754">https://www.rfc-editor.org/info/rfc5754</a>&gt;.

   [<a id="ref-RFC5934" name="ref-RFC5934">RFC5934</a>]  Housley, R., Ashmore, S., and C. Wallace, "Trust Anchor
              Management Protocol (TAMP)", <a href="rfc5934.html">RFC 5934</a>,
              DOI 10.17487/RFC5934, August 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5934">https://www.rfc-editor.org/info/rfc5934</a>&gt;.

   [<a id="ref-RFC5958" name="ref-RFC5958">RFC5958</a>]  Turner, S., "Asymmetric Key Packages", <a href="rfc5958.html">RFC 5958</a>,
              DOI 10.17487/RFC5958, August 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5958">https://www.rfc-editor.org/info/rfc5958</a>&gt;.

   [<a id="ref-RFC5959" name="ref-RFC5959">RFC5959</a>]  Turner, S., "Algorithms for Asymmetric Key Package Content
              Type", <a href="rfc5959.html">RFC 5959</a>, DOI 10.17487/RFC5959, August 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5959">https://www.rfc-editor.org/info/rfc5959</a>&gt;.

   [<a id="ref-RFC5967" name="ref-RFC5967">RFC5967</a>]  Turner, S., "The application/pkcs10 Media Type", <a href="rfc5967.html">RFC 5967</a>,
              DOI 10.17487/RFC5967, August 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5967">https://www.rfc-editor.org/info/rfc5967</a>&gt;.

   [<a id="ref-RFC6010" name="ref-RFC6010">RFC6010</a>]  Housley, R., Ashmore, S., and C. Wallace, "Cryptographic
              Message Syntax (CMS) Content Constraints Extension",
              <a href="rfc6010.html">RFC 6010</a>, DOI 10.17487/RFC6010, September 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6010">https://www.rfc-editor.org/info/rfc6010</a>&gt;.

   [<a id="ref-RFC6031" name="ref-RFC6031">RFC6031</a>]  Turner, S. and R. Housley, "Cryptographic Message Syntax
              (CMS) Symmetric Key Package Content Type", <a href="rfc6031.html">RFC 6031</a>,
              DOI 10.17487/RFC6031, December 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6031">https://www.rfc-editor.org/info/rfc6031</a>&gt;.

   [<a id="ref-RFC6032" name="ref-RFC6032">RFC6032</a>]  Turner, S. and R. Housley, "Cryptographic Message Syntax
              (CMS) Encrypted Key Package Content Type", <a href="rfc6032.html">RFC 6032</a>,
              DOI 10.17487/RFC6032, December 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6032">https://www.rfc-editor.org/info/rfc6032</a>&gt;.






<span class="grey">Turner                       Standards Track                   [Page 47]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-48" id="page-48" name="page-48"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   [<a id="ref-RFC6033" name="ref-RFC6033">RFC6033</a>]  Turner, S., "Algorithms for Cryptographic Message Syntax
              (CMS) Encrypted Key Package Content Type", <a href="rfc6033.html">RFC 6033</a>,
              DOI 10.17487/RFC6033, December 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6033">https://www.rfc-editor.org/info/rfc6033</a>&gt;.

   [<a id="ref-RFC6160" name="ref-RFC6160">RFC6160</a>]  Turner, S., "Algorithms for Cryptographic Message Syntax
              (CMS) Protection of Symmetric Key Package Content Types",
              <a href="rfc6160.html">RFC 6160</a>, DOI 10.17487/RFC6160, April 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6160">https://www.rfc-editor.org/info/rfc6160</a>&gt;.

   [<a id="ref-RFC6161" name="ref-RFC6161">RFC6161</a>]  Turner, S., "Elliptic Curve Algorithms for Cryptographic
              Message Syntax (CMS) Encrypted Key Package Content Type",
              <a href="rfc6161.html">RFC 6161</a>, DOI 10.17487/RFC6161, April 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6161">https://www.rfc-editor.org/info/rfc6161</a>&gt;.

   [<a id="ref-RFC6162" name="ref-RFC6162">RFC6162</a>]  Turner, S., "Elliptic Curve Algorithms for Cryptographic
              Message Syntax (CMS) Asymmetric Key Package Content Type",
              <a href="rfc6162.html">RFC 6162</a>, DOI 10.17487/RFC6162, April 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6162">https://www.rfc-editor.org/info/rfc6162</a>&gt;.

   [<a id="ref-RFC6268" name="ref-RFC6268">RFC6268</a>]  Schaad, J. and S. Turner, "Additional New ASN.1 Modules
              for the Cryptographic Message Syntax (CMS) and the Public
              Key Infrastructure Using X.509 (PKIX)", <a href="rfc6268.html">RFC 6268</a>,
              DOI 10.17487/RFC6268, July 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6268">https://www.rfc-editor.org/info/rfc6268</a>&gt;.

   [<a id="ref-RFC6402" name="ref-RFC6402">RFC6402</a>]  Schaad, J., "Certificate Management over CMS (CMC)
              Updates", <a href="rfc6402.html">RFC 6402</a>, DOI 10.17487/RFC6402, November 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6402">https://www.rfc-editor.org/info/rfc6402</a>&gt;.

   [<a id="ref-RFC7030" name="ref-RFC7030">RFC7030</a>]  Pritikin, M., Ed., Yee, P., Ed., and D. Harkins, Ed.,
              "Enrollment over Secure Transport", <a href="rfc7030.html">RFC 7030</a>,
              DOI 10.17487/RFC7030, October 2013,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7030">https://www.rfc-editor.org/info/rfc7030</a>&gt;.

   [<a id="ref-RFC7303" name="ref-RFC7303">RFC7303</a>]  Thompson, H. and C. Lilley, "XML Media Types", <a href="rfc7303.html">RFC 7303</a>,
              DOI 10.17487/RFC7303, July 2014,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7303">https://www.rfc-editor.org/info/rfc7303</a>&gt;.

   [<a id="ref-RFC7191" name="ref-RFC7191">RFC7191</a>]  Housley, R., "Cryptographic Message Syntax (CMS) Key
              Package Receipt and Error Content Types", <a href="rfc7191.html">RFC 7191</a>,
              DOI 10.17487/RFC7191, April 2014,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7191">https://www.rfc-editor.org/info/rfc7191</a>&gt;.

   [<a id="ref-RFC7192" name="ref-RFC7192">RFC7192</a>]  Turner, S., "Algorithms for Cryptographic Message Syntax
              (CMS) Key Package Receipt and Error Content Types",
              <a href="rfc7192.html">RFC 7192</a>, DOI 10.17487/RFC7192, April 2014,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7192">https://www.rfc-editor.org/info/rfc7192</a>&gt;.



<span class="grey">Turner                       Standards Track                   [Page 48]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-49" id="page-49" name="page-49"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   [<a id="ref-RFC7193" name="ref-RFC7193">RFC7193</a>]  Turner, S., Housley, R., and J. Schaad, "The
              application/cms Media Type", <a href="rfc7193.html">RFC 7193</a>,
              DOI 10.17487/RFC7193, April 2014,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7193">https://www.rfc-editor.org/info/rfc7193</a>&gt;.

   [<a id="ref-RFC7230" name="ref-RFC7230">RFC7230</a>]  Fielding, R., Ed., and J. Reschke, Ed., "Hypertext
              Transfer Protocol (HTTP/1.1): Message Syntax and Routing",
              <a href="rfc7230.html">RFC 7230</a>, DOI 10.17487/RFC7230, June 2014,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7230">https://www.rfc-editor.org/info/rfc7230</a>&gt;.

   [<a id="ref-RFC7231" name="ref-RFC7231">RFC7231</a>]  Fielding, R., Ed., and J. Reschke, Ed., "Hypertext
              Transfer Protocol (HTTP/1.1): Semantics and Content",
              <a href="rfc7231.html">RFC 7231</a>, DOI 10.17487/RFC7231, June 2014,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7231">https://www.rfc-editor.org/info/rfc7231</a>&gt;.

   [<a id="ref-RFC7292" name="ref-RFC7292">RFC7292</a>]  Moriarty, K., Ed., Nystrom, M., Parkinson, S., Rusch, A.,
              and M. Scott, "PKCS #12: Personal Information Exchange
              Syntax v1.1", <a href="rfc7292.html">RFC 7292</a>, DOI 10.17487/RFC7292, July 2014,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7292">https://www.rfc-editor.org/info/rfc7292</a>&gt;.

   [<a id="ref-RFC8126" name="ref-RFC8126">RFC8126</a>]  Cotton, M., Leiba, B., and T. Narten, "Guidelines for
              Writing an IANA Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>,
              <a href="rfc8126.html">RFC 8126</a>, DOI 10.17487/RFC8126, June 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;.

   [<a id="ref-RFC8174" name="ref-RFC8174">RFC8174</a>]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in
              <a href="rfc2119.html">RFC 2119</a> Key Words", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc8174.html">RFC 8174</a>,
              DOI 10.17487/RFC8174, May 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a id="ref-RFC8259" name="ref-RFC8259">RFC8259</a>]  Bray, T., Ed., "The JavaScript Object Notation (JSON) Data
              Interchange Format", STD 90, <a href="rfc8259.html">RFC 8259</a>,
              DOI 10.17487/RFC8259, December 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;.

   [<a id="ref-XML" name="ref-XML">XML</a>]      Bray, T., Paoli, J., Sperberg-McQueen, M., Maler, E., and
              F. Yergeau, "Extensible Markup Language (XML) 1.0
              (Fifth Edition)", World Wide Web Consortium
              Recommendation REC-xml-20081126, November 2008,
              &lt;<a href="https://www.w3.org/TR/2008/REC-xml-20081126/">https://www.w3.org/TR/2008/REC-xml-20081126/</a>&gt;.

   [<a id="ref-XMLSCHEMA" name="ref-XMLSCHEMA">XMLSCHEMA</a>]
              Malhotra, A. and P. Biron, "XML Schema Part 2: Datatypes
              Second Edition", World Wide Web Consortium
              Recommendation REC-xmlschema-2-20041028, October 2004,
              &lt;<a href="https://www.w3.org/TR/2004/REC-xmlschema-2-20041028">https://www.w3.org/TR/2004/REC-xmlschema-2-20041028</a>&gt;.





<span class="grey">Turner                       Standards Track                   [Page 49]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-50" id="page-50" name="page-50"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


   [<a id="ref-X.690" name="ref-X.690">X.690</a>]    ITU-T, "Information technology - ASN.1 encoding rules:
              Specification of Basic Encoding Rules (BER), Canonical
              Encoding Rules (CER) and Distinguished Encoding Rules
              (DER)", ITU-T Recommendation X.690, ISO/IEC 8825-1,
              August 2015, &lt;<a href="https://www.itu.int/rec/T-REC-X.690/en">https://www.itu.int/rec/T-REC-X.690/en</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.2.%20%20Informative%20References"></a><a class="selflink" href="#section-12.2" name="section-12.2">12.2</a>.  Informative References</span>

   [<a id="ref-PKCS12" name="ref-PKCS12">PKCS12</a>]   IANA, "PKCS #12", &lt;<a href="https://www.iana.org/assignments/media-types/application/pkcs12">https://www.iana.org/assignments/</a>
              <a href="https://www.iana.org/assignments/media-types/application/pkcs12">media-types/application/pkcs12</a>&gt;.

   [<a id="ref-RFC4086" name="ref-RFC4086">RFC4086</a>]  Eastlake 3rd, D., Schiller, J., and S. Crocker,
              "Randomness Requirements for Security", <a href="https://tools.ietf.org/html/bcp106">BCP 106</a>, <a href="rfc4086.html">RFC 4086</a>,
              DOI 10.17487/RFC4086, June 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;.

   [<a id="ref-RFC4949" name="ref-RFC4949">RFC4949</a>]  Shirey, R., "Internet Security Glossary, Version 2",
              FYI 36, <a href="rfc4949.html">RFC 4949</a>, DOI 10.17487/RFC4949, August 2007,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4949">https://www.rfc-editor.org/info/rfc4949</a>&gt;.

   [<a id="ref-XMLNS" name="ref-XMLNS">XMLNS</a>]    Bray, T., Hollander, D., Layman, A., Tobin, R., and H.
              Thompson, "Namespaces in XML 1.0 (Third Edition)",
              World Wide Web Consortium Recommendation
              REC-xml-names-20091208/, December 2009,
              &lt;<a href="https://www.w3.org/TR/2009/REC-xml-names-20091208/">https://www.w3.org/TR/2009/REC-xml-names-20091208/</a>&gt;.


























<span class="grey">Turner                       Standards Track                   [Page 50]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-51" id="page-51" name="page-51"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Example%20Use%20of%20PAL"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Example Use of PAL</span>

   This is an informative appendix.  It includes examples of protocol
   flows.

   Steps for using a PAL include the following:

   1. Access PAL

   2. Process PAL entries
      2.1. Get CA certificates
      2.2. Get CRLs
      2.3. Get CSR attributes
      2.4. Enroll: simple enrollment, re-enrollment, or full CMC
      2.5. Get Firmware, TAMP, Symmetric Keys, or EE certificates

   Client                      Server
         ---------------------&gt;                     -+
   GET req:                                          | /pal
         &lt;---------------------                      |
                       GET res: PAL                  |
                       Content-Type: application/xml |
                                                     |
         ---------------------&gt;                     -+
   GET req:                                          | /cacerts
         &lt;---------------------                      |
               GET res: CA Certificates              |
               Content-Type: application/pkcs7-smime |
                             smime-type=certs-only   |
                                                     |
         ---------------------&gt;                     -+
   GET req:                                          | /crls
         &lt;---------------------                      |
               GET res: CRLs                         |
               Content-Type: application/pkcs7-smime |
                             smime-type=crls-only    |
                                                     |
         ---------------------&gt;                     -+
   GET req:                                          | /csrattrs
         &lt;---------------------                      |
                           GET res: attributes       |










<span class="grey">Turner                       Standards Track                   [Page 51]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-52" id="page-52" name="page-52"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


         ---------------------&gt;                     -+
   POST req: PKIRequest                              | /simpleenroll and
   Content-Type: application/pkcs10                  | /simplereenroll
                                                     |
   Content-Type: application/pkcs7-mime              | /fullcmc
                 smime-type=CMC-request              |
                                                     |
         &lt;--------------------                       |
              (success or failure)                   |
              POST res: PKIResponse                  | /simpleenroll
              Content-Type: application/pkcs7-mime   | /simplereenroll
                            smime-type=certs-only    | /fullcmc
                                                     |
              Content-Type: application/pkcs7-mime   | /fullcmc
                            smime-type=CMC-response  |
                                                     |
         --------------------&gt;                      -+
   GET req:                                          | /firmware
         &lt;--------------------                       | /tamp
               GET res: Firmware, TAMP Query         | /symmetrickeys
                        + Updates, Symmetric Keys    |
                Content-Type: application/cms        |
                                                     |
         ---------------------&gt;                     -+
   POST res: Firmware Receipts or Errors,            | /firmware/return
   TAMP Response or Confirms or Errors,              | /tamp/return
   Symmetric Key Receipts or Errors                  | /symmetrickeys/
                                                     |      return
                                                     |
   Content-Type: application/cms                     |
         &lt;--------------------                       |
               POST res: empty                       |
                (success or failure)                 |
         --------------------&gt;                      -+
   GET req:                                          | /eecerts
         &lt;--------------------                       |
               GET res: Other EE certificates        |
                Content-Type: application/pkcs7-mime |
                              smime-type=certs-only  |

   The figure above shows /eecerts after /*/return, but this is for
   illustrative purposes only.









<span class="grey">Turner                       Standards Track                   [Page 52]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-53" id="page-53" name="page-53"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20B.%20%20Additional%20CSR%20Attributes"></a><a class="selflink" href="#appendix-B" name="appendix-B">Appendix B</a>.  Additional CSR Attributes</span>

   This is an informative appendix.

   In some cases, the client is severely limited in its ability to
   encode and decode ASN.1 objects.  If the client knows that a "csr"
   template is being provided during enrollment, then it can peel the
   returned CSR attribute, generate its keys, place the public key in
   the certification request, and then sign the request.  To accomplish
   this, the server returns a pKCS7PDU attribute [<a href="rfc2985.html" title='"PKCS #9: Selected Object Classes and Attribute Types Version 2.0"'>RFC2985</a>] in the
   /csrattrs (the following is "pseudo ASN.1" and is only meant to show
   the fields needed to accomplish returning a template certification
   request):

     pKCS7PDU ATTRIBUTE ::= {
       WITH SYNTAX ContentInfo
       ID pkcs-9-at-pkcs7PDU
       }

     pkcs-9-at-pkcs7PDU OBJECT IDENTIFIER ::= {
       iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs9(9)
       pkcs-9-at(25) 5
       }

   The ContentInfo is a PKIData:

     PKIData ::= SEQUENCE {
       reqSequence        SEQUENCE SIZE(0..MAX) OF TaggedRequest
       }

   Where TaggedRequest is a choice between the PKCS #10 or Certificate
   Request Message Format (CRMF) requests.

     TaggedRequest ::= CHOICE {
       tcr               [0] TaggedCertificationRequest,
       crm               [1] CertReqMsg
       }

   Or, the ContentInfo can be a signed-data content type that further
   encapsulates a PKIData.











<span class="grey">Turner                       Standards Track                   [Page 53]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-54" id="page-54" name="page-54"> </a>
<span class="grey"><a href="rfc8295.html">RFC 8295</a>                     EST Extensions                 January 2018</span>


Acknowledgements

   Thanks in no particular order go to Alexey Melnikov, Paul Hoffman,
   Brad McInnis, Max Pritikin, Francois Rousseau, Chris Bonatti, and
   Russ Housley for taking time to provide comments.

Author's Address

   Sean Turner
   sn3rd

   Email: sean@sn3rd.com







































Turner                       Standards Track                   [Page 54]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc8295 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:15 GMT --></html>