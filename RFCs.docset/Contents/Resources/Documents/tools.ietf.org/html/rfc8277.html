<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc8277 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:15 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="rfc3107" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:8277" name="DC.Identifier"/>
<meta content="October, 2017" name="DC.Date.Issued"/>
<meta content="Eric Rosen &lt;erosen@juniper.net&gt;" name="DC.Creator"/>
<meta content="This document specifies a set of procedures for using BGP to advertise
that a specified router has bound a specified MPLS label (or a
specified sequence of MPLS labels organized as a contiguous part of a
label stack) to a specified address prefix. This can be done by
sending a BGP UPDATE message whose Network Layer Reachability
Information field contains both the prefix and the MPLS label(s) and
whose Next Hop field identifies the node at which said prefix is bound
to said label(s). This document obsoletes RFC 3107." name="DC.Description.Abstract"/>
<meta content="Using BGP to Bind MPLS Labels to Address Prefixes" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 8277 - Using BGP to Bind MPLS Labels to Address Prefixes</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc8277.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc8277" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-mpls-rfc3107bis" title="draft-ietf-mpls-rfc3107bis">draft-ietf-mpls...</a>] [<a href="https://datatracker.ietf.org/doc/rfc8277" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc8277" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc8277" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                          E. Rosen
Request for Comments: 8277                        Juniper Networks, Inc.
Obsoletes: <a href="rfc3107.html">3107</a>                                             October 2017
Category: Standards Track
ISSN: 2070-1721


           <span class="h1">Using BGP to Bind MPLS Labels to Address Prefixes</span>

Abstract

   This document specifies a set of procedures for using BGP to
   advertise that a specified router has bound a specified MPLS label
   (or a specified sequence of MPLS labels organized as a contiguous
   part of a label stack) to a specified address prefix.  This can be
   done by sending a BGP UPDATE message whose Network Layer Reachability
   Information field contains both the prefix and the MPLS label(s) and
   whose Next Hop field identifies the node at which said prefix is
   bound to said label(s).  This document obsoletes <a href="rfc3107.html">RFC 3107</a>.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc7841.html#section-2">Section 2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8277">https://www.rfc-editor.org/info/rfc8277</a>.

Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



<span class="grey">Rosen                        Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
   2.  Using BGP to Bind an Address Prefix to One or More MPLS
       Labels  . . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-2.1">2.1</a>.  Multiple Labels Capability  . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     2.2.  NLRI Encoding When the Multiple Labels Capability Is
           Not Used  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
     2.3.  NLRI Encoding When the Multiple Labels Capability Is Used  10
     2.4.  How to Explicitly Withdraw the Binding of a Label to a
           Prefix  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-2.5">2.5</a>.  Changing the Label That Is Bound to a Prefix  . . . . . .  <a href="#page-13">13</a>
   <a href="#section-3">3</a>.  Installing and/or Propagating SAFI-4 or SAFI-128 Routes . . .  <a href="#page-14">14</a>
     <a href="#section-3.1">3.1</a>.  Comparability of Routes . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
     <a href="#section-3.2">3.2</a>.  Modification of Label(s) Field When Propagating . . . . .  <a href="#page-14">14</a>
       <a href="#section-3.2.1">3.2.1</a>.  When the Next Hop Field Is Unchanged  . . . . . . . .  <a href="#page-14">14</a>
       <a href="#section-3.2.2">3.2.2</a>.  When the Next Hop Field Is Changed  . . . . . . . . .  <a href="#page-15">15</a>
   <a href="#section-4">4</a>.  Data Plane  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
   <a href="#section-5">5</a>.  Relationship between SAFI-4 and SAFI-1 Routes . . . . . . . .  <a href="#page-18">18</a>
   <a href="#section-6">6</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <a href="#page-19">19</a>
   <a href="#section-7">7</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-19">19</a>
   <a href="#section-8">8</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-20">20</a>
     <a href="#section-8.1">8.1</a>.  Normative References  . . . . . . . . . . . . . . . . . .  <a href="#page-20">20</a>
     <a href="#section-8.2">8.2</a>.  Informative References  . . . . . . . . . . . . . . . . .  <a href="#page-22">22</a>
   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-23">23</a>
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-23">23</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   [<a id="ref-RFC3107" name="ref-RFC3107">RFC3107</a>] specifies encodings and procedures for using BGP to
   indicate that a particular router has bound either a single MPLS
   label or a sequence of MPLS labels to a particular address prefix.
   (A sequence of labels would be organized as a contiguous part of an
   MPLS label stack as specified in [<a href="rfc3031.html" title='"Multiprotocol Label Switching Architecture"'>RFC3031</a>] and [<a href="rfc3032.html" title='"MPLS Label Stack Encoding"'>RFC3032</a>].)  This is
   done by sending a BGP UPDATE message whose Network Layer Reachability
   Information field contains both the prefix and the MPLS label(s) and
   whose Next Hop field identifies the node at which said prefix is
   bound to said label(s).  Each such UPDATE also advertises a path to
   the specified prefix via the specified next hop.












<span class="grey">Rosen                        Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


   Although there are many implementations and deployments of [<a href="rfc3107.html" title='"Carrying Label Information in BGP-4"'>RFC3107</a>],
   there are a number of issues with it that have impeded
   interoperability in the past and may potentially impede
   interoperability in the future:

   o  Although [<a href="rfc3107.html" title='"Carrying Label Information in BGP-4"'>RFC3107</a>] specifies an encoding that allows a sequence of
      MPLS labels (rather than just a single label) to be bound to a
      prefix, it does not specify the semantics of binding a sequence of
      labels to a prefix.

   o  Many implementations of [<a href="rfc3107.html" title='"Carrying Label Information in BGP-4"'>RFC3107</a>] assume that only one label will
      be bound to a prefix, and cannot properly process a BGP UPDATE
      message that binds a sequence of labels to a prefix.  Thus, an
      implementation attempting to provide this feature is likely to
      experience problems interoperating with other implementations.

   o  The procedures in [<a href="rfc3107.html" title='"Carrying Label Information in BGP-4"'>RFC3107</a>] for withdrawing the binding of a label
      or sequence of labels to a prefix are not specified clearly and
      correctly.

   o  [<a href="rfc3107.html" title='"Carrying Label Information in BGP-4"'>RFC3107</a>] specifies an optional feature, known as "Advertising
      Multiple Routes to a Destination", that, to the best of the
      author's knowledge, has never been implemented as specified.  The
      functionality that this feature was intended to provide can and
      has been implemented in a different way using the procedures of
      [<a href="rfc7911.html" title='"Advertisement of Multiple Paths in BGP"'>RFC7911</a>], which were not available at the time that [<a href="rfc3107.html" title='"Carrying Label Information in BGP-4"'>RFC3107</a>] was
      written.  In [<a href="rfc3107.html" title='"Carrying Label Information in BGP-4"'>RFC3107</a>], this feature was controlled by a BGP
      Capability Code that has never been implemented and is now
      deprecated; see <a href="#section-6">Section 6</a>.

   o  It is possible for a BGP speaker to receive two BGP UPDATEs that
      advertise paths to the same address prefix, where one UPDATE binds
      a label (or sequence of labels) to the prefix and the other does
      not.  [<a href="rfc3107.html" title='"Carrying Label Information in BGP-4"'>RFC3107</a>] is silent on the issue of how the presence of two
      such UPDATEs impacts the BGP decision process and does not say
      explicitly whether one or the other or both of these UPDATEs
      should be propagated.  This has led different implementations to
      handle this situation in different ways.

   o  Much of [<a href="rfc3107.html" title='"Carrying Label Information in BGP-4"'>RFC3107</a>] applies to the VPN-IPv4 ([<a href="rfc4364.html" title='"BGP/MPLS IP Virtual Private Networks (VPNs)"'>RFC4364</a>]) and VPN-IPv6
      ([<a href="rfc4659.html" title='"BGP-MPLS IP Virtual Private Network (VPN) Extension for IPv6 VPN"'>RFC4659</a>]) address families, but those address families are not
      mentioned in it.

   This document replaces and obsoletes [<a href="rfc3107.html" title='"Carrying Label Information in BGP-4"'>RFC3107</a>].  It defines a new BGP
   Capability to be used when binding a sequence of labels to a prefix;
   by using this Capability, the interoperability problems alluded to
   above can be avoided.  This document also removes the unimplemented




<span class="grey">Rosen                        Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


   "Advertising Multiple Routes to a Destination" feature (see <a href="rfc3107.html#section-4">Section 4
   of [RFC3107]</a>), while specifying how to use [<a href="rfc7911.html" title='"Advertisement of Multiple Paths in BGP"'>RFC7911</a>] to provide the
   same functionality.  This document also addresses the issue of the
   how UPDATEs that bind labels to a given prefix interact with UPDATEs
   that advertise paths to that prefix but do not bind labels to it.
   However, for backwards compatibility, it declares most of these
   interactions to be matters of local policy.

   The places where this specification differs from [<a href="rfc3107.html" title='"Carrying Label Information in BGP-4"'>RFC3107</a>] are
   indicated in the text.  It is believed that implementations that
   conform to the current document will interoperate correctly with
   existing deployed implementations of [<a href="rfc3107.html" title='"Carrying Label Information in BGP-4"'>RFC3107</a>].

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   <a href="https://tools.ietf.org/html/bcp14">BCP 14</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>] [<a href="rfc8174.html" title='"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"'>RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Using%20BGP%20to%20Bind%20an%20Address%20Prefix%20to%20One%20or%20More%20MPLS%20Labels"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Using BGP to Bind an Address Prefix to One or More MPLS Labels</span>

   BGP may be used to advertise that a particular node (call it N) has
   bound a particular MPLS label, or a particular sequence of MPLS
   labels (organized as a contiguous part of an MPLS label stack), to a
   particular address prefix.  This is done by sending a Multiprotocol
   BGP UPDATE message, i.e., an UPDATE message with an MP_REACH_NLRI
   attribute as specified in [<a href="rfc4760.html" title='"Multiprotocol Extensions for BGP-4"'>RFC4760</a>].  The Network Address of Next Hop
   field of that attribute contains an IP address of node N.  The
   label(s) and the prefix are encoded in the Network Layer Reachability
   Information (NLRI) field of the MP_REACH_NLRI.  The encoding of the
   NLRI field is specified in Sections <a href="#section-2.2">2.2</a> and <a href="#section-2.3">2.3</a>.

   If the prefix is an IPv4 address prefix or a VPN-IPv4 ([<a href="rfc4364.html" title='"BGP/MPLS IP Virtual Private Networks (VPNs)"'>RFC4364</a>])
   address prefix, the Address Family Identifier (AFI) of the
   MP_REACH_NLRI attribute is set to 1.  If the prefix is an IPv6
   address prefix or a VPN-IPv6 prefix ([<a href="rfc4659.html" title='"BGP-MPLS IP Virtual Private Network (VPN) Extension for IPv6 VPN"'>RFC4659</a>]), the AFI is set to 2.

   If the prefix is an IPv4 address prefix or an IPv6 address prefix,
   the Subsequent Address Family Identifier (SAFI) field is set to 4.
   If the prefix is a VPN-IPv4 address prefix or a VPN-IPv6 address
   prefix, the SAFI is set to 128.

   The use of SAFI 4 or SAFI 128 when the AFI is other than 1 or 2 is
   outside the scope of this document.







<span class="grey">Rosen                        Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


   This document does not specify the format of the Network Address of
   Next Hop field of the MP_REACH_NLRI attribute.  The format of the
   Next Hop field depends upon a number of factors and is discussed in a
   number of other RFCs: see [<a href="rfc4364.html" title='"BGP/MPLS IP Virtual Private Networks (VPNs)"'>RFC4364</a>], [<a href="rfc4659.html" title='"BGP-MPLS IP Virtual Private Network (VPN) Extension for IPv6 VPN"'>RFC4659</a>], [<a href="rfc4798.html" title='"Connecting IPv6 Islands over IPv4 MPLS Using IPv6 Provider Edge Routers (6PE)"'>RFC4798</a>], and
   [<a href="rfc5549.html" title='"Advertising IPv4 Network Layer Reachability Information with an IPv6 Next Hop"'>RFC5549</a>].

   There are a variety of applications that make use of alternative
   methods of using BGP to advertise MPLS label bindings: see, e.g.,
   [<a href="rfc7432.html" title='"BGP MPLS-Based Ethernet VPN"'>RFC7432</a>], [<a href="rfc6514.html" title='"BGP Encodings and Procedures for Multicast in MPLS/BGP IP VPNs"'>RFC6514</a>], or [<a href="#ref-TUNNEL-ENCAPS">TUNNEL-ENCAPS</a>].  The method described in
   the current document is not claimed to be the only way of using BGP
   to advertise MPLS label bindings.  Discussion of which method to use
   for which application is outside the scope of the current document.

   In the remainder of this document, we will use the term "SAFI-x
   UPDATE" to refer to a BGP UPDATE message containing an MP_REACH_NLRI
   attribute or an MP_UNREACH_NLRI attribute ([<a href="rfc4760.html" title='"Multiprotocol Extensions for BGP-4"'>RFC4760</a>]) whose SAFI
   field contains the value x.

   This document defines a BGP Optional Capabilities parameter
   ([<a href="rfc5492.html" title='"Capabilities Advertisement with BGP-4"'>RFC5492</a>]) known as the Multiple Labels Capability.

   o  Unless this Capability is sent on a given BGP session by both of
      that session's BGP speakers, a SAFI-4 or SAFI-128 UPDATE message
      sent on that session from either speaker MUST bind a prefix to
      only a single label and MUST use the encoding of <a href="#section-2.2">Section 2.2</a>.

   o  If this Capability is sent by both BGP speakers on a given
      session, an UPDATE message on that session, from either speaker,
      MUST use the encoding of <a href="#section-2.3">Section 2.3</a> and MAY bind a prefix to a
      sequence of more than one label.

   The encoding of the Multiple Labels Capability is specified in
   <a href="#section-2.1">Section 2.1</a>.

   Procedures for explicitly withdrawing a label binding are given in
   <a href="#section-2.4">Section 2.4</a>.  Procedures for changing the label(s) bound to a given
   prefix by a given node are given in <a href="#section-2.5">Section 2.5</a>.

   Procedures for propagating SAFI-4 and SAFI-128 UPDATEs are discussed
   in <a href="#section-3">Section 3</a>.

   When a BGP speaker installs and propagates a SAFI-4 or SAFI-128
   UPDATE, and if it changes the value of the Network Address of Next
   Hop field, it must program its data plane appropriately.  This is
   discussed in <a href="#section-4">Section 4</a>.






<span class="grey">Rosen                        Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Multiple%20Labels%20Capability"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Multiple Labels Capability</span>

   [<a id="ref-RFC5492" name="ref-RFC5492">RFC5492</a>] defines the "Capabilities Optional Parameter".  A BGP
   speaker can include a Capabilities Optional Parameter in a BGP OPEN
   message.  The Capabilities Optional Parameter is a triple that
   includes a one-octet Capability Code, a one-octet Capability length,
   and a variable-length Capability Value.

   This document defines a Capability Code known as the Multiple Labels
   Capability code.  IANA has assigned value 8 to this Capability Code.
   (This Capability Code is new to this document and does not appear in
   [<a href="rfc3107.html" title='"Carrying Label Information in BGP-4"'>RFC3107</a>].)

   If a BGP speaker has not sent the Multiple Labels Capability in its
   BGP OPEN message on a particular BGP session, or if it has not
   received the Multiple Labels Capability in the BGP OPEN message from
   its peer on that BGP session, that BGP speaker MUST NOT send on that
   session any UPDATE message that binds more than one MPLS label to any
   given prefix.  Further, when advertising the binding of a single
   label to a prefix, the BGP speaker MUST use the encoding specified in
   <a href="#section-2.2">Section 2.2</a>.

   The value field of the Multiple Labels Capability (shown in Figure 1)
   consists of one or more triples, where each triple consists of four
   octets.  The first two octets of a triple specify an AFI value, the
   third octet specifies a SAFI value, and the fourth specifies a Count.
   If one of the triples is &lt;AFI, SAFI, Count&gt;, the Count is the maximum
   number of labels that the BGP speaker sending the Capability can
   process in a received UPDATE of the specified AFI/SAFI.  If the Count
   is 255, then no limit has been placed on the number of labels that
   can be processed in a received UPDATE of the specified AFI/SAFI.

   Any implementation that sends a Multiple Labels Capability MUST be
   able to support at least two labels in the NLRI.  However, there may
   be deployment scenarios in which a larger number of labels is needed.

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |              AFI              |    SAFI       |    Count      ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~              AFI              |    SAFI       |    Count      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

            Figure 1: Value Field of Multiple Labels Capability

   If the Capability contains more than one triple with a given AFI/
   SAFI, all but the first MUST be ignored.



<span class="grey">Rosen                        Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


   A triple of the form &lt;AFI=x, SAFI=y, Count=0&gt; or
   &lt;AFI=x, SAFI=y, Count=1&gt; MUST NOT be sent.  If such a triple is
   received, it MUST be ignored.

   A Multiple Labels Capability whose length is not a multiple of four
   MUST be considered to be malformed.

   "Graceful Restart Mechanism for BGP" [<a href="rfc4724.html" title='"Graceful Restart Mechanism for BGP"'>RFC4724</a>] describes a procedure
   that allows routes learned over a given BGP session to be maintained
   when the session fails and then restarts.  This procedure requires
   the entire RIB to be transmitted when the session restarts.  If the
   Multiple Labels Capability for a given AFI/SAFI was exchanged on the
   failed session but has not been exchanged on the restarted session,
   then any prefixes advertised in that AFI/SAFI with multiple labels
   MUST be explicitly withdrawn.  Similarly, if the maximum label count
   (specified in the Capability for a given AFI/SAFI) is reduced, any
   prefixes advertised with more labels than are valid for the current
   session MUST be explicitly withdrawn.

   "Accelerated Routing Convergence for BGP Graceful Restart"
   [<a href="#ref-Enhanced-GR">Enhanced-GR</a>] describes another procedure that allows the routes
   learned over a given BGP session to be maintained when the session
   fails and then restarts.  These procedures MUST NOT be applied if
   either of the following conditions hold:

   o  The Multiple Labels Capability for a given AFI/SAFI had been
      exchanged prior to the restart but has not been exchanged on the
      restarted session.

   o  The Multiple Labels Capability for a given AFI/SAFI had been
      exchanged with a given Count prior to the restart but have been
      exchanged with a smaller count on the restarted session.

   If either of these conditions hold, the complete set of routes for
   the given AFI/SAFI MUST be exchanged.

   If a BGP OPEN message contains multiple copies of the Multiple Labels
   Capability, only the first copy is significant; subsequent copies
   MUST be ignored.

   If (a) a BGP speaker has sent the Multiple Labels Capability in its
   BGP OPEN message for a particular BGP session, (b) it has received
   the Multiple Labels Capability in its peer's BGP OPEN message for
   that session, and (c) both Capabilities specify AFI/SAFI x/y, then
   when using an UPDATE of AFI x and SAFI y to advertise the binding of
   a label or sequence of labels to a given prefix, the BGP speaker MUST
   use the encoding of <a href="#section-2.3">Section 2.3</a>.  This encoding MUST be used even if
   only one label is being bound to a given prefix.



<span class="grey">Rosen                        Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


   If both BGP speakers of a given BGP session have sent the Multiple
   Labels Capability, but AFI/SAFI x/y has not been specified in both
   Capabilities, then UPDATEs of AFI/SAFI x/y on that session MUST use
   the encoding of <a href="#section-2.2">Section 2.2</a>, and such UPDATEs can only bind one label
   to a prefix.

   A BGP speaker SHOULD NOT send an UPDATE that binds more labels to a
   given prefix than its peer is capable of receiving, as specified in
   the Multiple Labels Capability sent by that peer.  If a BGP speaker
   receives an UPDATE that binds more labels to a given prefix than the
   number of labels the BGP speaker is prepared to receive (as announced
   in its Multiple Labels Capability), the BGP speaker MUST apply the
   "treat-as-withdraw" strategy of [<a href="rfc7606.html" title='"Revised Error Handling for BGP UPDATE Messages"'>RFC7606</a>] to that UPDATE.

   Notwithstanding the number of labels that a BGP speaker has claimed
   to be able to receive, its peer MUST NOT attempt to send more labels
   than can be properly encoded in the NLRI field of the MP_REACH_NLRI
   attribute.  Please note that there is only a limited amount of space
   in the NLRI field for labels:

   o  per [<a href="rfc4760.html" title='"Multiprotocol Extensions for BGP-4"'>RFC4760</a>], the size of this field is limited to 255 bits (not
      255 octets), including the number of bits in the prefix;

   o  in a SAFI-128 UPDATE, the prefix is at least 64 bits long and may
      be as long as 192 bits (e.g., in a VPN-IPv6 host route).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20NLRI%20Encoding%20When%20the%20Multiple%20Labels%20Capability%20Is%20Not%20Used"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  NLRI Encoding When the Multiple Labels Capability Is Not Used</span>

   If the Multiple Labels Capability has not been both sent and received
   on a given BGP session, then in a BGP UPDATE on that session whose
   MP_REACH_NLRI attribute contains one of the AFI/SAFI combinations
   specified in <a href="#section-2">Section 2</a>, the NLRI field is encoded as shown in
   Figure 2:

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Length     |                 Label                 |Rsrv |S|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                          Prefix                               ~
     ~                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                       Figure 2: NLRI with One Label







<span class="grey">Rosen                        Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


   - Length:

      The Length field consists of a single octet.  It specifies the
      length in bits of the remainder of the NLRI field.

      Note that the length will always be the sum of 20 (number of bits
      in Label field), plus 3 (number of bits in Rsrv field), plus 1
      (number of bits in S field), plus the length in bits of the
      prefix.

      In an MP_REACH_NLRI attribute whose AFI/SAFI is 1/4, the prefix
      length will be 32 bits or less.  In an MP_REACH_NLRI attribute
      whose AFI/SAFI is 2/4, the prefix length will be 128 bits or less.
      In an MP_REACH_NLRI attribute whose SAFI is 128, the prefix will
      be 96 bits or less if the AFI is 1 and will be 192 bits or less if
      the AFI is 2.

      As specified in [<a href="rfc4760.html" title='"Multiprotocol Extensions for BGP-4"'>RFC4760</a>], the actual length of the NLRI field
      will be the number of bits specified in the Length field, rounded
      up to the nearest integral number of octets.

   - Label:

      The Label field is a 20-bit field containing an MPLS label value
      (see [<a href="rfc3032.html" title='"MPLS Label Stack Encoding"'>RFC3032</a>]).

   - Rsrv:

      This 3-bit field SHOULD be set to zero on transmission and MUST be
      ignored on reception.

   - S:

      This 1-bit field MUST be set to one on transmission and MUST be
      ignored on reception.

   Note that the UPDATE message not only advertises the binding between
   the prefix and the label, it also advertises a path to the prefix via
   the node identified in the Network Address of Next Hop field of the
   MP_REACH_NLRI attribute.

   [<a id="ref-RFC3107" name="ref-RFC3107">RFC3107</a>] requires that if only a single label is bound to a prefix,
   the S bit must be set.  If the S bit is not set, [<a href="rfc3107.html" title='"Carrying Label Information in BGP-4"'>RFC3107</a>] specifies
   that additional labels will appear in the NLRI.  However, some
   implementations assume that the NLRI will contain only a single label
   and thus do not check the setting of the S bit.  The procedures
   specified in the current document will interwork with such
   implementations.  As long as the Multiple Labels Capability is not



<span class="grey">Rosen                        Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


   sent and received by both BGP speakers on a given BGP session, this
   document REQUIRES that only one label be specified in the NLRI, that
   the S bit be set on transmission, and that it be ignored on
   reception.

   If the procedures of [<a href="rfc7911.html" title='"Advertisement of Multiple Paths in BGP"'>RFC7911</a>] are being used, a four-octet "path
   identifier" (as defined in <a href="rfc7911.html#section-3">Section 3 of [RFC7911]</a>) is part of the
   NLRI and precedes the Length field.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20NLRI%20Encoding%20When%20the%20Multiple%20Labels%20Capability%20Is%20Used"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  NLRI Encoding When the Multiple Labels Capability Is Used</span>

   If the Multiple Labels Capability has been both sent and received on
   a given BGP session, then in a BGP UPDATE on that session whose
   MP_REACH_NLRI attribute contains one of the AFI/SAFI combinations
   specified in <a href="#section-2">Section 2</a>, the NLRI field is encoded as shown in
   Figure 3:

      0                   1                   2                     3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+
     |    Length     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                 Label                 |Rsrv |S~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                 Label                 |Rsrv |S|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                          Prefix                               ~
     ~                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                    Figure 3: NLRI with Multiple Labels

   - Length:

      The Length field consists of a single octet.  It specifies the
      length in bits of the remainder of the NLRI field.

      Note that for each label, the length is increased by 24 bits (20
      bits in the Label field, plus 3 bits in the Rsrv field, plus 1 S
      bit).

      In an MP_REACH_NLRI attribute whose AFI/SAFI is 1/4, the prefix
      length will be 32 bits or less.  In an MP_REACH_NLRI attribute
      whose AFI/SAFI is 2/4, the prefix length will be 128 bits or less.
      In an MP_REACH_NLRI attribute whose SAFI is 128, the prefix will
      be 96 bits or less if the AFI is 1 and will be 192 bits or less if
      the AFI is 2.




<span class="grey">Rosen                        Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


      As specified in [<a href="rfc4760.html" title='"Multiprotocol Extensions for BGP-4"'>RFC4760</a>], the actual length of the NLRI field
      will be the number of bits specified in the Length field rounded
      up to the nearest integral number of octets.

   - Label:

      The Label field is a 20-bit field containing an MPLS label value
      (see [<a href="rfc3032.html" title='"MPLS Label Stack Encoding"'>RFC3032</a>]).

   - Rsrv:

      This 3-bit field SHOULD be set to zero on transmission and MUST be
      ignored on reception.

   - S:

      In all labels except the last (i.e., in all labels except the one
      immediately preceding the prefix), the S bit MUST be 0.  In the
      last label, the S bit MUST be 1.

      Note that failure to set the S bit in the last label will make it
      impossible to parse the NLRI correctly.  See <a href="#section-3">Section 3</a>, paragraph
      j of [<a href="rfc7606.html" title='"Revised Error Handling for BGP UPDATE Messages"'>RFC7606</a>] for a discussion of error handling when the NLRI
      cannot be parsed.

   Note that the UPDATE message not only advertises the binding between
   the prefix and the labels, it also advertises a path to the prefix
   via the node identified in the Next Hop field of the MP_REACH_NLRI
   attribute.

   If the procedures of [<a href="rfc7911.html" title='"Advertisement of Multiple Paths in BGP"'>RFC7911</a>] are being used, a four-octet "path
   identifier" (as defined in <a href="rfc7911.html#section-3">Section 3 of [RFC7911]</a>) is part of the
   NLRI and precedes the Length field.


















<span class="grey">Rosen                        Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.4.%20%20How%20to%20Explicitly%20Withdraw%20the%20Binding%20of%20a%20Label%20to%20a%20Prefix"></a><a class="selflink" href="#section-2.4" name="section-2.4">2.4</a>.  How to Explicitly Withdraw the Binding of a Label to a Prefix</span>

   Suppose a BGP speaker has announced, on a given BGP session, the
   binding of a given label or sequence of labels to a given prefix.
   Suppose it now wishes to withdraw that binding.  To do so, it may
   send a BGP UPDATE message with an MP_UNREACH_NLRI attribute.  The
   NLRI field of this attribute is encoded as follows:

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Length     |        Compatibility                          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                          Prefix                               ~
     ~                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                       Figure 4: NLRI for Withdrawal

   Upon transmission, the Compatibility field SHOULD be set to 0x800000.
   Upon reception, the value of the Compatibility field MUST be ignored.

   This encoding is used for explicitly withdrawing the binding (on a
   given BGP session) between the specified prefix and whatever label or
   sequence of labels had previously been bound by the procedures of
   this document to that prefix on the given session.  This encoding is
   used whether or not the Multiple Labels Capability has been sent or
   received on the session.  Note that label/prefix bindings that were
   not advertised on the given session cannot be withdrawn by this
   method.  (However, if the bindings were advertised on a previous
   session with the same peer, and the current session is the result of
   a "graceful restart" ([<a href="rfc4724.html" title='"Graceful Restart Mechanism for BGP"'>RFC4724</a>]) of the previous session, then this
   withdrawal method may be used.)

   When using an MP_UNREACH_NLRI attribute to withdraw a route whose
   NLRI was previously specified in an MP_REACH_NLRI attribute, the
   lengths and values of the respective prefixes must match, and the
   respective AFI/SAFIs must match.  If the procedures of [<a href="rfc7911.html" title='"Advertisement of Multiple Paths in BGP"'>RFC7911</a>] are
   being used, the respective values of the "path identifier" fields
   must match as well.  Note that the prefix length is not the same as
   the NLRI length; to determine the prefix length of a prefix in an
   MP_UNREACH_NLRI, the length of the Compatibility field must be
   subtracted from the length of the NLRI.

   An explicit withdrawal in a SAFI-x UPDATE on a given BGP session not
   only withdraws the binding between the prefix and the label(s), it
   also withdraws the path to that prefix that was previously advertised
   in a SAFI-x UPDATE on that session.



<span class="grey">Rosen                        Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


   [<a id="ref-RFC3107" name="ref-RFC3107">RFC3107</a>] made it possible to specify a particular label value in the
   Compatibility field.  However, the functionality that required the
   presence of a particular label value (or sequence of label values)
   was never implemented, and that functionality is not present in the
   current document.  Hence, the value of this field is of no
   significance; there is never any reason for this field to contain a
   label value or a sequence of label values.

   [<a id="ref-RFC3107" name="ref-RFC3107">RFC3107</a>] also made it possible to withdraw a binding without
   specifying the label explicitly, by setting the Compatibility field
   to 0x800000.  However, some implementations set it to 0x000000.  In
   order to ensure backwards compatibility, it is RECOMMENDED by this
   document that the Compatibility field be set to 0x800000, but it is
   REQUIRED that it be ignored upon reception.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.5.%20%20Changing%20the%20Label%20That%20Is%20Bound%20to%20a%20Prefix"></a><a class="selflink" href="#section-2.5" name="section-2.5">2.5</a>.  Changing the Label That Is Bound to a Prefix</span>

   Suppose a BGP speaker, S1, has received on a given BGP session, a
   SAFI-4 or SAFI-128 UPDATE, U1, that specifies label (or sequence of
   labels) L1, prefix P, and next hop N1.  As specified above, this
   indicates that label (or sequence of labels) L1 is bound to prefix P
   at node N1.  Suppose that S1 now receives, on the same session, an
   UPDATE, U2, of the same AFI/SAFI, that specifies label (or sequence
   of labels) L2, prefix P, and the same next hop, N1.

   o  If [<a href="rfc7911.html" title='"Advertisement of Multiple Paths in BGP"'>RFC7911</a>] is not being used, UPDATE U2 MUST be interpreted as
      meaning that L2 is now bound to P at N1 and that L1 is no longer
      bound to P at N1.  That is, the UPDATE U1 is implicitly withdrawn
      and is replaced by UPDATE U2.

   o  Suppose that [<a href="rfc7911.html" title='"Advertisement of Multiple Paths in BGP"'>RFC7911</a>] is being used, that UPDATE U1 has Path
      Identifier I1, and that UPDATE U2 has Path Identifier I2.

      *  If I1 is the same as I2, UPDATE U2 MUST be interpreted as
         meaning that L2 is now bound to P at N1 and that L1 is no
         longer bound to P at N1.  UPDATE U1 is implicitly withdrawn.

      *  If I1 is not the same as I2, U2 MUST be interpreted as meaning
         that L2 is now bound to P at N1, but U2 MUST NOT be interpreted
         as meaning that L1 is no longer bound to P at N1.  Under
         certain conditions (specification of which is outside the scope
         of this document), S1 may choose to load-balance traffic
         between the path represented by U1 and the path represented by
         U2.  To send traffic on the path represented by U1, S1 uses the
         label(s) advertised in U1; to send traffic on the path
         represented by U2, S1 uses the label(s) advertised in U2.
         (Although these two paths have the same next hop, one must
         suppose that they diverge further downstream.)



<span class="grey">Rosen                        Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


   Suppose a BGP speaker, S1, has received, on a given BGP session, a
   SAFI-4 or SAFI-128 UPDATE that specifies label L1, prefix P, and next
   hop N1.  Suppose that S1 now receives, on a different BGP session, an
   UPDATE of the same AFI/SAFI, that specifies label L2, prefix P, and
   the same next hop, N1.  BGP speaker S1 SHOULD treat this as an
   indication that N1 has at least two paths to P, and S1 MAY use this
   fact to do load-balancing of any traffic that it has to send to P.

   Note that this section discusses only the case where two UPDATEs have
   the same next hop.  Procedures for the case where two UPDATEs have
   different next hops are adequately described in [<a href="rfc4271.html" title='"A Border Gateway Protocol 4 (BGP-4)"'>RFC4271</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Installing%20and%2For%20Propagating%20SAFI-4%20or%20SAFI-128%20Routes"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Installing and/or Propagating SAFI-4 or SAFI-128 Routes</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Comparability%20of%20Routes"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Comparability of Routes</span>

   Suppose a BGP speaker has received two SAFI-4 UPDATEs specifying the
   same Prefix and that either:

   o  the two UPDATEs are received on different BGP sessions; or

   o  the two UPDATEs are received on the same session, add-paths is
      used on that session, and the NLRIs of the two UPDATEs have
      different path identifiers.

   These two routes MUST be considered to be comparable, even if they
   specify different labels.  Thus, the BGP best-path selection
   procedures (see <a href="rfc4271.html#section-9.1">Section 9.1 of [RFC4271]</a>) are applied to select one
   of them as the better path.  If the procedures of [<a href="rfc7911.html" title='"Advertisement of Multiple Paths in BGP"'>RFC7911</a>] are not
   being used on a particular BGP session, only the best path is
   propagated on that session.  If the procedures of [<a href="rfc7911.html" title='"Advertisement of Multiple Paths in BGP"'>RFC7911</a>] are being
   used on a particular BGP session, then both paths may be propagated
   on that session, though with different path identifiers.

   The same applies to SAFI-128 routes.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Modification%20of%20Label%28s%29%20Field%20When%20Propagating"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Modification of Label(s) Field When Propagating</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.1.%20%20When%20the%20Next%20Hop%20Field%20Is%20Unchanged"></a><a class="selflink" href="#section-3.2.1" name="section-3.2.1">3.2.1</a>.  When the Next Hop Field Is Unchanged</span>

   When a SAFI-4 or SAFI-128 route is propagated, if the Network Address
   of Next Hop field is left unchanged, the Label field(s) MUST also be
   left unchanged.

   Note that a given route MUST NOT be propagated to a given peer if the
   route's NLRI has multiple labels, but the Multiple Labels Capability
   was not negotiated with the peer.  Similarly, a given route MUST NOT
   be propagated to a given peer if the route's NLRI has more labels



<span class="grey">Rosen                        Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


   than the peer has announced (through its Multiple Labels Capability)
   that it can handle.  In either case, if a previous route with the
   same AFI, SAFI, and prefix (but with fewer labels) has already been
   propagated to the peer, that route MUST be withdrawn from that peer
   using the procedure specified in <a href="#section-2.4">Section 2.4</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.2.%20%20When%20the%20Next%20Hop%20Field%20Is%20Changed"></a><a class="selflink" href="#section-3.2.2" name="section-3.2.2">3.2.2</a>.  When the Next Hop Field Is Changed</span>

   If the Network Address of Next Hop field is changed before a SAFI-4
   or SAFI-128 route is propagated, the Label field(s) of the propagated
   route MUST contain the label(s) that is (are) bound to the prefix at
   the new next hop.

   Suppose BGP speaker S1 has received an UPDATE that binds a particular
   sequence of one or more labels to a particular prefix.  If S1 chooses
   to propagate this route after changing its next hop, S1 may change
   the label in any of the following ways, depending upon local policy:

   o  A single label may be replaced by a single label of the same or
      different value.

   o  A sequence of multiple labels may be replaced by a single label.

   o  A single label may be replaced by a sequence of multiple labels.

   o  A sequence of multiple labels may be replaced by a sequence of
      multiple labels; the number of labels may be left the same or may
      be changed.

   Of course, when deciding whether to propagate, to a given BGP peer,
   an UPDATE binding a sequence of more than one label, a BGP speaker
   must attend to the information provided by the Multiple Labels
   Capability (see <a href="#section-2.1">Section 2.1</a>).  A BGP speaker MUST NOT send multiple
   labels to a peer with which it has not exchanged the Multiple Labels
   Capability and MUST NOT send more labels to a given peer than the
   peer has announced (via the Multiple Labels Capability) than it can
   handle.

   It is possible that a BGP speaker's local policy will tell it to
   encode N labels in a given route's NLRI before propagating the route,
   but that one of the BGP speaker's peers cannot handle N labels in the
   NLRI.  In this case, the BGP speaker has two choices:

   o  It can propagate the route to the given peer with fewer than N
      labels; however, whether this makes sense, and if so, how to
      choose the labels, is also a matter of local policy.





<span class="grey">Rosen                        Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


   o  It can decide not to propagate the route to the given peer.  In
      that case, if a previous route with the same AFI, SAFI, and prefix
      (but with fewer labels) has already been propagated to that peer,
      that route MUST be withdrawn from that peer using the procedure of
      <a href="#section-2.4">Section 2.4</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Data%20Plane"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Data Plane</span>

   In the following, we will use the phrase "node S tunnels packet P to
   node N", where packet P is an MPLS packet.  By this phrase, we mean
   that node S encapsulates packet P and causes packet P to be delivered
   to node N in such a way that P's label stack before encapsulation
   will be seen unchanged by N but will not be seen by the nodes (if
   any) between S and N.

   If the tunnel is a Label Switched Path (LSP), encapsulating the
   packet may be as simple as pushing on another MPLS label.  If node N
   is a Layer 2 adjacency of node S, a Layer 2 encapsulation may be all
   that is needed.  Other sorts of tunnels (e.g., IP tunnels, GRE
   tunnels, UDP tunnels) may also be used, depending upon the particular
   deployment scenario.

   Suppose BGP speaker S1 receives a SAFI-4 or SAFI-128 BGP UPDATE with
   an MP_REACH_NLRI specifying label L1, prefix P, and next hop N1, and
   suppose S1 installs this route as its (or one of its) best path(s)
   towards P.  And suppose S1 propagates this route after changing the
   next hop to itself and changing the label to L2.  Suppose further
   that S1 receives an MPLS data packet and, in the process of
   forwarding that MPLS data packet, S1 sees label L2 rise to the top of
   the packet's label stack.  Then, to forward the packet further, S1
   must replace L2 with L1 as the top entry in the packet's label stack,
   and S1 must then tunnel the packet to N1.

   Suppose that the route received by S1 specified not a single label,
   but a sequence of k labels &lt;L11, L12, ..., L1k&gt; where L11 is the
   first label appearing in the NLRI, and L1k is the last.  And suppose
   again that S1 propagates this route after changing the next hop to
   itself and changing the Label field to the single label L2.  Suppose
   further that S1 receives an MPLS data packet, and in the process of
   forwarding that MPLS data packet, S1 sees label L2 rise to the top of
   the packet's label stack.  In this case, instead of simply replacing
   L2 with L1, S1 removes L2 from the top of the label stack and then
   pushes labels L1k through L11 onto the label stack such that L11 is
   now at the top of the label stack.  Then, S1 must tunnel the packet
   to N1.  (Note that L1k will not be at the bottom of the packet's
   label stack and hence will not have the "bottom of stack" bit set
   unless L2 had previously been at the bottom of the packet's label
   stack.)



<span class="grey">Rosen                        Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


   The above paragraph assumes that when S1 propagates a SAFI-4 or
   SAFI-128 route after setting the next hop to itself, it replaces the
   label or labels specified in the NLRI of that route with a single
   label.  However, it is also possible, as determined by local policy,
   for a BGP speaker to specify multiple labels when it propagates a
   SAFI-4 or SAFI-128 route after setting the next hop to itself.

   Suppose, for example, that S1 supports context labels ([<a href="rfc5331.html" title='"MPLS Upstream Label Assignment and Context-Specific Label Space"'>RFC5331</a>]).
   Let L21 be a context label supported by S1, and let L22 be a label
   that is in the label space identified (at S1) by L21.  Suppose S1
   receives a SAFI-4 or SAFI-128 UPDATE whose prefix is P, whose Label
   field is &lt;L11, L12, ..., L1k&gt; and whose next hop is N1.  Before
   propagating the UPDATE, S1 may set the next hop to itself (by
   replacing N1 with S1) and may replace the label stack &lt;L11, L12, ...,
   L1k&gt; with the pair of labels &lt;L21, L22&gt;.

   In this case, if S1 receives an MPLS data packet whose top label is
   L21 and whose second label is L22, S1 will remove both L21 and L22
   from the label stack and replace them with &lt;L11, L12, ..., L1k&gt;.
   Note that the fact that L21 is a context label is known only to S1;
   other BGP speakers do not know how S1 will interpret L21 (or L22).

   The ability to replace one or more labels by one or more labels can
   provide great flexibility, but it must be done carefully.  Let's
   suppose again that S1 receives an UPDATE that specifies prefix P,
   label stack &lt;L11, L12, ..., L1k&gt;, and next hop N1.  And suppose that
   S1 propagates this UPDATE to BGP speaker S2 after setting next hop
   self and after replacing the Label field with &lt;L21, L22, ..., L2k&gt;.
   Finally, suppose that S1 programs its data plane so that when it
   processes a received MPLS packet whose top label is L21, it replaces
   L21 with &lt;L11, L12, ..., L1k&gt; and then tunnels the packet to N1.

   In this case, BGP speaker S2 will have received a route with prefix
   P, Label field &lt;L21, L22, ..., L2k&gt;, and next hop S1.  If S2 decides
   to forward an IP packet according to this route, it will push &lt;L21,
   L22, ..., L2k&gt; onto the packet's label stack and tunnel the packet to
   S1.  S1 will replace L21 with &lt;L11, L12, ..., L1k&gt; and will tunnel
   the packet to N1.  N1 will receive the packet with the following
   label stack: &lt;L11, L12, ..., L1k, L22, ..., L2k&gt;.  While this may be
   useful in certain scenarios, it may provide unintended results in
   other scenarios.

   Procedures for choosing, setting up, maintaining, or determining the
   liveness of a particular tunnel or type of tunnel are outside the
   scope of this document.






<span class="grey">Rosen                        Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


   When pushing labels onto a packet's label stack, the Time-to-Live
   (TTL) field ([<a href="rfc3032.html" title='"MPLS Label Stack Encoding"'>RFC3032</a>], [<a href="rfc3443.html" title='"Time To Live (TTL) Processing in Multi-Protocol Label Switching (MPLS) Networks"'>RFC3443</a>]) and the Traffic Class (TC) field
   ([<a href="rfc3032.html" title='"MPLS Label Stack Encoding"'>RFC3032</a>], [<a href="rfc5462.html" title='"Multiprotocol Label Switching (MPLS) Label Stack Entry: "'>RFC5462</a>]) of each label stack entry must, of course, be
   set.  This document does not specify any set of rules for setting
   these fields; that is a matter of local policy.

   This document does not specify any new rules for processing the label
   stack of an incoming data packet.

   It is a matter of local policy whether SAFI-4 routes can be used as
   the basis for forwarding IP packets or whether SAFI-4 routes can only
   be used for forwarding MPLS packets.  If BGP speaker S1 is forwarding
   IP packets according to SAFI-4 routes, then consider an IP packet
   with destination address D, such that P is the "longest prefix match"
   for D from among the routes that are being used to forward IP
   packets.  And suppose the packet is being forwarded according to a
   SAFI-4 route whose prefix is P, whose next hop is N1 and whose
   sequence of labels is L1.  To forward the packet according to this
   route, S1 must create a label stack for the packet, push on the
   sequence of labels L1, and then tunnel the packet to N1.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Relationship%20between%20SAFI-4%20and%20SAFI-1%20Routes"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Relationship between SAFI-4 and SAFI-1 Routes</span>

   It is possible that a BGP speaker will receive both a SAFI-1 route
   for prefix P and a SAFI-4 route for prefix P.  Different
   implementations treat this situation in different ways.

   For example, some implementations may regard SAFI-1 routes and SAFI-4
   routes as completely independent and may treat them in a "ships in
   the night" fashion.  In this case, best-path selection for the two
   SAFIs is independent, and there will be a best SAFI-1 route to P as
   well as a best SAFI-4 route to P.  Which packets get forwarded
   according to the routes of which SAFI is then a matter of local
   policy.

   Other implementations may treat the SAFI-1 and SAFI-4 routes for a
   given prefix as comparable, such that the best route to prefix P is
   either a SAFI-1 route or a SAFI-4 route but not both.  In such
   implementations, if load-balancing is done among a set of equal cost
   routes, some of the equal cost routes may be SAFI-1 routes and some
   may be SAFI-4 routes.  Whether this is allowed is, again, a matter of
   local policy.

   Some implementations may allow a single BGP session to carry UPDATEs
   of both SAFI-1 and SAFI-4; other implementations may disallow this.
   Some implementations that allow both SAFIs on the same session may
   treat the receipt of a SAFI-1 route for prefix P on a given session




<span class="grey">Rosen                        Standards Track                   [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


   as an implicit withdrawal of a previous SAFI-4 route for prefix P on
   that session, and vice versa.  Other implementations may have
   different behavior.

   A BGP speaker may receive a SAFI-4 route over a given BGP session but
   may have other BGP sessions for which SAFI-4 is not enabled.  In this
   case, the BGP speaker MAY convert the SAFI-4 route to a SAFI-1 route
   and then propagate the result over the session on which SAFI-4 is not
   enabled.  Whether this is done is a matter of local policy.

   These differences in the behavior of different implementations may
   result in unexpected behavior or lack of interoperability.  In some
   cases, it may be difficult or impossible to achieve the desired
   policies with certain implementations or combinations of
   implementations.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  IANA Considerations</span>

   IANA has assigned value 8 for Multiple Labels Capability in the BGP
   "Capability Codes" registry, with this document as the reference.

   IANA has modified the BGP "Capability Codes" registry to mark value 4
   ("Multiple routes to a destination capability") as deprecated, with
   this document as the reference.

   IANA has changed the reference for SAFI 4 in the "Subsequent Address
   Family Identifiers (SAFI) Parameters" registry to this document.

   Also, IANA has added this document as a reference for SAFI 128 in
   that same registry.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Security%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Security Considerations</span>

   The security considerations of BGP (as specified in [<a href="rfc4271.html" title='"A Border Gateway Protocol 4 (BGP-4)"'>RFC4271</a>]) apply.

   If a BGP implementation that is not conformant with the current
   document encodes multiple labels in the NLRI but has not sent and
   received the Multiple Labels Capability, a BGP implementation that
   does conform with the current document will likely reset the BGP
   session.

   This document specifies that certain data packets be "tunneled" from
   one BGP speaker to another.  This requires that the packets be
   encapsulated while in flight.  This document does not specify the
   encapsulation to be used.  However, if a particular encapsulation is
   used, the security considerations of that encapsulation are
   applicable.




<span class="grey">Rosen                        Standards Track                   [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


   If a particular tunnel encapsulation does not provide integrity and
   authentication, it is possible that a data packet's label stack can
   be modified, through error or malfeasance, while the packet is in
   flight.  This can result in misdelivery of the packet.  It should be
   noted that the tunnel encapsulation (MPLS) most commonly used in
   deployments of this specification does not provide integrity or
   authentication; neither do the other tunnel encapsulations mentioned
   in <a href="#section-4">Section 4</a>.

   There are various techniques one can use to constrain the
   distribution of BGP UPDATE messages.  If a BGP UPDATE advertises the
   binding of a particular label or set of labels to a particular
   address prefix, such techniques can be used to control the set of BGP
   speakers that are intended to learn of that binding.  However, if BGP
   sessions do not provide privacy, other routers may learn of that
   binding.

   When a BGP speaker processes a received MPLS data packet whose top
   label it advertised, there is no guarantee that the label in question
   was put on the packet by a router that was intended to know about
   that label binding.  If a BGP speaker is using the procedures of this
   document, it may be useful for that speaker to distinguish its
   "internal" interfaces from its "external" interfaces and to avoid
   advertising the same labels to BGP speakers reached on internal
   interfaces as to BGP speakers reached on external interfaces.  Then,
   a data packet can be discarded if its top label was not advertised
   over the type of interface from which the packet was received.  This
   reduces the likelihood of forwarding packets whose labels have been
   "spoofed" by untrusted sources.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20References"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Normative%20References"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC3031" name="ref-RFC3031">RFC3031</a>]  Rosen, E., Viswanathan, A., and R. Callon, "Multiprotocol
              Label Switching Architecture", <a href="rfc3031.html">RFC 3031</a>,
              DOI 10.17487/RFC3031, January 2001,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3031">https://www.rfc-editor.org/info/rfc3031</a>&gt;.

   [<a id="ref-RFC3032" name="ref-RFC3032">RFC3032</a>]  Rosen, E., Tappan, D., Fedorkow, G., Rekhter, Y.,
              Farinacci, D., Li, T., and A. Conta, "MPLS Label Stack
              Encoding", <a href="rfc3032.html">RFC 3032</a>, DOI 10.17487/RFC3032, January 2001,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3032">https://www.rfc-editor.org/info/rfc3032</a>&gt;.



<span class="grey">Rosen                        Standards Track                   [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


   [<a id="ref-RFC3107" name="ref-RFC3107">RFC3107</a>]  Rekhter, Y. and E. Rosen, "Carrying Label Information in
              BGP-4", <a href="rfc3107.html">RFC 3107</a>, DOI 10.17487/RFC3107, May 2001,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3107">https://www.rfc-editor.org/info/rfc3107</a>&gt;.

   [<a id="ref-RFC3443" name="ref-RFC3443">RFC3443</a>]  Agarwal, P. and B. Akyol, "Time To Live (TTL) Processing
              in Multi-Protocol Label Switching (MPLS) Networks",
              <a href="rfc3443.html">RFC 3443</a>, DOI 10.17487/RFC3443, January 2003,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3443">https://www.rfc-editor.org/info/rfc3443</a>&gt;.

   [<a id="ref-RFC4271" name="ref-RFC4271">RFC4271</a>]  Rekhter, Y., Ed., Li, T., Ed., and S. Hares, Ed., "A
              Border Gateway Protocol 4 (BGP-4)", <a href="rfc4271.html">RFC 4271</a>,
              DOI 10.17487/RFC4271, January 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4271">https://www.rfc-editor.org/info/rfc4271</a>&gt;.

   [<a id="ref-RFC4364" name="ref-RFC4364">RFC4364</a>]  Rosen, E. and Y. Rekhter, "BGP/MPLS IP Virtual Private
              Networks (VPNs)", <a href="rfc4364.html">RFC 4364</a>, DOI 10.17487/RFC4364, February
              2006, &lt;<a href="https://www.rfc-editor.org/info/rfc4364">https://www.rfc-editor.org/info/rfc4364</a>&gt;.

   [<a id="ref-RFC4659" name="ref-RFC4659">RFC4659</a>]  De Clercq, J., Ooms, D., Carugi, M., and F. Le Faucheur,
              "BGP-MPLS IP Virtual Private Network (VPN) Extension for
              IPv6 VPN", <a href="rfc4659.html">RFC 4659</a>, DOI 10.17487/RFC4659, September 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4659">https://www.rfc-editor.org/info/rfc4659</a>&gt;.

   [<a id="ref-RFC4760" name="ref-RFC4760">RFC4760</a>]  Bates, T., Chandra, R., Katz, D., and Y. Rekhter,
              "Multiprotocol Extensions for BGP-4", <a href="rfc4760.html">RFC 4760</a>,
              DOI 10.17487/RFC4760, January 2007,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4760">https://www.rfc-editor.org/info/rfc4760</a>&gt;.

   [<a id="ref-RFC4798" name="ref-RFC4798">RFC4798</a>]  De Clercq, J., Ooms, D., Prevost, S., and F. Le Faucheur,
              "Connecting IPv6 Islands over IPv4 MPLS Using IPv6
              Provider Edge Routers (6PE)", <a href="rfc4798.html">RFC 4798</a>,
              DOI 10.17487/RFC4798, February 2007,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4798">https://www.rfc-editor.org/info/rfc4798</a>&gt;.

   [<a id="ref-RFC5462" name="ref-RFC5462">RFC5462</a>]  Andersson, L. and R. Asati, "Multiprotocol Label Switching
              (MPLS) Label Stack Entry: "EXP" Field Renamed to "Traffic
              Class" Field", <a href="rfc5462.html">RFC 5462</a>, DOI 10.17487/RFC5462, February
              2009, &lt;<a href="https://www.rfc-editor.org/info/rfc5462">https://www.rfc-editor.org/info/rfc5462</a>&gt;.

   [<a id="ref-RFC5492" name="ref-RFC5492">RFC5492</a>]  Scudder, J. and R. Chandra, "Capabilities Advertisement
              with BGP-4", <a href="rfc5492.html">RFC 5492</a>, DOI 10.17487/RFC5492, February
              2009, &lt;<a href="https://www.rfc-editor.org/info/rfc5492">https://www.rfc-editor.org/info/rfc5492</a>&gt;.

   [<a id="ref-RFC5549" name="ref-RFC5549">RFC5549</a>]  Le Faucheur, F. and E. Rosen, "Advertising IPv4 Network
              Layer Reachability Information with an IPv6 Next Hop",
              <a href="rfc5549.html">RFC 5549</a>, DOI 10.17487/RFC5549, May 2009,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5549">https://www.rfc-editor.org/info/rfc5549</a>&gt;.




<span class="grey">Rosen                        Standards Track                   [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


   [<a id="ref-RFC7606" name="ref-RFC7606">RFC7606</a>]  Chen, E., Ed., Scudder, J., Ed., Mohapatra, P., and K.
              Patel, "Revised Error Handling for BGP UPDATE Messages",
              <a href="rfc7606.html">RFC 7606</a>, DOI 10.17487/RFC7606, August 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7606">https://www.rfc-editor.org/info/rfc7606</a>&gt;.

   [<a id="ref-RFC8174" name="ref-RFC8174">RFC8174</a>]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in <a href="rfc2119.html">RFC</a>
              <a href="rfc2119.html">2119</a> Key Words", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc8174.html">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Informative%20References"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Informative References</span>

   [<a id="ref-Enhanced-GR" name="ref-Enhanced-GR">Enhanced-GR</a>]
              Patel, K., Chen, E., Fernando, R., and J. Scudder,
              "Accelerated Routing Convergence for BGP Graceful
              Restart", Work in Progress,
              <a href="https://tools.ietf.org/html/draft-ietf-idr-enhanced-gr-06">draft-ietf-idr-enhanced-gr-06</a>, June 2016.

   [<a id="ref-RFC4724" name="ref-RFC4724">RFC4724</a>]  Sangli, S., Chen, E., Fernando, R., Scudder, J., and Y.
              Rekhter, "Graceful Restart Mechanism for BGP", <a href="rfc4724.html">RFC 4724</a>,
              DOI 10.17487/RFC4724, January 2007,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4724">https://www.rfc-editor.org/info/rfc4724</a>&gt;.

   [<a id="ref-RFC5331" name="ref-RFC5331">RFC5331</a>]  Aggarwal, R., Rekhter, Y., and E. Rosen, "MPLS Upstream
              Label Assignment and Context-Specific Label Space",
              <a href="rfc5331.html">RFC 5331</a>, DOI 10.17487/RFC5331, August 2008,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5331">https://www.rfc-editor.org/info/rfc5331</a>&gt;.

   [<a id="ref-RFC6514" name="ref-RFC6514">RFC6514</a>]  Aggarwal, R., Rosen, E., Morin, T., and Y. Rekhter, "BGP
              Encodings and Procedures for Multicast in MPLS/BGP IP
              VPNs", <a href="rfc6514.html">RFC 6514</a>, DOI 10.17487/RFC6514, February 2012,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6514">https://www.rfc-editor.org/info/rfc6514</a>&gt;.

   [<a id="ref-RFC7432" name="ref-RFC7432">RFC7432</a>]  Sajassi, A., Ed., Aggarwal, R., Bitar, N., Isaac, A.,
              Uttaro, J., Drake, J., and W. Henderickx, "BGP MPLS-Based
              Ethernet VPN", <a href="rfc7432.html">RFC 7432</a>, DOI 10.17487/RFC7432, February
              2015, &lt;<a href="https://www.rfc-editor.org/info/rfc7432">https://www.rfc-editor.org/info/rfc7432</a>&gt;.

   [<a id="ref-RFC7911" name="ref-RFC7911">RFC7911</a>]  Walton, D., Retana, A., Chen, E., and J. Scudder,
              "Advertisement of Multiple Paths in BGP", <a href="rfc7911.html">RFC 7911</a>,
              DOI 10.17487/RFC7911, July 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7911">https://www.rfc-editor.org/info/rfc7911</a>&gt;.

   [<a id="ref-TUNNEL-ENCAPS" name="ref-TUNNEL-ENCAPS">TUNNEL-ENCAPS</a>]
              Rosen, E., Patel, K., and G. Velde, "The BGP Tunnel
              Encapsulation Attribute", Work in Progress,
              <a href="https://tools.ietf.org/html/draft-ietf-idr-tunnel-encaps-07">draft-ietf-idr-tunnel-encaps-07</a>, July 2017.





<span class="grey">Rosen                        Standards Track                   [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc8277.html">RFC 8277</a>            BGP and Labeled Address Prefixes        October 2017</span>


Acknowledgements

   This document obsoletes <a href="rfc3107.html">RFC 3107</a>.  We wish to thank Yakov Rekhter,
   co-author of <a href="rfc3107.html">RFC 3107</a>, for his work on that document.  We also wish
   to thank Ravi Chandra, Enke Chen, Srihari R. Sangli, Eric Gray, and
   Liam Casey for their review of and comments on that document.

   We thank Alexander Okonnikov and David Lamparter for pointing out a
   number of the errors in <a href="rfc3107.html">RFC 3107</a>.

   We wish to thank Lili Wang and Kaliraj Vairavakkalai for their help
   and advice during the preparation of this document.

   We also thank Mach Chen, Bruno Decraene, Jie Dong, Adrian Farrel,
   Jeff Haas, Jonathan Hardwick, Jakob Heitz, Alexander Okonnikov, Keyur
   Patel, Kevin Wang, and Lucy Yong for their review of and comments on
   this document.

Author's Address

   Eric C. Rosen
   Juniper Networks, Inc.
   10 Technology Park Drive
   Westford, Massachusetts  01886
   United States of America

   Email: erosen@juniper.net
























Rosen                        Standards Track                   [Page 23]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc8277 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:15 GMT --></html>