<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc5408 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 28 Apr 2015 16:01:29 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.111" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:5408" name="DC.Identifier"/>
<meta content="This document describes the security architecture required to
implement identity-based encryption, a public-key encryption
technology that uses a user's identity as a public key. It also
defines data structures that can be used to implement the technology.
This memo provides information for the Internet community." name="DC.Description.Abstract"/>
<meta content="Martin, Luther" name="DC.Creator"/>
<meta content="Appenzeller, Guido" name="DC.Creator"/>
<meta content="Schertler, Mark" name="DC.Creator"/>
<meta content="January, 2009" name="DC.Date.Issued"/>
<meta content="Identity-Based Encryption Architecture and Supporting Data Structures" name="DC.Title"/>

    <link href="http://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="http://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5408 - Identity-Based Encryption Architecture and Supporting Data Structures</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc5408.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc5408" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-ietf-smime-ibearch" title="draft-ietf-smime-ibearch">draft-ietf-smime-...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5408" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc5408" title="Side-by-side diff">Diff2</a>] [<a href="https://datatracker.ietf.org/ipr/search/?option=rfc_search&amp;rfc_search=5408" title="IPR disclosures related to this document">IPR</a>]           </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                     G. Appenzeller
Request for Comments: 5408                           Stanford University
Category: Informational                                        L. Martin
                                                        Voltage Security
                                                            M. Schertler
                                                                   Axway
                                                            January 2009


 <span class="h1">Identity-Based Encryption Architecture and Supporting Data Structures</span>

Status of This Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Copyright Notice

   Copyright (c) 2009 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/</a>
   <a href="http://trustee.ietf.org/license-info">license-info</a>) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.

Abstract

   This document describes the security architecture required to
   implement identity-based encryption, a public-key encryption
   technology that uses a user's identity as a public key.  It also
   defines data structures that can be used to implement the technology.

















<span class="grey">Appenzeller, et al.          Informational                      [Page 1]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Terminology ................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Identity-Based Encryption .......................................<a href="#page-3">3</a>
      <a href="#section-2.1">2.1</a>. Overview ...................................................<a href="#page-3">3</a>
      <a href="#section-2.2">2.2</a>. Sending a Message That Is IBE-Encrypted ....................<a href="#page-5">5</a>
           <a href="#section-2.2.1">2.2.1</a>. Sender Obtains Public Parameters ....................<a href="#page-5">5</a>
           <a href="#section-2.2.2">2.2.2</a>. Construct and Send an IBE-Encrypted Message .........<a href="#page-6">6</a>
      <a href="#section-2.3">2.3</a>. Receiving and Viewing an IBE-Encrypted Message .............<a href="#page-6">6</a>
           <a href="#section-2.3.1">2.3.1</a>. Recipient Obtains Public Parameters .................<a href="#page-7">7</a>
           <a href="#section-2.3.2">2.3.2</a>. Recipient Obtains IBE Private Key ...................<a href="#page-8">8</a>
           <a href="#section-2.3.3">2.3.3</a>. Recipient Decrypts IBE-Encrypted Message ............<a href="#page-8">8</a>
   <a href="#section-3">3</a>. Identity Format .................................................<a href="#page-9">9</a>
   <a href="#section-4">4</a>. Public Parameter Lookup .........................................<a href="#page-9">9</a>
      <a href="#section-4.1">4.1</a>. Request Method ............................................<a href="#page-10">10</a>
      <a href="#section-4.2">4.2</a>. Parameter and Policy Format ...............................<a href="#page-11">11</a>
      <a href="#section-4.3">4.3</a>. The application/ibe-pp-data MIME Type .....................<a href="#page-14">14</a>
   <a href="#section-5">5</a>. Private Key Request Protocol ...................................<a href="#page-15">15</a>
      <a href="#section-5.1">5.1</a>. Overview ..................................................<a href="#page-15">15</a>
      <a href="#section-5.2">5.2</a>. Private Key Request .......................................<a href="#page-15">15</a>
      <a href="#section-5.3">5.3</a>. Request Structure .........................................<a href="#page-16">16</a>
      <a href="#section-5.4">5.4</a>. The application/ibe-key-request+xml MIME type .............<a href="#page-17">17</a>
      <a href="#section-5.5">5.5</a>. Authentication ............................................<a href="#page-18">18</a>
      <a href="#section-5.6">5.6</a>. Server Response Format ....................................<a href="#page-18">18</a>
           <a href="#section-5.6.1">5.6.1</a>. The IBE100 responseCode ............................<a href="#page-19">19</a>
           <a href="#section-5.6.2">5.6.2</a>. The IBE101 responseCode ............................<a href="#page-20">20</a>
           <a href="#section-5.6.3">5.6.3</a>. The IBE201 responseCode ............................<a href="#page-20">20</a>
           <a href="#section-5.6.4">5.6.4</a>. The IBE300 responseCode ............................<a href="#page-21">21</a>
           <a href="#section-5.6.5">5.6.5</a>. The IBE301 responseCode ............................<a href="#page-21">21</a>
           <a href="#section-5.6.6">5.6.6</a>. The IBE303 responseCode ............................<a href="#page-21">21</a>
           <a href="#section-5.6.7">5.6.7</a>. The IBE304 responseCode ............................<a href="#page-22">22</a>
      <a href="#section-5.7">5.7</a>. The application/ibe-pkg-reply+xml MIME type ...............<a href="#page-22">22</a>
   <a href="#section-6">6</a>. ASN.1 Module ...................................................<a href="#page-23">23</a>
   <a href="#section-7">7</a>. Security Considerations ........................................<a href="#page-25">25</a>
      <a href="#section-7.1">7.1</a>. Attacks outside the Scope of This Document ................<a href="#page-25">25</a>
      <a href="#section-7.2">7.2</a>. Attacks within the Scope of This Document .................<a href="#page-26">26</a>
           <a href="#section-7.2.1">7.2.1</a>. Attacks on the Protocols Defined in This Document ..<a href="#page-26">26</a>
   <a href="#section-8">8</a>. IANA Considerations ............................................<a href="#page-27">27</a>
      <a href="#section-8.1">8.1</a>. Media Types ...............................................<a href="#page-27">27</a>
      <a href="#section-8.2">8.2</a>. XML Namespace .............................................<a href="#page-27">27</a>
   <a href="#section-9">9</a>. References .....................................................<a href="#page-28">28</a>
      <a href="#section-9.1">9.1</a>. Normative References ......................................<a href="#page-28">28</a>
      <a href="#section-9.2">9.2</a>. Informative References ....................................<a href="#page-29">29</a>







<span class="grey">Appenzeller, et al.          Informational                      [Page 2]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>. Introduction</span>

   This document describes the security architecture required to
   implement identity-based encryption, a public-key encryption
   technology that uses a user's identity as a public key.  It also
   defines data structures that are required to implement the
   technology.  Objects used in this implementation are defined using
   ASN.1 [<a href="#ref-ASN1">ASN1</a>] and XML [<a href="#ref-XML" title="Extensible Markup Language (XML) 1.0 (Fourth Edition)">XML</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Terminology"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="#ref-KEY" title='"Key words for use in RFCs to Indicate Requirement Levels"'>KEY</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Identity-Based%20Encryption"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Identity-Based Encryption</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Overview"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Overview</span>

   Identity-based encryption (IBE) is a public-key encryption technology
   that allows a public key to be calculated from an identity and a set
   of public mathematical parameters and that allows for the
   corresponding private key to be calculated from an identity, a set of
   public mathematical parameters, and a domain-wide secret value.  An
   IBE public key can be calculated by anyone who has the necessary
   public parameters; a cryptographic secret is needed to calculate an
   IBE private key, and the calculation can only be performed by a
   trusted server that has this secret.

   Calculation of both the public and private keys in an IBE system can
   occur as needed, resulting in just-in-time creation of both public
   and private keys.  This contrasts with other public-key systems
   [<a href="#ref-P1363" title='"Standard Specifications for Public-Key Cryptography"'>P1363</a>], in which keys are generated randomly and distributed prior
   to secure communication commencing, and in which private encryption
   keys need to be securely archived to allow for their recovery if they
   are lost or destroyed.  The ability to calculate a recipient's public
   key, in particular, eliminates the need for the sender and receiver
   to interact with each other, either directly or through a proxy such
   as a directory server, before sending secure messages.

   A characteristic of IBE systems that differentiates them from other
   server-based cryptographic systems is that once a set of public
   parameters is fetched, encryption is possible with no further
   communication with a server during the validity period of the public
   parameters.  Other server-based systems may require a connection to a
   server for each encryption operation.





<span class="grey">Appenzeller, et al.          Informational                      [Page 3]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


   This document describes an IBE-based messaging system, how the
   components of such a system work together, and defines data
   structures that support the operation of such a system.  The server
   components required for such a system are the following:

      o  A Public Parameter Server (PPS).  IBE public parameters include
         publicly-sharable cryptographic material, known as IBE public
         parameters, and policy information for an associated PKG.  A
         PPS provides a well-known location for secure distribution of
         IBE public parameters and policy information that describe the
         operation of a PKG.  <a href="#section-5">Section 5</a> of this document describes the
         protocol that a client uses to communicate with a PPS.

      o  A Private-key Generator (PKG).  The PKG stores and uses
         cryptographic material, known as a master secret, which is used
         for generating a user's IBE private key.  A PKG accepts an IBE
         user's private key request, and after successfully
         authenticating them in some way, returns their IBE private key.
         <a href="#section-5">Section 5</a> of this document describes the protocol that a client
         uses to communicate with a PKG.

   A logical architecture of such an IBE system would be to have a PKG
   and PPS per name space, such as a DNS zone.  The organization that
   controls the DNS zone would also control the PKG and PPS and thus the
   determination of which PKG or PPS to use when creating public and
   private keys for the organization's members.  In this case, the PPS
   URI/IRI can be uniquely created from a user-friendly name for the
   form of identity that the PPS supports.  This architecture would make
   it clear which set of public parameters to use and where to retrieve
   them for a given identity (for example, an <a href="rfc2821.html">RFC 2821</a> address [<a href="#ref-SMTP" title='"Simple Mail Transfer Protocol"'>SMTP</a>]).

   IBE-encrypted messages can use standard message formats, such as the
   Cryptographic Message Syntax [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>].  How to use IBE with the CMS to
   encrypt email messages is defined in [<a href="#ref-IBECMS" title='"Using the Boneh-Franklin Identity-Based Encryption Algorithm with the Cryptographic Message Syntax (CMS)"'>IBECMS</a>].

   Note that IBE algorithms are used only for encryption, so if digital
   signatures are required, they will need to be provided by an
   additional mechanism.

   <a href="#section-3">Section 3</a> of this document describes the identity format that all PPS
   and PKG servers MUST support.










<span class="grey">Appenzeller, et al.          Informational                      [Page 4]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Sending%20a%20Message%20That%20Is%20IBE-Encrypted"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Sending a Message That Is IBE-Encrypted</span>

   In order to send an encrypted message, an IBE user must perform the
   following steps:

      1. Obtain the recipient's public parameters

         The public parameters of the recipient's system are needed to
         perform IBE operations.  Once a user obtains these public
         parameters, he can perform IBE encryption operations.  These
         public parameters may be available at a PPS that is operated by
         the user's organization, one that is operated by the sender's
         organization, or by a different organization entirely.

      2. Construct and send an IBE-encrypted message

         In addition to the IBE public parameters, all that is needed to
         construct an IBE-encrypted message is the recipient's identity,
         the form of which is defined by the public parameters.  When
         this identity is the same as the identity that a message would
         be addressed to, then no more information is needed from a user
         to send them an encrypted message than is needed to send them
         an unencrypted message.  This is one of the major benefits of
         an IBE-based secure messaging system.  Examples of identities
         are individual, group, or role identifiers.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.1.%20%20Sender%20Obtains%20Public%20Parameters"></a><a class="selflink" href="#section-2.2.1" name="section-2.2.1">2.2.1</a>.  Sender Obtains Public Parameters</span>

   The sender of a message obtains the IBE public parameters that he
   needs from a PPS that is hosted at a well-known URI or IRI.  The IBE
   public parameters contain all of the information that the sender
   needs to create an IBE-encrypted message except for the identity of
   the recipient.  <a href="#section-4">Section 4</a> of this document describes the URI [<a href="#ref-URI" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI</a>] or
   IRI [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>] of a PPS, the format of IBE public parameters, and how to
   obtain them from a PPS.  The URI or IRI from which users obtain IBE
   public parameters MUST be authenticated in some way.  PPS servers
   MUST support TLS 1.2 [<a href="#ref-TLS" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>TLS</a>] to satisfy this requirement and SHOULD
   support its successors.  This step is shown below in Figure 1.

                     IBE Public Parameter Request
                    -----------------------------&gt;
             Sender                                PPS
                    &lt;-----------------------------
                         IBE Public Parameters

             Figure 1: Requesting IBE Public Parameters





<span class="grey">Appenzeller, et al.          Informational                      [Page 5]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


   The sender of an IBE-encrypted message selects the PPS and
   corresponding PKG based on his local security policy.  Different PPS
   servers may provide public parameters that specify different IBE
   algorithms or different key strengths, for example.  Or, they may
   require the use of PKG servers that require different levels of
   authentication before granting IBE private keys.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.2.%20%20Construct%20and%20Send%20an%20IBE-Encrypted%20Message"></a><a class="selflink" href="#section-2.2.2" name="section-2.2.2">2.2.2</a>.  Construct and Send an IBE-Encrypted Message</span>

   To IBE-encrypt a message, the sender chooses a content-encryption key
   (CEK) and uses it to encrypt his message and then encrypts the CEK
   with the recipient's IBE public key as described in [<a href="#ref-CMS" title='"Cryptographic Message Syntax (CMS)"'>CMS</a>].  This
   operation is shown below in Figure 2.  The document [<a href="#ref-IBCS" title='"Identity-Based Cryptography Standard (IBCS) #1: Supersingular Curve Implementations of the BF and BB1 Cryptosystems"'>IBCS</a>] describes
   the algorithms needed to implement two forms of IBE, and [<a href="#ref-IBECMS" title='"Using the Boneh-Franklin Identity-Based Encryption Algorithm with the Cryptographic Message Syntax (CMS)"'>IBECMS</a>]
   describes how to use the Cryptographic Message Syntax (CMS) to
   encapsulate the encrypted message along with the IBE information that
   the recipient needs to decrypt an email message.

                      CEK ----&gt; Sender ----&gt; IBE-encrypted CEK

                                  ^
                                  |
                                  |

                         Recipient's Identity
                       and IBE Public Parameters

           Figure 2: Using an IBE Public-key Algorithm to Encrypt

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20Receiving%20and%20Viewing%20an%20IBE-Encrypted%20Message"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  Receiving and Viewing an IBE-Encrypted Message</span>

   In order to read an IBE-encrypted message, a recipient of such a
   message parses it to find the URI or IRI he needs in order to obtain
   the IBE public parameters that are required to perform IBE
   calculations as well as to obtain a component of the identity that
   was used to encrypt the message.  Next, the recipient carries out the
   following steps:

      1. Obtain the IBE public parameters

         An IBE system's public parameters allow it to uniquely create
         public and private keys.  The recipient of an IBE-encrypted
         message can decrypt an IBE-encrypted message if he has both the
         IBE public parameters and the necessary IBE private key.  The
         public parameters also provide the URI or IRI of the PKG where
         the recipient of an IBE-encrypted message can obtain the IBE
         private keys.




<span class="grey">Appenzeller, et al.          Informational                      [Page 6]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


      2. Obtain the IBE private key from the PKG

         To decrypt an IBE-encrypted message, in addition to the IBE
         public parameters, the recipient needs to obtain the private
         key that corresponds to the public key that the sender used.
         The IBE private key is obtained after successfully
         authenticating to a private key generator (PKG), a trusted
         third party that calculates private keys for users.  The
         recipient then receives the IBE private key over a secure
         connection.

      3. Decrypt the IBE-encrypted Message

         The IBE private key decrypts the CEK (see <a href="#section-2.3.3">Section 2.3.3</a>).  The
         CEK is then used to decrypt the encrypted message.

   It may be useful for a PKG to allow users other than the intended
   recipient to receive some IBE private keys.  Giving a mail-filtering
   appliance permission to obtain IBE private keys on behalf of users,
   for example, can allow the appliance to decrypt and scan encrypted
   messages for viruses or other malicious features.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.3.1.%20%20Recipient%20Obtains%20Public%20Parameters"></a><a class="selflink" href="#section-2.3.1" name="section-2.3.1">2.3.1</a>.  Recipient Obtains Public Parameters</span>

   Before he can perform any IBE calculations related to the message
   that he has received, the recipient of an IBE-encrypted message needs
   to obtain the IBE public parameters that were used in the encryption
   operation.  This operation is shown below in Figure 3.  Because the
   use of the correct public parameters is vital to the overall security
   of an IBE system, IBE public parameters MUST be transported to
   recipients over a secure protocol.  PPS servers MUST support TLS 1.2
   [<a href="#ref-TLS" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>TLS</a>] or its successors, using the latest version supported by both
   parties, for transport of IBE public parameters.  In addition, users
   MUST verify that the subject name in the server certificate matches
   the URI/IRI of the PPS.  The comments in <a href="#section-2.2.1">Section 2.2.1</a> also apply to
   this operation.

                        IBE Public Parameter Request
                       -----------------------------&gt;
             Recipient                                PPS
                       &lt;-----------------------------
                            IBE Public Parameters

               Figure 3: Requesting IBE Public Parameters







<span class="grey">Appenzeller, et al.          Informational                      [Page 7]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.3.2.%20%20Recipient%20Obtains%20IBE%20Private%20Key"></a><a class="selflink" href="#section-2.3.2" name="section-2.3.2">2.3.2</a>.  Recipient Obtains IBE Private Key</span>

   To obtain an IBE private key, the recipient of an IBE-encrypted
   message provides the IBE public key used to encrypt the message and
   their authentication credentials to a PKG and requests the private
   key that corresponds to the IBE public key.  <a href="#section-5">Section 5</a> of this
   document defines the protocol for communicating with a PKG as well as
   a minimum interoperable way to authenticate to a PKG that all IBE
   implementations MUST support.  Because the security of IBE private
   keys is vital to the overall security of an IBE system, IBE private
   keys MUST be transported to recipients over a secure protocol.  PKG
   servers MUST support TLS 1.2 [<a href="#ref-TLS" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>TLS</a>] or its successors, using the
   latest version supported by both parties, for transport of IBE
   private keys.  This operation is shown below in Figure 4.

                          IBE Private Key Request
                       ----------------------------&gt;
             Recipient                                PKG
                       &lt;----------------------------
                              IBE Private Key

                 Figure 4: Obtaining an IBE Private Key

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.3.3.%20%20Recipient%20Decrypts%20IBE-Encrypted%20Message"></a><a class="selflink" href="#section-2.3.3" name="section-2.3.3">2.3.3</a>.  Recipient Decrypts IBE-Encrypted Message</span>

   After obtaining the necessary IBE private key, the recipient uses
   that IBE private key and the corresponding IBE public parameters to
   decrypt the CEK.  This operation is shown below in Figure 5.  He then
   uses the CEK to decrypt the encrypted message content.  An example of
   how to do this with email messages is given in [<a href="#ref-IBECMS" title='"Using the Boneh-Franklin Identity-Based Encryption Algorithm with the Cryptographic Message Syntax (CMS)"'>IBECMS</a>].

        IBE-encrypted CEK ----&gt; Recipient ----&gt; CEK

                                    ^
                                    |
                                    |

                            IBE Private Key
                        and IBE Public Parameters

       Figure 5: Using an IBE Public-Key Algorithm to Decrypt










<span class="grey">Appenzeller, et al.          Informational                      [Page 8]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Identity%20Format"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Identity Format</span>

   An IBEIdentityInfo type MUST be used to represent the identity of a
   recipient.  This is defined to be the following:

   IBEIdentityInfo ::= SEQUENCE {
     district        IA5String,
     serial          INTEGER,
     identityType    OBJECT IDENTIFIER,
     identityData    OCTET STRING
   }

   An IBEIdentityInfo type is used to calculate public and private IBE
   keys.  Because of this, such a structure is typically DER-encoded
   [<a href="#ref-DER">DER</a>].

   The fields of an IBEIdentityInfo structure have the following
   meanings.

   The district is an IA5String that represents the URI [<a href="#ref-URI" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI</a>] or IRI
   [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>] where the recipient of an IBE-encrypted message can retrieve
   the IBE public parameters needed to encrypt or decrypt a message
   encrypted for this identity.  Applications MUST support the method
   described in <a href="#section-4">Section 4</a> for doing this and MAY support other methods.
   IRIs MUST be handled according to the procedures specified in <a href="#section-7.4">Section</a>
   <a href="#section-7.4">7.4</a> of [<a href="#ref-PKIX" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>PKIX</a>].

   The serial is an INTEGER that defines a unique set of IBE public
   parameters in the event that more than one set of parameters is used
   by a single district.

   identityType is an OBJECT IDENTIFIER that defines the format that the
   identityData field is encoded with.

   An example of a useful IBEIdentityInfo type is given in [<a href="#ref-IBECMS" title='"Using the Boneh-Franklin Identity-Based Encryption Algorithm with the Cryptographic Message Syntax (CMS)"'>IBECMS</a>].
   This example is tailored to the use of IBE in encrypting email.
   Because the information that comprises an identity is very dependent
   on the application, this document does not define an identityType
   that all applications MUST support.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Public%20Parameter%20Lookup"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Public Parameter Lookup</span>

   This section specifies how a component of an IBE system can retrieve
   the public parameters.  A sending or receiving client MUST allow
   configuration of these parameters manually, for example, through
   editing a configuration file.  However, for simplified configuration,
   a client SHOULD also implement the public parameter URI/IRI request
   method described in this document to fetch the public parameters



<span class="grey">Appenzeller, et al.          Informational                      [Page 9]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


   based on a configured URI/IRI.  This is especially useful for
   federating between IBE systems.  By specifying a single URI/IRI, a
   client can be configured to fetch all the relevant parameters for a
   remote PKG.  These public parameters can then be used to encrypt
   messages to recipients who authenticate to and retrieve private keys
   from that PKG.

   The following section outlines the URI/IRI request method to retrieve
   a parameter block and describes the structure of the parameter block
   itself.  The technique for fetching IBE public parameters using the
   process defined in this section is indicated by the OID uriPPSOID,
   which is defined to be the following:

   uriPPSOID OBJECT IDENTIFIER ::= {
     joint-iso-itu-t(2) country(16) us(840)
     organization(1) identicrypt(114334)
     pps-schemas(3) ic-schemas(1) pps-uri(1) version(1)
   }

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Request%20Method"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Request Method</span>

   The configuration URI/IRI SHOULD be an HTTPS URI [<a href="#ref-HTTP" title='"Hypertext Transfer Protocol -- HTTP/1.1"'>HTTP</a>] and MAY
   additionally support IRIs [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>] for this purpose.  To retrieve the
   IBE public parameters, the client SHOULD use the HTTP GET method as
   defined in [<a href="#ref-HTTP" title='"Hypertext Transfer Protocol -- HTTP/1.1"'>HTTP</a>].  The request MUST happen over a secure protocol.
   The requesting client MUST support TLS 1.2 [<a href="#ref-TLS" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>TLS</a>] or its successors
   and SHOULD use the latest version supported by both parties.  When
   requesting the URI/IRI, the client MUST only accept the system
   parameter block if the server identity was verified successfully by
   TLS 1.2 [<a href="#ref-TLS" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>TLS</a>] or its successors.

   A successful GET request returns in its body the base64 [<a href="#ref-B64" title='"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"'>B64</a>]
   encoding of the DER-encoded [<a href="#ref-DER">DER</a>] IBESysParams structure that is
   described in the next section.  This structure MUST be encoded as an
   application/ibe-pp-data MIME type.
















<span class="grey">Appenzeller, et al.          Informational                     [Page 10]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Parameter%20and%20Policy%20Format"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Parameter and Policy Format</span>

   The IBE public parameters are a structure of the form

   IBESysParams ::= SEQUENCE {
     version              INTEGER { v2(2) },
     districtName         IA5String,
     districtSerial       INTEGER,
     validity             ValidityPeriod,
     ibePublicParameters  IBEPublicParameters,
     ibeIdentityType      OBJECT IDENTIFIER,
     ibeParamExtensions   IBEParamExtensions OPTIONAL
   }

   The fields of an IBESysParams structure have the following meanings.

   The version field specifies the version of the IBESysParams format.
   For the format described in this document, this MUST be set to 2.

   The districtName field is an IA5String that MUST be an encoding of an
   URI [<a href="#ref-URI" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI</a>] or IRI [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>].  IRIs MUST be handled according to the
   procedures specified in Section 7.4 of [<a href="#ref-PKIX" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>PKIX</a>].

   The districtSerial field is an integer that represents a unique set
   of IBE public parameters that are available at the URI or IRI defined
   by the districtName.  If new parameters are published for a
   districtName, the districtSerial MUST be increased to a number
   greater than the previously-used districtSerial.

   The validity field defines the lifetime of a specific instance of the
   IBESysParams and is defined to be the following:

   ValidityPeriod ::= SEQUENCE {
     notBefore     GeneralizedTime,
     notAfter      GeneralizedTime
   }

   The values of notBefore and notAfter MUST be expressed in Greenwich
   Mean Time (Zulu), MUST include seconds (i.e., times are always
   YYYYMMDDHHMMSSZ), even where the number of seconds is equal to zero,
   and MUST be expressed to the nearest second.

   A client MUST verify that the date on which it uses the IBE public
   parameters falls between the notBefore time and the notAfter time of
   the IBE public parameters, and it MUST NOT use the parameters for IBE
   encryption operations if they do not.





<span class="grey">Appenzeller, et al.          Informational                     [Page 11]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


   IBE public parameters MUST be regenerated and republished whenever
   the values of ibePublicParameters, ibeIdentityType, or
   ibeParamExtensions change for a district.  A client SHOULD refetch
   the IBE public parameters at an application-configurable interval to
   ensure that it has the most current version of the IBE public
   parameters.

   It is possible to create identities for use in IBE that have a time
   component, as described in [<a href="#ref-IBECMS" title='"Using the Boneh-Franklin Identity-Based Encryption Algorithm with the Cryptographic Message Syntax (CMS)"'>IBECMS</a>], for example.  If such an
   identity is used, the time component of the identity MUST fall
   between the notBefore time and the notAfter times of the IBE public
   parameters.

   IBEPublicParameters is a structure containing public parameters that
   correspond to IBE algorithms that the PKG supports.  This structure
   is defined to be following:

   IBEPublicParameters ::= SEQUENCE (1..MAX) OF
     IBEPublicParameter

   IBEPublicParameter  ::= SEQUENCE {
     ibeAlgorithm          OBJECT IDENTIFIER,
     publicParameterData   OCTET STRING
   }

   The ibeAlgorithm OID specifies an IBE algorithm.  The OIDs for two
   IBE algorithms (the Boneh-Franklin and Boneh-Boyen algorithms) and
   their publicParameterData structures are defined in [<a href="#ref-IBCS" title='"Identity-Based Cryptography Standard (IBCS) #1: Supersingular Curve Implementations of the BF and BB1 Cryptosystems"'>IBCS</a>].

   The publicParameterData is a DER-encoded [<a href="#ref-DER">DER</a>] structure that
   contains the actual cryptographic parameters.  Its specific structure
   depends on the algorithm.

   The IBESysParams of a district MUST contain an OID that identifies at
   least one algorithm and MAY contain OIDs that identify more than one
   algorithm.  It MUST NOT contain two or more IBEPublicParameter
   entries with the same algorithm.  A client that wants to use
   IBESysParams can chose any of the algorithms specified in the
   publicParameterData structure.  A client MUST implement at least the
   Boneh-Franklin algorithm [<a href="#ref-IBCS" title='"Identity-Based Cryptography Standard (IBCS) #1: Supersingular Curve Implementations of the BF and BB1 Cryptosystems"'>IBCS</a>] and MAY implement the Boneh-Boyen
   [<a href="#ref-IBCS" title='"Identity-Based Cryptography Standard (IBCS) #1: Supersingular Curve Implementations of the BF and BB1 Cryptosystems"'>IBCS</a>] and other algorithms.  If a client does not support any of the
   supported algorithms, it MUST generate an error message and fail.

   ibeIdentityType is an OID that defines the type of identities that
   are used with this district.  The OIDs and the required and optional
   fields for each OID are application dependent.  An example of this is
   given in [<a href="#ref-IBECMS" title='"Using the Boneh-Franklin Identity-Based Encryption Algorithm with the Cryptographic Message Syntax (CMS)"'>IBECMS</a>], which defines an identity format suitable for use
   in encrypting email.



<span class="grey">Appenzeller, et al.          Informational                     [Page 12]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


   IBEParamExtensions is a set of extensions that can be used to define
   additional parameters that particular implementations may require.
   This structure is defined as follows:

   IBEParamExtensions ::= SEQUENCE OF IBEParamExtension

   IBEParamExtension ::= SEQUENCE {
     ibeParamExtensionOID     OBJECT IDENTIFIER,
     ibeParamExtensionValue   OCTET STRING
   }

   The contents of the octet string ibeParamExtensionValue are defined
   by the specific ibeParamExtensionOID.  The IBEParamExtensions of a
   district MAY have any number of extensions, including zero.  One
   example of extensions that have been used in practice is to provide a
   URI where an encrypted message can be decrypted and viewed by users
   of webmail systems.  Another example is to provide commercial
   branding information, so that a bank can provide a different user
   interface for customers of different lines of business.

   If a client receives public parameters that contain an extension that
   it is unable to process, it MUST NOT use the values in the
   IBESysParams structure for any cryptographic operations.  Clients
   MUST be able to process an IBESysParams structure that contains no
   IBEParamExtensions.

   The pkgURI OID that is defined below defines an IBEParamExtensions
   structure that contains the URI or IRI of a Private Key Generator.
   The presence of this OID in an IBEParamExtension indicates that
   clients MUST use the protocol defined in <a href="#section-5">Section 5</a> of this document
   to obtain IBE private keys from the PKG and MUST do so using the
   URI/IRI that is defined by the ibeParamExtensionValue in the
   IBEParamExtension.

   If the PKG is publicly-accessible, this extension SHOULD be present
   to allow the automatic retrieval of private keys for recipients of
   encrypted messages.  For this extension, the ibeParamExtensionValue
   OCTET STRING is an IA5String containing the URI [<a href="#ref-URI" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI</a>] or IRI [<a href="#ref-IRI" title='"Internationalized Resource Identifiers (IRIs)"'>IRI</a>] of
   the PKG where IBE private keys can be obtained.  IRIs MUST be handled
   according to the procedures specified in Section 7.4 of [<a href="#ref-PKIX" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>PKIX</a>].

   ibeParamExt OBJECT IDENTIFIER ::= {
     ibcs ibcs3(3) parameter-extensions(2)
   }

   pkgURI OBJECT IDENTIFIER ::= { ibeParamExt pkgURI(1) }





<span class="grey">Appenzeller, et al.          Informational                     [Page 13]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20The%20application%2Fibe-pp-data%20MIME%20Type"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  The application/ibe-pp-data MIME Type</span>

   The following summarizes the properties of the
   application/ibe-pp-data MIME type.

   MIME media type name: application

   MIME subtype name: ibe-pp-data

   Mandatory parameters: none

   Optional parameters: none

   Encoding considerations: This media type MUST be encoded as 7-bit
      (US-ASCII text [<a href="#ref-ASCII">ASCII</a>]).

   Security considerations: The data conveyed as this media type are the
      public parameters needed for the operation of a cryptographic
      system.  To ensure that the parameters can be trusted, the request
      for these parameters must take place over a secure protocol, such
      as TLS 1.2 or its successors.  To ensure the validity of the
      server, the client MUST verify the server certificate and MUST
      abort the parameter request if the verification of the server
      certificate of the TLS connection fails.  This media type contains
      no active content and does not use compression.

   Interoperability considerations: There are no known interoperability
      considerations for this media type.

   Applications that use this media type: Applications that implement
      IBE in compliance with this specification will use this media
      type.  The most commonly used of these applications are encrypted
      email and file encryption.

   Additional information: none

   Person and email address for further information: Luther Martin,
      martin@voltage.com.

   Intended usage: COMMON

   Author/Change controller: Luther Martin, martin@voltage.com.









<span class="grey">Appenzeller, et al.          Informational                     [Page 14]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Private%20Key%20Request%20Protocol"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Private Key Request Protocol</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Overview"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Overview</span>

   When requesting a private key, a client has to transmit three
   parameters:

      1. The IBE algorithm for which the key is being requested

      2. The identity for which it is requesting a key

      3. Authentication credentials for the individual requesting the
         key

   The identity for which a client requests a key may not necessarily be
   the same as the identity that the authentication credentials
   validate.  This may happen, for example, when a single user has
   access to multiple aliases.  For example, an email user may have
   access to the keys that correspond to two different email addresses,
   e.g., bob@example.com and bob.smith@example.com.

   This section defines the protocol to request private keys, a minimum
   user authentication method for interoperability, and how to pass
   authentication credentials to the server.  It assumes that a client
   has already determined the URI/IRI of the PKG.  This can be done from
   information included in the IBE message format and the public
   parameters of the IBE system.

   The technique for fetching an IBE private key using the process
   defined in this section is indicated by the OBJECT IDENTIFIER pkgURI,
   which is defined to be the following:

   ibcs OBJECT IDENTIFIER ::= {
     joint-iso-itu-t(2) country(16) us(840)
     organization(1) identicrypt(114334) ibcs(1)
   }

   ibeParamExt OBJECT IDENTIFIER ::= {
     ibcs ibcs3(3) parameter-extensions(2)
   }

   pkgURI OBJECT IDENTIFIER ::= { ibeParamExt pkgURI(1) }

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Private%20Key%20Request"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Private Key Request</span>

   To request a private key, a client MUST perform a HTTP POST method as
   defined in [<a href="#ref-HTTP" title='"Hypertext Transfer Protocol -- HTTP/1.1"'>HTTP</a>].  The request MUST take place over a secure
   protocol.  The requesting client MUST support TLS 1.2 [<a href="#ref-TLS" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>TLS</a>] or its



<span class="grey">Appenzeller, et al.          Informational                     [Page 15]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


   successors, using the latest version supported by both the client and
   the PKG.  When requesting the URI/IRI, the client MUST verify the
   server certificate [<a href="#ref-HTTPTLS" title='"HTTP Over TLS"'>HTTPTLS</a>], and it MUST abort the key request if
   the server certificate verification of the TLS connection fails.
   Doing so is critical to protect the authentication credentials and
   the private key against man-in-the-middle attacks when it is
   transmitted from the key server to the client.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Request%20Structure"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Request Structure</span>

   The POST method contains in its body the following XML structure that
   MUST be encoded as an application/ibe-key-request+xml MIME type:

   &lt;ibe:request xmlns:ibe="urn:ietf:params:xml:ns:ibe"&gt;
      &lt;ibe:header&gt;
         &lt;ibe:client version="clientID"/&gt;
      &lt;/ibe:header&gt;
      &lt;ibe:body&gt;
      &lt;ibe:keyRequest&gt;
         &lt;ibe:algorithm&gt;
            algorithmOID
         &lt;/ibe:algorithm&gt;
         &lt;ibe:id&gt;
            ibeIdentityInfo
         &lt;/ibe:id&gt;
      &lt;/ibe:keyRequest&gt;
      &lt;ibe:authData&gt;
         ibeAuthData
      &lt;/ibe:authData&gt;
      &lt;/ibe:body&gt;
   &lt;/ibe:request&gt;

   A &lt;ibe:request&gt; SHOULD include an &lt;ibe:client&gt; element in the
   &lt;ibe:header&gt; part of a key request that contains an ASCII string that
   identifies the client type and client version.

   A key request MUST contain an &lt;ibe:oid&gt; element that contains the
   base64 [<a href="#ref-B64" title='"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"'>B64</a>] encoding of a DER-encoded [<a href="#ref-DER">DER</a>] object identifier that
   identifies the algorithm for which a key is requested.  OIDs for the
   Boneh-Boyen (BB1) and Boneh-Franklin (BF) algorithms are listed in
   [<a href="#ref-IBCS" title='"Identity-Based Cryptography Standard (IBCS) #1: Supersingular Curve Implementations of the BF and BB1 Cryptosystems"'>IBCS</a>].

   A key request MUST contain an &lt;ibe:id&gt; element that contains the
   identity that the private key is being requested for.  This identity
   is the base64 [<a href="#ref-B64" title='"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"'>B64</a>] encoding of a DER-encoded [<a href="#ref-DER">DER</a>] ASN.1 structure.
   This structure defines a user's identity in a way appropriate for the
   application.  An example of such a structure that is appropriate for
   use in encrypting email is defined in [<a href="#ref-IBECMS" title='"Using the Boneh-Franklin Identity-Based Encryption Algorithm with the Cryptographic Message Syntax (CMS)"'>IBECMS</a>].



<span class="grey">Appenzeller, et al.          Informational                     [Page 16]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


   A key request MAY contain an &lt;ibe:authData&gt; element.  This element
   contains authentication information that the PKG can use to determine
   whether or not a request for a particular IBE private key should be
   granted.

   A client MAY include optional additional XML elements in the
   &lt;ibe:body&gt; part of the key request.  A PKG MUST be able to process
   key requests that contain no such optional elements.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20The%20application%2Fibe-key-request%2Bxml%20MIME%20type"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  The application/ibe-key-request+xml MIME type</span>

   The following summarizes the properties of the
   application/ibe-key-request+xml MIME type.

   MIME media type name: application

   MIME subtype name: ibe-key-request+xml

   Mandatory parameters: none

   Optional parameters: none

   Encoding considerations: This media type MUST be encoded as US-ASCII
      [<a href="#ref-ASCII">ASCII</a>].

   Security considerations: The data conveyed in this media type may
      contain authentication credentials.  Because of this, its
      confidentiality and integrity is extremely important.  To ensure
      this, the request for an IBE private key must take place over a
      secure protocol, such as TLS 1.2 or its successors.  To ensure the
      validity of the server, the client MUST verify the server
      certificate and MUST abort the key request if the verification of
      the server certificate of the TLS connection fails.  This media
      type contains no active content and does not use compression.

   Interoperability considerations: There are no known interoperability
      considerations for this media type.

   Applications that use this media type: Applications that implement
      IBE in compliance with this specification will use this media
      type.  The most commonly used of these applications are encrypted
      email and file encryption.

   Additional information: none

   Person and email address for further information: Luther Martin,
      martin@voltage.com.




<span class="grey">Appenzeller, et al.          Informational                     [Page 17]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


   Intended usage: COMMON

   Author/Change controller: Luther Martin, martin@voltage.com.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.5.%20%20Authentication"></a><a class="selflink" href="#section-5.5" name="section-5.5">5.5</a>.  Authentication</span>

   When a client requests a key from a PKG, the PKG MUST authenticate
   the client before issuing the key.  Authentication may either be done
   through the key request structure or as part of the secure transport
   protocol.

   A client or server implementing the request protocol MUST support
   HTTP Basic Auth [<a href="#ref-AUTH" title='"HTTP Authentication: Basic and Digest Access Authentication"'>AUTH</a>] and SHOULD also support HTTP Digest Auth
   [<a href="#ref-AUTH" title='"HTTP Authentication: Basic and Digest Access Authentication"'>AUTH</a>].  Applications MAY also use other means of authentication that
   are appropriate for the application.  An email application, for
   example, might rely on deployed email infrastructure for this.

   For authentication methods that are not done by the transport
   protocol, a client MAY include additional authentication information
   in XML elements in the &lt;ibe:authData&gt; element of a key request.  If a
   client does not know how to authenticate to a server, the client MAY
   send a key request without authentication information.  If the key
   server requires the client to authenticate externally, it MAY reply
   with an IBE201 responseCode (as defined below) to redirect the client
   to the correct authentication mechanism.  After receiving an
   authentication credential from this external mechanism, a client can
   then use the credential to form a key request that contains the
   additional authentication data.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.6.%20%20Server%20Response%20Format"></a><a class="selflink" href="#section-5.6" name="section-5.6">5.6</a>.  Server Response Format</span>

   The key server replies to the HTTP request with an HTTP response.  If
   the response contains a client error or server error status code, the
   client MUST abort the key request and fail.

   If the PKG replies with an HTTP response that has a status code
   indicating success, the body of the reply MUST contain the following
   XML structure that MUST be encoded as an
   application/ibe-pkg-reply+xml MIME type:

   &lt;ibe:response xmlns:ibe="urn:ietf:params:xml:ns:ibe"&gt;
      &lt;ibe:responseType value="responseCode"/&gt;
      &lt;ibe:body&gt;
         bodyTags
      &lt;/ibe:body&gt;
   &lt;/ibe:response&gt;





<span class="grey">Appenzeller, et al.          Informational                     [Page 18]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


   The responseCode attribute contains an ASCII string that describes
   the type of response from the key server.  The list of currently-
   defined responseCodes and their associated meanings is:

      IBE100 KEY_FOLLOWS
      IBE101 RESERVED
      IBE201 FOLLOW_ENROLL_URI
      IBE300 SYSTEM_ERROR
      IBE301 INVALID_REQUEST
      IBE303 CLIENT_OBSOLETE
      IBE304 AUTHORIZATION DENIED

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.6.1.%20%20The%20IBE100%20responseCode"></a><a class="selflink" href="#section-5.6.1" name="section-5.6.1">5.6.1</a>.  The IBE100 responseCode</span>

   If the key request was successful, the key server responds with a
   responseCode of IBE100, and the &lt;ibe:body&gt; MUST contain a
   &lt;ibe:privateKey&gt; element that contains a valid private key.  An
   example of this is shown below.

   &lt;ibe:response xmlns:ibe="urn:ietf:params:xml:ns:ibe"&gt;
      &lt;ibe:responseType value="IBE100"/&gt;
      &lt;ibe:body&gt;
         &lt;ibe:privateKey&gt;
           privateKey
         &lt;/ibe:privateKey&gt;
      &lt;/ibe:body&gt;
   &lt;/ibe:response&gt;

   The privateKey is the base64 [<a href="#ref-B64" title='"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"'>B64</a>] encoding of the DER encoding [<a href="#ref-DER">DER</a>]
   of the following structure:

   IBEPrivateKeyReply ::= SEQUENCE {
     pkgIdentity    IBEIdentityInfo,
     pgkAlgorithm   OBJECT IDENTIFIER,
     pkgKeyData     OCTET STRING,
     pkgOptions     SEQUENCE SIZE (1..MAX) OF PKGOption
   }

   PKGOption ::=  SEQUENCE  {
     optionID    OBJECT IDENTIFIER,
     optionValue OCTET STRING
   }

   The pkgIdentity is an IBEIdentityInfo structure that MUST be
   identical to the IBEIdentityInfo structure that was sent in the key
   request.





<span class="grey">Appenzeller, et al.          Informational                     [Page 19]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


   The pkgAlgorithm is an OID that identifies the algorithm of the
   returned private key.  The OIDs for the BB1 and BF algorithms are
   defined in [<a href="#ref-IBCS" title='"Identity-Based Cryptography Standard (IBCS) #1: Supersingular Curve Implementations of the BF and BB1 Cryptosystems"'>IBCS</a>].

   The pkgKeyData is a structure that contains the actual private key.
   Private-key formats for the BB1 and BF algorithms are defined in
   [<a href="#ref-IBCS" title='"Identity-Based Cryptography Standard (IBCS) #1: Supersingular Curve Implementations of the BF and BB1 Cryptosystems"'>IBCS</a>].

   A server MAY pass back additional information to a client in the
   pkgOptions structure.  A client that receives a IBEPrivateKeyReply
   from a PKG that contains information in a pkgOptions structure that
   it is unable process MUST NOT use the IBE private key in the
   IBEPrivateKeyReply structure for any cryptographic operations.  A
   client MUST be able to process an IBEPrivateKeyReply that contains no
   PKGOptions structure.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.6.2.%20%20The%20IBE101%20responseCode"></a><a class="selflink" href="#section-5.6.2" name="section-5.6.2">5.6.2</a>.  The IBE101 responseCode</span>

   The responseCode IBE101 is reserved to ensure interoperability with
   earlier versions of the protocol described in this document.  An
   example of such a response is shown below.  A response with the
   IBE101 responseCode SHOULD contain no body.  If information is
   contained in the body of such a response, the client receiving the
   response MUST discard any data that is contained in the body.

   &lt;ibe:response xmlns:ibe="urn:ietf:params:xml:ns:ibe"&gt;
      &lt;ibe:responseType value="IBE101"/&gt;
      &lt;ibe:body&gt;
         This message must be discarded by the recipient
      &lt;/ibe:body
   &lt;/ibe:response&gt;

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.6.3.%20%20The%20IBE201%20responseCode"></a><a class="selflink" href="#section-5.6.3" name="section-5.6.3">5.6.3</a>.  The IBE201 responseCode</span>

   A PKG MAY support authenticating users to external authentication
   mechanisms.  If this is the case, the server replies to the client
   with responseCode IBE201 and the body of the response MUST contain a
   &lt;ibe:location&gt; element that specifies the URI of the authentication
   mechanism.  An example of such a response is shown below.

   &lt;ibe:response xmlns:ibe="urn:ietf:params:xml:ns:ibe"&gt;
      &lt;ibe:responseType value="IBE201"/&gt;
      &lt;ibe:body&gt;
         &lt;ibe:location
            URI="http://www.example.com/enroll.asp"/&gt;
      &lt;/ibe:body&gt;
   &lt;/ibe:response&gt;




<span class="grey">Appenzeller, et al.          Informational                     [Page 20]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


   The client can now contact the URI returned in such a response using
   the same mechanisms as defined in <a href="#section-5.2">Section 5.2</a> to obtain an
   authentication credential.  Once the client has obtained the
   credential from the authentication mechanism at this URI, it sends a
   new key request to the PKG with the correct authentication
   credentials contained in the request, placing the authentication
   credential in the &lt;ibe:authData&gt; element of a key request as
   described in <a href="#section-5.5">Section 5.5</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.6.4.%20%20The%20IBE300%20responseCode"></a><a class="selflink" href="#section-5.6.4" name="section-5.6.4">5.6.4</a>.  The IBE300 responseCode</span>

   The IBE300 responseCode indicates that an internal server error has
   occurred.  Information that may help diagnose the error MAY be
   included in the body of such a response.  An example of such a
   response is shown below.  Upon receiving a IBE300 responseCode, the
   client MUST abort the key request and discard any data that was
   included in the body of the response.

   &lt;ibe:response xmlns:ibe="urn:ietf:params:xml:ns:ibe"&gt;
      &lt;ibe:responseType value="IBE300"/&gt;
      &lt;ibe:body&gt;
         Widget phlebotomy failure
      &lt;/ibe:body&gt;
   &lt;/ibe:response&gt;

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.6.5.%20%20The%20IBE301%20responseCode"></a><a class="selflink" href="#section-5.6.5" name="section-5.6.5">5.6.5</a>.  The IBE301 responseCode</span>

   The IBE303 responseCode indicates that an invalid key request has
   been received by the server.  Information that may help diagnose the
   error MAY be included in the body of such a response.  An example of
   such a response is shown below.  Upon receiving an IBE301
   responseCode, the client MUST abort the key request and discard any
   data that was included in the body of the response.

   &lt;ibe:response xmlns:ibe="urn:ietf:params:xml:ns:ibe"&gt;
      &lt;ibe:responseType value="IBE301"/&gt;
      &lt;ibe:body&gt;
         Some additional stuff
      &lt;/ibe:body&gt;
   &lt;/ibe:response&gt;

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.6.6.%20%20The%20IBE303%20responseCode"></a><a class="selflink" href="#section-5.6.6" name="section-5.6.6">5.6.6</a>.  The IBE303 responseCode</span>

   The IBE303 responseCode indicates that the server is unable to
   correctly process the request because the version of the request is
   no longer supported by the server.  Information that may help
   diagnose the error MAY be included in the body of such a response.




<span class="grey">Appenzeller, et al.          Informational                     [Page 21]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


   An example of such a response is shown below.  Upon receiving an
   IBE303 responseCode, the client MUST abort the key request and
   discard any data that was included in the body of the response.

   &lt;ibe:response xmlns:ibe="urn:ietf:params:xml:ns:ibe"&gt;
      &lt;ibe:responseType value="IBE303"/&gt;
      &lt;ibe:body&gt;
         Version 3.3 or later needed
      &lt;/ibe:body&gt;
   &lt;/ibe:response&gt;

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.6.7.%20%20The%20IBE304%20responseCode"></a><a class="selflink" href="#section-5.6.7" name="section-5.6.7">5.6.7</a>.  The IBE304 responseCode</span>

   The IBE304 responseCode indicates that a valid key request has been
   received by the server, but the authentication credentials provided
   were invalid.  Information that may help diagnose the error MAY be
   included in the body of such a response.  An example of such a
   response is shown below.  Upon receiving an IBE304 responseCode, the
   client MUST abort the key request and discard any data that was
   included in the body of the response.

   &lt;ibe:response xmlns:ibe="urn:ietf:params:xml:ns:ibe"&gt;
      &lt;ibe:responseType value="IBE304"/&gt;
      &lt;ibe:body&gt;
         Helpful error message
      &lt;/ibe:body&gt;
   &lt;/ibe:response&gt;

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.7.%20%20The%20application%2Fibe-pkg-reply%2Bxml%20MIME%20type"></a><a class="selflink" href="#section-5.7" name="section-5.7">5.7</a>.  The application/ibe-pkg-reply+xml MIME type</span>

   The following summarizes the properties of the
   application/ibe-pkg-reply+xml MIME type.

   MIME media type name: application

   MIME subtype name: ibe-pkg-reply+xml

   Mandatory parameters: none

   Optional parameters: none

   Encoding considerations: This media type MUST be encoded as US-ASCII
      [<a href="#ref-ASCII">ASCII</a>].

   Security considerations: The data conveyed as this media type is an
      IBE private key, so its confidentiality and integrity are
      extremely important.  To ensure this, the response from the server
      that contains an IBE private key must take place over a secure



<span class="grey">Appenzeller, et al.          Informational                     [Page 22]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


      protocol, such as TLS 1.2 or its successors.  To ensure the
      validity of the server, the client MUST verify the server
      certificate and MUST abort the key request if the verification of
      the server certificate of the TLS connection fails.  This media
      type contains no active content and does not use compression.

   Interoperability considerations: There are no known interoperability
      considerations for this media type.

   Applications that use this media type: Applications that implement
      IBE in compliance with this specification will use this media
      type.  The most commonly used of these applications are encrypted
      email and file encryption.

   Additional information: none

   Person and email address for further information: Luther Martin,
      martin@voltage.com.

   Intended usage: COMMON

   Author/Change controller: Luther Martin, martin@voltage.com.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20ASN.1%20Module"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  ASN.1 Module</span>

   The following ASN.1 module summarizes the ASN.1 definitions discussed
   in this document.

   IBEARCH-module { joint-iso-itu-t(2) country(16) us(840)
     organization(1) identicrypt(114334) ibcs(1) ibearch(5)
     module(5) version(1)
   }

   DEFINITIONS IMPLICIT TAGS ::= BEGIN

   IBESysParams ::= SEQUENCE {
     version               INTEGER { v2(2) },
     districtName          IA5String,
     districtSerial        INTEGER,
     validity              ValidityPeriod,
     ibePublicParameters   IBEPublicParameters,
     ibeIdentityType       OBJECT IDENTIFIER,
     ibeParamExtensions    IBEParamExtensions OPTIONAL
   }







<span class="grey">Appenzeller, et al.          Informational                     [Page 23]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


   ValidityPeriod ::= SEQUENCE {
     notBefore     GeneralizedTime,
     notAfter      GeneralizedTime
   }

   IBEPublicParameters ::= SEQUENCE (1..MAX) OF
     IBEPublicParameter

   IBEPublicParameter  ::= SEQUENCE {
     ibeAlgorithm          OBJECT IDENTIFIER,
     publicParameterData   OCTET STRING
   }

   IBEParamExtensions ::= SEQUENCE OF IBEParamExtension

   IBEParamExtension ::= SEQUENCE {
     ibeParamExtensionOID     OBJECT IDENTIFIER,
     ibeParamExtensionValue   OCTET STRING
   }

   ibcs OBJECT IDENTIFIER ::= {
     joint-iso-itu-t(2) country(16) us(840)
     organization(1) identicrypt(114334) ibcs(1)
   }

   ibeParamExt OBJECT IDENTIFIER ::= {
     ibcs ibcs3(3) parameter-extensions(2)
   }

   pkgURI OBJECT IDENTIFIER ::= { ibeParamExt pkgURI(1) }

   IBEPrivateKeyReply ::= SEQUENCE {
     pkgIdentity  IBEIdentityInfo,
     pgkAlgorithm OBJECT IDENTIFIER,
     pkgKeyData   OCTET STRING,
     pkgOptions   SEQUENCE SIZE (1..MAX) OF PKGOption
   }

   PKGOption  ::=  SEQUENCE  {
     optionID    OBJECT IDENTIFIER,
     optionValue OCTET STRING
   }

   uriPPSOID OBJECT IDENTIFIER ::= {
     joint-iso-itu-t(2) country(16) us(840)
     organization(1) identicrypt(114334)
     pps-schemas(3) ic-schemas(1) pps-uri(1) version(1)
   }



<span class="grey">Appenzeller, et al.          Informational                     [Page 24]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


   IBEIdentityInfo ::= SEQUENCE {
     district        IA5String,
     serial          INTEGER,
     identityType    OBJECT IDENTIFIER,
     identityData    OCTET STRING
   }

   END

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Security%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Security Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Attacks%20outside%20the%20Scope%20of%20This%20Document"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Attacks outside the Scope of This Document</span>

   Attacks on the cryptographic algorithms that are used to implement
   IBE are outside the scope of this document.  Such attacks are
   detailed in [<a href="#ref-IBCS" title='"Identity-Based Cryptography Standard (IBCS) #1: Supersingular Curve Implementations of the BF and BB1 Cryptosystems"'>IBCS</a>], which defines parameters that give 80-bit,
   112-bit, and 128-bit encryption strength.  We assume that capable
   administrators of an IBE system will select parameters that provide a
   sufficient resistance to cryptanalytic attacks by adversaries.

   Attacks that give an adversary the ability to access or change the
   information on a PPS or PKG, especially the cryptographic material
   (referred to in this document as the master secret), will defeat the
   security of an IBE system.  In particular, if the cryptographic
   material is compromised, the adversary will have the ability to
   recreate any user's private key and therefore decrypt all messages
   protected with the corresponding public key.  To address this
   concern, it is highly RECOMMENDED that best practices for physical
   and operational security for PPS and PKG servers be followed and that
   these servers be configured (sometimes known as hardened) in
   accordance with best current practices [<a href="#ref-NIST" title='"Security Configuration Checklist Program for IT Products - Guidance for Checklist Users and Developers"'>NIST</a>].  An IBE system SHOULD
   be operated in an environment where illicit access is infeasible for
   attackers to obtain.

   Attacks that require administrative access or IBE-user-equivalent
   access to machines used by either the client or the server components
   defined in this document are also outside the scope of this document.

   We also assume that all administrators of a system implementing the
   protocols that are defined in this document are trustworthy and will
   not abuse their authority to bypass the security provided by an IBE
   system.  Similarly, we assume that users of an IBE system will behave
   responsibly, not sharing their authentication credentials with
   others.  Thus, attacks that require such assumptions are outside the
   scope of this document.






<span class="grey">Appenzeller, et al.          Informational                     [Page 25]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Attacks%20within%20the%20Scope%20of%20This%20Document"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Attacks within the Scope of This Document</span>

   Attacks within the scope of this document are those that allow an
   adversary to:

      o  passively monitor information transmitted between users of an
         IBE system and the PPS and PKG

      o  masquerade as a PPS or PKG

      o  perform a denial-of-service (DoS) attack on a PPS or PKG

      o  easily guess an IBE users authentication credential

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.2.1.%20%20Attacks%20on%20the%20Protocols%20Defined%20in%20This%20Document"></a><a class="selflink" href="#section-7.2.1" name="section-7.2.1">7.2.1</a>.  Attacks on the Protocols Defined in This Document</span>

   All communications between users of an IBE system and the PPS or PKG
   are protected using TLS 1.2 [<a href="#ref-TLS" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>TLS</a>].  The IBE system defined in this
   document provides no additional security protections for the
   communications between IBE users and the PPS or PKG.  Therefore, the
   described IBE system is completely dependent on the TLS security
   mechanisms for authentication of the PKG or PPS server and for
   confidentiality and integrity of the communications.  Should there be
   a compromise of the TLS security mechanisms, the integrity of all
   communications between an IBE user and the PPS or PKG will be
   suspect.

   The protocols defined in this document do not explicitly defend
   against an attacker masquerading as a legitimate IBE PPS or PKG.  The
   protocols rely on the server authentication mechanism of TLS [<a href="#ref-TLS" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>TLS</a>].
   In addition to the TLS server authentication mechanism, IBE client
   software can provide protection against this possibility by providing
   user interface capabilities that allow users to visually determine
   that a connection to PPS and PKG servers is legitimate.  This
   additional capability can help ensure that users cannot easily be
   tricked into providing valid authorization credentials to an
   attacker.

   The protocols defined in this document are also vulnerable to attacks
   against an IBE PPS or PKG.  Denial-of-service attacks against either
   component can result in users' being unable to encrypt or decrypt
   using IBE, and users of an IBE system SHOULD take the appropriate
   countermeasures [<a href="#ref-DOS" title='"Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing"'>DOS</a>, <a href="#ref-BGPDOS" title='"Configuring BGP to Block Denial-of-Service Attacks"'>BGPDOS</a>] that their use of IBE requires.

   The IBE user authentication method selected by an IBE PKG SHOULD be
   of sufficient strength to prevent attackers from easily guessing the
   IBE user's authentication credentials through trial and error.




<span class="grey">Appenzeller, et al.          Informational                     [Page 26]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  IANA Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Media%20Types"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Media Types</span>

   With this specification, IANA has registered three media types in the
   standard registration tree.  These are application/ibe-pp-data,
   application/ibe-key-request+xml, and application/ibe-pkg-reply+xml.
   The media type application/ibe-pp-data is defined in <a href="#section-4.3">Section 4.3</a> of
   this document.  The media type application/ibe-key-request+xml is
   defined in <a href="#section-5.4">Section 5.4</a> of this document.  The media type
   application/ibe-pkg-reply+xml is defined in <a href="#section-5.7">Section 5.7</a> of this
   document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20XML%20Namespace"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  XML Namespace</span>

   The IANA is requested to register the following namespace identifier:

   urn:ietf:params:xml:ns:ibe

   Registrant Contact:

      Luther Martin
      Voltage Security
      1070 Arastradero Rd Suite 100
      Palo Alto, CA 94304

      Phone: +1 650 543 1280
      Email: martin@voltage.com

   XML:

      &lt;?xml version="1.0"?&gt;
      &lt;!DOCTYPE html PUBLIC "-//W3C/DTD XHTML Basic 1.0//EN"
                "<a href="http://www.w3.org/TR/xhtml-basic/xhtml-basic10.dtd">http://www.w3.org/TR/xhtml-basic/xhtml-basic10.dtd</a>"&gt;
      &lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
        &lt;head&gt;
          &lt;meta http-equiv="content-type"
                content="text/html;charset=iso-8859-1"/&gt;
          &lt;title&gt;Identity-Based Encryption&lt;/title&gt;
        &lt;/head&gt;
        &lt;body&gt;
          &lt;h1&gt;Namespace for Identity-Based Encryption&lt;/h1&gt;
          &lt;h2&gt;urn:ietf:params:xml:ns:ibe&lt;/h2&gt;
          &lt;p&gt;
      &lt;a href="http://www.rfc-editor.org/rfc/rfc5408.txt"&gt;<a href="rfc5408.html">RFC5408</a>&lt;/a&gt;.
          &lt;/p&gt;
        &lt;/body&gt;
      &lt;/html&gt;



<span class="grey">Appenzeller, et al.          Informational                     [Page 27]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20References"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20Normative%20References"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  Normative References</span>

   [<a id="ref-ASCII" name="ref-ASCII">ASCII</a>]   ISO/IEC 646:1991 - Information Technology - ISO 7-bit Coded
             Character Set for Information Exchange.

   [<a id="ref-ASN1" name="ref-ASN1">ASN1</a>]    ITU-T Recommendation X.680: Information Technology -
             Abstract Syntax Notation One, 1997.

   [<a id="ref-AUTH" name="ref-AUTH">AUTH</a>]    Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S.,
             Leach, P., Luotonen, A., and L. Stewart, "HTTP
             Authentication: Basic and Digest Access Authentication",
             <a href="rfc2617.html">RFC 2617</a>, June 1999.

   [<a id="ref-B64" name="ref-B64">B64</a>]     Freed, N. and N. Borenstein, "Multipurpose Internet Mail
             Extensions (MIME) Part One: Format of Internet Message
             Bodies", <a href="rfc2045.html">RFC 2045</a>, November 1996.

   [<a id="ref-CMS" name="ref-CMS">CMS</a>]     Housley, R., "Cryptographic Message Syntax (CMS)", <a href="rfc3852.html">RFC</a>
             <a href="rfc3852.html">3852</a>, July 2004.

   [<a id="ref-DER" name="ref-DER">DER</a>]     ITU-T Recommendation X.690: OSI Networking and System
             Aspects: Abstract Syntax Notation One (ASN.1), July 2002.

   [<a id="ref-DOS" name="ref-DOS">DOS</a>]     Ferguson, P. and D. Senie, "Network Ingress Filtering:
             Defeating Denial of Service Attacks which employ IP Source
             Address Spoofing", <a href="http://tools.ietf.org/html/bcp38">BCP 38</a>, <a href="rfc2827.html">RFC 2827</a>, May 2000.

   [<a id="ref-HTTP" name="ref-HTTP">HTTP</a>]    Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter,
             L., Leach, P., and T. Berners-Lee, "Hypertext Transfer
             Protocol -- HTTP/1.1", <a href="rfc2616.html">RFC 2616</a>, June 1999.

   [<a id="ref-HTTPTLS" name="ref-HTTPTLS">HTTPTLS</a>] Rescorla, E., "HTTP Over TLS", <a href="rfc2818.html">RFC 2818</a>, May 2000.

   [<a id="ref-IBCS" name="ref-IBCS">IBCS</a>]    Boyen, X. and L. Martin, "Identity-Based Cryptography
             Standard (IBCS) #1: Supersingular Curve Implementations of
             the BF and BB1 Cryptosystems", <a href="rfc5091.html">RFC 5091</a>, December 2007.

   [<a id="ref-IRI" name="ref-IRI">IRI</a>]     Duerst, M. and M. Suignard, "Internationalized Resource
             Identifiers (IRIs)", <a href="rfc3987.html">RFC 3987</a>, January 2005.

   [<a id="ref-KEY" name="ref-KEY">KEY</a>]     Bradner, S., "Key words for use in RFCs to Indicate
             Requirement Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.







<span class="grey">Appenzeller, et al.          Informational                     [Page 28]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


   [<a id="ref-PKIX" name="ref-PKIX">PKIX</a>]    Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
             Housley, R., and W. Polk, "Internet X.509 Public Key
             Infrastructure Certificate and Certificate Revocation List
             (CRL) Profile", <a href="rfc5280.html">RFC 5280</a>, May 2008.

   [<a id="ref-SMTP" name="ref-SMTP">SMTP</a>]    Klensin, J., "Simple Mail Transfer Protocol", <a href="rfc5321.html">RFC 5321</a>,
             October 2008.

   [<a id="ref-TLS" name="ref-TLS">TLS</a>]     Dierks, T. and E. Rescorla, "The Transport Layer Security
             (TLS) Protocol Version 1.2", <a href="rfc5246.html">RFC 5246</a>, August 2008.

   [<a id="ref-URI" name="ref-URI">URI</a>]     Berners-Lee, T., Fielding, R., and L. Masinter, "Uniform
             Resource Identifier (URI): Generic Syntax", STD 66, <a href="rfc3986.html">RFC</a>
             <a href="rfc3986.html">3986</a>, January 2005.

   [<a id="ref-XML" name="ref-XML">XML</a>]     W3C, Extensible Markup Language (XML) 1.0 (Fourth Edition),
             September 2006.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20Informative%20References"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  Informative References</span>

   [<a id="ref-BGPDOS" name="ref-BGPDOS">BGPDOS</a>]  Turk, D., "Configuring BGP to Block Denial-of-Service
             Attacks", <a href="rfc3882.html">RFC 3882</a>, September 2004.

   [<a id="ref-IBECMS" name="ref-IBECMS">IBECMS</a>]  Martin, L. and M. Schertler, "Using the Boneh-Franklin
             Identity-Based Encryption Algorithm with the Cryptographic
             Message Syntax (CMS)", <a href="rfc5409.html">RFC 5409</a>, January 2009.

   [<a id="ref-NIST" name="ref-NIST">NIST</a>]    M. Souppaya, J. Wack and K. Kent, "Security Configuration
             Checklist Program for IT Products - Guidance for Checklist
             Users and Developers", NIST Special Publication SP 800-70,
             May 2005.

   [<a id="ref-P1363" name="ref-P1363">P1363</a>]  IEEE P1363, "Standard Specifications for Public-Key
             Cryptography", 2001.

















<span class="grey">Appenzeller, et al.          Informational                     [Page 29]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc5408.html">RFC 5408</a>                    IBE Architecture                January 2009</span>


Authors' Addresses

   Guido Appenzeller
   Stanford University
   Gates Building 3A
   Stanford, CA 94305

   Phone: +1 650 732 2273
   EMail: appenz@cs.stanford.edu


   Luther Martin
   Voltage Security
   1070 Arastradero Rd, Suite 100
   Palo Alto, CA 94304
   USA

   Phone: +1 650 543 1280
   EMail: martin@voltage.com


   Mark Schertler
   Axway
   1600 Seaport Blvd, Suite 400
   Redwood City, CA 94063
   USA

   Phone: +1 650 216 2039
   EMail: mschertler@us.axway.com






















Appenzeller, et al.          Informational                     [Page 30]

</pre><br/>
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.111, available from
<a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>



</body><!-- Mirrored from tools.ietf.org/html/rfc5408 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 28 Apr 2015 16:01:29 GMT --></html>