<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from tools.ietf.org/html/rfc5423 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.126" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Relation.Replaces" content="draft-newman-lemonade-msgevent" />
<meta name="DC.Identifier" content="urn:ietf:rfc:5423" />
<meta name="DC.Date.Issued" content="March, 2009" />
<meta name="DC.Creator" content="Newman, Chris" />
<meta name="DC.Creator" content="Gellens, Randall" />
<meta name="DC.Description.Abstract" content="One of the missing features in the existing Internet mail and
messaging standards is a facility for server-to-server and server-to-
client event notifications related to message store events. As the
scope of Internet mail expands to support more diverse media (such as
voice mail), devices (such as cell phones) and to provide rich
interactions with other services (such as web portals and legal
compliance systems), the need for an interoperable notification system
increases. This document attempts to enumerate the types of events
which interest real-world consumers of such a system." />
<meta name="DC.Title" content="Internet Message Store Events" />

    <link rel="icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 5423 - Internet Message Store Events</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgblue"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc5423.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc5423" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-lemonade-msgevent" title="draft-ietf-lemonade-msgevent">draft-ietf-lemo...</a>] [<a href='https://datatracker.ietf.org/doc/rfc5423' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5423" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc5423" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=5423">Errata</a>]</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br />
<span class="pre noprint docinfo">                                                            <span style='color: #C00;'>Errata Exist</span></span><br />
<pre>
Network Working Group                                         R. Gellens
Request for Comments: 5423                                 QUALCOMM Inc.
Category: Standards Track                                      C. Newman
                                                        Sun Microsystems
                                                              March 2009


                     <span class="h1">Internet Message Store Events</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (c) 2009 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents in effect on the date of
   publication of this document (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>).
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.

Abstract

   One of the missing features in the existing Internet mail and
   messaging standards is a facility for server-to-server and server-to-
   client event notifications related to message store events.  As the
   scope of Internet mail expands to support more diverse media (such as
   voice mail) and devices (such as cell phones) and to provide rich
   interactions with other services (such as web portals and legal
   compliance systems), the need for an interoperable notification
   system increases.  This document attempts to enumerate the types of
   events that interest real-world consumers of such a system.

   This document describes events and event parameters that are useful
   for several cases, including notification to administrative systems
   and end users.  This is not intended as a replacement for a message
   access facility such as IMAP.







<span class="grey">Gellens &amp; Newman            Standards Track                     [Page 1]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc5423.html">RFC 5423</a>             Internet Message Store Events            March 2009</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-2">2</a>
     <a href="#section-1.1">1.1</a>.  Conventions Used in This Document  . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  Event Model  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
   <a href="#section-4">4</a>.  Event Types  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-4.1">4.1</a>.  Message Addition and Deletion  . . . . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-4.2">4.2</a>.  Message Flags  . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-4.3">4.3</a>.  Access Accounting  . . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
     <a href="#section-4.4">4.4</a>.  Mailbox Management . . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
   <a href="#section-5">5</a>.  Event Parameters . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
   <a href="#section-6">6</a>.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
   <a href="#section-7">7</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
   <a href="#section-8">8</a>.  Acknowledgments  . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
   <a href="#section-9">9</a>.  References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
     <a href="#section-9.1">9.1</a>.  Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
     <a href="#section-9.2">9.2</a>.  Informative References . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
   <a href="#appendix-A">Appendix A</a>.  Future Extensions . . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>

<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   A message store is used to organize Internet Messages [<a href="rfc5322.html" title="&quot;Internet Message Format&quot;">RFC5322</a>] into
   one or more mailboxes (possibly hierarchical), annotate them in
   various ways, and provide access to these messages and associated
   metadata.  Three different standards-based protocols have been widely
   deployed to remotely access a message store.  The Post Office
   Protocol (POP) [<a href="rfc1939.html" title="&quot;Post Office Protocol - Version 3&quot;">RFC1939</a>] provides simple download-and-delete access
   to a single mail drop (which is a subset of the functionality
   typically associated with a message store).  The Internet Message
   Access Protocol (IMAP) [<a href="rfc3501.html" title="&quot;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1&quot;">RFC3501</a>] provides an extensible feature-rich
   model for online, offline, and disconnected access to a message store
   with minimal constraints on any associated "fat-client" user
   interface.  Finally, mail access applications built on top of the
   Hypertext Transfer Protocol (HTTP) [<a href="rfc2616.html" title="&quot;Hypertext Transfer Protocol -- HTTP/1.1&quot;">RFC2616</a>] that run in standards-
   based web browsers provide a third standards-based access mechanism
   for online-only access.

   While simple and/or ad-hoc mechanisms for notifications have sufficed
   to some degree in the past (e.g., "Simple New Mail Notification"
   [<a href="rfc4146.html" title="&quot;Simple New Mail Notification&quot;">RFC4146</a>], "IMAP4 IDLE Command" [<a href="rfc2177.html" title="&quot;IMAP4 IDLE command&quot;">RFC2177</a>]), as the scope and
   importance of message stores expand, the demand for a more complete
   store notification system increases.  Some of the driving forces
   behind this demand include:

   o  Mobile devices with intermittent network connectivity that have
      "new mail" or "message count" indicators.




<span class="grey">Gellens &amp; Newman            Standards Track                     [Page 2]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc5423.html">RFC 5423</a>             Internet Message Store Events            March 2009</span>


   o  Unified messaging systems that include both Internet and voice
      mail require support for a message-waiting indicator on phones.

   o  Interaction with systems for event-based or utility-computing
      billing.

   o  Simplification of the process of passing message store events to
      non-Internet notification systems.

   o  A calendar system may wish to subscribe to MessageNew
      notifications in order to support iMIP [<a href="rfc2447.html" title="&quot;iCalendar Message-Based Interoperability Protocol (iMIP)&quot;">RFC2447</a>].

   o  Some jurisdictions have laws or regulations for information
      protection and auditing that require interoperable protocols
      between message stores built by messaging experts and compliance
      auditing systems built by compliance experts.

   Vendors who have deployed proprietary notification systems for their
   Internet message stores have seen significant demand to provide
   notifications for more and more events.  As a first step towards
   building a notification system, this document attempts to enumerate
   the core events that real-world customers demand.

   This document includes those events that can be generated by the use
   of IMAP4rev1 [<a href="rfc3501.html" title="&quot;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1&quot;">RFC3501</a>] and some existing extensions.  As new IMAP
   extensions are defined, or additional event types or parameters need
   to be added, the set specified here can be extended by means of an
   IANA registry with update requirements, as specified in <a href="#section-6">Section 6</a>.

<span class="h3"><a class="selflink" name="section-1.1" href="#section-1.1">1.1</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].
   When these words appear in lower-case or with initial capital
   letters, they are not <a href="rfc2119.html">RFC 2119</a> key words.

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Terminology</span>

   The following terminology is used in this document:

   mailbox
      A container for Internet messages and/or child mailboxes.  A
      mailbox may or may not permit delivery of new messages via a mail
      delivery agent.






<span class="grey">Gellens &amp; Newman            Standards Track                     [Page 3]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc5423.html">RFC 5423</a>             Internet Message Store Events            March 2009</span>


   mailbox identifier
      A mailbox identifier provides sufficient information to identify a
      specific mailbox on a specific server instance.  An IMAP URL can
      be a mailbox identifier.

   message access protocols
      Protocols that provide clients (e.g., a mail user agent or web
      browser) with access to the message store, including but not
      limited to IMAP, POP, and HTTP.

   message context
      As defined in [<a href="rfc3458.html" title="&quot;Message Context for Internet Mail&quot;">RFC3458</a>].

   UIDVALIDITY
      As defined in IMAP4rev1 [<a href="rfc3501.html" title="&quot;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1&quot;">RFC3501</a>].  UIDVALIDITY is critical to the
      correct operation of a caching mail client.  When it changes, the
      client MUST flush its cache.  It's particularly important to
      include UIDVALIDITY with event notifications related to message
      addition or removal in order to keep the message data correctly
      synchronized.

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Event Model</span>

   The events that are generated by a message store depend to some
   degree on the model used to represent a message store.  The model the
   IETF has for a message store is implicit from IMAP4rev1 and
   extensions, so that model is assumed by this document.

   A message store event typically has an associated mailbox name and
   usually has an associated user name (or authorization identity if
   using the terminology from "Simple Authentication and Security Layer"
   (SASL) [<a href="rfc4422.html" title="&quot;Simple Authentication and Security Layer (SASL)&quot;">RFC4422</a>]).  Events referring to a specific message can use an
   IMAP URL [<a href="rfc5092.html" title="&quot;IMAP URL Scheme&quot;">RFC5092</a>] to do so.  Events referring to a set of messages
   can use an IMAP URL to the mailbox plus an IMAP UID (Unique
   Identifier) set.

   Each notification has a type and parameters.  The type determines the
   type of event, while the parameters supply information about the
   context of the event that may be used to adjust subscription
   preferences or may simply supply data associated with the event.  The
   types and parameter names in this document are restricted to US-ASCII
   printable characters, so these events can be easily mapped to an
   arbitrary notification system.  However, this document assumes that
   arbitrary parameter values (including large and multi-line values)
   can be encoded with the notification system.  Systems which lack that
   feature could only implement a subset of these events.





<span class="grey">Gellens &amp; Newman            Standards Track                     [Page 4]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc5423.html">RFC 5423</a>             Internet Message Store Events            March 2009</span>


   This document does not indicate which event parameters are mandatory
   or optional.  That is done in documents that specify specific message
   formats or bindings to a notification system.

   For scalability reasons, some degree of filtering at event generation
   is necessary.  At the very least, the ability to turn on and off
   groups of related events and to suppress inclusion of large
   parameters (such as messageContent) is needed.  A sophisticated
   publish/subscribe notification system may be able to propagate
   cumulative subscription information to the publisher.

   Some of these events might be logically collapsed into a single event
   type with a required parameter to distinguish between the cases
   (e.g., QuotaExceed and QuotaWithin).  However, until such time that
   an event subscription model is formulated, it's not practical to make
   such decisions.  We thus note only the fact that some of these events
   may be viewed as a single event type.

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Event Types</span>

   This section discusses the different types of events useful in a
   message store event notification system.  The intention is to
   document the events sufficient to cover an overwhelming majority of
   known use cases while leaving less common event types for the future.
   This section mentions parameters that are important or specific to
   the events described here.  Event parameters likely to be included in
   most or all notifications are discussed in the next section.

<span class="h3"><a class="selflink" name="section-4.1" href="#section-4.1">4.1</a>.  Message Addition and Deletion</span>

   This section includes events related to message addition and
   deletion.

   MessageAppend
      A message was appended or concatenated to a mailbox by a message
      access client.  For the most part, this is identical to the
      MessageNew event type except that the SMTP envelope information is
      not included as a parameter, but information about which protocol
      triggered the event MAY be included.  See the MessageNew event for
      more information.

   MessageExpire
      One or more messages were expired from a mailbox due to server
      expiration policy and are no longer accessible by the end user.

      The parameters include a mailbox identifier that MUST include
      UIDVALIDITY and a UID set that describes the messages.




<span class="grey">Gellens &amp; Newman            Standards Track                     [Page 5]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc5423.html">RFC 5423</a>             Internet Message Store Events            March 2009</span>


      Information about which server expiration policy was applied may
      be included in the future.

   MessageExpunge
      One or more messages were expunged from a mailbox by an IMAP
      CLOSE/EXPUNGE, POP3 DELE+QUIT, HTTP, or equivalent client action
      and are no longer accessible by the end user.

      The parameters include a mailbox identifier that MUST include
      UIDVALIDITY, a UID set, and MAY also indicate which access
      protocol triggered the event.

   MessageNew
      A new message was received into a mailbox via a message delivery
      agent.

      The parameters include a message identifier that, for IMAP-
      accessible message stores, MUST include UIDVALIDITY and a UID.
      The parameters MAY also include an SMTP envelope and other
      arbitrary message and mailbox metadata.  In some cases, the entire
      new message itself may be included.  The set of parameters SHOULD
      be adjustable to the client's preference, with limits set by
      server policy.  An interesting policy, for example, would be to
      include messages up to 2K in size with the notification, but to
      include a URLAUTH [<a href="rfc4467.html" title="&quot;Internet Message Access Protocol (IMAP) - URLAUTH Extension&quot;">RFC4467</a>] reference for larger messages.

   QuotaExceed
      An operation failed (typically MessageNew) because the user's
      mailbox exceeded one of the quotas (e.g., disk quota, message
      quota, quota by message context, etc.).  The parameters SHOULD
      include at least the relevant user and quota and, optionally, the
      mailbox.  Quota usage SHOULD be included if possible.  Parameters
      needed to extend this to support quota by context are not
      presently described in this document but could be added in the
      future.

   QuotaWithin
      An operation occurred (typically MessageExpunge or MessageExpire)
      that reduced the user's quota usage under the limit.

   QuotaChange
      The user's quota was changed.









<span class="grey">Gellens &amp; Newman            Standards Track                     [Page 6]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc5423.html">RFC 5423</a>             Internet Message Store Events            March 2009</span>


<span class="h3"><a class="selflink" name="section-4.2" href="#section-4.2">4.2</a>.  Message Flags</span>

   This section includes events related to changes in message flags.

   MessageRead
      One or more messages in the mailbox were marked as read or seen by
      a user.  Note that POP has no concept of read or seen messages, so
      these events are only generated by IMAP or HTTP clients (or
      equivalent).

      The parameters include a mailbox identifier and a set of message
      UIDs.

   MessageTrash
      One or more messages were marked for future deletion by the user
      but are still accessible over the protocol (the user's client may
      or may not make these messages accessible through its user
      interface).

      The parameters include a mailbox identifier and a set of message
      UIDs.

   FlagsSet
      One or more messages in the mailbox had one or more IMAP flags or
      keywords set.

      The parameters include a list of IMAP flag or keyword names that
      were set, a mailbox identifier, and the set of UIDs of affected
      messages.  The flagNames MUST NOT include \Recent.  For
      compatibility with simpler clients, it SHOULD be configurable
      whether setting the \Seen or \Deleted flags results in this event
      or the simpler MessageRead/MessageTrash events.  By default, the
      simpler message forms SHOULD be used for MessageRead and
      MessageTrash.

   FlagsClear
      One or more messages in the mailbox had one or more IMAP flags or
      keywords cleared.

      The parameters include a list of IMAP flag or keyword names that
      were cleared, a mailbox identifier, and the set of UIDs of
      affected messages.  The flagNames parameter MUST NOT include
      \Recent.








<span class="grey">Gellens &amp; Newman            Standards Track                     [Page 7]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc5423.html">RFC 5423</a>             Internet Message Store Events            March 2009</span>


<span class="h3"><a class="selflink" name="section-4.3" href="#section-4.3">4.3</a>.  Access Accounting</span>

   This section lists events related to message store access accounting.

   Login
      A user has logged into the system via IMAP, HTTP, POP, or some
      other mechanism.

      The parameters include the domain name and port used to access the
      server and the user's authorization identity.  Additional possible
      parameters include the client's IP address and port, the
      authentication identity (if different from the authorization
      identity), the service name, the authentication mechanism,
      information about any negotiated security layers, a timestamp, and
      other information.

   Logout
      A user has logged out or otherwise been disconnected from the
      message store via IMAP, HTTP, POP, or some other mechanism.

      The parameters include the server domain name and the user's
      authorization identity.  Additional parameters MAY include any of
      the information from the "Login" event as well as information
      about the type of disconnect (suggested values include graceful,
      abort, timeout, and security layer error), the duration of the
      connection or session, and other information.

<span class="h3"><a class="selflink" name="section-4.4" href="#section-4.4">4.4</a>.  Mailbox Management</span>

   This section lists events related to the management of mailboxes.

   MailboxCreate
      A mailbox has been created, or an access control changed on an
      existing mailbox so that it is now accessible by the user.  If the
      mailbox creation caused the creation of new mailboxes earlier in
      the hierarchy, separate MailboxCreate events are not generated, as
      their creation is implied.

      The parameters include the created mailbox identifier, its
      UIDVALIDITY for IMAP-accessible message stores, and MAY also
      indicate which access protocol triggered the event.  Access and
      permissions information (such as Access Control List (ACL)
      [<a href="rfc4314.html" title="&quot;IMAP4 Access Control List (ACL) Extension&quot;">RFC4314</a>] settings) require a standardized format to be included,
      and so are left for future extension.







<span class="grey">Gellens &amp; Newman            Standards Track                     [Page 8]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc5423.html">RFC 5423</a>             Internet Message Store Events            March 2009</span>


   MailboxDelete
      A mailbox has been deleted, or an access control changed on an
      existing mailbox so that it is no longer accessible by the user.
      Note that if the mailbox has child mailboxes, only the specified
      mailbox has been deleted, not the children.  The mailbox becomes
      \NOSELECT, and the hierarchy remains unchanged, as per the
      description of the DELETE command in IMAP4rev1 [<a href="rfc3501.html" title="&quot;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1&quot;">RFC3501</a>].

      The parameters include the deleted mailbox identifier and MAY also
      indicate which access protocol triggered the event.

   MailboxRename
      A mailbox has been renamed.  Note that, per the description of the
      RENAME command in IMAP4rev1 [<a href="rfc3501.html" title="&quot;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1&quot;">RFC3501</a>], special semantics regarding
      the mailbox hierarchy apply when INBOX is renamed (child mailboxes
      are usually included in the rename, but are excluded when INBOX is
      renamed).  When a mailbox other than INBOX is renamed and its
      child mailboxes are also renamed as a result, separate
      MailboxRename events are not generated for the child mailboxes, as
      their renaming is implied.  If the rename caused the creation of
      new mailboxes earlier in the hierarchy, separate MailboxCreate
      events are not generated for those, as their creation is implied.
      When INBOX is renamed, a new INBOX is created.  A MailboxCreate
      event is not generated for the new INBOX, since it is implied.

      The parameters include the old mailbox identifier, the new mailbox
      identifier, and MAY also indicate which access protocol triggered
      the event.

   MailboxSubscribe
      A mailbox has been added to the server-stored subscription list,
      such as the one managed by the IMAP SUBSCRIBE and UNSUBSCRIBE
      commands.

      The parameters include the user whose subscription list has been
      affected, the mailbox identifier, and MAY also indicate which
      access protocol triggered the event.

   MailboxUnSubscribe
      A mailbox has been removed from the subscription list.

      The parameters include the user whose subscription list has been
      affected, the mailbox identifier, and MAY also indicate which
      access protocol triggered the event.







<span class="grey">Gellens &amp; Newman            Standards Track                     [Page 9]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc5423.html">RFC 5423</a>             Internet Message Store Events            March 2009</span>


<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  Event Parameters</span>

   This section lists parameters included with these events.

   admin
      Included with all events generated by message access protocols.

      The authentication identity associated with this event, as
      distinct from the authorization identity (see "user").  This is
      not included when it is the same as the value of the user
      parameter.

   bodyStructure
      May be included with MessageAppend and MessageNew.

      The IMAP BODYSTRUCTURE of the message.

   clientIP
      Included with all events generated by message access protocols.

      The IPv4 or IPv6 address of the message store access client that
      performed the action that triggered the notification.

   clientPort
      Included with all events generated by message access protocols.

      The port number of the message store access client that performed
      an action that triggered the notification (the port from which the
      connection occurred).

   diskQuota
      Included with QuotaExceed, QuotaWithin, and QuotaChange
      notifications relating to a user or mailbox disk quota.  May be
      included with other notifications.

      Disk quota limit in kilobytes (1024 octets).

   diskUsed
      Included with QuotaExceed and QuotaWithin notifications relating
      to a user or mailbox disk quota.  May be included with other
      notifications.

      Disk space used in kilobytes (1024 octets).  Only disk space that
      counts against the quota is included.







<span class="grey">Gellens &amp; Newman            Standards Track                    [Page 10]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc5423.html">RFC 5423</a>             Internet Message Store Events            March 2009</span>


   envelope
      May be included with the MessageNew notification.

      The message transfer envelope associated with final delivery of
      the message for the MessageNew notification.  This includes the
      MAIL FROM and relevant RCPT TO line(s) used for final delivery
      with CRLF delimiters and any ESMTP parameters.

   flagNames
      Included with FlagsSet and FlagsClear events.  May be included
      with MessageAppend and MessageNew to indicate flags that were set
      initially by the APPEND command or delivery agent, respectively.

      A list (likely to be space-separated) of IMAP flag or keyword
      names that were set or cleared.  Flag names begin with a backslash
      while keyword names do not.  The \Recent flag is explicitly not
      permitted in the list.

   mailboxID
      Included in events that affect mailboxes.  A URI describing the
      mailbox.  In the case of MailboxRename, this refers to the new
      name.

   maxMessages
      Included with QuotaExceed and QuotaWithin notifications relating
      to a user or mailbox message count quota.  May be included with
      other notifications.

      Quota limit on the number of messages in the mailbox, for events
      referring to a mailbox.

   messageContent
      May be included with MessageAppend and MessageNew.

      The entire message itself.  Size-based suppression of this SHOULD
      be available.

   messageSize
      May be included with MessageAppend and MessageNew.

      Size of the <a href="rfc5322.html">RFC 5322</a> message itself in octets.  This value matches
      the length of the IMAP literal returned in response to an IMAP
      FETCH of BODY[] for the referenced message.








<span class="grey">Gellens &amp; Newman            Standards Track                    [Page 11]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc5423.html">RFC 5423</a>             Internet Message Store Events            March 2009</span>


   messages
      Included with QuotaExceed and QuotaWithin notifications relating
      to a user or mailbox message count quota.  May be included with
      other notifications.

      Number of messages in the mailbox.  This is typically included
      with message addition and deletion events.

   modseq
      May be included with any notification referring to one message.

      This is the 64-bit integer MODSEQ as defined in [<a href="rfc4551.html" title="&quot;IMAP Extension for Conditional STORE Operation or Quick Flag Changes Resynchronization&quot;">RFC4551</a>].  No
      assumptions about MODSEQ can be made if this is omitted.

   oldMailboxID
      A URI describing the old name of a renamed or moved mailbox.

   pid
      May be included with any notification.

      The process ID of the process that generated the notification.

   process
      May be included with any notification.

      The name of the process that generated the notification.

   serverDomain
      Included in Login and optionally in Logout or other events.  The
      domain name or IP address (v4 or v6) used to access the server or
      mailbox.

   serverPort
      Included in Login and optionally in Logout or other events.  The
      port number used to access the server.  This is often a well-known
      port.

   serverFQDN
      May be included with any notification.

      The fully qualified domain name of the server that generated the
      event.  Note that this may be different from the server name used
      to access the mailbox included in the mailbox identifier.








<span class="grey">Gellens &amp; Newman            Standards Track                    [Page 12]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey"><a href="rfc5423.html">RFC 5423</a>             Internet Message Store Events            March 2009</span>


   service
      May be included with any notification.

      The name of the service that triggered the event.  Suggested
      values include "imap", "pop", "http", and "admincli" (for an
      administrative client).

   tags
      May be included with any notification.

      A list of UTF-8 tags (likely to be comma-separated).  One or more
      tags can be set at the time a notification criteria or
      notification subscription is created.  Subscribers can use tags
      for additional client-side filtering or dispatch of events.

   timestamp
      May be included with any notification.

      The time at which the event occurred that triggered the
      notification (the underlying protocol carrying the notification
      may contain a timestamp for when the notification was generated).
      This MAY be an approximate time.

      Timestamps are expressed in local time and contain the offset from
      UTC (this information is used in several places in Internet mail)
      and are normally in [<a href="rfc3339.html" title="&quot;Date and Time on the Internet: Timestamps&quot;">RFC3339</a>] format.

   uidnext
      May be included with any notification referring to a mailbox.

      The UID that is projected to be assigned next in the mailbox.
      This is typically included with message addition and deletion
      events.  This is equivalent to the UIDNEXT status item in the IMAP
      STATUS command.

   uidset
      Included with MessageExpires, MessageExpunges, MessageRead,
      MessageTrash, FlagsSet, and FlagsClear.

      This includes the set of IMAP UIDs referenced.

   uri
      Included with all notifications.  A reference to the IMAP server,
      a mailbox, or a message.

      Typically an IMAP URL.  This can include the name of the server
      used to access the mailbox/message, the mailbox name, the
      UIDVALIDITY of the mailbox, and the UID of a specific message.



<span class="grey">Gellens &amp; Newman            Standards Track                    [Page 13]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey"><a href="rfc5423.html">RFC 5423</a>             Internet Message Store Events            March 2009</span>


   user
      Included with all events generated by message access protocols.

      This is the authorization identifier used when the client
      connected to the access protocol that triggered the event.  Some
      protocols (for example, many SASL mechanisms) distinguish between
      authorization and authentication identifiers.  For events
      associated with a mailbox, this may be different from the owner of
      the mailbox specified in the IMAP URL.

<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  IANA Considerations</span>

   The IANA has created a new registry for "Internet Message Store
   Events" that contains two sub-registries: event names and event
   parameters.  For both event names and event parameters, entries that
   do not start with "vnd." are added by the IETF and are intended for
   interoperable use.  Entries that start with "vnd." are intended for
   private use by one or more parties and are allocated to avoid
   collisions.

   The initial values are contained in this document.

   Using IANA Considerations [<a href="rfc5226.html" title="&quot;Guidelines for Writing an IANA Considerations Section in RFCs&quot;">RFC5226</a>] terminology, entries that do not
   start with "vnd." are allocated by IETF Consensus, while those
   starting with "vnd." are allocated First Come First Served.

<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  Security Considerations</span>

   Notifications can produce a large amount of traffic and expose
   sensitive information.  When notification mechanisms are used to
   maintain state between different entities, the ability to corrupt or
   manipulate notification messages could enable an attacker to modulate
   the state of these entities.  For example, if an attacker were able
   to modify notifications sent from a message store to an auditing
   server, he could modify the "user" and "messageContent" parameters in
   MessageNew notifications to create false audit log entries.

   A competent transfer protocol for notifications must consider
   authentication, authorization, privacy, and message integrity, as
   well as denial-of-service issues.  While the IETF has adequate tools
   and experience to address these issues for mechanisms that involve
   only one TCP connection, notification or publish/subscribe protocols
   that are more sophisticated than a single end-to-end TCP connection
   will need to pay extra attention to these issues and carefully
   balance requirements to successfully deploy a system with security
   and privacy considerations.





<span class="grey">Gellens &amp; Newman            Standards Track                    [Page 14]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-15" id="page-15" href="#page-15" class="invisible"> </a>
<span class="grey"><a href="rfc5423.html">RFC 5423</a>             Internet Message Store Events            March 2009</span>


<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  Acknowledgments</span>

   Alexey Melnikov, Arnt Gulbrandsen, and Zoltan Ordogh have reviewed
   and offered improvements to this document.  Richard Barnes did a nice
   review during Last Call.

<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  References</span>

<span class="h3"><a class="selflink" name="section-9.1" href="#section-9.1">9.1</a>.  Normative References</span>

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a name="ref-RFC3501" id="ref-RFC3501">RFC3501</a>]  Crispin, M., "INTERNET MESSAGE ACCESS PROTOCOL - VERSION
              4rev1", <a href="rfc3501.html">RFC 3501</a>, March 2003.

   [<a name="ref-RFC5092" id="ref-RFC5092">RFC5092</a>]  Melnikov, A. and C. Newman, "IMAP URL Scheme", <a href="rfc5092.html">RFC 5092</a>,
              November 2007.

   [<a name="ref-RFC5226" id="ref-RFC5226">RFC5226</a>]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc5226.html">RFC 5226</a>,
              May 2008.

<span class="h3"><a class="selflink" name="section-9.2" href="#section-9.2">9.2</a>.  Informative References</span>

   [<a name="ref-RFC1939" id="ref-RFC1939">RFC1939</a>]  Myers, J. and M. Rose, "Post Office Protocol - Version 3",
              STD 53, <a href="rfc1939.html">RFC 1939</a>, May 1996.

   [<a name="ref-RFC2177" id="ref-RFC2177">RFC2177</a>]  Leiba, B., "IMAP4 IDLE command", <a href="rfc2177.html">RFC 2177</a>, June 1997.

   [<a name="ref-RFC2447" id="ref-RFC2447">RFC2447</a>]  Dawson, F., Mansour, S., and S. Silverberg, "iCalendar
              Message-Based Interoperability Protocol (iMIP)", <a href="rfc2447.html">RFC 2447</a>,
              November 1998.

   [<a name="ref-RFC2616" id="ref-RFC2616">RFC2616</a>]  Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,
              Masinter, L., Leach, P., and T. Berners-Lee, "Hypertext
              Transfer Protocol -- HTTP/1.1", <a href="rfc2616.html">RFC 2616</a>, June 1999.

   [<a name="ref-RFC3339" id="ref-RFC3339">RFC3339</a>]  Klyne, G., Ed. and C. Newman, "Date and Time on the
              Internet: Timestamps", <a href="rfc3339.html">RFC 3339</a>, July 2002.

   [<a name="ref-RFC3458" id="ref-RFC3458">RFC3458</a>]  Burger, E., Candell, E., Eliot, C., and G. Klyne, "Message
              Context for Internet Mail", <a href="rfc3458.html">RFC 3458</a>, January 2003.

   [<a name="ref-RFC4146" id="ref-RFC4146">RFC4146</a>]  Gellens, R., "Simple New Mail Notification", <a href="rfc4146.html">RFC 4146</a>,
              August 2005.





<span class="grey">Gellens &amp; Newman            Standards Track                    [Page 15]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-16" id="page-16" href="#page-16" class="invisible"> </a>
<span class="grey"><a href="rfc5423.html">RFC 5423</a>             Internet Message Store Events            March 2009</span>


   [<a name="ref-RFC4314" id="ref-RFC4314">RFC4314</a>]  Melnikov, A., "IMAP4 Access Control List (ACL) Extension",
              <a href="rfc4314.html">RFC 4314</a>, December 2005.

   [<a name="ref-RFC4422" id="ref-RFC4422">RFC4422</a>]  Melnikov, A. and K. Zeilenga, "Simple Authentication and
              Security Layer (SASL)", <a href="rfc4422.html">RFC 4422</a>, June 2006.

   [<a name="ref-RFC4467" id="ref-RFC4467">RFC4467</a>]  Crispin, M., "Internet Message Access Protocol (IMAP) -
              URLAUTH Extension", <a href="rfc4467.html">RFC 4467</a>, May 2006.

   [<a name="ref-RFC4551" id="ref-RFC4551">RFC4551</a>]  Melnikov, A. and S. Hole, "IMAP Extension for Conditional
              STORE Operation or Quick Flag Changes Resynchronization",
              <a href="rfc4551.html">RFC 4551</a>, June 2006.

   [<a name="ref-RFC5322" id="ref-RFC5322">RFC5322</a>]  Resnick, P., Ed., "Internet Message Format", <a href="rfc5322.html">RFC 5322</a>,
              October 2008.




































<span class="grey">Gellens &amp; Newman            Standards Track                    [Page 16]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-17" id="page-17" href="#page-17" class="invisible"> </a>
<span class="grey"><a href="rfc5423.html">RFC 5423</a>             Internet Message Store Events            March 2009</span>


<span class="h2"><a class="selflink" name="appendix-A" href="#appendix-A">Appendix A</a>.  Future Extensions</span>

   This document specifies core functionality based on events that are
   believed to be well understood, have known use cases, and are
   implemented by at least one deployed real-world Internet message
   store.  (A few events are exceptions to the last test only: FlagsSet,
   FlagsClear, MailboxCreate, MailboxDelete, MailboxRename,
   MailboxSubscribe, and MailboxUnSubscribe.)

   Some events have been suggested but are postponed to future
   extensions because they do not meet this criteria.  These events
   include messages that have been moved to archive storage and may
   require extra time to access, quota by message context,
   authentication failure, user mail account disabled, annotations, and
   mailbox ACL or metadata change.  The descriptions of several events
   note additional parameters that are likely candidates for future
   inclusion.  See <a href="#section-6">Section 6</a> for how the list of events and parameters
   can be extended.

   In order to narrow the scope of this document to something that can
   be completed, only events generated from the message store (by a
   message access module, administrative module, or message delivery
   agent) are considered.  A complete mail system is normally linked
   with an identity system that would also publish events of interest to
   a message store event subscriber.  Events of interest include account
   created/deleted/disabled and password changed/expired.

Authors' Addresses

   Randall Gellens
   QUALCOMM Incorporated
   5775 Morehouse Drive
   San Diego, CA  92651
   USA

   Phone:
   EMail: rg+ietf@qualcomm.com


   Chris Newman
   Sun Microsystems
   800 Royal Oaks
   Monrovia, CA  91016-6347
   USA

   Phone:
   EMail: chris.newman@sun.com




Gellens &amp; Newman            Standards Track                    [Page 17]

</pre><br />
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>
</body>

<!-- Mirrored from tools.ietf.org/html/rfc5423 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:35 GMT -->
</html>
