<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from tools.ietf.org/html/rfc6065 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:51:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.129c" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Relation.Replaces" content="draft-nelson-isms-extended-vacm" />
<meta name="DC.Identifier" content="urn:ietf:rfc:6065" />
<meta name="DC.Date.Issued" content="December, 2010" />
<meta name="DC.Creator" content="Presuhn, Randy" />
<meta name="DC.Creator" content="Narayan, Kaushik" />
<meta name="DC.Creator" content="Nelson, David" />
<meta name="DC.Description.Abstract" content="This memo describes a backward-compatible extension to the View-based
Access Control Model for SNMPv3 for use with RADIUS and other AAA
services to provide authorization of MIB database access. This
extension is intended to be used in conjunction with secure SNMP
Transport Models that facilitate RADIUS authentication, such as the
Secure Shell Transport Model." />
<meta name="DC.Title" content="Using Authentication, Authorization, and Accounting Services to Dynamically Provision View-Based Access Control Model User-to-Group Mappings" />

    <link rel="icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 6065 - Using Authentication, Authorization, and Accounting Services to Dynamically Provision View-Based Access Control Model User-to-Group Mappings</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgblue"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6065.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6065" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-isms-radius-vacm" title="draft-ietf-isms-radius-vacm">draft-ietf-isms...</a>] [<a href='https://datatracker.ietf.org/doc/rfc6065' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6065" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6065" title="Side-by-side diff">Diff2</a>]         </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Internet Engineering Task Force (IETF)                        K. Narayan
Request for Comments: 6065                           Cisco Systems, Inc.
Category: Standards Track                                      D. Nelson
ISSN: 2070-1721                                    Elbrys Networks, Inc.
                                                         R. Presuhn, Ed.
                                                           December 2010


      <span class="h1">Using Authentication, Authorization, and Accounting Services</span>
        <span class="h1">to Dynamically Provision View-Based Access Control Model</span>
                         <span class="h1">User-to-Group Mappings</span>

Abstract

   This memo defines a portion of the Management Information Base (MIB)
   for use with network management protocols.  It describes the use of
   information provided by Authentication, Authorization, and Accounting
   (AAA) services, such as the Remote Authentication Dial-In User
   Service (RADIUS), to dynamically update user-to-group mappings in the
   View-based Access Control Model (VACM).

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section&nbsp;2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6065">http://www.rfc-editor.org/info/rfc6065</a>.

Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must





<span class="grey">Narayan, et al.              Standards Track                    [Page 1]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc6065.html">RFC 6065</a>                    AAA-Enabled VACM               December 2010</span>


   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  The Internet-Standard Management Framework . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  Conventions  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-4">4</a>.  Overview . . . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-4.1">4.1</a>.  Using AAA services with SNMP . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-4.2">4.2</a>.  Applicability  . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
   <a href="#section-5">5</a>.  Structure of the MIB Module  . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-5.1">5.1</a>.  Textual Conventions  . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-5.2">5.2</a>.  The Table Structure  . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
   <a href="#section-6">6</a>.  Relationship to Other MIB Modules  . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-6.1">6.1</a>.  Relationship to the VACM MIB . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-6.2">6.2</a>.  MIB modules Required for IMPORTS . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-6.3">6.3</a>.  Documents Required for REFERENCE Clauses . . . . . . . . .  <a href="#page-6">6</a>
   <a href="#section-7">7</a>.  Elements of Procedure  . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-7.1">7.1</a>.  Sequencing Requirements  . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-7.2">7.2</a>.  Actions upon Session Establishment Indication  . . . . . .  <a href="#page-7">7</a>
       <a href="#section-7.2.1">7.2.1</a>.  Required Information . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
       <a href="#section-7.2.2">7.2.2</a>.  Creation of Entries in vacmAaaSecurityToGroupTable . .  <a href="#page-8">8</a>
       <a href="#section-7.2.3">7.2.3</a>.  Creation of Entries in vacmSecurityToGroupTable  . . .  <a href="#page-8">8</a>
       <a href="#section-7.2.4">7.2.4</a>.  Update of vacmGroupName  . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
     <a href="#section-7.3">7.3</a>.  Actions upon Session Termination Indication  . . . . . . .  <a href="#page-9">9</a>
       7.3.1.  Deletion of Entries from
               vacmAaaSecurityToGroupTable  . . . . . . . . . . . . .  <a href="#page-9">9</a>
       <a href="#section-7.3.2">7.3.2</a>.  Deletion of Entries from vacmSecurityToGroupTable  . . <a href="#page-10">10</a>
   <a href="#section-8">8</a>.  Definitions  . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
   <a href="#section-9">9</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
     <a href="#section-9.1">9.1</a>.  Principal Identity Naming  . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
     <a href="#section-9.2">9.2</a>.  Management Information Considerations  . . . . . . . . . . <a href="#page-15">15</a>
   <a href="#section-10">10</a>. IANA Considerations  . . . . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
   <a href="#section-11">11</a>. Contributors . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
   <a href="#section-12">12</a>. References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#section-12.1">12.1</a>. Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#section-12.2">12.2</a>. Informative References . . . . . . . . . . . . . . . . . . <a href="#page-18">18</a>












<span class="grey">Narayan, et al.              Standards Track                    [Page 2]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc6065.html">RFC 6065</a>                    AAA-Enabled VACM               December 2010</span>


<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   This memo specifies a way to dynamically provision selected View-
   based Access Control Model (VACM) [<a href="rfc3415.html" title="&quot;View-based Access Control Model (VACM) for the Simple Network Management Protocol (SNMP)&quot;">RFC3415</a>] Management Information
   Base (MIB) objects, based on information received from an
   Authentication, Authorization, and Accounting (AAA) service, such as
   RADIUS [<a href="rfc2865.html" title="&quot;Remote Authentication Dial In User Service (RADIUS)&quot;">RFC2865</a>] and [<a href="rfc5607.html" title="&quot;Remote Authentication Dial-In User Service (RADIUS) Authorization for Network Access Server (NAS) Management&quot;">RFC5607</a>].  It reduces the need for security
   administrators to manually update VACM configurations due to user
   churn, allowing a centralized AAA service to provide the information
   associating a given user with the access control policy (known as a
   "group" in VACM) governing that user's access to management
   information.

   This memo requires no changes to the Abstract Service Interface for
   the Access Control Subsystem, and requires no changes to the Elements
   of Procedure for VACM.  It provides a MIB module that reflects the
   information provided by the AAA service, along with elements of
   procedure for maintaining that information and performing
   corresponding updates to VACM MIB data.

   The reader is expected to be familiar with [<a href="rfc3415.html" title="&quot;View-based Access Control Model (VACM) for the Simple Network Management Protocol (SNMP)&quot;">RFC3415</a>], [<a href="rfc5607.html" title="&quot;Remote Authentication Dial-In User Service (RADIUS) Authorization for Network Access Server (NAS) Management&quot;">RFC5607</a>],
   [<a href="rfc5608.html" title="&quot;Remote Authentication Dial-In User Service (RADIUS) Usage for Simple Network Management Protocol (SNMP) Transport Models&quot;">RFC5608</a>], and their supporting specifications.

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  The Internet-Standard Management Framework</span>

   For a detailed overview of the documents that describe the current
   Internet-Standard Management Framework, please refer to <a href="rfc3410.html#section-7">section&nbsp;7 of
   RFC 3410</a> [<a href="rfc3410.html" title="&quot;Introduction and Applicability Statements for Internet- Standard Management Framework&quot;">RFC3410</a>].

   Managed objects are accessed via a virtual information store, termed
   the Management Information Base or MIB.  MIB objects are generally
   accessed through the Simple Network Management Protocol (SNMP).
   Objects in the MIB are defined using the mechanisms defined in the
   Structure of Management Information (SMI).  This memo specifies a MIB
   module that is compliant to the SMIv2, which is described in STD 58,
   <a href="rfc2578.html">RFC 2578</a> [<a href="rfc2578.html" title="&quot;Structure of Management Information Version 2 (SMIv2)&quot;">RFC2578</a>], STD 58, <a href="rfc2579.html">RFC 2579</a> [<a href="rfc2579.html" title="&quot;Textual Conventions for SMIv2&quot;">RFC2579</a>] and STD 58, <a href="rfc2580.html">RFC 2580</a>
   [<a href="rfc2580.html" title="&quot;Conformance Statements for SMIv2&quot;">RFC2580</a>].

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Conventions</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in <a href="rfc2119.html">RFC</a>
   <a href="rfc2119.html">2119</a> [<a href="rfc2119.html" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].







<span class="grey">Narayan, et al.              Standards Track                    [Page 3]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc6065.html">RFC 6065</a>                    AAA-Enabled VACM               December 2010</span>


<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Overview</span>

<span class="h3"><a class="selflink" name="section-4.1" href="#section-4.1">4.1</a>.  Using AAA services with SNMP</span>

   There are two use cases for AAA support of management access via
   SNMP.  These are (a) service authorization and (b) access control
   authorization.  The former is discussed in detail in [<a href="rfc5608.html" title="&quot;Remote Authentication Dial-In User Service (RADIUS) Usage for Simple Network Management Protocol (SNMP) Transport Models&quot;">RFC5608</a>].  The
   latter is the subject of this memo.

   The use case assumption here is that roles within an organization
   (which are represented in VACM as groups, which in turn name access
   control policies) change infrequently, while the users assigned to
   those roles change much more frequently.  This memo describes how the
   user-to-role (group) mapping can be delegated to the RADIUS server,
   avoiding the need to re-provision managed devices as users are added,
   deleted, or assigned new roles in an organization.

   This memo assumes that the detailed access control policies are pre-
   configured in VACM, and does not attempt to address the question of
   how the policy associated with a given role is put in place.

   The only additional information obtained from the AAA service is the
   mapping of the authenticated user's identifier to a specific role (or
   "group" in VACM terminology) in the access control policy.  Dynamic
   user authorization for MIB database access control, as defined
   herein, is limited to mapping the authenticated user to a group,
   which in turn is mapped to whatever access control policies are
   already in place in VACM.

   The SNMP architecture [<a href="rfc3411.html" title="&quot;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks&quot;">RFC3411</a>] maintains strong modularity and
   separation of concerns, separating user identity (authentication)
   from user database access rights (authorization).  RADIUS, on the
   other hand, allows for no such separation of authorization from
   authentication.  Consequently, the approach here is to leverage
   existing RADIUS usage for identifying a principal, documented in
   [<a href="rfc5608.html" title="&quot;Remote Authentication Dial-In User Service (RADIUS) Usage for Simple Network Management Protocol (SNMP) Transport Models&quot;">RFC5608</a>], along with the RADIUS Management-Policy-Id Attribute
   [<a href="rfc5607.html" title="&quot;Remote Authentication Dial-In User Service (RADIUS) Authorization for Network Access Server (NAS) Management&quot;">RFC5607</a>].

   A unique identifier is needed for each AAA-authorized "session",
   corresponding to a communication channel, such as a transport
   session, for which a principal has been AAA-authenticated and which
   is authorized to offer SNMP service.  How these identifiers are
   assigned is implementation dependent.  When a RADIUS Management-
   Policy-Id Attribute (or equivalent) is bound to such a session and
   principal authentication, this binding provides sufficient
   information to compute dynamic updates to VACM.  How this information
   is communicated within an implementation is implementation dependent;
   this memo is only concerned with externally observable behavior.



<span class="grey">Narayan, et al.              Standards Track                    [Page 4]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc6065.html">RFC 6065</a>                    AAA-Enabled VACM               December 2010</span>


   The key concept here is that what we will informally call a "AAA
   binding" binds:

   1.  a communications channel

   2.  an authenticated principal

   3.  service authorization

   4.  an access control policy name

   Some of the binding is done via other specifications.  A transport
   model, such as the Secure Shell Transport Model [<a href="rfc5592.html" title="&quot;Secure Shell Transport Model for the Simple Network Management Protocol (SNMP)&quot;">RFC5592</a>], provides a
   binding between 1 and 2 and 3, providing a securityName.  In turn,
   [<a href="rfc5607.html" title="&quot;Remote Authentication Dial-In User Service (RADIUS) Authorization for Network Access Server (NAS) Management&quot;">RFC5607</a>] provides a binding between (1+2+3) and 4.  This document
   extends that further, to create a binding between (1+2+3+4) and the
   local (VACM MIB) definition of the named policy, called a group in
   VACM.

<span class="h3"><a class="selflink" name="section-4.2" href="#section-4.2">4.2</a>.  Applicability</span>

   Though this memo was motivated to support the use of specific
   Transport Models, such as the Secure Shell Transport Model [<a href="rfc5592.html" title="&quot;Secure Shell Transport Model for the Simple Network Management Protocol (SNMP)&quot;">RFC5592</a>],
   it MAY be used with other implementation environments satisfying
   these requirements:

   o  use an AAA service for sign-on service and data access
      authorization;

   o  provide an indication of the start of a session for a particular
      authenticated principal in a particular role, based on information
      provided by the AAA service.  The principal will be identified
      using an SNMP securityName [<a href="rfc3411.html" title="&quot;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks&quot;">RFC3411</a>].  The role will be identified
      by the name of the corresponding VACM group.

   o  provide an indication of the end of the need for being able to
      make access decisions for a particular authenticated principal, as
      at the end of a session, whether due to disconnection, termination
      due to timeout, or any other reason.

   Likewise, although this memo specifically refers to RADIUS, it MAY be
   used with other AAA services satisfying these requirements:

   o  the service provides information semantically equivalent to the
      RADIUS Management-Policy-Id Attribute [<a href="rfc5607.html" title="&quot;Remote Authentication Dial-In User Service (RADIUS) Authorization for Network Access Server (NAS) Management&quot;">RFC5607</a>], which corresponds
      to the name of a VACM group;





<span class="grey">Narayan, et al.              Standards Track                    [Page 5]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc6065.html">RFC 6065</a>                    AAA-Enabled VACM               December 2010</span>


   o  the service provides an authenticated principal identifier (e.g.,
      the RADIUS User-Name Attribute [<a href="rfc2865.html" title="&quot;Remote Authentication Dial In User Service (RADIUS)&quot;">RFC2865</a>]) that can be transformed
      to an equivalent principal identifier in the form of a
      securityName [<a href="rfc3411.html" title="&quot;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks&quot;">RFC3411</a>].

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  Structure of the MIB Module</span>

<span class="h3"><a class="selflink" name="section-5.1" href="#section-5.1">5.1</a>.  Textual Conventions</span>

   This MIB module makes use of the SnmpAdminString [<a href="rfc3411.html" title="&quot;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks&quot;">RFC3411</a>] and
   SnmpSecurityModel [<a href="rfc3411.html" title="&quot;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks&quot;">RFC3411</a>] textual conventions.

<span class="h3"><a class="selflink" name="section-5.2" href="#section-5.2">5.2</a>.  The Table Structure</span>

   This MIB module defines a single table, the
   vacmAaaSecurityToGroupTable.  This table is indexed by the integer
   assigned to each security model, the protocol-independent
   securityName corresponding to a principal, and the unique identifier
   of a session.

<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Relationship to Other MIB Modules</span>

   This MIB module has a close operational relationship with the SNMP-
   VIEW-BASED-ACM-MIB (more commonly known as the "VACM MIB") from
   [<a href="rfc3415.html" title="&quot;View-based Access Control Model (VACM) for the Simple Network Management Protocol (SNMP)&quot;">RFC3415</a>].  It also relies on IMPORTS from several other modules.

<span class="h3"><a class="selflink" name="section-6.1" href="#section-6.1">6.1</a>.  Relationship to the VACM MIB</span>

   Although the MIB module defined here has a close relationship with
   the VACM MIB's vacmSecurityToGroupTable, it in no way changes the
   elements of procedure for VACM, nor does it affect any other tables
   defined in VACM.  See the elements of procedure (below) for details
   of how the contents of the vacmSecurityToGroupTable are affected by
   this MIB module.

<span class="h3"><a class="selflink" name="section-6.2" href="#section-6.2">6.2</a>.  MIB modules Required for IMPORTS</span>

   This MIB module employs definitions from [<a href="rfc2578.html" title="&quot;Structure of Management Information Version 2 (SMIv2)&quot;">RFC2578</a>], [<a href="rfc2579.html" title="&quot;Textual Conventions for SMIv2&quot;">RFC2579</a>], and
   [<a href="rfc3411.html" title="&quot;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks&quot;">RFC3411</a>].

<span class="h3"><a class="selflink" name="section-6.3" href="#section-6.3">6.3</a>.  Documents Required for REFERENCE Clauses</span>

   This MIB module contains REFERENCE clauses making reference to
   [<a href="rfc2865.html" title="&quot;Remote Authentication Dial In User Service (RADIUS)&quot;">RFC2865</a>], [<a href="rfc3411.html" title="&quot;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks&quot;">RFC3411</a>], and [<a href="rfc5590.html" title="&quot;Transport Subsystem for the Simple Network Management Protocol (SNMP)&quot;">RFC5590</a>].







<span class="grey">Narayan, et al.              Standards Track                    [Page 6]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc6065.html">RFC 6065</a>                    AAA-Enabled VACM               December 2010</span>


<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  Elements of Procedure</span>

   The following elements of procedure are formulated in terms of two
   types of events: an indication of the establishment of a session, and
   an indication that one has ended.  These can result in the creation
   of entries in the vacmAaaSecurityToGroupTable, which can in turn
   trigger creation, update, or deletion of entries in the
   vacmSecurityToGroupTable.

   There are various possible implementation-dependent error cases not
   spelled out here, such as running out of memory.  By their nature,
   recovery in such cases will be implementation dependent.
   Implementors are advised to consider fail-safe strategies, e.g.,
   prematurely terminating access in preference to erroneously
   perpetuating access.

<span class="h3"><a class="selflink" name="section-7.1" href="#section-7.1">7.1</a>.  Sequencing Requirements</span>

   These procedures assume that a transport model, such as [<a href="rfc5592.html" title="&quot;Secure Shell Transport Model for the Simple Network Management Protocol (SNMP)&quot;">RFC5592</a>],
   coordinates session establishment with AAA authentication and
   authorization.  They rely on the receipt by the AAA client of the
   RADIUS Management-Policy-Id [<a href="rfc5607.html" title="&quot;Remote Authentication Dial-In User Service (RADIUS) Authorization for Network Access Server (NAS) Management&quot;">RFC5607</a>] Attribute (or its equivalent)
   from the RADIUS Access-Accept message (or equivalent).  They also
   assume that the User-Name [<a href="rfc2865.html" title="&quot;Remote Authentication Dial In User Service (RADIUS)&quot;">RFC2865</a>] from the RADIUS Access-Request
   message (or equivalent) corresponds to a securityName [<a href="rfc3411.html" title="&quot;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks&quot;">RFC3411</a>].

   To ensure correct processing of SNMP PDUs, the handling of the
   indication of the establishment of a session in accordance with the
   elements of procedure below MUST be completed before the
   isAccessAllowed() Abstract Service Interface [<a href="rfc3415.html" title="&quot;View-based Access Control Model (VACM) for the Simple Network Management Protocol (SNMP)&quot;">RFC3415</a>] is invoked for
   any SNMP PDUs from that session.

   If a session termination indication occurs before all invocations of
   the isAccessAllowed() Abstract Service Interface [<a href="rfc3415.html" title="&quot;View-based Access Control Model (VACM) for the Simple Network Management Protocol (SNMP)&quot;">RFC3415</a>] have
   completed for all SNMP PDUs from that session, those remaining
   invocations MAY result in denial of access.

<span class="h3"><a class="selflink" name="section-7.2" href="#section-7.2">7.2</a>.  Actions upon Session Establishment Indication</span>

<span class="h4"><a class="selflink" name="section-7.2.1" href="#section-7.2.1">7.2.1</a>.  Required Information</span>

   Four pieces of information are needed to process the session
   establishment indication:

   o  the SnmpSecurityModel [<a href="rfc3411.html" title="&quot;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks&quot;">RFC3411</a>] needed as an index into the
      vacmSecurityToGroupTable;

   o  the RADIUS User-Name Attribute;



<span class="grey">Narayan, et al.              Standards Track                    [Page 7]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc6065.html">RFC 6065</a>                    AAA-Enabled VACM               December 2010</span>


   o  a session identifier, as a unique, definitive identifier of the
      session that the AAA authorization is tied to;

   o  the RADIUS Management-Policy-Id Attribute.

   All four of these pieces of information are REQUIRED.  In particular,
   if either the User-Name or Management-Policy-Id is absent, invalid,
   or a zero-length string, no further processing of the session
   establishment indication is undertaken.

   As noted in <a href="#section-4.2">Section 4.2</a>, the above text refers specifically to RADIUS
   attributes.  Other AAA services can be substituted, but the
   requirements imposed on the User-Name and the Management-Policy-Id-
   Attribute MUST be satisfied using the equivalent fields for those
   services.

<span class="h4"><a class="selflink" name="section-7.2.2" href="#section-7.2.2">7.2.2</a>.  Creation of Entries in vacmAaaSecurityToGroupTable</span>

   Whenever an indication arrives that a new session has been
   established, determine whether a corresponding entry exists in the
   vacmAaaSecurityToGroupTable.  If one does not, create a new row with
   the columns populated as follows:

   o  vacmAaaSecurityModel = value of SnmpSecurityModel corresponding to
      the security model in use;

   o  vacmAaaSecurityName = RADIUS User-Name Attribute or equivalent,
      the securityName that will be used in invocations of the
      isAccessAllowed() Abstract Service Interface [<a href="rfc3415.html" title="&quot;View-based Access Control Model (VACM) for the Simple Network Management Protocol (SNMP)&quot;">RFC3415</a>];

   o  vacmAaaSessionID = session identifier, unique across all open
      sessions of all of this SNMP engine's transport models;

   o  vacmAaaGroupName = RADIUS Management-Policy-Id Attribute or
      equivalent.

   Otherwise, if the row already exists, update the vacmAaaGroupName
   with the RADIUS Management-Policy-Id Attribute or equivalent
   supplied.

<span class="h4"><a class="selflink" name="section-7.2.3" href="#section-7.2.3">7.2.3</a>.  Creation of Entries in vacmSecurityToGroupTable</span>

   Whenever an entry is created in the vacmAaaSecurityToGroupTable, the
   vacmSecurityToGroupTable is examined to determine whether a
   corresponding entry exists there, using the value of
   vacmAaaSecurityModel for vacmSecurityModel, and the value of
   vacmAaaSecurityName for vacmSecurityName.  If no corresponding entry
   exists, create one using the vacmAaaGroupName of the newly created



<span class="grey">Narayan, et al.              Standards Track                    [Page 8]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc6065.html">RFC 6065</a>                    AAA-Enabled VACM               December 2010</span>


   entry to fill in vacmGroupName, using a value of "volatile" for the
   row's StorageType, and a value of "active" for its RowStatus.

<span class="h4"><a class="selflink" name="section-7.2.4" href="#section-7.2.4">7.2.4</a>.  Update of vacmGroupName</span>

   Whenever the value of an instance of vacmAaaGroupName is updated, if
   a corresponding entry exists in the vacmSecurityToGroupTable, and
   that entry's StorageType is "volatile" and its RowStatus is "active",
   update the value of vacmGroupName with the value from
   vacmAaaGroupName.

   If a corresponding entry already exists in the
   vacmSecurityToGroupTable, and that row's StorageType is anything
   other than "volatile", or its RowStatus is anything other than
   "active", then that instance of vacmGroupName MUST NOT be modified.

   The operational assumption here is that if the row's StorageType is
   "volatile", then this entry was probably dynamically created; an
   entry created by a security administrator would not normally be given
   a StorageType of "volatile".  If the value being provided by RADIUS
   (or another AAA service) is the same as what is already there, this
   is a no-op.  If the value is different, the new information is
   understood as a more recent role (group) assignment for the user,
   which should supersede the one currently held there.  The structure
   of the vacmSecurityToGroupTable makes it impossible for a
   (vacmSecurityModel, vacmSecurityName) tuple to map to more than one
   group.

<span class="h3"><a class="selflink" name="section-7.3" href="#section-7.3">7.3</a>.  Actions upon Session Termination Indication</span>

   Whenever a RADIUS (or other AAA) authenticated session ends for any
   reason, an indication is provided.  This indication MUST provide
   means of determining the SnmpSecurityModel, and an identifier for the
   transport session tied to the AAA authorization.  The manner in which
   this occurs is implementation dependent.

<span class="h4"><a class="selflink" name="section-7.3.1" href="#section-7.3.1">7.3.1</a>.  Deletion of Entries from vacmAaaSecurityToGroupTable</span>

   Entries in the vacmAaaSecurityToGroupTable MUST NOT persist across
   system reboots.

   When a session has been terminated, the vacmAaaSecurityToGroupTable
   is searched for a corresponding entry.  A "matching" entry is any
   entry for which the SnmpSecurityModel and session ID match the
   information associated with the session termination indication.  Any
   matching entries are deleted.  It is possible that no entries will
   match; this is not an error, and no special processing is required in
   this case.



<span class="grey">Narayan, et al.              Standards Track                    [Page 9]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc6065.html">RFC 6065</a>                    AAA-Enabled VACM               December 2010</span>


<span class="h4"><a class="selflink" name="section-7.3.2" href="#section-7.3.2">7.3.2</a>.  Deletion of Entries from vacmSecurityToGroupTable</span>

   Whenever the last remaining row bearing a particular
   (vacmAaaSecurityModel, vacmAaaSecurityName) pair is deleted from the
   vacmAaaSecurityToGroupTable, the vacmSecurityToGroupTable is examined
   for a corresponding row.  If one exists, and if its StorageType is
   "volatile" and its RowStatus is "active", that row MUST be deleted as
   well.  The mechanism to accomplish this task is implementation
   dependent.

<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  Definitions</span>

SNMP-VACM-AAA-MIB DEFINITIONS ::= BEGIN

IMPORTS
    MODULE-COMPLIANCE, OBJECT-GROUP       FROM SNMPv2-CONF
    MODULE-IDENTITY, OBJECT-TYPE,
    mib-2,
    Unsigned32                            FROM SNMPv2-SMI
    SnmpAdminString,
    SnmpSecurityModel                     FROM SNMP-FRAMEWORK-MIB;

vacmAaaMIB    MODULE-IDENTITY
    LAST-UPDATED "201012090000Z"          -- 9 December 2010
    ORGANIZATION "ISMS Working Group"
    CONTACT-INFO "WG-email:   isms@ietf.org"

    DESCRIPTION  "The management and local datastore information
                  definitions for the AAA-Enabled View-based Access
                  Control Model for SNMP.

                  Copyright (c) 2010 IETF Trust and the persons
                  identified as the document authors.  All rights
                  reserved.

                  Redistribution and use in source and binary forms,
                  with or without modification, is permitted pursuant
                  to, and subject to the license terms contained in,
                  the Simplified BSD License set forth in <a href="#section-4">Section</a>
                  <a href="#section-4">4</a>.c of the IETF Trust's Legal Provisions Relating
                  to IETF Documents
                  (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>).

                  This version of this MIB module is part of <a href="rfc6065.html">RFC 6065</a>;
                  see the RFC itself for full legal notices."

    REVISION "201012090000Z"
    DESCRIPTION "Initial version, published as <a href="rfc6065.html">RFC 6065</a>."



<span class="grey">Narayan, et al.              Standards Track                   [Page 10]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc6065.html">RFC 6065</a>                    AAA-Enabled VACM               December 2010</span>


     ::= { mib-2 199 }

vacmAaaMIBObjects   OBJECT IDENTIFIER ::= { vacmAaaMIB 1 }

vacmAaaMIBConformance OBJECT IDENTIFIER ::= { vacmAaaMIB 2 }

vacmAaaSecurityToGroupTable OBJECT-TYPE
    SYNTAX       SEQUENCE OF VacmAaaSecurityToGroupEntry
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION "This table provides a listing of all currently active
                 sessions for which a mapping of the combination of
                 SnmpSecurityModel and securityName into the name of
                 a VACM group has been provided by an AAA service.
                 The group name (in VACM) in turn identifies an access
                 control policy to be used for the corresponding
                 principals."
    REFERENCE   "<a href="rfc3411.html#section-3.2.2">RFC 3411, Section&nbsp;3.2.2</a>, defines securityName."
    ::= { vacmAaaMIBObjects 1 }

vacmAaaSecurityToGroupEntry OBJECT-TYPE
    SYNTAX       VacmAaaSecurityToGroupEntry
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION "An entry in this table maps the combination of a
                 SnmpSecurityModel and securityName into the name
                 of a VACM group defining the access control policy
                 that is to govern a particular session.

                 Each entry corresponds to a session.

                 Entries do not persist across reboots.

                 An entry is created whenever an indication occurs
                 that a new session has been established that would
                 not have the same index values as an existing entry.

                 When a session is torn down, disconnected, timed out
                 (e.g., following the RADIUS Session-Timeout Attribute),
                 or otherwise terminated for any reason, the
                 corresponding vacmAaaSecurityToGroupEntry is deleted."
    REFERENCE   "<a href="rfc3411.html#section-3.2.2">RFC 3411, Section&nbsp;3.2.2</a>, defines securityName."
    INDEX       {
                  vacmAaaSecurityModel,
                  vacmAaaSecurityName,
                  vacmAaaSessionID
                }
    ::= { vacmAaaSecurityToGroupTable 1 }



<span class="grey">Narayan, et al.              Standards Track                   [Page 11]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc6065.html">RFC 6065</a>                    AAA-Enabled VACM               December 2010</span>


VacmAaaSecurityToGroupEntry ::= SEQUENCE
    {
        vacmAaaSecurityModel            SnmpSecurityModel,
        vacmAaaSecurityName             SnmpAdminString,
        vacmAaaSessionID                Unsigned32,
        vacmAaaGroupName                SnmpAdminString
    }

vacmAaaSecurityModel OBJECT-TYPE
    SYNTAX       SnmpSecurityModel(1..2147483647)
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION "The security model associated with the AAA binding
                 represented by this entry.

                 This object cannot take the 'any' (0) value."
    ::= { vacmAaaSecurityToGroupEntry 1 }

vacmAaaSecurityName OBJECT-TYPE
    SYNTAX       SnmpAdminString (SIZE(1..32))
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION "The securityName of the principal associated with the
                 AAA binding represented by this entry.  In RADIUS
                 environments, this corresponds to the User-Name
                 Attribute."
    REFERENCE   "<a href="rfc3411.html#section-3.2.2">RFC 3411, Section&nbsp;3.2.2</a>, defines securityName, and
                 <a href="rfc2865.html#section-5.1">RFC 2865, Section&nbsp;5.1</a>, defines User-Name."
    ::= { vacmAaaSecurityToGroupEntry 2 }

vacmAaaSessionID OBJECT-TYPE
    SYNTAX       Unsigned32
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION "An implementation-dependent identifier of the session.

                 This value MUST be unique among all currently open
                 sessions of all of this SNMP engine's transport models.
                 The value has no particular significance other than to
                 distinguish sessions.

                 Implementations in which tmSessionID has a compatible
                 syntax and is unique across all transport models MAY
                 use that value."
    REFERENCE   "The Abstract Service Interface parameter tmSessionID
                 is defined in <a href="rfc5590.html#section-5.2.4">RFC 5590, Section&nbsp;5.2.4</a>."
    ::= { vacmAaaSecurityToGroupEntry 3 }




<span class="grey">Narayan, et al.              Standards Track                   [Page 12]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey"><a href="rfc6065.html">RFC 6065</a>                    AAA-Enabled VACM               December 2010</span>


vacmAaaGroupName    OBJECT-TYPE
    SYNTAX       SnmpAdminString (SIZE(1..32))
    MAX-ACCESS   read-only
    STATUS       current
    DESCRIPTION "The name of the group to which this entry is to belong.
                 In RADIUS environments, this comes from the RADIUS
                 Management-Policy-Id Attribute.

                 When the appropriate conditions are met,
                 the value of this object is applied the vacmGroupName
                 in the corresponding vacmSecurityToGroupEntry."
    REFERENCE    "<a href="rfc3415.html">RFC 3415</a>"
    ::= { vacmAaaSecurityToGroupEntry 4 }


-- Conformance information ******************************************

vacmAaaMIBCompliances
               OBJECT IDENTIFIER ::= {vacmAaaMIBConformance 1}
vacmAaaMIBGroups
               OBJECT IDENTIFIER ::= {vacmAaaMIBConformance 2}

-- compliance statements

vacmAaaMIBBasicCompliance MODULE-COMPLIANCE
    STATUS       current
    DESCRIPTION "The compliance statement for SNMP engines implementing
                 the AAA-Enabled View-based Access Control Model for
                 SNMP."
    MODULE    -- this module
        MANDATORY-GROUPS { vacmAaaGroup }

    ::= { vacmAaaMIBCompliances 1 }

-- units of conformance

vacmAaaGroup OBJECT-GROUP
    OBJECTS {
              vacmAaaGroupName
            }
    STATUS       current
    DESCRIPTION "A collection of objects for supporting the use of AAA
                 services to provide user-to-group mappings for VACM."
    ::= { vacmAaaMIBGroups 1 }

END





<span class="grey">Narayan, et al.              Standards Track                   [Page 13]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey"><a href="rfc6065.html">RFC 6065</a>                    AAA-Enabled VACM               December 2010</span>


<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  Security Considerations</span>

   The algorithms in this memo make heuristic use of the StorageType of
   entries in the vacmSecurityToGroupTable to distinguish those
   provisioned by a security administrator (which would presumably not
   be configured as "volatile") from those dynamically generated.  In
   making this distinction, it assumes that those entries explicitly
   provisioned by a security administrator and given a non-"volatile"
   status are not to be dynamically overridden.  Furthermore, it assumes
   that any active entries with "volatile" status can be treated as
   dynamic, and deleted or updated as needed.  Users of this memo need
   to be aware of this operational assumption, which, while reasonable,
   is not necessarily universally valid.  For example, this situation
   could also occur if the SNMP security administrator had mistakenly
   created these non-volatile entries in error.

   The design of VACM ensures that if an unknown policy (group name) is
   used in the vacmSecurityToGroupTable, no access is granted.  A
   consequence of this is that no matter what information is provided by
   the AAA server, no user can gain SNMP access rights not already
   granted to some group through the VACM configuration.

<span class="h3"><a class="selflink" name="section-9.1" href="#section-9.1">9.1</a>.  Principal Identity Naming</span>

   In order to ensure that the access control policy ultimately applied
   as a result of the mechanisms described here is indeed the intended
   policy for a given principal using a particular security model, care
   needs to be applied in the mapping of the authenticated user
   (principal) identity to the securityName used to make the access
   control decision.  Broadly speaking, there are two approaches to
   ensure consistency of identity:

   o  Entries for the vacmSecurityToGroupTable corresponding to a given
      security model are created only through the operation of the
      procedures described in this memo.  A consequence of this would be
      that all such entries would have been created using the RADIUS
      User-Name (or other AAA-authenticated identity) and RADIUS
      Management-Policy-Id Attribute (or equivalent).

   o  Administrative policy allows a matching pre-configured entry to
      exist in the vacmSecurityToGroupTable, i.e., an entry with the
      corresponding vacmSecurityModel and with a vacmSecurityName
      matching the authenticated principal's RADIUS User-Name.  In this
      case, administrative policy also needs to ensure consistency of
      identity between each authenticated principal's RADIUS User-Name
      and the administratively configured vacmSecurityName in the
      vacmSecurityToGroupTable row entries for that particular security
      model.



<span class="grey">Narayan, et al.              Standards Track                   [Page 14]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-15" id="page-15" href="#page-15" class="invisible"> </a>
<span class="grey"><a href="rfc6065.html">RFC 6065</a>                    AAA-Enabled VACM               December 2010</span>


   In the latter case, inconsistent re-use of the same name for
   different entities or individuals (principals) can cause the
   incorrect access control policy to be applied for the authenticated
   principal, depending on whether the policy that is configured using
   SNMP or the policy that is applied using the procedures of this memo
   is the intended policy.  This may result in greater or lesser access
   rights than the administrative policy intended.  Inadvertent
   misidentification in such cases may be undetectable by the SNMP
   engine or other software elements of the managed entity.

<span class="h3"><a class="selflink" name="section-9.2" href="#section-9.2">9.2</a>.  Management Information Considerations</span>

   There are no management objects defined in this MIB module that have
   a MAX-ACCESS clause of read-write and/or read-create.  So, if this
   MIB module is implemented correctly, then there is no risk that an
   intruder can alter or create any management objects of this MIB
   module via direct SNMP SET operations.

   Some of the readable objects in this MIB module (including some
   objects with a MAX-ACCESS of not-accessible, whose values are exposed
   as a result of access to indexed objects) may be considered sensitive
   or vulnerable in some network environments.  It is thus important to
   control even GET and/or NOTIFY access to these objects and possibly
   to even encrypt the values of these objects when sending them over
   the network via SNMP.  These are the tables and objects and their
   sensitivity/vulnerability:

   o  vacmAaaSecurityToGroupTable - the entire table is potentially
      sensitive, since walking the table will reveal user names,
      security models in use, session identifiers, and group names;

   o  vacmAaaSecurityModel - though not-accessible, this is exposed as
      an index of vacmAaaGroupName;

   o  vacmAaaSecurityName - though not-accessible, this is exposed as an
      index of vacmAaaGroupName;

   o  vacmAaaSessionID - though not-accessible, this is exposed as an
      index of vacmAaaGroupName;

   o  vacmAaaGroupName - since this identifies a security policy and
      associates it with a particular user, this is potentially
      sensitive.








<span class="grey">Narayan, et al.              Standards Track                   [Page 15]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-16" id="page-16" href="#page-16" class="invisible"> </a>
<span class="grey"><a href="rfc6065.html">RFC 6065</a>                    AAA-Enabled VACM               December 2010</span>


   SNMP versions prior to SNMPv3 did not include adequate security.
   Even if the network itself is secure (for example by using IPsec),
   even then, there is no control as to who on the secure network is
   allowed to access and GET/SET (read/change/create/delete) the objects
   in this MIB module.

   It is RECOMMENDED that implementers consider the security features as
   provided by the SNMPv3 framework (see <a href="rfc3410.html#section-8">[RFC3410], section&nbsp;8</a>),
   including full support for the SNMPv3 cryptographic mechanisms (for
   authentication and privacy).

   Further, deployment of SNMP versions prior to SNMPv3 is NOT
   RECOMMENDED.  Instead, it is RECOMMENDED to deploy SNMPv3 and to
   enable cryptographic security.  It is then a customer/operator
   responsibility to ensure that the SNMP entity giving access to an
   instance of this MIB module is properly configured to give access to
   the objects only to those principals (users) that have legitimate
   rights to indeed GET or SET (change/create/delete) them.

<span class="h2"><a class="selflink" name="section-10" href="#section-10">10</a>.  IANA Considerations</span>

   The MIB module in this document uses the following IANA-assigned
   OBJECT IDENTIFIER value recorded in the SMI Numbers registry:

      Descriptor        OBJECT IDENTIFIER value
      ----------        -----------------------
      vacmAaaMIB        { mib-2 199 }

<span class="h2"><a class="selflink" name="section-11" href="#section-11">11</a>.  Contributors</span>

   The following participants from the ISMS working group contributed to
   the development of this document:

   o  Andrew Donati

   o  David Harrington

   o  Jeffrey Hutzelman

   o  Juergen Schoenwaelder

   o  Tom Petch

   o  Wes Hardaker







<span class="grey">Narayan, et al.              Standards Track                   [Page 16]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-17" id="page-17" href="#page-17" class="invisible"> </a>
<span class="grey"><a href="rfc6065.html">RFC 6065</a>                    AAA-Enabled VACM               December 2010</span>


   During the IESG review, additional comments were received from:

   o  Adrian Farrel

   o  Amanda Baber

   o  Dan Romescanu

   o  David Kessens

   o  Francis Dupont

   o  Glenn Keeni

   o  Jari Arkko

   o  Joel Jaeggli

   o  Magnus Nystrom

   o  Mike Heard

   o  Robert Story

   o  Russ Housley

   o  Sean Turner

   o  Tim Polk

<span class="h2"><a class="selflink" name="section-12" href="#section-12">12</a>.  References</span>

<span class="h3"><a class="selflink" name="section-12.1" href="#section-12.1">12.1</a>.  Normative References</span>

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a name="ref-RFC2578" id="ref-RFC2578">RFC2578</a>]  McCloghrie, K., Ed., Perkins, D., Ed., and J.
              Schoenwaelder, Ed., "Structure of Management Information
              Version 2 (SMIv2)", STD 58, <a href="rfc2578.html">RFC 2578</a>, April 1999.

   [<a name="ref-RFC2579" id="ref-RFC2579">RFC2579</a>]  McCloghrie, K., Ed., Perkins, D., Ed., and J.
              Schoenwaelder, Ed., "Textual Conventions for SMIv2",
              STD 58, <a href="rfc2579.html">RFC 2579</a>, April 1999.

   [<a name="ref-RFC2580" id="ref-RFC2580">RFC2580</a>]  McCloghrie, K., Perkins, D., and J. Schoenwaelder,
              "Conformance Statements for SMIv2", STD 58, <a href="rfc2580.html">RFC 2580</a>,
              April 1999.



<span class="grey">Narayan, et al.              Standards Track                   [Page 17]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-18" id="page-18" href="#page-18" class="invisible"> </a>
<span class="grey"><a href="rfc6065.html">RFC 6065</a>                    AAA-Enabled VACM               December 2010</span>


   [<a name="ref-RFC2865" id="ref-RFC2865">RFC2865</a>]  Rigney, C., Willens, S., Rubens, A., and W. Simpson,
              "Remote Authentication Dial In User Service (RADIUS)",
              <a href="rfc2865.html">RFC 2865</a>, June 2000.

   [<a name="ref-RFC3411" id="ref-RFC3411">RFC3411</a>]  Harrington, D., Presuhn, R., and B. Wijnen, "An
              Architecture for Describing Simple Network Management
              Protocol (SNMP) Management Frameworks", STD 62, <a href="rfc3411.html">RFC 3411</a>,
              December 2002.

   [<a name="ref-RFC3415" id="ref-RFC3415">RFC3415</a>]  Wijnen, B., Presuhn, R., and K. McCloghrie, "View-based
              Access Control Model (VACM) for the Simple Network
              Management Protocol (SNMP)", STD 62, <a href="rfc3415.html">RFC 3415</a>,
              December 2002.

   [<a name="ref-RFC5590" id="ref-RFC5590">RFC5590</a>]  Harrington, D. and J. Schoenwaelder, "Transport Subsystem
              for the Simple Network Management Protocol (SNMP)",
              <a href="rfc5590.html">RFC 5590</a>, June 2009.

   [<a name="ref-RFC5607" id="ref-RFC5607">RFC5607</a>]  Nelson, D. and G. Weber, "Remote Authentication Dial-In
              User Service (RADIUS) Authorization for Network Access
              Server (NAS) Management", <a href="rfc5607.html">RFC 5607</a>, July 2009.

   [<a name="ref-RFC5608" id="ref-RFC5608">RFC5608</a>]  Narayan, K. and D. Nelson, "Remote Authentication Dial-In
              User Service (RADIUS) Usage for Simple Network Management
              Protocol (SNMP) Transport Models", <a href="rfc5608.html">RFC 5608</a>, August 2009.

<span class="h3"><a class="selflink" name="section-12.2" href="#section-12.2">12.2</a>.  Informative References</span>

   [<a name="ref-RFC3410" id="ref-RFC3410">RFC3410</a>]  Case, J., Mundy, R., Partain, D., and B. Stewart,
              "Introduction and Applicability Statements for Internet-
              Standard Management Framework", <a href="rfc3410.html">RFC 3410</a>, December 2002.

   [<a name="ref-RFC5592" id="ref-RFC5592">RFC5592</a>]  Harrington, D., Salowey, J., and W. Hardaker, "Secure
              Shell Transport Model for the Simple Network Management
              Protocol (SNMP)", <a href="rfc5592.html">RFC 5592</a>, June 2009.
















<span class="grey">Narayan, et al.              Standards Track                   [Page 18]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-19" id="page-19" href="#page-19" class="invisible"> </a>
<span class="grey"><a href="rfc6065.html">RFC 6065</a>                    AAA-Enabled VACM               December 2010</span>


Authors' Addresses

   Kaushik Narayan
   Cisco Systems, Inc.
   10 West Tasman Drive
   San Jose, CA  95134
   USA

   Phone: +1 408-526-8168
   EMail: kaushik_narayan@yahoo.com


   David Nelson
   Elbrys Networks, Inc.
   282 Corporate Drive, Unit #1,
   Portsmouth, NH  03801
   USA

   Phone: +1 603-570-2636
   EMail: d.b.nelson@comcast.net


   Randy Presuhn (editor)
   San Jose, CA  95120
   USA

   EMail: randy_presuhn@mindspring.com
























Narayan, et al.              Standards Track                   [Page 19]

</pre><br />
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.129c, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>
</body>

<!-- Mirrored from tools.ietf.org/html/rfc6065 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:51:32 GMT -->
</html>
