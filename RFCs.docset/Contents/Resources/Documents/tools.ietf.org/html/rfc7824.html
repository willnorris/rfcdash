<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7824 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:19 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-krishnan-dhc-dhcpv6-privacy" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:7824" name="DC.Identifier"/>
<meta content="May, 2016" name="DC.Date.Issued"/>
<meta content="Krishnan, Suresh" name="DC.Creator"/>
<meta content="Mrugalski, Tomek" name="DC.Creator"/>
<meta content="Jiang, Sheng" name="DC.Creator"/>
<meta content="DHCPv6 is a protocol that is used to provide addressing and
configuration information to IPv6 hosts. This document describes the
privacy issues associated with the use of DHCPv6 by Internet users. It
is intended to be an analysis of the present situation and does not
propose any solutions." name="DC.Description.Abstract"/>
<meta content="Privacy Considerations for DHCPv6" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7824 - Privacy Considerations for DHCPv6</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7824.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7824" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-dhc-dhcpv6-privacy" title="draft-ietf-dhc-dhcpv6-privacy">draft-ietf-dhc-...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7824" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7824" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7824" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                       S. Krishnan
Request for Comments: 7824                                      Ericsson
Category: Informational                                     T. Mrugalski
ISSN: 2070-1721                                                      ISC
                                                                S. Jiang
                                           Huawei Technologies Co., Ltd.
                                                                May 2016


                   <span class="h1">Privacy Considerations for DHCPv6</span>

Abstract

   DHCPv6 is a protocol that is used to provide addressing and
   configuration information to IPv6 hosts.  This document describes the
   privacy issues associated with the use of DHCPv6 by Internet users.
   It is intended to be an analysis of the present situation and does
   not propose any solutions.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7824">http://www.rfc-editor.org/info/rfc7824</a>.

















<span class="grey">Krishnan, et al.              Informational                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7824.html">RFC 7824</a>              DHCPv6 Privacy Considerations             May 2016</span>


Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





































<span class="grey">Krishnan, et al.              Informational                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7824.html">RFC 7824</a>              DHCPv6 Privacy Considerations             May 2016</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. Terminology .....................................................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. Identifiers in DHCPv6 Options and Fields ........................<a href="#page-5">5</a>
      <a href="#section-3.1">3.1</a>. Source IPv6 Address ........................................<a href="#page-5">5</a>
      <a href="#section-3.2">3.2</a>. DUID .......................................................<a href="#page-5">5</a>
      <a href="#section-3.3">3.3</a>. Client Identifier Option ...................................<a href="#page-6">6</a>
      <a href="#section-3.4">3.4</a>. IA_NA, IA_TA, IA_PD, IA Address, and IA Prefix Options .....<a href="#page-6">6</a>
      <a href="#section-3.5">3.5</a>. Client FQDN Option .........................................<a href="#page-6">6</a>
      <a href="#section-3.6">3.6</a>. Client Link-Layer Address Option ...........................<a href="#page-7">7</a>
      <a href="#section-3.7">3.7</a>. Option Request Option ......................................<a href="#page-7">7</a>
      <a href="#section-3.8">3.8</a>. Vendor Class and Vendor-Specific Information Options .......<a href="#page-7">7</a>
      <a href="#section-3.9">3.9</a>. Civic Location Option ......................................<a href="#page-8">8</a>
      <a href="#section-3.10">3.10</a>. Coordinate-Based Location Option ..........................<a href="#page-8">8</a>
      <a href="#section-3.11">3.11</a>. Client System Architecture Type Option ....................<a href="#page-8">8</a>
      <a href="#section-3.12">3.12</a>. Relay Agent Options .......................................<a href="#page-8">8</a>
           <a href="#section-3.12.1">3.12.1</a>. Subscriber-ID Option ...............................<a href="#page-9">9</a>
           <a href="#section-3.12.2">3.12.2</a>. Interface ID Option ................................<a href="#page-9">9</a>
           <a href="#section-3.12.3">3.12.3</a>. Remote ID Option ...................................<a href="#page-9">9</a>
           <a href="#section-3.12.4">3.12.4</a>. Relay-ID Option ....................................<a href="#page-9">9</a>
   <a href="#section-4">4</a>. Existing Mechanisms That Affect Privacy ........................<a href="#page-10">10</a>
      <a href="#section-4.1">4.1</a>. Temporary Addresses .......................................<a href="#page-10">10</a>
      <a href="#section-4.2">4.2</a>. DNS Updates ...............................................<a href="#page-10">10</a>
      <a href="#section-4.3">4.3</a>. Allocation Strategies .....................................<a href="#page-10">10</a>
   <a href="#section-5">5</a>. Attacks ........................................................<a href="#page-12">12</a>
      <a href="#section-5.1">5.1</a>. Device Type Discovery (Fingerprinting) ....................<a href="#page-12">12</a>
      <a href="#section-5.2">5.2</a>. Operating System Discovery (Fingerprinting) ...............<a href="#page-12">12</a>
      <a href="#section-5.3">5.3</a>. Finding Location Information ..............................<a href="#page-12">12</a>
      <a href="#section-5.4">5.4</a>. Finding Previously Visited Networks .......................<a href="#page-13">13</a>
      <a href="#section-5.5">5.5</a>. Finding a Stable Identity .................................<a href="#page-13">13</a>
      <a href="#section-5.6">5.6</a>. Pervasive Monitoring ......................................<a href="#page-13">13</a>
      <a href="#section-5.7">5.7</a>. Finding a Client's IP Address or Hostname .................<a href="#page-14">14</a>
      <a href="#section-5.8">5.8</a>. Correlation of Activities over Time .......................<a href="#page-14">14</a>
      <a href="#section-5.9">5.9</a>. Location Tracking .........................................<a href="#page-14">14</a>
      <a href="#section-5.10">5.10</a>. Leasequery and Bulk Leasequery ...........................<a href="#page-15">15</a>
   <a href="#section-6">6</a>. Security Considerations ........................................<a href="#page-15">15</a>
   <a href="#section-7">7</a>. Privacy Considerations .........................................<a href="#page-15">15</a>
   <a href="#section-8">8</a>. References .....................................................<a href="#page-16">16</a>
      <a href="#section-8.1">8.1</a>. Normative References ......................................<a href="#page-16">16</a>
      <a href="#section-8.2">8.2</a>. Informative References ....................................<a href="#page-16">16</a>
   Acknowledgements ..................................................<a href="#page-18">18</a>
   Authors' Addresses ................................................<a href="#page-18">18</a>








<span class="grey">Krishnan, et al.              Informational                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7824.html">RFC 7824</a>              DHCPv6 Privacy Considerations             May 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   DHCPv6 [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>] is a protocol that is used to provide addressing and
   configuration information to IPv6 hosts.  DHCPv6 uses several
   identifiers that could become a source for gleaning information about
   the IPv6 host.  This information may include device type, operating
   system information, location(s) that the device may have previously
   visited, etc.  This document discusses the various identifiers used
   by DHCPv6 and the potential privacy issues [<a href="rfc6973.html" title='"Privacy Considerations for Internet Protocols"'>RFC6973</a>].  In particular,
   it also takes into consideration the problem of pervasive monitoring
   [<a href="rfc7258.html" title='"Pervasive Monitoring Is an Attack"'>RFC7258</a>].

   Future works may propose protocol changes to fix the privacy issues
   that have been analyzed in this document.  See [<a href="rfc7844.html" title='"Anonymity Profile for DHCP Clients"'>RFC7844</a>] for one of
   such changes.  Protocol changes are out of scope for this document.

   The primary focus of this document is around privacy considerations
   for clients to support client mobility and connection to random
   networks.  The privacy of DHCPv6 servers and relay agents are
   considered less important as they are typically open for public
   services.  And, it is generally assumed that communication from the
   relay agent to the server is protected from casual snooping, as that
   communication occurs in the provider's backbone.  Nevertheless, the
   topics involving relay agents and servers are explored to some
   degree.  However, future work may want to further explore privacy of
   DHCPv6 servers and relay agents.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   Naming conventions from [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>] and other DHCPv6-related RFCs are
   used throughout this document.  In addition, the following term is
   used:

   Stable identifier:  Any property disclosed by a DHCPv6 client that
           does not change over time or changes very infrequently and is
           unique for said client in a given context.  Examples include
           Media Access Control (MAC) address, client-id, and a
           hostname.  Some identifiers may be considered stable only
           under certain conditions; for example, one client
           implementation may keep its client-id stored in stable
           storage whereas another may generate it on the fly and use a
           different one after each boot.  Stable identifiers may or may
           not be globally unique.








<span class="grey">Krishnan, et al.              Informational                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7824.html">RFC 7824</a>              DHCPv6 Privacy Considerations             May 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Identifiers%20in%20DHCPv6%20Options%20and%20Fields"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Identifiers in DHCPv6 Options and Fields</span>

   In DHCPv6, there are many options that include identification
   information or that can be used to extract identification information
   about the client.  This section enumerates various options or fields
   and the identifiers conveyed in them, which can be used to disclose
   client identification.  The attacks that are enabled by such
   disclosures are detailed in <a href="#section-5">Section 5</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Source%20IPv6%20Address"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Source IPv6 Address</span>

   Although an IPv6 link-local address is technically not a part of
   DHCPv6, it appears in the DHCPv6 transmissions, so it is mentioned
   here for completeness.

   If the client does not use privacy extensions (see [<a href="rfc4941.html" title='"Privacy Extensions for Stateless Address Autoconfiguration in IPv6"'>RFC4941</a>]) or
   similar solutions and its IPv6 link-local address is based on a
   physical link-layer address, this information is disclosed to the
   DHCPv6 server and to anyone who manages to intercept this
   transmission.

   There are multiple cases where IPv6 link-local addresses are used in
   DHCPv6.  Initial client transmissions are always sent from the IPv6
   link-local addresses even when the server unicast option (see
   Sections <a href="#section-22.12">22.12</a> and <a href="#section-18">18</a> of [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>] for details) is enabled.  If there
   are relay agents, they forward the client's traffic wrapped in Relay-
   forward and store original source IPv6 address in peer-address field.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20DUID"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  DUID</span>

   Each DHCPv6 client and server has a DHCP Unique Identifier (DUID)
   [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>].  The DUID is designed to be unique across all DHCPv6
   clients and servers and to remain stable after it has been initially
   generated.  The DUID can be of different forms.  Commonly used forms
   are based on the link-layer address of one of the device's network
   interfaces (with or without a timestamp) [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>], or on the
   Universally Unique IDentifier (UUID) [<a href="rfc6355.html" title='"Definition of the UUID-Based DHCPv6 Unique Identifier (DUID-UUID)"'>RFC6355</a>].  The default type,
   defined in <a href="rfc3315.html#section-9.2">Section 9.2 of [RFC3315]</a> is DUID-LLT that is based on
   link-layer address.  It is commonly implemented in most popular
   clients.

   It is important to understand DUID life cycle.  Clients and servers
   are expected to generate their DUID once (during first operation) and
   store it in a non-volatile storage or use the same deterministic
   algorithm to generate the same DUID value again.  This means that
   most implementations will use the available link-layer address during
   their first boot.  Even if the administrator enables link-layer
   address randomization, it is likely that it was not yet enabled



<span class="grey">Krishnan, et al.              Informational                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7824.html">RFC 7824</a>              DHCPv6 Privacy Considerations             May 2016</span>


   during the first device boot.  Hence, the original, unobfuscated
   link-layer address will likely end up being announced as the client
   DUID, even if the link-layer address has changed (or even if being
   changed on a periodic basis).  The exposure of the original link-
   layer address in DUID will also undermine other privacy extensions
   such as [<a href="rfc4941.html" title='"Privacy Extensions for Stateless Address Autoconfiguration in IPv6"'>RFC4941</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Client%20Identifier%20Option"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Client Identifier Option</span>

   The Client Identifier option (OPTION_CLIENTID) [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>] is used to
   carry the DUID of a DHCPv6 client between a client and a server.
   There is an analogous Server Identifier Option, but it is not as
   interesting in the privacy context (unless a host can be convinced to
   start acting as a server).  See <a href="#section-3.2">Section 3.2</a> for relevant discussion
   about DUIDs.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20IA_NA%2C%20IA_TA%2C%20IA_PD%2C%20IA%20Address%2C%20and%20IA%20Prefix%20Options"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  IA_NA, IA_TA, IA_PD, IA Address, and IA Prefix Options</span>

   The Identity Association for Non-temporary Addresses (IA_NA) option
   [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>] is used to carry the parameters and any non-temporary
   addresses associated with the given IA_NA.  The Identity Association
   for Temporary Addresses (IA_TA) option [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>] is analogous to the
   IA_NA option but is used for temporary addresses.  The IA Address
   option [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>] is used to specify IPv6 addresses associated with an
   IA_NA or an IA_TA and is encapsulated within the Options field of
   such an IA_NA or IA_TA option.  The Identity Association for Prefix
   Delegation (IA_PD) [<a href="rfc3633.html" title='"IPv6 Prefix Options for Dynamic Host Configuration Protocol (DHCP) version 6"'>RFC3633</a>] option is used to carry the prefixes
   that are assigned to the requesting router.  IA Prefix option
   [<a href="rfc3633.html" title='"IPv6 Prefix Options for Dynamic Host Configuration Protocol (DHCP) version 6"'>RFC3633</a>] is used to specify IPv6 prefixes associated with an IA_PD
   and is encapsulated within the Options field of such an IA_PD option.

   To differentiate between instances of the same type of IA containers
   for a client, each IA_NA, IA_TA, and IA_PD options have an IAID field
   with a unique value for a given IA type.  It is up to the client to
   pick unique IAID values.  At least one popular implementation uses
   the last four octets of the link-layer address.  In most cases, that
   means that merely two bytes are missing for a full link-layer address
   reconstruction.  However, the first three octets in a typical link-
   layer address are vendor identifiers.  That can be determined with a
   high level of certainty using other means, thus allowing full link-
   layer address discovery.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.5.%20%20Client%20FQDN%20Option"></a><a class="selflink" href="#section-3.5" name="section-3.5">3.5</a>.  Client FQDN Option</span>

   The Client Fully Qualified Domain Name (FQDN) option [<a href="rfc4704.html" title='"The Dynamic Host Configuration Protocol for IPv6 (DHCPv6) Client Fully Qualified Domain Name (FQDN) Option"'>RFC4704</a>] is
   used by DHCPv6 clients and servers to exchange information about the
   client's FQDN and about who has the responsibility for updating the
   DNS with the associated AAAA and PTR RRs.



<span class="grey">Krishnan, et al.              Informational                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7824.html">RFC 7824</a>              DHCPv6 Privacy Considerations             May 2016</span>


   A client can use this option to convey all or part of its domain name
   to a DHCPv6 server for the IPv6-address-to-FQDN mapping.  In most
   cases, a client sends its hostname as a hint for the server.  The
   DHCPv6 server may be configured to modify the supplied name or to
   substitute a different name.  The server should send its notion of
   the complete FQDN for the client in the Domain Name field.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.6.%20%20Client%20Link-Layer%20Address%20Option"></a><a class="selflink" href="#section-3.6" name="section-3.6">3.6</a>.  Client Link-Layer Address Option</span>

   The client link-layer address option [<a href="rfc6939.html" title='"Client Link-Layer Address Option in DHCPv6"'>RFC6939</a>] is used by first-hop
   DHCPv6 relays to provide the client's link-layer address towards the
   server.

   DHCPv6 relay agents that receive messages originating from clients
   may include the link-layer source address of the received DHCPv6
   message in the client link-layer address option, in relayed DHCPv6
   Relay-forward messages.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.7.%20%20Option%20Request%20Option"></a><a class="selflink" href="#section-3.7" name="section-3.7">3.7</a>.  Option Request Option</span>

   DHCPv6 clients include an Option Request option [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>] in DHCPv6
   messages to inform the server about options the client wants the
   server to send to the client.

   The contents of an Option Request option are the option codes for
   options requested by the client.  The client may additionally include
   instances of those options that are identified in the Option Request
   option, with data values as hints to the server about parameter
   values the client would like to have returned.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.8.%20%20Vendor%20Class%20and%20Vendor-Specific%20Information%20Options"></a><a class="selflink" href="#section-3.8" name="section-3.8">3.8</a>.  Vendor Class and Vendor-Specific Information Options</span>

   The Vendor Class option, defined in <a href="rfc3315.html#section-22.16">Section 22.16 of [RFC3315]</a>, is
   used by a DHCPv6 client to identify the vendor that manufactured the
   hardware on which the client is running.

   The Vendor-specific information option, defined in <a href="rfc3315.html#section-22.17">Section 22.17 of
   [RFC3315]</a>, includes enterprise number, which identifies the client's
   vendor and often includes a number of additional parameters that are
   specific to a given vendor.  That may include any type of information
   the vendor deems useful.  It should be noted that this information
   may be present (and different) in both directions: client-to-server
   and server-to-client communications.








<span class="grey">Krishnan, et al.              Informational                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7824.html">RFC 7824</a>              DHCPv6 Privacy Considerations             May 2016</span>


   The information contained in the data area of this option is
   contained in one or more opaque fields that identify details of the
   hardware configuration, for example, the version of the operating
   system the client is running or the amount of memory installed on the
   client.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.9.%20%20Civic%20Location%20Option"></a><a class="selflink" href="#section-3.9" name="section-3.9">3.9</a>.  Civic Location Option</span>

   DHCPv6 servers use the Civic Location option [<a href="rfc4776.html" title='"Dynamic Host Configuration Protocol (DHCPv4 and DHCPv6) Option for Civic Addresses Configuration Information"'>RFC4776</a>] to deliver
   location information (the civic and postal addresses) from the DHCPv6
   server to DHCPv6 clients.  It may refer to three locations: the
   location of the DHCPv6 server, the location of the network element
   believed to be closest to the client, or the location of the client,
   identified by the "what" element within the option.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.10.%20%20Coordinate-Based%20Location%20Option"></a><a class="selflink" href="#section-3.10" name="section-3.10">3.10</a>.  Coordinate-Based Location Option</span>

   The GeoLoc options [<a href="rfc6225.html" title='"Dynamic Host Configuration Protocol Options for Coordinate-Based Location Configuration Information"'>RFC6225</a>] are used by the DHCPv6 server to provide
   coordinate-based geographic location information to DHCPv6 clients.
   They enable a DHCPv6 client to obtain its location.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.11.%20%20Client%20System%20Architecture%20Type%20Option"></a><a class="selflink" href="#section-3.11" name="section-3.11">3.11</a>.  Client System Architecture Type Option</span>

   The Client System Architecture Type option [<a href="rfc5970.html" title='"DHCPv6 Options for Network Boot"'>RFC5970</a>] is used by the
   DHCPv6 client to send a list of supported architecture types to the
   DHCPv6 server.  It is used by clients that must be booted using the
   network rather than from local storage, so the server can decide
   which boot file should be provided to the client.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.12.%20%20Relay%20Agent%20Options"></a><a class="selflink" href="#section-3.12" name="section-3.12">3.12</a>.  Relay Agent Options</span>

   A DHCPv6 relay agent may include a number of options.  Those options
   contain information that can be used to identify the client.  Those
   options are almost exclusively exchanged between the relay agent and
   the server, thus never leaving the operators network.  In particular,
   they're almost never present in the last wireless hop in case of WiFi
   networks.  The only exception to that rule is somewhat infrequently
   used Relay-Supplied Options option [<a href="rfc6422.html" title='"Relay-Supplied DHCP Options"'>RFC6422</a>].  This fact implies that
   the threat-model-related relay options are slightly different.
   Traffic sniffing at the last hop and related class of attacks
   typically do not apply.  On the other hand, all attacks that involve
   the operator's infrastructure (either willing or coerced cooperation
   or infrastructure being compromised) usually apply.

   The following subsections describe various options inserted by the
   relay agents.





<span class="grey">Krishnan, et al.              Informational                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7824.html">RFC 7824</a>              DHCPv6 Privacy Considerations             May 2016</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.12.1.%20%20Subscriber-ID%20Option"></a><a class="selflink" href="#section-3.12.1" name="section-3.12.1">3.12.1</a>.  Subscriber-ID Option</span>

   A DHCPv6 relay may include a Subscriber-ID option [<a href="rfc4580.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6) Relay Agent Subscriber-ID Option"'>RFC4580</a>] to
   associate some provider-specific information with clients' DHCPv6
   messages that is independent of the physical network configuration.

   In many deployments, the relay agent that inserts this option is
   configured to use client's link-layer address as Subscriber-ID.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.12.2.%20%20Interface%20ID%20Option"></a><a class="selflink" href="#section-3.12.2" name="section-3.12.2">3.12.2</a>.  Interface ID Option</span>

   A DHCPv6 relay includes the Interface ID option [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>] to identify
   the interface on which it received the client message that is being
   relayed.

   Although, in principle, the Interface ID can be arbitrarily long with
   completely random values, it is sometimes a text string that includes
   the relay agent name followed by the interface name.  This can be
   used for fingerprinting the relay or determining a client's point of
   attachment.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.12.3.%20%20Remote%20ID%20Option"></a><a class="selflink" href="#section-3.12.3" name="section-3.12.3">3.12.3</a>.  Remote ID Option</span>

   A DHCPv6 relay includes a Remote ID option [<a href="rfc4649.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6) Relay Agent Remote-ID Option"'>RFC4649</a>] to identify the
   remote host end of the circuit.

   The remote-id is vendor specific, for which the vendor is indicated
   in the enterprise-number field.  The remote-id field may encode the
   information that identified DHCPv6 clients:

   o  a "caller ID" telephone number for dial-up connection

   o  a "user name" prompted for by a Remote Access Server

   o  a remote caller ATM address o a "modem ID" of a cable data modem

   o  the remote IP address of a point-to-point link

   o  an interface or port identifier

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.12.4.%20%20Relay-ID%20Option"></a><a class="selflink" href="#section-3.12.4" name="section-3.12.4">3.12.4</a>.  Relay-ID Option</span>

   Relay agent may include Relay-ID option [<a href="rfc5460.html" title='"DHCPv6 Bulk Leasequery"'>RFC5460</a>], which contains a
   unique relay agent identifier.  While its intended use is to provide
   additional information for the server, so it would be able to respond
   to leasequeries later, this information can be also used to identify
   a client's location within the network.




<span class="grey">Krishnan, et al.              Informational                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7824.html">RFC 7824</a>              DHCPv6 Privacy Considerations             May 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Existing%20Mechanisms%20That%20Affect%20Privacy"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Existing Mechanisms That Affect Privacy</span>

   This section describes deployed DHCPv6 mechanisms that can affect
   privacy.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Temporary%20Addresses"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Temporary Addresses</span>

   [<a id="ref-RFC3315" name="ref-RFC3315">RFC3315</a>] defines a mechanism for a client to request temporary
   addresses.  The idea behind temporary addresses is that a client can
   request a temporary address for a specific purpose, use it, and then
   never renew it (i.e., let it expire).

   There are a number of serious issues, both related to protocol and
   its implementations, that make temporary addresses nearly useless for
   their original goal.  First, [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>] does not include T1 and T2
   renewal timers in IA_TA (a container for temporary addresses).
   However, in <a href="#section-18.1.3">Section 18.1.3</a>, it explicitly mentions that temporary
   addresses can be renewed.  Client implementations may mistakenly
   renew temporary addresses if they are not careful (i.e., by including
   the IA_TA with the same IAID in Renew or Rebind requests, rather than
   a new IAID -- see <a href="rfc3315.html#section-22.5">Section 22.5 of [RFC3315]</a>), thus forfeiting short
   liveness.  [<a href="rfc4704.html" title='"The Dynamic Host Configuration Protocol for IPv6 (DHCPv6) Client Fully Qualified Domain Name (FQDN) Option"'>RFC4704</a>] does not explicitly prohibit servers from
   updating DNS for assigned temporary addresses, and there are
   implementations that can be configured to do that.  However, this is
   not advised as publishing a client's IPv6 address in DNS that is
   publicly available is a major privacy breach.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20DNS%20Updates"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  DNS Updates</span>

   The Client FQDN option [<a href="rfc4704.html" title='"The Dynamic Host Configuration Protocol for IPv6 (DHCPv6) Client Fully Qualified Domain Name (FQDN) Option"'>RFC4704</a>] used along with DNS UPDATE [<a href="rfc2136.html" title='"Dynamic Updates in the Domain Name System (DNS UPDATE)"'>RFC2136</a>]
   defines a mechanism that allows both clients and the server to insert
   information about clients into the DNS domain.  Both forward (AAAA)
   and reverse (PTR) resource records can be updated.  This allows other
   nodes to conveniently refer to a host, despite the fact that its IPv6
   address may be changing.

   This mechanism exposes two important pieces of information: the
   current address (which can be mapped to current location) and a
   client's hostname.  The stable hostname can then by used to correlate
   the client across different network attachments even when its IPv6
   address keeps changing.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Allocation%20Strategies"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Allocation Strategies</span>

   A DHCPv6 server running in typical, stateful mode is given a task of
   managing one or more pools of IPv6 resources (currently non-temporary
   addresses, temporary addresses and/or prefixes, but more resource
   types may be defined in the future).  When a client requests a



<span class="grey">Krishnan, et al.              Informational                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7824.html">RFC 7824</a>              DHCPv6 Privacy Considerations             May 2016</span>


   resource, the server must pick a resource out of the configured pool.
   Depending on the server's implementation, various allocation
   strategies are possible.  Choices in this regard may have privacy
   implications.

   Iterative allocation:  a server may choose to allocate addresses one
      by one.  That strategy has the benefit of being very fast, thus
      being favored in deployments that prefer performance.  However, it
      makes the resources very predictable.  Also, since the resources
      allocated tend to be clustered at the beginning of an available
      pool, it makes scanning attacks much easier.

   Identifier-based allocation:  some server implementations use a fixed
      identifier for a specific client, seemingly taken from the
      client's MAC address when available or some lower bits of client's
      source IPv6 address.  This has a property of being convenient for
      converting IP address to/from other identifiers, especially if the
      identifier is or contains a MAC address.  It is also convenient,
      as a returning client is very likely to get the same address, even
      if the server does not retain the client's previous address.
      Those properties are convenient for system administrators, so
      DHCPv6 server implementors are sometimes requested to implement
      it.  There is at least one implementation that supports it.  The
      downside of such allocation is that the client now discloses its
      identifier in its IPv6 address to all services to which it
      connects.  That means that attacks related to the correlation of
      activities over time, location tracking, address scanning, and OS/
      vendor discovery apply.

   Hash allocation:  an extension of identifier-based allocation.
      Instead of using the identifier directly, it is hashed first.  If
      the hash is implemented correctly, it removes the flaw of
      disclosing the identifier, a property that eliminates
      susceptibility to address scanning and OS/vendor discovery.  If
      the hash is poorly implemented (e.g., can be reversed), it
      introduces no improvement over identifier-based allocation.  Even
      a well-implemented hash does not mitigate the threat of
      correlation over time.

   Random allocation:  a server can pick a resource pseudorandomly out
      of an available pool.  This allocation scheme essentially prevents
      returning clients from getting the same address or prefix again.
      On the other hand, it is beneficial from a privacy perspective as
      addresses and prefixes generated that way are not susceptible to
      correlation attacks, OS/vendor discovery attacks, or identity
      discovery attacks.  Note that even though the address or prefix
      itself may be resilient to a given attack, the client may still be




<span class="grey">Krishnan, et al.              Informational                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7824.html">RFC 7824</a>              DHCPv6 Privacy Considerations             May 2016</span>


      susceptible if additional information is disclosed other way; for
      example, the client's address may be randomized, but it still can
      leak its MAC address in the Client Identifier option.

   Other allocation strategies may be implemented.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Attacks"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Attacks</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Device%20Type%20Discovery%20%28Fingerprinting%29"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Device Type Discovery (Fingerprinting)</span>

   The type of device used by the client can be guessed by the attacker
   using the Vendor Class option, Vendor-specific information option,
   the client link-layer address option, and by parsing the Client
   Identifier option.  All of those options may contain OUI
   (Organizationally Unique Identifier) that represents the device's
   vendor.  That knowledge can be used for device-specific vulnerability
   exploitation attacks.  See <a href="rfc7721.html#section-3.4">Section 3.4 of [RFC7721]</a> for a discussion
   about this type of attack.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Operating%20System%20Discovery%20%28Fingerprinting%29"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Operating System Discovery (Fingerprinting)</span>

   The operating system running on a client can be guessed using the
   Vendor Class option, the Vendor-specific information option, the
   Client System Architecture Type option, or by using fingerprinting
   techniques on the combination of options requested using the Option
   Request option.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Finding%20Location%20Information"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Finding Location Information</span>

   The physical location information can be obtained by the attacker by
   many means.  The most direct way to obtain this information is by
   looking into a message originating from the server that contains the
   Civic Location or GeoLoc options.  It can also be indirectly inferred
   using the Remote ID option, the Interface ID option (e.g., if an
   access circuit on an Access Node corresponds to a civic location), or
   the Subscriber-ID option (if the attacker has access to subscriber
   info).

   Another way to discover a client's physical location is to use
   geolocation services.  Those services typically map IP prefixes into
   geographical locations.  The services are usually based on known
   locations of the subnet, so they may reveal a client's location to
   the extent of the network to which it is connected, if they can
   locate the network.  However, they usually are not able to discover
   specific physical location within a network.  That is not always true
   and it depends on the quality of the a priori information available
   in the geolocation services databases.  It should be noted that this
   threat is general to the DHCPv6 mechanism.  Regardless of the



<span class="grey">Krishnan, et al.              Informational                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc7824.html">RFC 7824</a>              DHCPv6 Privacy Considerations             May 2016</span>


   allocation strategy used by the DHCPv6 server implementation, the
   addresses assigned will always belong to the subnet the server is
   configured to manage.  Cases of using ULAs (Unique Local Addresses)
   assigned by the DHCPv6 server are out of scope for this document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20Finding%20Previously%20Visited%20Networks"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  Finding Previously Visited Networks</span>

   When DHCPv6 clients reconnect to a network, they attempt to obtain
   the same address they used when they previously attached to that
   network.  They do this by putting the previously assigned address(es)
   in the IA Address option(s).  [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>] does not exclude IA_TA in
   such a case, so it is possible that a client implementation includes
   an address contained in an IA_TA for the Confirm message.  By
   observing these addresses, an attacker can identify the network the
   client had previously visited.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.5.%20%20Finding%20a%20Stable%20Identity"></a><a class="selflink" href="#section-5.5" name="section-5.5">5.5</a>.  Finding a Stable Identity</span>

   An attacker might use a stable identity gleaned from DHCPv6 messages
   to correlate activities of a given client on unrelated networks.  The
   Client FQDN option, the Subscriber-ID option, and the Client ID
   option can serve as long-lived identifiers of DHCPv6 clients.  The
   Client FQDN option can also provide an identity that can easily be
   correlated with web server activity logs.

   It should be noted that in the general case, the MAC addresses as
   such are not available in the DHCPv6 packets.  Therefore, they cannot
   be used directly in a reliable way.  However, they may become
   indirectly available using other mechanisms: the client-id contains
   the link-local address if DUID-LL or DUID-LLT types are used, the
   source IPv6 address may use an EUI-64 that contains a MAC address,
   some access technologies may specify a MAC address in dedicated
   options (e.g., cable modems use MAC addresses in Data Over Cable
   Service Interface Specification (DOCSIS) options).  Relay agents may
   insert additional information that is used to help the server to
   identify the client.  This could be the Remote-Id option, Subscriber-
   ID option, client link-layer address option or Vendor-specific
   information options.  Options inserted by relay agents usually
   traverse only the relay-server path, so they typically can't be
   eavesdropped by intercepting the client's transmissions.  This
   depends on the actual deployment model and used access technologies.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.6.%20%20Pervasive%20Monitoring"></a><a class="selflink" href="#section-5.6" name="section-5.6">5.6</a>.  Pervasive Monitoring</span>

   Pervasive Monitoring (PM) is widespread (and often covert)
   surveillance through intrusive gathering of protocol artifacts,
   including application content or protocol metadata such as headers.
   Active or passive wiretaps and traffic analysis, (e.g., correlation,



<span class="grey">Krishnan, et al.              Informational                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc7824.html">RFC 7824</a>              DHCPv6 Privacy Considerations             May 2016</span>


   timing or measuring packet sizes) or subverting the cryptographic
   keys used to secure protocols can also be used as part of pervasive
   monitoring.  PM is distinguished by being indiscriminate and very
   large scale; it does not necessarily introduce new types of technical
   compromise.  See [<a href="rfc7258.html" title='"Pervasive Monitoring Is an Attack"'>RFC7258</a>] for a discussion about PM.

   In the DHCPv6 context, the PM approach can be used to collect any
   identifiers discussed in <a href="#section-3">Section 3</a>.  DHCPv4 and DHCPv6 are especially
   susceptible as the initial message sent (SOLICIT in the case of
   DHCPv6) is one of the very first packets sent when visiting a
   network.  Furthermore, in certain cases, this packet can be logged
   even on networks that do not support IPv6 (some implementations
   initiate DHCPv6 even without receiving RA with M or O bits set).
   This may be an easily overlooked attack vector when an IPv6-capable
   device connects to an IPv4-only network, gains only IPv4
   connectivity, but still leaks its stable identifiers over DHCPv6.

   Using the PM approach, the attacks discussed in Sections <a href="#section-5.1">5.1</a>, <a href="#section-5.2">5.2</a>,
   5.3, 5.4, 5.5, 5.7, 5.8, and possibly 5.9, apply.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.7.%20%20Finding%20a%20Client%27s%20IP%20Address%20or%20Hostname"></a><a class="selflink" href="#section-5.7" name="section-5.7">5.7</a>.  Finding a Client's IP Address or Hostname</span>

   Many DHCPv6 deployments use DNS Updates [<a href="rfc4704.html" title='"The Dynamic Host Configuration Protocol for IPv6 (DHCPv6) Client Fully Qualified Domain Name (FQDN) Option"'>RFC4704</a>] that put client's
   information (current IP address, client's hostname) into the DNS,
   where it is easily accessible by anyone interested.  Client ID is
   also disclosed, albeit in not an easily accessible form (SHA-256
   digest of the client-id).  As SHA-256 is considered irreversible,
   DHCID can't be converted back to client-id.  However, SHA-256 digest
   can be used as an unique identifier that is accessible by any host.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.8.%20%20Correlation%20of%20Activities%20over%20Time"></a><a class="selflink" href="#section-5.8" name="section-5.8">5.8</a>.  Correlation of Activities over Time</span>

   As with other identifiers, an IPv6 address can be used to correlate
   the activities of a host for at least as long as the lifetime of the
   address.  If that address was generated from some other, stable
   identifier and that generation scheme can be deduced by an attacker,
   the duration of the correlation attack extends to that of the
   identifier.  In many cases, its lifetime is equal to the lifetime of
   the device itself.  See <a href="rfc7721.html#section-3.1">Section 3.1 of [RFC7721]</a> for detailed
   discussion.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.9.%20%20Location%20Tracking"></a><a class="selflink" href="#section-5.9" name="section-5.9">5.9</a>.  Location Tracking</span>

   If a stable identifier is used for assigning an address and such
   mapping is discovered by an attacker (e.g., a server that uses IEEE-
   identifier-based IID to generate an IPv6 address), all scenarios
   discussed in <a href="rfc7721.html#section-3.2">Section 3.2 of [RFC7721]</a> apply.  In particular, both
   passive (a service that the client connects to can log the client's



<span class="grey">Krishnan, et al.              Informational                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc7824.html">RFC 7824</a>              DHCPv6 Privacy Considerations             May 2016</span>


   address and draw conclusions regarding its location and movement
   patterns based on the prefix it is connecting from) and active (an
   attacker can send ICMPv6 echo requests or other probe packets to
   networks of suspected client locations) can be used.  To give a
   specific example, by accessing a social portal from
   tomek-laptop.coffee.somecity.com.example,
   tomek-laptop.mycompany.com.example, and
   tomek-laptop.myisp.example.com, the portal administrator can draw
   conclusions about tomek-laptop's owner's current location and his
   habits.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.10.%20%20Leasequery%20and%20Bulk%20Leasequery"></a><a class="selflink" href="#section-5.10" name="section-5.10">5.10</a>.  Leasequery and Bulk Leasequery</span>

   Attackers may masquerade as an access concentrator, either as a
   DHCPv6 relay agent or as a DHCPv6 client, to obtain location
   information directly from the DHCPv6 server(s) using the DHCPv6
   Leasequery [<a href="rfc5007.html" title='"DHCPv6 Leasequery"'>RFC5007</a>] mechanism.

   Location information is information needed by the access concentrator
   to forward traffic to a broadband-accessible host.  This information
   includes knowledge of the host hardware address, the port or virtual
   circuit that leads to the host, and/or the hardware address of the
   intervening subscriber modem.

   Furthermore, the attackers may use the DHCPv6 bulk leasequery
   [<a href="rfc5460.html" title='"DHCPv6 Bulk Leasequery"'>RFC5460</a>] mechanism to obtain bulk information about DHCPv6 bindings,
   even without knowing the target bindings.

   Additionally, active leasequery [<a href="rfc7653.html" title='"DHCPv6 Active Leasequery"'>RFC7653</a>] is a mechanism for
   subscribing to DHCPv6 lease update changes in near real-time.  The
   intent of this mechanism is to update an operator's database;
   however, if the mechanism is misused, an attacker could defeat the
   server's authentication mechanisms and subscribe to all updates.  He
   then could continue receiving updates, without any need for local
   presence.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Security Considerations</span>

   In current practice, the client privacy and client authentication are
   mutually exclusive.  The client authentication procedure reveals
   additional client information in their certificates/identifiers.
   Full privacy for the clients may mean the clients are also anonymous
   to the server and the network.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Privacy%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Privacy Considerations</span>

   This document in its entirety discusses privacy considerations in
   DHCPv6.  As such, no dedicated discussion is needed.



<span class="grey">Krishnan, et al.              Informational                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc7824.html">RFC 7824</a>              DHCPv6 Privacy Considerations             May 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20References"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Normative%20References"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Normative References</span>

   [<a id="ref-RFC3315" name="ref-RFC3315">RFC3315</a>]  Droms, R., Ed., Bound, J., Volz, B., Lemon, T., Perkins,
              C., and M. Carney, "Dynamic Host Configuration Protocol
              for IPv6 (DHCPv6)", <a href="rfc3315.html">RFC 3315</a>, DOI 10.17487/RFC3315, July
              2003, &lt;<a href="http://www.rfc-editor.org/info/rfc3315">http://www.rfc-editor.org/info/rfc3315</a>&gt;.

   [<a id="ref-RFC6973" name="ref-RFC6973">RFC6973</a>]  Cooper, A., Tschofenig, H., Aboba, B., Peterson, J.,
              Morris, J., Hansen, M., and R. Smith, "Privacy
              Considerations for Internet Protocols", <a href="rfc6973.html">RFC 6973</a>,
              DOI 10.17487/RFC6973, July 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6973">http://www.rfc-editor.org/info/rfc6973</a>&gt;.

   [<a id="ref-RFC7258" name="ref-RFC7258">RFC7258</a>]  Farrell, S. and H. Tschofenig, "Pervasive Monitoring Is an
              Attack", <a href="https://tools.ietf.org/html/bcp188">BCP 188</a>, <a href="rfc7258.html">RFC 7258</a>, DOI 10.17487/RFC7258, May
              2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7258">http://www.rfc-editor.org/info/rfc7258</a>&gt;.

   [<a id="ref-RFC7721" name="ref-RFC7721">RFC7721</a>]  Cooper, A., Gont, F., and D. Thaler, "Security and Privacy
              Considerations for IPv6 Address Generation Mechanisms",
              <a href="rfc7721.html">RFC 7721</a>, DOI 10.17487/RFC7721, March 2016,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7721">http://www.rfc-editor.org/info/rfc7721</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Informative%20References"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Informative References</span>

   [<a id="ref-RFC2136" name="ref-RFC2136">RFC2136</a>]  Vixie, P., Ed., Thomson, S., Rekhter, Y., and J. Bound,
              "Dynamic Updates in the Domain Name System (DNS UPDATE)",
              <a href="rfc2136.html">RFC 2136</a>, DOI 10.17487/RFC2136, April 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2136">http://www.rfc-editor.org/info/rfc2136</a>&gt;.

   [<a id="ref-RFC3633" name="ref-RFC3633">RFC3633</a>]  Troan, O. and R. Droms, "IPv6 Prefix Options for Dynamic
              Host Configuration Protocol (DHCP) version 6", <a href="rfc3633.html">RFC 3633</a>,
              DOI 10.17487/RFC3633, December 2003,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3633">http://www.rfc-editor.org/info/rfc3633</a>&gt;.

   [<a id="ref-RFC4580" name="ref-RFC4580">RFC4580</a>]  Volz, B., "Dynamic Host Configuration Protocol for IPv6
              (DHCPv6) Relay Agent Subscriber-ID Option", <a href="rfc4580.html">RFC 4580</a>,
              DOI 10.17487/RFC4580, June 2006,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4580">http://www.rfc-editor.org/info/rfc4580</a>&gt;.

   [<a id="ref-RFC4649" name="ref-RFC4649">RFC4649</a>]  Volz, B., "Dynamic Host Configuration Protocol for IPv6
              (DHCPv6) Relay Agent Remote-ID Option", <a href="rfc4649.html">RFC 4649</a>,
              DOI 10.17487/RFC4649, August 2006,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4649">http://www.rfc-editor.org/info/rfc4649</a>&gt;.






<span class="grey">Krishnan, et al.              Informational                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc7824.html">RFC 7824</a>              DHCPv6 Privacy Considerations             May 2016</span>


   [<a id="ref-RFC4704" name="ref-RFC4704">RFC4704</a>]  Volz, B., "The Dynamic Host Configuration Protocol for
              IPv6 (DHCPv6) Client Fully Qualified Domain Name (FQDN)
              Option", <a href="rfc4704.html">RFC 4704</a>, DOI 10.17487/RFC4704, October 2006,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4704">http://www.rfc-editor.org/info/rfc4704</a>&gt;.

   [<a id="ref-RFC4776" name="ref-RFC4776">RFC4776</a>]  Schulzrinne, H., "Dynamic Host Configuration Protocol
              (DHCPv4 and DHCPv6) Option for Civic Addresses
              Configuration Information", <a href="rfc4776.html">RFC 4776</a>,
              DOI 10.17487/RFC4776, November 2006,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4776">http://www.rfc-editor.org/info/rfc4776</a>&gt;.

   [<a id="ref-RFC4941" name="ref-RFC4941">RFC4941</a>]  Narten, T., Draves, R., and S. Krishnan, "Privacy
              Extensions for Stateless Address Autoconfiguration in
              IPv6", <a href="rfc4941.html">RFC 4941</a>, DOI 10.17487/RFC4941, September 2007,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4941">http://www.rfc-editor.org/info/rfc4941</a>&gt;.

   [<a id="ref-RFC5007" name="ref-RFC5007">RFC5007</a>]  Brzozowski, J., Kinnear, K., Volz, B., and S. Zeng,
              "DHCPv6 Leasequery", <a href="rfc5007.html">RFC 5007</a>, DOI 10.17487/RFC5007,
              September 2007, &lt;<a href="http://www.rfc-editor.org/info/rfc5007">http://www.rfc-editor.org/info/rfc5007</a>&gt;.

   [<a id="ref-RFC5460" name="ref-RFC5460">RFC5460</a>]  Stapp, M., "DHCPv6 Bulk Leasequery", <a href="rfc5460.html">RFC 5460</a>,
              DOI 10.17487/RFC5460, February 2009,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5460">http://www.rfc-editor.org/info/rfc5460</a>&gt;.

   [<a id="ref-RFC5970" name="ref-RFC5970">RFC5970</a>]  Huth, T., Freimann, J., Zimmer, V., and D. Thaler, "DHCPv6
              Options for Network Boot", <a href="rfc5970.html">RFC 5970</a>, DOI 10.17487/RFC5970,
              September 2010, &lt;<a href="http://www.rfc-editor.org/info/rfc5970">http://www.rfc-editor.org/info/rfc5970</a>&gt;.

   [<a id="ref-RFC6225" name="ref-RFC6225">RFC6225</a>]  Polk, J., Linsner, M., Thomson, M., and B. Aboba, Ed.,
              "Dynamic Host Configuration Protocol Options for
              Coordinate-Based Location Configuration Information",
              <a href="rfc6225.html">RFC 6225</a>, DOI 10.17487/RFC6225, July 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6225">http://www.rfc-editor.org/info/rfc6225</a>&gt;.

   [<a id="ref-RFC6355" name="ref-RFC6355">RFC6355</a>]  Narten, T. and J. Johnson, "Definition of the UUID-Based
              DHCPv6 Unique Identifier (DUID-UUID)", <a href="rfc6355.html">RFC 6355</a>,
              DOI 10.17487/RFC6355, August 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6355">http://www.rfc-editor.org/info/rfc6355</a>&gt;.

   [<a id="ref-RFC6422" name="ref-RFC6422">RFC6422</a>]  Lemon, T. and Q. Wu, "Relay-Supplied DHCP Options",
              <a href="rfc6422.html">RFC 6422</a>, DOI 10.17487/RFC6422, December 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6422">http://www.rfc-editor.org/info/rfc6422</a>&gt;.

   [<a id="ref-RFC6939" name="ref-RFC6939">RFC6939</a>]  Halwasia, G., Bhandari, S., and W. Dec, "Client Link-Layer
              Address Option in DHCPv6", <a href="rfc6939.html">RFC 6939</a>, DOI 10.17487/RFC6939,
              May 2013, &lt;<a href="http://www.rfc-editor.org/info/rfc6939">http://www.rfc-editor.org/info/rfc6939</a>&gt;.





<span class="grey">Krishnan, et al.              Informational                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc7824.html">RFC 7824</a>              DHCPv6 Privacy Considerations             May 2016</span>


   [<a id="ref-RFC7653" name="ref-RFC7653">RFC7653</a>]  Raghuvanshi, D., Kinnear, K., and D. Kukrety, "DHCPv6
              Active Leasequery", <a href="rfc7653.html">RFC 7653</a>, DOI 10.17487/RFC7653,
              October 2015, &lt;<a href="http://www.rfc-editor.org/info/rfc7653">http://www.rfc-editor.org/info/rfc7653</a>&gt;.

   [<a id="ref-RFC7844" name="ref-RFC7844">RFC7844</a>]  Huitema, C., Mrugalski, T., and S. Krishnan, "Anonymity
              Profile for DHCP Clients", <a href="rfc7844.html">RFC 7844</a>, DOI 10.17487/RFC7844,
              May 2016, &lt;<a href="http://www.rfc-editor.org/info/rfc7844">http://www.rfc-editor.org/info/rfc7844</a>&gt;.

Acknowledgements

   The authors would like to thank Stephen Farrell, Ted Lemon, Ines
   Robles, Russ White, Christian Schaefer, Jinmei Tatuya, Bernie Volz,
   Marcin Siodelski, Christian Huitema, Brian Haberman, Robert Sparks,
   Peter Yee, Ben Campbell, and other members of DHC WG for their
   valuable comments.

Authors' Addresses

   Suresh Krishnan
   Ericsson
   8400 Decarie Blvd.
   Town of Mount Royal, QC
   Canada

   Phone: +1 514 345 7900 x42871
   Email: suresh.krishnan@ericsson.com


   Tomek Mrugalski
   Internet Systems Consortium, Inc.
   950 Charter Street
   Redwood City, CA  94063
   United States

   Email: tomasz.mrugalski@gmail.com


   Sheng Jiang
   Huawei Technologies Co., Ltd.
   Q14, Huawei Campus, No.156 BeiQing Road
   Hai-Dian District, Beijing  100095
   China

   Email: jiangsheng@huawei.com







Krishnan, et al.              Informational                    [Page 18]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7824 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:19 GMT --></html>