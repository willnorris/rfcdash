<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc4767 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:39 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:4767" name="DC.Identifier"/>
<meta content='This memo describes the Intrusion Detection Exchange Protocol (IDXP),
an application-level protocol for exchanging data between intrusion
detection entities. IDXP supports mutual-authentication, integrity,
and confidentiality over a connection-oriented protocol. The protocol
provides for the exchange of IDMEF messages, unstructured text, and
binary data. The IDMEF message elements are described in RFC 4765,
"The Intrusion Detection Message Exchange Format (IDMEF)", a companion
document of the Intrusion Detection Exchange Format Working Group
(IDWG) of the IETF. This memo defines an Experimental Protocol for the
Internet community.' name="DC.Description.Abstract"/>
<meta content="Matthews, Gregory A." name="DC.Creator"/>
<meta content="Feinstein, Benjamin S." name="DC.Creator"/>
<meta content="March, 2007" name="DC.Date.Issued"/>
<meta content="The Intrusion Detection Exchange Protocol (IDXP)" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 4767 - The Intrusion Detection Exchange Protocol (IDXP)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgyellow" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc4767.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc4767" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-idwg-beep-idxp" title="draft-ietf-idwg-beep-idxp">draft-ietf-idwg...</a>] [<a href="https://datatracker.ietf.org/doc/rfc4767" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4767" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc4767" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                            EXPERIMENTAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                       B. Feinstein
Request for Comments: 4767                             SecureWorks, Inc.
Category: Experimental                                       G. Matthews
                                           CSC/NASA Ames Research Center
                                                              March 2007


            <span class="h1">The Intrusion Detection Exchange Protocol (IDXP)</span>

Status of This Memo

   This memo defines an Experimental Protocol for the Internet
   community.  It does not specify an Internet standard of any kind.
   Discussion and suggestions for improvement are requested.
   Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The IETF Trust (2007).

Abstract

   This memo describes the Intrusion Detection Exchange Protocol (IDXP),
   an application-level protocol for exchanging data between intrusion
   detection entities.  IDXP supports mutual-authentication, integrity,
   and confidentiality over a connection-oriented protocol.  The
   protocol provides for the exchange of IDMEF messages, unstructured
   text, and binary data.  The IDMEF message elements are described in
   <a href="rfc4765.html">RFC 4765</a>, "The Intrusion Detection Message Exchange Format (IDMEF)",
   a companion document of the Intrusion Detection Exchange Format
   Working Group (IDWG) of the IETF.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Purpose ....................................................<a href="#page-3">3</a>
      <a href="#section-1.2">1.2</a>. Profiles ...................................................<a href="#page-3">3</a>
      <a href="#section-1.3">1.3</a>. Terminology ................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. The Model .......................................................<a href="#page-4">4</a>
      <a href="#section-2.1">2.1</a>. Connection Provisioning ....................................<a href="#page-4">4</a>
      <a href="#section-2.2">2.2</a>. Data Transfer ..............................................<a href="#page-6">6</a>
      <a href="#section-2.3">2.3</a>. Connection Teardown ........................................<a href="#page-7">7</a>
      <a href="#section-2.4">2.4</a>. Trust Model ................................................<a href="#page-8">8</a>
   <a href="#section-3">3</a>. The IDXP Profile ................................................<a href="#page-8">8</a>
      <a href="#section-3.1">3.1</a>. IDXP Profile Overview ......................................<a href="#page-8">8</a>
      <a href="#section-3.2">3.2</a>. IDXP Profile Identification and Initialization .............<a href="#page-9">9</a>
      <a href="#section-3.3">3.3</a>. IDXP Profile Message Syntax ................................<a href="#page-9">9</a>
      <a href="#section-3.4">3.4</a>. IDXP Profile Semantics .....................................<a href="#page-9">9</a>



<span class="grey">Feinstein &amp; Matthews          Experimental                      [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


           <a href="#section-3.4.1">3.4.1</a>. The IDXP-Greeting Element ..........................<a href="#page-10">10</a>
           <a href="#section-3.4.2">3.4.2</a>. The Option Element .................................<a href="#page-11">11</a>
           <a href="#section-3.4.3">3.4.3</a>. The IDMEF-Message Element ..........................<a href="#page-12">12</a>
   <a href="#section-4">4</a>. IDXP Options ...................................................<a href="#page-12">12</a>
      <a href="#section-4.1">4.1</a>. The channelPriority Option ................................<a href="#page-13">13</a>
      <a href="#section-4.2">4.2</a>. The streamType Option .....................................<a href="#page-14">14</a>
   <a href="#section-5">5</a>. Fulfillment of IDWG Communications Protocol Requirements .......<a href="#page-16">16</a>
      <a href="#section-5.1">5.1</a>. Reliable Message Transmission .............................<a href="#page-16">16</a>
      <a href="#section-5.2">5.2</a>. Interaction with Firewalls ................................<a href="#page-16">16</a>
      <a href="#section-5.3">5.3</a>. Mutual Authentication .....................................<a href="#page-16">16</a>
      <a href="#section-5.4">5.4</a>. Message Confidentiality ...................................<a href="#page-17">17</a>
      <a href="#section-5.5">5.5</a>. Message Integrity .........................................<a href="#page-17">17</a>
      <a href="#section-5.6">5.6</a>. Per-Source Authentication .................................<a href="#page-17">17</a>
      <a href="#section-5.7">5.7</a>. Denial of Service .........................................<a href="#page-18">18</a>
      <a href="#section-5.8">5.8</a>. Message Duplication .......................................<a href="#page-18">18</a>
   <a href="#section-6">6</a>. Extending IDXP .................................................<a href="#page-18">18</a>
   <a href="#section-7">7</a>. IDXP Option Registration Template ..............................<a href="#page-19">19</a>
   <a href="#section-8">8</a>. Initial Registrations ..........................................<a href="#page-19">19</a>
      <a href="#section-8.1">8.1</a>. Registration: The IDXP Profile ............................<a href="#page-19">19</a>
      8.2. Registration: The System (Well-Known) TCP Port
           Number for IDXP ...........................................<a href="#page-19">19</a>
      <a href="#section-8.3">8.3</a>. Registration: The channelPriority Option ..................<a href="#page-20">20</a>
      <a href="#section-8.4">8.4</a>. Registration: The streamType Option .......................<a href="#page-20">20</a>
   <a href="#section-9">9</a>. The DTDs .......................................................<a href="#page-20">20</a>
      <a href="#section-9.1">9.1</a>. The IDXP DTD ..............................................<a href="#page-20">20</a>
      <a href="#section-9.2">9.2</a>. The channelPriority Option DTD ............................<a href="#page-22">22</a>
      <a href="#section-9.3">9.3</a>. The streamType DTD ........................................<a href="#page-23">23</a>
   <a href="#section-10">10</a>. Reply Codes ...................................................<a href="#page-24">24</a>
   <a href="#section-11">11</a>. Security Considerations .......................................<a href="#page-25">25</a>
      <a href="#section-11.1">11.1</a>. Use of the TUNNEL Profile ................................<a href="#page-25">25</a>
      <a href="#section-11.2">11.2</a>. Use of Underlying Security Profiles ......................<a href="#page-25">25</a>
   <a href="#section-12">12</a>. IANA Considerations ...........................................<a href="#page-25">25</a>
   <a href="#section-13">13</a>. References ....................................................<a href="#page-26">26</a>
      <a href="#section-13.1">13.1</a>. Normative References .....................................<a href="#page-26">26</a>
      <a href="#section-13.2">13.2</a>. Informative References ...................................<a href="#page-26">26</a>
   <a href="#section-14">14</a>. Acknowledgements ..............................................<a href="#page-26">26</a>















<span class="grey">Feinstein &amp; Matthews          Experimental                      [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   IDXP is specified, in part, as a Blocks Extensible Exchange Protocol
   (BEEP) [<a href="#ref-4" title='"The Blocks Extensible Exchange Protocol Core"'>4</a>] "profile".  BEEP is a generic application protocol
   framework for connection-oriented, asynchronous interactions.
   Features such as authentication and confidentiality are provided
   through the use of other BEEP profiles.  Accordingly, many aspects of
   IDXP (e.g., confidentiality) are provided within the BEEP framework.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Purpose"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Purpose</span>

   IDXP provides for the exchange of IDMEF [<a href="#ref-2" title='"The Intrusion Detection Message Exchange Format (IDMEF)"'>2</a>] messages, unstructured
   text, and binary data between intrusion detection entities.
   Addressing the security-sensitive nature of exchanges between
   intrusion detection entities, underlying BEEP security profiles
   should be used to offer IDXP the required set of security properties.
   See <a href="#section-5">Section 5</a> for a discussion of how IDXP fulfills the IDWG
   communications protocol requirements.  See <a href="#section-11">Section 11</a> for a
   discussion of security considerations.

   IDXP is primarily intended for the exchange of data created by
   intrusion detection entities.  IDMEF [<a href="#ref-2" title='"The Intrusion Detection Message Exchange Format (IDMEF)"'>2</a>] messages should be used for
   the structured representation of this intrusion detection data,
   although IDXP may be used to exchange unstructured text and binary
   data.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Profiles"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Profiles</span>

   There are several BEEP profiles discussed, the first of which we
   define in this memo:

      The IDXP Profile

      The TUNNEL Profile [<a href="#ref-3" title='"The TUNNEL Profile"'>3</a>]

      The Simple Authentication and Security Layer (SASL) Family of
      Profiles (see Section 4.1 of [<a href="#ref-4" title='"The Blocks Extensible Exchange Protocol Core"'>4</a>])

      The TLS Profile (see Section 3.1 of [<a href="#ref-4" title='"The Blocks Extensible Exchange Protocol Core"'>4</a>])

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20Terminology"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a> [<a href="#ref-1" title='"Key words for use in RFCs to Indicate Requirement Levels"'>1</a>].






<span class="grey">Feinstein &amp; Matthews          Experimental                      [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


   Throughout this memo, the terms "analyzer" and "manager" are used in
   the context of the Intrusion Detection Message Exchange Requirements
   [<a href="#ref-5" title='"Intrusion Detection Message Exchange Requirements"'>5</a>].  In particular, Section 2.2 of [<a href="#ref-5" title='"Intrusion Detection Message Exchange Requirements"'>5</a>] defines a collection of
   intrusion detection terms.

   The terms "peer", "initiator", "listener", "client", and "server",
   and the characters "I", "L", "C", and "S" are used in the context of
   BEEP [<a href="#ref-4" title='"The Blocks Extensible Exchange Protocol Core"'>4</a>].  In particular, <a href="#section-2.1">Section 2.1</a> of BEEP discusses the roles
   that a BEEP peer may perform.

   The term "Document Type Definition" is abbreviated as "DTD" and is
   defined in <a href="#section-2.8">Section 2.8</a> of the Extensible Markup Language (XML) [<a href="#ref-7" title='"Extensible Markup Language (XML) 1.0 (2nd ed)"'>7</a>].

   Note that the term "proxy" is specific to IDXP and does not exist in
   the context of BEEP.  The term "intrusion detection" is abbreviated
   as "ID".

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20The%20Model"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  The Model</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Connection%20Provisioning"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Connection Provisioning</span>

   Intrusion detection entities using IDXP to transfer data are termed
   IDXP peers.  Peers can exist only in pairs, and these pairs
   communicate over a single BEEP session with one or more BEEP channels
   opened for transferring data.  Peers are either managers or
   analyzers, as defined in Section 2.2 of [<a href="#ref-5" title='"Intrusion Detection Message Exchange Requirements"'>5</a>].

   The relationship between analyzers and managers is potentially many-
   to-many.  That is, an analyzer MAY communicate with many managers;
   similarly, a manager MAY communicate with many analyzers.  Likewise,
   the relationship between different managers is potentially many-to-
   many, so that a manager MAY receive the alerts sent by a large number
   of analyzers by receiving them through intermediate managers.
   Analyzers MUST NOT establish IDXP exchanges with other analyzers.

   An IDXP peer wishing to establish IDXP communications with another
   IDXP peer does so by opening a BEEP channel, which may entail
   initiating a BEEP session.  A BEEP security profile offering the
   required security properties SHOULD initially be negotiated (see
   <a href="#section-11">Section 11</a> for a discussion of security considerations).  Following
   the successful negotiation of the BEEP security profile, IDXP
   greetings are exchanged and connection provisioning proceeds.

   In the following sequence, the peer 'Alice' initiates an IDXP
   exchange with the peer 'Bob'.






<span class="grey">Feinstein &amp; Matthews          Experimental                      [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


   Alice                                               Bob
     ---------------- xport connect(1) ------------------&gt;
    &lt;-------------------- greeting ----------------------&gt;
    &lt;-------------start security profile(2) -------------&gt;
    &lt;-------------------- greeting ----------------------&gt;
    &lt;------------------ start IDXP(3) -------------------&gt;

   Notes:

   (1) 'Alice' initiates a transport connection to 'Bob', triggering the
       exchange of BEEP greeting messages.

   (2) Both entities negotiate the use of a BEEP security profile.

   (3) Both entities negotiate the use of the IDXP profile.

   In between a pair of IDXP peers may be an arbitrary number of
   proxies.  A proxy may be necessary for administrative reasons, such
   as running on a firewall to allow restricted access.  Another use
   might be one proxy per company department, which forwards data from
   the analyzer peers in the department onto a company-wide manager
   peer.

   A BEEP tuning profile MAY be used to create an application-layer
   tunnel that transparently forwards data over a chain of proxies.  The
   TUNNEL profile [<a href="#ref-3" title='"The TUNNEL Profile"'>3</a>] SHOULD be used for this purpose; see [<a href="#ref-3" title='"The TUNNEL Profile"'>3</a>] for more
   detail concerning the options available to set up an application-
   layer tunnel using TUNNEL, and see <a href="#section-11.1">Section 11.1</a> for a discussion of
   TUNNEL-related security considerations.  TUNNEL MUST be offered as a
   tuning profile for the creation of application-layer tunnels.  The
   TUNNEL profile MUST offer the use of some form of SASL authentication
   (see Section 4.1 of [<a href="#ref-4" title='"The Blocks Extensible Exchange Protocol Core"'>4</a>]).  Once a tunnel has been created, a BEEP
   security profile offering the required security properties SHOULD be
   negotiated, followed by negotiation of the IDXP profile.

   The following sequence shows how TUNNEL might be used to create an
   application-layer tunnel through which IDXP would operate.  A peer
   'Alice' initiates the creation of a BEEP session using the IDXP
   profile with the entity 'Bob' by first contacting 'proxy1'.  In the
   greeting exchange between 'Alice' and 'proxy1', the TUNNEL profile is
   selected, and subsequently the use of the TUNNEL profile is extended
   to reach through 'proxy2' to 'Bob'.









<span class="grey">Feinstein &amp; Matthews          Experimental                      [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


   Alice              proxy1               proxy2               Bob
     -- xport connect --&gt;
    &lt;---- greeting -----&gt;
     -- start TUNNEL ---&gt;
                         - xport connect(1) -&gt;
                        &lt;----- greeting -----&gt;
                         --- start TUNNEL ---&gt;
                                              --- xport connect --&gt;
                                             &lt;----- greeting -----&gt;
                                              --- start TUNNEL ---&gt;
                                             &lt;----- &lt;ok&gt;(2) ------
                        &lt;------- &lt;ok&gt; -------
    &lt;------ &lt;ok&gt; -------
    &lt;------------------------- greeting --------------------------&gt;
    &lt;------------------ start security profile -------------------&gt;
    &lt;------------------------- greeting --------------------------&gt;
    &lt;------------------------ start IDXP -------------------------&gt;

   Notes:

   (1) Instead of immediately acknowledging the request from 'Alice' to
       start TUNNEL, 'proxy1' attempts to establish use of TUNNEL with
       'proxy2'.  'proxy2' also delays its acknowledgment to 'proxy1'.

   (2) 'Bob' acknowledges the request from 'proxy2' to start TUNNEL, and
       this acknowledgment propagates back to 'Alice' so that a TUNNEL
       application-layer tunnel is established from 'Alice' to 'Bob'.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Data%20Transfer"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Data Transfer</span>

   Between a pair of ID entities communicating over a BEEP session, one
   or more BEEP channels MAY be opened using the IDXP profile.  If
   desired, additional BEEP sessions MAY be established to offer
   additional channels using the IDXP profile.  However, in most
   situations additional channels using the IDXP profile SHOULD be
   opened within an existing BEEP session, as opposed to provisioning a
   new BEEP session containing the additional channels using the IDXP
   profile.

   Peers assume the role of client or server on a per-channel basis,
   with one acting as the client and the other as the server.  A peer's
   role of client or server is determined independent of whether the
   peer assumed the role of initiator or listener during the BEEP
   session establishment.  Clients and servers act as sources and sinks,
   respectively, for exchanging data.






<span class="grey">Feinstein &amp; Matthews          Experimental                      [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


   In a simple case, an analyzer peer sends data to a manager peer.  For
   example,

   +----------+                          +----------+
   |          |                          |          |
   |          |****** BEEP session ******|          |
   |          |                          |          |
   | Analyzer | ----- IDXP profile ----&gt; | Manager  |
   | (Client) |                          | (Server) |
   |          |                          |          |
   |          |**************************|          |
   |          |                          |          |
   +----------+                          +----------+

   Use of multiple BEEP channels in a BEEP session facilitates
   categorization and prioritization of data sent between IDXP peers.
   For example, a manager 'M1', sending alert data to another manager,
   'M2', may choose to open a separate channel to exchange different
   categories of alerts.  'M1' would act as the client on each of these
   channels, and manager 'M2' can then process and act on the incoming
   alerts based on their respective channel categorizations.  See
   <a href="#section-4">Section 4</a> for more detail on how to incorporate categorization and/or
   prioritization into channel creation.

   +----------+                                            +----------+
   |          |                                            |          |
   |          |*************** BEEP session ***************|          |
   |          |                                            |          |
   |          | -- IDXP profile, network-based alerts ---&gt; |          |
   | Manager  |                                            | Manager  |
   |   M1     | ---- IDXP profile, host-based alerts ----&gt; |   M2     |
   | (Client) |                                            | (Server) |
   |          | ------ IDXP profile, other alerts -------&gt; |          |
   |          |                                            |          |
   |          |********************************************|          |
   |          |                                            |          |
   +----------+                                            +----------+

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20Connection%20Teardown"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  Connection Teardown</span>

   An IDXP peer may choose to close an IDXP channel under many different
   circumstances (e.g., an error in processing has occurred).  To close
   a channel, the peer sends a "close" element (see Section 2.3.1.3 of
   [<a href="#ref-4" title='"The Blocks Extensible Exchange Protocol Core"'>4</a>]) on channel zero indicating which channel is being closed.  An
   IDXP peer may also choose to close an entire BEEP session by sending
   a "close" element indicating that channel zero is to be closed.





<span class="grey">Feinstein &amp; Matthews          Experimental                      [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


   Section 2.3.1.3 of [<a href="#ref-4" title='"The Blocks Extensible Exchange Protocol Core"'>4</a>] offers a more complete discussion of the
   circumstances under which a BEEP peer is permitted to close a channel
   and the mechanisms for doing so.

   It is anticipated that due to the overhead of provisioning an
   application-layer tunnel and/or a BEEP security profile, BEEP
   sessions containing IDXP channels will be long-lived.  In addition,
   the repeated overhead of IDXP channel provisioning (i.e., the
   exchange of IDXP greetings) may be avoided by keeping IDXP channels
   open even while data is not actively being exchanged on them.  These
   are recommendations and, as such, IDXP peers may choose to close and
   re-provision BEEP sessions and/or IDXP channels as they see fit.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.4.%20%20Trust%20Model"></a><a class="selflink" href="#section-2.4" name="section-2.4">2.4</a>.  Trust Model</span>

   In our model, trust is placed exclusively in the IDXP peers.  Proxies
   are always assumed to be untrustworthy.  A BEEP security profile is
   used to establish end-to-end security between pairs of IDXP peers,
   doing away with the need to place trust in any intervening proxies.
   Only after successful negotiation of the underlying security profile
   are IDXP peers to be trusted.  Only BEEP security profiles offering
   at least the protections required by Section 5 of [<a href="#ref-5" title='"Intrusion Detection Message Exchange Requirements"'>5</a>] should be used
   to secure a BEEP session containing channels using the IDXP profile.
   See Section 3 of [<a href="#ref-4" title='"The Blocks Extensible Exchange Protocol Core"'>4</a>] for the registration of the TLS profile, an
   example of a BEEP security profile meeting the requirements of
   Section 5 of [<a href="#ref-5" title='"Intrusion Detection Message Exchange Requirements"'>5</a>].  See <a href="#section-5">Section 5</a> for a discussion of how IDXP
   fulfills the IDWG communications protocol requirements.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20The%20IDXP%20Profile"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  The IDXP Profile</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20IDXP%20Profile%20Overview"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  IDXP Profile Overview</span>

   The IDXP profile provides a mechanism for exchanging information
   between intrusion detection entities.  A BEEP tuning profile MAY be
   used to create an application-layer tunnel that transparently
   forwards data over a chain of proxies.  The TUNNEL profile [<a href="#ref-3" title='"The TUNNEL Profile"'>3</a>] SHOULD
   be used for this purpose; see [<a href="#ref-3" title='"The TUNNEL Profile"'>3</a>] for more detail concerning the
   options available to set up an application-layer tunnel using TUNNEL,
   and see <a href="#section-11.1">Section 11.1</a> for a discussion of TUNNEL-related security
   considerations.  TUNNEL MUST be offered as a tuning profile for the
   creation of application-layer tunnels.  The TUNNEL profile MUST offer
   the use of some form of SASL authentication (see Section 4.1 of [<a href="#ref-4" title='"The Blocks Extensible Exchange Protocol Core"'>4</a>]).
   The TLS profile SHOULD be used to provide the required combination of
   mutual-authentication, integrity, and confidentiality for the IDXP
   profile.  For further discussion of application-layer tunnel and
   security issues, see Sections <a href="#section-2.1">2.1</a> and <a href="#section-11">11</a>.





<span class="grey">Feinstein &amp; Matthews          Experimental                      [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


   The IDXP profile supports several elements of interest:

   o  The "IDXP-Greeting" element identifies an analyzer or manager at
      one end of a BEEP channel to the analyzer or manager at the other
      end of the channel.

   o  The "Option" element is used to convey optional channel parameters
      between peers during the exchange of "IDXP-Greeting" elements.
      This element is OPTIONAL.

   o  The "IDMEF-Message" element carries the structured information to
      be exchanged between the peers.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20IDXP%20Profile%20Identification%20and%20Initialization"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  IDXP Profile Identification and Initialization</span>

   The IDXP profile is identified as

      <a href="http://idxp.org/beep/profile">http://idxp.org/beep/profile</a>

   in the BEEP "profile" element during channel creation.

   During channel creation, "IDXP-Greeting" elements MUST be mutually
   exchanged between the peers.  An "IDXP-Greeting" element MAY be
   contained within the corresponding "profile" element in the BEEP
   "start" element.  Including an "IDXP-Greeting" element in the initial
   "start" element has exactly the same semantics as passing it as the
   first "MSG" message on the channel.  If channel creation is
   successful, then before sending the corresponding reply, the BEEP
   peer processes the "IDXP-Greeting" element and includes the resulting
   response in the reply.  This response will be an "ok" element or an
   "error" element.  The choice of which element is returned is
   dependent on local provisioning of the peer.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20IDXP%20Profile%20Message%20Syntax"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  IDXP Profile Message Syntax</span>

   BEEP messages in the profile MUST have a MIME Content-Type [<a href="#ref-8" title='"Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types"'>8</a>] of
   "text/xml", "text/plain", or "application/octet-stream".  The syntax
   of the individual elements is specified in <a href="#section-9.1">Section 9.1</a> of this
   document and Section 4 of [<a href="#ref-2" title='"The Intrusion Detection Message Exchange Format (IDMEF)"'>2</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20IDXP%20Profile%20Semantics"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  IDXP Profile Semantics</span>

   Each BEEP peer issues the "IDXP-Greeting" element using "MSG"
   messages.  The "IDXP-Greeting" element MAY contain one or more
   "Option" sub-elements, conveying optional channel parameters.  Each
   BEEP peer then issues "ok" in "RPY" messages or "error" in "ERR"
   messages.  (See Section 2.3.1 of [<a href="#ref-4" title='"The Blocks Extensible Exchange Protocol Core"'>4</a>] for the definitions of the
   "error" and "ok" elements.)  An "error" element MAY be issued within



<span class="grey">Feinstein &amp; Matthews          Experimental                      [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


   a "RPY" message when piggy-backed within a BEEP "profile" element.
   See <a href="#section-3.4.1">Section 3.4.1</a> for an example of an "error" element being issued
   within a "RPY" message.  Based on the respective client/server roles
   negotiated during the exchange of "IDXP-Greeting" elements, the
   client sends data using "MSG" messages.  Depending on the MIME
   Content-Type, this data may be an "IDMEF-Message" element, plain
   text, or binary.  The server then issues "ok" in "RPY" messages or
   "error" in "ERR" messages.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.1.%20%20The%20IDXP-Greeting%20Element"></a><a class="selflink" href="#section-3.4.1" name="section-3.4.1">3.4.1</a>.  The IDXP-Greeting Element</span>

   The "IDXP-Greeting" element serves to identify the analyzer or
   manager at one end of the BEEP channel to the analyzer or manager at
   the other end of the channel.  The "IDXP-Greeting" element MUST
   include the role of the peer on the channel (client or server) and
   the Uniform Resource Identifier (URI) [<a href="#ref-6" title='"Uniform Resource Identifier (URI): Generic Syntax"'>6</a>] of the peer.  In addition,
   the "IDXP-Greeting" element MAY include the fully qualified domain
   name (see [<a href="#ref-9" title='"Domain names - concepts and facilities"'>9</a>]) of the peer.  One or more "Option" sub-elements MAY be
   present.

   An "IDXP-Greeting" element MAY be sent by either peer at any time.
   The peer receiving the "IDXP-Greeting" MUST respond with an "ok"
   (indicating acceptance), or an "error" (indicating rejection).  A
   peer's identity and role on a channel and any optional channel
   parameters are, in effect, specified by the most recent "IDXP-
   Greeting" it sent that was answered with an "ok".

   An "IDXP-Greeting" may be rejected (with an "error" element) under
   many circumstances.  These include, but are not limited to,
   authentication failure, lack of authorization to connect under the
   specified role, the negotiation of an inadequate cipher suite, or the
   presence of a channel option that must be understood but was
   unrecognized.

   For example, a successful creation with an embedded "IDXP-Greeting"
   might look like this:

   I: MSG 0 10 . 1592 187
   I: Content-Type: text/xml
   I:
   I: &lt;start number='1'&gt;
   I:   &lt;profile uri='http://idxp.org/beep/profile'&gt;
   I:     &lt;![CDATA[ &lt;IDXP-Greeting uri='http://example.com/alice'
   I:       role='client' /&gt; ]]&gt;
   I:   &lt;/profile&gt;
   I: &lt;/start&gt;
   I: END
   L: RPY 0 10 . 1865 91



<span class="grey">Feinstein &amp; Matthews          Experimental                     [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


   L: Content-Type: text/xml
   L:
   L: &lt;profile uri='http://idxp.org/beep/profile'&gt;
   L:   &lt;![CDATA[ &lt;ok /&gt; ]]&gt;
   L: &lt;/profile&gt;
   L: END
   L: MSG 0 11 . 1956 61
   L: Content-Type: text/xml
   L:
   L: &lt;IDXP-Greeting uri='http://example.com/bob' role='server' /&gt;
   L: END
   I: RPY 0 11 . 1779 7
   I: Content-Type: text/xml
   I:
   I: &lt;ok /&gt;
   I: END

   A creation with an embedded "IDXP-Greeting" that fails might look
   like this:

   I: MSG 0 10 . 1776 185
   I: Content-Type: text/xml
   I:
   I: &lt;start number='1'&gt;
   I:   &lt;profile uri='http://idxp.org/beep/profile'&gt;
   I:     &lt;![CDATA[ &lt;IDXP-Greeting uri='http://example.com/eve'
   I:       role='client' /&gt; ]]&gt;
   I:   &lt;/profile&gt;
   I: &lt;/start&gt;
   I: END
   L: RPY 0 10 . 1592 182
   L: Content-Type: text/xml
   L:
   L: &lt;profile uri='http://idxp.org/beep/profile'&gt;
   L:   &lt;![CDATA[
   L:     &lt;error code='530'&gt;'http://example.com/eve' must first
   L:       negotiate the TLS profile&lt;/error&gt; ]]&gt;
   L: &lt;/profile&gt;
   L: END

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.2.%20%20The%20Option%20Element"></a><a class="selflink" href="#section-3.4.2" name="section-3.4.2">3.4.2</a>.  The Option Element</span>

   If present, the "Option" element MUST be contained within an "IDXP-
   Greeting" element.  An individual "IDXP-Greeting" element MAY contain
   one or more "Option" sub-elements.  Each "Option" element within an
   "IDXP-Greeting" element represents a request to enable an IDXP option
   on the channel being negotiated.  See <a href="#section-4">Section 4</a> for a complete
   description of IDXP options and the "Option" element.



<span class="grey">Feinstein &amp; Matthews          Experimental                     [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.3.%20%20The%20IDMEF-Message%20Element"></a><a class="selflink" href="#section-3.4.3" name="section-3.4.3">3.4.3</a>.  The IDMEF-Message Element</span>

   The "IDMEF-Message" element carries the information to be exchanged
   between the peers.  See Section 4 of [<a href="#ref-2" title='"The Intrusion Detection Message Exchange Format (IDMEF)"'>2</a>] for the definition of this
   element.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20IDXP%20Options"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  IDXP Options</span>

   IDXP provides a service for the reliable exchange of data between
   intrusion detection entities.  Options are used to alter the
   semantics of the service.

   The specification of an IDXP option MUST define

   o  the identity of the option;

   o  what content, if any, is contained within the option; and

   o  the processing rules for the option.

   An option registration template (see <a href="#section-7">Section 7</a>) organizes this
   information.

   An "Option" element is contained within an "IDXP-Greeting" element.
   The "IDXP-Greeting" element itself MAY contain one or more "Option"
   elements.  The "Option" element has several attributes and contains
   arbitrary content:

   o  the "internal" and the "external" attributes, exactly one of which
      MUST be present, uniquely identify the option;

   o  the "mustUnderstand" attribute, whose presence is OPTIONAL and
      whose default value is "false", specifies whether the option, if
      unrecognized, MUST cause an error in processing to occur; and

   o  the "localize" attribute, whose presence is OPTIONAL, specifies
      one or more language tokens, each identifying a desirable language
      tag to be used if textual diagnostics are returned to the
      originator.

   The value of the "internal" attribute is the IANA-registered name for
   the option.  If the "internal" attribute is not present, then the
   value of the "external" attribute is a URI or URI with a fragment-
   identifier.  Note that a relative-URI value is not allowed.

   The "mustUnderstand" attribute specifies whether the peer may ignore
   the option if it is unrecognized.  If the value of the
   "mustUnderstand" attribute is "true", and if the peer does not



<span class="grey">Feinstein &amp; Matthews          Experimental                     [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


   recognize the option, then an error in processing has occurred.  When
   absent, the value of the "mustUnderstand" attribute is defined to be
   "false".

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20The%20channelPriority%20Option"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  The channelPriority Option</span>

   <a href="#section-8.3">Section 8.3</a> contains the IDXP option registration for the
   "channelPriority" option.  This option contains a "channelPriority"
   element (see <a href="#section-9.2">Section 9.2</a>).

   By default, IDXP does not place any requirements on how peers should
   manage multiple IDXP channels.  The "channelPriority" option provides
   a way for peers using multiple IDXP channels to request relative
   priorities for each channel.  When sending an "IDXP-Greeting" element
   during the provisioning of an IDXP channel, the originating peer MAY
   request that the remote peer assign a priority to the channel by
   including an "Option" element containing a "channelPriority" element.

   The "channelPriority" element has one attribute named "priority", of
   range 0..2147483647.  This attribute is REQUIRED.  Not
   coincidentally, this is the maximum range of possible BEEP channel
   numbers.  0 is defined to represent the highest priority, with
   relative priority decreasing as the "priority" value ascends.

   For example, during the exchange of "IDXP-Greeting" elements during
   channel provisioning, an analyzer successfully requests that a
   manager assign a priority to the channel:

   analyzer                                           manager
      --------------- greeting w/ option -----------------&gt;
      &lt;---------------------- &lt;ok&gt; ------------------------

   C: MSG 1 17 . 1984 165
   C: Content-Type: text/xml
   C:
   C: &lt;IDXP-Greeting uri='http://example.com/alice' role='client'&gt;
   C:   &lt;Option internal='channelPriority'&gt;
   C:     &lt;channelPriority priority='0' /&gt;
   C:   &lt;/Option&gt;
   C: &lt;/IDXP-Greeting&gt;
   C: END
   S: RPY 1 17 . 2001 7
   S: Content-Type: text/xml
   S:
   S: &lt;ok /&gt;
   S: END





<span class="grey">Feinstein &amp; Matthews          Experimental                     [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


   For example, during the exchange of "IDXP-Greeting" elements during
   channel provisioning, a manager unsuccessfully requests that an
   analyzer assign a priority to the channel:

     analyzer                                           manager
       &lt;---------------- greeting w/ option ----------------
        --------------------- &lt;error&gt; ----------------------&gt;

  S: MSG 1 17 . 1312 194
  S: Content-Type: text/xml
  S:
  S: &lt;IDXP-Greeting uri='http://example.com/bob' role='server'&gt;
  S:   &lt;Option internal='channelPriority' mustUnderstand='true'&gt;
  S:     &lt;channelPriority priority='2147483647' /&gt;
  S:   &lt;/Option&gt;
  S: &lt;/IDXP-Greeting&gt;
  S: END
  C: ERR 1 17 . 451 68
  C: Content-Type: text/xml
  C:
  C: &lt;error code='504'&gt;'channelPriority' option was unrecognized&lt;/error&gt;
  C: END

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20The%20streamType%20Option"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  The streamType Option</span>

   <a href="#section-8.4">Section 8.4</a> contains the IDXP option registration for the
   "streamType" option.  This option contains a "streamType" element
   (see <a href="#section-9.3">Section 9.3</a>).

   By default, IDXP provides no explicit method for categorizing
   channels.  The "streamType" option provides a way for peers to
   request that a channel be categorized as a particular stream type.
   When sending an "IDXP-Greeting" element during the provisioning of an
   IDXP channel, the originating peer MAY request that the remote peer
   assign a stream type to the channel by including an "Option" element
   containing a "streamType" element.

   The "streamType" element has one attribute named "type", with the
   possible values of "alert", "heartbeat", or "config".  This attribute
   is REQUIRED.  A value of "alert" indicates that the channel should be
   categorized as being used for the exchange of ID alerts.  A value of
   "heartbeat" indicates that the channel should be categorized as being
   used for the exchange of heartbeat messages such as the "Heartbeat"
   element (see Section 4 of [<a href="#ref-2" title='"The Intrusion Detection Message Exchange Format (IDMEF)"'>2</a>]).  A value of "config" indicates that
   the channel should be categorized as being used for the exchange of
   configuration messages.





<span class="grey">Feinstein &amp; Matthews          Experimental                     [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


   For example, during the exchange of "IDXP-Greeting" elements during
   channel provisioning, an analyzer successfully requests that a
   manager assign a stream type to the channel:

   analyzer                                           manager
      --------------- greeting w/ option -----------------&gt;
     &lt;---------------------- &lt;ok&gt; ------------------------

   C: MSG 1 21 . 1963 155
   C: Content-Type: text/xml
   C:
   C: &lt;IDXP-Greeting uri='http://example.com/alice' role='client'&gt;
   C:   &lt;Option internal='streamType'&gt;
   C:     &lt;streamType type='alert' /&gt;
   C:   &lt;/Option&gt;
   C: &lt;/IDXP-Greeting&gt;
   C: END
   S: RPY 1 21 . 1117 7
   S: Content-Type: text/xml
   S:
   S: &lt;ok /&gt;
   S: END

   For example, during the exchange of "IDXP-Greeting" elements during
   channel provisioning, a manager unsuccessfully requests that an
   analyzer assign a stream type to the channel:

   analyzer                                           manager
     &lt;---------------- greeting w/ option ----------------
      --------------------- &lt;error&gt; ----------------------&gt;

   S: MSG 1 21 . 1969 176
   S: Content-Type: text/xml
   S:
   S: &lt;IDXP-Greeting uri='http://example.com/bob' role='server'&gt;
   S:   &lt;Option internal='streamType' mustUnderstand='true'&gt;
   S:     &lt;streamType type='config' /&gt;
   S:   &lt;/Option&gt;
   S: &lt;/IDXP-Greeting&gt;
   S: END
   C: ERR 1 21 . 1292 63
   C: Content-Type: text/xml
   C:
   C: &lt;error code='504'&gt;'streamType' option was unrecognized&lt;/error&gt;
   C: END






<span class="grey">Feinstein &amp; Matthews          Experimental                     [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Fulfillment%20of%20IDWG%20Communications%20Protocol%20Requirements"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Fulfillment of IDWG Communications Protocol Requirements</span>

   The following lists each of the communications protocol requirements
   established in Section 5 of [<a href="#ref-5" title='"Intrusion Detection Message Exchange Requirements"'>5</a>] and, for each requirement, describes
   the manner in which it is fulfilled.  IDXP itself does not fulfill
   each of the communications protocol requirements, but instead relies
   on the underlying BEEP protocol and a variety of BEEP profiles.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Reliable%20Message%20Transmission"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Reliable Message Transmission</span>

   "The [protocol] MUST support reliable transmission of messages."  See
   Section 5.1 of [<a href="#ref-5" title='"Intrusion Detection Message Exchange Requirements"'>5</a>].

      IDXP operates over BEEP, which operates only over reliable
      connection-oriented transport protocols (e.g., TCP).  In addition,
      BEEP peers communicate using a simple request-response protocol,
      which provides end-to-end reliability between peers.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Interaction%20with%20Firewalls"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Interaction with Firewalls</span>

   "The [protocol] MUST support transmission of messages between ID
   components across firewall boundaries without compromising security."
   See Section 5.2 of [<a href="#ref-5" title='"Intrusion Detection Message Exchange Requirements"'>5</a>].

      The TUNNEL profile [<a href="#ref-3" title='"The TUNNEL Profile"'>3</a>] MUST be offered as an option for creation
      of application-layer tunnels to allow operation across firewalls.
      The TUNNEL profile SHOULD be used to provide an application-layer
      tunnel.  The ability to authenticate hosts during the creation of
      an application-layer tunnel MUST be provided by the mechanism
      chosen to create such tunnels.  A firewall may therefore be
      configured to authenticate all hosts attempting to tunnel into the
      protected network.  If the TUNNEL profile is used, SASL (see
      Section 4.1 of [<a href="#ref-4" title='"The Blocks Extensible Exchange Protocol Core"'>4</a>]) MUST be offered as a mechanism by which hosts
      can be authenticated.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Mutual%20Authentication"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Mutual Authentication</span>

   "The [protocol] MUST support mutual authentication of the analyzer
   and the manager to each other."  See Section 5.3 of [<a href="#ref-5" title='"Intrusion Detection Message Exchange Requirements"'>5</a>].

      IDXP supports mutual authentication of the peers through the use
      of an appropriate underlying BEEP security profile.  The TLS
      profile and members of the SASL family of profiles (see <a href="#section-4.1">Section</a>
      <a href="#section-4.1">4.1</a> of [<a href="#ref-4" title='"The Blocks Extensible Exchange Protocol Core"'>4</a>]) are examples of security profiles that may be used to
      authenticate the identity of communicating ID components.  TLS
      MUST be offered as a mechanism to provide mutual authentication,
      and TLS SHOULD be used to provide mutual authentication.




<span class="grey">Feinstein &amp; Matthews          Experimental                     [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20Message%20Confidentiality"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  Message Confidentiality</span>

   "The [protocol] MUST support confidentiality of the message content
   during message exchange.  The selected design MUST be capable of
   supporting a variety of encryption algorithms and MUST be adaptable
   to a wide variety of environments."  See Section 5.4 of [<a href="#ref-5" title='"Intrusion Detection Message Exchange Requirements"'>5</a>].

      IDXP supports confidentiality through the use of an appropriate
      underlying BEEP security profile.  The TLS profile is an example
      of a security profile that offers confidentiality.  The TLS
      profile with the TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA cipher suite
      MUST be offered as a mechanism to provide confidentiality, and TLS
      with this cipher suite SHOULD be used to provide confidentiality.
      The TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA cipher suite uses ephemeral
      Diffie-Hellman (DHE) with DSS signatures for key exchange and
      triple DES (Data Encryption Standard) (3DES) and cipher-block
      chaining (CBC) for encryption.  Stronger cipher suites are
      optional.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.5.%20%20Message%20Integrity"></a><a class="selflink" href="#section-5.5" name="section-5.5">5.5</a>.  Message Integrity</span>

   "The [protocol] MUST ensure the integrity of the message content.
   The selected design MUST be capable of supporting a variety of
   integrity mechanisms and MUST be adaptable to a wide variety of
   environments."  See Section 5.5 of [<a href="#ref-5" title='"Intrusion Detection Message Exchange Requirements"'>5</a>].

      IDXP supports message integrity through the use of an appropriate
      underlying BEEP security profile.  The TLS profile and members of
      the SASL family of profiles (see Section 4.1 of [<a href="#ref-4" title='"The Blocks Extensible Exchange Protocol Core"'>4</a>]) are examples
      of security profiles that offer message integrity.  The TLS
      profile with the TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA cipher suite
      MUST be offered as a mechanism to provide integrity, and TLS with
      this cipher suite SHOULD be used to provide integrity.  The
      TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA cipher suite uses the Secure
      Hash Algorithm (SHA) for integrity protection using a keyed
      message authentication code.  Stronger cipher suites are optional.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.6.%20%20Per-Source%20Authentication"></a><a class="selflink" href="#section-5.6" name="section-5.6">5.6</a>.  Per-Source Authentication</span>

   "The [protocol] MUST support separate authentication keys for each
   sender."  See Section 5.6 of [<a href="#ref-5" title='"Intrusion Detection Message Exchange Requirements"'>5</a>].

      IDXP supports separate authentication keys for each sender (i.e.,
      per-source authentication) through the use of an appropriate
      underlying BEEP security profile.  The TLS profile is an example
      of a security profile that supports per-source authentication
      through the mutual authentication of public-key certificates.  TLS
      MUST be offered as a mechanism to provide per-source



<span class="grey">Feinstein &amp; Matthews          Experimental                     [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


      authentication, and TLS SHOULD be used to provide per-source
      authentication.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.7.%20%20Denial%20of%20Service"></a><a class="selflink" href="#section-5.7" name="section-5.7">5.7</a>.  Denial of Service</span>

   "The [protocol] SHOULD resist protocol denial-of-service attacks."
   See Section 5.7 of [<a href="#ref-5" title='"Intrusion Detection Message Exchange Requirements"'>5</a>].

      IDXP supports resistance to denial of service (DoS) attacks
      through the use of an appropriate underlying BEEP security
      profile.  BEEP peers offering the IDXP profile MUST offer the use
      of TLS with the TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA cipher suite,
      and SHOULD use TLS with that cipher suite.  To resist DoS attacks
      it is helpful to discard traffic arising from a non-authenticated
      source.  BEEP peers MUST support the use of authentication in
      conjunction with any mechanism used to create application-layer
      tunnels.  In particular, the use of some form of SASL
      authentication (see Section 4.1 of [<a href="#ref-4" title='"The Blocks Extensible Exchange Protocol Core"'>4</a>]) MUST be offered to provide
      authentication in the use of the TUNNEL profile.  See Section 7 of
      [<a href="#ref-3" title='"The TUNNEL Profile"'>3</a>] for a discussion of security considerations in the use of the
      TUNNEL profile.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.8.%20%20Message%20Duplication"></a><a class="selflink" href="#section-5.8" name="section-5.8">5.8</a>.  Message Duplication</span>

   "The [protocol] SHOULD resist malicious duplication of messages."
   See Section 5.8 of [<a href="#ref-5" title='"Intrusion Detection Message Exchange Requirements"'>5</a>].

      IDXP supports resistance to malicious duplication of messages
      (i.e., replay attacks) through the use of an appropriate
      underlying BEEP security profile.  The TLS profile is an example
      of a security profile offering resistance to replay attacks.  The
      TLS profile with the TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA cipher
      suite MUST be offered as a mechanism to provide resistance against
      replay attacks, and TLS with this cipher suite SHOULD be used to
      provide resistance against replay attacks.  The
      TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA cipher suite uses cipher-block
      chaining (CBC) to ensure that even if a message is duplicated the
      cipher-text duplicate will produce a very different plain-text
      result.  Stronger cipher suites are optional.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Extending%20IDXP"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Extending IDXP</span>

   The specification of IDXP options (see <a href="#section-4">Section 4</a>) is the preferred
   method of extending IDXP.  In order to extend IDXP, an IDXP option
   SHOULD be documented in an RFC and MUST be registered with the IANA
   (see <a href="#section-7">Section 7</a>).  IDXP extensions that cannot be expressed as IDXP
   options MUST be documented in an RFC.




<span class="grey">Feinstein &amp; Matthews          Experimental                     [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20IDXP%20Option%20Registration%20Template"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  IDXP Option Registration Template</span>

   When an IDXP option is registered, the following information is
   supplied:

   Option Identification: specify the NMTOKEN or the URI that
   authoritatively identifies this option.

   Contains: specify the XML content that is contained within the
   "Option" element.

   Processing Rules: specify the processing rules associated with the
   option.

   Contact Information: specify the postal and electronic contact
   information for the author(s) of the option.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Initial%20Registrations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Initial Registrations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Registration%3A%20The%20IDXP%20Profile"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Registration: The IDXP Profile</span>

   Profile identification: <a href="http://idxp.org/beep/profile">http://idxp.org/beep/profile</a>

   Messages exchanged during channel creation: "IDXP-Greeting"

   Messages starting one-to-one exchanges: "IDXP-Greeting", "IDMEF-
   Message"

   Messages in positive replies: "ok"

   Messages in negative replies: "error"

   Messages in one-to-many exchanges: none

   Message syntax: see <a href="#section-3.3">Section 3.3</a>

   Message semantics: see <a href="#section-3.4">Section 3.4</a>

   Contact information: see the "Authors' Addresses" section of this
   memo

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Registration%3A%20The%20System%20%28Well-Known%29%20TCP%20Port%20Number%20for%20IDXP"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Registration: The System (Well-Known) TCP Port Number for IDXP</span>

   Protocol Number: 603

   Message Formats, Types, Opcodes, and Sequences: see <a href="#section-3.3">Section 3.3</a>

   Functions: see <a href="#section-3.4">Section 3.4</a>



<span class="grey">Feinstein &amp; Matthews          Experimental                     [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


   Use of Broadcast/Multicast: none

   Proposed Name: Intrusion Detection Exchange Protocol

   Short name: idxp

   Contact Information: see the "Authors' Addresses" section of this
   memo

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.3.%20%20Registration%3A%20The%20channelPriority%20Option"></a><a class="selflink" href="#section-8.3" name="section-8.3">8.3</a>.  Registration: The channelPriority Option</span>

   Option Identification: channelPriority

   Contains: channelPriority (see <a href="#section-9.2">Section 9.2</a>)

   Processing Rules: see <a href="#section-4.1">Section 4.1</a>

   Contact Information: see the "Authors' Addresses" section of this
   memo

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.4.%20%20Registration%3A%20The%20streamType%20Option"></a><a class="selflink" href="#section-8.4" name="section-8.4">8.4</a>.  Registration: The streamType Option</span>

   Option Identification: streamType

   Contains: streamType (see <a href="#section-9.3">Section 9.3</a>)

   Processing Rules: see <a href="#section-4.2">Section 4.2</a>

   Contact Information: see the "Authors' Addresses" section of this
   memo

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20The%20DTDs"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  The DTDs</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20The%20IDXP%20DTD"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  The IDXP DTD</span>

   The following is the DTD defining the valid elements for the IDXP
   profile.

     &lt;!--
     DTD for the IDXP Profile

     Refer to this DTD as:

       &lt;!ENTITY % IDXP PUBLIC "-//IETF//DTD <a href="rfc4767.html">RFC 4767</a> IDXP v1.0//EN"&gt;

       %IDXP;
     --&gt;




<span class="grey">Feinstein &amp; Matthews          Experimental                     [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


     &lt;!-- Includes --&gt;

       &lt;!ENTITY % BEEP PUBLIC "-//IETF//DTD BEEP//EN"&gt;

       %BEEP;


       &lt;!ENTITY % IDMEF-Message PUBLIC
                                 "-//IETF//DTD <a href="rfc4765.html">RFC 4765</a> IDMEF v1.0//EN"&gt;

       %IDMEF;

     &lt;!--
       Profile Summary

         BEEP profile <a href="http://idxp.org/beep/profile">http://idxp.org/beep/profile</a>

         role       MSG               RPY      ERR
         ====       ===               ===      ===
         I or L     IDXP-Greeting     ok       error
         C          IDMEF-Message     ok       error
     --&gt;

     &lt;!--
       Entity Definitions

             entity        syntax/reference     example
             ======        ================     =======
         an authoritative identification
             URI           see <a href="rfc3986.html">RFC 3986</a> [<a href="#ref-6" title='"Uniform Resource Identifier (URI): Generic Syntax"'>6</a>]     http://example.com

         a fully qualified domain name
             FQDN          see <a href="rfc1034.html">RFC 1034</a> [<a href="#ref-9" title='"Domain names - concepts and facilities"'>9</a>]     www.example.com
     --&gt;

     &lt;!ENTITY % URI      "CDATA"&gt;
     &lt;!ENTITY % FQDN     "CDATA"&gt;

     &lt;!--
       The IDXP-Greeting element declares the role and identity of
       the peer issuing it, on a per-channel basis. The
       IDXP-Greeting element may contain one or more Option
       sub-elements.
     --&gt;







<span class="grey">Feinstein &amp; Matthews          Experimental                     [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


   &lt;!ELEMENT IDXP-Greeting  (Option*)&gt;
   &lt;!ATTLIST IDXP-Greeting
             uri            %URI;                #REQUIRED
             role           (client|server)      #REQUIRED
             fqdn           %FQDN;               #IMPLIED&gt;

     &lt;!--
       The Option element conveys an IDXP channel option.
       Note that the %LOCS entity is imported from the BEEP Channel
       Management DTD.
     --&gt;

   &lt;!ELEMENT Option (ANY)&gt;
   &lt;!ATTLIST Option
             internal       NMTOKEN              ""
             external       %URI;                ""
             mustUnderstand (true|false)         "false"
             localize       %LOCS;               "i-default"&gt;

     &lt;!--
       The IDMEF-Message element conveys the intrusion detection
       information that is exchanged.  This element is defined in the
       idmef-message.dtd
     --&gt;

   &lt;!-- End of DTD --&gt;

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20The%20channelPriority%20Option%20DTD"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  The channelPriority Option DTD</span>

   The following is the DTD defining the valid elements for the
   channelPriority option.

     &lt;!--
     DTD for the channelPriority IDXP option, as of 2002-01-08

     Refer to this DTD as:

       &lt;!ENTITY % IDXP-channelPriority PUBLIC
         "-//IETF//DTD <a href="rfc4767.html">RFC 4767</a> IDXP-channelPriority v1.0//EN"&gt;

       %IDXP-channelPriority;
     --&gt;

     &lt;!--
       Entity Definitions

             entity        syntax/reference     example
             ======        ================     =======



<span class="grey">Feinstein &amp; Matthews          Experimental                     [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


       a priority number
             PRIORITY      0..2147483647        1
     --&gt;

   &lt;!ENTITY % PRIORITY          "CDATA"&gt;

   &lt;!ELEMENT channelPriority    EMPTY&gt;
   &lt;!ATTLIST channelPriority
             priority           %PRIORITY    #REQUIRED&gt;

   &lt;!-- End of DTD --&gt;

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.3.%20%20The%20streamType%20DTD"></a><a class="selflink" href="#section-9.3" name="section-9.3">9.3</a>.  The streamType DTD</span>

   The following is the DTD defining the valid elements for the
   streamType option.

     &lt;!--
     DTD for the streamType IDXP option, as of 2002-01-08

     Refer to this DTD as:

       &lt;!ENTITY % IDXP-streamType PUBLIC
         "-//IETF//DTD <a href="rfc4767.html">RFC 4767</a> IDXP-streamType v1.0//EN"&gt;

       %IDXP-streamType;
     --&gt;

     &lt;!--
       Entity Definitions

             entity        syntax/reference                example
             ======        ================                =======
        a stream type
             STYPE         (alert | heartbeat | config)    "alert"
     --&gt;

   &lt;!ENTITY % STYPE        (alert|heartbeat|config)&gt;

   &lt;!ELEMENT streamType    EMPTY&gt;
   &lt;!ATTLIST streamType
             type          %STYPE    #REQUIRED&gt;

   &lt;!-- End of DTD --&gt;







<span class="grey">Feinstein &amp; Matthews          Experimental                     [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Reply%20Codes"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Reply Codes</span>

   This section lists the three-digit error codes the IDXP profile may
   generate.

   code    meaning
   ====    =======
   421     Service not available
           (e.g., the peer does not have sufficient resources)

   450     Requested action not taken
           (e.g., DNS lookup failed or connection could not
            be established.  See also 550.)

   454     Temporary authentication failure

   500     General syntax error
           (e.g., poorly-formed XML)

   501     Syntax error in parameters
           (e.g., non-valid XML)

   504     Parameter not implemented

   530     Authentication required

   534     Authentication mechanism insufficient
           (e.g., cipher suite too weak, sequence exhausted)

   535     Authentication failure

   537     Action not authorized for user

   550     Requested action not taken
           (e.g., peer could be contacted, but
            malformed greeting or no IDXP profile advertised)

   553     Parameter invalid

   554     Transaction failed
           (e.g., policy violation)










<span class="grey">Feinstein &amp; Matthews          Experimental                     [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20Security%20Considerations"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  Security Considerations</span>

   The IDXP profile is a profile of BEEP.  In BEEP, transport security,
   user authentication, and data exchange are orthogonal.  Refer to
   Section 9 of [<a href="#ref-4" title='"The Blocks Extensible Exchange Protocol Core"'>4</a>] for a discussion of this.  It is strongly
   recommended that those wanting to use the IDXP profile initially
   negotiate a BEEP security profile between the peers that offers the
   required security properties.  The TLS profile SHOULD be used to
   provide for transport security.  See <a href="#section-5">Section 5</a> for a discussion of
   how IDXP fulfills the IDWG communications protocol requirements.

   See <a href="#section-2.4">Section 2.4</a> for a discussion of the trust model.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.1.%20%20Use%20of%20the%20TUNNEL%20Profile"></a><a class="selflink" href="#section-11.1" name="section-11.1">11.1</a>.  Use of the TUNNEL Profile</span>

   See <a href="#section-5">Section 5</a> for IDXP's requirements on application-layer tunneling
   and the TUNNEL profile specifically.  See Section 7 of [<a href="#ref-3" title='"The TUNNEL Profile"'>3</a>] for a
   discussion of the security considerations inherent in the use of the
   TUNNEL profile.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.2.%20%20Use%20of%20Underlying%20Security%20Profiles"></a><a class="selflink" href="#section-11.2" name="section-11.2">11.2</a>.  Use of Underlying Security Profiles</span>

   At present, the TLS profile is the only BEEP security profile known
   to meet all of the requirements set forth in Section 5 of [<a href="#ref-5" title='"Intrusion Detection Message Exchange Requirements"'>5</a>].  When
   securing a BEEP session with the TLS profile, the
   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA cipher suite offers an acceptable
   level of security.  See <a href="#section-5">Section 5</a> for a discussion of how IDXP
   fulfills the IDWG communications requirements through the use of an
   underlying security profile.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/12.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-12" name="section-12">12</a>.  IANA Considerations</span>

   The IANA registered "idxp" as a TCP port number as specified in
   <a href="#section-8.2">Section 8.2</a>.

   The IANA maintains a list of:

      IDXP options, see <a href="#section-7">Section 7</a>.

   For this list, the IESG is responsible for assigning a designated
   expert to review the specification prior to the IANA making the
   assignment.  As a courtesy to developers of non-standards track IDXP
   options, the mailing list idxp-discuss@lists.idxp.org may be used to
   solicit commentary.

   IANA made the registrations specified in Sections <a href="#section-8.3">8.3</a> and <a href="#section-8.4">8.4</a>.





<span class="grey">Feinstein &amp; Matthews          Experimental                     [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/13.%20%20References"></a><a class="selflink" href="#section-13" name="section-13">13</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/13.1.%20%20Normative%20References"></a><a class="selflink" href="#section-13.1" name="section-13.1">13.1</a>.  Normative References</span>

   [<a id="ref-1" name="ref-1">1</a>]  Bradner, S., "Key words for use in RFCs to Indicate Requirement
        Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-2" name="ref-2">2</a>]  Debar, H., Curry, D., and B. Feinstein, "The Intrusion Detection
        Message Exchange Format (IDMEF)", <a href="rfc4765.html">RFC 4765</a>, March 2007.

   [<a id="ref-3" name="ref-3">3</a>]  New, D., "The TUNNEL Profile", <a href="rfc3620.html">RFC 3620</a>, October 2003.

   [<a id="ref-4" name="ref-4">4</a>]  Rose, M., "The Blocks Extensible Exchange Protocol Core", <a href="rfc3080.html">RFC</a>
        <a href="rfc3080.html">3080</a>, March 2001.

   [<a id="ref-5" name="ref-5">5</a>]  Wood, M. and M. Erlinger, "Intrusion Detection Message Exchange
        Requirements", <a href="rfc4766.html">RFC 4766</a>, March 2007.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/13.2.%20%20Informative%20References"></a><a class="selflink" href="#section-13.2" name="section-13.2">13.2</a>.  Informative References</span>

   [<a id="ref-6" name="ref-6">6</a>]  Berners-Lee, T., Fielding, R., and L. Masinter, "Uniform
        Resource Identifier (URI): Generic Syntax", STD 66, <a href="rfc3986.html">RFC 3986</a>,
        January 2005.

   [<a id="ref-7" name="ref-7">7</a>]  Bray, T., Paoli, J., Sperberg-McQueen, C. and E. Maler,
        "Extensible Markup Language (XML) 1.0 (2nd ed)", W3C REC-xml,
        October 2000, &lt;<a href="http://www.w3.org/TR/REC-xml">http://www.w3.org/TR/REC-xml</a>&gt;.

   [<a id="ref-8" name="ref-8">8</a>]  Freed, N. and N. Borenstein, "Multipurpose Internet Mail
        Extensions (MIME) Part Two: Media Types", <a href="rfc2046.html">RFC 2046</a>, November
        1996.

   [<a id="ref-9" name="ref-9">9</a>]  Mockapetris, P., "Domain names - concepts and facilities", STD
        13, <a href="rfc1034.html">RFC 1034</a>, November 1987.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/14.%20%20Acknowledgements"></a><a class="selflink" href="#section-14" name="section-14">14</a>.  Acknowledgements</span>

   The authors gratefully acknowledge the contributions of Darren New,
   Marshall T. Rose, Roy Pollock, Tim Buchheim, Mike Erlinger, John C.
   C. White, and Paul Osterwald.











<span class="grey">Feinstein &amp; Matthews          Experimental                     [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


Authors' Addresses

   Benjamin S. Feinstein
   SecureWorks, Inc.
   PO Box 95007
   Atlanta, GA 30347
   US

   Phone: +1 404 327-6339
   Email: bfeinstein@acm.org
   URI:   <a href="http://www.secureworks.com/">http://www.secureworks.com/</a>


   Gregory A. Matthews
   CSC/NASA Ames Research Center

   EMail: gmatthew@nas.nasa.gov
   URI:   <a href="http://www.nas.nasa.gov/">http://www.nas.nasa.gov/</a>

































<span class="grey">Feinstein &amp; Matthews          Experimental                     [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc4767.html">RFC 4767</a>                          IDXP                        March 2007</span>


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.







Feinstein &amp; Matthews          Experimental                     [Page 28]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc4767 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:39 GMT --></html>