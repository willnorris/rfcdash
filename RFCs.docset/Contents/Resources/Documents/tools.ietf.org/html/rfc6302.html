<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6302 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 28 Apr 2015 16:01:09 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.111" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:6302" name="DC.Identifier"/>
<meta content="In the wake of IPv4 exhaustion and deployment of IP address sharing
techniques, this document recommends that Internet-facing servers log
port number and accurate timestamps in addition to the incoming IP
address. This memo documents an Internet Best Current Practice." name="DC.Description.Abstract"/>
<meta content="Sheppard, Scott" name="DC.Creator"/>
<meta content="Durand, Alain" name="DC.Creator"/>
<meta content="Lee, Donn" name="DC.Creator"/>
<meta content="Gashinsky, Igor" name="DC.Creator"/>
<meta content="June, 2011" name="DC.Date.Issued"/>
<meta content="Logging Recommendations for Internet-Facing Servers" name="DC.Title"/>

    <link href="http://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="http://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6302 - Logging Recommendations for Internet-Facing Servers</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgmagenta" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc6302.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc6302" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-ietf-intarea-server-logging-recommendations" title="draft-ietf-intarea-server-logging-recommendations">draft-ietf-intare...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6302" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc6302" title="Side-by-side diff">Diff2</a>]                 </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                   BEST CURRENT PRACTICE</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                         A. Durand
Request for Comments: 6302                              Juniper Networks
BCP: 162                                                    I. Gashinsky
Category: Best Current Practice                              Yahoo! Inc.
ISSN: 2070-1721                                                   D. Lee
                                                          Facebook, Inc.
                                                             S. Sheppard
                                                                ATT Labs
                                                               June 2011


          <span class="h1">Logging Recommendations for Internet-Facing Servers</span>

Abstract

   In the wake of IPv4 exhaustion and deployment of IP address sharing
   techniques, this document recommends that Internet-facing servers log
   port number and accurate timestamps in addition to the incoming IP
   address.

Status of This Memo

   This memo documents an Internet Best Current Practice.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   BCPs is available in <a href="rfc5741.html#section-2">SectionÂ 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6302">http://www.rfc-editor.org/info/rfc6302</a>.

Copyright Notice

   Copyright (c) 2011 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in <a href="#section-4">Section 4</a>.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



<span class="grey">Durand, et al.            Best Current Practice                 [Page 1]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6302.html">RFC 6302</a>             Internet-Facing Server Logging            June 2011</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-2">2</a>
   <a href="#section-2">2</a>.  Recommendations . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  ISP Considerations  . . . . . . . . . . . . . . . . . . . . . . <a href="#page-4">4</a>
   <a href="#section-4">4</a>.  Security Considerations . . . . . . . . . . . . . . . . . . . . <a href="#page-4">4</a>
   <a href="#section-5">5</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-4">4</a>
     <a href="#section-5.1">5.1</a>.  Normative references  . . . . . . . . . . . . . . . . . . . <a href="#page-4">4</a>
     <a href="#section-5.2">5.2</a>.  Informative references  . . . . . . . . . . . . . . . . . . <a href="#page-4">4</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The global IPv4 address free pool at IANA was exhausted in February
   2011.  Service providers will now have a hard time finding enough
   IPv4 global addresses to sustain product and subscriber growth.  Due
   to the huge existing global infrastructure, both hardware and
   software, vendors, and service providers must continue to support
   IPv4 technologies for the foreseeable future.  As legacy applications
   and hardware are retired, the reliance on IPv4 will diminish;
   however, this is a process that will take years, perhaps decades.

   To maintain legacy IPv4 address support, service providers will have
   little choice but to share IPv4 global addresses among multiple
   customers.  Techniques to do so are outside of the scope of this
   document.  All include some form of address translation/address
   sharing, being NAT44 [<a href="rfc3022.html" title='"Traditional IP Network Address Translator (Traditional NAT)"'>RFC3022</a>], NAT64 [<a href="rfc6146.html" title='"Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers"'>RFC6146</a>] or DS-Lite [<a href="#ref-DS-LITE" title='"Dual- Stack Lite Broadband Deployments Following IPv4 Exhaustion"'>DS-LITE</a>].

   The effects on the Internet of the introduction of those address
   sharing techniques have been documented in [<a href="rfc6269.html" title='"Issues with IP Address Sharing"'>RFC6269</a>].

   Address sharing techniques come with their own logging infrastructure
   to track the relation between which original IP address and source
   port(s) were associated with which user and external IPv4 address at
   any given point in time.  In the past, to support abuse mitigation or
   public safety requests, the knowledge of the external global IP
   address was enough to identify a subscriber of interest.  With
   address sharing technologies, only providing information about the
   external public address associated with a session to a service
   provider is no longer sufficient information to unambiguously
   identify customers.

   Note: This document provides recommendations for Internet-facing
   servers logging incoming connections.  It does not provide any
   recommendations about logging on carrier-grade NAT or other address
   sharing tools.






<span class="grey">Durand, et al.            Best Current Practice                 [Page 2]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6302.html">RFC 6302</a>             Internet-Facing Server Logging            June 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Recommendations"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Recommendations</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

   It is RECOMMENDED as best current practice that Internet-facing
   servers logging incoming IP addresses from inbound IP traffic also
   log:

   o  The source port number.

   o  A timestamp, RECOMMENDED in UTC, accurate to the second, from a
      traceable time source (e.g., NTP [<a href="rfc5905.html" title='"Network Time Protocol Version 4: Protocol and Algorithms Specification"'>RFC5905</a>]).

   o  The transport protocol (usually TCP or UDP) and destination port
      number, when the server application is defined to use multiple
      transports or multiple ports.

   Discussion: Carrier-grade NATs may have different policies to recycle
   ports; some implementations may decide to reuse ports almost
   immediately, some may wait several minutes before marking the port
   ready for reuse.  As a result, servers have no idea how fast the
   ports will be reused and, thus, should log timestamps using a
   reasonably accurate clock.  At this point, the RECOMMENDED accuracy
   for timestamps is to the second or better.  Representation of
   timestamps in UTC is preferred to local time with UTC-offset or time
   zone, as this extra information can be lost in the reporting chain.

   Examples of Internet-facing servers include, but are not limited to,
   web servers and email servers.

   Although the deployment of address sharing techniques is not foreseen
   in IPv6, the above recommendations apply to both IPv4 and IPv6, if
   only for consistency and code simplification reasons.

   Discussions about data-retention policies are out of scope for this
   document.  Server security and transport security are important for
   the protection of logs for Internet-facing systems.  The operator of
   the Internet-facing server must consider the risks, including the
   data and services on the server, to determine the appropriate
   measures.  The protection of logs is critical in incident
   investigations.  If logs are tampered with, evidence could be
   destroyed.

   The above recommendations also apply to devices such as load-
   balancers logging incoming connections on behalf of actual servers.




<span class="grey">Durand, et al.            Best Current Practice                 [Page 3]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6302.html">RFC 6302</a>             Internet-Facing Server Logging            June 2011</span>


   The above recommendations apply to current logging practices.  They
   do not require any changes in the way logging is performed; e.g.,
   which packets are examined and logged.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20ISP%20Considerations"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  ISP Considerations</span>

   ISP deploying IP address sharing techniques should also deploy a
   corresponding logging architecture to maintain records of the
   relation between a customer's identity and IP/port resources
   utilized.  However, recommendations on this topic are out of scope
   for this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Security%20Considerations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Security Considerations</span>

   In the absence of the source port number and accurate timestamp
   information, operators deploying any address sharing techniques will
   not be able to identify unambiguously customers when dealing with
   abuse or public safety queries.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20References"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Normative%20references"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Normative references</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Informative%20references"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Informative references</span>

   [<a id="ref-DS-LITE" name="ref-DS-LITE">DS-LITE</a>]  Durand, A., Droms, R., Woodyatt, J., and Y. Lee, "Dual-
              Stack Lite Broadband Deployments Following IPv4
              Exhaustion", Work in Progress, May 2011.

   [<a id="ref-RFC3022" name="ref-RFC3022">RFC3022</a>]  Srisuresh, P. and K. Egevang, "Traditional IP Network
              Address Translator (Traditional NAT)", <a href="rfc3022.html">RFC 3022</a>,
              January 2001.

   [<a id="ref-RFC5905" name="ref-RFC5905">RFC5905</a>]  Mills, D., Martin, J., Burbank, J., and W. Kasch, "Network
              Time Protocol Version 4: Protocol and Algorithms
              Specification", <a href="rfc5905.html">RFC 5905</a>, June 2010.

   [<a id="ref-RFC6146" name="ref-RFC6146">RFC6146</a>]  Bagnulo, M., Matthews, P., and I. van Beijnum, "Stateful
              NAT64: Network Address and Protocol Translation from IPv6
              Clients to IPv4 Servers", <a href="rfc6146.html">RFC 6146</a>, April 2011.

   [<a id="ref-RFC6269" name="ref-RFC6269">RFC6269</a>]  Ford, M., Ed., Boucadair, M., Durand, A., Levis, P., and
              P. Roberts, "Issues with IP Address Sharing", <a href="rfc6269.html">RFC 6269</a>,
              June 2011.




<span class="grey">Durand, et al.            Best Current Practice                 [Page 4]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6302.html">RFC 6302</a>             Internet-Facing Server Logging            June 2011</span>


Authors' Addresses

   Alain Durand
   Juniper Networks
   1194 North Mathilda Avenue
   Sunnyvale, CA  94089-1206
   USA

   EMail: adurand@juniper.net


   Igor Gashinsky
   Yahoo! Inc.
   45 West 18th St.
   New York, NY  10011
   USA

   EMail: igor@yahoo-inc.com


   Donn Lee
   Facebook, Inc.
   1601 S. California Ave.
   Palo Alto, CA  94304
   USA

   EMail: donn@fb.com


   Scott Sheppard
   ATT Labs
   575 Morosgo Ave, 4d57
   Atlanta, GA  30324
   USA

   EMail: Scott.Sheppard@att.com















Durand, et al.            Best Current Practice                 [Page 5]

</pre><br/>
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.111, available from
<a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>



</body><!-- Mirrored from tools.ietf.org/html/rfc6302 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 28 Apr 2015 16:01:09 GMT --></html>