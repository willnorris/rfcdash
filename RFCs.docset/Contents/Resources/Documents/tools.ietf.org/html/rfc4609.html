<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc4609 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:40 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:4609" name="DC.Identifier"/>
<meta content="This memo describes security threats for the larger (intra-domain or
inter-domain) multicast routing infrastructures. Only Protocol
Independent Multicast - Sparse Mode (PIM-SM) is analyzed, in its three
main operational modes: the traditional Any-Source Multicast (ASM)
model, the source-specific multicast (SSM) model, and the ASM model
enhanced by the Embedded Rendezvous Point (Embedded-RP) group-to-RP
mapping mechanism. This memo also describes enhancements to the
protocol operations that mitigate the identified threats. This memo
provides information for the Internet community." name="DC.Description.Abstract"/>
<meta content="Savola, Pekka" name="DC.Creator"/>
<meta content="Lehtonen, Rami" name="DC.Creator"/>
<meta content="October, 2006" name="DC.Date.Issued"/>
<meta content="Protocol Independent Multicast - Sparse Mode (PIM-SM) Multicast Routing Security Issues and Enhancements" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 4609 - Protocol Independent Multicast - Sparse Mode (PIM-SM) Multicast Routing Security Issues and Enhancements</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc4609.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc4609" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-mboned-mroutesec" title="draft-ietf-mboned-mroutesec">draft-ietf-mbon...</a>] [<a href="https://datatracker.ietf.org/doc/rfc4609" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4609" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc4609" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                          P. Savola
Request for Comments: 4609                                     CSC/FUNET
Category: Informational                                      R. Lehtonen
                                                             TeliaSonera
                                                                D. Meyer
                                                             August 2006


         <span class="h1">Protocol Independent Multicast - Sparse Mode (PIM-SM)</span>
           <span class="h1">Multicast Routing Security Issues and Enhancements</span>

Status of This Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2006).

Abstract

   This memo describes security threats for the larger (intra-domain or
   inter-domain) multicast routing infrastructures.  Only Protocol
   Independent Multicast - Sparse Mode (PIM-SM) is analyzed, in its
   three main operational modes: the traditional Any-Source Multicast
   (ASM) model, the source-specific multicast (SSM) model, and the ASM
   model enhanced by the Embedded Rendezvous Point (Embedded-RP)
   group-to-RP mapping mechanism.  This memo also describes enhancements
   to the protocol operations that mitigate the identified threats.




















<span class="grey">Savola, et al.               Informational                      [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Terminology .....................................................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. Threats to Multicast Routing ....................................<a href="#page-4">4</a>
      <a href="#section-3.1">3.1</a>. Receiver-Based Attacks .....................................<a href="#page-5">5</a>
           <a href="#section-3.1.1">3.1.1</a>. Joins to Different Groups (Join Flooding) ...........<a href="#page-5">5</a>
      <a href="#section-3.2">3.2</a>. Source-Based Attacks .......................................<a href="#page-7">7</a>
           <a href="#section-3.2.1">3.2.1</a>. Sending Multicast to Empty Groups (Data Flooding) ...<a href="#page-7">7</a>
           3.2.2. Disturbing Existing Group by Sending to It
                  (Group Integrity Violation)..........................<a href="#page-8">8</a>
      <a href="#section-3.3">3.3</a>. Aggravating Factors to the Threats .........................<a href="#page-9">9</a>
           <a href="#section-3.3.1">3.3.1</a>. Distant RP/Source Problem ...........................<a href="#page-9">9</a>
           <a href="#section-3.3.2">3.3.2</a>. No Receiver Information in PIM Joins ...............<a href="#page-10">10</a>
   <a href="#section-4">4</a>. Threat Analysis ................................................<a href="#page-10">10</a>
      <a href="#section-4.1">4.1</a>. Summary of the Threats ....................................<a href="#page-10">10</a>
      <a href="#section-4.2">4.2</a>. Enhancements for Threat Mitigation ........................<a href="#page-10">10</a>
   <a href="#section-5">5</a>. PIM Security Enhancements ......................................<a href="#page-11">11</a>
      <a href="#section-5.1">5.1</a>. Remote Routability Signalling .............................<a href="#page-11">11</a>
      <a href="#section-5.2">5.2</a>. Rate-Limiting Possibilities ...............................<a href="#page-12">12</a>
      <a href="#section-5.3">5.3</a>. Specific Rate-limiting Suggestions ........................<a href="#page-14">14</a>
           <a href="#section-5.3.1">5.3.1</a>. Group Management Protocol Rate-Limiter .............<a href="#page-14">14</a>
           <a href="#section-5.3.2">5.3.2</a>. Source Transmission Rate-Limiter ...................<a href="#page-14">14</a>
           <a href="#section-5.3.3">5.3.3</a>. PIM Signalling Rate-Limiter ........................<a href="#page-15">15</a>
           <a href="#section-5.3.4">5.3.4</a>. Unicast-Decapsulation Rate-Limiter .................<a href="#page-15">15</a>
           <a href="#section-5.3.5">5.3.5</a>. PIM Register Rate-Limiter ..........................<a href="#page-15">15</a>
           <a href="#section-5.3.6">5.3.6</a>. MSDP Source-Active Rate-Limiter ....................<a href="#page-16">16</a>
      <a href="#section-5.4">5.4</a>. Passive Mode for PIM ......................................<a href="#page-16">16</a>
   <a href="#section-6">6</a>. Security Considerations ........................................<a href="#page-16">16</a>
   <a href="#section-7">7</a>. Acknowledgements ...............................................<a href="#page-17">17</a>
   <a href="#section-8">8</a>. References .....................................................<a href="#page-17">17</a>
      <a href="#section-8.1">8.1</a>. Normative References ......................................<a href="#page-17">17</a>
      <a href="#section-8.2">8.2</a>. Informative References ....................................<a href="#page-17">17</a>
   <a href="#appendix-A">Appendix A</a>.  RPF Considers Interface, Not Neighbor ................<a href="#page-19">19</a>
   <a href="#appendix-B">Appendix B</a>.  Return Routability Extensions ........................<a href="#page-20">20</a>
     <a href="#appendix-B.1">B.1</a>.  Sending PIM-Prune Messages Down the Tree ..................<a href="#page-20">20</a>
     <a href="#appendix-B.2">B.2</a>.  Analysing Multicast Group Traffic at DR ...................<a href="#page-21">21</a>
     <a href="#appendix-B.3">B.3</a>.  Comparison of the Above Approaches ........................<a href="#page-21">21</a>













<span class="grey">Savola, et al.               Informational                      [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   This document describes security threats to the Protocol Independent
   Multicast - Sparse Mode (PIM-SM) multicast routing infrastructures
   and suggests ways to make these architectures more resistant to the
   described threats.

   Only attacks that have an effect on the multicast routing
   infrastructures (whether intra- or inter-domain) are considered.

   "On-link" attacks where the hosts specifically target the Designated
   Router (DR) or other routers on the link, or where hosts disrupt
   other hosts on the same link, possibly using group management
   protocols, are discussed elsewhere (e.g., [<a href="#ref-10" title='"Trust Models and Security in Multicast Listener Discovery"'>10</a>] and [<a href="#ref-12" title='"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"'>12</a>]).  These
   attacks are not discussed further in this document.

   Similar to unicast, the multicast payloads may need end-to-end
   security.  Security mechanisms to provide confidentiality,
   authentication, and integrity are described in other documents (e.g.,
   [<a href="#ref-9" title='"The Multicast Group Security Architecture"'>9</a>]).  Attacks that these security mechanisms protect against are not
   discussed further in this document.

   PIM builds on a model where Reverse Path Forwarding (RPF) checking
   is, among other things, used to ensure loop-free properties of the
   multicast distribution trees.  As a side effect, this limits the
   impact of an attacker using a forged source address, which is often
   used as a component in unicast-based attacks.  However, a host can
   still spoof an address within the same subnet, or spoof the source of
   a unicast-encapsulated PIM Register message, which a host may send on
   its own.

   We consider PIM-SM [<a href="#ref-1" title='"Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised)"'>1</a>] operating in the traditional Any Source
   Multicast (ASM) model (including the use of Multicast Source
   Discovery Protocol (MSDP) [<a href="#ref-2" title='"Multicast Source Discovery Protocol (MSDP)"'>2</a>] for source discovery), in Source-
   Specific Multicast [<a href="#ref-3" title='"Source-Specific Multicast for IP"'>3</a>] (SSM) model, and the Embedded-RP [<a href="#ref-4" title='"Embedding the Rendezvous Point (RP) Address in an IPv6 Multicast Address"'>4</a>]
   group-to-RP mapping mechanism in ASM model.  Bidirectional-PIM [<a href="#ref-15" title='"Bi-directional Protocol Independent Multicast (BIDIR-PIM)"'>15</a>]
   is typically deployed only in intra-domain and is similar to ASM but
   without register messages.  Bidirectional-PIM is not finished as of
   this writing, and its considerations are not discussed further in
   this document.











<span class="grey">Savola, et al.               Informational                      [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   ASM

      "ASM" [<a href="#ref-6" title='"Host extensions for IP multicasting"'>6</a>] is used to refer to the traditional Any Source Multicast
      model with multiple PIM domains and a signalling mechanism (MSDP)
      to exchange information about active sources between them.

   SSM

      "SSM" [<a href="#ref-7" title='"An Overview of Source-Specific Multicast (SSM)"'>7</a>] is used to refer to Source-Specific Multicast.

   SSM channel

      SSM channel (S, G) identifies the multicast delivery tree
      associated with a source address S and a SSM destination address
      G.

   Embedded-RP

      "Embedded-RP" refers to the ASM model where the Embedded-RP
      mapping mechanism is used to find the Rendezvous Point (RP) for a
      group, and MSDP is not used.

   Target Router

      "Target Router" is used to refer to either the RP processing a
      packet (ASM or Embedded-RP) or the DR that is receiving (Source,
      Group) (or (S,G)) joins (in all models).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Threats%20to%20Multicast%20Routing"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Threats to Multicast Routing</span>

   We make the broad assumption that the multicast routing networks are
   reasonably trusted.  That is, we assume that the multicast routers
   themselves are well-behaved, in the same sense that unicast routers
   are expected to behave well.  While this assumption is not entirely
   correct, it simplifies the analysis of threat models.  The threats
   caused by misbehaving multicast routers (including fake multicast
   routers) are not considered in this memo; the generic threat model
   would be similar to [<a href="#ref-5" title='"Generic Threats to Routing Protocols"'>5</a>].  RP discovery mechanisms like Bootstrap
   Router (BSR) and Auto-RP are also considered out of scope.

   As the threats described in this memo are mainly Denial-of-Service
   (DoS) attacks, it may be useful to note that the attackers will try
   to find a scarce resource anywhere in the control or data plane, as
   described in [<a href="#ref-5" title='"Generic Threats to Routing Protocols"'>5</a>].





<span class="grey">Savola, et al.               Informational                      [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


   There are multiple threats relating to the use of host-to-router
   signalling protocols -- such as Internet Group Management Protocol
   (IGMP) or Multicast Listener Discovery (MLD) -- but these are outside
   the scope of this memo.

   PIM-SM can be abused in the cases where RPF checks are not applicable
   (in particular, in the stub LAN networks), as spoofing the on-link
   traffic is very simple.  For example, a host could get elected to
   become DR for the subnet, but not perform any of its functions.  A
   host can also easily make PIM routers on the link stop forwarding
   multicast by sending PIM Assert messages.  This implies that a
   willful attacker will be able to circumvent many of the potential
   rate-limiting functions performed at the DR (as one can always send
   the messages himself).  The PIM-SM specification, however, states
   that these messages should only be accepted from known PIM neighbors;
   if this is performed, the hosts would first have to establish a PIM
   adjacency with the router.  Typically, adjacencies are formed with
   anyone on the link, so a willful attacker would have a high
   probability of success in forming a protocol adjacency.  These are
   described at some length in [<a href="#ref-1" title='"Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised)"'>1</a>], but are also considered out of the
   scope of this memo.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Receiver-Based%20Attacks"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Receiver-Based Attacks</span>

   These attacks are often referred to as control plane attacks, and the
   aim of the attacker is usually to increase the amount of multicast
   state information in routers above a manageable level.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.1.%20%20Joins%20to%20Different%20Groups%20%28Join%20Flooding%29"></a><a class="selflink" href="#section-3.1.1" name="section-3.1.1">3.1.1</a>.  Joins to Different Groups (Join Flooding)</span>

   Join flooding occurs when a host tries to join, once or a couple of
   times, to a group or an SSM channel, and the DR generates a PIM Join
   to the Target Router.  The group/SSM channel or the Target Router may
   or may not exist.

   An example of this is a host trying to join different, non-existent
   groups at a very rapid pace, trying to overload the routers on the
   path with an excessive amount of (*/S,G) state (also referred to as
   "PIM State"), or the Target Router with an excessive number of
   packets.

   Note that even if a host joins to a group multiple times, the DR only
   sends one PIM Join message, without waiting for any acknowledgement;
   the next message is only sent after the PIM Join timer expires or the
   state changes at the DR.






<span class="grey">Savola, et al.               Informational                      [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


   This kind of joining causes PIM state to be created, but this state
   is relatively short-lived (260 seconds by default, which is the
   default time that the state is active at DR in the absence of IGMP/
   MLD Reports/Leaves).  Note that the host can join a number of
   different ASM groups or SSM channels with only one IGMPv3 [<a href="#ref-11" title='"Internet Group Management Protocol, Version 3"'>11</a>] or
   MLDv2 [<a href="#ref-12" title='"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"'>12</a>] Report as the protocol allows multiple sources to be
   included in the same message, resulting in multiple PIM Joins from
   one IGMPv3/MLDv2 message.

   However, even short-lived state may be harmful when the intent is to
   cause as much state as possible.  The host can continue to send
   IGMP/MLD Reports to these groups to make the state attack more
   long-lived.  This results in:

   o  ASM: An (*,G) join is sent to an intra-domain RP, causing state on
      that path; in turn, that RP joins to the DR of the source if the
      source is active.  If the source address was specified by the host
      in the IGMPv3/MLDv2 Report, a (S,G) Join is sent directly to the
      DR of the source, as with SSM, below.

   o  SSM: An (S,G) join is sent inter-domain to the DR of the source S,
      causing state on that path.  If the source S does not exist, the
      join goes to the closest router using longest prefix matching on
      the path to S as possible.

   o  Embedded-RP: An (*,G) join is sent towards an inter/intra-domain
      RP embedded in the group G, causing state on that path.  If the RP
      does not exist, the join goes to the router that is closest to the
      RP address.  Similarly, an explicit (S,G) join goes to the DR, as
      with SSM above.

   That is, SSM and Embedded-RP always enable "inter-domain" state
   creation.  ASM defaults to intra-domain, but can be used for inter-
   domain state creation as well.

   If the source or RP (only in case of Embedded-RP) does not exist, the
   multicast routing protocol does not have any means to remove the
   distribution tree if the joining host remains active.  The worst case
   attack could be a host remaining active to many different groups
   (containing either imaginary source or RP).  Please note that the
   imaginary RP problem is related to only Embedded-RP, where the RP
   address is extracted from the group address, G.

   For example, if the host is able to generate 100 IGMPv3 (S,G) joins a
   second, each carrying 10 sources, the amount of state after 260
   seconds would be 260 000 state entries -- and 100 packets per second
   is still a rather easily achievable number.




<span class="grey">Savola, et al.               Informational                      [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Source-Based%20Attacks"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Source-Based Attacks</span>

   These attacks are often referred to as "data plane" attacks; however,
   with traditional ASM and MSDP, these also include an MSDP control
   plane threat.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.1.%20%20Sending%20Multicast%20to%20Empty%20Groups%20%28Data%20Flooding%29"></a><a class="selflink" href="#section-3.2.1" name="section-3.2.1">3.2.1</a>.  Sending Multicast to Empty Groups (Data Flooding)</span>

   Data flooding occurs when a host sends data packets to a multicast
   group or SSM channel for which there are no real subscribers.

   Note that since register encapsulation is not subject to RPF checks,
   the hosts can also craft and send these packets themselves, also
   spoofing the source address of the register messages unless ingress
   filtering [<a href="#ref-13" title='"Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing"'>13</a>] has been deployed [<a href="#ref-14" title='"Ingress Filtering for Multihomed Networks"'>14</a>].  That is, as the initial data
   registering is not subject to the same RPF checks as many other
   multicast routing procedures, making control decisions based on that
   data leads to many potential threats.

   Examples of this threat are a virus/worm trying to propagate to
   multicast addresses, an attacker trying to crash routers with
   excessive MSDP state, or an attacker wishing to overload the RP with
   encapsulated packets of different groups.  This results in:

   o  ASM: The DR register-encapsulates the packets in Register messages
      to the intra-domain RP, which may join to the source and issue a
      Register-Stop, but which continues to get the data.  A
      notification about the active source is sent (unless the group or
      source is configured to be local) inter-domain with MSDP and
      propagated globally.

   o  SSM: The DR receives the data, but the data does not propagate
      from the DR unless someone joins the (S,G) channel.

   o  Embedded-RP: The DR register-encapsulates the packets to the
      intra/inter-domain RP, which may join to the source and issue a
      Register-Stop.  Data continues to be encapsulated if different
      groups are used.

   This yields many potential attacks, especially if at least parts of
   the multicast forwarding functions are implemented on a "slow" path
   or CPU in the routers:

   o  The MSDP control plane traffic generated can cause a significant
      amount of control and data traffic, which may overload the routers
      receiving it.  A thorough analysis of MSDP vulnerabilities can be
      found in [<a href="#ref-16" title='"Detection and Deflection of DoS Attacks Against the Multicast Source Discovery Protocol"'>16</a>] and is only related to the ASM.  However, this is
      the most serious threat at the moment, because MSDP will flood the



<span class="grey">Savola, et al.               Informational                      [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


      multicast group information to all multicast domains in Internet
      including the multicast packet encapsulated to MSDP source-active
      message.  This creates a lot of data and state to be shared by all
      multicast-enabled routers, and if the source remains active, the
      flooding will be repeated every 60 seconds by default.

   o  As a large amount of data is forwarded on the multicast tree, if
      multicast forwarding is performed on CPU, it may be a serious
      performance bottleneck, and a way to perform DoS on the path.
      Similarly, the DR must always be capable of processing (and
      discarding, if necessary) the multicast packets received from the
      source.  These are potentially present in every model.

   o  If the encapsulation is performed on software, it may be a
      performance bottleneck, and a way to perform DoS on the DR.
      Similarly, if the decapsulation is performed on software, it may
      be a performance bottleneck, and a way to perform DoS on the RP.
      Note: the decapsulator may know (based on access configuration, a
      rate limit, or something else) that it doesn't need to decapsulate
      the packet, avoiding bottlenecks.  These threats are related to
      ASM and Embedded-RP.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.2.%20%20Disturbing%20Existing%20Group%20by%20Sending%20to%20It%20%28Group%20Integrity"></a><a class="selflink" href="#section-3.2.2" name="section-3.2.2">3.2.2</a>.  Disturbing Existing Group by Sending to It (Group Integrity</span>
<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/Violation%29"></a>        Violation)</span>

   Group integrity violation occurs when a host sends packets to a group
   or SSM channel, which already exists, to disturb the users of the
   existing group/SSM channel.

   The SSM service model prevents injection of packets to (S,G)
   channels, avoiding this problem.  However, if the source address can
   be spoofed to be a topologically-correct address, it's possible to
   get the packet into the distribution tree.  Typically only hosts that
   are on-link with the source are able to perform this, so it is not
   really relevant in the scope of this memo.

   With ASM and Embedded-RP, sources can inject forged traffic through
   RPs, which provide the source discovery for the group.  The RPs send
   the traffic over the shared tree towards receivers (routers with
   (*,G) state).  DR then forwards the forged traffic to receivers
   unless the legitimate recipients are able to filter out unwanted
   sources, e.g., using Multicast Source Filters (MSF) API [<a href="#ref-8" title='"Socket Interface Extensions for Multicast Source Filters"'>8</a>].
   Typically this is not used or supported by the applications using
   these protocols.







<span class="grey">Savola, et al.               Informational                      [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


   Note that with ASM and Embedded-RP, the RP may exert some form of
   control on who can send to a group, as the first packets are
   register-encapsulated in register packets to the RP.  If the RP drops
   the packet based on an access list, a rate limit, or something else,

   it doesn't get injected to an existing group.  However, if the DR has
   existing (*,G) state, the data will also be forwarded on those
   interfaces.

   With ASM, this "source control" is distributed across all the PIM
   domains, which significantly decreases its applicability.
   Embedded-RP enables easier control because source discovery is done
   through a single RP per group.

   As a result, in addition to possible local disturbance, the RP
   decapsulates the register packets and forwards them to the receivers
   in the multicast distribution tree, resulting in an integrity
   violation.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Aggravating%20Factors%20to%20the%20Threats"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Aggravating Factors to the Threats</span>

   This section describes a few factors that aggravate the threats
   described in Sections <a href="#section-3.1">3.1</a> and <a href="#section-3.2">3.2</a>.  These could also be viewed as
   individual threats on their own.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.1.%20%20Distant%20RP%2FSource%20Problem"></a><a class="selflink" href="#section-3.3.1" name="section-3.3.1">3.3.1</a>.  Distant RP/Source Problem</span>

   In the shared tree model, if the RP or a source is distant
   (topologically), then joins will travel to the distant RP or source
   and keep the state information in the path active, even if the data
   is being delivered locally.

   Note that this problem will be exacerbated if the RP/source space is
   global; if a router is registering to a RP/source that is not in the
   local domain (say, fielded by the site's direct provider), then the
   routing domain is flat.

   Also note that PIM assumes that the addresses used in PIM messages
   are valid.  However, there is no way to ensure this, and using non-
   existent S or G in (*,G) or (S,G) messages will cause the signalling
   to be set up, even though one cannot reach the address.

   This will be analyzed at more length in <a href="#section-5.1">Section 5.1</a>.








<span class="grey">Savola, et al.               Informational                      [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.2.%20%20No%20Receiver%20Information%20in%20PIM%20Joins"></a><a class="selflink" href="#section-3.3.2" name="section-3.3.2">3.3.2</a>.  No Receiver Information in PIM Joins</span>

   Only DRs, which are directly connected to receivers, know the exact
   receiver information (e.g., IP address).  PIM does not forward that
   information further in the multicast distribution tree.  Therefore,
   individual routers (e.g., domain edge routers) are not able to make
   policy decisions on who can be connected to the distribution tree.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Threat%20Analysis"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Threat Analysis</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Summary%20of%20the%20Threats"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Summary of the Threats</span>

   Trying to summarize the severity of the major classes of threats with
   respect to each multicast usage model, we have a matrix of resistance
   to different kinds of threats:

                 +----------------+------------------+-----------------+
                 | Forged Join    |   Being a Source | Group Integrity |
   +-------------+----------------+------------------+-----------------+
   | ASM         |    bad 1)      |      very bad    |   bad/mediocre  |
   +-------------+----------------+------------------+-----------------+
   | SSM         |    bad         |     very good    |    very good    |
   +-------------+----------------+------------------+-----------------+
   | Embedded-RP |    bad 1),2)   | good/mediocre 3) |      good       |
   +-------------+----------------+------------------+-----------------+

   Notes:

   1) In ASM, the host can directly join also (S,G) groups with
      IGMPv3/MLDv2 and thus have the same characteristics as SSM (also
      allows inter-domain state to be created).

   2) allows inter-domain shared state to be created.

   3) Embedded-RP allows a host to determine the RP for a given group
      (or set of groups), which in turn allows that host to mount a PIM
      register attack.  In this case, the host can mount the attack
      without implementing any of the PIM register machinery.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Enhancements%20for%20Threat%20Mitigation"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Enhancements for Threat Mitigation</span>

   There are several desirable actions ("requirements") that could be
   considered to mitigate these threats; these are listed below.  A few
   more concrete suggestions are presented later in the section.

   o  Inter-domain MSDP (ASM) should be retired to avoid attacks; or, if
      this is not reasonable, the DRs should rate-limit the register
      encapsulation (note that the hosts can circumvent this).  More



<span class="grey">Savola, et al.               Informational                     [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


      importantly, the RPs should rate-limit the register decapsulation
      especially from different sources, or MSDP must rate-limit the
      MSDP data generation for new sources.

   o  DRs should rate-limit PIM Joins and Prunes somehow; there are
      multiple ways this should be considered (i.e., depending on which
      variables are taken into consideration).

   o  DRs could rate-limit register encapsulation somehow; there are
      multiple ways to perform this.  Note that the hosts can avoid this
      by performing the register encapsulation themselves if so
      inclined.

   o  RPs could rate-limit register decapsulation somehow; there are
      multiple ways to perform this.  Note that if the source of the
      unicast packets is spoofed by the host, this may have an effect on
      how (for example) rate-limiters behave.

   o  RPs should rate-limit the MSDP SA messages coming from MSDP peers.

   o  RPs could limit or even disable the SA cache size.  However, this
      could have negative effects on normal operation.

   o  RPs should provide good interfaces to reject packets that are not
      interesting; for example, if an Embedded-RP group is not
      configured to be allowed in the RP, the register encapsulated
      packets would not even be decapsulated.

   o  DRs could rate-limit the multicast traffic somehow to reduce the
      disturbing possibilities; there are multiple possibilities how
      exactly this should be considered.

   o  DRs should rate-limit the number of groups/SSM channels that can
      be created by a given source, S.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20PIM%20Security%20Enhancements"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  PIM Security Enhancements</span>

   This section includes more in-depth description of the above-
   mentioned functions for rate-limiting, etc., as well as a description
   of the remote routability signalling issue.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Remote%20Routability%20Signalling"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Remote Routability Signalling</span>

   As described in <a href="#section-3.3.1">Section 3.3.1</a>, non-existent DRs or RPs may cause some
   problems when setting up multicast state.  There seem to be a couple
   of different approaches to mitigate this, especially if rate-limiting
   is not extensively deployed.




<span class="grey">Savola, et al.               Informational                     [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


   With ASM and Embedded-RP, Register message delivery could be ensured
   somehow.  For example:

      1) At the very least, receiving an ICMP unreachable message (of
         any flavor) should cause the DR to stop the Register packets,
         as the RP will not be receiving them anyway.  (However, one
         should note that easy spoofing of such ICMP messages could
         cause a DoS on legitimate traffic.)

      2) An additional method could be implementing a timer on the DRs
         so that unless nothing is heard back from the RP within a
         defined time period, the flow of Register messages would stop.
         (Currently, the RPs are not required to answer back, unless
         they want to join to the source.)

      3) An extreme case would be performing some form of return
         routability check prior to starting the register messages:
         first, a packet would be sent to the RP, testing its existence
         and willingness to serve, and also proving to the RP that the
         sender of the "bubble" and the sender of the registers are the
         same and the source address is not forged.  (That is, the RP
         would insert a cookie in the bubble, and it would have to be
         present in the register message.)

   It would be desirable to have some kind of state management for PIM
   Joins (and other messages) as well; for example, a "Join Ack" that
   could be used to ensure that the path to the source/RP actually
   exists.  However, this is very difficult, if not impossible, with the
   current architecture: PIM messages are sent hop-by-hop, and there is
   not enough information to trace back the replies, for example, to
   notify the routers in the middle to release the corresponding state
   or to notify the DR that the path did not exist.

   <a href="#appendix-B">Appendix B</a> discusses this receiver-based remote routability
   signalling in more detail.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Rate-Limiting%20Possibilities"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Rate-Limiting Possibilities</span>

   There seem to be many ways to implement rate-limiting (for
   signalling, data encapsulation, and multicast traffic) at the DRs or
   RPs.  The best approach likely depends on the threat model; for
   example, factors in the evaluation may include:

   o  Whether the host is willfully malicious, uncontrolled (e.g.,
      virus/worm), or a regular user just doing something wrong.






<span class="grey">Savola, et al.               Informational                     [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


   o  Whether the threat is aimed towards a single group, a single RP
      handling the group, or the (multicast) routing infrastructure in
      general.

   o  Whether the host on a subnet is spoofing its address (but still as
      one that fulfills the RPF checks of the DR).

   o  Whether the host may generate the PIM join (and similar) messages
      itself to avoid rate-limiters at the DR, if possible.

   o  Whether unicast RPF checks are applied on the link (i.e., whether
      the host can send register-encapsulated register-messages on its
      own).

   o  Whether blocking the misbehaving host on a subnet is allowed to
      also block other, legitimate hosts on the same subnet.

   o  Whether these mechanisms would cause false positives on links with
      only properly working hosts if many of them are receivers or
      senders.

   As should be obvious, there are many different scenarios here that
   seem to call for different kinds of solutions.

   For example, the rate-limiting could be performed based on:

   1.  multicast address, or the RP where the multicast address maps to

   2.  source address

   3.  the (source address, multicast address) pair (or the RP that maps
       to the multicast address)

   4.  data rate, in case of rate-limiting the source

   5.  everything (multicast groups and sources would not be
       distinguished at all)

   In the above, we assume that rate-limiting would be performed per-
   interface (on DRs) if a more fine-grained filter is not being used.

   It should be noted that some of the rate-limiting functions can be
   used as a tool for DoS against legitimate multicast users.
   Therefore, several parameters for rate-limiting should be used to
   prevent such operation.






<span class="grey">Savola, et al.               Informational                     [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Specific%20Rate-limiting%20Suggestions"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Specific Rate-limiting Suggestions</span>

   These suggestions take two forms: limiters designed to be run on all
   the edge networks, preventing or limiting an attack in the first
   place, and the limiters designed to be run at the border of PIM
   domains or at the RPs, which should provide protection in case edge-
   based limiting fails or was not implemented, or when additional
   control is required.

   Almost none of the suggested rate-limiters take legitimate users into
   account.  That is, being able to allow some hosts on a link to
   transmit/receive, while disallowing others, is very challenging to do
   right, because the attackers can easily circumvent such systems.
   Therefore, the intent is to limit the damage to only one link, one
   DR, or one RP -- and avoid the more global effects on the Internet
   multicast architecture.

   Also, it is possible to perform white-listing of groups, sources, or
   (S,G) pairs from the rate-limiters so that packets related to these
   are not counted towards the limits.  This is useful for handling an
   aggressive but legitimate source without modifying the limiting
   parameters for all the traffic, for example.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.1.%20%20Group%20Management%20Protocol%20Rate-Limiter"></a><a class="selflink" href="#section-5.3.1" name="section-5.3.1">5.3.1</a>.  Group Management Protocol Rate-Limiter</span>

   A Group Management Protocol rate-limiter is a token-bucket-based
   rate-limiter to all Group Management Protocols (IGMP, MLD) that would
   limit the average rate of accepted groups or sources on the specific
   interface, with a bucket of depth of G_DEPTH, refilling at G_RATE
   tokens per second.  Example values could be G_RATE=1 and G_DEPTH=20.
   Note that, e.g., an IGMPv3 join with two included sources for one
   group would count as two groups/sources.

   This would be the first-order defense against state-creation attacks
   from the hosts.  However, as it cannot be guaranteed that all the
   routers would implement something like this, other kinds of
   protections would be useful as well.  This harms legitimate receivers
   on the same link as an attacker.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.2.%20%20Source%20Transmission%20Rate-Limiter"></a><a class="selflink" href="#section-5.3.2" name="section-5.3.2">5.3.2</a>.  Source Transmission Rate-Limiter</span>

   A source transmission rate-limiter is a token-bucket-based rate-
   limiter that would limit the multicast data transmission (excluding
   link-local groups) on a specific interface with a bucket of depth of
   GSEND_DEPTH, refilling at GSEND_RATE tokens per second.  Example
   values could be GSEND_RATE=10 and GSEND_DEPTH=20.





<span class="grey">Savola, et al.               Informational                     [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


   This would be the first-order defense against data flooding attacks.
   However, as it cannot be guaranteed that all routers would implement
   something like this, and as the RP (if SSM is not used) could be
   loaded from multiple senders, additional protections are needed as
   well.  This harms legitimate senders on the same link as an attacker.
   This does not prevent a host from sending a lot of traffic to the
   same group -- an action that would harm only the DR and the RP of the
   group, is similar to unicast DoS attacks against one source, and is
   not considered critical to the overall security.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.3.%20%20PIM%20Signalling%20Rate-Limiter"></a><a class="selflink" href="#section-5.3.3" name="section-5.3.3">5.3.3</a>.  PIM Signalling Rate-Limiter</span>

   A PIM signalling rate-limiter is a token-bucket-based rate-limiter
   that would limit all multicast PIM messaging, either through a
   specific interface or globally on the router, with a bucket of depth
   of PIM_DEPTH, refilling at PIM_RATE tokens per second.  Example
   values could be PIM_RATE=1000 and PIM_DEPTH=10000.

   This would be second-order defense against PIM state attacks when
   IGMP/MLD rate-limiters haven't been implemented or haven't been
   effective.  This limiter might not need to be active by default, as
   long as the values are configurable.  The main applicability for this
   filter would be at a border of PIM domain in case PIM state attacks
   are detected.  This harms legitimate receivers as well.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.4.%20%20Unicast-Decapsulation%20Rate-Limiter"></a><a class="selflink" href="#section-5.3.4" name="section-5.3.4">5.3.4</a>.  Unicast-Decapsulation Rate-Limiter</span>

   A unicast-decapsulation rate-limiter is a simple decapsulation rate-
   limiter that would protect the CPU usage in the router by limiting
   the packets per second (depending on the router architecture) and
   disregarding the source of the registers.  This could also be an
   additional check to be used before decapsulation and checking the
   group to throttle the worst of the decapsulation CPU consumption.
   This limit should have to be quite high, and would hamper the
   existing legitimate sessions as well.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.5.%20%20PIM%20Register%20Rate-Limiter"></a><a class="selflink" href="#section-5.3.5" name="section-5.3.5">5.3.5</a>.  PIM Register Rate-Limiter</span>

   A PIM Register rate-limiter is a token-bucket-based rate-limiter that
   would limit register decapsulation of PIM Register messages with a
   bucket of depth of REG_DEPTH, refilling at REG_RATE tokens per
   second.  If the router has restarted recently, a larger initial
   bucket should be used.  Example values could be REG_RATE=1 and
   REG_DEPTH=10 (or REG_DEPTH=500 after restart).

   This would be second-order defense against data flooding: if the DRs
   would not implement appropriate limiters, or if the total number of
   flooded groups rises too high, the RP should be able to limit the



<span class="grey">Savola, et al.               Informational                     [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


   rate with which new groups are created.  This does not harm
   legitimate senders, as long as their groups have already been
   created.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.6.%20%20MSDP%20Source-Active%20Rate-Limiter"></a><a class="selflink" href="#section-5.3.6" name="section-5.3.6">5.3.6</a>.  MSDP Source-Active Rate-Limiter</span>

   A MSDP source-active rate-limiter is a token-bucket-based, source-
   based rate-limiter, that would limit new groups per source with a
   bucket of depth of SAG_DEPTH, refilling at SAG_RATE tokens per
   second.  Example values could be SAG_RATE=1 and SAG_DEPTH=10.

   This would be second-order defense, at both the MSDP SA sending and
   receiving sites, against data flooding and MSDP vulnerabilities in
   particular.  The specific threat being addressed here is a source (or
   multiple different sources) trying to "probe" (e.g., virus or worm)
   different multicast addresses. [<a href="#ref-16" title='"Detection and Deflection of DoS Attacks Against the Multicast Source Discovery Protocol"'>16</a>] discusses different MSDP attack
   prevention mechanisms at length.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20Passive%20Mode%20for%20PIM"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  Passive Mode for PIM</span>

   As described in the last paragraph of <a href="#section-3">Section 3</a>, hosts are also able
   to form PIM adjacencies and send disrupting traffic unless great care
   is observed at the routers.  This stems from the fact that most
   implementations require that stub LANs with only one PIM router must
   also have PIM enabled (to enable PIM processing of the sourced data,
   etc.)  Such stub networks however do not require to actually run the
   PIM protocol on the link.  Therefore, such implementations should
   provide an option to specify that the interface is "passive" with
   regard to PIM: no PIM packets are sent or processed (if received),
   but hosts can still send and receive multicast on that interface.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Security Considerations</span>

   This memo analyzes the security of PIM routing infrastructures in
   some detail and proposes enhancements to mitigate the observed
   threats.

   This document does not discuss adding (strong) authentication to the
   multicast protocols.  The PIM-SM specification [<a href="#ref-1" title='"Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised)"'>1</a>] describes the
   application of IPsec for routing authentication; note that being able
   to authenticate the register messages and to prevent illegitimate
   users from establishing PIM adjacencies seem to be the two most
   important goals.  The IGMPv3 specification [<a href="#ref-11" title='"Internet Group Management Protocol, Version 3"'>11</a>] describes the use of
   IPsec for group management (IPsec for MLDv2 may be applied
   similarly), which is out of scope for this memo.  However, note that
   being able to control the group memberships might reduce the
   receiver-based attacks.




<span class="grey">Savola, et al.               Informational                     [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


   However, one should keep in mind two caveats: authentication alone
   might not be sufficient, especially if the user or the host stack
   (consider a worm propagation scenario) cannot be expected to "behave
   well"; and adding such authentication likely provides new attack
   vectors, e.g., in the form of a CPU DoS attack with an excessive
   amount of cryptographic operations.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Acknowledgements"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Acknowledgements</span>

   Kamil Sarac discussed "return routability" issues at length.  Stig
   Venaas and Bharat Joshi provided feedback to improve the document
   quality.  Bill Fenner and Russ Housley provided useful comments
   during the IESG evaluation.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20References"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Normative%20References"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Normative References</span>

   [<a id="ref-1" name="ref-1">1</a>]   Fenner, B., Handley, M., Holbrook, H., and I. Kouvelas,
         "Protocol Independent Multicast - Sparse Mode (PIM-SM):
         Protocol Specification (Revised)", <a href="rfc4601.html">RFC 4601</a>, August 2006.

   [<a id="ref-2" name="ref-2">2</a>]   Fenner, B. and D. Meyer, "Multicast Source Discovery Protocol
         (MSDP)", <a href="rfc3618.html">RFC 3618</a>, October 2003.

   [<a id="ref-3" name="ref-3">3</a>]   Holbrook, H. and B. Cain, "Source-Specific Multicast for IP",
         <a href="rfc4607.html">RFC 4607</a>, August 2006.

   [<a id="ref-4" name="ref-4">4</a>]   Savola, P. and B. Haberman, "Embedding the Rendezvous Point
         (RP) Address in an IPv6 Multicast Address", <a href="rfc3956.html">RFC 3956</a>,
         November 2004.

   [<a id="ref-5" name="ref-5">5</a>]   Barbir, A., Murphy, S., and Y. Yang, "Generic Threats to
         Routing Protocols", <a href="rfc4593.html">RFC 4593</a>, July 2006.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Informative%20References"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Informative References</span>

   [<a id="ref-6" name="ref-6">6</a>]   Deering, S., "Host extensions for IP multicasting", STD 5,
         <a href="rfc1112.html">RFC 1112</a>, August 1989.

   [<a id="ref-7" name="ref-7">7</a>]   Bhattacharyya, S., "An Overview of Source-Specific Multicast
         (SSM)", <a href="rfc3569.html">RFC 3569</a>, July 2003.

   [<a id="ref-8" name="ref-8">8</a>]   Thaler, D., Fenner, B., and B. Quinn, "Socket Interface
         Extensions for Multicast Source Filters", <a href="rfc3678.html">RFC 3678</a>,
         January 2004.





<span class="grey">Savola, et al.               Informational                     [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


   [<a id="ref-9" name="ref-9">9</a>]   Hardjono, T. and B. Weis, "The Multicast Group Security
         Architecture", <a href="rfc3740.html">RFC 3740</a>, March 2004.

   [<a id="ref-10" name="ref-10">10</a>]  Daley, G. and G. Kurup, "Trust Models and Security in Multicast
         Listener Discovery", Work in Progress, July 2004.

   [<a id="ref-11" name="ref-11">11</a>]  Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A.
         Thyagarajan, "Internet Group Management Protocol, Version 3",
         <a href="rfc3376.html">RFC 3376</a>, October 2002.

   [<a id="ref-12" name="ref-12">12</a>]  Vida, R. and L. Costa, "Multicast Listener Discovery Version 2
         (MLDv2) for IPv6", <a href="rfc3810.html">RFC 3810</a>, June 2004.

   [<a id="ref-13" name="ref-13">13</a>]  Ferguson, P. and D. Senie, "Network Ingress Filtering:
         Defeating Denial of Service Attacks which employ IP Source
         Address Spoofing", <a href="https://tools.ietf.org/html/bcp38">BCP 38</a>, <a href="rfc2827.html">RFC 2827</a>, May 2000.

   [<a id="ref-14" name="ref-14">14</a>]  Baker, F. and P. Savola, "Ingress Filtering for Multihomed
         Networks", <a href="https://tools.ietf.org/html/bcp84">BCP 84</a>, <a href="rfc3704.html">RFC 3704</a>, March 2004.

   [<a id="ref-15" name="ref-15">15</a>]  Handley, M., "Bi-directional Protocol Independent Multicast
         (BIDIR-PIM)", Work in Progress, October 2005.

   [<a id="ref-16" name="ref-16">16</a>]  Rajvaidya, P., Ramachandran, K., and K. Almeroth, "Detection
         and Deflection of DoS Attacks Against the Multicast Source
         Discovery Protocol", UCSB Technical Report, May 2003.

























<span class="grey">Savola, et al.               Informational                     [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20RPF%20Considers%20Interface%2C%20Not%20Neighbor"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  RPF Considers Interface, Not Neighbor</span>

   In most current implementations, the RPF check considers only the
   incoming interface, and not the upstream neighbor (RPF neighbor).

   This can result in accepting packets from the "wrong" RPF neighbor
   (the neighbor is "wrong" since, while the RPF check succeeds and the
   packet is forwarded, the unicast policy would not have forwarded the
   packet).

   This is a problem in the media where more than two routers can
   connect to, in particular, Ethernet-based Internet Exchanges.
   Therefore, any neighbor on such a link could inject any PIM
   signalling as long as a route matching the address used in the
   signalling is going through the interface.

   Note that for PIM signalling to be accepted, a PIM adjacency must
   have been established.  However, typically, this does not help much
   against willful attackers, as PIM adjacencies are usually formed with
   anyone on the link.  Still, the requirement is that the neighbor has
   enabled PIM in the concerned interface.  That is, in most cases, the
   threat is limited to attackers within the operators in the exchange,
   not third parties.  On the other hand, data plane forwarding has no
   such checks -- and having such checks would require that one look at
   the link-layer addresses used.  That is, this checking is not as
   feasible as one might hope.

























<span class="grey">Savola, et al.               Informational                     [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20B.%20%20Return%20Routability%20Extensions"></a><a class="selflink" href="#appendix-B" name="appendix-B">Appendix B</a>.  Return Routability Extensions</span>

   The multicast state information is built from the receiver side, and
   it can be currently pruned only by the receiver-side DR.  If the RP
   or the source for the group is non-existent, the state can't be
   pruned by the DR without return routability extensions to provide
   such information.  There might also be a need to remove the state in
   some cases when there is no multicast traffic sent to that group.
   This section discusses the alternative ways to remove the unused
   state information in the routers, so that it can't be used in state-
   based DoS attacks.  Note that rate-limiting PIM Joins gives some
   protection against the state attacks.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.1.%20%20Sending%20PIM-Prune%20Messages%20Down%20the%20Tree"></a><a class="selflink" href="#appendix-B.1" name="appendix-B.1">B.1</a>.  Sending PIM-Prune Messages Down the Tree</span>

   When a router discovers the non-existence of the RP or the source, it
   can create a PIM-Prune message and send it back to the join
   originator.  However, since it does not know the unicast IP address
   of join originator DR, it cannot directly unicast it to that router.

   A possible alternative is to use a link-local multicast group address
   (e.g., all-pim routers local multicast address) to pass this
   information back toward the joining DR.  Since the routers from this
   current router all the way back to the joining DR have forwarding
   state entry for the group, they can use this state information to see
   how to forward the PIM-Prune message back.

   Each on-tree router, in addition to forwarding the PIM-Prune message,
   can also prune the state from its state tables.  This way, the PIM-
   Prune message will go back to the DR by following the multicast
   forwarding state information created so far.  In addition, if we use
   some sort of RPF checks during this process, we can also make it more
   difficult to inject such PIM-Prune messages maliciously.

   A potential abuse scenario may involve an attacker that has access to
   a router on the direct path and can send such PIM-Prune messages down
   the tree branch so as to prune the branch from the tree.  But such an
   attacker can currently achieve the same effect by sending a PIM-Prune
   message toward the source from the same point on the tree.  So, the
   proposed mechanism does not really aggravate the situation.

   One visible overhead in this new scenario might be that someone can
   send bogus join messages to create redundant PIM-Join and PIM-Prune
   messages in the network.







<span class="grey">Savola, et al.               Informational                     [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.2.%20%20Analyzing%20Multicast%20Group%20Traffic%20at%20DR"></a><a class="selflink" href="#appendix-B.2" name="appendix-B.2">B.2</a>.  Analyzing Multicast Group Traffic at DR</span>

   Another possible way to remove the unused state information would be
   to analyze individual group traffic at the DR and if there is no
   multicast traffic for a certain group within a certain time limit,
   the state should be removed.  In here, if the receiver is malicious
   and wants to create states in the network, then it can send joins to
   different groups and create states on routers for each of these
   different groups until the DR decides that the groups are inactive
   and initiates the prune process.  In addition, during the prune
   process, the routers will again process all these prune messages and
   therefore will be spending time.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.3.%20%20Comparison%20of%20the%20Above%20Approaches"></a><a class="selflink" href="#appendix-B.3" name="appendix-B.3">B.3</a>.  Comparison of the Above Approaches</span>

   Both of these solutions have the same problem of renewing the
   multicast state information.  The DR shouldn't permanently block the
   state building for that group, but should restrict the PIM Joins if
   it notices that the receiver is abusing the system.  One additional
   option is to block the PIM Joins to the non-existent source/RP for a
   certain time.

   In the first approach (sending PIM-Prunes down the tree), part of the
   goal was to prune the states in the routers much sooner than in the
   second approach.  (That is, the goal is to make sure that the routers
   will not be keeping unnecessary states for long time.)

   The second approach works also for DoS attacks related to the
   existing source/RP addresses, could be more quickly implemented and
   deployed in the network, and does not have any relationship with the
   other deployments (no need to change all PIM routers).




















<span class="grey">Savola, et al.               Informational                     [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


Authors' Addresses

   Pekka Savola
   CSC/FUNET
   Espoo
   Finland

   EMail: psavola@funet.fi


   Rami Lehtonen
   TeliaSonera
   Hataanpaan valtatie 20
   Tampere 33100
   Finland

   EMail: rami.lehtonen@teliasonera.com


   David Meyer

   EMail: dmm@1-4-5.net





























<span class="grey">Savola, et al.               Informational                     [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc4609.html">RFC 4609</a>           PIM-SM Multicast Routing Security         August 2006</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).







Savola, et al.               Informational                     [Page 23]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc4609 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:40 GMT --></html>