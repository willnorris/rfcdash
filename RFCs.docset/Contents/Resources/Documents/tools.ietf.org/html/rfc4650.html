<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc4650 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:40 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-euchner-mikey-dhhmac" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:4650" name="DC.Identifier"/>
<meta content="September, 2006" name="DC.Date.Issued"/>
<meta content="Martin Euchner &lt;martin_euchner@hotmail.com&gt;" name="DC.Creator"/>
<meta content="This document describes a lightweight point-to-point key management
protocol variant for the multimedia Internet keying (MIKEY) protocol
MIKEY, as defined in RFC 3830. In particular, this variant deploys the
classic Diffie-Hellman key agreement protocol for key establishment
featuring perfect forward secrecy in conjunction with a keyed hash
message authentication code for achieving mutual authentication and
message integrity of the key management messages exchanged. This
protocol addresses the security and performance constraints of
multimedia key management in MIKEY. [STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="HMAC-Authenticated Diffie-Hellman for Multimedia Internet KEYing (MIKEY)" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 4650 - HMAC-Authenticated Diffie-Hellman for Multimedia Internet KEYing (MIKEY)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc4650.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc4650" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-msec-mikey-dhhmac" title="draft-ietf-msec-mikey-dhhmac">draft-ietf-msec...</a>] [<a href="https://datatracker.ietf.org/doc/rfc4650" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4650" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc4650" title="Side-by-side diff">Diff2</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=4650&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=4650">Errata</a>]</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Network Working Group                                         M. Euchner
Request for Comments: 4650                                September 2006
Category: Standards Track


                   <span class="h1">HMAC-Authenticated Diffie-Hellman</span>
                 <span class="h1">for Multimedia Internet KEYing (MIKEY)</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2006).

Abstract

   This document describes a lightweight point-to-point key management
   protocol variant for the multimedia Internet keying (MIKEY) protocol
   MIKEY, as defined in <a href="rfc3830.html">RFC 3830</a>.  In particular, this variant deploys
   the classic Diffie-Hellman key agreement protocol for key
   establishment featuring perfect forward secrecy in conjunction with a
   keyed hash message authentication code for achieving mutual
   authentication and message integrity of the key management messages
   exchanged.  This protocol addresses the security and performance
   constraints of multimedia key management in MIKEY.




















<span class="grey">Euchner                     Standards Track                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
      <a href="#section-1.1">1.1</a>. Definitions ................................................<a href="#page-5">5</a>
      <a href="#section-1.2">1.2</a>. Abbreviations ..............................................<a href="#page-6">6</a>
      <a href="#section-1.3">1.3</a>. Conventions Used in This Document ..........................<a href="#page-7">7</a>
   <a href="#section-2">2</a>. Scenario ........................................................<a href="#page-7">7</a>
      <a href="#section-2.1">2.1</a>. Applicability ..............................................<a href="#page-7">7</a>
      <a href="#section-2.2">2.2</a>. Relation to GKMARCH ........................................<a href="#page-8">8</a>
   <a href="#section-3">3</a>. DHHMAC Security Protocol ........................................<a href="#page-8">8</a>
      <a href="#section-3.1">3.1</a>. TGK Re-keying .............................................<a href="#page-10">10</a>
   <a href="#section-4">4</a>. DHHMAC Payload Formats .........................................<a href="#page-10">10</a>
      <a href="#section-4.1">4.1</a>.  Common Header Payload (HDR) ..............................<a href="#page-11">11</a>
      <a href="#section-4.2">4.2</a>. Key Data Transport Payload (KEMAC) ........................<a href="#page-12">12</a>
      <a href="#section-4.3">4.3</a>. ID Payload (ID) ...........................................<a href="#page-12">12</a>
      <a href="#section-4.4">4.4</a>. General Extension Payload .................................<a href="#page-12">12</a>
   <a href="#section-5">5</a>. Security Considerations ........................................<a href="#page-13">13</a>
      <a href="#section-5.1">5.1</a>. Security Environment ......................................<a href="#page-13">13</a>
      <a href="#section-5.2">5.2</a>. Threat Model ..............................................<a href="#page-13">13</a>
      <a href="#section-5.3">5.3</a>. Security Features and Properties ..........................<a href="#page-15">15</a>
      <a href="#section-5.4">5.4</a>. Assumptions ...............................................<a href="#page-19">19</a>
      <a href="#section-5.5">5.5</a>. Residual Risk .............................................<a href="#page-20">20</a>
      <a href="#section-5.6">5.6</a>. Authorization and Trust Model .............................<a href="#page-21">21</a>
   <a href="#section-6">6</a>. Acknowledgments ................................................<a href="#page-21">21</a>
   <a href="#section-7">7</a>. IANA Considerations ............................................<a href="#page-22">22</a>
   <a href="#section-8">8</a>. References .....................................................<a href="#page-22">22</a>
      <a href="#section-8.1">8.1</a>. Normative References ......................................<a href="#page-22">22</a>
      <a href="#section-8.2">8.2</a>. Informative References ....................................<a href="#page-22">22</a>
   <a href="#appendix-A">Appendix A</a>. Usage of MIKEY-DHHMAC in H.235 ........................<a href="#page-25">25</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   There is work done in IETF to develop key management schemes.  For
   example, IKE [<a href="#ref-12" title='"The Internet Key Exchange (IKE)"'>12</a>] is a widely accepted unicast scheme for IPsec, and
   the MSEC WG is developing other schemes, addressed to group
   communication [<a href="#ref-17" title='"The Group Domain of Interpretation"'>17</a>], [<a href="#ref-18" title='"GSAKMP: Group Secure Association Key Management Protocol"'>18</a>].  For reasons discussed below, there is,
   however, a need for a scheme with low latency, suitable for demanding
   cases such as real-time data over heterogeneous networks and small
   interactive groups.

   As pointed out in MIKEY (see [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>]), secure real-time multimedia
   applications demand a particular adequate lightweight key management
   scheme that takes care to establish dynamic session keys securely and
   efficiently in a conversational multimedia scenario.

   In general, MIKEY scenarios cover peer-to-peer, simple one-to-many,
   and small-sized groups.  MIKEY in particular describes three key




<span class="grey">Euchner                     Standards Track                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


   management schemes for the peer-to-peer case that all finish their
   task within one roundtrip:

   -  a symmetric key distribution protocol (MIKEY-PS) based on pre-
      shared master keys

   -  a public-key encryption-based key distribution protocol (MIKEY-PK
      and reverse-mode MIKEY-RSA-R [<a href="#ref-33" title='"An additional mode of key Distribution in MIKEY: MIKEY-RSA-R"'>33</a>]) assuming a public-key
      infrastructure with RSA-based (Rivest, Shamir and Adleman)
      private/public keys and digital certificates

   -  a Diffie-Hellman key agreement protocol (MIKEY-DHSIGN) deploying
      digital signatures and certificates.

   All of these three key management protocols are designed so that they
   complete their work within just one roundtrip.  This requires
   depending on loosely synchronized clocks and deploying timestamps
   within the key management protocols.

   However, it is known [<a href="#ref-6" title='"Handbook of Applied Cryptography"'>6</a>] that each of the three key management
   schemes has its subtle constraints and limitations:

   -  The symmetric key distribution protocol (MIKEY-PS) is simple to
      implement; however, it was not intended to scale to support any
      configurations beyond peer-to-peer, simple one-to-many, and
      small-size (interactive) groups, due to the need for mutually
      pre-assigned shared master secrets.

      Moreover, the security provided does not achieve the property of
      perfect forward secrecy; i.e., compromise of the shared master
      secret would render past and even future session keys susceptible
      to compromise.

      Further, the generation of the session key happens just at the
      initiator.  Thus, the responder has to fully trust the initiator
      to choose a good and secure session secret; the responder is able
      neither to participate in the key generation nor to influence that
      process.  This is considered a specific limitation in less trusted
      environments.

   -  The public-key encryption scheme (MIKEY-PK and MIKEY-RSA-R [<a href="#ref-33" title='"An additional mode of key Distribution in MIKEY: MIKEY-RSA-R"'>33</a>])
      depends upon a public-key infrastructure that certifies the
      private-public keys by issuing and maintaining digital
      certificates.  While such key management schemes provide full
      scalability in large networked configurations, public-key
      infrastructures are still not widely available, and, in general,
      implementations are significantly more complex.




<span class="grey">Euchner                     Standards Track                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


      Further, additional roundtrips and computational processing might
      be necessary for each end system in order to ascertain
      verification of the digital certificates.  For example, typical
      operations in the context of a public-key infrastructure may
      involve extra network communication handshakes with the public-key
      infrastructure and with certification authorities and may
      typically involve additional processing steps in the end systems.
      These operations would include validating digital certificates
      (<a href="rfc3029.html">RFC 3029</a>, [<a href="#ref-24" title='"Internet X.509 Public Key Infrastructure Data Validation and Certification Server Protocols"'>24</a>]), ascertaining the revocation status of digital
      certificates (<a href="rfc2560.html">RFC 2560</a>, [<a href="#ref-23" title='"X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP"'>23</a>]), asserting certificate policies,
      construction of certification path(s) ([<a href="#ref-26" title='"Internet X.509 Public Key Infrastructure: Certification Path Building"'>26</a>]), requesting and
      obtaining necessary certificates (<a href="rfc2511.html">RFC 2511</a>, [<a href="#ref-25" title='"Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)"'>25</a>]), and management
      of certificates for such purposes ([<a href="#ref-22" title='"Internet X.509 Public Key Infrastructure Certificate Management Protocol (CMP)"'>22</a>]).  Such steps and tasks
      all result in further delay of the key agreement or key
      establishment phase among the end systems, which negatively
      affects setup time.  Any extra PKI handshakes and processing are
      not in the scope of MIKEY, and since this document only deploys
      symmetric security mechanisms, aspects of PKI, digital
      certificates, and related processing are not further covered in
      this document.

      Finally, as in the symmetric case, the responder depends
      completely upon the initiator's choosing good and secure session
      keys.

   -  The third MIKEY-DHSIGN key management protocol deploys the
      Diffie-Hellman key agreement scheme and authenticates the exchange
      of the Diffie-Hellman half-keys in each direction by using a
      digital signature.  This approach has the same advantages and
      deficiencies as described in the previous section in terms of a
      public-key infrastructure.

      However, the Diffie-Hellman key agreement protocol is known for
      its subtle security strengths in that it is able to provide full
      perfect forward secrecy (PFS) and further have to both parties
      actively involved in session key generation.  This special
      security property (despite the somewhat higher computational
      costs) makes Diffie-Hellman techniques attractive in practice.

   In order to overcome some of the limitations as outlined above, a
   special need has been recognized for another efficient key agreement
   protocol variant in MIKEY.  This protocol variant aims to provide the
   capability of perfect forward secrecy as part of a key agreement with
   low latency without dependency on a public-key infrastructure.







<span class="grey">Euchner                     Standards Track                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


   This document describes a fourth lightweight key management scheme
   for MIKEY that could somehow be seen as a synergetic optimization
   between the pre-shared key distribution scheme and the Diffie-Hellman
   key agreement.

   The idea of the protocol in this document is to apply the Diffie-
   Hellman key agreement, but rather than deploy a digital signature for
   authenticity of the exchanged keying material, it instead uses a
   keyed-hash for symmetrically pre-assigned shared secrets.  This
   combination of security mechanisms is called the HMAC-authenticated
   Diffie-Hellman (DH) key agreement for MIKEY (DHHMAC).

   The DHHMAC variant closely follows the design and philosophy of MIKEY
   and reuses MIKEY protocol payload components and MIKEY mechanisms to
   its maximum benefit and for best compatibility.

   Like the MIKEY Diffie-Hellman protocol, DHHMAC does not scale beyond
   a point-to-point constellation; thus, both MIKEY Diffie-Hellman
   protocols do not support group-based keying for any group size larger
   than two entities.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Definitions"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Definitions</span>

   The definitions and notations in this document are aligned with
   MIKEY; see [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] sections <a href="#section-1.3">1.3</a> - <a href="#section-1.4">1.4</a>.

   All large integer computations in this document should be understood
   as being mod p within some fixed group G for some large prime p; see
   [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-3.3">section 3.3</a>.  However, the DHHMAC protocol is also applicable
   generally to other appropriate finite, cyclical groups as well.

   It is assumed that a pre-shared key s is known by both entities
   (initiator and responder).  The authentication key auth_key is
   derived from the pre-shared secret s using the pseudo-random function
   PRF; see [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] sections <a href="#section-4.1.3">4.1.3</a> and <a href="#section-4.1.5">4.1.5</a>.

   In this text, [X] represents an optional piece of information.
   Generally throughout the text, X SHOULD be present unless certain
   circumstances MAY allow X to be optional and not to be present,
   thereby potentially resulting in weaker security.  Likewise, [X, Y]
   represents an optional compound piece of information where the pieces
   X and Y either SHOULD both be present or MAY optionally both be
   absent.  {X} denotes zero or more occurrences of X.








<span class="grey">Euchner                     Standards Track                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Abbreviations"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Abbreviations</span>

   auth_key        Pre-shared authentication key, PRF-derived from
                   pre-shared key s.
   DH              Diffie-Hellman
   DHi             Public Diffie-Hellman half key g^(xi) of the
                   Initiator
   DHr             Public Diffie-Hellman half key g^(xr) of the
                   Responder
   DHHMAC          HMAC-authenticated Diffie-Hellman
   DoS             Denial-of-service
   G               Diffie-Hellman group
   HDR             MIKEY common header payload
   HMAC            Keyed Hash Message Authentication Code
   HMAC-SHA1       HMAC using SHA1 as hash function (160-bit result)
   IDi             Identity of initiator
   IDr             Identity of receiver
   IKE             Internet Key Exchange
   IPsec           Internet Protocol Security
   MIKEY           Multimedia Internet KEYing
   MIKEY-DHHMAC    MIKEY Diffie-Hellman key management protocol using
                   HMAC
   MIKEY-DHSIGN    MIKEY Diffie-Hellman key agreement protocol
   MIKEY-PK        MIKEY public-key encryption-based key distribution
                   protocol
   MIKEY-PS        MIKEY pre-shared key distribution protocol
   p               Diffie-Hellman prime modulus
   PKI             Public-key Infrastructure
   PRF             MIKEY pseudo-random function (see [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-4.1.3">section</a>
                   <a href="#section-4.1.3">4.1.3</a>)
   RSA             Rivest, Shamir, and Adleman
   s               Pre-shared key
   SDP             Session Description Protocol
   SOI             Son-of-IKE, IKEv2
   SP              MIKEY Security Policy (Parameter) Payload
   T               Timestamp
   TEK             Traffic Encryption Key
   TGK             MIKEY TEK Generation Key, as the common Diffie-
                   Hellman shared secret
   TLS             Transport Layer Security
   xi              Secret, (pseudo) random Diffie-Hellman key of the
                   Initiator
   xr              Secret, (pseudo) random Diffie-Hellman key of the
                   Responder







<span class="grey">Euchner                     Standards Track                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="#ref-1" title='"Key words for use in RFCs to Indicate Requirement Levels"'>1</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Scenario"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Scenario</span>

   The HMAC-authenticated Diffie-Hellman key agreement protocol (DHHMAC)
   for MIKEY addresses the same scenarios and scope as the other three
   key management schemes in MIKEY address.

   DHHMAC is applicable in a peer-to-peer group where no access to a
   public-key infrastructure can be assumed to be available.  Rather,
   pre- shared master secrets are assumed to be available among the
   entities in such an environment.

   In a pair-wise group, it is assumed that each client will be setting
   up a session key for its outgoing links with its peer using the DH-
   MAC key agreement protocol.

   As is the case for the other three MIKEY key management protocols,
   DHHMAC assumes, at least, loosely synchronized clocks among the
   entities in the small group.

   To synchronize the clocks in a secure manner, some operational or
   procedural means are recommended.  MIKEY-DHHMAC does not define any
   secure time synchronization measures; however, sections <a href="#section-5.4">5.4</a> and <a href="#section-9.3">9.3</a>
   of [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] provide implementation guidance on clock synchronization and
   timestamps.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Applicability"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Applicability</span>

   MIKEY-DHHMAC and the other MIKEY key management protocols are
   intended for application-level key management and are optimized for
   multimedia applications with real-time session setup and session
   management constraints.

   As the MIKEY-DHHMAC key management protocol terminates in one
   roundtrip, DHHMAC is applicable for integration into two-way
   handshake session or call signaling protocols such as

   a) SIP [<a href="#ref-13" title='"SIP: Session Initiation Protocol"'>13</a>] and SDP, where the encoded MIKEY messages are
      encapsulated and transported in SDP containers of the SDP
      offer/answer see <a href="rfc3264.html">RFC 3264</a> [<a href="#ref-27" title='"An Offer/Answer Model with Session Description Protocol (SDP)"'>27</a>]) handshake, as described in [<a href="#ref-4" title='"Key Management Extensions for Session Description Protocol (SDP) and Real Time Streaming Protocol (RTSP)"'>4</a>];
      and





<span class="grey">Euchner                     Standards Track                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


   b) H.323 (see [<a href="#ref-15" title='" H.323 Security framework: Usage of the MIKEY Key Management Protocol for the Secure Real Time Transport Protocol (SRTP) within H.235"'>15</a>]), where the encoded MIKEY messages are transported
      in the H.225.0 fast start call signaling handshake.  <a href="#appendix-A">Appendix A</a>
      outlines the usage of MIKEY-DHHMAC within H.235.

   MIKEY-DHHMAC is offered as an option to the other MIKEY key
   management variants (MIKEY-pre-shared, MIKEY-public-key and MIKEY-
   DH-SIGN) for all those cases where DHHMAC has its particular
   strengths (see <a href="#section-5">section 5</a>).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Relation%20to%20GKMARCH"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Relation to GKMARCH</span>

   The Group key management architecture (GKMARCH) [<a href="#ref-19" title='"Multicast Security (MSEC) Group Key Management Architecture"'>19</a>] describes a
   generic architecture for multicast security group key management
   protocols.  In the context of this architecture, MIKEY-DHHMAC may
   operate as a registration protocol; see also [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-2.4">section 2.4</a>.  The
   main entities involved in the architecture are a group controller/key
   server (GCKS), the receiver(s), and the sender(s).  Due to the pair-
   wise nature of the Diffie-Hellman operation and the 1-roundtrip
   constraint, usage of MIKEY-DHHMAC rules out any deployment as a group
   key management protocol with more than two group entities.  Only the
   degenerate case with two peers is possible where, for example, the
   responder acts as the group controller.

   Note that MIKEY does not provide re-keying in the GKMARCH sense, only
   updating of the keys by normal unicast messages.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20DHHMAC%20Security%20Protocol"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  DHHMAC Security Protocol</span>

   The following figure defines the security protocol for DHHMAC:

               Initiator                        Responder

   I_message = HDR, T, RAND, [IDi], IDr,
               {SP}, DHi, KEMAC
                    -----------------------&gt;   R_message = HDR, T,
                                                [IDr], IDi, DHr,
                                                DHi, KEMAC
                    &lt;----------------------


      Figure 1: HMAC-authenticated Diffie-Hellman key-based exchange,
        where xi and xr are (pseudo) randomly chosen, respectively,
                    by the initiator and the responder.

   The DHHMAC key exchange SHALL be done according to Figure 1.  The
   initiator chooses a (pseudo) random value, xi, and sends an HMACed
   message including g^(xi) and a timestamp to the responder.  It is
   recommended that the initiator SHOULD always include the identity



<span class="grey">Euchner                     Standards Track                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


   payloads IDi and IDr within the I_message; unless the receiver can
   defer the initiator's identity by some other means, IDi MAY
   optionally be omitted.  The initiator SHALL always include the
   recipient's identity.

   The group parameters (e.g., the group G) are a set of parameters
   chosen by the initiator.  Note that like in the MIKEY protocol, both
   sender and receiver explicitly transmit the Diffie-Hellman group G
   within the Diffie-Hellman payload DHi or DHr through an encoding
   (e.g., OAKLEY group numbering; see [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.4">section 6.4</a>).  The actual
   group parameters g and p, however, are not explicitly transmitted but
   can be deduced from the Diffie-Hellman group G.  The responder
   chooses a (pseudo) random positive integer, xr, and sends an HMACed
   message including g^(xr) and the timestamp to the initiator.  The
   responder SHALL always include the initiator's identity IDi
   regardless of whether the I_message conveyed any IDi.  It is
   RECOMMENDED that the responder SHOULD always include the identity
   payload IDr within the R_message; unless the initiator can defer the
   responder's identity by some other means, IDr MAY optionally be left
   out.

   Both parties then calculate the TGK as g^(xi * xr).

   The HMAC authentication provides authentication of the DH half-keys
   and is necessary to avoid man-in-the-middle attacks.

   This approach is less expensive than digitally signed Diffie-Hellman
   in that both sides compute one exponentiation and one HMAC first,
   then one HMAC verification, and finally another Diffie-Hellman
   exponentiation.

   With off-line pre-computation, the initial Diffie-Hellman half-key
   MAY be computed before the key management transaction and thereby MAY
   further reduce the overall roundtrip delay, as well as the risk of
   denial-of-service attacks.

   Processing of the TGK SHALL be accomplished as described in MIKEY [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>]
   <a href="#section-4">section 4</a>.

   The computed HMAC result SHALL be conveyed in the KEMAC payload field
   where the MAC fields holds the HMAC result.  The HMAC SHALL be
   computed over the entire message, excluding the MAC field using
   auth_key; see also <a href="#section-4.2">section 4.2</a>.








<span class="grey">Euchner                     Standards Track                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20TGK%20Re-keying"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  TGK Re-keying</span>

   TGK re-keying for DHHMAC generally proceeds as described in [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>]
   <a href="#section-4.5">section 4.5</a>.  Specifically, Figure 2 provides the message exchange
   for the DHHMAC update message.

               Initiator                        Responder

   I_message = HDR, T, [IDi], IDr,
               {SP}, [DHi], KEMAC
                    -----------------------&gt;   R_message = HDR, T,
                                                [IDr], IDi,
                                                [DHr, DHi], KEMAC
                    &lt;----------------------

                      Figure 2: DHHMAC update message

   TGK re-keying supports two procedures:

   a) True re-keying by exchanging new and fresh Diffie-Hellman half-
      keys.  For this, the initiator SHALL provide a new, fresh DHi, and
      the responder SHALL respond with a new, fresh DHr and the received
      DHi.

   b) Non-key related information update without including any Diffie-
      Hellman half-keys in the exchange.  Such a transaction does not
      change the actual TGK but updates other information such as
      security policy parameters.  To update the non-key related
      information only, [DHi] and [DHr, DHi] SHALL be left out.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20DHHMAC%20Payload%20Formats"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  DHHMAC Payload Formats</span>

   This section specifies the payload formats and data type values for
   DHHMAC; see also [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6">section 6</a>, for a definition of the MIKEY
   payloads.


   This document does not define new payload formats but re-uses MIKEY
   payloads for DHHMAC as referenced:

   * Common header payload (HDR); see <a href="#section-4.1">section 4.1</a> and [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.1">section 6.1</a>.

   * SRTP ID sub-payload; see [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.1.1">section 6.1.1</a>.

   * Key data transport payload (KEMAC); see <a href="#section-4.2">section 4.2</a> and [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.2">section</a>
     <a href="#section-6.2">6.2</a>.

   * DH data payload; see [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.4">section 6.4</a>.



<span class="grey">Euchner                     Standards Track                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


   * Timestamp payload; see [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.6">section 6.6</a>.

   * ID payload; [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.7">section 6.7</a>.

   * Security Policy payload (SP); see [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.10">section 6.10</a>.

   * RAND payload (RAND); see [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.11">section 6.11</a>.

   * Error payload (ERR); see [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.12">section 6.12</a>.

   * General Extension Payload; see [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.15">section 6.15</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Common%20Header%20Payload%20%28HDR%29"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Common Header Payload (HDR)</span>

   Referring to [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.1">section 6.1</a>, the following data types SHALL be used
   for DHHMAC:

      Data type     | Value | Comment
   -------------------------------------------------------------
      DHHMAC init   |     7 | Initiator's DHHMAC exchange message
      DHHMAC resp   |     8 | Responder's DHHMAC exchange message
      Error         |     6 | Error message; see [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.12">section 6.12</a>

                                Table 4.1.a

   Note: A responder is able to recognize the MIKEY DHHMAC protocol by
   evaluating the data type field as 7 or 8.  This is how the responder
   can differentiate between MIKEY and MIKEY DHHMAC.

   The next payload field SHALL be one of the following values:

   Next payload| Value |       Section
   ----------------------------------------------------------------
   Last payload|     0 | -
   KEMAC       |     1 | <a href="#section-4.2">section 4.2</a> and [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.2">section 6.2</a>
   DH          |     3 | [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.4">section 6.4</a>
   T           |     5 | [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.6">section 6.6</a>
   ID          |     6 | [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.7">section 6.7</a>
   SP          |    10 | [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.10">section 6.10</a>
   RAND        |    11 | [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.11">section 6.11</a>
   ERR         |    12 | [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.12">section 6.12</a>
   General Ext.|    21 | [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.15">section 6.15</a>

                                Table 4.1.b

   Other defined next payload values defined in [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] SHALL not be applied
   to DHHMAC.




<span class="grey">Euchner                     Standards Track                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


   In case of a decoding error or of a failed HMAC authentication
   verification, the responder SHALL apply the Error payload data type.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Key%20Data%20Transport%20Payload%20%28KEMAC%29"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Key Data Transport Payload (KEMAC)</span>

   DHHMAC SHALL apply this payload for conveying the HMAC result along
   with the indicated authentication algorithm.  When used in
   conjunction with DHHMAC, KEMAC SHALL not convey any encrypted data;
   thus, Encr alg SHALL be set to 2 (NULL), Encr data len SHALL be set
   to 0, and Encr data SHALL be left empty.  The AES key wrap method
   (see [<a href="#ref-16" title='"Advanced Encryption Standard (AES) Key Wrap Algorithm"'>16</a>]) SHALL not be applied for DHHMAC.

   For DHHMAC, this key data transport payload SHALL be the last payload
   in the message.  Note that the Next payload field SHALL be set to
   Last payload.  The HMAC is then calculated over the entire MIKEY
   message, excluding the MAC field using auth_key as described in [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>]
   <a href="#section-5.2">section 5.2</a>, and then stored within the MAC field.

      MAC alg       | Value |           Comments
   ------------------------------------------------------------------
      HMAC-SHA-1    |     0 | Mandatory, Default (see [<a href="#ref-3" title='"Secure Hash Standard"'>3</a>])
      NULL          |     1 | Very restricted use; see
                            | [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-4.2.4">section 4.2.4</a>

                                Table 4.2.a

   HMAC-SHA-1 is the default hash function that MUST be implemented as
   part of the DHHMAC.  The length of the HMAC-SHA-1 result is 160 bits.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20ID%20Payload%20%28ID%29"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  ID Payload (ID)</span>

   For DHHMAC, this payload SHALL only hold a non-certificate-based
   identity.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.4.%20%20General%20Extension%20Payload"></a><a class="selflink" href="#section-4.4" name="section-4.4">4.4</a>.  General Extension Payload</span>

   For DHHMAC, to avoid bidding-down attacks, this payload SHALL list
   all key management protocol identifiers of a surrounding
   encapsulation protocol, such as SDP [<a href="#ref-4" title='"Key Management Extensions for Session Description Protocol (SDP) and Real Time Streaming Protocol (RTSP)"'>4</a>].  The General Extension
   Payload SHALL be integrity protected with the HMAC using the shared
   secret.

   Type      | Value | Comments
   SDP IDs   |     1 | List of SDP key management IDs (allocated for
                       use in [<a href="#ref-4" title='"Key Management Extensions for Session Description Protocol (SDP) and Real Time Streaming Protocol (RTSP)"'>4</a>]); see also [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-6.15">section 6.15</a>.

                                Table 4.4.a




<span class="grey">Euchner                     Standards Track                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Security%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Security Considerations</span>

   This document addresses key management security issues throughout.
   For a comprehensive explanation of MIKEY security considerations,
   please refer to MIKEY [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-9">section 9</a>.

   In addition, this document addresses security issues according to
   [<a href="#ref-7" title='"Guidelines for Writing RFC Text on Security Considerations"'>7</a>], where the following security considerations apply in particular
   to this document:

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Security%20Environment"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Security Environment</span>

   The DHHMAC security protocol described in this document focuses
   primarily on communication security; i.e., the security issues
   concerned with the MIKEY DHHMAC protocol.  Nevertheless, some system
   security issues are also of interest that are not explicitly defined
   by the DHHMAC protocol, but that should be provided locally in
   practice.

   The system that runs the DHHMAC protocol entity SHALL provide the
   capability to generate (pseudo) random numbers as input to the
   Diffie-Hellman operation (see [<a href="#ref-8" title='"Randomness Recommendations for Security"'>8</a>]).  Furthermore, the system SHALL be
   capable of storing the generated (pseudo) random data, secret data,
   keys, and other secret security parameters securely (i.e.,
   confidential and safe from unauthorized tampering).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Threat%20Model"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Threat Model</span>

   The threat model, to which this document adheres, covers the issues
   of end-to-end security in the Internet generally, without ruling out
   the possibility that MIKEY DHHMAC can be deployed in a corporate,
   closed IP environment.  This also includes the possibility that MIKEY
   DHHMAC can be deployed on a hop-by-hop basis with some intermediate
   trusted "MIKEY DHHMAC proxies" involved.

   Since DHHMAC is a key management protocol, the following security
   threats are of concern:

   * Unauthorized interception of plain TGKs: For DHHMAC, this threat
     does not occur since the TGK is not actually transmitted on the
     wire (not even in encrypted fashion).

   * Eavesdropping of other, transmitted keying information: DHHMAC
     protocol does not explicitly transmit the TGK at all.  Instead, by
     using the Diffie-Hellman "encryption" operation, which conceals the
     secret (pseudo) random values, only partial information (i.e., the
     DH half-key) for construction of the TGK is transmitted.  It is
     fundamentally assumed that availability of such Diffie-Hellman



<span class="grey">Euchner                     Standards Track                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


     half-keys to an eavesdropper does not result in any substantial
     security risk; see 5.4.  Furthermore, the DHHMAC carries other data
     such as timestamps, (pseudo) random values, identification
     information or security policy parameters; eavesdropping of any
     such data is not considered to yield any significant security risk.

   * Masquerade of either entity: This security threat must be avoided,
     and if a masquerade attack would be attempted, appropriate
     detection means must be in place.  DHHMAC addresses this threat by
     providing mutual peer entity authentication.

   * Man-in-the-middle attacks: Such attacks threaten the security of
     exchanged, non-authenticated messages.  Man-in-the-middle attacks
     usually come with masquerade and or loss of message integrity (see
     below).  Man-in-the-middle attacks must be avoided and, if present
     or attempted, must be detected appropriately.  DHHMAC addresses
     this threat by providing mutual peer entity authentication and
     message integrity.

   * Loss of integrity: This security threat relates to unauthorized
     replay, deletion, insertion, and manipulation of messages.
     Although any such attacks cannot be avoided, they must at least be
     detected.  DHHMAC addresses this threat by providing message
     integrity.

   * Bidding-down attacks: When multiple key management protocols, each
     of a distinct security level, are offered (such as those made
     possible by SDP [<a href="#ref-4" title='"Key Management Extensions for Session Description Protocol (SDP) and Real Time Streaming Protocol (RTSP)"'>4</a>]), avoiding bidding-down attacks is of concern.
     DHHMAC addresses this threat by reusing the MIKEY General Extension
     Payload mechanism, where all key management protocol identifiers
     are to be listed within the MIKEY General Extension Payload.

   Some potential threats are not within the scope of this threat model:

   * Passive and off-line cryptanalysis of the Diffie-Hellman algorithm:
     Under certain reasonable assumptions (see 5.4, below), it is widely
     believed that DHHMAC is sufficiently secure and that such attacks
     are infeasible, although the possibility of a successful attack
     cannot be ruled out.

   * Non-repudiation of the receipt or of the origin of the message:
     These are not requirements within the context of DHHMAC in this
     environment, and thus related countermeasures are not provided at
     all.







<span class="grey">Euchner                     Standards Track                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


   * Denial-of-service or distributed denial-of-service attacks: Some
     considerations are given on some of those attacks, but DHHMAC does
     not claim to provide full countermeasure against any of those
     attacks.  For example, stressing the availability of the entities
     is not thwarted by means of the key management protocol; some other
     local countermeasures should be applied.  Further, some DoS attacks
     are not countered, such as interception of a valid DH- request and
     its massive instant duplication.  Such attacks might at least be
     countered partially by some local means that are outside the scope
     of this document.

   * Identity protection: Like MIKEY, identity protection is not a major
     design requirement for MIKEY-DHHMAC, either; see [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>].  No security
     protocol is known so far that is able to provide the objectives of
     DHHMAC as stated in <a href="#section-5.3">section 5.3</a>, including identity protection
     within just a single roundtrip.  MIKEY-DHHMAC trades identity
     protection for better security for the keying material and shorter
     roundtrip time.  Thus, MIKEY-DHHMAC does not provide identity
     protection on its own but may inherit such property from a security
     protocol underneath that actually features identity protection.

     The DHHMAC security protocol (see <a href="#section-3">section 3</a>) and the TGK re-keying
     security protocol (see <a href="#section-3.1">section 3.1</a>) provide the option not to
     supply identity information.  This option is only applicable if
     some other means are available to supply trustworthy identity
     information; e.g., by relying on secured links underneath MIKEY
     that supply trustworthy identity information some other way.
     However, it is understood that without identity information, the
     MIKEY key management security protocols might be subject to
     security weaknesses such as masquerade, impersonation, and
     reflection attacks, particularly in end-to-end scenarios where no
     other secure means of assured identity information are provided.

     Leaving identity fields optional (if doing so is possible) thus
     should not be seen as a privacy method, either, but rather as a
     protocol optimization feature.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Security%20Features%20and%20Properties"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Security Features and Properties</span>

   With the security threats in mind, this document provides the
   following security features and yields the following properties:

   * Secure key agreement with the establishment of a TGK at both peers:
     This is achieved using an authenticated Diffie-Hellman key
     management protocol.






<span class="grey">Euchner                     Standards Track                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


   * Peer-entity authentication (mutual): This authentication
     corroborates that the host/user is authentic in that possession of
     a pre-assigned secret key is proven using keyed HMAC.
     Authentication occurs on the request and on the response message;
     thus authentication is mutual.

     The HMAC computation corroborates for authentication and message
     integrity of the exchanged Diffie-Hellman half-keys and associated
     messages.  The authentication is absolutely necessary in order to
     avoid man-in-the-middle attacks on the exchanged messages in
     transit and, in particular, on the otherwise non-authenticated
     exchanged Diffie-Hellman half-keys.

     Note: This document does not address issues regarding
     authorization; this feature is not provided explicitly.  However,
     DHHMAC authentication means support and facilitate realization of
     authorization means (local issue).

   * Cryptographic integrity check: The cryptographic integrity check is
     achieved using a message digest (keyed HMAC).  It includes the
     exchanged Diffie-Hellman half-keys but covers the other parts of
     the exchanged message as well.  Both mutual peer entity
     authentication and message integrity provide effective
     countermeasures against man-in-the-middle attacks.

     The initiator may deploy a local timer that fires when the awaited
     response message did not arrive in a timely manner.  This is
     intended to detect deletion of entire messages.

   * Replay protection of the messages is achieved using embedded
     timestamps: In order to detect replayed messages, it is essential
     that the clocks among initiator and sender be roughly synchronized.
     The reader is referred to [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-5.4">section 5.4</a>, and [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] <a href="#section-9.3">section 9.3</a>,
     which provide further considerations and give guidance on clock
     synchronization and timestamp usage.  Should the clock
     synchronization be lost, end systems cannot detect replayed
     messages anymore, and the end systems cannot securely establish
     keying material.  This may result in a denial-of-service; see [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>]
     <a href="#section-9.5">section 9.5</a>.

   * Limited DoS protection: Rapid checking of the message digest allows
     verifying the authenticity and integrity of a message before
     launching CPU intensive Diffie-Hellman operations or starting other
     resource consuming tasks.  This protects against some denial-of-
     service attacks: malicious modification of messages and spam
     attacks with (replayed or masqueraded) messages.  DHHMAC probably
     does not explicitly counter sophisticated distributed, large-scale
     denial-of-service attacks that compromise system availability, for



<span class="grey">Euchner                     Standards Track                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


     example.  Some DoS protection is provided by inclusion of the
     initiator's identity payload in the I_message.  This allows the
     recipient to filter out those (replayed) I_messages that are not
     targeted for him and to avoid creating unnecessary MIKEY sessions.

   * Perfect-forward secrecy (PFS): Other than the MIKEY pre-shared and
     public-key-based key distribution protocols, the Diffie-Hellman key
     agreement protocol features a security property called perfect
     forward secrecy.  That is, even if the long-term pre-shared key is
     compromised at some point in time, this does not compromise past or
     future session keys.

     Neither the MIKEY pre-shared nor the MIKEY public-key protocol
     variants are able to provide the security property of perfect-
     forward secrecy.  Thus, none of the other MIKEY protocols is able
     to substitute the Diffie-Hellman PFS property.

     As such, DHHMAC and digitally signed DH provide a far superior
     security level to that of the pre-shared or public-key-based key
     distribution protocol in that respect.

   * Fair, mutual key contribution: The Diffie-Hellman key management
     protocol is not a strict key distribution protocol per se, in which
     the initiator distributes a key to its peers.  Actually, both
     parties involved in the protocol exchange are able to contribute to
     the common Diffie-Hellman TEK traffic generating key equally.  This
     reduces the risk of either party cheating or unintentionally
     generating a weak session key.  This makes the DHHMAC a fair key
     agreement protocol.  One may view this property as an additional
     distributed security measure that increases security robustness
     over that of the case where all the security depends just on the
     proper implementation of a single entity.

     For Diffie-Hellman key agreement to be secure, each party SHALL
     generate its xi or xr values using a strong, unpredictable pseudo-
     random generator if a source of true randomness is not available.
     Further, these values xi or xr SHALL be kept private.  It is
     RECOMMENDED that these secret values be destroyed once the common
     Diffie-Hellman shared secret key has been established.

   * Efficiency and performance: Like the MIKEY-public key protocol, the
     MIKEY DHHMAC key agreement protocol securely establishes a TGK
     within just one roundtrip.  Other existing key management
     techniques, such as IPsec-IKE [<a href="#ref-12" title='"The Internet Key Exchange (IKE)"'>12</a>], IPsec-IKEv2 [<a href="#ref-14" title='"Internet Key Exchange (IKEv2) Protocol"'>14</a>], TLS [<a href="#ref-11" title='"The Transport Layer Security (TLS) Protocol Version 1.1"'>11</a>], and
     other schemes, are not deemed adequate in addressing those real-
     time and security requirements sufficiently; they all use more than
     a single roundtrip.  All the MIKEY key management protocols are
     able to complete their task of security policy parameter



<span class="grey">Euchner                     Standards Track                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


     negotiation, including key-agreement or key distribution, in one
     roundtrip.  However, the MIKEY pre-shared and MIKEY public-key
     protocol are both able to complete their task even in a half-
     roundtrip when the confirmation messages are omitted.

     Using HMAC in conjunction with a strong one-way hash function (such
     as SHA1) may be achieved more efficiently in software than
     expensive public-key operations.  This yields a particular
     performance benefit of DHHMAC over signed DH or the public-key
     encryption protocol.

     If a very high security level is desired for long-term secrecy of
     the negotiated Diffie-Hellman shared secret, longer hash values may
     be deployed, such as SHA256, SHA384, or SHA512 provide, possibly in
     conjunction with stronger Diffie-Hellman groups.  This is left as
     for further study.

     For the sake of improved performance and reduced roundtrip delay,
     either party may  pre-compute its public Diffie-Hellman half-key
     off-line.

     On the other side and under reasonable conditions, DHHMAC consumes
     more CPU cycles than the MIKEY pre-shared key distribution
     protocol.  The same might hold true quite likely for the MIKEY
     public-key distribution protocol (depending on choice of the
     private and public key lengths).  As such, it can be said that
     DHHMAC provides sound performance when compared with the other
     MIKEY protocol variants.

     The use of optional identity information (with the constraints
     stated in <a href="#section-5.2">section 5.2</a>) and optional Diffie-Hellman half-key fields
     provides a means to increase performance and shorten the consumed
     network bandwidth.

   * Security infrastructure: This document describes the HMAC-
     authenticated Diffie-Hellman key agreement protocol, which
     completely avoids digital signatures and the associated public-key
     infrastructure, as would be necessary for the X.509 RSA public-
     key-based key distribution protocol or the digitally signed
     Diffie-Hellman key agreement protocol as described in MIKEY.
     Public-key infrastructures may not always be available in certain
     environments, nor may they be deemed adequate for real-time
     multimedia applications when additional steps are taken for
     certificate validation and certificate revocation methods with
     additional roundtrips into account.






<span class="grey">Euchner                     Standards Track                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


     DHHMAC does not depend on PKI, nor do implementations require PKI
     standards.  Thus, it is believed to be much simpler than the more
     complex PKI facilities.

     DHHMAC is particularly attractive in those environments where
     provisioning of a pre-shared key has already been accomplished.

   * NAT-friendliness: DHHMAC is able to operate smoothly through
     firewall/NAT devices as long as the protected identity information
     of the end entity is not an IP/transport address.

   * Scalability: Like the MIKEY signed Diffie-Hellman protocol, DHHMAC
     does not scale to any larger configurations beyond peer-to-peer
     groups.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20Assumptions"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  Assumptions</span>

   This document states a couple of assumptions upon which the security
   of DHHMAC significantly depends.  The following conditions are
   assumed:

   * The parameters xi, xr, s, and auth_key are to be kept secret.

   * The pre-shared key s has sufficient entropy and cannot be
     effectively guessed.

   * The pseudo-random function (PRF) is secure, yields the pseudo-
     random property, and maintains the entropy.

   * A sufficiently large and secure Diffie-Hellman group is applied.

   * The Diffie-Hellman assumption holds saying basically that even with
     knowledge of the exchanged Diffie-Hellman half-keys and knowledge
     of the Diffie-Hellman group, it is infeasible to compute the TGK or
     to derive the secret parameters xi or xr.  The latter is also
     called the discrete logarithm assumption.  Please see [<a href="#ref-6" title='"Handbook of Applied Cryptography"'>6</a>], [<a href="#ref-9" title='"The Diffie-Hellman Protocol"'>9</a>], or
     [<a href="#ref-10">10</a>] for more background information regarding the Diffie-Hellman
     problem and its computational complexity assumptions.

   * The hash function (SHA1) is secure; i.e., it is computationally
     infeasible to find a message that corresponds to a given message
     digest, or to find two different messages that produce the same
     message digest.

   * The HMAC algorithm is secure and does not leak the auth_key.  In
     particular, the security depends on the message authentication
     property of the compression function of the hash function H when it
     is applied to single blocks (see [<a href="#ref-5" title='"HMAC: Keyed-Hashing for Message Authentication"'>5</a>]).



<span class="grey">Euchner                     Standards Track                    [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


   * A source capable of producing sufficiently many bits of (pseudo)
     randomness is available.

   * The system upon which DHHMAC runs is sufficiently secure.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.5.%20%20Residual%20Risk"></a><a class="selflink" href="#section-5.5" name="section-5.5">5.5</a>.  Residual Risk</span>

   Although these detailed assumptions are non-negligible, security
   experts generally believe that all these assumptions are reasonable
   and that the assumptions made can be fulfilled in practice with
   little or no expenses.

   The mathematical and cryptographic assumptions of the properties of
   the PRF, the Diffie-Hellman algorithm (discrete log-assumption), the
   HMAC algorithm, and the SHA1 algorithms have been neither proven nor
   disproven at this time.

   Thus, a certain residual risk remains, which might threaten the
   overall security at some unforeseeable time in the future.

   The DHHMAC would be compromised as soon as any of the listed
   assumptions no longer hold.

   The Diffie-Hellman mechanism is a generic security technique that is
   not only applicable to groups of prime order or of characteristic
   two.  This is because of the fundamental mathematical assumption that
   the discrete logarithm problem is also a very hard one in general
   groups.  This enables Diffie-Hellman to be deployed also for GF(p)*,
   for sub-groups of sufficient size, and for groups upon elliptic
   curves.  RSA does not allow such generalization, as the core
   mathematical problem is a different one (large integer
   factorization).

   RSA asymmetric keys tend to become increasingly lengthy (1536 bits
   and more) and thus very computationally intensive.  Nevertheless,
   Elliptic Curve Diffie-Hellman (ECDH) allows key lengths to be cut
   down substantially (say 170 bits or more) while maintaining at least
   the security level and providing even more significant performance
   benefits in practice.  Moreover, it is believed that elliptic-curve
   techniques provide much better protection against side channel
   attacks due to the inherent redundancy in the projective coordinates.
   For all these reasons, one may view elliptic-curve-based Diffie-
   Hellman as being more "future-proof" and robust against potential
   threats than RSA is.  Note that Elliptic Curve Diffie-Hellman
   variants of MIKEY are defined in [<a href="#ref-31" title='"ECC Algorithms For MIKEY"'>31</a>].






<span class="grey">Euchner                     Standards Track                    [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


   HMAC-SHA1 is a key security mechanism within DHHMAC on which the
   overall security of MIKEY DHHMAC depends.  MIKEY DHHMAC uses HMAC-
   SHA1 in combination with the classic Diffie-Hellman key agreement
   scheme.  HMAC-SHA1 is a keyed one-way hash function that involves a
   secret in its computation.  DHHMAC applies HMAC-SHA1 for protection
   of the MIKEY payload.  Likewise, the pseudo-random function PRF
   within MIKEY [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] uses the HMAC-SHA1 mechanism as a key derivation
   function.  While certain attacks have been reported against SHA1 and
   MD5 (see [<a href="#ref-29" title='"Attacks on Cryptographic Hashes in Internet Protocols"'>29</a>]), with current knowledge (see [<a href="#ref-29" title='"Attacks on Cryptographic Hashes in Internet Protocols"'>29</a>], [<a href="#ref-30" title='"Deploying a New Hash Algorithm"'>30</a>]), no attacks
   have been reported against the HMAC-SHA1 security mechanism.  In
   fact, [<a href="#ref-32" title='"New Proofs for NMAC and HMAC: Security Without Collision-Resistance"'>32</a>] proves that HMAC possesses the property of a pseudo-random
   function PRF assuming solely that the (SHA1) hash function is a
   pseudo-random function. [<a href="#ref-32" title='"New Proofs for NMAC and HMAC: Security Without Collision-Resistance"'>32</a>] also provides evidence that HMAC is
   robust against collision attacks on the underlying hash function.  It
   is believed that MIKEY DHHMAC should be considered secure enough for
   the time being.  Thus, there is no need to change the underlying
   security mechanism within the MIKEY DHHMAC protocol.

   It is not recommended to deploy DHHMAC for any other use than that
   depicted in <a href="#section-2">section 2</a>.  Any misapplication might lead to unknown,
   undefined properties.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.6.%20%20Authorization%20and%20Trust%20Model"></a><a class="selflink" href="#section-5.6" name="section-5.6">5.6</a>.  Authorization and Trust Model</span>

   Basically, similar remarks on authorization as those stated in [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>]
   <a href="#section-4.3.2">section 4.3.2</a> hold also for DHHMAC.  However, as noted before, this
   key management protocol does not serve full groups.

   One may view the pre-established shared secret as yielding some pre-
   established trust relationship between the initiator and the
   responder.  This results in a much simpler trust model for DHHMAC
   than would be the case for some generic group key management protocol
   and potential group entities without any pre-defined trust
   relationship.  In conjunction with the assumption of a shared key,
   the common group controller simplifies the communication setup of the
   entities.

   One may view the pre-established trust relationship through the pre-
   shared secret as some means for pre-granted, implied authorization.
   This document does not define any particular authorization means but
   leaves this subject to the application.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Acknowledgments"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Acknowledgments</span>

   This document incorporates kindly, valuable review feedback from
   Steffen Fries, Hannes Tschofenig, Fredrick Lindholm, Mary Barnes, and
   Russell Housley and general feedback by the MSEC WG.




<span class="grey">Euchner                     Standards Track                    [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  IANA Considerations</span>

   This document does not define its own new name spaces for DHHMAC,
   beyond the IANA name spaces that have been assigned for MIKEY; see
   [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>] sections <a href="#section-10">10</a> and <a href="#section-10.1">10.1</a> and IANA MIKEY payload name spaces [<a href="#ref-37">37</a>].

   In order to align Table 4.1.a with Table 6.1.a in [<a href="#ref-2" title='"MIKEY: Multimedia Internet KEYing"'>2</a>], IANA is
   requested to add the following entries to their MIKEY Payload Name
   Space:

   Data Type        Value  Reference
   ---------------  -----  ---------
   DHHMAC init          7  <a href="rfc4650.html">RFC 4650</a>
   DHHMAC resp          8  <a href="rfc4650.html">RFC 4650</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20References"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Normative%20References"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Normative References</span>

   [<a id="ref-1" name="ref-1">1</a>]   Bradner, S., "Key words for use in RFCs to Indicate Requirement
         Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-2" name="ref-2">2</a>]   Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K.
         Norrman, "MIKEY: Multimedia Internet KEYing", <a href="rfc3830.html">RFC 3830</a>, August
         2004.

   [<a id="ref-3" name="ref-3">3</a>]   NIST, FIBS-PUB 180-2, "Secure Hash Standard", April 1995,
         <a href="http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf">http://csrc.nist.gov/publications/fips/fips180-2/</a>
         <a href="http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf">fips180-2withchangenotice.pdf</a>.

   [<a id="ref-4" name="ref-4">4</a>]   Arkko, J., Lindholm, F., Naslund, M., Norrman, K., and E.
         Carrara, "Key Management Extensions for Session Description
         Protocol (SDP) and Real Time Streaming Protocol (RTSP)", <a href="rfc4567.html">RFC</a>
         <a href="rfc4567.html">4567</a>, July 2006.

   [<a id="ref-5" name="ref-5">5</a>]   Krawczyk, H., Bellare, M., and R. Canetti, "HMAC: Keyed-Hashing
         for Message Authentication", <a href="rfc2104.html">RFC 2104</a>, February 1997.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Informative%20References"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Informative References</span>

   [<a id="ref-6" name="ref-6">6</a>]   A.J. Menezes, P. van Oorschot, S. A. Vanstone: "Handbook of
         Applied Cryptography", CRC Press 1996.

   [<a id="ref-7" name="ref-7">7</a>]   Rescorla, E. and B. Korver, "Guidelines for Writing RFC Text on
         Security Considerations", <a href="https://tools.ietf.org/html/bcp72">BCP 72</a>, <a href="rfc3552.html">RFC 3552</a>, July 2003.

   [<a id="ref-8" name="ref-8">8</a>]   Eastlake 3rd, D., Crocker, S., and J. Schiller, "Randomness
         Recommendations for Security", <a href="rfc1750.html">RFC 1750</a>, December 1994.



<span class="grey">Euchner                     Standards Track                    [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


   [<a id="ref-9" name="ref-9">9</a>]   Ueli M. Maurer, S. Wolf: "The Diffie-Hellman Protocol",
         Designs, Codes, and Cryptography, Special Issue Public Key
         Cryptography, Kluwer Academic Publishers, vol. 19, pp. 147-171,
         2000.
         <a href="ftp://ftp.inf.ethz.ch/pub/crypto/publications/MauWol00c.ps">ftp://ftp.inf.ethz.ch/pub/crypto/publications/MauWol00c.ps</a>.

   [<a id="ref-10" name="ref-10">10</a>]  Discrete Logarithms and the Diffie-Hellman Protocol,
         <a href="http://www.crypto.ethz.ch/research/ntc/dldh/">http://www.crypto.ethz.ch/research/ntc/dldh/</a>.

   [<a id="ref-11" name="ref-11">11</a>]  Dierks, T. and E. Rescorla, "The Transport Layer Security (TLS)
         Protocol Version 1.1", <a href="rfc4346.html">RFC 4346</a>, April 2006.

   [<a id="ref-12" name="ref-12">12</a>]  Harkins, D. and D. Carrel, "The Internet Key Exchange (IKE)",
         <a href="rfc2409.html">RFC 2409</a>, November 1998.

   [<a id="ref-13" name="ref-13">13</a>]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A.,
         Peterson, J., Sparks, R., Handley, M., and E. Schooler, "SIP:
         Session Initiation Protocol", <a href="rfc3261.html">RFC 3261</a>, June 2002.

   [<a id="ref-14" name="ref-14">14</a>]  Kaufman, C., "Internet Key Exchange (IKEv2) Protocol", <a href="rfc4306.html">RFC</a>
         <a href="rfc4306.html">4306</a>, December 2005.

   [<a id="ref-15" name="ref-15">15</a>]  ITU-T Recommendation H.235.7: " H.323 Security framework: Usage
         of the MIKEY Key Management Protocol for the Secure Real Time
         Transport Protocol (SRTP) within H.235"; 9/2005.

   [<a id="ref-16" name="ref-16">16</a>]  Schaad, J. and R. Housley, "Advanced Encryption Standard (AES)
         Key Wrap Algorithm", <a href="rfc3394.html">RFC 3394</a>, September 2002.

   [<a id="ref-17" name="ref-17">17</a>]  Baugher, M., Weis, B., Hardjono, T., and H. Harney, "The Group
         Domain of Interpretation", <a href="rfc3547.html">RFC 3547</a>, July 2003.

   [<a id="ref-18" name="ref-18">18</a>]  Harney, H., Meth, U., Colegrove, A., and G. Gross, "GSAKMP:
         Group Secure Association Key Management Protocol", <a href="rfc4535.html">RFC 4535</a>,
         June 2006.

   [<a id="ref-19" name="ref-19">19</a>]  Baugher, M., Canetti, R., Dondeti, L., and F. Lindholm,
         "Multicast Security (MSEC) Group Key Management Architecture",
         <a href="rfc4046.html">RFC 4046</a>, April 2005.

   [<a id="ref-20" name="ref-20">20</a>]  Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K.
         Norrman, "The Secure Real-time Transport Protocol (SRTP)", <a href="rfc3711.html">RFC</a>
         <a href="rfc3711.html">3711</a>, March 2004.

   [<a id="ref-21" name="ref-21">21</a>]  ITU-T Recommendation H.235.0, " H.323 Security framework:
         Security framework for H-series (H.323 and other H.245 based)
         multimedia systems", (09/2005).




<span class="grey">Euchner                     Standards Track                    [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


   [<a id="ref-22" name="ref-22">22</a>]  Adams, C., Farrell, S., Kause, T., and T. Mononen, "Internet
         X.509 Public Key Infrastructure Certificate Management Protocol
         (CMP)", <a href="rfc4210.html">RFC 4210</a>, September 2005.

   [<a id="ref-23" name="ref-23">23</a>]  Myers, M., Ankney, R., Malpani, A., Galperin, S., and C. Adams,
         "X.509 Internet Public Key Infrastructure Online Certificate
         Status Protocol - OCSP", <a href="rfc2560.html">RFC 2560</a>, June 1999.

   [<a id="ref-24" name="ref-24">24</a>]  Adams, C., Sylvester, P., Zolotarev, M., and R. Zuccherato,
         "Internet X.509 Public Key Infrastructure Data Validation and
         Certification Server Protocols", <a href="rfc3029.html">RFC 3029</a>, February 2001.

   [<a id="ref-25" name="ref-25">25</a>]  Schaad, J., "Internet X.509 Public Key Infrastructure
         Certificate Request Message Format (CRMF)", <a href="rfc4211.html">RFC 4211</a>, September
         2005.

   [<a id="ref-26" name="ref-26">26</a>]  Cooper, M., Dzambasow, Y., Hesse, P., Joseph, S., and R.
         Nicholas, "Internet X.509 Public Key Infrastructure:
         Certification Path Building", <a href="rfc4158.html">RFC 4158</a>, September 2005.

   [<a id="ref-27" name="ref-27">27</a>]  Rosenberg, J. and H. Schulzrinne, "An Offer/Answer Model with
         Session Description Protocol (SDP)", <a href="rfc3264.html">RFC 3264</a>, June 2002.

   [<a id="ref-37" name="ref-37">37</a>]  IANA MIKEY Payload Name Spaces per <a href="rfc3830.html">RFC 3830</a>, see
         <a href="http://www.iana.org/assignments/mikey-payloads">http://www.iana.org/assignments/mikey-payloads</a>.

   [<a id="ref-29" name="ref-29">29</a>]  Hoffman, P. and B. Schneier, "Attacks on Cryptographic Hashes
         in Internet Protocols", <a href="rfc4270.html">RFC 4270</a>, November 2005.

   [<a id="ref-30" name="ref-30">30</a>]  Bellovin, S.M. and E.K. Rescorla: "Deploying a New Hash
         Algorithm", October 2005,
         <a href="http://www.cs.columbia.edu/~smb/papers/new-hash.pdf">http://www.cs.columbia.edu/~smb/papers/new-hash.pdf</a>.

   [<a id="ref-31" name="ref-31">31</a>]  Milne, A., Blaser, M., Brown, D., and L. Dondetti, "ECC
         Algorithms For MIKEY", Work in Progress, June 2005.

   [<a id="ref-32" name="ref-32">32</a>]  Bellare, M.: "New Proofs for NMAC and HMAC: Security Without
         Collision-Resistance", <a href="http://eprint.iacr.org/2006/043.pdf">http://eprint.iacr.org/2006/043.pdf</a>,
         November 2005.

   [<a id="ref-33" name="ref-33">33</a>]  Ignjatic, D., Dondeti, L., Audet, F., and P. Lin, "An
         additional mode of key Distribution in MIKEY: MIKEY-RSA-R",
         Work in Progress, August 2006.








<span class="grey">Euchner                     Standards Track                    [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Usage%20of%20MIKEY-DHHMAC%20in%20H.235"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Usage of MIKEY-DHHMAC in H.235</span>

   This appendix provides informative overview how MIKEY-DHHMAC can be
   applied in some H.323-based multimedia environments.  Generally,
   MIKEY is applicable for multimedia applications including IP
   telephony.  [<a href="#ref-15" title='" H.323 Security framework: Usage of the MIKEY Key Management Protocol for the Secure Real Time Transport Protocol (SRTP) within H.235"'>15</a>] describes various use cases of the MIKEY key
   management protocols (MIKEY-PS, MIKEY-PK, MIKEY-DHSIGN and MIKEY-
   DHHMAC) with the purpose to establish TGK keying material among H.323
   endpoints.  The TGKs are then used for media encryption by applying
   SRTP [<a href="#ref-20" title='"The Secure Real-time Transport Protocol (SRTP)"'>20</a>].  Addressed scenarios include point-to-point with one or
   more intermediate gatekeepers (trusted or partially trusted) in
   between.

   One particular use case addresses MIKEY-DHHMAC to establish a media
   connection from an endpoint B calling (through a gatekeeper) to
   another endpoint A that is located within that same gatekeeper zone.
   While EP-A and EP-B typically do not share any auth_key a priori,
   some separate protocol exchange means are achieved outside the actual
   call setup procedure to establish an auth_key for the time while
   endpoints are being registered with the gatekeeper; such protocols
   exist [<a href="#ref-15" title='" H.323 Security framework: Usage of the MIKEY Key Management Protocol for the Secure Real Time Transport Protocol (SRTP) within H.235"'>15</a>] but are not shown in this document.  The auth_key between
   the endpoints is being used to authenticate and integrity protect the
   MIKEY-DHHMAC messages.

   To establish a call, it is assumed that endpoint B has obtained
   permission from the gatekeeper (not shown).  Endpoint B as the caller
   builds the MIKEY-DHHMAC I_message (see <a href="#section-3">section 3</a>) and sends the
   I_message encapsulated within the H.323-SETUP to endpoint A.  A
   routing gatekeeper (GK) would forward this message to endpoint B; in
   case of a non-routing gatekeeper, endpoint B sends the SETUP directly
   to endpoint A.  In either case, H.323 inherent security mechanisms
   [<a href="#ref-21" title='" H.323 Security framework: Security framework for H-series (H.323 and other H.245 based) multimedia systems"'>21</a>] are applied to protect the (encapsulation) message during
   transfer.  This is not depicted here.  The receiving endpoint A is
   able to verify the conveyed I_message and can compute a TGK.
   Assuming that endpoint A would accept the call, EP-A then builds the
   MIKEY-DHHMAC R_message and sends the response as part of the
   CallProceeding-to-Connect message back to the calling endpoint B
   (possibly through a routing gatekeeper).  Endpoint B processes the
   conveyed R_message to compute the same TGK as the called endpoint A.

   1.) EP-B -&gt; (GK) -&gt; EP-A: SETUP(I_fwd_message [, I_rev_message])
   2.) EP-A -&gt; (GK) -&gt; EP-B: CallProceeding-to-CONNECT(R_fwd_message
       [, R_rev_message])

   Notes: If it is necessary to establish directional TGKs for full-
          duplex links in both directions B-&gt;A and A-&gt;B, then the
          calling endpoint B instantiates the DHHMAC protocol twice:
          once in the direction B-&gt;A using I_fwd_message and another run



<span class="grey">Euchner                     Standards Track                    [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


          in parallel in the direction A-&gt;B using I_rev_message.  In
          that case, two MIKEY-DHHMAC I_messages are encapsulated within
          SETUP (I_fwd_message and I_rev_message) and two MIKEY-DHHMAC
          R_messages (R_fwd_message and R_rev_message) are encapsulated
          within CallProceeding-to-CONNECT.  The I_rev_message
          corresponds with the I_fwd_message.  Alternatively, the called
          endpoint A may instantiate the DHHMAC protocol in a separate
          run with endpoint B (not shown); however, this requires a
          third handshake to complete.

          For more details on how the MIKEY protocols may be deployed
          with H.235, please refer to [<a href="#ref-15" title='" H.323 Security framework: Usage of the MIKEY Key Management Protocol for the Secure Real Time Transport Protocol (SRTP) within H.235"'>15</a>].

Author's Address

   Martin Euchner
   Hofmannstr. 51
   81359 Munich, Germany

   Phone: +49 89 722 55790
   Fax:   +49 89 722 62366
   EMail: martin_euchner@hotmail.com





























<span class="grey">Euchner                     Standards Track                    [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc4650.html">RFC 4650</a>      HMAC-Authenticated Diffie-Hellman for MIKEY September 2006</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).







Euchner                     Standards Track                    [Page 27]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc4650 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:40 GMT --></html>