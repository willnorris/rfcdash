<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc5929 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 28 Apr 2015 16:01:18 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.111" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:5929" name="DC.Identifier"/>
<meta content="This document defines three channel binding types for Transport Layer
Security (TLS), tls-unique, tls-server-end-point, and tls-unique-for-
telnet, in accordance with RFC 5056 (On Channel Binding).  Note that
based on implementation experience, this document changes the original
definition of 'tls-unique' channel binding type in the channel
binding type IANA registry. [STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="Zhu, Larry" name="DC.Creator"/>
<meta content="Williams, Nicolas" name="DC.Creator"/>
<meta content="Altman, Jeffrey" name="DC.Creator"/>
<meta content="July, 2010" name="DC.Date.Issued"/>
<meta content="Channel Bindings for TLS" name="DC.Title"/>

    <link href="http://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="http://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5929 - Channel Bindings for TLS</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc5929.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc5929" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-altman-tls-channel-bindings" title="draft-altman-tls-channel-bindings">draft-altman-tls-...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5929" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc5929" title="Side-by-side diff">Diff2</a>]                 </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                         J. Altman
Request for Comments: 5929                              Secure Endpoints
Category: Standards Track                                    N. Williams
ISSN: 2070-1721                                                   Oracle
                                                                  L. Zhu
                                                   Microsoft Corporation
                                                               July 2010

                        <span class="h1">Channel Bindings for TLS</span>

Abstract

   This document defines three channel binding types for Transport Layer
   Security (TLS), tls-unique, tls-server-end-point, and tls-unique-for-
   telnet, in accordance with <a href="rfc5056.html">RFC 5056</a> (On Channel Binding).

   Note that based on implementation experience, this document changes
   the original definition of 'tls-unique' channel binding type in the
   channel binding type IANA registry.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc5929">http://www.rfc-editor.org/info/rfc5929</a>.

Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in <a href="#section-4">Section 4</a>.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



<span class="grey">Altman, et al.               Standards Track                    [Page 1]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5929.html">RFC 5929</a>                  TLS Channel Bindings                 July 2010</span>


   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Conventions Used in This Document ...............................<a href="#page-3">3</a>
   <a href="#section-3">3</a>. The 'tls-unique' Channel Binding Type ...........................<a href="#page-3">3</a>
      <a href="#section-3.1">3.1</a>. Description ................................................<a href="#page-3">3</a>
      <a href="#section-3.2">3.2</a>. Registration ...............................................<a href="#page-4">4</a>
   <a href="#section-4">4</a>. The 'tls-server-end-point' Channel Binding Type .................<a href="#page-5">5</a>
      <a href="#section-4.1">4.1</a>. Description ................................................<a href="#page-5">5</a>
      <a href="#section-4.2">4.2</a>. Registration ...............................................<a href="#page-6">6</a>
   <a href="#section-5">5</a>. The 'tls-unique-for-telnet' Channel Binding Type ................<a href="#page-6">6</a>
      <a href="#section-5.1">5.1</a>. Description ................................................<a href="#page-7">7</a>
      <a href="#section-5.2">5.2</a>. Registration ...............................................<a href="#page-7">7</a>
   <a href="#section-6">6</a>. Applicability of TLS Channel Binding Types ......................<a href="#page-7">7</a>
   <a href="#section-7">7</a>. Required Application Programming Interfaces ....................<a href="#page-10">10</a>
   8. Description of Backwards-Incompatible Changes Made
      Herein to 'tls-unique' .........................................<a href="#page-10">10</a>
   <a href="#section-9">9</a>. IANA Considerations ............................................<a href="#page-11">11</a>
   <a href="#section-10">10</a>. Security Considerations .......................................<a href="#page-11">11</a>
      <a href="#section-10.1">10.1</a>. Cryptographic Algorithm Agility ..........................<a href="#page-12">12</a>
      10.2. On Disclosure of Channel Bindings Data by
            Authentication Mechanisms ................................<a href="#page-12">12</a>
   <a href="#section-11">11</a>. References ....................................................<a href="#page-13">13</a>
      <a href="#section-11.1">11.1</a>. Normative References .....................................<a href="#page-13">13</a>
      <a href="#section-11.2">11.2</a>. Informative References ...................................<a href="#page-14">14</a>














<span class="grey">Altman, et al.               Standards Track                    [Page 2]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5929.html">RFC 5929</a>                  TLS Channel Bindings                 July 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   Subsequent to the publication of "On Channel Bindings" [<a href="rfc5056.html" title='"On the Use of Channel Bindings to Secure Channels"'>RFC5056</a>],
   three channel binding types for Transport Layer Security (TLS) were
   proposed, reviewed, and added to the IANA channel binding type
   registry, all in accordance with [<a href="rfc5056.html" title='"On the Use of Channel Bindings to Secure Channels"'>RFC5056</a>].  Those channel binding
   types are: 'tls-unique', 'tls-server-end-point', and 'tls-unique-for-
   telnet'.  It has become desirable to have these channel binding types
   re-registered through an RFC so as to make it easier to reference
   them, and to correct them to describe actual implementations.  This
   document does just that.  The authors of those three channel binding
   types have transferred, or have indicated that they will transfer,
   "ownership" of those channel binding types to the IESG.

   We also provide some advice on the applicability of these channel
   binding types, as well as advice on when to use which.  Additionally,
   we provide an abstract API that TLS implementors should provide, by
   which to obtain channel bindings data for a TLS connection.

   WARNING: it turns out that the first implementor implemented and
   deployed something rather different than what was described in the
   IANA registration for 'tls-unique'.  Subsequently, it was decided
   that we should adopt that form of 'tls-unique'.  This means that this
   document makes a backwards-incompatible change to 'tls-unique'.  See
   <a href="#section-8">Section 8</a> for more details.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20The%20%27tls-unique%27%20Channel%20Binding%20Type"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  The 'tls-unique' Channel Binding Type</span>

   IANA updated the registration of the 'tls-unique' channel binding
   type to match the description below.  There are material and
   substantial changes from the original registration, both in the
   description as well as registration meta-data (such as registration
   ownership).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Description"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Description</span>

   Description: The first TLS Finished message sent (note: the Finished
   struct, not the TLS record layer message containing it) in the most
   recent TLS handshake of the TLS connection being bound to (note: TLS
   connection, not session, so that the channel binding is specific to
   each connection regardless of whether session resumption is used).
   If TLS renegotiation takes place before the channel binding



<span class="grey">Altman, et al.               Standards Track                    [Page 3]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5929.html">RFC 5929</a>                  TLS Channel Bindings                 July 2010</span>


   operation, then the first TLS Finished message sent of the latest/
   inner-most TLS connection is used.  Note that for full TLS
   handshakes, the first Finished message is sent by the client, while
   for abbreviated TLS handshakes (session resumption), the first
   Finished message is sent by the server.

   WARNING: The definition, security, and interoperability
   considerations of this channel binding type have changed since the
   original registration.  Implementors should read the document that
   last updated this registration for more information.

   Interoperability note:

      This definition of 'tls-unique' means that a channel's bindings
      data may change over time, which in turn creates a synchronization
      problem should the channel's bindings data change between the time
      that the client initiates authentication with channel binding and
      the time that the server begins to process the client's first
      authentication message.  If that happens, the authentication
      attempt will fail spuriously.

      Based on the fact that while servers may request TLS
      renegotiation, only clients may initiate it, this synchronization
      problem can be avoided by clients and servers as follows: server
      applications MUST NOT request TLS renegotiation during phases of
      the application protocol during which application-layer
      authentication occurs.  Client applications SHOULD NOT initiate
      TLS renegotiation between the start and completion of
      authentication.

      The rationale for making the server behavior a requirement while
      the client behavior is only a recommendation is that there
      typically exist TLS APIs for requesting renegotiation on the
      server side of a TLS connection, while many client TLS stacks do
      not provide fine-grained control over when TLS renegotiation
      occurs.

      Application protocols SHOULD be designed in such a way that a
      server would never need to request TLS renegotiation immediately
      before or during application-layer authentication.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Registration"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Registration</span>

   o  Channel binding unique prefix: tls-unique

   o  Channel binding type: unique

   o  Channel type: TLS [<a href="rfc5246.html" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>RFC5246</a>]



<span class="grey">Altman, et al.               Standards Track                    [Page 4]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5929.html">RFC 5929</a>                  TLS Channel Bindings                 July 2010</span>


   o  Published specification: &lt;<a href="rfc5929.html">RFC 5929</a>&gt;

   o  Channel binding is secret: no

   o  Description: &lt;See specification&gt;

   o  Intended usage: COMMON

   o  Person and email address to contact for further information: Larry
      Zhu (larry.zhu@microsoft.com), Nicolas Williams
      (Nicolas.Williams@oracle.com).

   o  Owner/Change controller name and email address: IESG.

   o  Expert reviewer name and contact information: IETF TLS WG
      (tls@ietf.org, failing that, ietf@ietf.org)

   o  Note: see the published specification for advice on the
      applicability of this channel binding type.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20The%20%27tls-server-end-point%27%20Channel%20Binding%20Type"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  The 'tls-server-end-point' Channel Binding Type</span>

   IANA updated the registration of the 'tls-server-end-point' channel
   binding type to match the description below.  Note that the only
   material changes from the original registration are: the "owner" (now
   the IESG), the contacts, the published specification, and a note
   indicating that the published specification should be consulted for
   applicability advice.  References were added to the description.  All
   other fields of the registration are copied here for the convenience
   of readers.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Description"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Description</span>

   Description: The hash of the TLS server's certificate [<a href="rfc5280.html" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>] as it
   appears, octet for octet, in the server's Certificate message.  Note
   that the Certificate message contains a certificate_list, in which
   the first element is the server's certificate.

   The hash function is to be selected as follows:

   o  if the certificate's signatureAlgorithm uses a single hash
      function, and that hash function is either MD5 [<a href="rfc1321.html" title='"The MD5 Message-Digest Algorithm"'>RFC1321</a>] or SHA-1
      [<a href="rfc3174.html" title='"US Secure Hash Algorithm 1 (SHA1)"'>RFC3174</a>], then use SHA-256 [<a href="#ref-FIPS-180-3" title='"Secure Hash Standard"'>FIPS-180-3</a>];

   o  if the certificate's signatureAlgorithm uses a single hash
      function and that hash function neither MD5 nor SHA-1, then use
      the hash function associated with the certificate's
      signatureAlgorithm;



<span class="grey">Altman, et al.               Standards Track                    [Page 5]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5929.html">RFC 5929</a>                  TLS Channel Bindings                 July 2010</span>


   o  if the certificate's signatureAlgorithm uses no hash functions or
      uses multiple hash functions, then this channel binding type's
      channel bindings are undefined at this time (updates to is channel
      binding type may occur to address this issue if it ever arises).

   The reason for using a hash of the certificate is that some
   implementations need to track the channel binding of a TLS session in
   kernel-mode memory, which is often at a premium.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Registration"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Registration</span>

   o  Channel binding unique prefix: tls-server-end-point

   o  Channel binding type: end-point

   o  Channel type: TLS [<a href="rfc5246.html" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>RFC5246</a>]

   o  Published specification: &lt;<a href="rfc5929.html">RFC 5929</a>&gt;

   o  Channel binding is secret: no

   o  Description: &lt;See specification&gt;

   o  Intended usage: COMMON

   o  Person and email address to contact for further information: Larry
      Zhu (larry.zhu@microsoft.com), Nicolas Williams
      (Nicolas.Williams@oracle.com).

   o  Owner/Change controller name and email address: IESG.

   o  Expert reviewer name and contact information: IETF TLS WG
      (tls@ietf.org, failing that, ietf@ietf.org)

   o  Note: see the published specification for advice on the
      applicability of this channel binding type.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20The%20%27tls-unique-for-telnet%27%20Channel%20Binding%20Type"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  The 'tls-unique-for-telnet' Channel Binding Type</span>

   IANA updated the registration of the 'tls-unique-for-telnet' channel
   binding type to match the description below.  Note that the only
   material changes from the original registration are: the "owner" (now
   the IESG), the contacts, the published specification, and a note
   indicating that the published specification should be consulted for
   applicability advice.  The description is also clarified.  We also
   moved the security considerations notes to the security
   considerations section of this document.  All other fields of the
   registration are copied here for the convenience of readers.



<span class="grey">Altman, et al.               Standards Track                    [Page 6]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5929.html">RFC 5929</a>                  TLS Channel Bindings                 July 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Description"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Description</span>

   Description: There is a proposal for adding a "StartTLS" extension to
   TELNET, and a channel binding extension for the various TELNET AUTH
   mechanisms whereby each side sends the other a "checksum" (MAC --
   message authentication code) of their view of the channel's bindings.
   The client uses the TLS Finished messages (note: the Finished struct)
   sent by the client and server, each concatenated in that order and in
   their clear text form, of the first TLS handshake to which the
   connection is being bound.  The server does the same but in the
   opposite concatenation order (server, then client).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Registration"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Registration</span>

   o  Channel binding unique prefix: tls-unique-for-telnet

   o  Channel binding type: unique

   o  Channel type: TLS [<a href="rfc5246.html" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>RFC5246</a>]

   o  Published specification: &lt;<a href="rfc5929.html">RFC 5929</a>&gt;

   o  Channel binding is secret: no

   o  Description: &lt;See specification&gt;

   o  Intended usage: COMMON

   o  Person and email address to contact for further information: Jeff
      Altman (jaltman@secure-endpoints.com), Nicolas Williams
      (Nicolas.Williams@oracle.com).

   o  Owner/Change controller name and email address: IESG.

   o  Expert reviewer name and contact information: IETF TLS WG
      (tls@ietf.org, failing that, ietf@ietf.org)

   o  Note: see the published specification for advice on the
      applicability of this channel binding type.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Applicability%20of%20TLS%20Channel%20Binding%20Types"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Applicability of TLS Channel Binding Types</span>

   The 'tls-unique-for-telnet' channel binding type is only applicable
   to TELNET [<a href="http://tools.ietf.org/html/rfc0854" title='"Telnet Protocol Specification"'>RFC0854</a>] and is available for all TLS connections.

   The 'tls-unique' channel binding type is available for all TLS
   connections, while 'tls-server-end-point' is only available when TLS
   cipher suites with server certificates are used, specifically: cipher



<span class="grey">Altman, et al.               Standards Track                    [Page 7]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5929.html">RFC 5929</a>                  TLS Channel Bindings                 July 2010</span>


   suites that use the Certificate handshake message, which typically
   involve the use of PKIX [<a href="rfc5280.html" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>].  For example, 'tls-server-end-
   point' is available when using TLS ciphers suites such as (this is
   not an exhaustive list):

   o  TLS_DHE_DSS_WITH_*

   o  TLS_DHE_RSA_WITH_*

   o  TLS_DH_DSS_WITH_*

   o  TLS_DH_RSA_WITH_*

   o  TLS_ECDHE_ECDSA_WITH_*

   o  TLS_ECDHE_RSA_WITH_*

   o  TLS_ECDH_ECDSA_WITH_*

   o  TLS_ECDH_RSA_WITH_*

   o  TLS_RSA_PSK_WITH_*

   o  TLS_RSA_WITH_*

   o  TLS_SRP_SHA_DSS_WITH_*

   o  TLS_SRP_SHA_RSA_WITH_*

   but is not available when using TLS cipher suites such as (this is
   not an exhaustive list):

   o  TLS_DHE_PSK_WITH_*

   o  TLS_DH_anon_WITH_*

   o  TLS_ECDHE_PSK_WITH_*

   o  TLS_ECDH_anon_WITH_*

   o  TLS_KRB5_WITH_*

   o  TLS_PSK_WITH_*

   o  TLS_SRP_SHA_WITH_*






<span class="grey">Altman, et al.               Standards Track                    [Page 8]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5929.html">RFC 5929</a>                  TLS Channel Bindings                 July 2010</span>


   'tls-server-end-point' is also not applicable for use with OpenPGP
   server certificates [<a href="rfc5081.html" title='"Using OpenPGP Keys for Transport Layer Security (TLS) Authentication"'>RFC5081</a>] [<a href="rfc4880.html" title='"OpenPGP Message Format"'>RFC4880</a>] (since these don't use the
   Certificate handshake message).

   Therefore, 'tls-unique' is applicable to more contexts than 'tls-
   server-end-point'.  However, 'tls-server-end-point' may be used with
   existing TLS server-side proxies ("concentrators") without
   modification to the proxies, whereas 'tls-unique' may require
   firmware or software updates to server-side proxies.  Therefore there
   may be cases where 'tls-server-end-point' may interoperate but where
   'tls-unique' may not.

   Also, authentication mechanisms may arise that depend on channel
   bindings to contribute entropy, in which case unique channel bindings
   would always have to be used in preference to end-point channel
   bindings.  At this time there are no such mechanisms, though one such
   SASL mechanism has been proposed.  Whether such mechanisms should be
   allowed is out of scope for this document.

   For many applications, there may be two or more potentially
   applicable TLS channel binding types.  Existing security frameworks
   (such as the GSS-API [<a href="rfc2743.html" title='"Generic Security Service Application Program Interface Version 2, Update 1"'>RFC2743</a>] or the SASL [<a href="rfc4422.html" title='"Simple Authentication and Security Layer (SASL)"'>RFC4422</a>] GS2 framework
   [<a href="rfc5801.html" title='"Using Generic Security Service Application Program Interface (GSS-API) Mechanisms in Simple Authentication and Security Layer (SASL): The GS2 Mechanism Family"'>RFC5801</a>]) and security mechanisms generally do not support
   negotiation of channel binding types.  Therefore, application peers
   need to agree a priori as to what channel binding type to use (or
   agree to rules for deciding what channel binding type to use).

   The specifics of whether and how to negotiate channel binding types
   are beyond the scope of this document.  However, it is RECOMMENDED
   that application protocols making use of TLS channel bindings, use
   'tls-unique' exclusively, except, perhaps, where server-side proxies
   are common in deployments of an application protocol.  In the latter
   case an application protocol MAY specify that 'tls-server-end-point'
   channel bindings must be used when available, with 'tls-unique' being
   used when 'tls-server-end-point' channel bindings are not available.
   Alternatively, the application may negotiate which channel binding
   type to use, or may make the choice of channel binding type
   configurable.

   Specifically, application protocol specifications MUST indicate at
   least one mandatory to implement channel binding type, MAY specify a
   negotiation protocol, MAY allow for out-of-band negotiation or
   configuration, and SHOULD have a preference for 'tls-unique' over
   'tls-server-end-point'.







<span class="grey">Altman, et al.               Standards Track                    [Page 9]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5929.html">RFC 5929</a>                  TLS Channel Bindings                 July 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Required%20Application%20Programming%20Interfaces"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Required Application Programming Interfaces</span>

   TLS implementations supporting the use of 'tls-unique' and/or 'tls-
   unique-for-telnet' channel binding types MUST provide application
   programming interfaces by which applications (clients and servers
   both) may obtain the channel bindings for a TLS connection.  Such
   interfaces may be expressed in terms of extracting the channel
   bindings data for a given connection and channel binding type.
   Alternatively, the implementor may provide interfaces by which to
   obtain the initial client Finished message, the initial server
   Finished message, and/or the server certificate (in a form that
   matches the description of the 'tls-server-end-point' channel binding
   type).  In the latter case, the application has to have knowledge of
   the channel binding type descriptions from this document.  This
   document takes no position on which form these application
   programming interfaces must take.

   TLS implementations supporting TLS renegotiation SHOULD provide APIs
   that allow applications to control when renegotiation can take place.
   For example, a TLS client implementation may provide a "callback"
   interface to indicate that the server requested renegotiation, but
   may not start renegotiation until the application calls a function to
   indicate that now is a good time to renegotiate.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Description%20of%20Backwards-Incompatible%20Changes%20Made%20Herein%20to"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Description of Backwards-Incompatible Changes Made Herein to</span>
    'tls-unique'

   The original description of 'tls-unique' read as follows:

      |OLD| Description: The client's TLS Finished message (note: the
      |OLD| Finished struct) from the first handshake of the connection
      |OLD| (note: connection, not session, so that the channel binding
      |OLD| is specific to each connection regardless of whether session
      |OLD| resumption is used).

                     Original 'tls-unique' description

   In other words: the client's Finished message from the first
   handshake of a connection, regardless of whether that handshake was a
   full or abbreviated handshake, and regardless of how many subsequent
   handshakes (renegotiations) might have followed.

   As explained in <a href="#section-1">Section 1</a>, this is no longer the description of 'tls-
   unique', and the new description is not backwards compatible with the
   original except in the case of TLS connections where: a) only one
   handshake has taken place before application-layer authentication,
   and b) that one handshake was a full handshake.




<span class="grey">Altman, et al.               Standards Track                   [Page 10]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5929.html">RFC 5929</a>                  TLS Channel Bindings                 July 2010</span>


   This change has a number of implications:

   o  Backwards-incompatibility.  It is possible that some
      implementations of the original 'tls-unique' channel binding type
      have been deployed.  We know of at least one TLS implementation
      that exports 'tls-unique' channel bindings with the original
      semantics, but we know of no deployed application using the same.
      Implementations of the original and new 'tls-unique' channel
      binding type will only interoperate when: a) full TLS handshakes
      are used, and b) TLS renegotiation is not used.

   o  Security considerations -- see <a href="#section-10">Section 10</a>.

   o  Interoperability considerations.  As described in <a href="#section-3">Section 3</a>, the
      new definition of the 'tls-unique' channel binding type has an
      interoperability problem that may result in spurious
      authentication failures unless the application implements one or
      both of the techniques described in that section.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  IANA Considerations</span>

   IANA updated three existing channel binding type registrations.  See
   the rest of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Security%20Considerations"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Security Considerations</span>

   The Security Considerations sections of [<a href="rfc5056.html" title='"On the Use of Channel Bindings to Secure Channels"'>RFC5056</a>], [<a href="rfc5246.html" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>RFC5246</a>], and
   [<a href="rfc5746.html" title='"Transport Layer Security (TLS) Renegotiation Indication Extension"'>RFC5746</a>] apply to this document.

   The TLS Finished messages (see <a href="rfc5246.html#section-7.4.9">Section 7.4.9 of [RFC5246]</a>) are known
   to both endpoints of a TLS connection and are cryptographically bound
   to it.  For implementations of TLS that correctly handle
   renegotiation [<a href="rfc5746.html" title='"Transport Layer Security (TLS) Renegotiation Indication Extension"'>RFC5746</a>], each handshake on a TLS connection is bound
   to the preceding handshake, if any.  Therefore, the TLS Finished
   messages can be safely used as a channel binding provided that the
   authentication mechanism doing the channel binding conforms to the
   requirements in [<a href="rfc5056.html" title='"On the Use of Channel Bindings to Secure Channels"'>RFC5056</a>].  Applications utilizing 'tls-unique'
   channel binding with TLS implementations without support for secure
   renegotiation [<a href="rfc5746.html" title='"Transport Layer Security (TLS) Renegotiation Indication Extension"'>RFC5746</a>] MUST ensure that ChangeCipherSpec has been
   used in any and all renegotiations prior to application-layer
   authentication, and MUST discard any knowledge learned from the
   server prior to the completion of application-layer authentication.

   The server certificate, when present, is also cryptographically bound
   to the TLS connection through its use in key transport and/or
   authentication of the server (either by dint of its use in key
   transport, by its use in signing key agreement, or by its use in key




<span class="grey">Altman, et al.               Standards Track                   [Page 11]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5929.html">RFC 5929</a>                  TLS Channel Bindings                 July 2010</span>


   agreement).  Therefore, the server certificate is suitable as an end-
   point channel binding as described in [<a href="rfc5056.html" title='"On the Use of Channel Bindings to Secure Channels"'>RFC5056</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Cryptographic%20Algorithm%20Agility"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Cryptographic Algorithm Agility</span>

   The 'tls-unique' and 'tls-unique-for-telnet' channel binding types do
   not add any use of cryptography beyond that used by TLS itself.
   Therefore, these two channel binding types add no considerations with
   respect to cryptographic algorithm agility.

   The 'tls-server-end-point' channel binding type consists of a hash of
   a server certificate.  The reason for this is to produce manageably
   small channel binding data, as some implementations will be using
   kernel-mode memory (which is typically scarce) to store these.  This
   use of a hash algorithm is above and beyond TLS's use of
   cryptography, therefore the 'tls-server-end-point' channel binding
   type has a security consideration with respect to hash algorithm
   agility.  The algorithm to be used, however, is derived from the
   server certificate's signature algorithm as described in <a href="#section-4.1">Section 4.1</a>;
   to recap: use SHA-256 if the certificate signature algorithm uses MD5
   or SHA-1, else use whatever hash function the certificate uses
   (unless the signature algorithm uses no hash functions or more than
   one hash function, in which case 'tls-server-end-point' is
   undefined).  The construction of 'tls-server-end-point' channel
   bindings is not directly hash-agile (since no negotiation of hash
   function is provided for), but it is hash-agile nonetheless.  The
   hash agility of 'tls-server-end-point' channel bindings derives from
   PKIX and TLS.

   Current proposals for randomized signatures algorithms [<a href="#ref-RHASH" title='"Strengthening Digital Signatures via Randomized Hashing"'>RHASH</a>]
   [<a href="#ref-NIST-SP.800-106.2009" title='"NIST Special Publication 800- 106: Randomized Hashing for Digital Signatures"'>NIST-SP.800-106.2009</a>] use hash functions in their construction -- a
   single hash function in each algorithm.  Therefore, the 'tls-server-
   end-point' channel binding type should be available even in cases
   where new signatures algorithms are used that are based on current
   randomized hashing proposals (but we cannot guarantee this, of
   course).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.2.%20%20On%20Disclosure%20of%20Channel%20Bindings%20Data%20by%20Authentication"></a><a class="selflink" href="#section-10.2" name="section-10.2">10.2</a>.  On Disclosure of Channel Bindings Data by Authentication</span>
<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/Mechanisms"></a>       Mechanisms</span>

   When these channel binding types were first considered, one issue
   that some commenters were concerned about was the possible impact on
   the security of the TLS channel, of disclosure of the channel
   bindings data by authentication mechanisms.  This can happen, for
   example, when an authentication mechanism transports the channel
   bindings data, with no confidentiality protection, over other
   transports (for example, in communicating with a trusted third
   party), or when the TLS channel provides no confidentiality



<span class="grey">Altman, et al.               Standards Track                   [Page 12]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5929.html">RFC 5929</a>                  TLS Channel Bindings                 July 2010</span>


   protection and the authentication mechanism does not protect the
   confidentiality of the channel bindings data.  This section considers
   that concern.

   When the TLS connection uses a cipher suite that does not provide
   confidentiality protection, the TLS Finished messages will be visible
   to eavesdroppers, regardless of what the authentication mechanism
   does.  The same is true of the server certificate which, in any case,
   is generally visible to eavesdroppers.  Therefore we must consider
   our choices of TLS channel bindings here to be safe to disclose by
   definition -- if that were not the case, then TLS with cipher suites
   that don't provide confidentiality protection would be unsafe.
   Furthermore, the TLS Finished message construction depends on the
   security of the TLS PRF, which in turn needs to be resistant to key
   recovery attacks, and we think that it is, as it is based on HMAC,
   and the master secret is, well, secret (and the result of key
   exchange).

   Note too that in the case of an attempted active man-in-the-middle
   attack, the attacker will already possess knowledge of the TLS
   Finished messages for both inbound and outbound TLS channels (which
   will differ, given that the attacker cannot force them to be the
   same).  No additional information is obtained by the attacker from
   the authentication mechanism's disclosure of channel bindings data --
   the attacker already has it, even when cipher suites providing
   confidentiality protection are provided.

   None of the channel binding types defined herein produce channel
   bindings data that must be kept secret.  Moreover, none of the
   channel binding types defined herein can be expected to be private
   (known only to the end-points of the channel), except that the unique
   TLS channel binding types can be expected to be private when a cipher
   suite that provides confidentiality protection is used to protect the
   Finished message exchanges and the application data records
   containing application-layer authentication messages.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20References"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.1.%20%20Normative%20References"></a><a class="selflink" href="#section-11.1" name="section-11.1">11.1</a>.  Normative References</span>

   [<a id="ref-FIPS-180-3" name="ref-FIPS-180-3">FIPS-180-3</a>]            United States of America, National Institute
                           of Standards and Technology, "Secure Hash
                           Standard", Federal Information Processing
                           Standard (FIPS) 180-3, October 2008.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]               Bradner, S., "Key words for use in RFCs to
                           Indicate Requirement Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>,
                           <a href="rfc2119.html">RFC 2119</a>, March 1997.



<span class="grey">Altman, et al.               Standards Track                   [Page 13]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5929.html">RFC 5929</a>                  TLS Channel Bindings                 July 2010</span>


   [<a id="ref-RFC5056" name="ref-RFC5056">RFC5056</a>]               Williams, N., "On the Use of Channel Bindings
                           to Secure Channels", <a href="rfc5056.html">RFC 5056</a>, November 2007.

   [<a id="ref-RFC5246" name="ref-RFC5246">RFC5246</a>]               Dierks, T. and E. Rescorla, "The Transport
                           Layer Security (TLS) Protocol Version 1.2",
                           <a href="rfc5246.html">RFC 5246</a>, August 2008.

   [<a id="ref-RFC5746" name="ref-RFC5746">RFC5746</a>]               Rescorla, E., Ray, M., Dispensa, S., and N.
                           Oskov, "Transport Layer Security (TLS)
                           Renegotiation Indication Extension",
                           <a href="rfc5746.html">RFC 5746</a>, February 2010.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.2.%20%20Informative%20References"></a><a class="selflink" href="#section-11.2" name="section-11.2">11.2</a>.  Informative References</span>

   [<a id="ref-NIST-SP.800-106.2009" name="ref-NIST-SP.800-106.2009">NIST-SP.800-106.2009</a>]  National Institute of Standards and
                           Technology, "NIST Special Publication 800-
                           106: Randomized Hashing for Digital
                           Signatures", February 2009.

   [<a id="ref-RFC0854" name="ref-RFC0854">RFC0854</a>]               Postel, J. and J. Reynolds, "Telnet Protocol
                           Specification", STD 8, <a href="rfc854.html">RFC 854</a>, May 1983.

   [<a id="ref-RFC1321" name="ref-RFC1321">RFC1321</a>]               Rivest, R., "The MD5 Message-Digest
                           Algorithm", <a href="rfc1321.html">RFC 1321</a>, April 1992.

   [<a id="ref-RFC2743" name="ref-RFC2743">RFC2743</a>]               Linn, J., "Generic Security Service
                           Application Program Interface Version 2,
                           Update 1", <a href="rfc2743.html">RFC 2743</a>, January 2000.

   [<a id="ref-RFC3174" name="ref-RFC3174">RFC3174</a>]               Eastlake, D. and P. Jones, "US Secure Hash
                           Algorithm 1 (SHA1)", <a href="rfc3174.html">RFC 3174</a>,
                           September 2001.

   [<a id="ref-RFC4422" name="ref-RFC4422">RFC4422</a>]               Melnikov, A., Ed., and K. Zeilenga, Ed.,
                           "Simple Authentication and Security Layer
                           (SASL)", <a href="rfc4422.html">RFC 4422</a>, June 2006.

   [<a id="ref-RFC4880" name="ref-RFC4880">RFC4880</a>]               Callas, J., Donnerhacke, L., Finney, H.,
                           Shaw, D., and R. Thayer, "OpenPGP Message
                           Format", <a href="rfc4880.html">RFC 4880</a>, November 2007.

   [<a id="ref-RFC5081" name="ref-RFC5081">RFC5081</a>]               Mavrogiannopoulos, N., "Using OpenPGP Keys
                           for Transport Layer Security (TLS)
                           Authentication", <a href="rfc5081.html">RFC 5081</a>, November 2007.







<span class="grey">Altman, et al.               Standards Track                   [Page 14]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc5929.html">RFC 5929</a>                  TLS Channel Bindings                 July 2010</span>


   [<a id="ref-RFC5280" name="ref-RFC5280">RFC5280</a>]               Cooper, D., Santesson, S., Farrell, S.,
                           Boeyen, S., Housley, R., and W. Polk,
                           "Internet X.509 Public Key Infrastructure
                           Certificate and Certificate Revocation List
                           (CRL) Profile", <a href="rfc5280.html">RFC 5280</a>, May 2008.

   [<a id="ref-RFC5801" name="ref-RFC5801">RFC5801</a>]               Josefsson, S. and N. Williams, "Using Generic
                           Security Service Application Program
                           Interface (GSS-API) Mechanisms in Simple
                           Authentication and Security Layer (SASL): The
                           GS2 Mechanism Family", <a href="rfc5801.html">RFC 5801</a>, July 2010.

   [<a id="ref-RHASH" name="ref-RHASH">RHASH</a>]                 Halevi, S. and H. Krawczyk, "Strengthening
                           Digital Signatures via Randomized Hashing",
                           Work in Progress, October 2007.

Authors' Addresses

   Jeff Altman
   Secure Endpoints
   255 W 94TH ST PHB
   New York, NY  10025
   US

   EMail: jaltman@secure-endpoints.com


   Nicolas Williams
   Oracle
   5300 Riata Trace Ct
   Austin, TX  78727
   US

   EMail: Nicolas.Williams@oracle.com


   Larry Zhu
   Microsoft Corporation
   One Microsoft Way
   Redmond, WA  98052
   US

   EMail: larry.zhu@microsoft.com








Altman, et al.               Standards Track                   [Page 15]

</pre><br/>
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.111, available from
<a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>



</body><!-- Mirrored from tools.ietf.org/html/rfc5929 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 28 Apr 2015 16:01:18 GMT --></html>