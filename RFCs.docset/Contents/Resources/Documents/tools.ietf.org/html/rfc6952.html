<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6952 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:25 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:6952" name="DC.Identifier"/>
<meta content='This document analyzes TCP-based routing protocols, the Border Gateway
Protocol (BGP), the Label Distribution Protocol (LDP), the Path
Computation Element Communication Protocol (PCEP), and the Multicast
Source Distribution Protocol (MSDP), according to guidelines set forth
in Section 4.2 of "Keying and Authentication for Routing Protocols
Design Guidelines", RFC 6518.' name="DC.Description.Abstract"/>
<meta content="Zheng, Lianshu" name="DC.Creator"/>
<meta content="Patel, Keyur" name="DC.Creator"/>
<meta content="Jethanandani, Mahesh" name="DC.Creator"/>
<meta content="May, 2013" name="DC.Date.Issued"/>
<meta content="Analysis of BGP, LDP, PCEP, and MSDP Issues According to the Keying and Authentication for Routing Protocols (KARP) Design Guide" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6952 - Analysis of BGP, LDP, PCEP, and MSDP Issues According to the Keying and Authentication for Routing Protocols (KARP) Design Guide</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6952.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6952" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-karp-routing-tcp-analysis" title="draft-ietf-karp-routing-tcp-analysis">draft-ietf-karp...</a>] [<a href="https://datatracker.ietf.org/doc/rfc6952" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6952" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6952" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                   M. Jethanandani
Request for Comments: 6952                             Ciena Corporation
Category: Informational                                         K. Patel
ISSN: 2070-1721                                       Cisco Systems, Inc
                                                                L. Zheng
                                                     Huawei Technologies
                                                                May 2013



      <span class="h1">Analysis of BGP, LDP, PCEP, and MSDP Issues According to the</span>
  <span class="h1">Keying and Authentication for Routing Protocols (KARP) Design Guide</span>

Abstract

   This document analyzes TCP-based routing protocols, the Border
   Gateway Protocol (BGP), the Label Distribution Protocol (LDP), the
   Path Computation Element Communication Protocol (PCEP), and the
   Multicast Source Distribution Protocol (MSDP), according to
   guidelines set forth in <a href="#section-4.2">Section 4.2</a> of "Keying and Authentication for
   Routing Protocols Design Guidelines", <a href="rfc6518.html">RFC 6518</a>.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6952">http://www.rfc-editor.org/info/rfc6952</a>.














<span class="grey">Jethanandani, et al.          Informational                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6952.html">RFC 6952</a>            BGP, LDP, PCEP, and MSDP Analysis           May 2013</span>


Copyright Notice

   Copyright (c) 2013 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-1.1">1.1</a>.  Abbreviations . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-2">2</a>.  Current Assessment of BGP, LDP, PCEP, and MSDP  . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-2.1">2.1</a>.  Transport Layer . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-2.2">2.2</a>.  Keying Mechanisms . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-2.3">2.3</a>.  BGP . . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-2.4">2.4</a>.  LDP . . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
       <a href="#section-2.4.1">2.4.1</a>.  Spoofing Attacks  . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
       <a href="#section-2.4.2">2.4.2</a>.  Denial-of-Service Attacks . . . . . . . . . . . . . .   <a href="#page-8">8</a>
     <a href="#section-2.5">2.5</a>.  PCEP  . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
     <a href="#section-2.6">2.6</a>.  MSDP  . . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
   <a href="#section-3">3</a>.  Optimal State for BGP, LDP, PCEP, and MSDP  . . . . . . . . .  <a href="#page-10">10</a>
     <a href="#section-3.1">3.1</a>.  LDP . . . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
   <a href="#section-4">4</a>.  Gap Analysis for BGP, LDP, PCEP, and MSDP . . . . . . . . . .  <a href="#page-11">11</a>
     <a href="#section-4.1">4.1</a>.  LDP . . . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-4.2">4.2</a>.  PCEP  . . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
   <a href="#section-5">5</a>.  Transition and Deployment Considerations  . . . . . . . . . .  <a href="#page-13">13</a>
   <a href="#section-6">6</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
   <a href="#section-7">7</a>.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
   <a href="#section-8">8</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
     <a href="#section-8.1">8.1</a>.  Normative References  . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
     <a href="#section-8.2">8.2</a>.  Informative References  . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>












<span class="grey">Jethanandani, et al.          Informational                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6952.html">RFC 6952</a>            BGP, LDP, PCEP, and MSDP Analysis           May 2013</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   In their "Report from the IAB Workshop on Unwanted Traffic March
   9-10, 2006" [<a href="rfc4948.html" title='"Report from the IAB workshop on Unwanted Traffic March 9-10, 2006"'>RFC4948</a>], the Internet Architecture Board (IAB)
   described an attack on core routing infrastructure as an ideal attack
   that would inflict the greatest amount of damage and suggested steps
   to tighten the infrastructure against the attack.  Four main steps
   were identified for that tightening:

   1.  Create secure mechanisms and practices for operating routers.

   2.  Clean up the Internet Routing Registry (IRR) repository, and
       secure both the database and the access, so that it can be used
       for routing verifications.

   3.  Create specifications for cryptographic validation of routing
       message content.

   4.  Secure the routing protocols' packets on the wire.

   In order to secure the routing protocols, this document performs an
   initial analysis of the current state of four TCP-based protocols --
   BGP [<a href="rfc4271.html" title='"A Border Gateway Protocol 4 (BGP-4)"'>RFC4271</a>], LDP [<a href="rfc5036.html" title='"LDP Specification"'>RFC5036</a>], PCEP [<a href="rfc5440.html" title='"Path Computation Element (PCE) Communication Protocol (PCEP)"'>RFC5440</a>], and MSDP [<a href="rfc3618.html" title='"Multicast Source Discovery Protocol (MSDP)"'>RFC3618</a>] --
   according to the requirements of the KARP Design Guidelines
   [<a href="rfc6518.html" title='"Keying and Authentication for Routing Protocols (KARP) Design Guidelines"'>RFC6518</a>].  <a href="#section-4.2">Section 4.2</a> of that document uses the term "state", which
   will be referred to as the "state of the security method".  Thus, a
   term like "Define Optimal State" would be referred to as "Define
   Optimal State of the Security Method".

   This document builds on several previous efforts into routing
   security:

   o  "Issues with Existing Cryptographic Protection Methods for Routing
      Protocols" [<a href="rfc6039.html" title='"Issues with Existing Cryptographic Protection Methods for Routing Protocols"'>RFC6039</a>], describes issues with existing cryptographic
      protection methods for routing protocols.

   o  Analysis of OSPF Security According to the KARP Design Guide
      [<a href="rfc6863.html" title='"Analysis of OSPF Security According to the Keying and Authentication for Routing Protocols (KARP) Design Guide"'>RFC6863</a>] analyzes Open Shortest Path First (OSPF) security
      according to the KARP Design Guide.

   <a href="#section-2">Section 2</a> of this document looks at the current state of the security
   method for the four routing protocols: BGP, LDP, PCEP, and MSDP.
   <a href="#section-3">Section 3</a> examines what the optimal state of the security method
   would be for the four routing protocols according to the KARP Design
   Guidelines [<a href="rfc6518.html" title='"Keying and Authentication for Routing Protocols (KARP) Design Guidelines"'>RFC6518</a>], and <a href="#section-4">Section 4</a> does an analysis of the gap
   between the existing state of the security method and the optimal
   state of the security method for the protocols and suggests some
   areas where improvement is needed.



<span class="grey">Jethanandani, et al.          Informational                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6952.html">RFC 6952</a>            BGP, LDP, PCEP, and MSDP Analysis           May 2013</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Abbreviations"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Abbreviations</span>

   AES - Advanced Encryption Standard

   AO - Authentication Option

   AS - Autonomous System

   BGP - Border Gateway Protocol

   CMAC - Cipher-Based Message Authentication Code

   DoS - Denial of Service

   GTSM - Generalized Time-to-Live (TTL) Security Mechanism

   HMAC - Hash-Based MAC

   KARP - Key and Authentication for Routing Protocols

   KDF - Key Derivation Function

   KEK - Key Encrypting Key

   KMP - Key Management Protocol

   LDP - Label Distribution Protocol

   LSR - Label Switching Routers

   MAC - Message Authentication Code

   MKT - Master Key Table

   MSDP - Multicast Source Distribution Protocol

   MD5 - Message Digest Algorithm 5

   OSPF - Open Shortest Path First

   PCEP - Path Computation Element Communication Protocol

   PCC - Path Computation Client

   PCE - Path Computation Element

   SHA - Secure Hash Algorithm




<span class="grey">Jethanandani, et al.          Informational                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6952.html">RFC 6952</a>            BGP, LDP, PCEP, and MSDP Analysis           May 2013</span>


   TCP - Transmission Control Protocol

   TTL - Time-to-Live

   UDP - User Datagram Protocol

   WG - Working Group

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Current%20Assessment%20of%20BGP%2C%20LDP%2C%20PCEP%2C%20and%20MSDP"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Current Assessment of BGP, LDP, PCEP, and MSDP</span>

   This section assesses the transport protocols for any authentication
   or integrity mechanisms used by the protocol.  It describes the
   current security mechanisms, if any, used by BGP, LDP, PCEP, and
   MSDP.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Transport%20Layer"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Transport Layer</span>

   At the transport layer, routing protocols are subject to a variety of
   DoS attacks, as outlined in "Internet Denial-of-Service
   Considerations" [<a href="rfc4732.html" title='"Internet Denial-of- Service Considerations"'>RFC4732</a>].  Such attacks can cause the routing
   protocol to become congested, resulting in the routing updates being
   supplied too slowly to be useful.  In extreme cases, these attacks
   prevent routers from converging after a change.

   Routing protocols use several methods to protect themselves.  Those
   that use TCP as a transport protocol use access lists to accept
   packets only from known sources.  These access lists also help
   protect edge routers from attacks originating outside the protected
   domain.  In addition, for edge routers running the External Border
   Gateway Protocol (eBGP), TCP LISTEN is run only on interfaces on
   which its peers have been discovered or via which routing sessions
   are expected (as specified in router configuration databases).

   "Generalized TTL Security Mechanism (GTSM)" [<a href="rfc5082.html" title='"The Generalized TTL Security Mechanism (GTSM)"'>RFC5082</a>] describes a
   generalized Time-to-Live (TTL) security mechanism to protect a
   protocol stack from CPU-utilization-based attacks.  TCP Robustness
   [<a href="rfc5961.html" title="&quot;Improving TCP's Robustness to Blind In-Window Attacks&quot;">RFC5961</a>] recommends some TCP-level mitigations against spoofing
   attacks targeted towards long-lived routing protocol sessions.

   Even when BGP, LDP, PCEP, and MSDP sessions use access lists, they
   are vulnerable to spoofing and man-in-the-middle attacks.
   Authentication and integrity checks allow the receiver of a routing
   protocol update to know that the message genuinely comes from the
   node that claims to have sent it and to know whether the message has
   been modified.  Sometimes routers can be subjected to a large number
   of authentication and integrity requests, exhausting connection
   resources on the router in a way that could lead to the denial of
   genuine requests.



<span class="grey">Jethanandani, et al.          Informational                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6952.html">RFC 6952</a>            BGP, LDP, PCEP, and MSDP Analysis           May 2013</span>


   TCP MD5 [<a href="rfc2385.html" title='"Protection of BGP Sessions via the TCP MD5 Signature Option"'>RFC2385</a>] has been obsoleted by TCP-AO [<a href="rfc5925.html" title='"The TCP Authentication Option"'>RFC5925</a>].  However,
   it is still widely used to authenticate TCP-based routing protocols
   such as BGP.  It provides a way for carrying a MD5 digest in a TCP
   segment.  This digest is computed using information known only to the
   endpoints, and this ensures authenticity and integrity of messages.
   The MD5 key used to compute the digest is stored locally on the
   router.  This option is used by routing protocols to provide for
   session-level protection against the introduction of spoofed TCP
   segments into any existing TCP streams, in particular, TCP Reset
   segments.  TCP MD5 does not provide a generic mechanism to support
   key rollover.  It also does not support algorithm agility.

   The Message Authentication Codes (MACs) used by TCP MD5 are
   considered too weak both because of the use of the hash function and
   because of the way the secret key used by TCP MD5 is managed.
   Furthermore, TCP MD5 does not support any algorithm agility.  TCP-AO
   [<a href="rfc5925.html" title='"The TCP Authentication Option"'>RFC5925</a>] and its companion document Cryptographic Algorithms for
   TCP-AO [<a href="rfc5926.html" title='"Cryptographic Algorithms for the TCP Authentication Option (TCP-AO)"'>RFC5926</a>], describe steps towards correcting both the MAC
   weakness and the management of secret keys.  Those steps require that
   two MAC algorithms be supported.  They are HMAC-SHA-1-96, as
   specified in HMAC [<a href="rfc2104.html" title='"HMAC: Keyed- Hashing for Message Authentication"'>RFC2104</a>], and AES-128-CMAC-96, as specified in
   NIST-SP800-38B [<a href="#ref-NIST-SP800-38B">NIST-SP800-38B</a>].  Cryptographic research suggests
   that both these MAC algorithms are fairly secure.  By supporting
   multiple MAC algorithms, TCP-AO supports algorithm agility.  TCP-AO
   also allows additional MACs to be added in the future.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Keying%20Mechanisms"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Keying Mechanisms</span>

   For TCP-AO [<a href="rfc5925.html" title='"The TCP Authentication Option"'>RFC5925</a>], there is no Key Management Protocol (KMP) used
   to manage the keys that are employed to generate the MAC.  TCP-AO
   talks about coordinating keys derived from the Master Key Table (MKT)
   between endpoints and allows for a master key to be configured
   manually or for it to be managed via an out-of-band mechanism.

   It should be noted that most routers configured with static keys have
   not seen the key changed ever.  The common reason given for not
   changing the key is the difficulty in coordinating the change between
   pairs of routers when using TCP MD5.  It is well known that the
   longer the same key is used, the greater the chance that it can be
   guessed or exposed, e.g., when an administrator with knowledge of the
   keys leaves the company.

   For point-to-point key management, the IKEv2 protocol [<a href="rfc5996.html" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC5996</a>]
   provides for automated key exchange under a Security Association (SA)
   and can be used for a comprehensive KMP solution for routers.  IKEv2
   can be used for both IPsec SAs [<a href="rfc4301.html" title='"Security Architecture for the Internet Protocol"'>RFC4301</a>] and other types of SAs.  For
   example, Fibre Channel SAs [<a href="rfc4595.html" title='"Use of IKEv2 in the Fibre Channel Security Association Management Protocol"'>RFC4595</a>] are currently negotiated with
   IKEv2.  Using IKEv2 to negotiate TCP-AO is a possible option.



<span class="grey">Jethanandani, et al.          Informational                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6952.html">RFC 6952</a>            BGP, LDP, PCEP, and MSDP Analysis           May 2013</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20BGP"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  BGP</span>

   All BGP communications take place over TCP.  Therefore, all security
   vulnerabilities for BGP can be categorized as relating to the
   security of the transport protocol itself, or to the compromising of
   individual routers and the data they handle.  This document examines
   the issues for the transport protocol, while the SIDR Working Group
   (WG) looks at ways to sign and secure the data exchanged in BGP as
   described in "An Infrastructure to Support Secure Internet Protocol"
   [<a href="rfc6480.html" title='"An Infrastructure to Support Secure Internet Routing"'>RFC6480</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.4.%20%20LDP"></a><a class="selflink" href="#section-2.4" name="section-2.4">2.4</a>.  LDP</span>

   "Security Framework for MPLS and GMPLS Networks" [<a href="rfc5920.html" title='"Security Framework for MPLS and GMPLS Networks"'>RFC5920</a>] outlines
   security aspects that are relevant in the context of MPLS and GMPLS.
   It describes the security threats, the related defensive techniques,
   and the mechanism for detection and reporting.

   <a href="#section-5">Section 5</a> of LDP [<a href="rfc5036.html" title='"LDP Specification"'>RFC5036</a>] states that LDP is subject to two
   different types of attacks: spoofing and denial-of-service attacks.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.4.1.%20%20Spoofing%20Attacks"></a><a class="selflink" href="#section-2.4.1" name="section-2.4.1">2.4.1</a>.  Spoofing Attacks</span>

   A spoofing attack against LDP can occur both during the discovery
   phase and during the session communication phase.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/2.4.1.1.%20%20Discovery%20Exchanges%20using%20UDP"></a><a class="selflink" href="#section-2.4.1.1" name="section-2.4.1.1">2.4.1.1</a>.  Discovery Exchanges using UDP</span>

   Label Switching Routers (LSRs) indicate their willingness to
   establish and maintain LDP sessions by periodically sending Hello
   messages.  Reception of a Hello message serves to create a new "Hello
   adjacency", if one does not already exist, or to refresh an existing
   one.

   There are two variants of the discovery mechanism.  A Basic Discovery
   mechanism is used to discover LSR neighbors that are directly
   connected at the link level, and an Extended Discovery mechanism is
   used by LSRs that are more than one hop away.

   Unlike all other LDP messages, the Hello messages are sent using UDP.
   This means that they cannot benefit from the security mechanisms
   available with TCP.  LDP [<a href="rfc5036.html" title='"LDP Specification"'>RFC5036</a>] does not provide any security
   mechanisms for use with Hello messages except for some configuration
   that may help protect against bogus discovery events.  These
   configurations include directly connected links and interfaces.
   Routers that do not use directly connected links have to use the
   Extended Discovery mechanism and will not be able to use
   configuration to protect against bogus discovery events.



<span class="grey">Jethanandani, et al.          Informational                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6952.html">RFC 6952</a>            BGP, LDP, PCEP, and MSDP Analysis           May 2013</span>


   Spoofing a Hello packet for an existing adjacency can cause the
   adjacency to time out and result in termination of the associated
   session.  This can occur when the spoofed Hello message specifies a
   small Hold Time, causing the receiver to expect Hello messages within
   this interval, while the true neighbor continues sending Hello
   messages at the lower, previously agreed to frequency.

   Spoofing a Hello packet can also cause the LDP session to be
   terminated.  This can occur when the spoofed Hello specifies a
   different Transport Address from the previously agreed one between
   neighbors.  Spoofed Hello messages are observed and reported as a
   real problem in production networks.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/2.4.1.2.%20%20Session%20Communication%20using%20TCP"></a><a class="selflink" href="#section-2.4.1.2" name="section-2.4.1.2">2.4.1.2</a>.  Session Communication using TCP</span>

   LDP, like other TCP-based routing protocols, specifies use of the TCP
   MD5 Signature Option to provide for the authenticity and integrity of
   session messages.  As stated in <a href="#section-2.1">Section 2.1</a> of this document and in
   <a href="#section-2.9">Section 2.9</a> of LDP [<a href="rfc5036.html" title='"LDP Specification"'>RFC5036</a>], MD5 authentication is considered too
   weak for this application as outlined in MD5 and HMAC-MD5 Security
   Considerations [<a href="rfc6151.html" title='"Updated Security Considerations for the MD5 Message-Digest and the HMAC-MD5 Algorithms"'>RFC6151</a>].  It also does not support algorithm
   agility.  A stronger hashing algorithm, e.g., SHA1, which is
   supported by TCP-AO [<a href="rfc5925.html" title='"The TCP Authentication Option"'>RFC5925</a>], could be deployed to take care of the
   weakness.

   Alternatively, one could move to using TCP-AO, which provides for
   stronger MAC algorithms, makes it easier to set up manual keys, and
   protects against replay attacks.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.4.2.%20%20Denial-of-Service%20Attacks"></a><a class="selflink" href="#section-2.4.2" name="section-2.4.2">2.4.2</a>.  Denial-of-Service Attacks</span>

   LDP is subject to Denial-of-Service (DoS) attacks both in discovery
   mode and session mode.  The potential targets are documented in
   <a href="#section-5.3">Section 5.3</a> of LDP [<a href="rfc5036.html" title='"LDP Specification"'>RFC5036</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.5.%20%20PCEP"></a><a class="selflink" href="#section-2.5" name="section-2.5">2.5</a>.  PCEP</span>

   For effective selection by Path Computation Clients (PCCs), a PCC
   needs to know the location of Path Computation Elements (PCEs) in its
   domain along with some information relevant for PCE selection.  Such
   PCE information could be learned through manual configuration, on
   each PCC, along with the capabilities of the PCE or automatically
   through a PCE discovery mechanism as outlined in Requirements for PCE
   Discovery [<a href="rfc4674.html" title='"Requirements for Path Computation Element (PCE) Discovery"'>RFC4674</a>].

   Attacks on PCEP [<a href="rfc5440.html" title='"Path Computation Element (PCE) Communication Protocol (PCEP)"'>RFC5440</a>] may result in damage to active networks.
   These include computation responses, which if changed can cause
   protocols like RSVP-TE [<a href="rfc3209.html" title='"RSVP-TE: Extensions to RSVP for LSP Tunnels"'>RFC3209</a>] to set up suboptimal or



<span class="grey">Jethanandani, et al.          Informational                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6952.html">RFC 6952</a>            BGP, LDP, PCEP, and MSDP Analysis           May 2013</span>


   inappropriate LSPs.  In addition, PCE itself can be a target for a
   variety of DoS attacks.  Such attacks can cause path computations to
   be supplied too slowly to be of any value, particularly as it relates
   to recovery or establishment of LSPs.

   Finally, PCE discovery, as outlined in OSPF Protocol Extensions for
   PCE Discovery [<a href="rfc5088.html" title='"OSPF Protocol Extensions for Path Computation Element (PCE) Discovery"'>RFC5088</a>] and IS-IS Protocol Extensions for PCE
   Discovery [<a href="rfc5089.html" title='"IS-IS Protocol Extensions for Path Computation Element (PCE) Discovery"'>RFC5089</a>], is a significant feature for the successful
   deployment of PCEP in large networks.  These mechanisms allow PCC to
   discover the existence of PCEs within the network.  If the discovery
   mechanism is compromised, it will impair the ability of the nodes to
   function as described below.

   As <a href="rfc5440.html">RFC 5440</a> states, PCEP (which makes use of TCP as a transport)
   could be the target of the following attacks:

   o  Spoofing (PCC or PCE implementation)

   o  Snooping (message interception)

   o  Falsification

   o  Denial of Service

   In inter-Autonomous System (inter-AS) scenarios where PCE-to-PCE
   communication is required, attacks may be particularly significant
   with commercial implications as well as service-level agreement
   implications.

   Additionally, snooping of PCEP requests and responses may give an
   attacker information about the operation of the network.  By viewing
   the PCEP messages, an attacker can determine the pattern of service
   establishment in the network and can know where traffic is being
   routed, thereby making the network susceptible to targeted attacks
   and the data within specific LSPs vulnerable.

   Ensuring PCEP communication privacy is of key importance, especially
   in an inter-AS context, where PCEP communication endpoints do not
   reside in the same AS.  An attacker that intercepts a PCE message
   could obtain sensitive information related to computed paths and
   resources.

   At the time PCEP was documented in [<a href="rfc5440.html" title='"Path Computation Element (PCE) Communication Protocol (PCEP)"'>RFC5440</a>], TCP-AO had not been
   fully specified.  Therefore, [<a href="rfc5440.html" title='"Path Computation Element (PCE) Communication Protocol (PCEP)"'>RFC5440</a>] mandates that PCEP
   implementations include support for TCP MD5 and that use of the
   function should be configurable by the operator.  [<a href="rfc5440.html" title='"Path Computation Element (PCE) Communication Protocol (PCEP)"'>RFC5440</a>] also
   describes the vulnerabilities and weaknesses of TCP MD5 as noted in
   this document.  [<a href="rfc5440.html" title='"Path Computation Element (PCE) Communication Protocol (PCEP)"'>RFC5440</a>] goes on to state that PCEP implementations



<span class="grey">Jethanandani, et al.          Informational                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6952.html">RFC 6952</a>            BGP, LDP, PCEP, and MSDP Analysis           May 2013</span>


   should include support for TCP-AO as soon as that specification is
   complete.  Since TCP-AO [<a href="rfc5925.html" title='"The TCP Authentication Option"'>RFC5925</a>] has now been published, new PCEP
   implementations should fully support TCP-AO.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.6.%20%20MSDP"></a><a class="selflink" href="#section-2.6" name="section-2.6">2.6</a>.  MSDP</span>

   Similar to BGP and LDP, the Multicast Source Distribution Protocol
   (MSDP) uses TCP MD5 [<a href="rfc2385.html" title='"Protection of BGP Sessions via the TCP MD5 Signature Option"'>RFC2385</a>] to protect TCP sessions via the TCP MD5
   option.  But with a weak MD5 authentication, TCP MD5 is not
   considered strong enough for this application.  It also does not
   support algorithm agility.

   MSDP advocates imposing a limit on the number of source address and
   group addresses (S,G) that can be cached within the protocol in order
   to mitigate state explosion due to any denial of service and other
   attacks.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Optimal%20State%20for%20BGP%2C%20LDP%2C%20PCEP%2C%20and%20MSDP"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Optimal State for BGP, LDP, PCEP, and MSDP</span>

   The ideal state of the security method for BGP, LDP, PCEP, and MSDP
   protocols is when they can withstand any of the known types of
   attacks.  The protocols also need to support algorithm agility, i.e.,
   they must not hardwire themselves to one algorithm.

   Additionally, the KMP for the routing sessions should help negotiate
   unique, pair-wise random keys without administrator involvement.  It
   should also negotiate Security Association (SA) parameters required
   for the session connection, including key lifetimes.  It should keep
   track of those lifetimes and negotiate new keys and parameters before
   they expire and do so without administrator involvement.  In the
   event of a breach, including when an administrator with knowledge of
   the keys leaves the company, the keys should be changed immediately.

   The DoS attacks for BGP, LDP, PCEP, and MSDP are attacks to the
   transport protocol -- TCP for the most part, and UDP in case of the
   discovery phase of LDP.  TCP and UDP should be able to withstand any
   of the DoS scenarios by dropping packets that are attack packets in a
   way that does not impact legitimate packets.

   The routing protocols should provide a mechanism to authenticate the
   routing information carried within the payload, and administrators
   should enable it.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20LDP"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  LDP</span>

   To mitigate LDP's current vulnerability to spoofing attacks, LDP
   needs to be upgraded such that an implementation is able to determine
   the authenticity of the neighbors sending the Hello message.



<span class="grey">Jethanandani, et al.          Informational                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc6952.html">RFC 6952</a>            BGP, LDP, PCEP, and MSDP Analysis           May 2013</span>


   Labels are similar to routing information, which is distributed in
   the clear.  However, there is currently no requirement that the
   labels be encrypted.  Such a requirement is out of scope for this
   document.

   Similarly, it is important to ensure that routers exchanging labels
   are mutually authenticated, and that there are no rogue peers or
   unauthenticated peers that can compromise the stability of the
   network.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Gap%20Analysis%20for%20BGP%2C%20LDP%2C%20PCEP%2C%20and%20MSDP"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Gap Analysis for BGP, LDP, PCEP, and MSDP</span>

   This section outlines the differences between the current state of
   the security methods for routing protocols and the desired state of
   the security methods as outlined in <a href="#section-4.2">Section 4.2</a> of the KARP Design
   Guidelines [<a href="rfc6518.html" title='"Keying and Authentication for Routing Protocols (KARP) Design Guidelines"'>RFC6518</a>].  As that document states, these routing
   protocols fall into the category of one-to-one peering messages and
   will use peer keying protocols.  This section covers issues that are
   common to the four protocols, leaving protocol-specific issues to
   sub-sections.

   At a transport level, these routing protocols are subject to some of
   the same attacks that TCP applications are subject to.  These include
   DoS and spoofing attacks.  "Internet Denial-of-Service
   Considerations" [<a href="rfc4732.html" title='"Internet Denial-of- Service Considerations"'>RFC4732</a>] outlines some solutions.  "Defending TCP
   Against Spoofing Attacks" [<a href="rfc4953.html" title='"Defending TCP Against Spoofing Attacks"'>RFC4953</a>] recommends ways to prevent
   spoofing attacks.  In addition, the recommendations in [<a href="rfc5961.html" title="&quot;Improving TCP's Robustness to Blind In-Window Attacks&quot;">RFC5961</a>]
   should also be followed and implemented to strengthen TCP.

   Routers lack comprehensive key management and keys derived that they
   can use to authenticate data.  As an example, TCP-AO [<a href="rfc5925.html" title='"The TCP Authentication Option"'>RFC5925</a>], talks
   about coordinating keys derived from the Master Key Table (MKT)
   between endpoints, but the MKT itself has to be configured manually
   or through an out-of-band mechanism.  Also, TCP-AO does not address
   the issue of connectionless reset, as it applies to routers that do
   not store MKT across reboots.

   Authentication, integrity protection, and encryption all require the
   use of keys by sender and receiver.  An automated KMP, therefore has
   to include a way to distribute key material between two endpoints
   with little or no administrative overhead.  It has to cover automatic
   key rollover.  It is expected that authentication will cover the
   packet, i.e., the payload and the TCP header, and will not cover the
   frame, i.e., the layer 2 header.

   There are two methods of automatic key rollover.  Implicit key
   rollover can be initiated after a certain volume of data gets
   exchanged or when a certain time has elapsed.  This does not require



<span class="grey">Jethanandani, et al.          Informational                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc6952.html">RFC 6952</a>            BGP, LDP, PCEP, and MSDP Analysis           May 2013</span>


   explicit signaling nor should it result in a reset of the TCP
   connection in a way that the links/adjacencies are affected.  On the
   other hand, explicit key rollover requires an out-of-band key
   signaling mechanism.  It can be triggered by either side and can be
   done anytime a security parameter changes, e.g., an attack has
   happened, or a system administrator with access to the keys has left
   the company.  An example of this is IKEv2 [<a href="rfc5996.html" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC5996</a>], but it could be
   any other new mechanisms also.

   As stated earlier, TCP-AO [<a href="rfc5925.html" title='"The TCP Authentication Option"'>RFC5925</a>] and its accompanying document,
   Cryptographic Algorithms for TCP-AO [<a href="rfc5926.html" title='"Cryptographic Algorithms for the TCP Authentication Option (TCP-AO)"'>RFC5926</a>], require that two MAC
   algorithms be supported, and they are HMAC-SHA-1-96, as specified in
   HMAC [<a href="rfc2104.html" title='"HMAC: Keyed- Hashing for Message Authentication"'>RFC2104</a>], and AES-128-CMAC-96, as specified in NIST-SP800-38B
   [<a href="#ref-NIST-SP800-38B">NIST-SP800-38B</a>].  Therefore, TCP-AO meets the algorithm agility
   requirement.

   There is a need to protect authenticity and validity of the routing/
   label information that is carried in the payload of the sessions.
   However, that is outside the scope of this document and is being
   addressed by the SIDR WG.  Similar mechanisms could be used for
   intra-domain protocols.

   Finally, replay protection is required.  The replay mechanism needs
   to be sufficient to prevent an attacker from creating a denial of
   service or disrupting the integrity of the routing protocol by
   replaying packets.  It is important that an attacker not be able to
   disrupt service by capturing packets and waiting for replay state to
   be lost.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20LDP"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  LDP</span>

   As described in LDP [<a href="rfc5036.html" title='"LDP Specification"'>RFC5036</a>], the threat of spoofed Basic Hellos can
   be reduced by only accepting Basic Hellos on interfaces that LSRs
   trust, employing GTSM [<a href="rfc5082.html" title='"The Generalized TTL Security Mechanism (GTSM)"'>RFC5082</a>], and ignoring Basic Hellos not
   addressed to the "all routers on this subnet" multicast group.
   Spoofing attacks via Targeted Hellos are potentially a more serious
   threat.  An LSR can reduce the threat of spoofed Extended Hellos by
   filtering them and accepting Hellos from sources permitted by access
   lists.  However, performing the filtering using access lists requires
   LSR resources, and the LSR is still vulnerable to the IP source
   address spoofing.  Spoofing attacks can be solved by being able to
   authenticate the Hello messages, and an LSR can be configured to only
   accept Hello messages from specific peers when authentication is in
   use.

   LDP Hello Cryptographic Authentication [<a href="#ref-HELLO-CRYPTO">HELLO-CRYPTO</a>] suggest a new
   Cryptographic Authentication TLV that can be used as an
   authentication mechanism to secure Hello messages.



<span class="grey">Jethanandani, et al.          Informational                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc6952.html">RFC 6952</a>            BGP, LDP, PCEP, and MSDP Analysis           May 2013</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20PCEP"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  PCEP</span>

   Path Computation Element (PCE) discovery, according to [<a href="rfc5440.html" title='"Path Computation Element (PCE) Communication Protocol (PCEP)"'>RFC5440</a>], is
   a significant feature for the successful deployment of PCEP in large
   networks.  This mechanism allows a Path Computation Client (PCC) to
   discover the existence of suitable PCEs within the network without
   the necessity of configuration.  It should be obvious that, where
   PCEs are discovered and not configured, the PCC cannot know the
   correct key to use.  There are different approaches to retain some
   aspect of security, but all of them require use of a keys and a
   keying mechanism, the need for which has been discussed above.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Transition%20and%20Deployment%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Transition and Deployment Considerations</span>

   As stated in the KARP Design Guidelines [<a href="rfc6518.html" title='"Keying and Authentication for Routing Protocols (KARP) Design Guidelines"'>RFC6518</a>], it is imperative
   that the new authentication, security mechanisms, and key management
   protocol support incremental deployment, as it is not feasible to
   deploy the new routing protocol authentication mechanism overnight.

   Typically, authentication and security in a peer-to-peer protocol
   requires that both parties agree to the mechanisms that will be used.
   If an agreement is not reached, the setup of the new mechanism will
   fail or will be deferred.  Upon failure, the routing protocols can
   fall back to the mechanisms that were already in place, e.g., use
   static keys if that was the mechanism in place.  The fallback should
   be configurable on a per-node or per-interface basis.  It is usually
   not possible for one end to use the new mechanism while the other end
   uses the old.  Policies can be put in place to retry upgrading after
   a said period of time, so that manual coordination is not required.

   If the automatic KMP requires use of Public Key Infrastructure
   Certificates [<a href="rfc5280.html" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>] to exchange key material, the required
   Certificate Authority (CA) root certificates may need to be installed
   to verify the authenticity of requests initiated by a peer.  Such a
   step does not require coordination with the peer, except to decide
   which CA authority will be used.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Security Considerations</span>

   This section describes security considerations that BGP, LDP, PCEP,
   and MSDP should try to meet.

   As with all routing protocols, they need protection from both on-path
   and off-path blind attacks.  A better way to protect them would be
   with per-packet protection using a cryptographic MAC.  In order to
   provide for the MAC, keys are needed.





<span class="grey">Jethanandani, et al.          Informational                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc6952.html">RFC 6952</a>            BGP, LDP, PCEP, and MSDP Analysis           May 2013</span>


   The routing protocols need to support algorithm agility, i.e., they
   must not hardwire themselves to one algorithm.

   Once keys are used, mechanisms are required to support key rollover.
   They should cover both manual and automatic key rollover.  Multiple
   approaches could be used.  However, since the existing mechanisms
   provide a protocol field to identify the key as well as management
   mechanisms to introduce and retire new keys, focusing on the existing
   mechanism as a starting point is prudent.

   Furthermore, it is strongly suggested that these routing protocols
   support algorithm agility.  It has been proven that algorithms weaken
   over time.  Supporting algorithm agility assists in smooth
   transitions from old to new algorithms.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Acknowledgements"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Acknowledgements</span>

   We would like to thank Brian Weis for encouraging us to write this
   document, and thanks to Anantha Ramaiah and Mach Chen for providing
   comments on it.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20References"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Normative%20References"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Normative References</span>

   [<a id="ref-RFC5926" name="ref-RFC5926">RFC5926</a>]  Lebovitz, G. and E. Rescorla, "Cryptographic Algorithms
              for the TCP Authentication Option (TCP-AO)", <a href="rfc5926.html">RFC 5926</a>,
              June 2010.

   [<a id="ref-RFC6518" name="ref-RFC6518">RFC6518</a>]  Lebovitz, G. and M. Bhatia, "Keying and Authentication for
              Routing Protocols (KARP) Design Guidelines", <a href="rfc6518.html">RFC 6518</a>,
              February 2012.

   [<a id="ref-RFC6863" name="ref-RFC6863">RFC6863</a>]  Hartman, S. and D. Zhang, "Analysis of OSPF Security
              According to the Keying and Authentication for Routing
              Protocols (KARP) Design Guide", <a href="rfc6863.html">RFC 6863</a>, March 2013.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Informative%20References"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Informative References</span>

   [<a id="ref-HELLO-CRYPTO" name="ref-HELLO-CRYPTO">HELLO-CRYPTO</a>]
              Zheng, L., Chen, M., and M. Bhatia, "LDP Hello
              Cryptographic Authentication", Work in Progress, January
              2013.

   [<a id="ref-NIST-SP800-38B" name="ref-NIST-SP800-38B">NIST-SP800-38B</a>]
              Dworking, , "Recommendation for Block Cipher Modes of
              Operation: The CMAC Mode for Authentication", May 2005.




<span class="grey">Jethanandani, et al.          Informational                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc6952.html">RFC 6952</a>            BGP, LDP, PCEP, and MSDP Analysis           May 2013</span>


   [<a id="ref-RFC2104" name="ref-RFC2104">RFC2104</a>]  Krawczyk, H., Bellare, M., and R. Canetti, "HMAC: Keyed-
              Hashing for Message Authentication", <a href="rfc2104.html">RFC 2104</a>, February
              1997.

   [<a id="ref-RFC2385" name="ref-RFC2385">RFC2385</a>]  Heffernan, A., "Protection of BGP Sessions via the TCP MD5
              Signature Option", <a href="rfc2385.html">RFC 2385</a>, August 1998.

   [<a id="ref-RFC3209" name="ref-RFC3209">RFC3209</a>]  Awduche, D., Berger, L., Gan, D., Li, T., Srinivasan, V.,
              and G. Swallow, "RSVP-TE: Extensions to RSVP for LSP
              Tunnels", <a href="rfc3209.html">RFC 3209</a>, December 2001.

   [<a id="ref-RFC3618" name="ref-RFC3618">RFC3618</a>]  Fenner, B. and D. Meyer, "Multicast Source Discovery
              Protocol (MSDP)", <a href="rfc3618.html">RFC 3618</a>, October 2003.

   [<a id="ref-RFC4271" name="ref-RFC4271">RFC4271</a>]  Rekhter, Y., Li, T., and S. Hares, "A Border Gateway
              Protocol 4 (BGP-4)", <a href="rfc4271.html">RFC 4271</a>, January 2006.

   [<a id="ref-RFC4301" name="ref-RFC4301">RFC4301</a>]  Kent, S. and K. Seo, "Security Architecture for the
              Internet Protocol", <a href="rfc4301.html">RFC 4301</a>, December 2005.

   [<a id="ref-RFC4595" name="ref-RFC4595">RFC4595</a>]  Maino, F. and D. Black, "Use of IKEv2 in the Fibre Channel
              Security Association Management Protocol", <a href="rfc4595.html">RFC 4595</a>, July
              2006.

   [<a id="ref-RFC4674" name="ref-RFC4674">RFC4674</a>]  Le Roux, J.L., "Requirements for Path Computation Element
              (PCE) Discovery", <a href="rfc4674.html">RFC 4674</a>, October 2006.

   [<a id="ref-RFC4732" name="ref-RFC4732">RFC4732</a>]  Handley, M., Rescorla, E., IAB, "Internet Denial-of-
              Service Considerations", <a href="rfc4732.html">RFC 4732</a>, December 2006.

   [<a id="ref-RFC4948" name="ref-RFC4948">RFC4948</a>]  Andersson, L., Davies, E., and L. Zhang, "Report from the
              IAB workshop on Unwanted Traffic March 9-10, 2006", <a href="rfc4948.html">RFC</a>
              <a href="rfc4948.html">4948</a>, August 2007.

   [<a id="ref-RFC4953" name="ref-RFC4953">RFC4953</a>]  Touch, J., "Defending TCP Against Spoofing Attacks", <a href="rfc4953.html">RFC</a>
              <a href="rfc4953.html">4953</a>, July 2007.

   [<a id="ref-RFC5036" name="ref-RFC5036">RFC5036</a>]  Andersson, L., Minei, I., and B. Thomas, "LDP
              Specification", <a href="rfc5036.html">RFC 5036</a>, October 2007.

   [<a id="ref-RFC5082" name="ref-RFC5082">RFC5082</a>]  Gill, V., Heasley, J., Meyer, D., Savola, P., and C.
              Pignataro, "The Generalized TTL Security Mechanism
              (GTSM)", <a href="rfc5082.html">RFC 5082</a>, October 2007.

   [<a id="ref-RFC5088" name="ref-RFC5088">RFC5088</a>]  Le Roux, JL., Vasseur, JP., Ikejiri, Y., and R. Zhang,
              "OSPF Protocol Extensions for Path Computation Element
              (PCE) Discovery", <a href="rfc5088.html">RFC 5088</a>, January 2008.




<span class="grey">Jethanandani, et al.          Informational                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc6952.html">RFC 6952</a>            BGP, LDP, PCEP, and MSDP Analysis           May 2013</span>


   [<a id="ref-RFC5089" name="ref-RFC5089">RFC5089</a>]  Le Roux, JL., Vasseur, JP., Ikejiri, Y., and R. Zhang,
              "IS-IS Protocol Extensions for Path Computation Element
              (PCE) Discovery", <a href="rfc5089.html">RFC 5089</a>, January 2008.

   [<a id="ref-RFC5280" name="ref-RFC5280">RFC5280</a>]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
              Housley, R., and W. Polk, "Internet X.509 Public Key
              Infrastructure Certificate and Certificate Revocation List
              (CRL) Profile", <a href="rfc5280.html">RFC 5280</a>, May 2008.

   [<a id="ref-RFC5440" name="ref-RFC5440">RFC5440</a>]  Vasseur, JP. and JL. Le Roux, "Path Computation Element
              (PCE) Communication Protocol (PCEP)", <a href="rfc5440.html">RFC 5440</a>, March
              2009.

   [<a id="ref-RFC5920" name="ref-RFC5920">RFC5920</a>]  Fang, L., "Security Framework for MPLS and GMPLS
              Networks", <a href="rfc5920.html">RFC 5920</a>, July 2010.

   [<a id="ref-RFC5925" name="ref-RFC5925">RFC5925</a>]  Touch, J., Mankin, A., and R. Bonica, "The TCP
              Authentication Option", <a href="rfc5925.html">RFC 5925</a>, June 2010.

   [<a id="ref-RFC5961" name="ref-RFC5961">RFC5961</a>]  Ramaiah, A., Stewart, R., and M. Dalal, "Improving TCP's
              Robustness to Blind In-Window Attacks", <a href="rfc5961.html">RFC 5961</a>, August
              2010.

   [<a id="ref-RFC5996" name="ref-RFC5996">RFC5996</a>]  Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen,
              "Internet Key Exchange Protocol Version 2 (IKEv2)", <a href="rfc5996.html">RFC</a>
              <a href="rfc5996.html">5996</a>, September 2010.

   [<a id="ref-RFC6039" name="ref-RFC6039">RFC6039</a>]  Manral, V., Bhatia, M., Jaeggli, J., and R. White, "Issues
              with Existing Cryptographic Protection Methods for Routing
              Protocols", <a href="rfc6039.html">RFC 6039</a>, October 2010.

   [<a id="ref-RFC6151" name="ref-RFC6151">RFC6151</a>]  Turner, S. and L. Chen, "Updated Security Considerations
              for the MD5 Message-Digest and the HMAC-MD5 Algorithms",
              <a href="rfc6151.html">RFC 6151</a>, March 2011.

   [<a id="ref-RFC6480" name="ref-RFC6480">RFC6480</a>]  Lepinski, M. and S. Kent, "An Infrastructure to Support
              Secure Internet Routing", <a href="rfc6480.html">RFC 6480</a>, February 2012.














<span class="grey">Jethanandani, et al.          Informational                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc6952.html">RFC 6952</a>            BGP, LDP, PCEP, and MSDP Analysis           May 2013</span>


Authors' Addresses

   Mahesh Jethanandani
   Ciena Corporation
   1741 Technology Drive
   San Jose, CA  95110
   USA

   Phone: +1 (408) 436-3313
   EMail: mjethanandani@gmail.com


   Keyur Patel
   Cisco Systems, Inc
   170 Tasman Drive
   San Jose, CA  95134
   USA

   Phone: +1 (408) 526-7183
   EMail: keyupate@cisco.com


   Lianshu Zheng
   Huawei Technologies
   China

   Phone: +86 (10) 82882008
   EMail: vero.zheng@huawei.com























Jethanandani, et al.          Informational                    [Page 17]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc6952 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:25 GMT --></html>