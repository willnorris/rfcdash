<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7428 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 28 Apr 2015 16:00:45 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.111" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="   This document describes the frame format for transmission of IPv6
   packets as well as a method of forming IPv6 link-local addresses and
   statelessly autoconfigured IPv6 addresses on ITU-T G.9959 networks.
" name="DC.Description.Abstract"/>
<meta content="Brandt, Anders" name="DC.Creator"/>
<meta content="Buron, Jakob" name="DC.Creator"/>
<meta content="Transmission of IPv6 Packets over ITU-T G.9959 Networks" name="DC.Title"/>

    <link href="http://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="http://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7428 - Transmission of IPv6 Packets over ITU-T G.9959 Networks</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgwhite" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc7428.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc7428" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-ietf-6lo-lowpanz" title="draft-ietf-6lo-lowpanz">draft-ietf-6lo-lo...</a>]                                 </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                         A. Brandt
Request for Comments: 7428                                      J. Buron
Category: Standards Track                                  Sigma Designs
ISSN: 2070-1721                                            February 2015


        <span class="h1">Transmission of IPv6 Packets over ITU-T G.9959 Networks</span>

Abstract

   This document describes the frame format for transmission of IPv6
   packets as well as a method of forming IPv6 link-local addresses and
   statelessly autoconfigured IPv6 addresses on ITU-T G.9959 networks.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7428">http://www.rfc-editor.org/info/rfc7428</a>.

Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in <a href="#section-4">Section 4</a>.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.









<span class="grey">Brandt &amp; Buron               Standards Track                    [Page 1]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
      <a href="#section-1.1">1.1</a>. Terms Used .................................................<a href="#page-3">3</a>
      <a href="#section-1.2">1.2</a>. Requirements Language ......................................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. G.9959 Parameters to Use for IPv6 Transport .....................<a href="#page-5">5</a>
      <a href="#section-2.1">2.1</a>. Addressing Mode ............................................<a href="#page-5">5</a>
      <a href="#section-2.2">2.2</a>. IPv6 Multicast Support .....................................<a href="#page-6">6</a>
      <a href="#section-2.3">2.3</a>. G.9959 MAC PDU Size and IPv6 MTU ...........................<a href="#page-6">6</a>
      <a href="#section-2.4">2.4</a>. Transmission Status Indications ............................<a href="#page-7">7</a>
      <a href="#section-2.5">2.5</a>. Transmission Security ......................................<a href="#page-7">7</a>
   <a href="#section-3">3</a>. 6LoWPAN Adaptation Layer and Frame Format .......................<a href="#page-7">7</a>
      <a href="#section-3.1">3.1</a>. Dispatch Header ............................................<a href="#page-8">8</a>
   <a href="#section-4">4</a>. 6LoWPAN Addressing ..............................................<a href="#page-9">9</a>
      4.1. Stateless Address Autoconfiguration of Routable IPv6
           Addresses ..................................................<a href="#page-9">9</a>
      <a href="#section-4.2">4.2</a>. IPv6 Link-Local Address ...................................<a href="#page-10">10</a>
      <a href="#section-4.3">4.3</a>. Unicast Address Mapping ...................................<a href="#page-10">10</a>
      <a href="#section-4.4">4.4</a>. On the Use of Neighbor Discovery Technologies .............<a href="#page-11">11</a>
           <a href="#section-4.4.1">4.4.1</a>. Prefix and CID Management (Route-Over) .............<a href="#page-11">11</a>
           <a href="#section-4.4.2">4.4.2</a>. Prefix and CID Management (Mesh-Under) .............<a href="#page-11">11</a>
   <a href="#section-5">5</a>. Header Compression .............................................<a href="#page-12">12</a>
   <a href="#section-6">6</a>. Security Considerations ........................................<a href="#page-13">13</a>
   <a href="#section-7">7</a>. Privacy Considerations .........................................<a href="#page-14">14</a>
   <a href="#section-8">8</a>. References .....................................................<a href="#page-14">14</a>
      <a href="#section-8.1">8.1</a>. Normative References ......................................<a href="#page-14">14</a>
      <a href="#section-8.2">8.2</a>. Informative References ....................................<a href="#page-16">16</a>
   <a href="#appendix-A">Appendix A</a>. G.9959 6LoWPAN Datagram Example .......................<a href="#page-17">17</a>
   Acknowledgements ..................................................<a href="#page-21">21</a>
   Authors' Addresses ................................................<a href="#page-21">21</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The ITU-T G.9959 recommendation [<a href="#ref-G.9959" title='"Short range narrow-band digital radiocommunication transceivers - PHY and MAC layer specifications"'>G.9959</a>] targets low-power Personal
   Area Networks (PANs).  This document defines the frame format for
   transmission of IPv6 [<a href="rfc2460.html" title='"Internet Protocol, Version 6 (IPv6) Specification"'>RFC2460</a>] packets as well as the formation of
   IPv6 link-local addresses and statelessly autoconfigured IPv6
   addresses on G.9959 networks.

   The general approach is to adapt elements of [<a href="rfc4944.html" title='"Transmission of IPv6 Packets over IEEE 802.15.4 Networks"'>RFC4944</a>] to G.9959
   networks.  G.9959 provides a Segmentation and Reassembly (SAR) layer
   for transmission of datagrams larger than the G.9959 Media Access
   Control Protocol Data Unit (MAC PDU).

   [<a id="ref-RFC6775" name="ref-RFC6775">RFC6775</a>] updates [<a href="rfc4944.html" title='"Transmission of IPv6 Packets over IEEE 802.15.4 Networks"'>RFC4944</a>] by specifying IPv6 over Low-Power
   Wireless Personal Area Network (6LoWPAN) optimizations for IPv6
   Neighbor Discovery (ND) (originally defined by [<a href="rfc4861.html" title='"Neighbor Discovery for IP version 6 (IPv6)"'>RFC4861</a>]).  This
   document limits the use of [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>] to prefix and Context ID



<span class="grey">Brandt &amp; Buron               Standards Track                    [Page 2]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


   assignment.  An Interface Identifier (IID) may be constructed from a
   G.9959 link-layer address, leading to a "link-layer-derived IPv6
   address".  If using that method, Duplicate Address Detection (DAD) is
   not needed.  Alternatively, IPv6 addresses may be assigned centrally
   via DHCP, leading to a "non-link-layer-derived IPv6 address".
   Address registration is only needed in certain cases.

   In addition to IPv6 application communication, the frame format
   defined in this document may be used by IPv6 routing protocols such
   as the Routing Protocol for Low-Power and Lossy Networks (RPL)
   [<a href="rfc6550.html" title='"RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks"'>RFC6550</a>] or Reactive Discovery of Point-to-Point Routes in Low-Power
   and Lossy Networks (P2P-RPL) [<a href="rfc6997.html" title='"Reactive Discovery of Point-to-Point Routes in Low-Power and Lossy Networks"'>RFC6997</a>] to implement IPv6 routing over
   G.9959 networks.

   The encapsulation frame defined by this specification may optionally
   be transported via mesh routing below the 6LoWPAN layer.  Mesh-under
   and route-over routing protocol specifications are out of scope for
   this document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Terms%20Used"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Terms Used</span>

   6LoWPAN: IPv6 over Low-Power Wireless Personal Area Network

   ABR: Authoritative 6LoWPAN Border Router (Authoritative 6LBR)
      [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>]

   Ack: Acknowledgement

   AES: Advanced Encryption Standard

   CID: Context Identifier [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>]

   DAD: Duplicate Address Detection [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>]

   DHCPv6: Dynamic Host Configuration Protocol for IPv6 [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>]

   EUI-64: Extended Unique Identifier [<a href="#ref-EUI64" title='"Guidelines for 64-bit Global Identifier (EUI-64TM)"'>EUI64</a>]

   G.9959: Short range narrow-band digital radiocommunication
      transceiver [<a href="#ref-G.9959" title='"Short range narrow-band digital radiocommunication transceivers - PHY and MAC layer specifications"'>G.9959</a>]

   GHC: Generic Header Compression [<a href="rfc7400.html" title='"6LoWPAN-GHC: Generic Header Compression for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC7400</a>]

   HomeID: G.9959 Link-Layer Network Identifier

   IID: Interface Identifier





<span class="grey">Brandt &amp; Buron               Standards Track                    [Page 3]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


   Link-layer-derived address: IPv6 address constructed on the basis of
      link-layer address information

   MAC: Media Access Control

   Mesh-under: Forwarding via mesh routing below the 6LoWPAN layer

   MTU: Maximum Transmission Unit

   ND: Neighbor Discovery [<a href="rfc4861.html" title='"Neighbor Discovery for IP version 6 (IPv6)"'>RFC4861</a>] [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>]

   NodeID: G.9959 Link-Layer Node Identifier

   Non-link-layer-derived address: IPv6 address assigned by a managed
      process, e.g., DHCPv6

   P2P-RPL: Reactive Discovery of Point-to-Point Routes in Low-Power and
      Lossy Networks [<a href="rfc6997.html" title='"Reactive Discovery of Point-to-Point Routes in Low-Power and Lossy Networks"'>RFC6997</a>]

   PAN: Personal Area Network

   PDU: Protocol Data Unit

   PHY: Physical Layer

   RA: Router Advertisement [<a href="rfc4861.html" title='"Neighbor Discovery for IP version 6 (IPv6)"'>RFC4861</a>] [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>]

   Route-over: Forwarding via IP routing above the 6LoWPAN layer

   RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks [<a href="rfc6550.html" title='"RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks"'>RFC6550</a>]

   SAR: G.9959 Segmentation and Reassembly

   ULA: Unique Local Address [<a href="rfc4193.html" title='"Unique Local IPv6 Unicast Addresses"'>RFC4193</a>]

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Requirements%20Language"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Requirements Language</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].











<span class="grey">Brandt &amp; Buron               Standards Track                    [Page 4]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20G.9959%20Parameters%20to%20Use%20for%20IPv6%20Transport"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  G.9959 Parameters to Use for IPv6 Transport</span>

   This section outlines properties applying to the PHY and MAC layers
   of G.9959 and how to use these for IPv6 transport.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Addressing%20Mode"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Addressing Mode</span>

   G.9959 defines how a unique 32-bit HomeID network identifier is
   assigned by a network controller and how an 8-bit NodeID host
   identifier is allocated to each node.  NodeIDs are unique within the
   network identified by the HomeID.  The G.9959 HomeID represents an
   IPv6 subnet that is identified by one or more IPv6 prefixes.

   An IPv6 host MUST construct its link-local IPv6 address from the
   link-layer-derived IID in order to facilitate IP header compression
   as described in [<a href="rfc6282.html" title='"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"'>RFC6282</a>].

   A node interface MAY support the M flag of the RA message for the
   construction of routable IPv6 addresses.  A cost-optimized node
   implementation may save memory by skipping support for the M flag.
   The M flag MUST be interpreted as defined in Figure 1.

    +--------+--------+---------------------------------------------+
    | M flag | M flag |  Required node behavior                     |
    | support| value  |                                             |
    +--------+--------+---------------------------------------------+
    | No     |(ignore)| Node MUST use link-layer-derived addressing |
    +--------+--------+---------------------------------------------+
    | Yes    |    0   | Node MUST use link-layer-derived addressing |
    |        +--------+---------------------------------------------+
    |        |    1   | Node MUST use DHCPv6-based addressing, and  |
    |        |        | node MUST comply fully with [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>]       |
    +--------+--------+---------------------------------------------+

              Figure 1: RA M Flag Support and Interpretation

   A node that uses DHCPv6-based addressing MUST comply fully with the
   text of [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>].

   If DHCPv6-based addressing is used, the DHCPv6 client must use a
   DHCPv6 Unique Identifier (DUID) of type DUID-UUID, as described in
   [<a href="rfc6355.html" title='"Definition of the UUID-Based DHCPv6 Unique Identifier (DUID-UUID)"'>RFC6355</a>].  The Universally Unique Identifier (UUID) used in the
   DUID-UUID must be generated as specified in <a href="rfc4122.html#section-4.5">[RFC4122], Section 4.5</a>,
   starting at the third paragraph in that section (the 47-bit random
   number-based UUID).  The DUID must be stored persistently by the node
   as specified in <a href="rfc6355.html#section-3">Section 3 of [RFC6355]</a>.





<span class="grey">Brandt &amp; Buron               Standards Track                    [Page 5]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


   A word of caution: since HomeIDs and NodeIDs are handed out by a
   network controller function during inclusion, identifier validity and
   uniqueness are limited by the lifetime of the network membership.
   This can be cut short by a mishap occurring at the network
   controller.  Having a single point of failure at the network
   controller suggests that high-reliability network deployments may
   benefit from a redundant network controller function.

   This warning applies to link-layer-derived addressing as well as to
   non-link-layer-derived addressing deployments.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20IPv6%20Multicast%20Support"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  IPv6 Multicast Support</span>

   [<a id="ref-RFC3819" name="ref-RFC3819">RFC3819</a>] recommends that IP subnetworks support (subnet-wide)
   multicast.  G.9959 supports direct-range IPv6 multicast, while
   subnet-wide multicast is not supported natively by G.9959.  Subnet-
   wide multicast may be provided by an IP routing protocol or a mesh
   routing protocol operating below the 6LoWPAN layer.  Routing protocol
   specifications are out of scope for this document.

   IPv6 multicast packets MUST be carried via G.9959 broadcast.

   As per [<a href="#ref-G.9959" title='"Short range narrow-band digital radiocommunication transceivers - PHY and MAC layer specifications"'>G.9959</a>], this is accomplished as follows:

   1.  The destination HomeID of the G.9959 MAC PDU MUST be the HomeID
       of the network.

   2.  The destination NodeID of the G.9959 MAC PDU MUST be the
       broadcast NodeID (0xff).

   G.9959 broadcast MAC PDUs are only intercepted by nodes within the
   network identified by the HomeID.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20G.9959%20MAC%20PDU%20Size%20and%20IPv6%20MTU"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  G.9959 MAC PDU Size and IPv6 MTU</span>

   IPv6 packets MUST be transmitted using G.9959 transmission profile R3
   or higher.

   [<a id="ref-RFC2460" name="ref-RFC2460">RFC2460</a>] specifies that any link that cannot convey a 1280-octet
   packet in one piece must provide link-specific fragmentation and
   reassembly at a layer below IPv6.

   G.9959 provides segmentation and reassembly for payloads up to
   1350 octets.  IPv6 header compression [<a href="rfc6282.html" title='"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"'>RFC6282</a>] improves the chances
   that a short IPv6 packet can fit into a single G.9959 frame.
   Therefore, <a href="#section-3">Section 3</a> of this document specifies that [<a href="rfc6282.html" title='"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"'>RFC6282</a>] MUST
   be supported.  With the mandatory link-layer security enabled, a
   G.9959 R3 MAC PDU may accommodate 6LoWPAN datagrams of up to



<span class="grey">Brandt &amp; Buron               Standards Track                    [Page 6]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


   130 octets without triggering G.9959 segmentation and reassembly.
   Longer 6LoWPAN datagrams will lead to the transmission of multiple
   G.9959 PDUs.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.4.%20%20Transmission%20Status%20Indications"></a><a class="selflink" href="#section-2.4" name="section-2.4">2.4</a>.  Transmission Status Indications</span>

   The G.9959 MAC layer provides native acknowledgement and
   retransmission of MAC PDUs.  The G.9959 SAR layer does the same for
   larger datagrams.  A mesh routing layer may provide a similar feature
   for routed communication.  An IPv6 routing stack communicating over
   G.9959 may utilize link-layer status indications such as delivery
   confirmation and Ack timeout from the MAC layer.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.5.%20%20Transmission%20Security"></a><a class="selflink" href="#section-2.5" name="section-2.5">2.5</a>.  Transmission Security</span>

   Implementations claiming conformance with this document MUST enable
   G.9959 shared network key security.

   The shared network key is intended to address security requirements
   in the home at the normal level of security requirements.  For
   applications with high or very high requirements for confidentiality
   and/or integrity, additional application-layer security measures for
   end-to-end authentication and encryption may need to be applied.
   (The availability of the network relies on the security properties of
   the network key in any case.)

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%206LoWPAN%20Adaptation%20Layer%20and%20Frame%20Format"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  6LoWPAN Adaptation Layer and Frame Format</span>

   The 6LoWPAN encapsulation formats defined in this section are carried
   as payload in the G.9959 MAC PDU.  IPv6 header compression [<a href="rfc6282.html" title='"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"'>RFC6282</a>]
   MUST be supported by implementations of this specification.  Further,
   implementations MAY support Generic Header Compression (GHC)
   [<a href="rfc7400.html" title='"6LoWPAN-GHC: Generic Header Compression for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC7400</a>].  A node implementing [<a href="rfc7400.html" title='"6LoWPAN-GHC: Generic Header Compression for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC7400</a>] MUST probe its peers for
   GHC support before applying GHC.

   All 6LoWPAN datagrams transported over G.9959 are prefixed by a
   6LoWPAN encapsulation header stack.  The 6LoWPAN payload follows this
   encapsulation header stack.  Each header in the header stack contains
   a header type followed by zero or more header fields.  An IPv6 header
   stack may contain, in the following order, addressing, hop-by-hop
   options, routing, fragmentation, destination options, and, finally,
   payload [<a href="rfc2460.html" title='"Internet Protocol, Version 6 (IPv6) Specification"'>RFC2460</a>].  The 6LoWPAN header format is structured the same
   way.  Currently, only one payload option is defined for the G.9959
   6LoWPAN header format.







<span class="grey">Brandt &amp; Buron               Standards Track                    [Page 7]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


   The definition of 6LoWPAN headers consists of the dispatch value, the
   definition of the header fields that follow, and their ordering
   constraints relative to all other headers.  Although the header stack
   structure provides a mechanism to address future demands on the
   6LoWPAN adaptation layer, it is not intended to provide general-
   purpose extensibility.

   An example of a complete G.9959 6LoWPAN datagram can be found in
   <a href="#appendix-A">Appendix A</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Dispatch%20Header"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Dispatch Header</span>

   The Dispatch Header is shown below:

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | 6LoWPAN CmdCls|   Dispatch    |  Type-specific header         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                    Figure 2: Dispatch Type and Header

   6LoWPAN CmdCls: 6LoWPAN Command Class identifier.  This field MUST
      carry the value 0x4F [<a href="#ref-G.9959" title='"Short range narrow-band digital radiocommunication transceivers - PHY and MAC layer specifications"'>G.9959</a>].  The value is assigned by the ITU-T
      and specifies that the following bits are a 6LoWPAN encapsulated
      datagram.  6LoWPAN protocols MUST ignore the G.9959 frame if the
      6LoWPAN Command Class identifier deviates from 0x4F.

   Dispatch: Identifies the header type immediately following the
      Dispatch Header.

   Type-specific header: A header determined by the Dispatch Header.

   The dispatch value may be treated as an unstructured namespace.  Only
   a few symbols are required to represent current 6LoWPAN
   functionality.  Although some additional savings could be achieved by
   encoding additional functionality into the dispatch byte, these
   measures would tend to constrain the ability to address future
   alternatives.












<span class="grey">Brandt &amp; Buron               Standards Track                    [Page 8]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


              +------------+--------------------+-----------+
              | Pattern    | Header Type        | Reference |
              +------------+--------------------+-----------+
              | 01  1xxxxx | 6LoWPAN_IPHC       | [<a href="rfc6282.html" title='"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"'>RFC6282</a>] |
              +------------+--------------------+-----------+

              Other IANA-assigned 6LoWPAN dispatch values do not
              apply to this document.

                         Figure 3: Dispatch Values

   6LoWPAN_IPHC: IPv6 Header Compression.  Refer to [<a href="rfc6282.html" title='"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"'>RFC6282</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%206LoWPAN%20Addressing"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  6LoWPAN Addressing</span>

   IPv6 addresses may be autoconfigured from IIDs that may again be
   constructed from link-layer address information to save memory in
   devices and to facilitate efficient IP header compression as per
   [<a href="rfc6282.html" title='"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"'>RFC6282</a>].  Link-layer-derived addresses have a static nature and may
   involuntarily expose private usage data on public networks.  Refer to
   <a href="#section-7">Section 7</a>.

   A NodeID is mapped into an IEEE EUI-64 identifier as follows:

                        IID = 0000:00ff:fe00:YYXX

                 Figure 4: Constructing a Compressible IID

   where XX carries the G.9959 NodeID and YY is a 1-byte value chosen by
   the individual node.  The default YY value MUST be zero.  A node MAY
   use values of YY other than zero to form additional IIDs in order to
   instantiate multiple IPv6 interfaces.  The YY value MUST be ignored
   when computing the corresponding NodeID (the XX value) from an IID.

   The method of constructing IIDs from the link-layer address obviously
   does not support addresses assigned or constructed by other means.  A
   node MUST NOT compute the NodeID from the IID if the first 6 bytes of
   the IID do not comply with the format defined in Figure 4.  In that
   case, the address resolution mechanisms of [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>] apply.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Stateless%20Address%20Autoconfiguration%20of%20Routable%20IPv6%20Addresses"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Stateless Address Autoconfiguration of Routable IPv6 Addresses</span>

   The IID defined above MUST be used whether autoconfiguring a ULA IPv6
   address [<a href="rfc4193.html" title='"Unique Local IPv6 Unicast Addresses"'>RFC4193</a>] or a globally routable IPv6 address [<a href="rfc3587.html" title='"IPv6 Global Unicast Address Format"'>RFC3587</a>] in
   G.9959 subnets.






<span class="grey">Brandt &amp; Buron               Standards Track                    [Page 9]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20IPv6%20Link-Local%20Address"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  IPv6 Link-Local Address</span>

   The IPv6 link-local address [<a href="rfc4291.html" title='"IP Version 6 Addressing Architecture"'>RFC4291</a>] for a G.9959 interface is
   formed by appending the IID defined above to the IPv6 link-local
   prefix fe80::/64.

   The "Universal/Local" (U/L) bit MUST be set to zero in keeping with
   the fact that this is not a globally unique value [<a href="#ref-EUI64" title='"Guidelines for 64-bit Global Identifier (EUI-64TM)"'>EUI64</a>].

   The resulting link-local address is formed as follows:

        10 bits            54 bits                  64 bits
     +----------+-----------------------+----------------------------+
     |1111111010|         (zeros)       | Interface Identifier (IID) |
     +----------+-----------------------+----------------------------+

                     Figure 5: IPv6 Link-Local Address

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Unicast%20Address%20Mapping"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Unicast Address Mapping</span>

   The address resolution procedure for mapping IPv6 unicast addresses
   into G.9959 link-layer addresses follows the general description in
   <a href="rfc4861.html#section-7.2">Section 7.2 of [RFC4861]</a>.  The Source/Target Link-layer Address
   option MUST have the following form when the link layer is G.9959.

                      0                   1
                      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                     |     Type      |    Length=1   |
                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                     |     0x00      |    NodeID     |
                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                     |            Padding            |
                     +-                             -+
                     |          (All zeros)          |
                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                  Figure 6: IPv6 Unicast Address Mapping

   Option fields:

   Type:  The value 1 signifies the Source Link-layer address.  The
      value 2 signifies the Destination Link-layer address.

   Length:  This is the length of this option (including the Type and
      Length fields) in units of 8 octets.  The value of this field is
      always 1 for G.9959 NodeIDs.




<span class="grey">Brandt &amp; Buron               Standards Track                   [Page 10]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


   NodeID:  This is the G.9959 NodeID to which the actual interface
      currently responds.  The link-layer address may change if the
      interface joins another network at a later time.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.4.%20%20On%20the%20Use%20of%20Neighbor%20Discovery%20Technologies"></a><a class="selflink" href="#section-4.4" name="section-4.4">4.4</a>.  On the Use of Neighbor Discovery Technologies</span>

   [<a id="ref-RFC4861" name="ref-RFC4861">RFC4861</a>] specifies how IPv6 nodes may resolve link-layer addresses
   from IPv6 addresses via the use of link-local IPv6 multicast.
   [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>] is an optimization of [<a href="rfc4861.html" title='"Neighbor Discovery for IP version 6 (IPv6)"'>RFC4861</a>], specifically targeting
   6LoWPAN networks.  [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>] defines how a 6LoWPAN node may register
   IPv6 addresses with an authoritative border router (ABR).  Mesh-under
   networks MUST NOT use [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>] address registration.  However,
   [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>] address registration MUST be used if the first 6 bytes of
   the IID do not comply with the format defined in Figure 4.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.4.1.%20%20Prefix%20and%20CID%20Management%20%28Route-Over%29"></a><a class="selflink" href="#section-4.4.1" name="section-4.4.1">4.4.1</a>.  Prefix and CID Management (Route-Over)</span>

   In route-over environments, IPv6 hosts MUST use [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>] address
   registration.  A node implementation for route-over operation MAY use
   [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>] mechanisms for obtaining IPv6 prefixes and corresponding
   header compression context information [<a href="rfc6282.html" title='"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"'>RFC6282</a>].  [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>] route-
   over requirements apply with no modifications.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.4.2.%20%20Prefix%20and%20CID%20Management%20%28Mesh-Under%29"></a><a class="selflink" href="#section-4.4.2" name="section-4.4.2">4.4.2</a>.  Prefix and CID Management (Mesh-Under)</span>

   An implementation for mesh-under operation MUST use [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>]
   mechanisms for managing IPv6 prefixes and corresponding header
   compression context information [<a href="rfc6282.html" title='"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"'>RFC6282</a>].  [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>] Duplicate
   Address Detection (DAD) MUST NOT be used, since the link-layer
   inclusion process of G.9959 ensures that a NodeID is unique for a
   given HomeID.

   With this exception and the specific redefinition of the RA Router
   Lifetime value 0xFFFF (refer to <a href="#section-4.4.2.3">Section 4.4.2.3</a>), the text of the
   following subsections is in compliance with [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>].

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.4.2.1.%20%20Prefix%20Assignment%20Considerations"></a><a class="selflink" href="#section-4.4.2.1" name="section-4.4.2.1">4.4.2.1</a>.  Prefix Assignment Considerations</span>

   As stated by [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>], an ABR is responsible for managing
   prefix(es).  Global routable prefixes may change over time.  It is
   RECOMMENDED that a ULA prefix is assigned to the 6LoWPAN subnet to
   facilitate stable site-local application associations based on IPv6
   addresses.  A node MAY support the M flag of the RA message.  This
   influences the way IPv6 addresses are assigned.  Refer to <a href="#section-2.1">Section 2.1</a>
   for details.






<span class="grey">Brandt &amp; Buron               Standards Track                   [Page 11]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.4.2.2.%20%20Robust%20and%20Efficient%20CID%20Management"></a><a class="selflink" href="#section-4.4.2.2" name="section-4.4.2.2">4.4.2.2</a>.  Robust and Efficient CID Management</span>

   The 6LoWPAN Context Option (6CO) is used according to [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>] in an
   RA to disseminate Context IDs (CIDs) to use for compressing prefixes.
   One or more prefixes and corresponding Context IDs MUST be assigned
   during initial node inclusion.

   When updating context information, a CID may have its lifetime set to
   zero to obsolete it.  The CID MUST NOT be reused immediately; rather,
   the next vacant CID should be assigned.  Header compression based on
   CIDs MUST NOT be used for RA messages carrying context information.
   An expired CID and the associated prefix MUST NOT be reset but rather
   must be retained in receive-only mode if there is no other current
   need for the CID value.  This will allow an ABR to detect if a
   sleeping node without a clock uses an expired CID, and in response,
   the ABR MUST return an RA with fresh context information to the
   originator.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.4.2.3.%20%20Infinite%20Prefix%20Lifetime%20Support%20for%20Island-Mode%20Networks"></a><a class="selflink" href="#section-4.4.2.3" name="section-4.4.2.3">4.4.2.3</a>.  Infinite Prefix Lifetime Support for Island-Mode Networks</span>

   Nodes MUST renew the prefix and CID according to the lifetime
   signaled by the ABR.  [<a href="rfc6775.html" title='"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC6775</a>] specifies that the maximum value of
   the RA Router Lifetime field MAY be up to 0xFFFF.  This document
   further specifies that the value 0xFFFF MUST be interpreted as
   infinite lifetime.  This value MUST NOT be used by ABRs.  Its use is
   only intended for a sleeping network controller -- for instance, a
   battery-powered remote control being master for a small island-mode
   network of light modules.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Header%20Compression"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Header Compression</span>

   IPv6 header compression [<a href="rfc6282.html" title='"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"'>RFC6282</a>] MUST be implemented, and GHC
   [<a href="rfc7400.html" title='"6LoWPAN-GHC: Generic Header Compression for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC7400</a>] compression for higher layers MAY be implemented.  This
   section will simply identify substitutions that should be made when
   interpreting the text of [<a href="rfc6282.html" title='"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"'>RFC6282</a>] and [<a href="rfc7400.html" title='"6LoWPAN-GHC: Generic Header Compression for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"'>RFC7400</a>].

   In general, the following substitutions should be made:

   o  Replace "802.15.4" with "G.9959".

   o  Replace "802.15.4 short address" with "&lt;Interface&gt;&lt;G.9959
      NodeID&gt;".

   o  Replace "802.15.4 PAN ID" with "G.9959 HomeID".







<span class="grey">Brandt &amp; Buron               Standards Track                   [Page 12]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


   When a 16-bit address is called for (i.e., an IEEE 802.15.4 "short
   address"), it MUST be formed by prepending an Interface label byte to
   the G.9959 NodeID:

                      0                   1
                      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                     |   Interface   |    NodeID     |
                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   A transmitting node may be sending to an IPv6 destination address
   that can be reconstructed from the link-layer destination address.
   If the Interface number is zero (the default value), all IPv6 address
   bytes may be elided.  Likewise, the Interface number of a fully
   elided IPv6 address (i.e., SAM/DAM=11) may be reconstructed to the
   value zero by a receiving node.

   64-bit 802.15.4 address details do not apply.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Security Considerations</span>

   The method of derivation of Interface Identifiers from 8-bit NodeIDs
   preserves uniqueness within the network.  However, there is no
   protection from duplication through forgery.  Neighbor Discovery in
   G.9959 links may be susceptible to threats as detailed in [<a href="rfc3756.html" title='"IPv6 Neighbor Discovery (ND) Trust Models and Threats"'>RFC3756</a>].
   G.9959 networks may feature mesh routing.  This implies additional
   threats due to ad hoc routing as per [<a href="#ref-KW03" title='"Secure Routing in Sensor Networks: Attacks and Countermeasures"'>KW03</a>].  G.9959 provides
   capability for link-layer security.  G.9959 nodes MUST use link-layer
   security with a shared key.  Doing so will alleviate the majority of
   threats stated above.  A sizable portion of G.9959 devices is
   expected to always communicate within their PAN (i.e., within their
   subnet, in IPv6 terms).  In response to cost and power consumption
   considerations, these devices will typically implement the minimum
   set of features necessary.  Accordingly, security for such devices
   may rely on the mechanisms defined at the link layer by G.9959.
   G.9959 relies on the Advanced Encryption Standard (AES) for
   authentication and encryption of G.9959 frames and further employs
   challenge-response handshaking to prevent replay attacks.

   It is also expected that some G.9959 devices (e.g., billing and/or
   safety-critical products) will implement coordination or integration
   functions.  These may communicate regularly with IPv6 peers outside
   the subnet.  Such IPv6 devices are expected to secure their end-to-
   end communications with standard security mechanisms (e.g., IPsec,
   Transport Layer Security (TLS), etc.).






<span class="grey">Brandt &amp; Buron               Standards Track                   [Page 13]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Privacy%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Privacy Considerations</span>

   IP addresses may be used to track devices on the Internet; such
   devices can in turn be linked to individuals and their activities.
   Depending on the application and the actual use pattern, this may be
   undesirable.  To impede tracking, globally unique and non-changing
   characteristics of IP addresses should be avoided, e.g., by
   frequently changing the global prefix and avoiding unique link-layer-
   derived IIDs in addresses.

   Some link layers use a 48-bit or 64-bit link-layer address that
   uniquely identifies the node on a global scale, regardless of global
   prefix changes.  The risk of exposing a G.9959 device from its
   link-layer-derived IID is limited because of the short 8-bit
   link-layer address.

   While intended for central address management, DHCPv6 address
   assignment also decouples the IPv6 address from the link-layer
   address.  Addresses may be made dynamic by the use of a short DHCP
   lease period and an assignment policy that makes the DHCP server hand
   out a fresh IP address every time.  For enhanced privacy, the
   DHCP-assigned addresses should be logged only for the duration of the
   lease, provided the implementation also allows logging for longer
   durations as per the operational policies.

   It should be noted that privacy and frequently changing address
   assignments come at a cost.  Non-link-layer-derived IIDs require the
   use of address registration.  Further, non-link-layer-derived IIDs
   cannot be compressed; this leads to longer datagrams and increased
   link-layer segmentation.  Finally, frequent prefix changes
   necessitate more Context Identifier updates; this not only leads to
   increased traffic but also may affect the battery lifetime of
   sleeping nodes.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20References"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Normative%20References"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Normative References</span>

   [<a id="ref-G.9959" name="ref-G.9959">G.9959</a>]   International Telecommunication Union, "Short range
              narrow-band digital radiocommunication transceivers - PHY
              and MAC layer specifications", ITU-T Recommendation
              G.9959, January 2015,
              &lt;<a href="http://www.itu.int/rec/T-REC-G.9959">http://www.itu.int/rec/T-REC-G.9959</a>&gt;.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.




<span class="grey">Brandt &amp; Buron               Standards Track                   [Page 14]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


   [<a id="ref-RFC2460" name="ref-RFC2460">RFC2460</a>]  Deering, S. and R. Hinden, "Internet Protocol, Version 6
              (IPv6) Specification", <a href="rfc2460.html">RFC 2460</a>, December 1998,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2460">http://www.rfc-editor.org/info/rfc2460</a>&gt;.

   [<a id="ref-RFC4122" name="ref-RFC4122">RFC4122</a>]  Leach, P., Mealling, M., and R. Salz, "A Universally
              Unique IDentifier (UUID) URN Namespace", <a href="rfc4122.html">RFC 4122</a>,
              July 2005, &lt;<a href="http://www.rfc-editor.org/info/rfc4122">http://www.rfc-editor.org/info/rfc4122</a>&gt;.

   [<a id="ref-RFC4193" name="ref-RFC4193">RFC4193</a>]  Hinden, R. and B. Haberman, "Unique Local IPv6 Unicast
              Addresses", <a href="rfc4193.html">RFC 4193</a>, October 2005,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4193">http://www.rfc-editor.org/info/rfc4193</a>&gt;.

   [<a id="ref-RFC4291" name="ref-RFC4291">RFC4291</a>]  Hinden, R. and S. Deering, "IP Version 6 Addressing
              Architecture", <a href="rfc4291.html">RFC 4291</a>, February 2006,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4291">http://www.rfc-editor.org/info/rfc4291</a>&gt;.

   [<a id="ref-RFC4861" name="ref-RFC4861">RFC4861</a>]  Narten, T., Nordmark, E., Simpson, W., and H. Soliman,
              "Neighbor Discovery for IP version 6 (IPv6)", <a href="rfc4861.html">RFC 4861</a>,
              September 2007, &lt;<a href="http://www.rfc-editor.org/info/rfc4861">http://www.rfc-editor.org/info/rfc4861</a>&gt;.

   [<a id="ref-RFC4944" name="ref-RFC4944">RFC4944</a>]  Montenegro, G., Kushalnagar, N., Hui, J., and D. Culler,
              "Transmission of IPv6 Packets over IEEE 802.15.4
              Networks", <a href="rfc4944.html">RFC 4944</a>, September 2007,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4944">http://www.rfc-editor.org/info/rfc4944</a>&gt;.

   [<a id="ref-RFC6282" name="ref-RFC6282">RFC6282</a>]  Hui, J. and P. Thubert, "Compression Format for IPv6
              Datagrams over IEEE 802.15.4-Based Networks", <a href="rfc6282.html">RFC 6282</a>,
              September 2011, &lt;<a href="http://www.rfc-editor.org/info/rfc6282">http://www.rfc-editor.org/info/rfc6282</a>&gt;.

   [<a id="ref-RFC6355" name="ref-RFC6355">RFC6355</a>]  Narten, T. and J. Johnson, "Definition of the UUID-Based
              DHCPv6 Unique Identifier (DUID-UUID)", <a href="rfc6355.html">RFC 6355</a>,
              August 2011, &lt;<a href="http://www.rfc-editor.org/info/rfc6355">http://www.rfc-editor.org/info/rfc6355</a>&gt;.

   [<a id="ref-RFC6775" name="ref-RFC6775">RFC6775</a>]  Shelby, Z., Chakrabarti, S., Nordmark, E., and C. Bormann,
              "Neighbor Discovery Optimization for IPv6 over Low-Power
              Wireless Personal Area Networks (6LoWPANs)", <a href="rfc6775.html">RFC 6775</a>,
              November 2012, &lt;<a href="http://www.rfc-editor.org/info/rfc6775">http://www.rfc-editor.org/info/rfc6775</a>&gt;.

   [<a id="ref-RFC7400" name="ref-RFC7400">RFC7400</a>]  Bormann, C., "6LoWPAN-GHC: Generic Header Compression for
              IPv6 over Low-Power Wireless Personal Area Networks
              (6LoWPANs)", <a href="rfc7400.html">RFC 7400</a>, November 2014,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7400">http://www.rfc-editor.org/info/rfc7400</a>&gt;.









<span class="grey">Brandt &amp; Buron               Standards Track                   [Page 15]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Informative%20References"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Informative References</span>

   [<a id="ref-EUI64" name="ref-EUI64">EUI64</a>]    IEEE, "Guidelines for 64-bit Global Identifier
              (EUI-64TM)", November 2012, &lt;<a href="http://standards.ieee.org/regauth/oui/tutorials/EUI64.html">http://standards.ieee.org/</a>
              <a href="http://standards.ieee.org/regauth/oui/tutorials/EUI64.html">regauth/oui/tutorials/EUI64.html</a>&gt;.

   [<a id="ref-KW03" name="ref-KW03">KW03</a>]     Karlof, C. and D. Wagner, "Secure Routing in Sensor
              Networks: Attacks and Countermeasures", Elsevier Ad Hoc
              Networks Journal, Special Issue on Sensor Network
              Applications and Protocols, vol. 1, issues 2-3,
              September 2003.

   [<a id="ref-RFC3315" name="ref-RFC3315">RFC3315</a>]  Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C.,
              and M. Carney, "Dynamic Host Configuration Protocol for
              IPv6 (DHCPv6)", <a href="rfc3315.html">RFC 3315</a>, July 2003,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3315">http://www.rfc-editor.org/info/rfc3315</a>&gt;.

   [<a id="ref-RFC3587" name="ref-RFC3587">RFC3587</a>]  Hinden, R., Deering, S., and E. Nordmark, "IPv6 Global
              Unicast Address Format", <a href="rfc3587.html">RFC 3587</a>, August 2003,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3587">http://www.rfc-editor.org/info/rfc3587</a>&gt;.

   [<a id="ref-RFC3756" name="ref-RFC3756">RFC3756</a>]  Nikander, P., Kempf, J., and E. Nordmark, "IPv6 Neighbor
              Discovery (ND) Trust Models and Threats", <a href="rfc3756.html">RFC 3756</a>,
              May 2004, &lt;<a href="http://www.rfc-editor.org/info/rfc3756">http://www.rfc-editor.org/info/rfc3756</a>&gt;.

   [<a id="ref-RFC3819" name="ref-RFC3819">RFC3819</a>]  Karn, P., Bormann, C., Fairhurst, G., Grossman, D.,
              Ludwig, R., Mahdavi, J., Montenegro, G., Touch, J., and L.
              Wood, "Advice for Internet Subnetwork Designers", <a href="http://tools.ietf.org/html/bcp89">BCP 89</a>,
              <a href="rfc3819.html">RFC 3819</a>, July 2004,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3819">http://www.rfc-editor.org/info/rfc3819</a>&gt;.

   [<a id="ref-RFC6550" name="ref-RFC6550">RFC6550</a>]  Winter, T., Thubert, P., Brandt, A., Hui, J., Kelsey, R.,
              Levis, P., Pister, K., Struik, R., Vasseur, JP., and R.
              Alexander, "RPL: IPv6 Routing Protocol for Low-Power and
              Lossy Networks", <a href="rfc6550.html">RFC 6550</a>, March 2012,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6550">http://www.rfc-editor.org/info/rfc6550</a>&gt;.

   [<a id="ref-RFC6997" name="ref-RFC6997">RFC6997</a>]  Goyal, M., Baccelli, E., Philipp, M., Brandt, A., and J.
              Martocci, "Reactive Discovery of Point-to-Point Routes in
              Low-Power and Lossy Networks", <a href="rfc6997.html">RFC 6997</a>, August 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6997">http://www.rfc-editor.org/info/rfc6997</a>&gt;.










<span class="grey">Brandt &amp; Buron               Standards Track                   [Page 16]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20G.9959%206LoWPAN%20Datagram%20Example"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  G.9959 6LoWPAN Datagram Example</span>

   This example outlines each individual bit of a sample IPv6 UDP packet
   arriving to a G.9959 node from a host in the Internet via a PAN
   border router.

   In the G.9959 PAN, the complete frame has the following fields.

   G.9959:

     +------+---------+----------+---+-----+----------...
     |HomeID|SrcNodeID|FrmControl|Len|SeqNo|DestNodeID|
     +------+---------+----------+---+-----+----------+-...

   6LoWPAN:

     ...+--------------+----------------+-----------------------...
        |6LoWPAN CmdCls|6LoWPAN_IPHC Hdr|Compressed IPv6 headers|
       ...-------------+----------------+-----------------------+-...

   IPv6, TCP/UDP, App payload:

       ...+-------------------------+------------+-----------+
          |Uncompressed IPv6 headers|TCP/UDP/ICMP|App payload|
         ...------------------------+------------+-----------+

   The frame comes from the source IPv6 address
   2001:0db8:ac10:ef01::ff:fe00:1206.  The source prefix
   2001:0db8:ac10:ef01/64 is identified by the IPHC CID = 3.

   The frame is delivered in direct range from the gateway that has
   source NodeID = 1.  The Interface Identifier (IID) ff:fe00:1206 is
   recognized as a link-layer-derived address and is compressed to the
   16-bit value 0x1206.

   The frame is sent to the destination IPv6 address
   2001:0db8:27ef:42ca::ff:fe00:0004.  The destination prefix
   2001:0db8:27ef:42ca/64 is identified by the IPHC CID = 2.

   The IID ff:fe00:0004 is recognized as a link-layer-derived address.

   Thanks to the link-layer-derived addressing rules, the sender knows
   that this is to be sent to G.9959 NodeID = 4, targeting the IPv6
   interface instance number 0 (the default).

   To reach the 6LoWPAN stack of the G.9959 node (skipping the G.9959
   header fields), the first octet must be the 6LoWPAN Command Class
   (0x4F).



<span class="grey">Brandt &amp; Buron               Standards Track                   [Page 17]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


        0
        0 1 2 3 4 5 6 7 8
       +-+-+-+-+-+-+-+-...
       |     0x4F      |
       +-+-+-+-+-+-+-+-+-...


   The Dispatch Header bits '011' advertise a compressed IPv6 header.

        0                   1
        0 1 2 3 4 5 6 7 8 9 0
       +-+-+-+-+-+-+-+-+-+-+-...
       |     0x4F      |0 1 1
       +-+-+-+-+-+-+-+-+-+-+-+-...


   The following bits encode the first IPv6 header fields:

   TF = '11'   : Traffic Class and Flow Label are elided
   NH = '1'    : Next Header is elided
   HLIM = '10' : Hop limit is 64

         0                   1
         0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...
        |     0x4F      |0 1 1 1 1 1 1 0|
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...

   CID = '1'   : CI data follows the DAM field
   SAC = '1'   : Src addr uses stateful, context-based compression
   SAM = '10'  : Use src CID and 16 bits for link-layer-derived addr
   M = '0'     : Dest addr is not a multicast addr
   DAC = '1'   : Dest addr uses stateful, context-based compression
   DAM = '11'  : Use dest CID and dest NodeID to link-layer-derived addr

        0                   1                   2
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...
       |     0x4F      |0 1 1 1 1 1 1 0|1 1 1 0 0 1 1 1|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...











<span class="grey">Brandt &amp; Buron               Standards Track                   [Page 18]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


   Address compression context identifiers:

   SCI =  0x3
   DCI =  0x2

          2           3
          4 5 6 7 8 9 0 1
      ...+-+-+-+-+-+-+-+-...
         |  0x3  |  0x2  |
        ...+-+-+-+-+-+-+-+-...

   IPv6 header fields:
   (skipping "version" field)
   (skipping "Traffic Class")
   (skipping "flow label")
   (skipping "payload length")

   IPv6 header address fields:

   SrcIP = 0x1206 : Use SCI and 16 least significant bits of
   link-layer-derived address

   (skipping DestIP ) - completely reconstructed from dest NodeID
                        and DCI

          2           3                   4
          4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7
      ...+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...
         |  0x3  |  0x2  |     0x12      |     0x06      |
        ...+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...

   Next Header encoding for the UDP header:

   Dispatch = '11110': Next Header dispatch code for UDP header
   C =      '0'      : 16-bit checksum carried inline
   P =      '00'     : Both src port and dest port are carried in-line

          4   5
          8 9 0 1 2 3 4 5
      ...+-+-+-+-+-+-+-+-...
         |1 1 1 1 0|0|0 0|
        ...+-+-+-+-+-+-+-+-...









<span class="grey">Brandt &amp; Buron               Standards Track                   [Page 19]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


 UDP header fields:

 src port  = 0x1234
 dest port = 0x5678

     5       6                   7                   8
     6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7
 ...+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...
    |     0x12      |     0x34      |     0x56      |     0x78      |
   ...+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-..


 (skipping "length")
 checksum = ....  (actual checksum value depends on
                   the actual UDP payload)


                                1
        8   9                   0
        8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3
    ...+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...
       |         (UDP checksum)        |
      ...+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...


 Add your own UDP payload here...

























<span class="grey">Brandt &amp; Buron               Standards Track                   [Page 20]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc7428.html">RFC 7428</a>                    IPv6 over G.9959               February 2015</span>


Acknowledgements

   Thanks to the authors of <a href="rfc4944.html">RFC 4944</a> and <a href="rfc6282.html">RFC 6282</a>, and members of the
   IETF 6LoWPAN working group; this document borrows extensively from
   their work.  Thanks to Erez Ben-Tovim, Erik Nordmark, Kerry Lynn,
   Michael Richardson, and Tommas Jess Christensen for useful comments.
   Thanks to Carsten Bormann for extensive feedback that improved this
   document significantly.  Thanks to Brian Haberman for pointing out
   unclear details.

Authors' Addresses

   Anders Brandt
   Sigma Designs
   Emdrupvej 26A, 1.
   Copenhagen O  2100
   Denmark

   EMail: anders_brandt@sigmadesigns.com


   Jakob Buron
   Sigma Designs
   Emdrupvej 26A, 1.
   Copenhagen O  2100
   Denmark

   EMail: jakob_buron@sigmadesigns.com























Brandt &amp; Buron               Standards Track                   [Page 21]

</pre><br/>
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.111, available from
<a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>



</body><!-- Mirrored from tools.ietf.org/html/rfc7428 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 28 Apr 2015 16:00:45 GMT --></html>