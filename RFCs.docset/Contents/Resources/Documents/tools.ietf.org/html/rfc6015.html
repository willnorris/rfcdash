<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6015 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:31 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-begen-fecframe-interleaved-fec-scheme" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:6015" name="DC.Identifier"/>
<meta content="October, 2010" name="DC.Date.Issued"/>
<meta content="Ali Begen &lt;abegen@cisco.com&gt;" name="DC.Creator"/>
<meta content="This document defines a new RTP payload format for the Forward Error
Correction (FEC) that is generated by the 1-D interleaved parity code
from a source media encapsulated in RTP. The 1-D interleaved parity
code is a systematic code, where a number of repair symbols are
generated from a set of source symbols and sent in a repair flow
separate from the source flow that carries the source symbols. The 1-D
interleaved parity code offers a good protection against bursty packet
losses at a cost of reasonable complexity. The new payload format
defined in this document is used (with some exceptions) as a part of
the DVB Application-layer FEC specification." name="DC.Description.Abstract"/>
<meta content="RTP Payload Format for 1-D Interleaved Parity FEC" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6015 - RTP Payload Format for 1-D Interleaved Parity FEC</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6015.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6015" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-fecframe-interleaved-fec-scheme" title="draft-ietf-fecframe-interleaved-fec-scheme">draft-ietf-fecf...</a>] [<a href="https://datatracker.ietf.org/doc/rfc6015" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6015" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6015" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                          A. Begen
Request for Comments: 6015                                         Cisco
Category: Standards Track                                   October 2010
ISSN: 2070-1721


             <span class="h1">RTP Payload Format for 1-D Interleaved Parity</span>
                     <span class="h1">Forward Error Correction (FEC)</span>

Abstract

   This document defines a new RTP payload format for the Forward Error
   Correction (FEC) that is generated by the 1-D interleaved parity code
   from a source media encapsulated in RTP.  The 1-D interleaved parity
   code is a systematic code, where a number of repair symbols are
   generated from a set of source symbols and sent in a repair flow
   separate from the source flow that carries the source symbols.  The
   1-D interleaved parity code offers a good protection against bursty
   packet losses at a cost of reasonable complexity.  The new payload
   format defined in this document should only be used (with some
   exceptions) as a part of the Digital Video Broadcasting-IPTV (DVB-
   IPTV) Application-layer FEC specification.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6015">http://www.rfc-editor.org/info/rfc6015</a>.















<span class="grey">Begen                        Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





































<span class="grey">Begen                        Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-4">4</a>
      <a href="#section-1.1">1.1</a>. Use Cases ..................................................<a href="#page-6">6</a>
      <a href="#section-1.2">1.2</a>. Overhead Computation .......................................<a href="#page-8">8</a>
      <a href="#section-1.3">1.3</a>. Relation to Existing Specifications ........................<a href="#page-8">8</a>
           <a href="#section-1.3.1">1.3.1</a>. RFCs 2733 and 3009 ..................................<a href="#page-8">8</a>
           <a href="#section-1.3.2">1.3.2</a>. SMPTE 2022-1 ........................................<a href="#page-8">8</a>
           <a href="#section-1.3.3">1.3.3</a>. ETSI TS 102 034 .....................................<a href="#page-9">9</a>
      <a href="#section-1.4">1.4</a>. Scope of the Payload Format ...............................<a href="#page-10">10</a>
   <a href="#section-2">2</a>. Requirements Notation ..........................................<a href="#page-10">10</a>
   <a href="#section-3">3</a>. Definitions, Notations, and Abbreviations ......................<a href="#page-10">10</a>
      <a href="#section-3.1">3.1</a>. Definitions ...............................................<a href="#page-10">10</a>
      <a href="#section-3.2">3.2</a>. Notations .................................................<a href="#page-11">11</a>
   <a href="#section-4">4</a>. Packet Formats .................................................<a href="#page-11">11</a>
      <a href="#section-4.1">4.1</a>. Source Packets ............................................<a href="#page-11">11</a>
      <a href="#section-4.2">4.2</a>. Repair Packets ............................................<a href="#page-11">11</a>
   <a href="#section-5">5</a>. Payload Format Parameters ......................................<a href="#page-15">15</a>
      <a href="#section-5.1">5.1</a>. Media Type Registration ...................................<a href="#page-15">15</a>
           <a href="#section-5.1.1">5.1.1</a>. Registration of audio/1d-interleaved-parityfec .....<a href="#page-15">15</a>
           <a href="#section-5.1.2">5.1.2</a>. Registration of video/1d-interleaved-parityfec .....<a href="#page-16">16</a>
           <a href="#section-5.1.3">5.1.3</a>. Registration of text/1d-interleaved-parityfec ......<a href="#page-18">18</a>
           5.1.4. Registration of
                  application/1d-interleaved-parityfec ...............<a href="#page-19">19</a>
      <a href="#section-5.2">5.2</a>. Mapping to SDP Parameters .................................<a href="#page-20">20</a>
           <a href="#section-5.2.1">5.2.1</a>. Offer-Answer Model Considerations ..................<a href="#page-21">21</a>
           <a href="#section-5.2.2">5.2.2</a>. Declarative Considerations .........................<a href="#page-22">22</a>
   <a href="#section-6">6</a>. Protection and Recovery Procedures .............................<a href="#page-22">22</a>
      <a href="#section-6.1">6.1</a>. Overview ..................................................<a href="#page-22">22</a>
      <a href="#section-6.2">6.2</a>. Repair Packet Construction ................................<a href="#page-22">22</a>
      <a href="#section-6.3">6.3</a>. Source Packet Reconstruction ..............................<a href="#page-24">24</a>
           <a href="#section-6.3.1">6.3.1</a>. Associating the Source and Repair Packets ..........<a href="#page-25">25</a>
           <a href="#section-6.3.2">6.3.2</a>. Recovering the RTP Header and Payload ..............<a href="#page-25">25</a>
   <a href="#section-7">7</a>. Session Description Protocol (SDP) Signaling ...................<a href="#page-27">27</a>
   <a href="#section-8">8</a>. Congestion Control Considerations ..............................<a href="#page-27">27</a>
   <a href="#section-9">9</a>. Security Considerations ........................................<a href="#page-28">28</a>
   <a href="#section-10">10</a>. IANA Considerations ...........................................<a href="#page-29">29</a>
   <a href="#section-11">11</a>. Acknowledgments ...............................................<a href="#page-29">29</a>
   <a href="#section-12">12</a>. References ....................................................<a href="#page-29">29</a>
      <a href="#section-12.1">12.1</a>. Normative References .....................................<a href="#page-29">29</a>
      <a href="#section-12.2">12.2</a>. Informative References ...................................<a href="#page-30">30</a>










<span class="grey">Begen                        Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   This document extends the Forward Error Correction (FEC) header
   defined in [<a href="rfc2733.html" title='"An RTP Payload Format for Generic Forward Error Correction"'>RFC2733</a>] and uses this new FEC header for the FEC that is
   generated by the 1-D interleaved parity code from a source media
   encapsulated in RTP [<a href="rfc3550.html" title='"RTP: A Transport Protocol for Real-Time Applications"'>RFC3550</a>].  The resulting new RTP payload format
   is registered by this document.

   The type of the source media protected by the 1-D interleaved parity
   code can be audio, video, text, or application.  The FEC data are
   generated according to the media type parameters that are
   communicated through out-of-band means.  The associations/
   relationships between the source and repair flows are also
   communicated through out-of-band means.

   The 1-D interleaved parity FEC uses the exclusive OR (XOR) operation
   to generate the repair symbols.  In a nutshell, the following steps
   take place:

   1.  The sender determines a set of source packets to be protected
       together based on the media type parameters.

   2.  The sender applies the XOR operation on the source symbols to
       generate the required number of repair symbols.

   3.  The sender packetizes the repair symbols and sends the repair
       packet(s) along with the source packets to the receiver(s) (in
       different flows).  The repair packets may be sent proactively or
       on demand.

   Note that the source and repair packets belong to different source
   and repair flows, and the sender needs to provide a way for the
   receivers to demultiplex them, even in the case in which they are
   sent in the same transport flow (i.e., same source/destination
   address/port with UDP).  This is required to offer backward
   compatibility (see <a href="#section-4">Section 4</a>).  At the receiver side, if all of the
   source packets are successfully received, there is no need for FEC
   recovery and the repair packets are discarded.  However, if there are
   missing source packets, the repair packets can be used to recover the
   missing information.  Block diagrams for the systematic parity FEC
   encoder and decoder are sketched in Figures 1 and 2, respectively.










<span class="grey">Begen                        Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


                               +------------+
    +--+  +--+  +--+  +--+ --&gt; | Systematic | --&gt; +--+  +--+  +--+  +--+
    +--+  +--+  +--+  +--+     | Parity FEC |     +--+  +--+  +--+  +--+
                               |  Encoder   |
                               |  (Sender)  | --&gt; +==+  +==+
                               +------------+     +==+  +==+

    Source Packet: +--+    Repair Packet: +==+
                   +--+                   +==+

         Figure 1: Block diagram for systematic parity FEC encoder

                               +------------+
    +--+    X    X    +--+ --&gt; | Systematic | --&gt; +--+  +--+  +--+  +--+
    +--+              +--+     | Parity FEC |     +--+  +--+  +--+  +--+
                               |  Decoder   |
                +==+  +==+ --&gt; | (Receiver) |
                +==+  +==+     +------------+

    Source Packet: +--+    Repair Packet: +==+    Lost Packet: X
                   +--+                   +==+

         Figure 2: Block diagram for systematic parity FEC decoder

   Suppose that we have a group of D x L source packets that have
   sequence numbers starting from 1 running to D x L.  If we apply the
   XOR operation to the group of the source packets whose sequence
   numbers are L apart from each other as sketched in Figure 3, we
   generate L repair packets.  This process is referred to as 1-D
   interleaved FEC protection, and the resulting L repair packets are
   referred to as interleaved (or column) FEC packets.




















<span class="grey">Begen                        Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


       +-------------+ +-------------+ +-------------+     +-------+
       | S_1         | | S_2         | | S3          | ... | S_L   |
       | S_L+1       | | S_L+2       | | S_L+3       | ... | S_2xL |
       | .           | | .           | |             |     |       |
       | .           | | .           | |             |     |       |
       | .           | | .           | |             |     |       |
       | S_(D-1)xL+1 | | S_(D-1)xL+2 | | S_(D-1)xL+3 | ... | S_DxL |
       +-------------+ +-------------+ +-------------+     +-------+
              +               +               +                +
        -------------   -------------   -------------       -------
       |     XOR     | |     XOR     | |     XOR     | ... |  XOR  |
        -------------   -------------   -------------       -------
              =               =               =                =
            +===+           +===+           +===+            +===+
            |C_1|           |C_2|           |C_3|      ...   |C_L|
            +===+           +===+           +===+            +===+

           Figure 3: Generating interleaved (column) FEC packets

   In Figure 3, S_n and C_m denote the source packet with a sequence
   number n and the interleaved (column) FEC packet with a sequence
   number m, respectively.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Use%20Cases"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Use Cases</span>

   We generate one interleaved FEC packet out of D non-consecutive
   source packets.  This repair packet can provide a full recovery of
   the missing information if there is only one packet missing among the
   corresponding source packets.  This implies that 1-D interleaved FEC
   protection performs well under bursty loss conditions provided that a
   large enough value is chosen for L, i.e., L packet duration should
   not be shorter than the duration of the burst that is intended to be
   repaired.

   For example, consider the scenario depicted in Figure 4 in which the
   sender generates interleaved FEC packets and a bursty loss hits the
   source packets.  Since the number of columns is larger than the
   number of packets lost due to the bursty loss, the repair operation
   succeeds.












<span class="grey">Begen                        Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


                         +---+
                         | 1 |    X      X      X
                         +---+

                         +---+  +---+  +---+  +---+
                         | 5 |  | 6 |  | 7 |  | 8 |
                         +---+  +---+  +---+  +---+

                         +---+  +---+  +---+  +---+
                         | 9 |  | 10|  | 11|  | 12|
                         +---+  +---+  +---+  +---+

                         +===+  +===+  +===+  +===+
                         |C_1|  |C_2|  |C_3|  |C_4|
                         +===+  +===+  +===+  +===+

      Figure 4: Example scenario where 1-D interleaved FEC protection
                          succeeds error recovery

   The sender may generate interleaved FEC packets to combat the bursty
   packet losses.  However, two or more random packet losses may hit the
   source and repair packets in the same column.  In that case, the
   repair operation fails.  This is illustrated in Figure 5.  Note that
   it is possible that two or more bursty losses may occur in the same
   source block, in which case interleaved FEC packets may still fail to
   recover the lost data.

                         +---+         +---+  +---+
                         | 1 |    X    | 3 |  | 4 |
                         +---+         +---+  +---+

                         +---+         +---+  +---+
                         | 5 |    X    | 7 |  | 8 |
                         +---+         +---+  +---+

                         +---+  +---+  +---+  +---+
                         | 9 |  | 10|  | 11|  | 12|
                         +---+  +---+  +---+  +---+

                         +===+  +===+  +===+  +===+
                         |C_1|  |C_2|  |C_3|  |C_4|
                         +===+  +===+  +===+  +===+

   Figure 5: Example scenario where 1-D interleaved FEC protection fails
                              error recovery






<span class="grey">Begen                        Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Overhead%20Computation"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Overhead Computation</span>

   The overhead is defined as the ratio of the number of bytes that
   belong to the repair packets to the number of bytes that belong to
   the protected source packets.

   Assuming that each repair packet carries an equal number of bytes
   carried by a source packet and ignoring the size of the FEC header,
   we can compute the overhead as follows:

        Overhead = 1/D

   where D is the number of rows in the source block.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20Relation%20to%20Existing%20Specifications"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  Relation to Existing Specifications</span>

   This section discusses the relation of the current specification to
   other existing specifications.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/1.3.1.%20%20RFCs%202733%20and%203009"></a><a class="selflink" href="#section-1.3.1" name="section-1.3.1">1.3.1</a>.  RFCs 2733 and 3009</span>

   The current specification extends the FEC header defined in [<a href="rfc2733.html" title='"An RTP Payload Format for Generic Forward Error Correction"'>RFC2733</a>]
   and registers a new RTP payload format.  This new payload format is
   not backward compatible with the payload format that was registered
   by [<a href="rfc3009.html" title='"Registration of parityfec MIME types"'>RFC3009</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/1.3.2.%20%20SMPTE%202022-1"></a><a class="selflink" href="#section-1.3.2" name="section-1.3.2">1.3.2</a>.  SMPTE 2022-1</span>

   In 2007, the Society of Motion Picture and Television Engineers
   (SMPTE) - Technology Committee N26 on File Management and Networking
   Technology - decided to revise the Pro-MPEG Code of Practice (CoP) #3
   Release 2 specification (initially produced by the Pro-MPEG Forum in
   2004), which discussed several aspects of the transmission of MPEG-2
   transport streams over IP networks.  The new SMPTE specification is
   referred to as [<a href="#ref-SMPTE2022-1" title='"Forward Error Correction for Real-Time Video/Audio Transport over IP Networks"'>SMPTE2022-1</a>].

   The Pro-MPEG CoP #3 Release 2 document was originally based on
   [<a href="rfc2733.html" title='"An RTP Payload Format for Generic Forward Error Correction"'>RFC2733</a>].  SMPTE revised the document by extending the FEC header
   proposed in [<a href="rfc2733.html" title='"An RTP Payload Format for Generic Forward Error Correction"'>RFC2733</a>] (by setting the E bit).  This extended header
   offers some improvements.

   For example, instead of utilizing the bitmap field used in [<a href="rfc2733.html" title='"An RTP Payload Format for Generic Forward Error Correction"'>RFC2733</a>],
   [<a href="#ref-SMPTE2022-1" title='"Forward Error Correction for Real-Time Video/Audio Transport over IP Networks"'>SMPTE2022-1</a>] introduces separate fields to convey the number of rows
   (D) and columns (L) of the source block as well as the type of the
   repair packet (i.e., whether the repair packet is an interleaved FEC
   packet computed over a column or a non-interleaved FEC packet
   computed over a row).  These fields, plus the base sequence number,
   allow the receiver side to establish associations between the source



<span class="grey">Begen                        Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


   and repair packets.  Note that although the bitmap field is not
   utilized, the FEC header of [<a href="#ref-SMPTE2022-1" title='"Forward Error Correction for Real-Time Video/Audio Transport over IP Networks"'>SMPTE2022-1</a>] inherently carries over the
   bitmap field from [<a href="rfc2733.html" title='"An RTP Payload Format for Generic Forward Error Correction"'>RFC2733</a>].

   On the other hand, some parts of [<a href="#ref-SMPTE2022-1" title='"Forward Error Correction for Real-Time Video/Audio Transport over IP Networks"'>SMPTE2022-1</a>] are not in compliance
   with RTP [<a href="rfc3550.html" title='"RTP: A Transport Protocol for Real-Time Applications"'>RFC3550</a>].  For example, [<a href="#ref-SMPTE2022-1" title='"Forward Error Correction for Real-Time Video/Audio Transport over IP Networks"'>SMPTE2022-1</a>] sets the
   Synchronization Source (SSRC) field to zero and does not use the
   timestamp field in the RTP headers of the repair packets (receivers
   ignore the timestamps of the repair packets).  Furthermore,
   [<a href="#ref-SMPTE2022-1" title='"Forward Error Correction for Real-Time Video/Audio Transport over IP Networks"'>SMPTE2022-1</a>] also sets the CSRC Count (CC) field in the RTP header
   to zero and does not allow any Contributing Source (CSRC) entry in
   the RTP header.

   The current document adopts the extended FEC header of [<a href="#ref-SMPTE2022-1" title='"Forward Error Correction for Real-Time Video/Audio Transport over IP Networks"'>SMPTE2022-1</a>]
   and registers a new RTP payload format.  At the same time, this
   document fixes the parts of [<a href="#ref-SMPTE2022-1" title='"Forward Error Correction for Real-Time Video/Audio Transport over IP Networks"'>SMPTE2022-1</a>] that are not compliant with
   RTP [<a href="rfc3550.html" title='"RTP: A Transport Protocol for Real-Time Applications"'>RFC3550</a>], except the one discussed below.

   The baseline header format first proposed in [<a href="rfc2733.html" title='"An RTP Payload Format for Generic Forward Error Correction"'>RFC2733</a>] does not have
   fields to protect the P and X bits and the CC fields of the source
   packets associated with a repair packet.  Rather, the P bit, X bit,
   and CC field in the RTP header of the repair packet are used to
   protect those bits and fields.  This, however, may sometimes result
   in failures when doing the RTP header validity checks as specified in
   [<a href="rfc3550.html" title='"RTP: A Transport Protocol for Real-Time Applications"'>RFC3550</a>].  While this behavior has been fixed in [<a href="rfc5109.html" title='"RTP Payload Format for Generic Forward Error Correction"'>RFC5109</a>], which
   obsoleted [<a href="rfc2733.html" title='"An RTP Payload Format for Generic Forward Error Correction"'>RFC2733</a>], the RTP payload format defined in this document
   still allows this behavior for legacy purposes.  Implementations
   following this specification must be aware of this potential issue
   when RTP header validity checks are applied.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/1.3.3.%20%20ETSI%20TS%20102%20034"></a><a class="selflink" href="#section-1.3.3" name="section-1.3.3">1.3.3</a>.  ETSI TS 102 034</span>

   In 2009, the Digital Video Broadcasting (DVB) consortium published a
   technical specification [<a href="#ref-ETSI-TS-102-034" title='"Transport of MPEG 2 TS Based DVB Services over IP Based Networks"'>ETSI-TS-102-034</a>] through the European
   Telecommunications Standards Institute (ETSI).  This specification
   covers several areas related to the transmission of MPEG-2 transport
   stream-based services over IP networks.

   Annex E of [<a href="#ref-ETSI-TS-102-034" title='"Transport of MPEG 2 TS Based DVB Services over IP Based Networks"'>ETSI-TS-102-034</a>] defines an optional protocol for
   Application-layer FEC (AL-FEC) protection of streaming media for
   DVB-IP services carried over RTP [<a href="rfc3550.html" title='"RTP: A Transport Protocol for Real-Time Applications"'>RFC3550</a>] transport.  The DVB-IPTV
   AL-FEC protocol uses two layers for protection: a base layer that is
   produced by a packet-based interleaved parity code, and an
   enhancement layer that is produced by a Raptor code [<a href="#ref-DVB-AL-FEC" title='"Guidelines for Implementing DVB-IPTV Application-Layer Hybrid FEC Protection"'>DVB-AL-FEC</a>].
   While the use of the enhancement layer is optional, the use of the
   base layer is mandatory wherever AL-FEC is used.  The DVB-IPTV AL-FEC
   protocol is also described in [<a href="#ref-DVB-AL-FEC" title='"Guidelines for Implementing DVB-IPTV Application-Layer Hybrid FEC Protection"'>DVB-AL-FEC</a>].




<span class="grey">Begen                        Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


   The interleaved parity code that is used in the base layer is a
   subset of [<a href="#ref-SMPTE2022-1" title='"Forward Error Correction for Real-Time Video/Audio Transport over IP Networks"'>SMPTE2022-1</a>].  In particular, the AL-FEC base layer uses
   only the 1-D interleaved FEC protection from [<a href="#ref-SMPTE2022-1" title='"Forward Error Correction for Real-Time Video/Audio Transport over IP Networks"'>SMPTE2022-1</a>].  The new
   RTP payload format that is defined and registered in this document
   (with some exceptions listed in [<a href="#ref-DVB-AL-FEC" title='"Guidelines for Implementing DVB-IPTV Application-Layer Hybrid FEC Protection"'>DVB-AL-FEC</a>]) is used as the AL-FEC
   base layer.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.4.%20%20Scope%20of%20the%20Payload%20Format"></a><a class="selflink" href="#section-1.4" name="section-1.4">1.4</a>.  Scope of the Payload Format</span>

   The payload format specified in this document must only be used in
   legacy applications where the limitations explained in <a href="#section-1.3.2">Section 1.3.2</a>
   are known not to impact any system components or other RTP elements.
   Whenever possible, a payload format that is fully compliant with
   [<a href="rfc3550.html" title='"RTP: A Transport Protocol for Real-Time Applications"'>RFC3550</a>], such as [<a href="rfc5109.html" title='"RTP Payload Format for Generic Forward Error Correction"'>RFC5109</a>] or other newer payload formats, must be
   used.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Requirements%20Notation"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Requirements Notation</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Definitions%2C%20Notations%2C%20and%20Abbreviations"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Definitions, Notations, and Abbreviations</span>

   The definitions and notations commonly used in this document are
   summarized in this section.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Definitions"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Definitions</span>

   This document uses the following definitions:

   Source Flow: The packet flow(s) carrying the source data to which FEC
   protection is to be applied.

   Repair Flow: The packet flow(s) carrying the repair data.

   Symbol: A unit of data.  Its size, in bytes, is referred to as the
   symbol size.

   Source Symbol: The smallest unit of data used during the encoding
   process.

   Repair Symbol: Repair symbols are generated from the source symbols.

   Source Packet: Data packets that contain only source symbols.

   Repair Packet: Data packets that contain only repair symbols.




<span class="grey">Begen                        Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


   Source Block: A block of source symbols that are considered together
   in the encoding process.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Notations"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Notations</span>

   o  L: Number of columns of the source block.

   o  D: Number of rows of the source block.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Packet%20Formats"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Packet Formats</span>

   This section defines the formats of the source and repair packets.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Source%20Packets"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Source Packets</span>

   The source packets need to contain information that identifies the
   source block and the position within the source block occupied by the
   packet.  Since the source packets that are carried within an RTP
   stream already contain unique sequence numbers in their RTP headers
   [<a href="rfc3550.html" title='"RTP: A Transport Protocol for Real-Time Applications"'>RFC3550</a>], we can identify the source packets in a straightforward
   manner, and there is no need to append additional field(s).  The
   primary advantage of not modifying the source packets in any way is
   that it provides backward compatibility for the receivers that do not
   support FEC at all.  In multicast scenarios, this backward
   compatibility becomes quite useful as it allows the non-FEC-capable
   and FEC-capable receivers to receive and interpret the same source
   packets sent in the same multicast session.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Repair%20Packets"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Repair Packets</span>

   The repair packets MUST contain information that identifies the
   source block to which they pertain and the relationship between the
   contained repair symbols and the original source block.  For this
   purpose, we use the RTP header of the repair packets as well as
   another header within the RTP payload, which we refer to as the FEC
   header, as shown in Figure 6.















<span class="grey">Begen                        Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


             +------------------------------+
             |          IP Header           |
             +------------------------------+
             |       Transport Header       |
             +------------------------------+
             |          RTP Header          | __
             +------------------------------+   |
             |          FEC Header          |    \
             +------------------------------+     &gt; RTP Payload
             |        Repair Symbols        |    /
             +------------------------------+ __|

                    Figure 6: Format of repair packets

   The RTP header is formatted according to [<a href="rfc3550.html" title='"RTP: A Transport Protocol for Real-Time Applications"'>RFC3550</a>] with some further
   clarifications listed below:

   o  Version: The version field is set to 2.

   o  Padding (P) Bit: This bit is equal to the XOR sum of the
      corresponding P bits from the RTP headers of the source packets
      protected by this repair packet.  However, padding octets are
      never present in a repair packet, independent of the value of the
      P bit.

   o  Extension (X) Bit: This bit is equal to the XOR sum of the
      corresponding X bits from the RTP headers of the source packets
      protected by this repair packet.  However, an RTP header extension
      is never present in a repair packet, independent of the value of
      the X bit.

   o  CSRC Count (CC): This field is equal to the XOR sum of the
      corresponding CC values from the RTP headers of the source packets
      protected by this repair packet.  However, a CSRC list is never
      present in a repair packet, independent of the value of the CC
      field.

   o  Marker (M) Bit: This bit is equal to the XOR sum of the
      corresponding M bits from the RTP headers of the source packets
      protected by this repair packet.

   o  Payload Type: The (dynamic) payload type for the repair packets is
      determined through out-of-band means.  Note that this document
      registers a new payload format for the repair packets (refer to
      <a href="#section-5">Section 5</a> for details).  According to [<a href="rfc3550.html" title='"RTP: A Transport Protocol for Real-Time Applications"'>RFC3550</a>], an RTP receiver
      that cannot recognize a payload type must discard it.  This action
      provides backward compatibility.  The FEC mechanisms can then be
      used in a multicast group with mixed FEC-capable and non-FEC-



<span class="grey">Begen                        Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


      capable receivers.  If a non-FEC-capable receiver receives a
      repair packet, it will not recognize the payload type, and hence,
      discards the repair packet.

   o  Sequence Number (SN): The sequence number has the standard
      definition.  It MUST be one higher than the sequence number in the
      previously transmitted repair packet.  The initial value of the
      sequence number SHOULD be random (unpredictable) [<a href="rfc3550.html" title='"RTP: A Transport Protocol for Real-Time Applications"'>RFC3550</a>].

   o  Timestamp (TS): The timestamp SHALL be set to a time corresponding
      to the repair packet's transmission time.  Note that the timestamp
      value has no use in the actual FEC protection process and is
      usually useful for jitter calculations.

   o  Synchronization Source (SSRC): The SSRC value SHALL be randomly
      assigned as suggested by [<a href="rfc3550.html" title='"RTP: A Transport Protocol for Real-Time Applications"'>RFC3550</a>].  This allows the sender to
      multiplex the source and repair flows on the same port or
      multiplex multiple repair flows on a single port.  The repair
      flows SHOULD use the RTP Control Protocol (RTCP) CNAME field to
      associate themselves with the source flow.

      In some networks, the RTP Source (which produces the source
      packets) and the FEC Source (which generates the repair packets
      from the source packets) may not be the same host.  In such
      scenarios, using the same CNAME for the source and repair flows
      means that the RTP Source and the FEC Source MUST share the same
      CNAME (for this specific source-repair flow association).  A
      common CNAME may be produced based on an algorithm that is known
      both to the RTP and FEC Source.  This usage is compliant with
      [<a href="rfc3550.html" title='"RTP: A Transport Protocol for Real-Time Applications"'>RFC3550</a>].

      Note that due to the randomness of the SSRC assignments, there is
      a possibility of SSRC collision.  In such cases, the collisions
      MUST be resolved as described in [<a href="rfc3550.html" title='"RTP: A Transport Protocol for Real-Time Applications"'>RFC3550</a>].

   Note that the P bit, X bit, CC field, and M bit of the source packets
   are protected by the corresponding bits/fields in the RTP header of
   the repair packet.  On the other hand, the payload of a repair packet
   protects the concatenation of (if present) the CSRC list, RTP
   extension, payload, and padding of the source RTP packets associated
   with this repair packet.

   The FEC header is 16 octets.  The format of the FEC header is shown
   in Figure 7.







<span class="grey">Begen                        Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |          SN base low          |        Length recovery        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |E| PT recovery |                     Mask                      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                          TS recovery                          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |N|D|Type |Index|     Offset    |       NA      |  SN base ext  |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                    Figure 7: Format of the FEC header

   The FEC header consists of the following fields:

   o  The SN base low field is used to indicate the lowest sequence
      number, taking wraparound into account, of those source packets
      protected by this repair packet.

   o  The Length recovery field is used to determine the length of any
      recovered packets.

   o  The E bit is the extension flag introduced in [<a href="rfc2733.html" title='"An RTP Payload Format for Generic Forward Error Correction"'>RFC2733</a>] and used
      to extend the [<a href="rfc2733.html" title='"An RTP Payload Format for Generic Forward Error Correction"'>RFC2733</a>] FEC header.

   o  The PT recovery field is used to determine the payload type of the
      recovered packets.

   o  The Mask field is not used.

   o  The TS recovery field is used to determine the timestamp of the
      recovered packets.

   o  The N bit is the extension flag that is reserved for future use.

   o  The D bit is not used.

   o  The Type field indicates the type of the error-correcting code
      used.  This document defines only one error-correcting code.

   o  The Index field is not used.

   o  The Offset and NA fields are used to indicate the number of
      columns (L) and rows (D) of the source block, respectively.

   o  The SN base ext field is not used.




<span class="grey">Begen                        Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


   The details on setting the fields in the FEC header are provided in
   <a href="#section-6.2">Section 6.2</a>.

   It should be noted that a Mask-based approach (similar to the one
   specified in [<a href="rfc2733.html" title='"An RTP Payload Format for Generic Forward Error Correction"'>RFC2733</a>]) may not be very efficient to indicate which
   source packets in the current source block are associated with a
   given repair packet.  In particular, for the applications that would
   like to use large source block sizes, the size of the Mask that is
   required to describe the source-repair packet associations may be
   prohibitively large.  Instead, a systematized approach is inherently
   more efficient.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Payload%20Format%20Parameters"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Payload Format Parameters</span>

   This section provides the media subtype registration for the 1-D
   interleaved parity FEC.  The parameters that are required to
   configure the FEC encoding and decoding operations are also defined
   in this section.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Media%20Type%20Registration"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Media Type Registration</span>

   This registration is done using the template defined in [<a href="rfc4288.html" title='"Media Type Specifications and Registration Procedures"'>RFC4288</a>] and
   following the guidance provided in [<a href="rfc4855.html" title='"Media Type Registration of RTP Payload Formats"'>RFC4855</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.1.%20%20Registration%20of%20audio%2F1d-interleaved-parityfec"></a><a class="selflink" href="#section-5.1.1" name="section-5.1.1">5.1.1</a>.  Registration of audio/1d-interleaved-parityfec</span>

   Type name: audio

   Subtype name: 1d-interleaved-parityfec

   Required parameters:

   o  rate: The RTP timestamp (clock) rate in Hz.  The (integer) rate
      SHALL be larger than 1000 to provide sufficient resolution to RTCP
      operations.  However, it is RECOMMENDED to select the rate that
      matches the rate of the protected source RTP stream.

   o  L: Number of columns of the source block.  L is a positive integer
      that is less than or equal to 255.

   o  D: Number of rows of the source block.  D is a positive integer
      that is less than or equal to 255.

   o  repair-window: The time that spans the FEC block (i.e., source
      packets and the corresponding repair packets).  An FEC encoder
      processes a block of source packets and generates a number of
      repair packets, which are then transmitted within a certain
      duration not larger than the value of the repair window.  At the



<span class="grey">Begen                        Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


      receiver side, the FEC decoder should wait at least for the
      duration of the repair window after getting the first packet in an
      FEC block to allow all the repair packets to arrive (the waiting
      time can be adjusted if there are missing packets at the beginning
      of the FEC block).  The FEC decoder can start decoding the already
      received packets sooner; however, it SHOULD NOT register an FEC
      decoding failure until it waits at least for the repair-window
      duration.  The size of the repair window is specified in
      microseconds.

   Optional parameters: None.

   Encoding considerations: This media type is framed (see <a href="#section-4.8">Section 4.8</a>
   in the template document [<a href="rfc4288.html" title='"Media Type Specifications and Registration Procedures"'>RFC4288</a>]) and contains binary data.

   Security considerations: See <a href="rfc6015.html#section-9">Section 9 of [RFC6015]</a>.

   Interoperability considerations: None.

   Published specification: [<a href="rfc6015.html">RFC6015</a>].

   Applications that use this media type: Multimedia applications that
   want to improve resiliency against packet loss by sending redundant
   data in addition to the source media.

   Additional information: None.

   Person &amp; email address to contact for further information: Ali Begen
   &lt;abegen@cisco.com&gt; and the IETF Audio/Video Transport Working Group.

   Intended usage: COMMON.

   Restriction on usage: This media type depends on RTP framing, and
   hence, is only defined for transport via RTP [<a href="rfc3550.html" title='"RTP: A Transport Protocol for Real-Time Applications"'>RFC3550</a>].

   Author: Ali Begen &lt;abegen@cisco.com&gt;.

   Change controller: IETF Audio/Video Transport Working Group delegated
   from the IESG.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.2.%20%20Registration%20of%20video%2F1d-interleaved-parityfec"></a><a class="selflink" href="#section-5.1.2" name="section-5.1.2">5.1.2</a>.  Registration of video/1d-interleaved-parityfec</span>

   Type name: video

   Subtype name: 1d-interleaved-parityfec

   Required parameters:




<span class="grey">Begen                        Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


   o  rate: The RTP timestamp (clock) rate in Hz.  The (integer) rate
      SHALL be larger than 1000 to provide sufficient resolution to RTCP
      operations.  However, it is RECOMMENDED to select the rate that
      matches the rate of the protected source RTP stream.

   o  L: Number of columns of the source block.  L is a positive integer
      that is less than or equal to 255.

   o  D: Number of rows of the source block.  D is a positive integer
      that is less than or equal to 255.

   o  repair-window: The time that spans the FEC block (i.e., source
      packets and the corresponding repair packets).  An FEC encoder
      processes a block of source packets and generates a number of
      repair packets, which are then transmitted within a certain
      duration not larger than the value of the repair window.  At the
      receiver side, the FEC decoder should wait at least for the
      duration of the repair window after getting the first packet in an
      FEC block to allow all the repair packets to arrive (the waiting
      time can be adjusted if there are missing packets at the beginning
      of the FEC block).  The FEC decoder can start decoding the already
      received packets sooner; however, it SHOULD NOT register an FEC
      decoding failure until it waits at least for the repair-window
      duration.  The size of the repair window is specified in
      microseconds.

   Optional parameters: None.

   Encoding considerations: This media type is framed (see <a href="#section-4.8">Section 4.8</a>
   in the template document [<a href="rfc4288.html" title='"Media Type Specifications and Registration Procedures"'>RFC4288</a>]) and contains binary data.

   Security considerations: See <a href="rfc6015.html#section-9">Section 9 of [RFC6015]</a>.

   Interoperability considerations: None.

   Published specification: [<a href="rfc6015.html">RFC6015</a>].

   Applications that use this media type: Multimedia applications that
   want to improve resiliency against packet loss by sending redundant
   data in addition to the source media.

   Additional information: None.

   Person &amp; email address to contact for further information: Ali Begen
   &lt;abegen@cisco.com&gt; and the IETF Audio/Video Transport Working Group.

   Intended usage: COMMON.




<span class="grey">Begen                        Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


   Restriction on usage: This media type depends on RTP framing, and
   hence, is only defined for transport via RTP [<a href="rfc3550.html" title='"RTP: A Transport Protocol for Real-Time Applications"'>RFC3550</a>].

   Author: Ali Begen &lt;abegen@cisco.com&gt;.

   Change controller: IETF Audio/Video Transport Working Group delegated
   from the IESG.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.3.%20%20Registration%20of%20text%2F1d-interleaved-parityfec"></a><a class="selflink" href="#section-5.1.3" name="section-5.1.3">5.1.3</a>.  Registration of text/1d-interleaved-parityfec</span>

   Type name: text

   Subtype name: 1d-interleaved-parityfec

   Required parameters:

   o  rate: The RTP timestamp (clock) rate in Hz.  The (integer) rate
      SHALL be larger than 1000 to provide sufficient resolution to RTCP
      operations.  However, it is RECOMMENDED to select the rate that
      matches the rate of the protected source RTP stream.

   o  L: Number of columns of the source block.  L is a positive integer
      that is less than or equal to 255.

   o  D: Number of rows of the source block.  D is a positive integer
      that is less than or equal to 255.

   o  repair-window: The time that spans the FEC block (i.e., source
      packets and the corresponding repair packets).  An FEC encoder
      processes a block of source packets and generates a number of
      repair packets, which are then transmitted within a certain
      duration not larger than the value of the repair window.  At the
      receiver side, the FEC decoder should wait at least for the
      duration of the repair window after getting the first packet in an
      FEC block to allow all the repair packets to arrive (the waiting
      time can be adjusted if there are missing packets at the beginning
      of the FEC block).  The FEC decoder can start decoding the already
      received packets sooner; however, it SHOULD NOT register an FEC
      decoding failure until it waits at least for the repair-window
      duration.  The size of the repair window is specified in
      microseconds.

   Optional parameters: None.

   Encoding considerations: This media type is framed (see <a href="#section-4.8">Section 4.8</a>
   in the template document [<a href="rfc4288.html" title='"Media Type Specifications and Registration Procedures"'>RFC4288</a>]) and contains binary data.

   Security considerations: See <a href="rfc6015.html#section-9">Section 9 of [RFC6015]</a>.



<span class="grey">Begen                        Standards Track                   [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


   Interoperability considerations: None.

   Published specification: [<a href="rfc6015.html">RFC6015</a>].

   Applications that use this media type: Multimedia applications that
   want to improve resiliency against packet loss by sending redundant
   data in addition to the source media.

   Additional information: None.

   Person &amp; email address to contact for further information: Ali Begen
   &lt;abegen@cisco.com&gt; and the IETF Audio/Video Transport Working Group.

   Intended usage: COMMON.

   Restriction on usage: This media type depends on RTP framing, and
   hence, is only defined for transport via RTP [<a href="rfc3550.html" title='"RTP: A Transport Protocol for Real-Time Applications"'>RFC3550</a>].

   Author: Ali Begen &lt;abegen@cisco.com&gt;.

   Change controller: IETF Audio/Video Transport Working Group delegated
   from the IESG.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.4.%20%20Registration%20of%20application%2F1d-interleaved-parityfec"></a><a class="selflink" href="#section-5.1.4" name="section-5.1.4">5.1.4</a>.  Registration of application/1d-interleaved-parityfec</span>

   Type name: application

   Subtype name: 1d-interleaved-parityfec

   Required parameters:

   o  rate: The RTP timestamp (clock) rate in Hz.  The (integer) rate
      SHALL be larger than 1000 to provide sufficient resolution to RTCP
      operations.  However, it is RECOMMENDED to select the rate that
      matches the rate of the protected source RTP stream.

   o  L: Number of columns of the source block.  L is a positive integer
      that is less than or equal to 255.

   o  D: Number of rows of the source block.  D is a positive integer
      that is less than or equal to 255.

   o  repair-window: The time that spans the FEC block (i.e., source
      packets and the corresponding repair packets).  An FEC encoder
      processes a block of source packets and generates a number of
      repair packets, which are then transmitted within a certain
      duration not larger than the value of the repair window.  At the
      receiver side, the FEC decoder should wait at least for the



<span class="grey">Begen                        Standards Track                   [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


      duration of the repair window after getting the first packet in an
      FEC block to allow all the repair packets to arrive (the waiting
      time can be adjusted if there are missing packets at the beginning
      of the FEC block).  The FEC decoder can start decoding the already
      received packets sooner; however, it SHOULD NOT register an FEC
      decoding failure until it waits at least for the repair-window
      duration.  The size of the repair window is specified in
      microseconds.

   Optional parameters: None.

   Encoding considerations: This media type is framed (see <a href="#section-4.8">Section 4.8</a>
   in the template document [<a href="rfc4288.html" title='"Media Type Specifications and Registration Procedures"'>RFC4288</a>]) and contains binary data.

   Security considerations: See <a href="rfc6015.html#section-9">Section 9 of [RFC6015]</a>.

   Interoperability considerations: None.

   Published specification: [<a href="rfc6015.html">RFC6015</a>].

   Applications that use this media type: Multimedia applications that
   want to improve resiliency against packet loss by sending redundant
   data in addition to the source media.

   Additional information: None.

   Person &amp; email address to contact for further information: Ali Begen
   &lt;abegen@cisco.com&gt; and the IETF Audio/Video Transport Working Group.

   Intended usage: COMMON.

   Restriction on usage: This media type depends on RTP framing, and
   hence, is only defined for transport via RTP [<a href="rfc3550.html" title='"RTP: A Transport Protocol for Real-Time Applications"'>RFC3550</a>].

   Author: Ali Begen &lt;abegen@cisco.com&gt;.

   Change controller: IETF Audio/Video Transport Working Group delegated
   from the IESG.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Mapping%20to%20SDP%20Parameters"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Mapping to SDP Parameters</span>

   Applications that use RTP transport commonly use Session Description
   Protocol (SDP) [<a href="rfc4566.html" title='"SDP: Session Description Protocol"'>RFC4566</a>] to describe their RTP sessions.  The
   information that is used to specify the media types in an RTP session
   has specific mappings to the fields in an SDP description.  In this
   section, we provide these mappings for the media subtype registered
   by this document ("1d-interleaved-parityfec").  Note that if an
   application does not use SDP to describe the RTP sessions, an



<span class="grey">Begen                        Standards Track                   [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


   appropriate mapping must be defined and used to specify the media
   types and their parameters for the control/description protocol
   employed by the application.

   The mapping of the media type specification for "1d-interleaved-
   parityfec" and its parameters in SDP is as follows:

   o  The media type (e.g., "application") goes into the "m=" line as
      the media name.

   o  The media subtype ("1d-interleaved-parityfec") goes into the
      "a=rtpmap" line as the encoding name.  The RTP clock rate
      parameter ("rate") also goes into the "a=rtpmap" line as the clock
      rate.

   o  The remaining required payload-format-specific parameters go into
      the "a=fmtp" line by copying them directly from the media type
      string as a semicolon-separated list of parameter=value pairs.

   SDP examples are provided in <a href="#section-7">Section 7</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.1.%20%20Offer-Answer%20Model%20Considerations"></a><a class="selflink" href="#section-5.2.1" name="section-5.2.1">5.2.1</a>.  Offer-Answer Model Considerations</span>

   When offering 1-D interleaved parity FEC over RTP using SDP in an
   Offer/Answer model [<a href="rfc3264.html" title='"An Offer/Answer Model with Session Description Protocol (SDP)"'>RFC3264</a>], the following considerations apply:

   o  Each combination of the L and D parameters produces a different
      FEC data and is not compatible with any other combination.  A
      sender application may desire to offer multiple offers with
      different sets of L and D values as long as the parameter values
      are valid.  The receiver SHOULD normally choose the offer that has
      a sufficient amount of interleaving.  If multiple such offers
      exist, the receiver may choose the offer that has the lowest
      overhead or the one that requires the smallest amount of
      buffering.  The selection depends on the application requirements.

   o  The value for the repair-window parameter depends on the L and D
      values and cannot be chosen arbitrarily.  More specifically, L and
      D values determine the lower limit for the repair-window size.
      The upper limit of the repair-window size does not depend on the L
      and D values.

   o  Although combinations with the same L and D values but with
      different repair-window sizes produce the same FEC data, such
      combinations are still considered different offers.  The size of
      the repair-window is related to the maximum delay between the





<span class="grey">Begen                        Standards Track                   [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


      transmission of a source packet and the associated repair packet.
      This directly impacts the buffering requirement on the receiver
      side, and the receiver must consider this when choosing an offer.

   o  There are no optional format parameters defined for this payload.
      Any unknown option in the offer MUST be ignored and deleted from
      the answer.  If FEC is not desired by the receiver, it can be
      deleted from the answer.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.2.%20%20Declarative%20Considerations"></a><a class="selflink" href="#section-5.2.2" name="section-5.2.2">5.2.2</a>.  Declarative Considerations</span>

   In declarative usage, like SDP in the Real-time Streaming Protocol
   (RTSP) [<a href="rfc2326.html" title='"Real Time Streaming Protocol (RTSP)"'>RFC2326</a>] or the Session Announcement Protocol (SAP)
   [<a href="rfc2974.html" title='"Session Announcement Protocol"'>RFC2974</a>], the following considerations apply:

   o  The payload format configuration parameters are all declarative
      and a participant MUST use the configuration that is provided for
      the session.

   o  More than one configuration may be provided (if desired) by
      declaring multiple RTP payload types.  In that case, the receivers
      should choose the repair flow that is best for them.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Protection%20and%20Recovery%20Procedures"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Protection and Recovery Procedures</span>

   This section provides a complete specification of the 1-D interleaved
   parity code and its RTP payload format.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Overview"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Overview</span>

   The following sections specify the steps involved in generating the
   repair packets and reconstructing the missing source packets from the
   repair packets.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Repair%20Packet%20Construction"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Repair Packet Construction</span>

   The RTP header of a repair packet is formed based on the guidelines
   given in <a href="#section-4.2">Section 4.2</a>.

   The FEC header includes 16 octets.  It is constructed by applying the
   XOR operation on the bit strings that are generated from the
   individual source packets protected by this particular repair packet.
   The set of the source packets that are associated with a given repair
   packet can be computed by the formula given in <a href="#section-6.3.1">Section 6.3.1</a>.

   The bit string is formed for each source packet by concatenating the
   following fields together in the order specified:




<span class="grey">Begen                        Standards Track                   [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


   o  Padding bit (1 bit) (This is the most significant bit of the bit
      string.)

   o  Extension bit (1 bit)

   o  CC field (4 bits)

   o  Marker bit (1 bit)

   o  PT field (7 bits)

   o  Timestamp (32 bits)

   o  Unsigned network-ordered 16-bit representation of the source
      packet length in bytes minus 12 (for the fixed RTP header), i.e.,
      the sum of the lengths of all the following if present: the CSRC
      list, header extension, RTP payload, and RTP padding (16 bits).

   o  If CC is nonzero, the CSRC list (variable length)

   o  If X is 1, the header extension (variable length)

   o  Payload (variable length)

   o  Padding, if present (variable length)

   Note that if the lengths of the source packets are not equal, each
   shorter packet MUST be padded to the length of the longest packet by
   adding octet(s) of 0 at the end.  Due to this possible padding and
   mandatory FEC header, a repair packet has a larger size than the
   source packets it protects.  This may cause problems if the resulting
   repair packet size exceeds the Maximum Transmission Unit (MTU) size
   of the path over which the repair flow is sent.

   By applying the parity operation on the bit strings produced from the
   source packets, we generate the FEC bit string.  Some parts of the
   RTP header and the FEC header of the repair packet are generated from
   the FEC bit string as follows:

   o  The first (most significant) bit in the FEC bit string is written
      into the Padding bit in the RTP header of the repair packet.

   o  The next bit in the FEC bit string is written into the Extension
      bit in the RTP header of the repair packet.

   o  The next 4 bits of the FEC bit string are written into the CC
      field in the RTP header of the repair packet.




<span class="grey">Begen                        Standards Track                   [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


   o  The next bit of the FEC bit string is written into the Marker bit
      in the RTP header of the repair packet.

   o  The next 7 bits of the FEC bit string are written into the PT
      recovery field in the FEC header.

   o  The next 32 bits of the FEC bit string are written into the TS
      recovery field in the FEC header.

   o  The next 16 bits are written into the Length recovery field in the
      FEC header.  This allows the FEC procedure to be applied even when
      the lengths of the protected source packets are not identical.

   o  The remaining bits are set to be the payload of the repair packet.

   The remaining parts of the FEC header are set as follows:

   o  The SN base low field MUST be set to the lowest sequence number,
      taking wraparound into account, of those source packets protected
      by this repair packet.

   o  The E bit MUST be set to 1 to extend the [<a href="rfc2733.html" title='"An RTP Payload Format for Generic Forward Error Correction"'>RFC2733</a>] FEC header.

   o  The Mask field SHALL be set to 0 and ignored by the receiver.

   o  The N bit SHALL be set to 0 and ignored by the receiver.

   o  The D bit SHALL be set to 0 and ignored by the receiver.

   o  The Type field MUST be set to 0 and ignored by the receiver.

   o  The Index field SHALL be set to 0 and ignored by the receiver.

   o  The Offset field MUST be set to the number of columns of the
      source block (L).

   o  The NA field MUST be set to the number of rows of the source block
      (D).

   o  The SN base ext field SHALL be set to 0 and ignored by the
      receiver.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20Source%20Packet%20Reconstruction"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  Source Packet Reconstruction</span>

   This section describes the recovery procedures that are required to
   reconstruct the missing source packets.  The recovery process has two
   steps.  In the first step, the FEC decoder determines which source




<span class="grey">Begen                        Standards Track                   [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


   and repair packets should be used in order to recover a missing
   packet.  In the second step, the decoder recovers the missing packet,
   which consists of an RTP header and RTP payload.

   In the following, we describe the RECOMMENDED algorithms for the
   first and second steps.  Based on the implementation, different
   algorithms MAY be adopted.  However, the end result MUST be identical
   to the one produced by the algorithms described below.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.3.1.%20%20Associating%20the%20Source%20and%20Repair%20Packets"></a><a class="selflink" href="#section-6.3.1" name="section-6.3.1">6.3.1</a>.  Associating the Source and Repair Packets</span>

   The first step is to associate the source and repair packets.  The SN
   base low field in the FEC header shows the lowest sequence number of
   the source packets that form the particular column.  In addition, the
   information of how many source packets are available in each column
   and row is available from the media type parameters specified in the
   SDP description.  This set of information uniquely identifies all of
   the source packets associated with a given repair packet.

   Mathematically, for any received repair packet, p*, we can determine
   the sequence numbers of the source packets that are protected by this
   repair packet as follows:

                       p*_snb + i * L (modulo 65536)

   where p*_snb denotes the value in the SN base low field of the FEC
   header of the p*, L is the number of columns of the source block and

                                 0 &lt;= i &lt; D

   where D is the number of rows of the source block.

   We denote the set of the source packets associated with repair packet
   p* by set T(p*).  Note that in a source block whose size is L columns
   by D rows, set T includes D source packets.  Recall that 1-D
   interleaved FEC protection can fully recover the missing information
   if there is only one source packet missing in set T.  If the repair
   packet that protects the source packets in set T is missing, or the
   repair packet is available but two or more source packets are
   missing, then missing source packets in set T cannot be recovered by
   1-D interleaved FEC protection.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.3.2.%20%20Recovering%20the%20RTP%20Header%20and%20Payload"></a><a class="selflink" href="#section-6.3.2" name="section-6.3.2">6.3.2</a>.  Recovering the RTP Header and Payload</span>

   For a given set T, the procedure for the recovery of the RTP header
   of the missing packet, whose sequence number is denoted by SEQNUM, is
   as follows:




<span class="grey">Begen                        Standards Track                   [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


   1.   For each of the source packets that are successfully received in
        set T, compute the bit string as described in <a href="#section-6.2">Section 6.2</a>.

   2.   For the repair packet associated with set T, compute the bit
        string in the same fashion except use the PT recovery field
        instead of the PT field and TS recovery field instead of the
        Timestamp field, and set the CSRC list, header extension and
        padding to null regardless of the values of the CC field, X bit,
        and P bit.

   3.   If any of the bit strings generated from the source packets are
        shorter than the bit string generated from the repair packet,
        pad them to be the same length as the bit string generated from
        the repair packet.  For padding, the padding of octet 0 MUST be
        added at the end of the bit string.

   4.   Calculate the recovered bit string as the XOR of the bit strings
        generated from all source packets in set T and the FEC bit
        string generated from the repair packet associated with set T.

   5.   Create a new packet with the standard 12-byte RTP header and no
        payload.

   6.   Set the version of the new packet to 2.

   7.   Set the Padding bit in the new packet to the first bit in the
        recovered bit string.

   8.   Set the Extension bit in the new packet to the next bit in the
        recovered bit string.

   9.   Set the CC field to the next 4 bits in the recovered bit string.

   10.  Set the Marker bit in the new packet to the next bit in the
        recovered bit string.

   11.  Set the Payload type in the new packet to the next 7 bits in the
        recovered bit string.

   12.  Set the SN field in the new packet to SEQNUM.

   13.  Set the TS field in the new packet to the next 32 bits in the
        recovered bit string.

   14.  Take the next 16 bits of the recovered bit string and set the
        new variable Y to whatever unsigned integer this represents
        (assuming network order).  Convert Y to host order and then take
        Y bytes from the recovered bit string and append them to the new



<span class="grey">Begen                        Standards Track                   [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


        packet.  Y represents the length of the new packet in bytes
        minus 12 (for the fixed RTP header), i.e., the sum of the
        lengths of all the following if present: the CSRC list, header
        extension, RTP payload, and RTP padding.

   15.  Set the SSRC of the new packet to the SSRC of the source RTP
        stream.

   This procedure completely recovers both the header and payload of an
   RTP packet.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Session%20Description%20Protocol%20%28SDP%29%20Signaling"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Session Description Protocol (SDP) Signaling</span>

   This section provides an SDP [<a href="rfc4566.html" title='"SDP: Session Description Protocol"'>RFC4566</a>] example.  The following
   example uses the FEC grouping semantics [<a href="rfc5956.html" title='"Forward Error Correction Grouping Semantics in Session Description Protocol"'>RFC5956</a>].

   In this example, we have one source video stream (mid:S1) and one FEC
   repair stream (mid:R1).  We form one FEC group with the "a=group:
   FEC-FR S1 R1" line.  The source and repair streams are sent to the
   same port on different multicast groups.  The repair window is set to
   200 ms.

        v=0
        o=ali 1122334455 1122334466 IN IP4 fec.example.com
        s=Interleaved Parity FEC Example
        t=0 0
        a=group:FEC-FR S1 R1
        m=video 30000 RTP/AVP 100
        c=IN IP4 233.252.0.1/127
        a=rtpmap:100 MP2T/90000
        a=mid:S1
        m=application 30000 RTP/AVP 110
        c=IN IP4 233.252.0.2/127
        a=rtpmap:110 1d-interleaved-parityfec/90000
        a=fmtp:110 L=5; D=10; repair-window=200000
        a=mid:R1

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Congestion%20Control%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Congestion Control Considerations</span>

   FEC is an effective approach to provide applications with resiliency
   against packet losses.  However, in networks where the congestion is
   a major contributor to the packet loss, the potential impacts of
   using FEC SHOULD be considered carefully before injecting the repair
   flows into the network.  In particular, in bandwidth-limited
   networks, FEC repair flows may consume most or all of the available
   bandwidth and may consequently congest the network.  In such cases,
   the applications MUST NOT arbitrarily increase the amount of FEC




<span class="grey">Begen                        Standards Track                   [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


   protection since doing so may lead to a congestion collapse.  If
   desired, stronger FEC protection MAY be applied only after the source
   rate has been reduced.

   In a network-friendly implementation, an application SHOULD NOT send/
   receive FEC repair flows if it knows that sending/receiving those FEC
   repair flows would not help at all in recovering the missing packets.
   Such a practice helps reduce the amount of wasted bandwidth.  It is
   RECOMMENDED that the amount of FEC protection is adjusted dynamically
   based on the packet loss rate observed by the applications.

   In multicast scenarios, it may be difficult to optimize the FEC
   protection per receiver.  If there is a large variation among the
   levels of FEC protection needed by different receivers, it is
   RECOMMENDED that the sender offers multiple repair flows with
   different levels of FEC protection and the receivers join the
   corresponding multicast sessions to receive the repair flow(s) that
   is best for them.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Security%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Security Considerations</span>

   RTP packets using the payload format defined in this specification
   are subject to the security considerations discussed in the RTP
   specification [<a href="rfc3550.html" title='"RTP: A Transport Protocol for Real-Time Applications"'>RFC3550</a>] and in any applicable RTP profile.

   The main security considerations for the RTP packet carrying the RTP
   payload format defined within this memo are confidentiality,
   integrity, and source authenticity.  Confidentiality is achieved by
   encrypting the RTP payload.  Altering the FEC packets can have a big
   impact on the reconstruction operation.  An attack that changes some
   bits in the FEC packets can have a significant effect on the
   calculation and the recovery of the source packets.  For example,
   changing the length recovery field can result in the recovery of a
   packet that is too long.  Depending on the application, it may be
   helpful to perform a sanity check on the received source and FEC
   packets before performing the recovery operation and to determine the
   validity of the recovered packets before using them.

   The integrity of the RTP packets is achieved through a suitable
   cryptographic integrity protection mechanism.  Such a cryptographic
   system may also allow the authentication of the source of the
   payload.  A suitable security mechanism for this RTP payload format
   should provide source authentication capable of determining if an RTP
   packet is from a member of the RTP session.

   Note that the appropriate mechanism to provide security to RTP and
   payloads following this memo may vary.  It is dependent on the
   application, transport and signaling protocol employed.  Therefore, a



<span class="grey">Begen                        Standards Track                   [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


   single mechanism is not sufficient, although if suitable, using the
   Secure Real-time Transport Protocol (SRTP) [<a href="rfc3711.html" title='"The Secure Real-time Transport Protocol (SRTP)"'>RFC3711</a>] is RECOMMENDED.
   Other mechanisms that may be used are IPsec [<a href="rfc4301.html" title='"Security Architecture for the Internet Protocol"'>RFC4301</a>] and Transport
   Layer Security (TLS) [<a href="rfc5246.html" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>RFC5246</a>]; other alternatives may exist.

   If FEC protection is applied on already encrypted source packets,
   there is no need for additional encryption.  However, if the source
   packets are encrypted after FEC protection is applied, the FEC
   packets should be cryptographically as secure as the source packets.
   Failure to provide an equal level of confidentiality, integrity, and
   authentication to the FEC packets can compromise the source packets'
   confidentiality, integrity or authentication since the FEC packets
   are generated by applying XOR operation across the source packets.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  IANA Considerations</span>

   New media subtypes are subject to IANA registration.  For the
   registration of the payload format and its parameters introduced in
   this document, refer to <a href="#section-5">Section 5</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20Acknowledgments"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  Acknowledgments</span>

   A major part of this document is borrowed from [<a href="rfc2733.html" title='"An RTP Payload Format for Generic Forward Error Correction"'>RFC2733</a>], [<a href="rfc5109.html" title='"RTP Payload Format for Generic Forward Error Correction"'>RFC5109</a>],
   and [<a href="#ref-SMPTE2022-1" title='"Forward Error Correction for Real-Time Video/Audio Transport over IP Networks"'>SMPTE2022-1</a>].  Thus, the author would like to thank the authors
   and editors of these earlier specifications.  The author also thanks
   Colin Perkins for his constructive suggestions for this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/12.%20%20References"></a><a class="selflink" href="#section-12" name="section-12">12</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.1.%20%20Normative%20References"></a><a class="selflink" href="#section-12.1" name="section-12.1">12.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]          Bradner, S., "Key words for use in RFCs to
                      Indicate Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>,
                      March 1997.

   [<a id="ref-RFC3550" name="ref-RFC3550">RFC3550</a>]          Schulzrinne, H., Casner, S., Frederick, R., and V.
                      Jacobson, "RTP: A Transport Protocol for Real-Time
                      Applications", STD 64, <a href="rfc3550.html">RFC 3550</a>, July 2003.

   [<a id="ref-RFC4566" name="ref-RFC4566">RFC4566</a>]          Handley, M., Jacobson, V., and C. Perkins, "SDP:
                      Session Description Protocol", <a href="rfc4566.html">RFC 4566</a>,
                      July 2006.

   [<a id="ref-RFC5956" name="ref-RFC5956">RFC5956</a>]          Begen, A., "Forward Error Correction Grouping
                      Semantics in Session Description Protocol",
                      <a href="rfc5956.html">RFC 5956</a>, September 2010.





<span class="grey">Begen                        Standards Track                   [Page 29]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


   [<a id="ref-RFC4288" name="ref-RFC4288">RFC4288</a>]          Freed, N. and J. Klensin, "Media Type
                      Specifications and Registration Procedures",
                      <a href="https://tools.ietf.org/html/bcp13">BCP 13</a>, <a href="rfc4288.html">RFC 4288</a>, December 2005.

   [<a id="ref-RFC4855" name="ref-RFC4855">RFC4855</a>]          Casner, S., "Media Type Registration of RTP
                      Payload Formats", <a href="rfc4855.html">RFC 4855</a>, February 2007.

   [<a id="ref-RFC3264" name="ref-RFC3264">RFC3264</a>]          Rosenberg, J. and H. Schulzrinne, "An Offer/Answer
                      Model with Session Description Protocol (SDP)",
                      <a href="rfc3264.html">RFC 3264</a>, June 2002.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.2.%20%20Informative%20References"></a><a class="selflink" href="#section-12.2" name="section-12.2">12.2</a>.  Informative References</span>

   [<a id="ref-DVB-AL-FEC" name="ref-DVB-AL-FEC">DVB-AL-FEC</a>]       Begen, A. and T. Stockhammer, "Guidelines for
                      Implementing DVB-IPTV Application-Layer Hybrid FEC
                      Protection", Work in Progress, December 2009.

   [<a id="ref-RFC2733" name="ref-RFC2733">RFC2733</a>]          Rosenberg, J. and H. Schulzrinne, "An RTP Payload
                      Format for Generic Forward Error Correction",
                      <a href="rfc2733.html">RFC 2733</a>, December 1999.

   [<a id="ref-RFC3009" name="ref-RFC3009">RFC3009</a>]          Rosenberg, J. and H. Schulzrinne, "Registration of
                      parityfec MIME types", <a href="rfc3009.html">RFC 3009</a>, November 2000.

   [<a id="ref-RFC5109" name="ref-RFC5109">RFC5109</a>]          Li, A., "RTP Payload Format for Generic Forward
                      Error Correction", <a href="rfc5109.html">RFC 5109</a>, December 2007.

   [<a id="ref-ETSI-TS-102-034" name="ref-ETSI-TS-102-034">ETSI-TS-102-034</a>]  ETSI TS 102 034 V1.4.1, "Transport of MPEG 2 TS
                      Based DVB Services over IP Based Networks",
                      August 2009.

   [<a id="ref-RFC2326" name="ref-RFC2326">RFC2326</a>]          Schulzrinne, H., Rao, A., and R. Lanphier, "Real
                      Time Streaming Protocol (RTSP)", <a href="rfc2326.html">RFC 2326</a>,
                      April 1998.

   [<a id="ref-RFC2974" name="ref-RFC2974">RFC2974</a>]          Handley, M., Perkins, C., and E. Whelan, "Session
                      Announcement Protocol", <a href="rfc2974.html">RFC 2974</a>, October 2000.

   [<a id="ref-SMPTE2022-1" name="ref-SMPTE2022-1">SMPTE2022-1</a>]      SMPTE 2022-1-2007, "Forward Error Correction for
                      Real-Time Video/Audio Transport over IP Networks",
                      2007.

   [<a id="ref-RFC3711" name="ref-RFC3711">RFC3711</a>]          Baugher, M., McGrew, D., Naslund, M., Carrara, E.,
                      and K. Norrman, "The Secure Real-time Transport
                      Protocol (SRTP)", <a href="rfc3711.html">RFC 3711</a>, March 2004.

   [<a id="ref-RFC4301" name="ref-RFC4301">RFC4301</a>]          Kent, S. and K. Seo, "Security Architecture for
                      the Internet Protocol", <a href="rfc4301.html">RFC 4301</a>, December 2005.



<span class="grey">Begen                        Standards Track                   [Page 30]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc6015.html">RFC 6015</a>         RTP Payload Format for Interleaved FEC     October 2010</span>


   [<a id="ref-RFC5246" name="ref-RFC5246">RFC5246</a>]          Dierks, T. and E. Rescorla, "The Transport Layer
                      Security (TLS) Protocol Version 1.2", <a href="rfc5246.html">RFC 5246</a>,
                      August 2008.

Author's Address

   Ali Begen
   Cisco
   181 Bay Street
   Toronto, ON  M5J 2T3
   Canada

   EMail: abegen@cisco.com






































Begen                        Standards Track                   [Page 31]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc6015 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:31 GMT --></html>