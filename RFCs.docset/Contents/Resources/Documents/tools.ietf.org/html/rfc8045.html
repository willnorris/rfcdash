<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from tools.ietf.org/html/rfc8045 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:19:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.129c" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Relation.Replaces" content="draft-cheng-radext-ip-port-radius-ext" />
<meta name="DC.Identifier" content="urn:ietf:rfc:8045" />
<meta name="DC.Date.Issued" content="January, 2017" />
<meta name="DC.Creator" content="Cheng, Dean" />
<meta name="DC.Creator" content="Sivakumar, Senthil" />
<meta name="DC.Creator" content="Boucadair, Mohamed" />
<meta name="DC.Creator" content="Korhonen, Jouni" />
<meta name="DC.Description.Abstract" content="This document defines three new RADIUS attributes. For devices that
implement IP port ranges, these attributes are used to communicate
with a RADIUS server in order to configure and report IP transport
ports as well as mapping behavior for specific hosts. This mechanism
can be used in various deployment scenarios such as Carrier-Grade NAT,
IPv4/IPv6 translators, Provider WLAN gateway, etc. This document
defines a mapping between some RADIUS attributes and IP Flow
Information Export (IPFIX) Information Element identifiers." />
<meta name="DC.Title" content="RADIUS Extensions for IP Port Configuration and Reporting" />

    <link rel="icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 8045 - RADIUS Extensions for IP Port Configuration and Reporting</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgblue"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc8045.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc8045" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-radext-ip-port-radius-ext" title="draft-ietf-radext-ip-port-radius-ext">draft-ietf-rade...</a>] [<a href='https://datatracker.ietf.org/doc/rfc8045' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc8045" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc8045" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=8045">Errata</a>]</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br />
<span class="pre noprint docinfo">                                                            <span style='color: #C00;'>Errata Exist</span></span><br />
<pre>
Internet Engineering Task Force (IETF)                          D. Cheng
Request for Comments: 8045                                        Huawei
Category: Standards Track                                    J. Korhonen
ISSN: 2070-1721                                     Broadcom Corporation
                                                            M. Boucadair
                                                                  Orange
                                                            S. Sivakumar
                                                           Cisco Systems
                                                            January 2017


       <span class="h1">RADIUS Extensions for IP Port Configuration and Reporting</span>

Abstract

   This document defines three new RADIUS attributes.  For devices that
   implement IP port ranges, these attributes are used to communicate
   with a RADIUS server in order to configure and report IP transport
   ports as well as mapping behavior for specific hosts.  This mechanism
   can be used in various deployment scenarios such as Carrier-Grade
   NAT, IPv4/IPv6 translators, Provider WLAN gateway, etc.  This
   document defines a mapping between some RADIUS attributes and IP Flow
   Information Export (IPFIX) Information Element identifiers.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc7841.html#section-2">Section&nbsp;2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc8045">http://www.rfc-editor.org/info/rfc8045</a>.














<span class="grey">Cheng, et al.                Standards Track                    [Page 1]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





































<span class="grey">Cheng, et al.                Standards Track                    [Page 2]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. Terminology .....................................................<a href="#page-5">5</a>
      <a href="#section-2.1">2.1</a>. Requirements Language ......................................<a href="#page-6">6</a>
   <a href="#section-3">3</a>. Extensions of RADIUS Attributes and TLVs ........................<a href="#page-7">7</a>
      <a href="#section-3.1">3.1</a>. Extended Attributes for IP Ports ...........................<a href="#page-7">7</a>
           <a href="#section-3.1.1">3.1.1</a>. IP-Port-Limit-Info Attribute ........................<a href="#page-7">7</a>
           <a href="#section-3.1.2">3.1.2</a>. IP-Port-Range Attribute .............................<a href="#page-9">9</a>
           <a href="#section-3.1.3">3.1.3</a>. IP-Port-Forwarding-Map Attribute ...................<a href="#page-12">12</a>
      <a href="#section-3.2">3.2</a>. RADIUS TLVs for IP Ports ..................................<a href="#page-15">15</a>
           <a href="#section-3.2.1">3.2.1</a>. IP-Port-Type TLV ...................................<a href="#page-16">16</a>
           <a href="#section-3.2.2">3.2.2</a>. IP-Port-Limit TLV ..................................<a href="#page-17">17</a>
           <a href="#section-3.2.3">3.2.3</a>. IP-Port-Ext-IPv4-Addr TLV ..........................<a href="#page-18">18</a>
           <a href="#section-3.2.4">3.2.4</a>. IP-Port-Int-IPv4-Addr TLV ..........................<a href="#page-19">19</a>
           <a href="#section-3.2.5">3.2.5</a>. IP-Port-Int-IPv6-Addr TLV ..........................<a href="#page-20">20</a>
           <a href="#section-3.2.6">3.2.6</a>. IP-Port-Int-Port TLV ...............................<a href="#page-21">21</a>
           <a href="#section-3.2.7">3.2.7</a>. IP-Port-Ext-Port TLV ...............................<a href="#page-22">22</a>
           <a href="#section-3.2.8">3.2.8</a>. IP-Port-Alloc TLV ..................................<a href="#page-23">23</a>
           <a href="#section-3.2.9">3.2.9</a>. IP-Port-Range-Start TLV ............................<a href="#page-24">24</a>
           <a href="#section-3.2.10">3.2.10</a>. IP-Port-Range-End TLV .............................<a href="#page-25">25</a>
           <a href="#section-3.2.11">3.2.11</a>. IP-Port-Local-Id TLV ..............................<a href="#page-25">25</a>
   <a href="#section-4">4</a>. Applications, Use Cases, and Examples ..........................<a href="#page-27">27</a>
      <a href="#section-4.1">4.1</a>. Managing CGN Port Behavior Using RADIUS ...................<a href="#page-27">27</a>
           <a href="#section-4.1.1">4.1.1</a>. Configure IP Port Limit for a User .................<a href="#page-27">27</a>
           <a href="#section-4.1.2">4.1.2</a>. Report IP Port Allocation/Deallocation .............<a href="#page-29">29</a>
           <a href="#section-4.1.3">4.1.3</a>. Configure Port Forwarding Mapping ..................<a href="#page-31">31</a>
           <a href="#section-4.1.4">4.1.4</a>. An Example .........................................<a href="#page-33">33</a>
      <a href="#section-4.2">4.2</a>. Report Assigned Port Set for a Visiting UE ................<a href="#page-35">35</a>
   <a href="#section-5">5</a>. Table of Attributes ............................................<a href="#page-36">36</a>
   <a href="#section-6">6</a>. Security Considerations ........................................<a href="#page-36">36</a>
   <a href="#section-7">7</a>. IANA Considerations ............................................<a href="#page-37">37</a>
      <a href="#section-7.1">7.1</a>. New IPFIX Information Elements ............................<a href="#page-37">37</a>
      <a href="#section-7.2">7.2</a>. New RADIUS Attributes .....................................<a href="#page-38">38</a>
      <a href="#section-7.3">7.3</a>. New RADIUS TLVs ...........................................<a href="#page-38">38</a>
   <a href="#section-8">8</a>. References .....................................................<a href="#page-39">39</a>
      <a href="#section-8.1">8.1</a>. Normative References ......................................<a href="#page-39">39</a>
      <a href="#section-8.2">8.2</a>. Informative References ....................................<a href="#page-40">40</a>
   Acknowledgments ...................................................<a href="#page-43">43</a>
   Authors' Addresses ................................................<a href="#page-43">43</a>











<span class="grey">Cheng, et al.                Standards Track                    [Page 3]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   In a broadband network, customer information is usually stored on a
   RADIUS server [<a href="rfc2865.html" title="&quot;Remote Authentication Dial In User Service (RADIUS)&quot;">RFC2865</a>].  At the time when a user initiates an IP
   connection request, if this request is authorized, the RADIUS server
   will populate the user's configuration information to the Network
   Access Server (NAS), which is often referred to as a Broadband
   Network Gateway (BNG) in broadband access networks.  The Carrier-
   Grade NAT (CGN) function may also be implemented on the BNG.  Within
   this document, the CGN may perform Network Address Translation from
   IPv4 Clients to IPv4 Servers (NAT44) [<a href="rfc3022.html" title="&quot;Traditional IP Network Address Translator (Traditional NAT)&quot;">RFC3022</a>], NAT from IPv6 Clients
   to IPv4 Servers (NAT64) [<a href="rfc6146.html" title="&quot;Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers&quot;">RFC6146</a>], or Dual-Stack Lite Address Family
   Transition Router (AFTR) [<a href="rfc6333.html" title="&quot;Dual-Stack Lite Broadband Deployments Following IPv4 Exhaustion&quot;">RFC6333</a>] function.  In such case, the CGN
   IP transport port (e.g., TCP/UDP port) mapping behaviors can be part
   of the configuration information sent from the RADIUS server to the
   NAS/BNG.  As part of the accounting information sent from the NAS/BNG
   to a RADIUS server, the NAS/BNG may also report the IP port mapping
   behavior applied by the CGN to a user session.

   When IP packets traverse the CGN, it performs mapping on the IP
   transport (e.g., TCP/UDP) source port as required.  An IP transport
   source port, along with a source IP address, destination IP address,
   destination port, and protocol identifier, if applicable, uniquely
   identify a mapping.  Since the number space of IP transport ports in
   the CGN's external realm is shared among multiple users assigned with
   the same IPv4 address, the total number of a user's simultaneous IP
   mappings is likely to be subject to a port quota (see <a href="rfc6269.html#section-5">Section&nbsp;5 of
   [RFC6269]</a>).

   The attributes defined in this document may also be used to report
   the assigned port range in some deployments, such as Provider WLAN
   [<a href="#ref-WIFI-SERVICES" title="&quot;Service Provider Wi-Fi Services Over Residential Architectures&quot;">WIFI-SERVICES</a>].  For example, a visiting host can be managed by
   Customer Premises Equipment (CPE), which will need to report the
   assigned port range to the service platform.  This is required for
   identification purposes (see TR-146 [<a href="#ref-TR-146" title="&quot;TR-146: Subscriber Sessions&quot;">TR-146</a>] for more details).

   This document proposes three new attributes as RADIUS protocol
   extensions; they are used for separate purposes, as follows:

   1.  IP-Port-Limit-Info: This attribute may be carried in a RADIUS
       Access-Accept, Access-Request, Accounting-Request, or CoA-Request
       packet.  The purpose of this attribute is to limit the total
       number of IP source transport ports allocated to a user and
       associated with one or more IPv4 or IPv6 addresses.

   2.  IP-Port-Range: This attribute may be carried in a RADIUS
       Accounting-Request packet.  The purpose of this attribute is for
       an address-sharing device (e.g., a CGN) to report to the RADIUS



<span class="grey">Cheng, et al.                Standards Track                    [Page 4]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


       server the range of IP source transport ports that have been
       allocated or deallocated for a user.  The port range is bound to
       an external IPv4 address.

   3.  IP-Port-Forwarding-Map: This attribute may be carried in RADIUS
       Access-Accept, Access-Request, Accounting-Request, or CoA-Request
       packet.  The purpose of this attribute is to specify how an IP
       internal source transport port, together with its internal IPv4
       or IPv6 address, are mapped to an external source transport port
       along with the external IPv4 address.

   IPFIX Information Elements [<a href="rfc7012.html" title="&quot;Information Model for IP Flow Information Export (IPFIX)&quot;">RFC7012</a>] can be used for IP flow
   identification and representation over RADIUS.  This document
   provides a mapping between some RADIUS TLVs and IPFIX Information
   Element identifiers.  A new IPFIX Information Element is defined by
   this document (see <a href="#section-3.2.2">Section 3.2.2</a>).

   IP protocol numbers (refer to [<a href="#ref-ProtocolNumbers" title="&quot;Protocol Numbers&quot;">ProtocolNumbers</a>]) can be used for
   identification of IP transport protocols (e.g., TCP [<a href="rfc793.html" title="&quot;Transmission Control Protocol&quot;">RFC793</a>], UDP
   [<a href="rfc768.html" title="&quot;User Datagram Protocol&quot;">RFC768</a>], Datagram Congestion Control Protocol (DCCP) [<a href="rfc4340.html" title="&quot;Datagram Congestion Control Protocol (DCCP)&quot;">RFC4340</a>], and
   Stream Control Transmission Protocol (SCTP) [<a href="rfc4960.html" title="&quot;Stream Control Transmission Protocol&quot;">RFC4960</a>]) that are
   associated with some RADIUS attributes.

   This document focuses on IPv4 address sharing.  Mechanisms for IPv6
   prefix sharing (e.g., IPv6-to-IPv6 Network Prefix Translation
   (NPTv6)) are out of scope.

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Terminology</span>

   This document makes use of the following terms:

   o  IP Port: This refers to an IP transport port (e.g., a TCP port
      number or UDP port number).

   o  IP Port Type: This refers to the IP transport protocol as
      indicated by the IP transport protocol number.  Refer to
      [<a href="#ref-ProtocolNumbers" title="&quot;Protocol Numbers&quot;">ProtocolNumbers</a>].

   o  IP Port Limit: This denotes the maximum number of IP ports for a
      specific (or all) IP transport protocol(s) that a device
      supporting port ranges can use when performing port number
      mappings for a specific user/host.  Note that this limit is
      usually associated with one or more IPv4/IPv6 addresses.

   o  IP Port Range: This specifies a set of contiguous IP ports
      indicated by the lowest numerical number and the highest numerical
      number, inclusively.




<span class="grey">Cheng, et al.                Standards Track                    [Page 5]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   o  Internal IP Address: This refers to the IP address that is used by
      a host as a source IP address in an outbound IP packet sent
      towards a device supporting port ranges in the internal realm.
      The internal IP address may be IPv4 or IPv6.

   o  External IP Address: This refers to the IP address that is used as
      a source IP address in an outbound IP packet after traversing a
      device supporting port ranges in the external realm.  This
      document assumes that the external IP address is an IPv4 address.

   o  Internal Port: This is an IP transport port that is allocated by a
      host or application behind an address-sharing device for an
      outbound IP packet in the internal realm.

   o  External Port: This is an IP transport port that is allocated by
      an address-sharing device upon receiving an outbound IP packet in
      the internal realm and is used to replace the internal port that
      is allocated by a user or application.

   o  External Realm: This refers to the networking segment where
      external IP addresses are used as source addresses of outbound
      packets forwarded by an address-sharing device.

   o  Internal Realm: This refers to the networking segment that is
      behind an address-sharing device and where internal IP addresses
      are used.

   o  Mapping: This denotes a relationship between an internal IP
      address, internal port, and protocol, as well as an external IP
      address, external port, and protocol.

   o  Address-Sharing Device: This is a device that is capable of
      sharing an IPv4 address among multiple users.  A typical example
      of this device is a CGN, CPE, Provider WLAN gateway, etc.

<span class="h3"><a class="selflink" name="section-2.1" href="#section-2.1">2.1</a>.  Requirements Language</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].











<span class="grey">Cheng, et al.                Standards Track                    [Page 6]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Extensions of RADIUS Attributes and TLVs</span>

   These three new attributes are defined in the following subsections:

   1.  IP-Port-Limit-Info Attribute

   2.  IP-Port-Range Attribute

   3.  IP-Port-Forwarding-Map Attribute

   All these attributes are allocated from the RADIUS "Extended Type"
   code space per [<a href="rfc6929.html" title="&quot;Remote Authentication Dial In User Service (RADIUS) Protocol Extensions&quot;">RFC6929</a>].

   These attributes and their embedded TLVs (refer to <a href="#section-3.2">Section 3.2</a>) are
   defined with globally unique names and follow the guidelines in
   <a href="rfc6929.html#section-2.7.1">Section&nbsp;2.7.1 of [RFC6929]</a>.

   In all the figures describing the RADIUS attributes and TLV formats
   in the following subsections, the fields are transmitted from left to
   right.

<span class="h3"><a class="selflink" name="section-3.1" href="#section-3.1">3.1</a>.  Extended Attributes for IP Ports</span>

<span class="h4"><a class="selflink" name="section-3.1.1" href="#section-3.1.1">3.1.1</a>.  IP-Port-Limit-Info Attribute</span>

   This attribute is of type "tlv" as defined in the RADIUS Protocol
   Extensions [<a href="rfc6929.html" title="&quot;Remote Authentication Dial In User Service (RADIUS) Protocol Extensions&quot;">RFC6929</a>].  It contains some sub-attributes, and the
   requirements are as follows:

   o  The IP-Port-Limit-Info Attribute MAY contain the IP-Port-Type TLV
      (see <a href="#section-3.2.1">Section 3.2.1</a>).

   o  The IP-Port-Limit-Info Attribute MUST contain the
      IP-Port-Limit TLV (see <a href="#section-3.2.2">Section 3.2.2</a>).

   o  The IP-Port-Limit-Info Attribute MAY contain the
      IP-Port-Ext-IPv4-Addr TLV (see <a href="#section-3.2.3">Section 3.2.3</a>).

   The IP-Port-Limit-Info Attribute specifies the maximum number of IP
   ports, as indicated in IP-Port-Limit TLV, of a specific IP transport
   protocol, as indicated in IP-Port-Type TLV, and associated with a
   given IPv4 address, as indicated in IP-Port-Ext-IPv4-Addr TLV, for an
   end user.

   Note that when IP-Port-Type TLV is not included as part of the
   IP-Port-Limit-Info Attribute, the port limit applies to all IP
   transport protocols.




<span class="grey">Cheng, et al.                Standards Track                    [Page 7]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   Note also that when IP-Port-Ext-IPv4-Addr TLV is not included as part
   of the IP-Port-Limit-Info Attribute, the port limit applies to all
   the IPv4 addresses managed by the address-sharing device, e.g., a CGN
   or NAT64 device.

   The IP-Port-Limit-Info Attribute MAY appear in an Access-Accept
   packet.  It MAY also appear in an Access-Request packet as a
   preferred maximum number of IP ports indicated by the device
   supporting port ranges co-located with the NAS, e.g., a CGN or NAT64.

   The IP-Port-Limit-Info Attribute MAY appear in a CoA-Request packet.

   The IP-Port-Limit-Info Attribute MAY appear in an Accounting-Request
   packet.

   The IP-Port-Limit-Info Attribute MUST NOT appear in any other RADIUS
   packet.

   The format of the IP-Port-Limit-Info Attribute is shown in Figure 1.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |     Length    | Extended-Type |    Value ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                 Figure 1

   Type

      241

   Length

      This field indicates the total length in octets of all fields of
      this attribute, including the Type, Length, Extended-Type, and the
      entire length of the embedded TLVs.

   Extended-Type

      5










<span class="grey">Cheng, et al.                Standards Track                    [Page 8]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   Value

      This field contains a set of TLVs as follows:

      IP-Port-Type TLV

         This TLV contains a value that indicates the IP port type.
         Refer to <a href="#section-3.2.1">Section 3.2.1</a>.

      IP-Port-Limit TLV

         This TLV contains the maximum number of IP ports of a specific
         IP port type and associated with a given IPv4 address for an
         end user.  This TLV MUST be included in the IP-Port-Limit-Info
         Attribute.  Refer to <a href="#section-3.2.2">Section 3.2.2</a>.  This limit applies to all
         mappings that can be instantiated by an underlying address-
         sharing device without soliciting any external entity.  In
         particular, this limit does not include the ports that are
         instructed by an Authentication, Authorization, and Accounting
         (AAA) server.

      IP-Port-Ext-IPv4-Addr TLV

         This TLV contains the IPv4 address that is associated with the
         IP port limit contained in the IP-Port-Limit TLV.  This TLV is
         optionally included as part of the IP-Port-Limit-Info
         Attribute.  Refer to <a href="#section-3.2.3">Section 3.2.3</a>.

   IP-Port-Limit-Info Attribute is associated with the following
   identifier: 241.5.

<span class="h4"><a class="selflink" name="section-3.1.2" href="#section-3.1.2">3.1.2</a>.  IP-Port-Range Attribute</span>

   This attribute is of type "tlv" as defined in the RADIUS Protocol
   Extensions [<a href="rfc6929.html" title="&quot;Remote Authentication Dial In User Service (RADIUS) Protocol Extensions&quot;">RFC6929</a>].  It contains some sub-attributes and the
   requirement is as follows:

   o  The IP-Port-Range Attribute MAY contain the IP-Port-Type TLV (see
      <a href="#section-3.2.1">Section 3.2.1</a>).

   o  The IP-Port-Range Attribute MUST contain the IP-Port-Alloc TLV
      (see <a href="#section-3.2.8">Section 3.2.8</a>).









<span class="grey">Cheng, et al.                Standards Track                    [Page 9]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   o  For port allocation, the IP-Port-Range Attribute MUST contain both
      the IP-Port-Range-Start TLV (see <a href="#section-3.2.9">Section 3.2.9</a>) and the
      IP-Port-Range-End TLV (see <a href="#section-3.2.10">Section 3.2.10</a>).  For port
      deallocation, the IP-Port-Range Attribute MAY contain both of
      these two TLVs; if the two TLVs are not included, it implies that
      all ports that were previously allocated are now all deallocated.

   o  The IP-Port-Range Attribute MAY contain the
      IP-Port-Ext-IPv4-Addr TLV (see <a href="#section-3.2.3">Section 3.2.3</a>).

   o  The IP-Port-Range Attribute MAY contain the IP-Port-Local-Id TLV
      (see <a href="#section-3.2.11">Section 3.2.11</a>).

   The IP-Port-Range Attribute contains a range of contiguous IP ports.
   These ports are either to be allocated or deallocated depending on
   the Value carried by the IP-Port-Alloc TLV.

   If the IP-Port-Type TLV is included as part of the IP-Port-Range
   Attribute, then the port range is associated with the specific IP
   transport protocol as specified in the IP-Port-Type TLV, but
   otherwise it is for all IP transport protocols.

   If the IP-Port-Ext-IPv4-Addr TLV is included as part of the
   IP-Port-Range Attribute, then the port range as specified is
   associated with the IPv4 address as indicated, but otherwise it is
   for all IPv4 addresses by the address-sharing device (e.g., a CGN
   device) for the end user.

   This attribute can be used to convey a single IP transport port
   number: in such case, the Value of the IP-Port-Range-Start TLV and
   the IP-Port-Range-End TLV, respectively, contain the same port
   number.

   The information contained in the IP-Port-Range Attribute is sent to
   RADIUS server.

   The IP-Port-Range Attribute MAY appear in an Accounting-Request
   packet.

   The IP-Port-Range Attribute MUST NOT appear in any other RADIUS
   packet.










<span class="grey">Cheng, et al.                Standards Track                   [Page 10]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   The format of the IP-Port-Range Attribute is shown in Figure 2.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |     Length    | Extended-Type |    Value ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                 Figure 2

   Type

      241

   Length

      This field indicates the total length in octets of all fields of
      this attribute, including the Type, Length, Extended-Type, and the
      entire length of the embedded TLVs.

   Extended-Type

      6

   Value

      This field contains a set of TLVs as follows:

      IP-Port-Type TLV

         This TLV contains a value that indicates the IP port type.
         Refer to <a href="#section-3.2.1">Section 3.2.1</a>.

      IP-Port-Alloc TLV

         This TLV contains a flag to indicate the range of the specified
         IP ports for either allocation or deallocation.  This TLV MUST
         be included as part of the IP-Port-Range Attribute.  Refer to
         <a href="#section-3.2.8">Section 3.2.8</a>.

      IP-Port-Range-Start TLV

         This TLV contains the smallest port number of a range of
         contiguous IP ports.  To report the port allocation, this TLV
         MUST be included together with IP-Port-Range-End TLV as part of
         the IP-Port-Range Attribute.  Refer to <a href="#section-3.2.9">Section 3.2.9</a>.





<span class="grey">Cheng, et al.                Standards Track                   [Page 11]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


      IP-Port-Range-End TLV

         This TLV contains the largest port number of a range of
         contiguous IP ports.  To report the port allocation, this TLV
         MUST be included together with IP-Port-Range-Start TLV as part
         of the IP-Port-Range Attribute.  Refer to <a href="#section-3.2.10">Section 3.2.10</a>.

      IP-Port-Ext-IPv4-Addr TLV

         This TLV contains the IPv4 address that is associated with the
         IP port range, as is collectively indicated in the
         IP-Port-Range-Start TLV and the IP-Port-Range-End TLV.  This
         TLV is optionally included as part of the IP-Port-Range
         Attribute.  Refer to <a href="#section-3.2.3">Section 3.2.3</a>.

      IP-Port-Local-Id TLV

         This TLV contains a local significant identifier at the
         customer premise, such as the Media Access Control (MAC)
         address, interface ID, VLAN ID, PPP sessions ID, VPN Routing
         and Forwarding (VRF) ID, IP address/prefix, etc.  This TLV is
         optionally included as part of the IP-Port-Range Attribute.
         Refer to <a href="#section-3.2.11">Section 3.2.11</a>.

   The IP-Port-Range Attribute is associated with the following
   identifier: 241.6.

<span class="h4"><a class="selflink" name="section-3.1.3" href="#section-3.1.3">3.1.3</a>.  IP-Port-Forwarding-Map Attribute</span>

   This attribute is of type "tlv" as defined in the RADIUS Protocol
   Extensions [<a href="rfc6929.html" title="&quot;Remote Authentication Dial In User Service (RADIUS) Protocol Extensions&quot;">RFC6929</a>].  It contains some sub-attributes and the
   requirement is as follows:

   o  The IP-Port-Forwarding-Map Attribute MAY contain the
      IP-Port-Type TLV (see <a href="#section-3.2.1">Section 3.2.1</a>).

   o  The IP-Port-Forwarding-Map Attribute MUST contain both
      IP-Port-Int-Port TLV (see <a href="#section-3.2.6">Section 3.2.6</a>) and the
      IP-Port-Ext-Port TLV (see <a href="#section-3.2.7">Section 3.2.7</a>).

   o  If the internal realm is with an IPv4 address family, the
      IP-Port-Forwarding-Map Attribute MUST contain the
      IP-Port-Int-IPv4-Addr TLV (see <a href="#section-3.2.4">Section 3.2.4</a>); if the internal
      realm is with an IPv6 address family, the IP-Port-Forwarding-Map
      Attribute MUST contain the IP-Port-Int-IPv6-Addr TLV (see
      <a href="#section-3.2.5">Section 3.2.5</a>).





<span class="grey">Cheng, et al.                Standards Track                   [Page 12]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   o  The IP-Port-Forwarding-Map Attribute MAY contain the
      IP-Port-Ext-IPv4-Addr TLV (see <a href="#section-3.2.3">Section 3.2.3</a>).

   o  The IP-Port-Forwarding-Map Attribute MAY contain the
      IP-Port-Local-Id TLV (see <a href="#section-3.2.11">Section 3.2.11</a>).

   The attribute contains a two-octet IP internal port number and a
   two-octet IP external port number.  The internal port number is
   associated with an internal IPv4 or IPv6 address that MUST always be
   included.  The external port number is associated with a specific
   external IPv4 address if included, but otherwise it is associated
   with all external IPv4 addresses for the end user.

   If the IP-Port-Type TLV is included as part of the
   IP-Port-Forwarding-Map Attribute, then the port mapping is associated
   with the specific IP transport protocol as specified in the
   IP-Port-Type TLV, but otherwise it is for all IP transport protocols.

   The IP-Port-Forwarding-Map Attribute MAY appear in an Access-Accept
   packet.  It MAY also appear in an Access-Request packet to indicate a
   preferred port mapping by the device co-located with NAS.  However,
   the server is not required to honor such a preference.

   The IP-Port-Forwarding-Map Attribute MAY appear in a CoA-Request
   packet.

   The IP-Port-Forwarding-Map Attribute MAY also appear in an
   Accounting-Request packet.

   The IP-Port-Forwarding-Map Attribute MUST NOT appear in any other
   RADIUS packet.




















<span class="grey">Cheng, et al.                Standards Track                   [Page 13]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   The format of the IP-Port-Forwarding-Map Attribute is shown in
   Figure 3.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |     Length    | Extended-Type |    Value ....
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                 Figure 3

   Type

      241

   Length

      This field indicates the total length in octets of all fields of
      this attribute, including the Type, Length, Extended-Type, and the
      entire length of the embedded TLVs.

   Extended-Type

      7

   Value

      This field contains a set of TLVs as follows:

      IP-Port-Type TLV

         This TLV contains a value that indicates the IP port type.
         Refer to <a href="#section-3.2.1">Section 3.2.1</a>.

      IP-Port-Int-Port TLV

         This TLV contains an internal IP port number associated with an
         internal IPv4 or IPv6 address.  This TLV MUST be included
         together with IP-Port-Ext-Port TLV as part of the
         IP-Port-Forwarding-Map Attribute.  Refer to <a href="#section-3.2.6">Section 3.2.6</a>.

      IP-Port-Ext-Port TLV

         This TLV contains an external IP port number associated with an
         external IPv4 address.  This TLV MUST be included together with
         IP-Port-Int-Port TLV as part of the IP-Port-Forwarding-Map
         Attribute.  Refer to <a href="#section-3.2.7">Section 3.2.7</a>.




<span class="grey">Cheng, et al.                Standards Track                   [Page 14]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-15" id="page-15" href="#page-15" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


      IP-Port-Int-IPv4-Addr TLV

         This TLV contains an IPv4 address that is associated with the
         internal IP port number contained in the IP-Port-Int-Port TLV.
         For the internal realm with an IPv4 address family, this TLV
         MUST be included as part of the IP-Port-Forwarding-Map
         Attribute.  Refer to <a href="#section-3.2.4">Section 3.2.4</a>.

      IP-Port-Int-IPv6-Addr TLV

         This TLV contains an IPv6 address that is associated with the
         internal IP port number contained in the IP-Port-Int-Port TLV.
         For the internal realm with an IPv6 address family, this TLV
         MUST be included as part of the IP-Port-Forwarding-Map
         Attribute.  Refer to <a href="#section-3.2.5">Section 3.2.5</a>.

      IP-Port-Ext-IPv4-Addr TLV

         This TLV contains an IPv4 address that is associated with the
         external IP port number contained in the IP-Port-Ext-Port TLV.
         This TLV MAY be included as part of the IP-Port-Forwarding-Map
         Attribute.  Refer to <a href="#section-3.2.3">Section 3.2.3</a>.

      IP-Port-Local-Id TLV

         This TLV contains a local significant identifier at the
         customer premise, such as MAC address, interface ID, VLAN ID,
         PPP sessions ID, VRF ID, IP address/prefix, etc.  This TLV is
         optionally included as part of the IP-Port-Forwarding-Map
         Attribute.  Refer to <a href="#section-3.2.11">Section 3.2.11</a>.

   The IP-Port-Forwarding-Map Attribute is associated with the following
   identifier: 241.7.

<span class="h3"><a class="selflink" name="section-3.2" href="#section-3.2">3.2</a>.  RADIUS TLVs for IP Ports</span>

   The TLVs that are included in the three attributes (see <a href="#section-3.1">Section 3.1</a>)
   are defined in the following subsections.  These TLVs use the format
   defined in [<a href="rfc6929.html" title="&quot;Remote Authentication Dial In User Service (RADIUS) Protocol Extensions&quot;">RFC6929</a>].  As the three attributes carry similar data, we
   have defined a common set of TLVs that are used for all three
   attributes.  That is, the TLVs have the same name and number when
   encapsulated in any one of the three parent attributes.  See
   Sections <a href="#section-3.1.1">3.1.1</a>, <a href="#section-3.1.2">3.1.2</a>, and <a href="#section-3.1.3">3.1.3</a> for a list of which TLV is permitted
   within which parent attribute.







<span class="grey">Cheng, et al.                Standards Track                   [Page 15]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-16" id="page-16" href="#page-16" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   The encoding of the Value field of these TLVs follows the
   recommendation of [<a href="rfc6158.html" title="&quot;RADIUS Design Guidelines&quot;">RFC6158</a>].  In particular, IP-Port-Type,
   IP-Port-Limit, IP-Port-Int-Port, IP-Port-Ext-Port, IP-Port-Alloc,
   IP-Port-Range-Start, and IP-Port-Range-End TLVs are encoded in
   32 bits as per the recommendation in <a href="rfc6158.html#appendix-A.2.1">Appendix&nbsp;A.2.1 of [RFC6158]</a>.

<span class="h4"><a class="selflink" name="section-3.2.1" href="#section-3.2.1">3.2.1</a>.  IP-Port-Type TLV</span>

   The format of IP-Port-Type TLV is shown in Figure 4.  This attribute
   carries the IP transport protocol number defined by IANA (refer to
   [<a href="#ref-ProtocolNumbers" title="&quot;Protocol Numbers&quot;">ProtocolNumbers</a>]).

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   TLV-Type    |     Length    |        Protocol-Number
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
           Protocol-Number         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                 Figure 4

   TLV-Type

      1

   Length

      Six octets

   Protocol-Number

      Integer.  This field contains the data (unsigned8) of the protocol
      number defined in [<a href="#ref-ProtocolNumbers" title="&quot;Protocol Numbers&quot;">ProtocolNumbers</a>], right justified, and the
      unused bits in this field MUST be set to zero.  Protocols that do
      not use a port number (e.g., the Resource Reservation Protocol
      (RSVP) or IP Encapsulating Security Payload (ESP)) MUST NOT be
      included in the IP-Port-Type TLV.

   IP-Port-Type TLV MAY be included in the following attributes:

   o  IP-Port-Limit-Info Attribute, identified as 241.5.1 (see
      <a href="#section-3.1.1">Section 3.1.1</a>)

   o  IP-Port-Range Attribute, identified as 241.6.1 (see <a href="#section-3.1.2">Section 3.1.2</a>)

   o  IP-Port-Forwarding-Map Attribute, identified as 241.7.1 (see
      <a href="#section-3.1.3">Section 3.1.3</a>)



<span class="grey">Cheng, et al.                Standards Track                   [Page 16]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-17" id="page-17" href="#page-17" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   When the IP-Port-Type TLV is included within a RADIUS attribute, the
   associated attribute is applied to the IP transport protocol as
   indicated by the Protocol-Number only, such as TCP, UDP, SCTP,
   DCCP, etc.

<span class="h4"><a class="selflink" name="section-3.2.2" href="#section-3.2.2">3.2.2</a>.  IP-Port-Limit TLV</span>

   The format of IP-Port-Limit TLV is shown in Figure 5.  This attribute
   carries IPFIX Information Element 458, "sourceTransportPortsLimit",
   which indicates the maximum number of IP transport ports as a limit
   for an end user to use that is associated with one or more IPv4 or
   IPv6 addresses.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   TLV-Type    |     Length    |    sourceTransportPortsLimit
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        sourceTransportPortsLimit  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                 Figure 5

   TLV-Type

      2

   Length

      Six octets

   sourceTransportPortsLimit

      Integer.  This field contains the data (unsigned16) of
      sourceTransportPortsLimit (458) defined in IPFIX, right justified,
      and the unused bits in this field MUST be set to zero.

   IP-Port-Limit TLV MUST be included as part of the IP-Port-Limit-Info
   Attribute (refer to <a href="#section-3.1.1">Section 3.1.1</a>), identified as 241.5.2.












<span class="grey">Cheng, et al.                Standards Track                   [Page 17]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-18" id="page-18" href="#page-18" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


<span class="h4"><a class="selflink" name="section-3.2.3" href="#section-3.2.3">3.2.3</a>.  IP-Port-Ext-IPv4-Addr TLV</span>

   The format of IP-Port-Ext-IPv4-Addr TLV is shown in Figure 6.  This
   attribute carries IPFIX Information Element 225,
   "postNATSourceIPv4Address", which is the IPv4 source address after
   NAT operation (refer to [<a href="#ref-IPFIX" title="&quot;IP Flow Information Export (IPFIX) Entities&quot;">IPFIX</a>]).

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   TLV-Type    |    Length     |    postNATSourceIPv4Address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        postNATSourceIPv4Address   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                 Figure 6

   TLV-Type

      3

   Length

      Six octets

   postNATSourceIPv4Address

      Integer.  This field contains the data (ipv4Address) of
      postNATSourceIPv4Address (225) defined in IPFIX.

   IP-Port-Ext-IPv4-Addr TLV MAY be included in the following
   attributes:

   o  IP-Port-Limit-Info Attribute, identified as 241.5.3 (see
      <a href="#section-3.1.1">Section 3.1.1</a>)

   o  IP-Port-Range Attribute, identified as 241.6.3 (see <a href="#section-3.1.2">Section 3.1.2</a>)

   o  IP-Port-Forwarding-Mapping Attribute, identified as 241.7.3 (see
      <a href="#section-3.1.3">Section 3.1.3</a>)











<span class="grey">Cheng, et al.                Standards Track                   [Page 18]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-19" id="page-19" href="#page-19" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


<span class="h4"><a class="selflink" name="section-3.2.4" href="#section-3.2.4">3.2.4</a>.  IP-Port-Int-IPv4-Addr TLV</span>

   The format of IP-Port-Int-IPv4 TLV is shown in Figure 7.  This
   attribute carries IPFIX Information Element 8, "sourceIPv4Address",
   which is the IPv4 source address before NAT operation (refer to
   [<a href="#ref-IPFIX" title="&quot;IP Flow Information Export (IPFIX) Entities&quot;">IPFIX</a>]).

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   TLV-Type    |     Length    |       sourceIPv4Address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         sourceIPv4Address         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                 Figure 7

   TLV-Type

      4

   Length

      Six octets

   sourceIPv4Address

      Integer.  This field contains the data (ipv4Address) of
      sourceIPv4Address (8) defined in IPFIX.

   If the internal realm is with an IPv4 address family, the
   IP-Port-Int-IPv4-Addr TLV MUST be included as part of the
   IP-Port-Forwarding-Map Attribute (refer to <a href="#section-3.1.3">Section 3.1.3</a>),
   identified as 241.7.4.

















<span class="grey">Cheng, et al.                Standards Track                   [Page 19]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-20" id="page-20" href="#page-20" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


<span class="h4"><a class="selflink" name="section-3.2.5" href="#section-3.2.5">3.2.5</a>.  IP-Port-Int-IPv6-Addr TLV</span>

   The format of IP-Port-Int-IPv6-Addr TLV is shown in Figure 8.  This
   attribute carries IPFIX Information Element 27, "sourceIPv6Address",
   which is the IPv6 source address before NAT operation (refer to
   [<a href="#ref-IPFIX" title="&quot;IP Flow Information Export (IPFIX) Entities&quot;">IPFIX</a>]).

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   TLV-Type    |     Length    |        sourceIPv6Address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                             sourceIPv6Address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                             sourceIPv6Address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                             sourceIPv6Address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
           sourceIPv6Address       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                 Figure 8

   TLV-Type

      5

   Length

      Eighteen octets

   sourceIPv6Address

      IPv6 address (128 bits).  This field contains the data
      (ipv6Address) of sourceIPv6Address (27) defined in IPFIX.

   If the internal realm is with an IPv6 address family, the
   IP-Port-Int-IPv6-Addr TLV MUST be included as part of the
   IP-Port-Forwarding-Map Attribute (refer to <a href="#section-3.1.3">Section 3.1.3</a>),
   identified as 241.7.5.











<span class="grey">Cheng, et al.                Standards Track                   [Page 20]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-21" id="page-21" href="#page-21" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


<span class="h4"><a class="selflink" name="section-3.2.6" href="#section-3.2.6">3.2.6</a>.  IP-Port-Int-Port TLV</span>

   The format of IP-Port-Int-Port TLV is shown in Figure 9.  This
   attribute carries IPFIX Information Element 7, "sourceTransportPort",
   which is the source transport number associated with an internal IPv4
   or IPv6 address (refer to [<a href="#ref-IPFIX" title="&quot;IP Flow Information Export (IPFIX) Entities&quot;">IPFIX</a>]).

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    TLV-Type   |     Length    |      sourceTransportPort
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
           sourceTransportPort     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                 Figure 9

   TLV-Type

      6

   Length

      Six octets

   sourceTransportPort

      Integer.  This field contains the data (unsigned16) of
      sourceTransportPort (7) defined in IPFIX, right justified, and
      unused bits MUST be set to zero.

   IP-Port-Int-Port TLV MUST be included as part of the
   IP-Port-Forwarding-Map Attribute (refer to <a href="#section-3.1.3">Section 3.1.3</a>),
   identified as 241.7.6.

















<span class="grey">Cheng, et al.                Standards Track                   [Page 21]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-22" id="page-22" href="#page-22" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


<span class="h4"><a class="selflink" name="section-3.2.7" href="#section-3.2.7">3.2.7</a>.  IP-Port-Ext-Port TLV</span>

   The format of IP-Port-Ext-Port TLV is shown in Figure 10.  This
   attribute carries IPFIX Information Element 227,
   "postNAPTSourceTransportPort", which is the transport number
   associated with an external IPv4 address (refer to [<a href="#ref-IPFIX" title="&quot;IP Flow Information Export (IPFIX) Entities&quot;">IPFIX</a>]).

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    TLV-Type   |     Length    |  postNAPTSourceTransportPort
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      postNAPTSourceTransportPort  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                 Figure 10

   TLV-Type

      7

   Length

      Six octets

   postNAPTSourceTransportPort

      Integer.  This field contains the data (unsigned16) of
      postNAPTSourceTransportPort (227) defined in IPFIX, right
      justified, and unused bits MUST be set to zero.

   IP-Port-Ext-Port TLV MUST be included as part of the
   IP-Port-Forwarding-Map Attribute (refer to <a href="#section-3.1.3">Section 3.1.3</a>),
   identified as 241.7.7.

















<span class="grey">Cheng, et al.                Standards Track                   [Page 22]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-23" id="page-23" href="#page-23" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


<span class="h4"><a class="selflink" name="section-3.2.8" href="#section-3.2.8">3.2.8</a>.  IP-Port-Alloc TLV</span>

   The format of IP-Port-Alloc TLV is shown in Figure 11.  This
   attribute carries IPFIX Information Element 230, "natEvent", which is
   a flag to indicate an action of NAT operation (refer to [<a href="#ref-IPFIX" title="&quot;IP Flow Information Export (IPFIX) Entities&quot;">IPFIX</a>]).

   When the value of natEvent is "1" (Create event), it means to
   allocate a range of transport ports; when the value is "2", it means
   to deallocate a range of transports ports.  For the purpose of this
   TLV, no other value is used.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    TLV-Type   |     Length    |            natEvent
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
               natEvent            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                 Figure 11

   TLV-Type

      8

   Length

      Six octets

   natEvent

      Integer.  This field contains the data (unsigned8) of natEvent
      (230) defined in IPFIX, right justified, and unused bits MUST be
      set to zero.  It indicates the allocation or deallocation of a
      range of IP ports as follows:

         0: Reserved
         1: Allocation
         2: Deallocation

   IP-Port-Alloc TLV MUST be included as part of the IP-Port-Range
   Attribute (refer to <a href="#section-3.1.2">Section 3.1.2</a>), identified as 241.6.8.









<span class="grey">Cheng, et al.                Standards Track                   [Page 23]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-24" id="page-24" href="#page-24" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


<span class="h4"><a class="selflink" name="section-3.2.9" href="#section-3.2.9">3.2.9</a>.  IP-Port-Range-Start TLV</span>

   The format of IP-Port-Range-Start TLV is shown in Figure 12.  This
   attribute carries IPFIX Information Element 361, "portRangeStart",
   which is the smallest port number of a range of contiguous transport
   ports (refer to [<a href="#ref-IPFIX" title="&quot;IP Flow Information Export (IPFIX) Entities&quot;">IPFIX</a>]).

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    TLV-Type   |     Length    |         portRangeStart
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
             portRangeStart        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                 Figure 12

   TLV-Type

      9

   Length

      Six octets

   portRangeStart

      Integer.  This field contains the data (unsigned16) of
      portRangeStart (361) defined in IPFIX, right justified, and unused
      bits MUST be set to zero.

   IP-Port-Range-Start TLV is included as part of the IP-Port-Range
   Attribute (refer to <a href="#section-3.1.2">Section 3.1.2</a>), identified as 241.6.9.


















<span class="grey">Cheng, et al.                Standards Track                   [Page 24]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-25" id="page-25" href="#page-25" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


<span class="h4"><a class="selflink" name="section-3.2.10" href="#section-3.2.10">3.2.10</a>.  IP-Port-Range-End TLV</span>

   The format of IP-Port-Range-End TLV is shown in Figure 13.  This
   attribute carries IPFIX Information Element 362, "portRangeEnd",
   which is the largest port number of a range of contiguous transport
   ports (refer to [<a href="#ref-IPFIX" title="&quot;IP Flow Information Export (IPFIX) Entities&quot;">IPFIX</a>]).

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    TLV-Type   |     Length    |          portRangeEnd
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              portRangeEnd         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                 Figure 13

   TLV-Type

      10

   Length

      Six octets

   portRangeEnd

      Integer.  This field contains the data (unsigned16) of
      portRangeEnd (362) defined in IPFIX, right justified, and unused
      bits MUST be set to zero.

   IP-Port-Range-End TLV is included as part of the IP-Port-Range
   Attribute (refer to <a href="#section-3.1.2">Section 3.1.2</a>), identified as 241.6.10.

<span class="h4"><a class="selflink" name="section-3.2.11" href="#section-3.2.11">3.2.11</a>.  IP-Port-Local-Id TLV</span>

   The format of IP-Port-Local-Id TLV is shown in Figure 14.  This
   attribute carries a string called "localID", which is a local
   significant identifier as explained below.

   The primary issue addressed by this TLV is that there are CGN
   deployments that do not distinguish internal hosts by their internal
   IP address alone but use further identifiers for unique subscriber
   identification.  For example, this is the case if a CGN supports
   overlapping private or shared IP address spaces (as described in
   [<a href="rfc1918.html" title="&quot;Address Allocation for Private Internets&quot;">RFC1918</a>] and [<a href="rfc6598.html" title="&quot;IANA-Reserved IPv4 Prefix for Shared Address Space&quot;">RFC6598</a>]) for internal hosts of different subscribers.
   In such cases, different internal hosts are identified and mapped at
   the CGN by their IP address and/or another identifier, for example,



<span class="grey">Cheng, et al.                Standards Track                   [Page 25]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-26" id="page-26" href="#page-26" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   the identifier of a tunnel between the CGN and the subscriber.  In
   these scenarios (and similar ones), the internal IP address is not
   sufficient to demultiplex connections from internal hosts.  An
   additional identifier needs to be present in the IP-Port-Range
   Attribute and IP-Port-Forwarding-Mapping Attribute in order to
   uniquely identify an internal host.  The IP-Port-Local-Id TLV is used
   to carry this identifier.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    TLV-Type   |     Length    |        localID ....
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                 Figure 14

   TLV-Type

      11

   Length

      Variable number of octets

   localID

      String.  The data type of this field is string (refer to
      [<a href="rfc8044.html" title="&quot;Data Types in RADIUS&quot;">RFC8044</a>]).  This field contains the data that is a local
      significant identifier at the customer premise, such as MAC
      address, interface ID, VLAN ID, PPP sessions ID, VRF ID, IP
      address/prefix, or another local significant identifier.

   IP-Port-Local-Id TLV MAY be included in the following Attributes if
   it is necessary to identify the subscriber:

   o  IP-Port-Range Attribute, identified as 241.6.11 (see
      <a href="#section-3.1.2">Section 3.1.2</a>)

   o  IP-Port-Forwarding-Mapping Attribute, identified as 241.7.11 (see
      <a href="#section-3.1.3">Section 3.1.3</a>)











<span class="grey">Cheng, et al.                Standards Track                   [Page 26]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-27" id="page-27" href="#page-27" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Applications, Use Cases, and Examples</span>

   This section describes some applications and use cases to illustrate
   the use of the attributes proposed in this document.

<span class="h3"><a class="selflink" name="section-4.1" href="#section-4.1">4.1</a>.  Managing CGN Port Behavior Using RADIUS</span>

   In a broadband network, customer information is usually stored on a
   RADIUS server, and the BNG acts as a NAS.  The communication between
   the NAS and the RADIUS server is triggered by a user when it signs in
   to the Internet service where either PPP or DHCP/DHCPv6 is used.
   When a user signs in, the NAS sends a RADIUS Access-Request message
   to the RADIUS server.  The RADIUS server validates the request, and
   if the validation succeeds, it in turn sends back a RADIUS
   Access-Accept message.  The Access-Accept message carries
   configuration information specific to that user back to the NAS,
   where some of the information would be passed on to the requesting
   user via PPP or DHCP/DHCPv6.

   A CGN function in a broadband network is most likely to be co-located
   on a BNG.  In that case, parameters for CGN port mapping behavior for
   users can be configured on the RADIUS server.  When a user signs in
   to the Internet service, the associated parameters can be conveyed to
   the NAS, and proper configuration is accomplished on the CGN device
   for that user.

   Also, a CGN operation status such as CGN port allocation and
   deallocation for a specific user on the BNG can also be transmitted
   back to the RADIUS server for accounting purposes using the RADIUS
   protocol.

   The RADIUS protocol has already been widely deployed in broadband
   networks to manage BNG, thus the functionality described in this
   specification introduces little overhead to the existing network
   operation.

   In the following subsections, we describe how to manage CGN behavior
   using the RADIUS protocol, with required RADIUS extensions proposed
   in <a href="#section-3">Section 3</a>.

<span class="h4"><a class="selflink" name="section-4.1.1" href="#section-4.1.1">4.1.1</a>.  Configure IP Port Limit for a User</span>

   In the face of an IPv4 address shortage, there are currently
   proposals to multiplex multiple users' connections over a number of
   shared IPv4 addresses, such as Carrier Grade NAT [<a href="rfc6888.html" title="&quot;Common Requirements for Carrier-Grade NATs (CGNs)&quot;">RFC6888</a>],
   Dual-Stack Lite [<a href="rfc6333.html" title="&quot;Dual-Stack Lite Broadband Deployments Following IPv4 Exhaustion&quot;">RFC6333</a>], NAT64 [<a href="rfc6146.html" title="&quot;Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers&quot;">RFC6146</a>], etc.  As a result, a
   single IPv4 public address may be shared by hundreds or even
   thousands of users.  As indicated in [<a href="rfc6269.html" title="&quot;Issues with IP Address Sharing&quot;">RFC6269</a>], it is therefore



<span class="grey">Cheng, et al.                Standards Track                   [Page 27]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-28" id="page-28" href="#page-28" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   necessary to impose limits on the total number of ports available to
   an individual user to ensure that the shared resource, i.e., the
   IPv4 address, remains available in some capacity to all the users
   using it.  The support of an IP port limit is also documented in
   [<a href="rfc6888.html" title="&quot;Common Requirements for Carrier-Grade NATs (CGNs)&quot;">RFC6888</a>] as a requirement for CGN.

   The IP port limit imposed on an end user may be on the total number
   of IP source transport ports or a specific IP transport protocol as
   defined in <a href="#section-3.1.1">Section 3.1.1</a>.

   The per-user IP port limit is configured on a RADIUS server, along
   with other user information such as credentials.

   When a user signs in to the Internet service successfully, the IP
   port limit for the subscriber is passed by the RADIUS server to the
   BNG, which is acting as a NAS and is co-located with the CGN using
   the IP-Port-Limit-Info RADIUS attribute (defined in <a href="#section-3.1.1">Section 3.1.1</a>)
   along with other configuration parameters.  While some parameters are
   passed to the user, the IP port limit is recorded on the CGN device
   for imposing the usage of IP transport ports for that user.

   Figure 15 illustrates how the RADIUS protocol is used to configure
   the maximum number of TCP/UDP ports for a given user on a CGN device.

   User                     CGN/NAS                        AAA
    |                         BNG                         Server
    |                          |                             |
    |                          |                             |
    |----Service Request------&gt;|                             |
    |                          |                             |
    |                          |-----Access-Request --------&gt;|
    |                          |                             |
    |                          |&lt;----Access-Accept-----------|
    |                          |     (IP-Port-Limit-Info)    |
    |                          |     (for TCP/UDP ports)     |
    |&lt;---Service Granted ------|                             |
    |    (other parameters)    |                             |
    |                          |                             |
    |                  (CGN external port                    |
    |                   allocation and                       |
    |                   IPv4 address assignment)             |
    |                          |                             |

       Figure 15: RADIUS Message Flow for Configuring CGN Port Limit







<span class="grey">Cheng, et al.                Standards Track                   [Page 28]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-29" id="page-29" href="#page-29" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   The IP port limit created on a CGN device for a specific user using a
   RADIUS extension may be changed using a RADIUS CoA message [<a href="rfc5176.html" title="&quot;Dynamic Authorization Extensions to Remote Authentication Dial In User Service (RADIUS)&quot;">RFC5176</a>]
   that carries the same RADIUS attribute.  The CoA message may be sent
   from the RADIUS server directly to the NAS, and once a RADIUS CoA ACK
   message is accepted and sent back, the new IP port limit replaces the
   previous one.

   Figure 16 illustrates how the RADIUS protocol is used to increase the
   TCP/UDP port limit from 1024 to 2048 on a CGN device for a specific
   user.


   User                     CGN/NAS                           AAA
    |                         BNG                            Server
    |                          |                               |
    |              TCP/UDP Port Limit (1024)                   |
    |                          |                               |
    |                          |&lt;---------CoA Request----------|
    |                          |       (IP-Port-Limit-Info)    |
    |                          |       (for TCP/UDP ports)     |
    |                          |                               |
    |              TCP/UDP Port Limit (2048)                   |
    |                          |                               |
    |                          |---------CoA Response---------&gt;|
    |                          |                               |

    Figure 16: RADIUS Message Flow for Changing a User's CGN Port Limit

<span class="h4"><a class="selflink" name="section-4.1.2" href="#section-4.1.2">4.1.2</a>.  Report IP Port Allocation/Deallocation</span>

   Upon obtaining the IP port limit for a user, the CGN device needs to
   allocate an IP transport port for the user when receiving a new IP
   flow sent from that user.

   As one practice, a CGN may allocate a block of IP ports for a
   specific user, instead of one port at a time, and within each port
   block the ports may be randomly distributed or in consecutive
   fashion.  When a CGN device allocates a block of transport ports, the
   information can be easily conveyed to the RADIUS server by a new
   RADIUS attribute called the IP-Port-Range (defined in <a href="#section-3.1.2">Section 3.1.2</a>).
   The CGN device may allocate one or more IP port ranges, where each
   range contains a set of numbers representing IP transport ports and
   the total number of ports MUST be less or equal to the associated IP
   port limit imposed for that user.  A CGN device may choose to
   allocate a small port range and allocate more at a later time as
   needed; such practice is good because of its randomization in nature.





<span class="grey">Cheng, et al.                Standards Track                   [Page 29]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-30" id="page-30" href="#page-30" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   At the same time, the CGN device also needs to decide on the shared
   IPv4 address for that user.  The shared IPv4 address and the
   pre-allocated IP port range are both passed to the RADIUS server.

   When a user initiates an IP flow, the CGN device randomly selects a
   transport port number from the associated and pre-allocated IP port
   range for that user to replace the original source port number along
   with the replacement of the source IP address by the shared IPv4
   address.

   A CGN device may decide to "free" a previously assigned set of IP
   ports that have been allocated for a specific user but are not
   currently in use, and with that, the CGN device must send the
   information of the deallocated IP port range along with the shared
   IPv4 address to the RADIUS server.

   Figure 17 illustrates how the RADIUS protocol is used to report a set
   of ports allocated and deallocated, respectively, by a NAT64 device
   for a specific user to the RADIUS server.  2001:db8:100:200::/56 is
   the IPv6 prefix allocated to this user.  In order to limit the usage
   of the NAT64 resources on a per-user basis for fairness of resource
   usage (see REQ-4 of [<a href="rfc6888.html" title="&quot;Common Requirements for Carrier-Grade NATs (CGNs)&quot;">RFC6888</a>]), port range allocations are bound to
   the /56 prefix, not to the source IPv6 address of the request.  The
   NAT64 device is configured with the per-user port limit policy by
   some means (e.g., subscriber-mask [<a href="rfc7785.html" title="&quot;Recommendations for Prefix Binding in the Context of Softwire Dual-Stack Lite&quot;">RFC7785</a>]).


























<span class="grey">Cheng, et al.                Standards Track                   [Page 30]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-31" id="page-31" href="#page-31" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   Host                      NAT64/NAS                     AAA
    |                         BNG                         Server
    |                          |                             |
    |                          |                             |
    |----Service Request------&gt;|                             |
    |                          |                             |
    |                          |-----Access-Request --------&gt;|
    |                          |                             |
    |                          |&lt;----Access-Accept-----------|
    |&lt;---Service Granted ------|                             |
    |    (other parameters)    |                             |
   ...                        ...                           ...
    |                          |                             |
    |                          |                             |
    |                (NAT64 decides to allocate              |
    |                 a TCP/UDP port range for the user)     |
    |                          |                             |
    |                          |-----Accounting-Request-----&gt;|
    |                          |    (IP-Port-Range           |
    |                          |     for allocation)         |
   ...                        ...                           ...
    |                          |                             |
    |                (NAT64 decides to deallocate            |
    |                 a TCP/UDP port range for the user)     |
    |                          |                             |
    |                          |-----Accounting-Request-----&gt;|
    |                          |    (IP-Port-Range           |
    |                          |     for deallocation)       |
    |                          |                             |

            Figure 17: RADIUS Message Flow for Reporting NAT64
                   Allocation/Deallocation of a Port Set

<span class="h4"><a class="selflink" name="section-4.1.3" href="#section-4.1.3">4.1.3</a>.  Configure Port Forwarding Mapping</span>

   In most scenarios, the port mapping on a NAT device is dynamically
   created when the IP packets of an IP connection initiated by a user
   arrives.  For some applications, the port mapping needs to be
   pre-defined and allow IP packets of applications from outside a CGN
   device to pass through and be "port forwarded" to the correct user
   located behind the CGN device.

   The Port Control Protocol (PCP) [<a href="rfc6887.html" title="&quot;Port Control Protocol (PCP)&quot;">RFC6887</a>], provides a mechanism to
   create a mapping from an external IP address and port to an internal
   IP address and port on a CGN device just to achieve the "port
   forwarding" purpose.  PCP is a server-client protocol capable of
   creating or deleting a mapping along with a rich set of features on a
   CGN device in dynamic fashion.  In some deployments, all users need



<span class="grey">Cheng, et al.                Standards Track                   [Page 31]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-32" id="page-32" href="#page-32" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   is a few (typically just one) pre-configured port mappings for
   applications at home, such as a web cam; the lifetime of such a port
   mapping remains valid throughout the duration of the customer's
   Internet service connection time.  In such an environment, it is
   possible to statically configure a port mapping on the RADIUS server
   for a user and let the RADIUS protocol propagate the information to
   the associated CGN device.

   Note that this document targets deployments where a AAA server is
   responsible for instructing NAT mappings for a given subscriber and
   does not make any assumption about the host's capabilities with
   regards to port forwarding control.  This deployment is complementary
   to PCP given that PCP targets a different deployment model where an
   application (on the host) controls its mappings in an upstream CPE,
   CGN, firewall, etc.

   Figure 18 illustrates how the RADIUS protocol is used to configure a
   port forwarding mapping on a NAT44 device.

   Host                     CGN/NAS                           AAA
    |                         BNG                            Server
    |                          |                               |
    |----Service Request------&gt;|                               |
    |                          |                               |
    |                          |---------Access-Request-------&gt;|
    |                          |                               |
    |                          |&lt;--------Access-Accept---------|
    |                          |   (IP-Port-Forwarding-Map)    |
    |&lt;---Service Granted ------|                               |
    |    (other parameters)    |                               |
    |                          |                               |
    |                 (Create a port mapping                   |
    |                  for the user, and                       |
    |                  associate it with the                   |
    |                  internal IP address                     |
    |                  and external IP address)                |
    |                          |                               |
    |                          |                               |
    |                          |------Accounting-Request------&gt;|
    |                          |    (IP-Port-Forwarding-Map)   |

              Figure 18: RADIUS Message Flow for Configuring
                         a Port Forwarding Mapping








<span class="grey">Cheng, et al.                Standards Track                   [Page 32]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-33" id="page-33" href="#page-33" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   A port forwarding mapping that is created on a CGN device using the
   RADIUS extension as described above may also be changed using a
   RADIUS CoA message [<a href="rfc5176.html" title="&quot;Dynamic Authorization Extensions to Remote Authentication Dial In User Service (RADIUS)&quot;">RFC5176</a>] that carries the same RADIUS
   association.  The CoA message may be sent from the RADIUS server
   directly to the NAS, and once the RADIUS CoA ACK message is accepted
   and sent back, the new port forwarding mapping then replaces the
   previous one.

   Figure 19 illustrates how the RADIUS protocol is used to change an
   existing port mapping from (a:X) to (a:Y), where "a" is an internal
   port, and "X" and "Y" are external ports, respectively, for a
   specific user with a specific IP address

   Host                     CGN/NAS                           AAA
    |                         BNG                            Server
    |                          |                               |
    |                    Internal IP Address                   |
    |                    Port Map (a:X)                        |
    |                          |                               |
    |                          |&lt;---------CoA Request----------|
    |                          |    (IP-Port-Forwarding-Map)   |
    |                          |                               |
    |                    Internal IP Address                   |
    |                    Port Map (a:Y)                        |
    |                          |                               |
    |                          |---------CoA Response---------&gt;|
    |                          |    (IP-Port-Forwarding-Map)   |

                Figure 19: RADIUS Message Flow for Changing
                     a User's Port Forwarding Mapping

<span class="h4"><a class="selflink" name="section-4.1.4" href="#section-4.1.4">4.1.4</a>.  An Example</span>

   An Internet Service Provider (ISP) assigns TCP/UDP 500 ports for the
   user Joe.  This number is the limit that can be used for TCP/UDP
   ports on a CGN device for Joe and it is configured on a RADIUS
   server.  Also, Joe asks for a pre-defined port forwarding mapping on
   the CGN device for his web cam applications (external port 5000 maps
   to internal port 1234).

   When Joe successfully connects to the Internet service, the RADIUS
   server conveys the TCP/UDP port limit (500) and the port forwarding
   mapping (external port 5000 to internal port 1234) to the CGN device
   using the IP-Port-Limit-Info Attribute and IP-Port-Forwarding-Map
   Attribute, respectively, carried by an Access-Accept message to the
   BNG where NAS and CGN are co-located.





<span class="grey">Cheng, et al.                Standards Track                   [Page 33]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-34" id="page-34" href="#page-34" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   Upon receiving the first outbound IP packet sent from Joe's laptop,
   the CGN device decides to allocate a small port pool that contains 40
   consecutive ports, from 3500 to 3540, inclusively, and also assigns a
   shared IPv4 address 192.0.2.15 for Joe.  The CGN device also randomly
   selects one port from the allocated range (say, 3519) and uses that
   port to replace the original source port in outbound IP packets.

   For accounting purposes, the CGN device passes this port range
   (3500-3540) and the shared IPv4 address 192.0.2.15 together to the
   RADIUS server using IP-Port-Range Attribute carried by an
   Accounting-Request message.

   When Joe works on more applications with more outbound IP mappings
   and the port pool (3500-3540) is close to exhaust, the CGN device
   allocates a second port pool (8500-8800) in a similar fashion and
   also passes the new port range (8500-8800) and IPv4 address
   192.0.2.15 together to the RADIUS server using IP-Port-Range
   Attribute carried by an Accounting-Request message.  Note when the
   CGN allocates more ports, it needs to assure that the total number of
   ports allocated for Joe is within the limit.

   Joe decides to upgrade his service agreement with more TCP/UDP ports
   allowed (up to 1000 ports).  The ISP updates the information in Joe's
   profile on the RADIUS server, which then sends a CoA-Request message
   that carries the IP-Port-Limit-Info Attribute with 1000 ports to the
   CGN device; the CGN device in turn sends back a CoA-ACK message.
   With that, Joe enjoys more available TCP/UDP ports for his
   applications.

   When Joe is not using his service, most of the IP mappings are closed
   with their associated TCP/UDP ports released on the CGN device, which
   then sends the relevant information back to the RADIUS server using
   the IP-Port-Range Attribute carried by the Accounting-Request
   message.

   Throughout Joe's connection with his ISP, applications can
   communicate with his web cam at home from the external realm, thus
   directly traversing the pre-configured mapping on the CGN device.

   When Joe disconnects from his Internet service, the CGN device will
   deallocate all TCP/UDP ports as well as the port forwarding mapping
   and send the relevant information to the RADIUS server.









<span class="grey">Cheng, et al.                Standards Track                   [Page 34]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-35" id="page-35" href="#page-35" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


<span class="h3"><a class="selflink" name="section-4.2" href="#section-4.2">4.2</a>.  Report Assigned Port Set for a Visiting UE</span>

   Figure 20 illustrates an example of the flow exchange that occurs
   when the visiting User Equipment (UE) connects to a CPE offering WLAN
   service.

   For identification purposes (see [<a href="rfc6967.html" title="&quot;Analysis of Potential Solutions for Revealing a Host Identifier (HOST_ID) in Shared Address Deployments&quot;">RFC6967</a>]), once the CPE assigns a
   port set, it issues a RADIUS message to report the assigned port set.

   UE         CPE             CGN                          AAA
    |                         BNG                         Server
    |                          |                             |
    |                          |                             |
    |----Service Request------&gt;|                             |
    |                          |                             |
    |                          |-----Access-Request --------&gt;|
    |                          |                             |
    |                          |&lt;----Access-Accept-----------|
    |&lt;---Service Granted ------|                             |
    |    (other parameters)    |                             |
   ...          |             ...                           ...
    |&lt;---IP@----|              |                             |
    |           |              |                             |
    |   (CPE assigns a TCP/UDP port                          |
    |   range for this visiting UE)                          |
    |           |                                            |
    |           |--Accounting-Request-...-------------------&gt;|
    |           |    (IP-Port-Range                          |
    |           |     for allocation)                        |
   ...          |             ...                           ...
    |           |              |                             |
    |           |              |                             |
    |   (CPE withdraws a TCP/UDP port                        |
    |   range for a visiting UE)                             |
    |           |                                            |
    |           |--Accounting-Request-...-------------------&gt;|
    |           |    (IP-Port-Range                          |
    |           |     for deallocation)                      |
    |           |                                            |

             Figure 20: RADIUS Message Flow for Reporting CPE
          Allocation/Deallocation of a Port Set to a Visiting UE









<span class="grey">Cheng, et al.                Standards Track                   [Page 35]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-36" id="page-36" href="#page-36" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  Table of Attributes</span>

   This document proposes three new RADIUS attributes, and their formats
   are as follows:

   o  IP-Port-Limit-Info: 241.5

   o  IP-Port-Range: 241.6

   o  IP-Port-Forwarding-Map: 241.7

   The following table provides a guide as to what type of RADIUS
   packets may contain these attributes and in what quantity.

   Request Accept Reject Challenge Acct.    #     Attribute
                                   Request
   0+      0+     0      0         0+       241.5 IP-Port-Limit-Info
   0       0      0      0         0+       241.6 IP-Port-Range
   0+      0+     0      0         0+       241.7 IP-Port-Forwarding-Map

   The following table defines the meaning of the above table entries.

   0  This attribute MUST NOT be present in packet.
   0+ Zero or more instances of this attribute MAY be present in packet.

<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Security Considerations</span>

   This document does not introduce any security issue other than the
   ones already identified in RADIUS documents [<a href="rfc2865.html" title="&quot;Remote Authentication Dial In User Service (RADIUS)&quot;">RFC2865</a>] and [<a href="rfc5176.html" title="&quot;Dynamic Authorization Extensions to Remote Authentication Dial In User Service (RADIUS)&quot;">RFC5176</a>]
   for CoA messages.  Known RADIUS vulnerabilities apply to this
   specification.  For example, if RADIUS packets are sent in the clear,
   an attacker in the communication path between the RADIUS client and
   server may glean information that it will use to prevent a legitimate
   user from accessing the service by appropriately setting the maximum
   number of IP ports conveyed in an IP-Port-Limit-Info Attribute;
   exhaust the port quota of a user by installing many mapping entries
   (IP-Port-Forwarding-Map Attribute); prevent incoming traffic from
   being delivered to its legitimate destination by manipulating the
   mapping entries installed by means of an IP-Port-Forwarding-Map
   Attribute; discover the IP address and port range that are assigned
   to a given user and reported in an IP-Port-Range Attribute; and so
   on.  The root cause of these attack vectors is the communication
   between the RADIUS client and server.








<span class="grey">Cheng, et al.                Standards Track                   [Page 36]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-37" id="page-37" href="#page-37" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   The IP-Port-Local-Id TLV includes an identifier of which the type and
   length is deployment and implementation dependent.  This identifier
   might carry privacy-sensitive information.  It is therefore
   RECOMMENDED to utilize identifiers that do not have such privacy
   concerns.

   If there is any error in a RADIUS Accounting-Request packet sent
   from a RADIUS client to the server, the RADIUS server MUST NOT send
   a response to the client (refer to [<a href="rfc2866.html" title="&quot;RADIUS Accounting&quot;">RFC2866</a>]).  Examples of the
   errors include the erroneous port range in the
   IP-Port-Range Attribute, inconsistent port mapping in the
   IP-Port-Forwarding-Map Attribute, etc.

   This document targets deployments where a trusted relationship is in
   place between the RADIUS client and server with communication
   optionally secured by IPsec or Transport Layer Security (TLS)
   [<a href="rfc6614.html" title="&quot;Transport Layer Security (TLS) Encryption for RADIUS&quot;">RFC6614</a>].

<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  IANA Considerations</span>

   Per this document, IANA has made new code point assignments for both
   IPFIX Information Elements and RADIUS attributes as explained in the
   following subsections.

<span class="h3"><a class="selflink" name="section-7.1" href="#section-7.1">7.1</a>.  New IPFIX Information Elements</span>

   The following IPFIX Information Element has been registered (refer to
   <a href="#section-3.2.2">Section 3.2.2</a>):

   o  sourceTransportPortsLimit:

      *  Name: sourceTransportPortsLimit

      *  Element ID: 458

      *  Description: This Information Element contains the maximum
         number of IP source transport ports that can be used by an end
         user when sending IP packets; each user is associated with one
         or more (source) IPv4 or IPv6 addresses.  This Information
         Element is particularly useful in address-sharing deployments
         that adhere to REQ-4 of [<a href="rfc6888.html" title="&quot;Common Requirements for Carrier-Grade NATs (CGNs)&quot;">RFC6888</a>].  Limiting the number of
         ports assigned to each user ensures fairness among users and
         mitigates the denial-of-service attack that a user could launch
         against other users through the address-sharing device in order
         to grab more ports.

      *  Data type: unsigned16




<span class="grey">Cheng, et al.                Standards Track                   [Page 37]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-38" id="page-38" href="#page-38" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


      *  Data type semantics: totalCounter

      *  Data type unit: ports

      *  Data value range: from 1 to 65535

<span class="h3"><a class="selflink" name="section-7.2" href="#section-7.2">7.2</a>.  New RADIUS Attributes</span>

   The Attribute Types defined in this document have been registered by
   IANA from the RADIUS namespace as described in the "IANA
   Considerations" section of [<a href="rfc3575.html" title="&quot;IANA Considerations for RADIUS (Remote Authentication Dial In User Service)&quot;">RFC3575</a>], in accordance with <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>
   [<a href="rfc5226.html" title="&quot;Guidelines for Writing an IANA Considerations Section in RFCs&quot;">RFC5226</a>].  For RADIUS packets, attributes, and registries created by
   this document, IANA has placed them at
   &lt;<a href="http://www.iana.org/assignments/radius-types">http://www.iana.org/assignments/radius-types</a>&gt;.

   In particular, this document defines three new RADIUS attributes, as
   follows, from the Short Extended Space of [<a href="rfc6929.html" title="&quot;Remote Authentication Dial In User Service (RADIUS) Protocol Extensions&quot;">RFC6929</a>]:

   Type      Description             Data Type   Reference
   ----      -----------             ---------   ---------
   241.5     IP-Port-Limit-Info      tlv         <a href="#section-3.1.1">Section 3.1.1</a>
   241.6     IP-Port-Range           tlv         <a href="#section-3.1.2">Section 3.1.2</a>
   241.7     IP-Port-Forwarding-Map  tlv         <a href="#section-3.1.3">Section 3.1.3</a>

<span class="h3"><a class="selflink" name="section-7.3" href="#section-7.3">7.3</a>.  New RADIUS TLVs</span>

   IANA has created a new registry called "RADIUS IP Port Configuration
   and Reporting TLVs".  All TLVs in this registry have one or more
   parent RADIUS attributes in nesting (refer to [<a href="rfc6929.html" title="&quot;Remote Authentication Dial In User Service (RADIUS) Protocol Extensions&quot;">RFC6929</a>]).  This
   registry contains the following TLVs:

      Value  Description           Data Type    Reference
      -----  -----------           ---------    ---------
      0      Reserved
      1      IP-Port-Type          integer      <a href="#section-3.2.1">Section 3.2.1</a>
      2      IP-Port-Limit         integer      <a href="#section-3.2.2">Section 3.2.2</a>
      3      IP-Port-Ext-IPv4-Addr ipv4addr     <a href="#section-3.2.3">Section 3.2.3</a>
      4      IP-Port-Int-IPv4-Addr ipv4addr     <a href="#section-3.2.4">Section 3.2.4</a>
      5      IP-Port-Int-IPv6-Addr ipv4addr     <a href="#section-3.2.5">Section 3.2.5</a>
      6      IP-Port-Int-Port      integer      <a href="#section-3.2.6">Section 3.2.6</a>
      7      IP-Port-Ext-Port      integer      <a href="#section-3.2.7">Section 3.2.7</a>
      8      IP-Port-Alloc         integer      <a href="#section-3.2.8">Section 3.2.8</a>
      9      IP-Port-Range-Start   integer      <a href="#section-3.2.9">Section 3.2.9</a>
      10     IP-Port-Range-End     integer      <a href="#section-3.2.10">Section 3.2.10</a>
      11     IP-Port-Local-Id      string       <a href="#section-3.2.11">Section 3.2.11</a>
      12-255 Unassigned





<span class="grey">Cheng, et al.                Standards Track                   [Page 38]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-39" id="page-39" href="#page-39" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   The registration procedure for this registry is Standards Action as
   defined in [<a href="rfc5226.html" title="&quot;Guidelines for Writing an IANA Considerations Section in RFCs&quot;">RFC5226</a>].

<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  References</span>

<span class="h3"><a class="selflink" name="section-8.1" href="#section-8.1">8.1</a>.  Normative References</span>

   [<a name="ref-IPFIX" id="ref-IPFIX">IPFIX</a>]    IANA, "IP Flow Information Export (IPFIX) Entities",
              &lt;<a href="http://www.iana.org/assignments/ipfix/">http://www.iana.org/assignments/ipfix/</a>&gt;.

   [<a name="ref-ProtocolNumbers" id="ref-ProtocolNumbers">ProtocolNumbers</a>]
              IANA, "Protocol Numbers",
              &lt;<a href="http://www.iana.org/assignments/protocol-numbers/">http://www.iana.org/assignments/protocol-numbers/</a>&gt;.

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a name="ref-RFC2865" id="ref-RFC2865">RFC2865</a>]  Rigney, C., Willens, S., Rubens, A., and W. Simpson,
              "Remote Authentication Dial In User Service (RADIUS)",
              <a href="rfc2865.html">RFC 2865</a>, DOI 10.17487/RFC2865, June 2000,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2865">http://www.rfc-editor.org/info/rfc2865</a>&gt;.

   [<a name="ref-RFC3575" id="ref-RFC3575">RFC3575</a>]  Aboba, B., "IANA Considerations for RADIUS (Remote
              Authentication Dial In User Service)", <a href="rfc3575.html">RFC 3575</a>,
              DOI 10.17487/RFC3575, July 2003,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3575">http://www.rfc-editor.org/info/rfc3575</a>&gt;.

   [<a name="ref-RFC5226" id="ref-RFC5226">RFC5226</a>]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc5226.html">RFC 5226</a>,
              DOI 10.17487/RFC5226, May 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5226">http://www.rfc-editor.org/info/rfc5226</a>&gt;.

   [<a name="ref-RFC6929" id="ref-RFC6929">RFC6929</a>]  DeKok, A. and A. Lior, "Remote Authentication Dial In User
              Service (RADIUS) Protocol Extensions", <a href="rfc6929.html">RFC 6929</a>,
              DOI 10.17487/RFC6929, April 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6929">http://www.rfc-editor.org/info/rfc6929</a>&gt;.

   [<a name="ref-RFC7012" id="ref-RFC7012">RFC7012</a>]  Claise, B., Ed., and B. Trammell, Ed., "Information Model
              for IP Flow Information Export (IPFIX)", <a href="rfc7012.html">RFC 7012</a>,
              DOI 10.17487/RFC7012, September 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7012">http://www.rfc-editor.org/info/rfc7012</a>&gt;.

   [<a name="ref-RFC8044" id="ref-RFC8044">RFC8044</a>]  DeKok, A., "Data Types in RADIUS", <a href="rfc8044.html">RFC 8044</a>,
              DOI 10.17487/RFC8044, January 2017,
              &lt;<a href="http://www.rfc-editor.org/info/rfc8044">http://www.rfc-editor.org/info/rfc8044</a>&gt;.




<span class="grey">Cheng, et al.                Standards Track                   [Page 39]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-40" id="page-40" href="#page-40" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


<span class="h3"><a class="selflink" name="section-8.2" href="#section-8.2">8.2</a>.  Informative References</span>

   [<a name="ref-RFC768" id="ref-RFC768">RFC768</a>]  Postel, J., "User Datagram Protocol", STD 6, <a href="rfc768.html">RFC 768</a>,
              DOI 10.17487/RFC0768, August 1980,
              &lt;<a href="http://www.rfc-editor.org/info/rfc768">http://www.rfc-editor.org/info/rfc768</a>&gt;.

   [<a name="ref-RFC793" id="ref-RFC793">RFC793</a>]  Postel, J., "Transmission Control Protocol", STD 7,
              <a href="rfc793.html">RFC 793</a>, DOI 10.17487/RFC0793, September 1981,
              &lt;<a href="http://www.rfc-editor.org/info/rfc793">http://www.rfc-editor.org/info/rfc793</a>&gt;.

   [<a name="ref-RFC1918" id="ref-RFC1918">RFC1918</a>]  Rekhter, Y., Moskowitz, B., Karrenberg, D., de Groot, G.,
              and E. Lear, "Address Allocation for Private Internets",
              <a href="https://tools.ietf.org/html/bcp5">BCP 5</a>, <a href="rfc1918.html">RFC 1918</a>, DOI 10.17487/RFC1918, February 1996,
              &lt;<a href="http://www.rfc-editor.org/info/rfc1918">http://www.rfc-editor.org/info/rfc1918</a>&gt;.

   [<a name="ref-RFC2866" id="ref-RFC2866">RFC2866</a>]  Rigney, C., "RADIUS Accounting", <a href="rfc2866.html">RFC 2866</a>,
              DOI 10.17487/RFC2866, June 2000,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2866">http://www.rfc-editor.org/info/rfc2866</a>&gt;.

   [<a name="ref-RFC3022" id="ref-RFC3022">RFC3022</a>]  Srisuresh, P. and K. Egevang, "Traditional IP Network
              Address Translator (Traditional NAT)", <a href="rfc3022.html">RFC 3022</a>,
              DOI 10.17487/RFC3022, January 2001,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3022">http://www.rfc-editor.org/info/rfc3022</a>&gt;.

   [<a name="ref-RFC4340" id="ref-RFC4340">RFC4340</a>]  Kohler, E., Handley, M., and S. Floyd, "Datagram
              Congestion Control Protocol (DCCP)", <a href="rfc4340.html">RFC 4340</a>,
              DOI 10.17487/RFC4340, March 2006,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4340">http://www.rfc-editor.org/info/rfc4340</a>&gt;.

   [<a name="ref-RFC4960" id="ref-RFC4960">RFC4960</a>]  Stewart, R., Ed., "Stream Control Transmission Protocol",
              <a href="rfc4960.html">RFC 4960</a>, DOI 10.17487/RFC4960, September 2007,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4960">http://www.rfc-editor.org/info/rfc4960</a>&gt;.

   [<a name="ref-RFC5176" id="ref-RFC5176">RFC5176</a>]  Chiba, M., Dommety, G., Eklund, M., Mitton, D., and B.
              Aboba, "Dynamic Authorization Extensions to Remote
              Authentication Dial In User Service (RADIUS)", <a href="rfc5176.html">RFC 5176</a>,
              DOI 10.17487/RFC5176, January 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5176">http://www.rfc-editor.org/info/rfc5176</a>&gt;.

   [<a name="ref-RFC6146" id="ref-RFC6146">RFC6146</a>]  Bagnulo, M., Matthews, P., and I. van Beijnum, "Stateful
              NAT64: Network Address and Protocol Translation from IPv6
              Clients to IPv4 Servers", <a href="rfc6146.html">RFC 6146</a>, DOI 10.17487/RFC6146,
              April 2011, &lt;<a href="http://www.rfc-editor.org/info/rfc6146">http://www.rfc-editor.org/info/rfc6146</a>&gt;.

   [<a name="ref-RFC6158" id="ref-RFC6158">RFC6158</a>]  DeKok, A., Ed., and G. Weber, "RADIUS Design Guidelines",
              <a href="https://tools.ietf.org/html/bcp158">BCP 158</a>, <a href="rfc6158.html">RFC 6158</a>, DOI 10.17487/RFC6158, March 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6158">http://www.rfc-editor.org/info/rfc6158</a>&gt;.




<span class="grey">Cheng, et al.                Standards Track                   [Page 40]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-41" id="page-41" href="#page-41" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   [<a name="ref-RFC6269" id="ref-RFC6269">RFC6269</a>]  Ford, M., Ed., Boucadair, M., Durand, A., Levis, P., and
              P. Roberts, "Issues with IP Address Sharing", <a href="rfc6269.html">RFC 6269</a>,
              DOI 10.17487/RFC6269, June 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6269">http://www.rfc-editor.org/info/rfc6269</a>&gt;.

   [<a name="ref-RFC6333" id="ref-RFC6333">RFC6333</a>]  Durand, A., Droms, R., Woodyatt, J., and Y. Lee,
              "Dual-Stack Lite Broadband Deployments Following IPv4
              Exhaustion", <a href="rfc6333.html">RFC 6333</a>, DOI 10.17487/RFC6333, August 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6333">http://www.rfc-editor.org/info/rfc6333</a>&gt;.

   [<a name="ref-RFC6598" id="ref-RFC6598">RFC6598</a>]  Weil, J., Kuarsingh, V., Donley, C., Liljenstolpe, C., and
              M. Azinger, "IANA-Reserved IPv4 Prefix for Shared Address
              Space", <a href="https://tools.ietf.org/html/bcp153">BCP 153</a>, <a href="rfc6598.html">RFC 6598</a>, DOI 10.17487/RFC6598,
              April 2012, &lt;<a href="http://www.rfc-editor.org/info/rfc6598">http://www.rfc-editor.org/info/rfc6598</a>&gt;.

   [<a name="ref-RFC6614" id="ref-RFC6614">RFC6614</a>]  Winter, S., McCauley, M., Venaas, S., and K. Wierenga,
              "Transport Layer Security (TLS) Encryption for RADIUS",
              <a href="rfc6614.html">RFC 6614</a>, DOI 10.17487/RFC6614, May 2012,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6614">http://www.rfc-editor.org/info/rfc6614</a>&gt;.

   [<a name="ref-RFC6887" id="ref-RFC6887">RFC6887</a>]  Wing, D., Ed., Cheshire, S., Boucadair, M., Penno, R., and
              P. Selkirk, "Port Control Protocol (PCP)", <a href="rfc6887.html">RFC 6887</a>,
              DOI 10.17487/RFC6887, April 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6887">http://www.rfc-editor.org/info/rfc6887</a>&gt;.

   [<a name="ref-RFC6888" id="ref-RFC6888">RFC6888</a>]  Perreault, S., Ed., Yamagata, I., Miyakawa, S., Nakagawa,
              A., and H. Ashida, "Common Requirements for Carrier-Grade
              NATs (CGNs)", <a href="https://tools.ietf.org/html/bcp127">BCP 127</a>, <a href="rfc6888.html">RFC 6888</a>, DOI 10.17487/RFC6888,
              April 2013, &lt;<a href="http://www.rfc-editor.org/info/rfc6888">http://www.rfc-editor.org/info/rfc6888</a>&gt;.

   [<a name="ref-RFC6967" id="ref-RFC6967">RFC6967</a>]  Boucadair, M., Touch, J., Levis, P., and R. Penno,
              "Analysis of Potential Solutions for Revealing a Host
              Identifier (HOST_ID) in Shared Address Deployments",
              <a href="rfc6967.html">RFC 6967</a>, DOI 10.17487/RFC6967, June 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6967">http://www.rfc-editor.org/info/rfc6967</a>&gt;.

   [<a name="ref-RFC7785" id="ref-RFC7785">RFC7785</a>]  Vinapamula, S. and M. Boucadair, "Recommendations for
              Prefix Binding in the Context of Softwire Dual-Stack
              Lite", <a href="rfc7785.html">RFC 7785</a>, DOI 10.17487/RFC7785, February 2016,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7785">http://www.rfc-editor.org/info/rfc7785</a>&gt;.











<span class="grey">Cheng, et al.                Standards Track                   [Page 41]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-42" id="page-42" href="#page-42" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


   [<a name="ref-TR-146" id="ref-TR-146">TR-146</a>]   Broadband Forum, "TR-146: Subscriber Sessions", Broadband
              Forum Technical Report 146, Issue 1, May 2013,
              &lt;<a href="http://www.broadband-forum.org/technical/download/TR-146.pdf">http://www.broadband-forum.org/technical/</a>
              <a href="http://www.broadband-forum.org/technical/download/TR-146.pdf">download/TR-146.pdf</a>&gt;.

   [<a name="ref-WIFI-SERVICES" id="ref-WIFI-SERVICES">WIFI-SERVICES</a>]
              Gundavelli, S., Grayson, M., Seite, P., and Y. Lee,
              "Service Provider Wi-Fi Services Over Residential
              Architectures", Work in Progress,
              <a href="https://tools.ietf.org/html/draft-gundavelli-v6ops-community-wifi-svcs-06">draft-gundavelli-v6ops-community-wifi-svcs-06</a>, April 2013.









































<span class="grey">Cheng, et al.                Standards Track                   [Page 42]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-43" id="page-43" href="#page-43" class="invisible"> </a>
<span class="grey"><a href="rfc8045.html">RFC 8045</a>              RADIUS Extensions for IP Port         January 2017</span>


Acknowledgments

   Many thanks to Dan Wing, Roberta Maglione, Daniel Derksen, David
   Thaler, Alan DeKok, Lionel Morand, and Peter Deacon for their useful
   comments and suggestions.

   Special thanks to Lionel Morand for the Shepherd review and to
   Kathleen Moriarty for the AD review.

   Thanks to Carl Wallace, Tim Chown, and Ben Campbell for the detailed
   review.

Authors' Addresses

   Dean Cheng
   Huawei
   2330 Central Expressway
   Santa Clara, California  95050
   United States of America

   Email: dean.cheng@huawei.com


   Jouni Korhonen
   Broadcom Corporation
   3151 Zanker Road
   San Jose, California  95134
   United States of America

   Email: jouni.nospam@gmail.com


   Mohamed Boucadair
   Orange
   Rennes
   France

   Email: mohamed.boucadair@orange.com


   Senthil Sivakumar
   Cisco Systems
   7100-8 Kit Creek Road
   Research Triangle Park, North Carolina
   United States of America

   Email: ssenthil@cisco.com




Cheng, et al.                Standards Track                   [Page 43]

</pre><br />
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.129c, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>
</body>

<!-- Mirrored from tools.ietf.org/html/rfc8045 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:19:32 GMT -->
</html>
