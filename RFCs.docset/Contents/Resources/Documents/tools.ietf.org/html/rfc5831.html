<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc5831 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:33 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:5831" name="DC.Identifier"/>
<meta content="This document is intended to be a source of information about the
Russian Federal standard hash function (GOST R 34.11-94), which is one
of the Russian cryptographic standard algorithms (called GOST
algorithms). Recently, Russian cryptography is being used in Internet
applications, and this document has been created as information for
developers and users of GOST R 34.11-94 for hash computation. This
document is not an Internet Standards Track specification; it is
published for informational purposes." name="DC.Description.Abstract"/>
<meta content="Vasily Dolmatov &lt;dol@cryptocom.ru&gt;" name="DC.Creator"/>
<meta content="March, 2010" name="DC.Date.Issued"/>
<meta content="GOST R 34.11-94: Hash Function Algorithm" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5831 - GOST R 34.11-94: Hash Function Algorithm</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc5831.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc5831" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-dolmatov-cryptocom-gost341194" title="draft-dolmatov-cryptocom-gost341194">draft-dolmatov-...</a>] [<a href="https://datatracker.ietf.org/doc/rfc5831" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5831" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc5831" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=5831">Errata</a>]</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">Updated by: <a href="rfc6986.html">6986</a>                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Independent Submission                                  V. Dolmatov, Ed.
Request for Comments: 5831                               Cryptocom, Ltd.
Category: Informational                                       March 2010
ISSN: 2070-1721


                <span class="h1">GOST R 34.11-94: Hash Function Algorithm</span>

Abstract

   This document is intended to be a source of information about the
   Russian Federal standard hash function (GOST R 34.11-94), which is
   one of the Russian cryptographic standard algorithms (called GOST
   algorithms).  Recently, Russian cryptography is being used in
   Internet applications, and this document has been created as
   information for developers and users of GOST R 34.11-94 for hash
   computation.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This is a contribution to the RFC Series, independently of any other
   RFC stream.  The RFC Editor has chosen to publish this document at
   its discretion and makes no statement about its value for
   implementation or deployment.  Documents approved for publication by
   the RFC Editor are not a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc5831">http://www.rfc-editor.org/info/rfc5831</a>.


















<span class="grey">Dolmatov                      Informational                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5831.html">RFC 5831</a>                     GOST R 34.11-94                  March 2010</span>


Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.

   This document may not be modified, and derivative works of it may not
   be created, except to format it for publication as an RFC or to
   translate it into languages other than English.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. General Information ........................................<a href="#page-3">3</a>
      <a href="#section-1.2">1.2</a>. The Purpose of GOST R 34.11-94 .............................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Applicability ...................................................<a href="#page-3">3</a>
   <a href="#section-3">3</a>. Conventions Used in This Document ...............................<a href="#page-4">4</a>
   <a href="#section-4">4</a>. General Statements ..............................................<a href="#page-5">5</a>
   <a href="#section-5">5</a>. Step-by-Step Hash Function ......................................<a href="#page-5">5</a>
      <a href="#section-5.1">5.1</a>. Key Generation .............................................<a href="#page-5">5</a>
      <a href="#section-5.2">5.2</a>. Encryption Transformation ..................................<a href="#page-7">7</a>
      <a href="#section-5.3">5.3</a>. Mixing Transformation ......................................<a href="#page-7">7</a>
   <a href="#section-6">6</a>. The Calculation Procedure for a Hash Function ...................<a href="#page-8">8</a>
   <a href="#section-7">7</a>. Test Examples (Informative) .....................................<a href="#page-9">9</a>
      <a href="#section-7.1">7.1</a>. Usage of the Algorithm GOST 28147-89 ......................<a href="#page-10">10</a>
      <a href="#section-7.2">7.2</a>. Representation of Vectors .................................<a href="#page-11">11</a>
      <a href="#section-7.3">7.3</a>. Examples of the Hash Value Calculation ....................<a href="#page-11">11</a>
           <a href="#section-7.3.1">7.3.1</a>. Hash Calculation for the Sample Message M ..........<a href="#page-11">11</a>
           <a href="#section-7.3.2">7.3.2</a>. Hash Calculation for the Sample Message M ..........<a href="#page-14">14</a>
   <a href="#section-8">8</a>. Security Considerations ........................................<a href="#page-16">16</a>
   <a href="#section-9">9</a>. Normative References ...........................................<a href="#page-16">16</a>
   <a href="#section-10">10</a>. Contributors ..................................................<a href="#page-17">17</a>













<span class="grey">Dolmatov                      Informational                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5831.html">RFC 5831</a>                     GOST R 34.11-94                  March 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20General%20Information"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  General Information</span>

   1. GOST R 34.11-94  [<a href="#ref-GOST3411" title='"Information technology. Cryptographic Data Security. Hashing function."'>GOST3411</a>] was developed by the Federal Agency
      for Government Communication and Information and by the All-Russia
      Scientific and Research Institute of Standardization.

   2. GOST R 34.11-94 was accepted and activated by Act 154 of
      23.05.1994 issued by the Russian Federal committee for standards.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20The%20Purpose%20of%20GOST%20R%2034.11-94"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  The Purpose of GOST R 34.11-94</span>

   Expanding the application of information technologies when creating,
   processing, and storing documents requires, in some cases,
   confidentiality of their contents, maintenance of completeness, and
   authenticity.

   Cryptography (cryptographic security) is one of the effective
   approaches for data security.  It is widely applied in different
   areas of government and commercial activity.

   Cryptographic data security methods are under serious scientific
   research and standardization efforts at national, regional, and
   international levels.

   GOST R 34.11-94 defines a hash function calculation procedure for an
   arbitrary sequence of binary symbols.

   The hash function maps an arbitrary set of data represented as a
   sequence of binary symbols onto its image of a fixed small length.

   Thus, hash functions can be used in procedures related to the
   electronic digital signature, resulting in considerable reduction of
   elapsed time for the sign and verify stages.  The effect of the
   reduction of time is due to the fact that only a short image of
   initial data is actually signed.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Applicability"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Applicability</span>

   GOST R 34.11-94 defines an algorithm and procedure for the
   calculation of a hash function for an arbitrary sequence of binary
   symbols.  These algorithms and procedures should be applied in
   cryptographic methods of data processing and securing, including
   digital signature procedures employed for data transfer and data
   storage in computer-aided systems.





<span class="grey">Dolmatov                      Informational                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5831.html">RFC 5831</a>                     GOST R 34.11-94                  March 2010</span>


   The hash function, defined in GOST R 34.11-94, is used for digital
   signature systems based on the asymmetric cryptographic algorithm
   according to GOST R 34.10-2001 (see <a href="#section-3">section 3</a>).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Conventions Used in This Document</span>

   The following notations are used in GOST R 34.11-94:

   V_all is a set of all finite words in the alphabet V = {0,1}.  The
   words are read from right to left and the alphabet symbols are
   numbered from right to left (i.e., the rightmost symbol of the word
   has the number one, the second rightmost symbol has number two,
   etc.).

   Vk is a set of all words in alphabet V = {0,1} of length k bits
   (k=16,64,256).

   |A| is the length of a word A belonging to V_all.

   A||B is a concatenation of words A, B belonging to V_all.  Its length
   is |A| + |B|, where the left |A| symbols come from the word A, and
   the right |B| symbols come from the word B.  One can also use the
   notation A||B = A * B.

   A^k is a concatenation of k copies of the word A (A belongs to
   V_all).

   &lt;N&gt;_k is a word of length k, containing a binary representation of
   N(mod 2^k) residue, with a non-negative integer N.

   A^$ is a non-negative integer with A as its binary representation.

   (xor) is the bitwise modulo 2 addition of the words of the same
   length.

   (+)' is the addition according to the rule A (+)' B = &lt;A^$+ B^$&gt;_k,
   where k = |A| = |B|.

   M is a binary sequence to be hashed, M belongs to V_all.  M is a
   message in digital signature systems.

   h is a hash function that maps the sequence M belonging to V_all onto
   the word h(M) belonging to V_256.

   E(k,A) is a result of the encryption of the word A using key K with
   the encryption algorithm according to [<a href="#ref-GOST28147" title='"Cryptographic Protection for Data Processing System"'>GOST28147</a>] in the electronic
   codebook (ECB) mode (K belongs to V256, A belongs to V64).




<span class="grey">Dolmatov                      Informational                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5831.html">RFC 5831</a>                     GOST R 34.11-94                  March 2010</span>


   h0 is an initial hash value.

   e := g is the assignment of the value g to the parameter e.

   ^ is the power operator.

   i = 1..8 is an interval with i being all the values from 1 to 8.

   hUZ is the S-boxes described in [<a href="#ref-GOST28147" title='"Cryptographic Protection for Data Processing System"'>GOST28147</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20General%20Statements"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  General Statements</span>

   A hash function h is the mapping h :  V_all -&gt; V256, depending on the
   parameter (which is the initial hash value H, H is a word from V256).
   To define the hash function, it is necessary to have:

      - a calculation algorithm for the step-by-step hash function

        chi : V256 x V256 -&gt;  V256

      - a description of an iterative procedure for calculating the hash
        value h

   A hash function h depends on two parameters, h0 and hUZ.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Step-by-Step%20Hash%20Function"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Step-by-Step Hash Function</span>

   A calculation algorithm for the step-by-step hash function contains
   three parts, which successively do:

      - key generation, here keys are 256-bit words;

      - an encryption transformation, that is encryption of 64-bit
        subwords of word H using keys K[i], (i = 1, 2, 3, 4) with the
        algorithm according to [<a href="#ref-GOST28147" title='"Cryptographic Protection for Data Processing System"'>GOST28147</a>] in ECB mode; and

      - a mixing transformation for the result of the encryption.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1%20%20Key%20Generation"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>  Key Generation</span>

   Consider X = (b[256], b[255], ..., b[1]) belongs to V256.

   Let:

      X = x[4]||x[3]||x[2]||x[1] = eta[16]||[eta15]||...||eta[1]

        = xi[32]||xi[31]||...||xi[1], where




<span class="grey">Dolmatov                      Informational                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5831.html">RFC 5831</a>                     GOST R 34.11-94                  March 2010</span>


        x[i] = (b[i*64],...,b[(i-1)*64+1]) belongs to V64, i = 1..4,

      eta[j] = (b[j*16],...,b[(j-1)*16+1]) belongs to V16, j = 1..16,

       xi[k] = (b[k*8],..., b[(k-1)*8+1]) belongs to V8, k = 1..32.

   Yet, another notation: A(X) = (x[1](xor)x[2])||x[4]||x[3]||x[2].

   The transformation P : V256 -&gt; V256 maps the word xi32||...||xi1
   onto the word xi[phi(32)] || ... || xi[phi(1)],

   where phi(i + 1 + 4 ( k - 1) ) = 8i + k , i = 0..3, k = 1..8.

   For the key generation, one should use the following initial data:

      - words H, M belonging to V256,

      - parameters: words C[i] (i = 2, 3, 4), with values:

        C[2] = C[4] = 0^256;

        C[3] = 1^8||0^8||1^16||0^24||1^16||0^8||(0^8||1^8)^2||1^8||0^8
               ||(0^8||1^8)^4||(1^8||0^8 )^4.

   The following algorithm is used for the key calculation:

   1. Assign values:

      i := 1, U := H , V := M.

   2. Calculate:

      W = U (xor) V , K[i] = P(W).

   3. Assign:

      i := i + 1.

   4. Verify condition:

      i = 5.

   If it is true, go to step 7.  If not, go to step 5.

   5. Calculate:

      U := A(U)(xor)C[i], V := A(A(V)),
      W := U(xor)V, K[i] = P(W).



<span class="grey">Dolmatov                      Informational                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5831.html">RFC 5831</a>                     GOST R 34.11-94                  March 2010</span>


   6. Go to step 3.

   7. End.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Encryption%20Transformation"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Encryption Transformation</span>

   At this stage, 64-bit subwords of the word H are encrypted using keys
   K[i] (i = 1, 2, 3, 4).

   For the encryption transformation, one should use the following
   initial data:

      H = h[4]||h[3]||h[2]||h[1],

   where h[i] belongs to V64, i = 1,2,3,4, and a key set is K[1], K[2],
   K[3], K[4].

   The encryption algorithm is applied and the following words are
   obtained:

      s[i] = E(K[i],h[i]), where: i = 1,2,3,4

   As a result of the stage, the following sequence is formed:

      S = s[4]||s[3]||s[2]||s[1].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Mixing%20Transformation"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Mixing Transformation</span>

   At this stage, the obtained sequence is mixed using a shift register.

   The initial data includes words H, M belonging to V256 and a word S
   belonging to V256 .

   Let a mapping PSI(X) : V256(2) -&gt; V256(2) transform the word:

      eta[16]||eta[15]||...||eta[1], eta[i] belongs to V16, i = 1..16

   into the word:

      eta[1](xor)eta[2](xor)eta[3](xor)eta[4](xor)eta[13](xor)eta[16]
      ||eta[16]||...||eta[2].

   Then, the value of the step-by-step hash function value is the word:

      chi(M, H) =  PSI^61(H(xor)PSI(M(xor)PSI^12(S))),

   where PSI^i(X) is the transformation PSI applied i times to X.




<span class="grey">Dolmatov                      Informational                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5831.html">RFC 5831</a>                     GOST R 34.11-94                  March 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20The%20Calculation%20Procedure%20for%20a%20Hash%20Function"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  The Calculation Procedure for a Hash Function</span>

   The calculation procedure for a hash function h is assumed to be
   applied to a sequence M belonging to V_all.  Its parameter is an
   initial hash value h0, which is an arbitrarily fixed word from V256.

   The calculation procedure for the function h uses the following
   quantities at each step of iteration:

   _M_ belonging to V_all - a part of the sequence M, which was not
   hashed at previous iterations;

   H belonging to V256 - the current hash value;

   SIGMA belonging to V256 - the current check sum value;

   L belonging to V256 - the length of the partial sequence M processed
   at the previous iteration step.

   The calculation algorithm for function h consists of the following
   steps:

   Step 1. Assign initial values to current quantities:

      1.1 _M_ := M.

      1.2 H := h0.

      1.3 SIGMA := 0^256.

      1.4 L := 0^256.

      1.5 Go to step 2.

   Step 2.

      2.1 Verify the condition |_M_|&gt;256.

   If it is true, go to step 3.

   Else, make the following calculations:

      2.2 L := &lt;L^$ + |M|&gt;_256

      2.3 M' := 0^(256 -|M|)||M

      2.4 SIGMA := SIGMA (+)' M'




<span class="grey">Dolmatov                      Informational                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5831.html">RFC 5831</a>                     GOST R 34.11-94                  March 2010</span>


      2.5 H := chi (M', H)

      2.6 H := chi (L, H)

      2.7 H := chi (SIGMA, H)

      2.8 End.

   Step 3.

      3.1 Calculate a subword M_s belonging to V256 of the word _M_
          (_M_ = M_p||M_s).  Then make the following calculations:

      3.2 H := chi (M_s, H)

      3.3 L := &lt;L^$ + 256&gt;_256

      3.4 SIGMA := SIGMA (+)' M[s]

      3.5 _M_ = M_p

      3.6 Go to step 2.

   The quantity H obtained at step 2.7 is the value of the hash function
   h(M).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Test%20Examples%20%28Informative%29"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Test Examples (Informative)</span>

   It is recommended to use the values for substitution units pi[1],
   pi[2],..., pi[8] and the initial hash value H described in this
   appendix for the GOST R 34.11-94 test examples only.




















<span class="grey">Dolmatov                      Informational                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5831.html">RFC 5831</a>                     GOST R 34.11-94                  March 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Usage%20of%20the%20Algorithm%20GOST%2028147-89"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Usage of the Algorithm GOST 28147-89</span>

   The algorithm GOST 28147-89 [<a href="#ref-GOST28147" title='"Cryptographic Protection for Data Processing System"'>GOST28147</a>] in ECB mode is used as an
   encryption transformation in the following examples.  The following
   values of the substitution units pi[1], pi[2],..., pi[8] have been
   chosen:

           8 7 6 5 4 3 2 1

       0   1 D 4 6 7 5 E 4

       1   F B B C D 8 B A

       2   D 4 A 7 A 1 4 9

       3   0 1 0 1 1 D C 2

       4   5 3 7 5 0 A 6 D

       5   7 F 2 F 8 3 D 8

       6   A 5 1 D 9 4 F 0

       7   4 9 D 8 F 2 A E

       8   9 0 3 4 E E 2 6

       9   2 A 6 A 4 F 3 B

      10   3 E 8 9 6 C 8 1

      11   E 7 5 E C 7 1 C

      12   6 6 9 0 B 6 0 7

      13   B 8 C 3 2 0 7 F

      14   8 2 F B 5 9 5 5

      15   C C E 2 3 B 9 3

   The hexadecimal value of pi[j](i) is given in a column number j,

      j = 1..8, and in a row number i, i = 0..15.







<span class="grey">Dolmatov                      Informational                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5831.html">RFC 5831</a>                     GOST R 34.11-94                  March 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Representation%20of%20Vectors"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Representation of Vectors</span>

   We will put down binary symbol sequences as hexadecimal digits
   strings, where each digit corresponds to four signs of its binary
   representation.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.3%20Examples%20of%20the%20Hash%20Value%20Calculation"></a><a class="selflink" href="#section-7.3" name="section-7.3">7.3</a> Examples of the Hash Value Calculation</span>

   A zero vector, for example, can be taken as an initial hash value:

   h0 = 00000000 00000000 00000000 00000000
        00000000 00000000 00000000 00000000

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.3.1.%20%20Hash%20Calculation%20for%20the%20Sample%20Message%20M"></a><a class="selflink" href="#section-7.3.1" name="section-7.3.1">7.3.1</a>.  Hash Calculation for the Sample Message M</span>

   M = 73657479 62203233 3D687467 6E656C20
       2C656761 7373656D 20736920 73696854

   Initial values are assigned for the text:

   _M_   = 73657479 62203233 3D687467 6E656C20
           2C656761 7373656D 20736920 73696854

   for the hash function:

   H   = 00000000 00000000 00000000 00000000
         00000000 00000000 00000000 00000000

   for the sum of text blocks:


   SIGMA = 00000000 00000000 00000000 00000000
           00000000 00000000 00000000 00000000

   for the length of the text:

   L = 00000000 00000000 00000000 00000000
       00000000 00000000 00000000 00000000

   If the length of the message to be hashed equals 256 bits (32 bytes),
   then:

   L = 00000000 00000000 00000000 00000000
       00000000 00000000 00000000 00000100

   M' = _M_ = 73657479 62203233 3D687467 6E656C20
              2C656761 7373656D 20736920 73696854




<span class="grey">Dolmatov                      Informational                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5831.html">RFC 5831</a>                     GOST R 34.11-94                  March 2010</span>


   and there is no need to pad the current block with zeroes:

   SIGMA=M' = 73657479 62203233 3D687467 6E656C20
               2C656761 7373656D 20736920 73696854

   The step-by-step hash function chi(M, N) values are calculated.

   The keys are generated:

   K[1] = 733D2C20 65686573 74746769 326C6568
          626E7373 20657369 79676120 33206D54

   K[2] = 110C733D 0D166568 130E7474 06417967
          1D00626E 161A2065 090D326C 4D393320

   K[3] = 80B111F3 730DF216 850013F1 C7E1F941
          620C1DFF 3ABAE91A 3FA109F2 F513B239

   K[4] = A0E2804E FF1B73F2 ECE27A00 E7B8C7E1
          EE1D620C AC0CC5BA A804C05E A18B0AEC

   The 64-bit subwords of block H are encrypted by the algorithm
   according to GOST 28147.

   Block h[1] = 00000000 00000000 is encrypted using key K[1] and
   s[1] = 42ABBCCE 32BC0B1B is obtained.

   Block h[2] = 00000000 00000000 is encrypted using key K[2] and
   s[2] = 5203EBC8 5D9BCFFD is obtained.

   Block h[3] = 00000000 00000000 is encrypted using key K[3] and
   s[3] = 8D345899 00FF0E28 is obtained.

   Block h[4] = 00000000 00000000 is encrypted using key K[4] and
   s[4] = E7860419 0D2A562D is obtained.

   So S = E7860419 0D2A562D 8D345899 00FF0E28
          5203EBC8 5D9BCFFD 42ABBCCE 32BC0B1B

   is obtained.

   The mixing transformation using a shift register is performed and

   KSI = chi(M, H) = CF9A8C65 505967A4 68A03B8C 42DE7624
                     D99C4124 883DA687 561C7DE3 3315C034

   is obtained.




<span class="grey">Dolmatov                      Informational                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5831.html">RFC 5831</a>                     GOST R 34.11-94                  March 2010</span>


   Assign H = KSI and calculate chi(L, H):

   K[1] = CF68D956 9AA09C1C 8C3B417D 658C24E3
          50428833 59DE3D15 6776A6C1 A4248734

   K[2] = 8FCF68D9 809AA09C 3C8C3B41 C7658C24
          BB504288 2859DE3D 666676A6 B3A42487

   K[3] = 4E70CF97 3C8065A0 853C8CC4 57389A8C
          CABB50BD E3D7A6DE D1996788 5CB35B24

   K[4] = 584E70CF C53C8065 48853C8C 1657389A
          EDCABB50 78E3D7A6 EED19867 7F5CB35B

   S    = 66B70F5E F163F461 468A9528 61D60593
          E5EC8A37 3FD42279 3CD1602D DD783E86

   KSI  = 2B6EC233 C7BC89E4 2ABC2692 5FEA7285
          DD3848D1 C6AC997A 24F74E2B 09A3AEF7

   Now assign H = KSI again and calculate chi( SIGMA, H):

   K[1] = 5817F104 0BD45D84 B6522F27 4AF5B00B
          A531B57A 9C8FDFCA BB1EFCC6 D7A517A3

   K[2] = E82759E0 C278D950 15CC523C FC72EBB6
          D2C73DA8 19A6CAC9 3E8440F5 C0DDB65A

   K[3] = 77483AD9 F7C29CAA EB06D1D7 841BCAD3
          FBC3DAA0 7CB555F0 D4968080 0A9E56BC

   K[4] = A1157965 2D9FBC9C 088C7CC2 46FB3DD2
          7684ADCB FA4ACA06 53EFF7D7 C0748708

   S    = 2AEBFA76 A85FB57D 6F164DE9 2951A581
          C31E7435 4930FD05 1F8A4942 550A582D

   KSI  = FAFF37A6 15A81669 1CFF3EF8 B68CA247
          E09525F3 9F811983 2EB81975 D366C4B1

   Then, the hash result is:

   H    = FAFF37A6 15A81669 1CFF3EF8 B68CA247
          E09525F3 9F811983 2EB81975 D366C4B1







<span class="grey">Dolmatov                      Informational                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5831.html">RFC 5831</a>                     GOST R 34.11-94                  March 2010</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.3.2.%20%20Hash%20Calculation%20for%20the%20Sample%20Message%20M"></a><a class="selflink" href="#section-7.3.2" name="section-7.3.2">7.3.2</a>.  Hash Calculation for the Sample Message M</span>

   Let M = 7365 74796220 3035203D 20687467 6E656C20
                73616820 65676173 73656D20 6C616E69
                6769726F 20656874 2065736F 70707553

   As the length of the message to be hashed equals 400 bits (50 bytes),
   the message is divided into two blocks, and the second (high-order)
   one is padded with zeroes.  During the calculations the following
   numbers are obtained:

   STEP 1.

   H    = 00000000 00000000 00000000 00000000
          00000000 00000000 00000000 00000000

   M_s = 73616820 65676173 73656D20 6C616E69
         6769726F 20656874 2065736F 70707553

   K[1] = 73736720 61656965 686D7273 20206F6F
          656C2070 67616570 616E6875 73697453

   K[2] = 14477373 0C0C6165 1F01686D 4F002020
          4C50656C 04156761 061D616E 1D277369

   K[3] = CBFF14B8 6D04F30C 96051FFE DFFFB000
          35094CAF 72F9FB15 7CF006E2 AB1AE227

   K[4] = EBACCB00 F7006DFB E5E16905 B0B0DFFF
          BA1C3509 FD118DF9 F61B830F F8C554E5

   S    = FF41797C EEAADAC2 43C9B1DF 2E14681C
          EDDC2210 1EE1ADF9 FA67E757 DAFE3AD9

   KSI  = F0CEEA4E 368B5A60 C63D96C1 E5B51CD2
          A93BEFBD 2634F0AD CBBB69CE ED2D5D9A

   STEP 2.

   H    = F0CEEA4E 368B5A60 C63D96C1 E5B51CD2
          A93BEFBD 2634F0AD CBBB69CE ED2D5D9A

   M'   = 00000000 00000000 00000000 00007365
          74796220 3035203D 20687467 6E656C20

   K[1] = F0C6DDEB CE3D42D3 EA968D1D 4EC19DA9
          36E51683 8BB50148 5A6FD031 60B790BA




<span class="grey">Dolmatov                      Informational                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc5831.html">RFC 5831</a>                     GOST R 34.11-94                  March 2010</span>


   K[2] = 16A4C6A9 F9DF3D3B E4FC96EF 5309C1BD
          FB68E526 2CDBB534 FE161C83 6F7DD2C8

   K[3] = C49D846D 1780482C 9086887F C48C9186
          9DCB0644 D1E641E5 A02109AF 9D52C7CF

   K[4] = BDB0C9F0 756E9131 E1F290EA 50E4CBB1
          1CAD9536 F4E4B674 99F31E29 70C52AFA

   S    = 62A07EA5 EF3C3309 2CE1B076 173D48CC
          6881EB66 F5C7959F 63FCA1F1 D33C31B8

   KSI  = 95BEA0BE 88D5AA02 FE3C9D45 436CE821
          B8287CB6 2CBC135B 3E339EFE F6576CA9

   STEP 3.

   H    = 95BEA0BE 88D5AA02 FE3C9D45 436CE821
          B8287CB6 2CBC135B 3E339EFE F6576CA9

   L    = 00000000 00000000 00000000 00000000
          00000000 00000000 00000000 00000190

   K[1] = 95FEB83E BE3C2833 A09D7C9E BE45B6FE
          88432CF6 D56CBC57 AAE8136D 02215B39

   K[2] = 8695FEB8 1BBE3C28 E2A09D7C 48BE45B6
          DA88432C EBD56CBC 7FABE813 F292215B

   K[2] = 8695FEB8 1BBE3C28 E2A09D7C 48BE45B6
          DA88432C EBD56CBC 7FABE813 F292215B

   K[3] = B9799501 141B413C 1EE2A062 0CB74145
          6FDA88BC D0142A6C FA80AA16 15F2FDB1

   K[4] = 94B97995 7D141B41 C21EE2A0 040CB741
          346FDA88 46D0142A BDFA81AA DC1562FD

   S    = D42336E0 2A0A6998 6C65478A 3D08A1B9
          9FDDFF20 4808E863 94FD9D6D F776A7AD

   KSI  = 47E26AFD 3E7278A1 7D473785 06140773
          A3D97E7E A744CB43 08AA4C24 3352C745

   STEP 4.

   H    = 47E26AFD 3E7278A1 7D473785 06140773
          A3D97E7E A744CB43 08AA4C24 3352C745



<span class="grey">Dolmatov                      Informational                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc5831.html">RFC 5831</a>                     GOST R 34.11-94                  March 2010</span>


   SIGMA = 73616820 65676173 73656D20 6C61E1CE
           DBE2D48F 509A88B1 40CDE7D6 DED5E173

   K[1] = 340E7848 83223B67 025AAAAB DDA5F1F2
          5B6AF7ED 1575DE87 19E64326 D2BDF236

   K[2] = 03DC0ED0 F4CD26BC 8B595F13 F5A4A55E
          A8B063CB ED3D7325 6511662A 7963008D

   K[3] = C954EF19 D0779A68 ED37D3FB 7DA5ADDC
          4A9D0277 78EF765B C4731191 7EBB21B1

   K[4] = 6D12BC47 D9363D19 1E3C696F 28F2DC02
          F2137F37 64E4C18B 69CCFBF8 EF72B7E3

   S    = 790DD7A1 066544EA 2829563C 3C39D781
          25EF9645 EE2C05DD A5ECAD92 2511A4D1

   KSI  = 0852F562 3B89DD57 AEB4781F E54DF14E
          EAFBC135 0613763A 0D770AA6 57BA1A47

   Then, the hash result is:

   H    = 0852F562 3B89DD57 AEB4781F E54DF14E
          EAFBC135 0613763A 0D770AA6 57BA1A47

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Security%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Security Considerations</span>

   This entire document is about security considerations.

   Current cryptographic resistance of GOST R 34.11-94 hash algorithm is
   estimated as 2^128 operations of computations of step hash functions.
   (There is a known method to reduce this estimate to 2^105 operations,
   but it demands padding the colliding message with 1024 random bit
   blocks each of 256-bit length; thus, it cannot be used in any
   practical implementation).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Normative%20References"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Normative References</span>

   [<a id="ref-GOST28147" name="ref-GOST28147">GOST28147</a>] "Cryptographic Protection for Data Processing System",
               GOST 28147-89, Gosudarstvennyi Standard of USSR,
               Government Committee of the USSR for Standards, 1989.
               (In Russian)

   [<a id="ref-GOST3411" name="ref-GOST3411">GOST3411</a>]  "Information technology.  Cryptographic Data Security.
               Hashing function.", GOST R 34.10-94, Gosudarstvennyi
               Standard of Russian Federation, Government Committee of
               the Russia for Standards, 1994. (In Russian)



<span class="grey">Dolmatov                      Informational                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc5831.html">RFC 5831</a>                     GOST R 34.11-94                  March 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Contributors"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Contributors</span>

   Dmitry Kabelev
   Cryptocom, Ltd.
   14 Kedrova St., Bldg. 2
   Moscow, 117218
   Russian Federation


   EMail: kdb@cryptocom.ru

   Igor Ustinov
   Cryptocom, Ltd.
   14 Kedrova St., Bldg. 2
   Moscow, 117218
   Russian Federation

   EMail: igus@cryptocom.ru


   Sergey Vyshensky
   Moscow State University
   Leninskie gory, 1
   Moscow, 119991
   Russian Federation

   EMail: svysh@pn.sinp.msu.ru

Author's Address

   Vasily Dolmatov, Ed.
   Cryptocom, Ltd.
   14 Kedrova St., Bldg. 2
   Moscow, 117218
   Russian Federation

   EMail: dol@cryptocom.ru














Dolmatov                      Informational                    [Page 17]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc5831 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:33 GMT --></html>