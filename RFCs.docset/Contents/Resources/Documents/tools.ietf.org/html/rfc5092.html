<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc5092 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:37 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="rfc2192" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:5092" name="DC.Identifier"/>
<meta content="November, 2007" name="DC.Date.Issued"/>
<meta content="Melnikov, Alexey" name="DC.Creator"/>
<meta content="Newman, Chris" name="DC.Creator"/>
<meta content="IMAP (RFC 3501) is a rich protocol for accessing remote message
stores. It provides an ideal mechanism for accessing public mailing
list archives as well as private and shared message stores. This
document defines a URL scheme for referencing objects on an IMAP
server.  This document obsoletes RFC 2192. It also updates RFC 4467.
[STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="IMAP URL Scheme" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5092 - IMAP URL Scheme</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc5092.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc5092" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-lemonade-rfc2192bis" title="draft-ietf-lemonade-rfc2192bis">draft-ietf-lemo...</a>] [<a href="https://datatracker.ietf.org/doc/rfc5092" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5092" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc5092" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=5092">Errata</a>]</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">Updated by: <a href="rfc5593.html">5593</a>                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Network Working Group                                   A. Melnikov, Ed.
Request for Comments: 5092                                    Isode Ltd.
Obsoletes: <a href="rfc2192.html">2192</a>                                                C. Newman
Updates: <a href="rfc4467.html">4467</a>                                           Sun Microsystems
Category: Standards Track                                  November 2007


                            <span class="h1">IMAP URL Scheme</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Abstract

   IMAP (<a href="rfc3501.html">RFC 3501</a>) is a rich protocol for accessing remote message
   stores.  It provides an ideal mechanism for accessing public mailing
   list archives as well as private and shared message stores.  This
   document defines a URL scheme for referencing objects on an IMAP
   server.

   This document obsoletes <a href="rfc2192.html">RFC 2192</a>.  It also updates <a href="rfc4467.html">RFC 4467</a>.

























<span class="grey">Melnikov &amp; Newman           Standards Track                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
   <a href="#section-2">2</a>. Conventions Used in This Document ...............................<a href="#page-3">3</a>
   <a href="#section-3">3</a>. IMAP userinfo Component (iuserinfo) .............................<a href="#page-4">4</a>
      <a href="#section-3.1">3.1</a>. IMAP Mailbox Naming Scope ..................................<a href="#page-4">4</a>
      <a href="#section-3.2">3.2</a>. IMAP User Name and Authentication Mechanism ................<a href="#page-4">4</a>
      <a href="#section-3.3">3.3</a>. Limitations of enc-user ....................................<a href="#page-6">6</a>
   <a href="#section-4">4</a>. IMAP Server .....................................................<a href="#page-7">7</a>
   <a href="#section-5">5</a>. Lists of Messages ...............................................<a href="#page-7">7</a>
   <a href="#section-6">6</a>. A Specific Message or Message Part ..............................<a href="#page-8">8</a>
      <a href="#section-6.1">6.1</a>. URLAUTH Authorized URL .....................................<a href="#page-9">9</a>
           <a href="#section-6.1.1">6.1.1</a>. Concepts ............................................<a href="#page-9">9</a>
                  <a href="#section-6.1.1.1">6.1.1.1</a>. URLAUTH ....................................<a href="#page-9">9</a>
                  <a href="#section-6.1.1.2">6.1.1.2</a>. Mailbox Access Key .........................<a href="#page-9">9</a>
                  <a href="#section-6.1.1.3">6.1.1.3</a>. Authorized Access Identifier ...............<a href="#page-9">9</a>
                  <a href="#section-6.1.1.4">6.1.1.4</a>. Authorization Mechanism ...................<a href="#page-10">10</a>
                  <a href="#section-6.1.1.5">6.1.1.5</a>. Authorization Token .......................<a href="#page-10">10</a>
           <a href="#section-6.1.2">6.1.2</a>. URLAUTH Extensions to IMAP URL .....................<a href="#page-10">10</a>
   <a href="#section-7">7</a>. Relative IMAP URLs .............................................<a href="#page-11">11</a>
      <a href="#section-7.1">7.1</a>. absolute-path References ..................................<a href="#page-12">12</a>
      <a href="#section-7.2">7.2</a>. relative-path References ..................................<a href="#page-12">12</a>
   <a href="#section-8">8</a>. Internationalization Considerations ............................<a href="#page-13">13</a>
   <a href="#section-9">9</a>. Examples .......................................................<a href="#page-13">13</a>
      <a href="#section-9.1">9.1</a>. Examples of Relative URLs .................................<a href="#page-16">16</a>
   <a href="#section-10">10</a>. Security Considerations .......................................<a href="#page-16">16</a>
      10.1. Security Considerations Specific to URLAUTH Authorized
            URL ......................................................<a href="#page-17">17</a>
   <a href="#section-11">11</a>. ABNF for IMAP URL Scheme ......................................<a href="#page-17">17</a>
   <a href="#section-12">12</a>. IANA Considerations ...........................................<a href="#page-21">21</a>
      <a href="#section-12.1">12.1</a>. IANA Registration of imap: URI Scheme ....................<a href="#page-21">21</a>
   <a href="#section-13">13</a>. References ....................................................<a href="#page-22">22</a>
      <a href="#section-13.1">13.1</a>. Normative References .....................................<a href="#page-22">22</a>
      <a href="#section-13.2">13.2</a>. Informative References ...................................<a href="#page-23">23</a>
   <a href="#appendix-A">Appendix A</a>. Sample Code............................................<a href="#page-24">24</a>
   <a href="#appendix-B">Appendix B</a>. List of Changes since <a href="rfc2192.html">RFC 2192</a>.........................<a href="#page-30">30</a>
   <a href="#appendix-C">Appendix C</a>. List of Changes since <a href="rfc4467.html">RFC 4467</a>.........................<a href="#page-31">31</a>
   <a href="#appendix-D">Appendix D</a>. Acknowledgments........................................<a href="#page-31">31</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The IMAP URL scheme is used to designate IMAP servers, mailboxes,
   messages, MIME bodies [<a href="#ref-MIME" title='"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"'>MIME</a>], and search programs on Internet hosts
   accessible using the IMAP protocol over TCP.

   The IMAP URL follows the common Internet scheme syntax as defined in
   [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>].  If :&lt;port&gt; is omitted, the port defaults to 143 (as
   defined in Section 2.1 of [<a href="#ref-IMAP4" title='"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1"'>IMAP4</a>]).



<span class="grey">Melnikov &amp; Newman           Standards Track                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


   An absolute IMAP URL takes one of the following forms:

      imap://&lt;iserver&gt;[/]

      imap://&lt;iserver&gt;/&lt;enc-mailbox&gt;[&lt;uidvalidity&gt;][?&lt;enc-search&gt;]

      imap://&lt;iserver&gt;/&lt;enc-mailbox&gt;[&lt;uidvalidity&gt;]&lt;iuid&gt;
       [&lt;isection&gt;][&lt;ipartial&gt;][&lt;iurlauth&gt;]

   The first form is used to refer to an IMAP server (see <a href="#section-4">Section 4</a>),
   the second form refers to the contents of a mailbox or a set of
   messages resulting from a search (see <a href="#section-5">Section 5</a>), and the final form
   refers to a specific message or message part, and possibly a byte
   range in that part (see <a href="#section-6">Section 6</a>).  If [<a href="#ref-URLAUTH" title='"Internet Message Access Protocol (IMAP) - URLAUTH Extension"'>URLAUTH</a>] extension is
   supported, then the final form can have the &lt;iurlauth&gt; component (see
   <a href="#section-6.1">Section 6.1</a> for more details).

   The &lt;iserver&gt; component common to all types of absolute IMAP URLs has
   the following syntax expressed in ABNF [<a href="#ref-ABNF" title='"Augmented BNF for Syntax Specifications: ABNF"'>ABNF</a>]:

      [iuserinfo "@"] host [ ":" port ]

   The &lt;iserver&gt; component is the same as "authority" defined in
   [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>].  The syntax and uses of the &lt;iuserinfo&gt; ("IMAP userinfo
   component") are described in detail in <a href="#section-3">Section 3</a>.  The syntax of
   &lt;host&gt; and &lt;port&gt; is described in [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="#ref-KEYWORDS" title='"Key words for use in RFCs to Indicate Requirement Levels"'>KEYWORDS</a>].

   This document references many productions from [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>].  When the
   document needs to emphasize IMAP URI-specific differences from [URI-
   GEN] (i.e., for parts of IMAP URIs that have more restricted syntax
   than generic URIs), it uses a non-terminal i&lt;foo&gt; to define an IMAP-
   specific version of the non-terminal &lt;foo&gt; from [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>].

   Note that the ABNF syntax shown in <a href="#section-11">Section 11</a> is normative.  Sections
   2-6 may use a less formal syntax that does not necessarily match the
   normative ABNF shown in <a href="#section-11">Section 11</a>.  If there are any differences
   between the syntax shown in Sections <a href="#section-2">2</a>-<a href="#section-6">6</a> and <a href="#section-11">Section 11</a>, then the
   syntax shown in <a href="#section-11">Section 11</a> must be treated as authoritative.  Non-
   syntax requirements included in Sections <a href="#section-2">2</a>-<a href="#section-6">6</a> are, of course,
   normative.





<span class="grey">Melnikov &amp; Newman           Standards Track                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20IMAP%20userinfo%20Component%20%28iuserinfo%29"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  IMAP userinfo Component (iuserinfo)</span>

   The &lt;iuserinfo&gt; component conforms to the generic syntax of
   &lt;userinfo&gt; defined in [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>].  It has the following syntax
   expressed in ABNF [<a href="#ref-ABNF" title='"Augmented BNF for Syntax Specifications: ABNF"'>ABNF</a>]:

      enc-user [iauth] / [enc-user] iauth

   The meaning of the different parts is described in subsections of
   this section.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20IMAP%20Mailbox%20Naming%20Scope"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  IMAP Mailbox Naming Scope</span>

   The "enc-user" part of the "iuserinfo" component, if present, denotes
   mailbox naming scope.  If it is absent, the IMAP URL can only
   reference mailboxes with globally unique names, i.e., mailboxes with
   names that don't change depending on the user the client
   authenticated as to the IMAP server.  Note that not all IMAP
   implementations support globally unique names.

   For example, a personal mailbox described by the following URL
   &lt;imap://michael@example.org/INBOX&gt; is most likely different from a
   personal mailbox described by &lt;imap://bester@example.org/INBOX&gt;, even
   though both URLs use the same mailbox name.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20IMAP%20User%20Name%20and%20Authentication%20Mechanism"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  IMAP User Name and Authentication Mechanism</span>

   The userinfo component (see [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>]) of an IMAP URI may contain an
   IMAP user name (a.k.a. authorization identity [<a href="#ref-SASL" title='"Simple Authentication and Security Layer (SASL)"'>SASL</a>], "enc-user")
   and/or an authentication mechanism. (Note that the "enc-user" also
   defines a mailbox naming scope as described in <a href="#section-3.1">Section 3.1</a>).  The
   IMAP user name and the authentication mechanism are used in the
   "LOGIN" or "AUTHENTICATE" commands after making the connection to the
   IMAP server.

   If no user name and no authentication mechanism are supplied, the
   client MUST authenticate as anonymous to the server.  If the server
   advertises AUTH=ANONYMOUS IMAP capability, the client MUST use the
   AUTHENTICATE command with ANONYMOUS [<a href="#ref-ANONYMOUS" title='"Anonymous Simple Authentication and Security Layer (SASL) Mechanism"'>ANONYMOUS</a>] SASL mechanism.  If
   SASL ANONYMOUS is not available, the (case-insensitive) user name
   "anonymous" is used with the "LOGIN" command and the Internet email
   address of the end user accessing the resource is supplied as the
   password.  The latter option is given in order to provide for
   interoperability with deployed servers.

   Note that, as described in <a href="rfc3501.html">RFC 3501</a>, the "LOGIN" command MUST NOT be
   used when the IMAP server advertises the LOGINDISABLED capability.




<span class="grey">Melnikov &amp; Newman           Standards Track                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


   An authentication mechanism (as used by the IMAP AUTHENTICATE
   command) can be expressed by adding ";AUTH=&lt;enc-auth-type&gt;" to the
   end of the user name in an IMAP URL.  When such an &lt;enc-auth-type&gt; is
   indicated, the client SHOULD request appropriate credentials from
   that mechanism and use the "AUTHENTICATE" command instead of the
   "LOGIN" command.  If no user name is specified, one MUST be obtained
   from the mechanism or requested from the user/configuration as
   appropriate.

   The string ";AUTH=*" indicates that the client SHOULD select an
   appropriate authentication mechanism.  (Though the '*' character in
   this usage is not strictly a delimiter, it is being treated like a
   sub-delim [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>] in this instance.  It MUST NOT be percent-encoded
   in this usage, as ";AUTH=%2A" will not match this production.)  It
   MAY use any mechanism listed in the response to the CAPABILITY
   command (or CAPABILITY response code) or use an out-of-band security
   service resulting in a PREAUTH connection.  If no user name is
   specified and no appropriate authentication mechanisms are available,
   the client SHOULD fall back to anonymous login as described above.
   The behavior prescribed in this section allows a URL that grants
   read-write access to authorized users and read-only anonymous access
   to other users.

   If a user name is included with no authentication mechanism, then
   ";AUTH=*" is assumed.

   Clients must take care when resolving a URL that requires or requests
   any sort of authentication, since URLs can easily come from untrusted
   sources.  Supplying authentication credentials to the wrong server
   may compromise the security of the user's account; therefore, the
   program resolving the URL should meet at least one of the following
   criteria in this case:

   1) The URL comes from a trusted source, such as a referral server
      that the client has validated and trusts according to site policy.
      Note that user entry of the URL may or may not count as a trusted
      source, depending on the experience level of the user and site
      policy.

   2) Explicit local site policy permits the client to connect to the
      server in the URL.  For example, a company example.com may have a
      site policy to trust all IMAP server names ending in example.com,
      whereas such a policy would be unwise for example.edu where random
      students can set up IMAP servers.

   3) The user confirms that connecting to that domain name with the
      specified credentials and/or mechanism is permitted.  For example,
      when using "LOGIN" or SASL PLAIN with Transport Layer Security



<span class="grey">Melnikov &amp; Newman           Standards Track                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


      (TLS), the IMAP URL client presents a dialog box "Is it OK to send
      your password to server "example.com"?  Please be aware the owners
      of example.com will be able to reuse your password to connect to
      other servers on your behalf".

   4) A mechanism is used that validates the server before passing
      potentially compromising client credentials.  For example, a site
      has a designated TLS certificate used to certify site-trusted IMAP
      server certificates, and this has been configured explicitly into
      the IMAP URL client.  Another example is use of a Simple
      Authentication and Security Layer (SASL) mechanism such as
      DIGEST-MD5 [<a href="#ref-DIGEST-MD5" title='"Using Digest Authentication as a SASL Mechanism"'>DIGEST-MD5</a>], which supports mutual authentication.

   5) An authentication mechanism is used that will not reveal any
      information to the server that could be used to compromise future
      connections.  Examples are SASL ANONYMOUS [<a href="#ref-ANONYMOUS" title='"Anonymous Simple Authentication and Security Layer (SASL) Mechanism"'>ANONYMOUS</a>] or GSSAPI
      [<a href="#ref-GSSAPI" title='"The Kerberos V5 ("'>GSSAPI</a>].

   URLs that do not include a user name but include an authentication
   mechanism (";AUTH=&lt;mech&gt;") must be treated with extra care, since for
   some &lt;mech&gt;s they are more likely to compromise the user's primary
   account.  A URL containing ";AUTH=*" must also be treated with extra
   care since it might fall back on a weaker security mechanism.
   Finally, clients are discouraged from using a plaintext password as a
   fallback with ";AUTH=*" unless the connection has strong encryption.

   A program interpreting IMAP URLs MAY cache open connections to an
   IMAP server for later reuse.  If a URL contains a user name, only
   connections authenticated as that user may be reused.  If a URL does
   not contain a user name or authentication mechanism, then only an
   anonymous connection may be reused.

   Note that if unsafe or reserved characters such as " " (space) or ";"
   are present in the user name or authentication mechanism, they MUST
   be percent-encoded as described in [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Limitations%20of%20enc-user"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Limitations of enc-user</span>

   As per Sections <a href="#section-3.1">3.1</a> and <a href="#section-3.2">3.2</a> of this document, the IMAP URI enc-user
   has two purposes:

      1) It provides context for user-specific mailbox paths such as
         "INBOX" (<a href="#section-3.1">Section 3.1</a>).

      2) It specifies that resolution of the URL requires logging in as
         that user and limits use of that URL to only that user (<a href="#section-3.2">Section</a>
         <a href="#section-3.2">3.2</a>).




<span class="grey">Melnikov &amp; Newman           Standards Track                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


   An obvious limitation of using the same field for both purposes is
   that the URL can be resolved only by the mailbox owner.  In order to
   avoid this restriction, implementations should use globally unique
   mailbox names (see <a href="#section-3.1">Section 3.1</a>) whenever possible.

      Note: There is currently no general way in IMAP of learning a
      globally unique name for a mailbox.  However, by looking at the
      NAMESPACE [<a href="#ref-NAMESPACE" title='"IMAP4 Namespace"'>NAMESPACE</a>] command result, it is possible to determine
      whether or not a mailbox name is globally unique.

   The URLAUTH component overrides the second purpose of the enc-user in
   the IMAP URI and by default permits the URI to be resolved by any
   user permitted by the &lt;access&gt; identifier.  URLAUTH and &lt;access&gt;
   identifier are described in <a href="#section-6.1">Section 6.1</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20IMAP%20Server"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  IMAP Server</span>

   An IMAP URL referring to an IMAP server has the following form:

      imap://&lt;iserver&gt;[/]

   This URL type is frequently used to describe a location of an IMAP
   server, both in referrals and in configuration.  It may optionally
   contain the &lt;iuserinfo&gt; component (see Sections <a href="#section-3">3</a> and <a href="#section-11">11</a>).  A program
   interpreting this URL would issue the standard set of commands it
   uses to present a view of the content of the IMAP server, as visible
   to the user described by the "enc-user" part of the &lt;iuserinfo&gt;
   component, if the "enc-user" part is specified.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Lists%20of%20Messages"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Lists of Messages</span>

   An IMAP URL referring to a list of messages has the following form:

      imap://&lt;iserver&gt;/&lt;enc-mailbox&gt;[&lt;uidvalidity&gt;][?&lt;enc-search&gt;]

   The &lt;enc-mailbox&gt; field is used as the argument to the IMAP4 "SELECT"
   or "EXAMINE" command.  Note that if unsafe or reserved characters
   such as " " (space), ";", or "?" are present in &lt;enc-mailbox&gt;, they
   MUST be percent-encoded as described in [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>].

   The &lt;uidvalidity&gt; field is optional.  If it is present, it MUST be
   the same as the value of IMAP4 UIDVALIDITY response code at the time
   the URL was created.  This MUST be used by the program interpreting
   the IMAP URL to determine if the URL is stale.  If the IMAP URL is
   stale, then the program should behave as if the corresponding mailbox
   doesn't exist.





<span class="grey">Melnikov &amp; Newman           Standards Track                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


   Note that the &lt;uidvalidity&gt; field is a modifier to the &lt;enc-mailbox&gt;,
   i.e., it is considered a part of the last "component" (as used in
   [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>]) of the &lt;enc-mailbox&gt;.  This is significant during relative
   URI resolution.

   The "?&lt;enc-search&gt;" field is optional.  If it is not present, the
   program interpreting the URL will present the entire content of the
   mailbox.

   If the "?&lt;enc-search&gt;" field is present, the program interpreting the
   URL should use the contents of this field as arguments following an
   IMAP4 SEARCH command.  These arguments are likely to contain unsafe
   characters such as " " (space) (which are likely to be present in the
   &lt;enc-search&gt;).  If unsafe characters are present, they MUST be
   percent-encoded as described in [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>].

   Note that quoted strings and non-synchronizing literals [LITERAL+]
   are allowed in the &lt;enc-search&gt; content; however, synchronizing
   literals are not allowed, as their presence would effectively mean
   that the agent interpreting IMAP URLs needs to parse an &lt;enc-search&gt;
   content, find all synchronizing literals, and perform proper command
   continuation request handling (see Sections <a href="#section-4.3">4.3</a> and <a href="#section-7">7</a> of [<a href="#ref-IMAP4" title='"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1"'>IMAP4</a>]).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20A%20Specific%20Message%20or%20Message%20Part"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  A Specific Message or Message Part</span>

   An IMAP URL referring to a specific message or message part has the
   following form:

      imap://&lt;iserver&gt;/&lt;enc-mailbox&gt;[&lt;uidvalidity&gt;]&lt;iuid&gt;
      [&lt;isection&gt;][&lt;ipartial&gt;][&lt;iurlauth&gt;]

   The &lt;enc-mailbox&gt; and [uidvalidity] are as defined in <a href="#section-5">Section 5</a>
   above.

   If &lt;uidvalidity&gt; is present in this form, it SHOULD be used by the
   program interpreting the URL to determine if the URL is stale.

   The &lt;iuid&gt; refers to an IMAP4 message Unique Identifier (UID), and it
   SHOULD be used as the &lt;set&gt; argument to the IMAP4 "UID FETCH"
   command.

   The &lt;isection&gt; field is optional.  If not present, the URL refers to
   the entire Internet message as returned by the IMAP command "UID
   FETCH &lt;uid&gt; BODY.PEEK[]".  If present, the URL refers to the object
   returned by a "UID FETCH &lt;uid&gt; BODY.PEEK[&lt;section&gt;]" command.  The
   type of the object may be determined by using a "UID FETCH &lt;uid&gt;
   BODYSTRUCTURE" command and locating the appropriate part in the




<span class="grey">Melnikov &amp; Newman           Standards Track                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


   resulting BODYSTRUCTURE.  Note that unsafe characters in [isection]
   MUST be percent-encoded as described in [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>].

   The &lt;ipartial&gt; field is optional.  If present, it effectively appends
   "&lt;&lt;partial-range&gt;&gt;" to the end of the UID FETCH BODY.PEEK[&lt;section&gt;]
   command constructed as described in the previous paragraph.  In other
   words, it allows the client to request a byte range of the
   message/message part.

   The &lt;iurlauth&gt; field is described in detail in <a href="#section-6.1">Section 6.1</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20URLAUTH%20Authorized%20URL"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  URLAUTH Authorized URL</span>

   URLAUTH authorized URLs are only supported by an IMAP server
   advertising the URLAUTH IMAP capability [<a href="#ref-URLAUTH" title='"Internet Message Access Protocol (IMAP) - URLAUTH Extension"'>URLAUTH</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.1.%20%20Concepts"></a><a class="selflink" href="#section-6.1.1" name="section-6.1.1">6.1.1</a>.  Concepts</span>

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.1.1.1.%20%20URLAUTH"></a><a class="selflink" href="#section-6.1.1.1" name="section-6.1.1.1">6.1.1.1</a>.  URLAUTH</span>

   URLAUTH is a component, appended at the end of a URL, that conveys
   authorization to access the data addressed by that URL.  It contains
   an authorized access identifier, an authorization mechanism name, and
   an authorization token.  The authorization token is generated from
   the URL, the authorized access identifier, authorization mechanism
   name, and a mailbox access key.

      Note: This specification only allows for the URLAUTH component in
      IMAP URLs describing a message or its part.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.1.1.2.%20%20Mailbox%20Access%20Key"></a><a class="selflink" href="#section-6.1.1.2" name="section-6.1.1.2">6.1.1.2</a>.  Mailbox Access Key</span>

   The mailbox access key is an unpredictable, random string.  To ensure
   unpredictability, the random string with at least 128 bits of entropy
   is generated by software or hardware (not by the human user).

   Each user has a table of mailboxes and an associated mailbox access
   key for each mailbox.  Consequently, the mailbox access key is per-
   user and per-mailbox.  In other words, two users sharing the same
   mailbox each have a different mailbox access key for that mailbox,
   and each mailbox accessed by a single user also has a different
   mailbox access key.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.1.1.3.%20%20Authorized%20Access%20Identifier"></a><a class="selflink" href="#section-6.1.1.3" name="section-6.1.1.3">6.1.1.3</a>.  Authorized Access Identifier</span>

   The authorized &lt;access&gt; identifier restricts use of the URLAUTH
   authorized URL to certain users authorized on the server, as
   described in <a href="#section-6.1.2">Section 6.1.2</a>.



<span class="grey">Melnikov &amp; Newman           Standards Track                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.1.1.4.%20%20Authorization%20Mechanism"></a><a class="selflink" href="#section-6.1.1.4" name="section-6.1.1.4">6.1.1.4</a>.  Authorization Mechanism</span>

   The authorization mechanism is the algorithm by which the URLAUTH is
   generated and subsequently verified, using the mailbox access key.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.1.1.5.%20%20Authorization%20Token"></a><a class="selflink" href="#section-6.1.1.5" name="section-6.1.1.5">6.1.1.5</a>.  Authorization Token</span>

   The authorization token is a deterministic string of at least 128
   bits that an entity with knowledge of the secret mailbox access key
   and URL authorization mechanism can use to verify the URL.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.2.%20%20URLAUTH%20Extensions%20to%20IMAP%20URL"></a><a class="selflink" href="#section-6.1.2" name="section-6.1.2">6.1.2</a>.  URLAUTH Extensions to IMAP URL</span>

   A specific message or message part IMAP URL can optionally contain
   ";EXPIRE=&lt;datetime&gt;" and/or ";URLAUTH=&lt;access&gt;:&lt;mech&gt;:&lt;token&gt;".

   When ";EXPIRE=&lt;datetime&gt;" is used, this indicates the latest date and
   time that the URL is valid.  After that date and time, the URL has
   expired and server implementations MUST reject the URL.  If
   ";EXPIRE=&lt;datetime&gt;" is not used, the URL has no expiration, but can
   still be revoked using the RESETKEY command [<a href="#ref-URLAUTH" title='"Internet Message Access Protocol (IMAP) - URLAUTH Extension"'>URLAUTH</a>].

   The URLAUTH takes the form ";URLAUTH=&lt;access&gt;:&lt;mech&gt;:&lt;token&gt;", and it
   MUST be at the end of the URL.  It is composed of three parts.  The
   &lt;access&gt; portion provides the authorized access identifiers that may
   constrain the operations and users that are permitted to use this
   URL.  The &lt;mech&gt; portion provides the authorization mechanism used by
   the IMAP server to generate the authorization token that follows.
   The &lt;token&gt; portion provides the authorization token, which can be
   generated using the GENURLAUTH command [<a href="#ref-URLAUTH" title='"Internet Message Access Protocol (IMAP) - URLAUTH Extension"'>URLAUTH</a>].

   The "submit+" &lt;access&gt; identifier prefix, followed by a userid,
   indicates that only a userid authorized as a message submission
   entity on behalf of the specified userid is permitted to use this
   URL.  The IMAP server does not validate the specified userid but does
   validate that the IMAP session has an authorization identity that is
   authorized as a message submission entity.  The authorized message
   submission entity MUST validate the userid prior to contacting the
   IMAP server.

   The "user+" &lt;access&gt; identifier prefix, followed by a userid,
   indicates that use of this URL is limited to IMAP sessions that are
   logged in as the specified userid (that is, have authorization
   identity as that userid).

      Note: If a SASL mechanism that provides both authorization and
      authentication identifiers is used to authenticate to the IMAP
      server, the "user+" &lt;access&gt; identifier MUST match the



<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


      authorization identifier.  If the SASL mechanism can't transport
      the authorization identifier, the "user+" &lt;access&gt; identifier MUST
      match the authorization identifier derived from the authentication
      identifier (see [<a href="#ref-SASL" title='"Simple Authentication and Security Layer (SASL)"'>SASL</a>]).

   The "authuser" &lt;access&gt; identifier indicates that use of this URL is
   limited to authenticated IMAP sessions that are logged in as any
   non-anonymous user (that is, have authorization identity as a non-
   anonymous user) of that IMAP server.  To restate this: use of this
   type of URL is prohibited to anonymous IMAP sessions, i.e., any
   URLFETCH command containing this type of URL issued in an anonymous
   session MUST return NIL in the URLFETCH response.

   The "anonymous" &lt;access&gt; identifier indicates that use of this URL is
   not restricted by session authorization identity; that is, any IMAP
   session in authenticated or selected state (as defined in [<a href="#ref-IMAP4" title='"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1"'>IMAP4</a>]),
   including anonymous sessions, may issue a URLFETCH [<a href="#ref-URLAUTH" title='"Internet Message Access Protocol (IMAP) - URLAUTH Extension"'>URLAUTH</a>] using
   this URL.

   The authorization token is represented as an ASCII-encoded
   hexadecimal string, which is used to authorize the URL.  The length
   and the calculation of the authorization token depend upon the
   mechanism used, but in all cases, the authorization token is at least
   128 bits (and therefore at least 32 hexadecimal digits).

   Example:

      &lt;imap://joe@example.com/INBOX/;uid=20/;section=1.2;urlauth=
      submit+fred:internal:91354a473744909de610943775f92038&gt;

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Relative%20IMAP%20URLs"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Relative IMAP URLs</span>

   Relative IMAP URLs are permitted and are resolved according to the
   rules defined in [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>].  In particular, in IMAP URLs parameters
   (such as ";uid=" or ";section=") are treated as part of the normal
   path with respect to relative URL resolution.

   [<a id="ref-URI-GEN" name="ref-URI-GEN">URI-GEN</a>] defines four forms of relative URLs: &lt;inetwork-path&gt;,
   &lt;iabsolute-path&gt;, &lt;irelative-path&gt;, and &lt;ipath-empty&gt;.  Their syntax
   is defined in <a href="#section-11">Section 11</a>.

   A relative reference that begins with two slash characters is termed
   a network-path reference (&lt;inetwork-path&gt;); such references are
   rarely used, because in most cases they can be replaced with an
   equivalent absolute URL.  A relative reference that begins with a
   single slash character is termed an absolute-path reference
   (&lt;iabsolute-path&gt;; see also <a href="#section-7.1">Section 7.1</a>).  A relative reference that
   does not begin with a slash character is termed a relative-path



<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


   reference (&lt;irelative-path&gt;; see also <a href="#section-7.2">Section 7.2</a>).  The final form
   is &lt;ipath-empty&gt;, which is "same-document reference" (see Section 4.4
   of [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>]).

   The following observations about relative URLs are important:

   The &lt;iauth&gt; grammar element (which is a part of &lt;iuserinfo&gt;, which
   is, in turn, a part of &lt;iserver&gt;; see <a href="#section-3">Section 3</a>) is considered part
   of the user name for purposes of resolving relative IMAP URLs.  This
   means that unless a new user name/server specification is included in
   the relative URL, the authentication mechanism is inherited from the
   base IMAP URL.

   URLs always use "/" as the hierarchy delimiter for the purpose of
   resolving paths in relative URLs.  IMAP4 permits the use of any
   hierarchy delimiter in mailbox names.  For this reason, relative
   mailbox paths will only work if the mailbox uses "/" as the hierarchy
   delimiter.  Relative URLs may be used on mailboxes that use other
   delimiters, but in that case, the entire mailbox name MUST be
   specified in the relative URL or inherited as a whole from the base
   URL.

   If an IMAP server allows for mailbox names starting with "./" or
   "../", ending with "/." or "/..", or containing sequences "/../" or
   "/./", then such mailbox names MUST be percent-encoded as described
   in [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>].  Otherwise, they would be misinterpreted as dot-
   segments (see Section 3.3 of [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>]), which are processed
   specially during the relative path resolution process.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20absolute-path%20References"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  absolute-path References</span>

   A relative reference that begins with a single slash character is
   termed an absolute-path reference (see Section 4.2 of [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>]).  If
   an IMAP server permits mailbox names with a leading "/", then the
   leading "/" MUST be percent-encoded as described in [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>].
   Otherwise, the produced absolute-path reference URI will be
   misinterpreted as a network-path reference [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>] described by the
   &lt;inetwork-path&gt; non-terminal.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20relative-path%20References"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  relative-path References</span>

   A relative reference that does not begin with a slash character is
   termed a relative-path reference [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>].  Implementations MUST NOT
   generate or accept relative-path IMAP references.

   See also Section 4.2 of [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>] for restrictions on relative-path
   references.




<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Internationalization%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Internationalization Considerations</span>

   IMAP4, <a href="#section-5.1.3">Section 5.1.3</a> [<a href="#ref-IMAP4" title='"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1"'>IMAP4</a>] includes a convention for encoding non-
   US-ASCII characters in IMAP mailbox names.  Because this convention
   is private to IMAP, it is necessary to convert IMAP's encoding to one
   that can be more easily interpreted by a URL display program.  For
   this reason, IMAP's modified UTF-7 encoding for mailboxes MUST be
   converted to UTF-8 [<a href="#ref-UTF-8" title='"UTF-8, a transformation format of ISO 10646"'>UTF-8</a>].  Since 8-bit octets are not permitted in
   URLs, the UTF-8 octets are percent-encoded as required by the URL
   specification [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>], Section 2.1.  Sample code is included in
   <a href="#appendix-A">Appendix A</a> to demonstrate this conversion.

   IMAP user names are UTF-8 strings and MUST be percent-encoded as
   required by the URL specification [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>], Section 2.1.

   Also note that IMAP SEARCH criteria can contain non-US-ASCII
   characters.  8-bit octets in those strings MUST be percent-encoded as
   required by the URL specification [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>], Section 2.1.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Examples"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Examples</span>

   The following examples demonstrate how an IMAP4 client program might
   translate various IMAP4 URLs into a series of IMAP4 commands.
   Commands sent from the client to the server are prefixed with "C:",
   and responses sent from the server to the client are prefixed with
   "S:".

   The URL:

      &lt;imap://minbari.example.org/gray-council;UIDVALIDITY=385759045/;
      UID=20/;PARTIAL=0.1024&gt;

   may result in the following client commands and server responses:

      &lt;connect to minbari.example.org, port 143&gt;
      S: * OK [CAPABILITY IMAP4rev1 STARTTLS AUTH=ANONYMOUS] Welcome
      C: A001 AUTHENTICATE ANONYMOUS
      S: +
      C: c2hlcmlkYW5AYmFieWxvbjUuZXhhbXBsZS5vcmc=
      S: A001 OK Welcome sheridan@babylon5.example.org
      C: A002 SELECT gray-council
      &lt;client verifies the UIDVALIDITY matches&gt;
      C: A003 UID FETCH 20 BODY.PEEK[]&lt;0.1024&gt;

   The URL:

      &lt;imap://psicorp.example.org/~peter/%E6%97%A5%E6%9C%AC%E8%AA%9E/
      %E5%8F%B0%E5%8C%97&gt;



<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


   may result in the following client commands:

      &lt;connect to psicorp.example.org, port 143&gt;
      S: * OK [CAPABILITY IMAP4rev1 STARTTLS AUTH=CRAM-MD5] Welcome
      C: A001 LOGIN ANONYMOUS bester@psycop.psicorp.example.org
      C: A002 SELECT ~peter/&amp;ZeVnLIqe-/&amp;U,BTFw-
      &lt;commands the client uses for viewing the contents of
       the mailbox&gt;

   The URL:

      &lt;imap://;AUTH=GSSAPI@minbari.example.org/gray-council/;uid=20/
      ;section=1.2&gt;

   may result in the following client commands:

      &lt;connect to minbari.example.org, port 143&gt;
      S: * OK Greetings
      C: A000 CAPABILITY
      S: * CAPABILITY IMAP4rev1 STARTTLS AUTH=GSSAPI
      S: A000 OK
      C: A001 AUTHENTICATE GSSAPI
      &lt;authentication exchange&gt;
      C: A002 SELECT gray-council
      C: A003 UID FETCH 20 BODY.PEEK[1.2]

   If the following relative URL is located in that body part:

      &lt;;section=1.4&gt;

   this could result in the following client commands:

      C: A004 UID FETCH 20 (BODY.PEEK[1.2.MIME]
            BODY.PEEK[1.MIME]
            BODY.PEEK[HEADER.FIELDS (Content-Location)])
      &lt;Client looks for Content-Location headers in
       result.  If no such headers, then it does the following&gt;
      C: A005 UID FETCH 20 BODY.PEEK[1.4]

   The URL:

      &lt;imap://;AUTH=*@minbari.example.org/gray%20council?
      SUBJECT%20shadows&gt;








<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


   could result in the following:

      &lt;connect to minbari.example.org, port 143&gt;
      S: * OK Welcome
      C: A001 CAPABILITY
      S: * CAPABILITY IMAP4rev1 AUTH=DIGEST-MD5
      S: A001 OK
      C: A002 AUTHENTICATE DIGEST-MD5
      &lt;authentication exchange&gt;
      S: A002 OK user lennier authenticated
      C: A003 SELECT "gray council"
      ...
      C: A004 SEARCH SUBJECT shadows
      S: * SEARCH 8 10 13 14 15 16
      S: A004 OK SEARCH completed
      C: A005 FETCH 8,10,13:16 ALL
      ...

   In the example above, the client has implementation-dependent
   choices.  The authentication mechanism could be anything, including
   PREAUTH.  The final FETCH command could fetch more or less
   information about the messages, depending on what it wishes to
   display to the user.

   The URL:

      &lt;imap://john;AUTH=*@minbari.example.org/babylon5/personel?
      charset%20UTF-8%20SUBJECT%20%7B14+%7D%0D%0A%D0%98%D0%B2%
      D0%B0%D0%BD%D0%BE%D0%B2%D0%B0&gt;

   shows that 8-bit data can be sent using non-synchronizing literals
   [LITERAL+].  This could result in the following:

      &lt;connect to minbari.example.org, port 143&gt;
      S: * OK Hi there
      C: A001 CAPABILITY
      S: * CAPABILITY IMAP4rev1 LITERAL+ AUTH=DIGEST-MD5
      S: A001 OK
      C: A002 AUTHENTICATE DIGEST-MD5
      &lt;authentication exchange&gt;
      S: A002 OK user john authenticated
      C: A003 SELECT babylon5/personel
      ...
      C: A004 SEARCH CHARSET UTF-8 SUBJECT {14+}
      C: XXXXXXXXXXXXXX
      S: * SEARCH 7 10 12
      S: A004 OK SEARCH completed
      C: A005 FETCH 7,10,12 ALL



<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


      ...

   where XXXXXXXXXXXXXX is 14 bytes of UTF-8 encoded data as specified
   in the URL above.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20Examples%20of%20Relative%20URLs"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  Examples of Relative URLs</span>

   The following absolute-path reference

      &lt;/foo/;UID=20/..&gt;

   is the same as

      &lt;/foo&gt;

   That is, both of them reference the mailbox "foo" located on the IMAP
   server described by the corresponding Base URI.

   The following relative-path reference

      &lt;;UID=20&gt;

   references a message with UID in the mailbox specified by the Base
   URI.

   The following edge case example demonstrates that the ;UIDVALIDITY=
   modifier is a part of the mailbox name as far as relative URI
   resolution is concerned:

      &lt;..;UIDVALIDITY=385759045/;UID=20&gt;

   In this example, ".." is not a dot-segment [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Security%20Considerations"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Security Considerations</span>

   Security considerations discussed in the IMAP specification [<a href="#ref-IMAP4" title='"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1"'>IMAP4</a>]
   and the URI specification [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>] are relevant.  Security
   considerations related to authenticated URLs are discussed in <a href="#section-3.2">Section</a>
   <a href="#section-3.2">3.2</a> of this document.

   Many email clients store the plaintext password for later use after
   logging into an IMAP server.  Such clients MUST NOT use a stored
   password in response to an IMAP URL without explicit permission from
   the user to supply that password to the specified host name.

   Clients resolving IMAP URLs that wish to achieve data confidentiality
   and/or integrity SHOULD use the STARTTLS command (if supported by the




<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


   server) before starting authentication, or use a SASL mechanism, such
   as GSSAPI, that provides a confidentiality security layer.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Security%20Consideration%20Specific%20to%20URLAUTH%20Authorized%20URL"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Security Consideration Specific to URLAUTH Authorized URL</span>

   The "user+&lt;userid&gt;" &lt;access&gt; identifier limits resolution of that URL
   to a particular userid, whereas the "submit+&lt;userid&gt;" &lt;access&gt;
   identifier is more general and simply requires that the session be
   authorized by a user that has been granted a "submit" role within the
   authentication system.  Use of either of these mechanisms limits the
   scope of the URL.  An attacker who cannot authenticate using the
   appropriate credentials cannot make use of the URL.

   The "authuser" and "anonymous" &lt;access&gt; identifiers do not have this
   level of protection.  These access identifiers are primarily useful
   for public export of data from an IMAP server, without requiring that
   it be copied to a web or anonymous FTP server.

   The decision to use the "authuser" &lt;access&gt; identifier should be made
   with caution.  An "authuser" &lt;access&gt; identifier can be used by any
   authorized user of the IMAP server; therefore, use of this access
   identifier should be limited to content that may be disclosed to any
   authorized user of the IMAP server.

   The decision to use the "anonymous" &lt;access&gt; identifier should be
   made with extreme caution.  An "anonymous" &lt;access&gt; identifier can be
   used by anyone; therefore, use of this access identifier should be
   limited to content that may be disclosed to anyone.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20ABNF%20for%20IMAP%20URL%20Scheme"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  ABNF for IMAP URL Scheme</span>

   Formal syntax is defined using ABNF [<a href="#ref-ABNF" title='"Augmented BNF for Syntax Specifications: ABNF"'>ABNF</a>], extending the ABNF rules
   in Section 9 of [<a href="#ref-IMAP4" title='"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1"'>IMAP4</a>].  Elements not defined here can be found in
   [<a href="#ref-ABNF" title='"Augmented BNF for Syntax Specifications: ABNF"'>ABNF</a>], [<a href="#ref-IMAP4" title='"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1"'>IMAP4</a>], [<a href="#ref-IMAPABNF" title='"Collected Extensions to IMAP4 ABNF"'>IMAPABNF</a>], or [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>].  Strings are not case
   sensitive, and free insertion of linear white space is not permitted.

   sub-delims-sh = "!" / "$" / "'" / "(" / ")" /
                   "*" / "+" / ","
                      ;; Same as [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>] sub-delims,
                      ;; but without ";", "&amp;" and "=".

   uchar            = unreserved / sub-delims-sh / pct-encoded

   achar            = uchar / "&amp;" / "="
                      ;; Same as [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>] 'unreserved / sub-delims /
                      ;; pct-encoded', but ";" is disallowed.

   bchar            = achar / ":" / "@" / "/"



<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


   enc-auth-type    = 1*achar
                   ; %-encoded version of [<a href="#ref-IMAP4" title='"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1"'>IMAP4</a>] "auth-type"

   enc-mailbox      = 1*bchar
                  ; %-encoded version of [<a href="#ref-IMAP4" title='"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1"'>IMAP4</a>] "mailbox"

   enc-search       = 1*bchar
                           ; %-encoded version of [<a href="#ref-IMAPABNF" title='"Collected Extensions to IMAP4 ABNF"'>IMAPABNF</a>]
                           ; "search-program".  Note that IMAP4
                           ; literals may not be used in
                           ; a "search-program", i.e., only
                           ; quoted or non-synchronizing
                           ; literals (if the server supports
                           ; LITERAL+ [LITERAL+]) are allowed.

   enc-section      = 1*bchar
                  ; %-encoded version of [<a href="#ref-IMAP4" title='"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1"'>IMAP4</a>] "section-spec"

   enc-user         = 1*achar
                  ; %-encoded version of [<a href="#ref-IMAP4" title='"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1"'>IMAP4</a>] authorization
                  ; identity or "userid".

   imapurl          = "imap://" iserver ipath-query
               ; Defines an absolute IMAP URL

   ipath-query      = ["/" [ icommand ]]
                    ; Corresponds to "path-abempty [ "?" query ]"
                    ; in [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>]

   Generic syntax for relative URLs is defined in Section 4.2 of
   [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>].  For ease of implementation, the relative IMAP URL syntax
   is defined below:

   imapurl-rel     = inetwork-path

                     / iabsolute-path
                     / irelative-path
                     / ipath-empty

   inetwork-path   = "//" iserver ipath-query
               ; Corresponds to '"//" authority path-abempty
               ; [ "?" query ]' in [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>]

   iabsolute-path  = "/" [ icommand ]
               ; icommand, if present, MUST NOT start with '/'.
               ;
               ; Corresponds to 'path-absolute [ "?" query ]'
               ; in [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>]



<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


   irelative-path  = imessagelist /
                     imsg-or-part
               ; Corresponds to 'path-noscheme [ "?" query ]'
               ; in [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>]

   imsg-or-part    = ( imailbox-ref "/" iuid-only ["/" isection-only]
                       ["/" ipartial-only] ) /
                     ( iuid-only ["/" isection-only]
                       ["/" ipartial-only] ) /
                     ( isection-only ["/" ipartial-only] ) /
                     ipartial-only

   ipath-empty     = 0&lt;pchar&gt;
                    ; Zero characters.
                    ; The same-document reference.

   The following three rules are only used in the presence of the IMAP
   [<a href="#ref-URLAUTH" title='"Internet Message Access Protocol (IMAP) - URLAUTH Extension"'>URLAUTH</a>] extension:

   authimapurl     = "imap://" iserver "/" imessagepart
                     ; Same as "imapurl" when "[icommand]" is
                     ; "imessagepart"

   authimapurlfull = authimapurl iurlauth
                     ; Same as "imapurl" when "[icommand]" is
                     ; "imessagepart iurlauth"

   authimapurlrump = authimapurl iurlauth-rump


   enc-urlauth     = 32*HEXDIG

   iurlauth        = iurlauth-rump iua-verifier

   iua-verifier    = ":" uauth-mechanism ":" enc-urlauth

   iurlauth-rump   = [expire] ";URLAUTH=" access

   access          = ("submit+" enc-user) / ("user+" enc-user) /
                       "authuser" / "anonymous"

   expire          = ";EXPIRE=" date-time
                         ; date-time is defined in [<a href="#ref-DATETIME" title='"Date and Time on the Internet: Timestamps"'>DATETIME</a>]

   uauth-mechanism = "INTERNAL" / 1*(ALPHA / DIGIT / "-" / ".")
                        ; Case-insensitive.
                        ; New mechanisms MUST be registered with IANA.




<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


   iauth            = ";AUTH=" ( "*" / enc-auth-type )

   icommand         = imessagelist /
                      imessagepart [iurlauth]

   imailbox-ref     = enc-mailbox [uidvalidity]

   imessagelist     = imailbox-ref [ "?" enc-search ]
                  ; "enc-search" is [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>] "query".

   imessagepart     = imailbox-ref iuid [isection] [ipartial]

   ipartial         = "/" ipartial-only

   ipartial-only    = ";PARTIAL=" partial-range

   isection         = "/" isection-only

   isection-only    = ";SECTION=" enc-section

   iserver          = [iuserinfo "@"] host [ ":" port ]
                           ; This is the same as "authority" defined
                           ; in [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>].  See [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>] for "host"
                           ; and "port" definitions.

   iuid             = "/" iuid-only

   iuid-only        = ";UID=" nz-number
                  ; See [<a href="#ref-IMAP4" title='"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1"'>IMAP4</a>] for "nz-number" definition

   iuserinfo        = enc-user [iauth] / [enc-user] iauth
                                ; conforms to the generic syntax of
                                ; "userinfo" as defined in [<a href="#ref-URI-GEN" title='"Uniform Resource Identifier (URI): Generic Syntax"'>URI-GEN</a>].

   partial-range    = number ["." nz-number]
                  ; partial FETCH.  The first number is
                           ; the offset of the first byte,
                           ; the second number is the length of
                           ; the fragment.

   uidvalidity      = ";UIDVALIDITY=" nz-number
                       ; See [<a href="#ref-IMAP4" title='"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1"'>IMAP4</a>] for "nz-number" definition









<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/12.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-12" name="section-12">12</a>.  IANA Considerations</span>

   IANA has updated the "imap" definition in the "Uniform Resource
   Identifier scheme registry" to point to this document.

   The registration template (as per [<a href="#ref-URI-REG" title='"Guidelines and Registration Procedures for New URI Schemes"'>URI-REG</a>]) is specified in <a href="#section-12.1">Section</a>
   <a href="#section-12.1">12.1</a> of this document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.1.%20%20IANA%20Registration%20of%20imap%3A%20URI%20Scheme"></a><a class="selflink" href="#section-12.1" name="section-12.1">12.1</a>.  IANA Registration of imap: URI Scheme</span>

   This section provides the information required to register the imap:
   URI scheme.

   URI scheme name: imap

   Status: permanent

   URI scheme syntax:

      See <a href="rfc5092.html#section-11">Section 11 of [RFC5092]</a>.

   URI scheme semantics:

      The imap: URI scheme is used to designate IMAP servers, mailboxes,
      messages, MIME bodies [<a href="#ref-MIME" title='"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"'>MIME</a>] and their parts, and search programs
      on Internet hosts accessible using the IMAP protocol.

      There is no MIME type associated with this URI.

   Encoding considerations:

      See <a href="rfc5092.html#section-8">Section 8 of [RFC5092]</a>.

   Applications/protocols that use this URI scheme name:

      The imap: URI is intended to be used by applications that might
      need access to an IMAP mailstore.  Such applications may include
      (but are not limited to) IMAP-capable web browsers; IMAP clients
      that wish to access a mailbox, message, or edit a message on the
      server using [<a href="#ref-CATENATE" title='"Internet Message Access Protocol (IMAP) CATENATE Extension"'>CATENATE</a>]; [<a href="#ref-SUBMIT" title='"Message Submission for Mail"'>SUBMIT</a>] clients and servers that are
      requested to assemble a complete message on submission using
      [<a href="#ref-BURL" title='"Message Submission BURL Extension"'>BURL</a>].

   Interoperability considerations:

      A widely deployed IMAP client Netscape Mail (and possibly
      Mozilla/Thunderbird/Seamonkey) uses a different imap: scheme
      internally.



<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


   Security considerations:

      See Security Considerations (<a href="#section-10">Section 10</a>) of [<a href="rfc5092.html">RFC5092</a>].

   Contact:

      Alexey Melnikov &lt;alexey.melnikov@isode.com&gt;

   Author/Change controller:

      IESG

   References:

      [<a id="ref-RFC5092" name="ref-RFC5092">RFC5092</a>] and [<a href="#ref-IMAP4" title='"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1"'>IMAP4</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/13.%20References"></a><a class="selflink" href="#section-13" name="section-13">13</a>. References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/13.1.%20%20Normative%20References"></a><a class="selflink" href="#section-13.1" name="section-13.1">13.1</a>.  Normative References</span>

   [<a id="ref-KEYWORDS" name="ref-KEYWORDS">KEYWORDS</a>]   Bradner, S., "Key words for use in RFCs to Indicate
                Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-IMAP4" name="ref-IMAP4">IMAP4</a>]      Crispin, M., "INTERNET MESSAGE ACCESS PROTOCOL - VERSION
                4rev1", <a href="rfc3501.html">RFC 3501</a>, March 2003.

   [<a id="ref-IMAPABNF" name="ref-IMAPABNF">IMAPABNF</a>]   Melnikov, A. and C. Daboo, "Collected Extensions to
                IMAP4 ABNF", <a href="rfc4466.html">RFC 4466</a>, April 2006.

   [<a id="ref-ABNF" name="ref-ABNF">ABNF</a>]       Crocker, D., Ed., and P. Overell, "Augmented BNF for
                Syntax Specifications: ABNF", <a href="rfc4234.html">RFC 4234</a>, October 2005.

   [<a id="ref-MIME" name="ref-MIME">MIME</a>]       Freed, N. and N. Borenstein, "Multipurpose Internet Mail
                Extensions (MIME) Part One: Format of Internet Message
                Bodies", <a href="rfc2045.html">RFC 2045</a>, November 1996.

   [<a id="ref-URI-GEN" name="ref-URI-GEN">URI-GEN</a>]    Berners-Lee, T., Fielding, R., and L. Masinter, "Uniform
                Resource Identifier (URI): Generic Syntax", STD 66, <a href="rfc3986.html">RFC</a>
                <a href="rfc3986.html">3986</a>, January 2005.

   [<a id="ref-UTF-8" name="ref-UTF-8">UTF-8</a>]      Yergeau, F., "UTF-8, a transformation format of ISO
                10646", STD 63, <a href="rfc3629.html">RFC 3629</a>, November 2003.

   [<a id="ref-NAMESPACE" name="ref-NAMESPACE">NAMESPACE</a>]  Gahrns, M. and C. Newman, "IMAP4 Namespace", <a href="rfc2342.html">RFC 2342</a>,
                May 1998.

   [LITERAL+]   Myers, J., "IMAP4 non-synchronizing literals", <a href="rfc2088.html">RFC 2088</a>,
                January 1997.



<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


   [<a id="ref-ANONYMOUS" name="ref-ANONYMOUS">ANONYMOUS</a>]  Zeilenga, K., "Anonymous Simple Authentication and
                Security Layer (SASL) Mechanism", <a href="rfc4505.html">RFC 4505</a>, June 2006.

   [<a id="ref-DATETIME" name="ref-DATETIME">DATETIME</a>]   Klyne, G. and C. Newman, "Date and Time on the Internet:
                Timestamps", <a href="rfc3339.html">RFC 3339</a>, July 2002.

   [<a id="ref-URLAUTH" name="ref-URLAUTH">URLAUTH</a>]    Crispin, M., "Internet Message Access Protocol (IMAP) -
                URLAUTH Extension", <a href="rfc4467.html">RFC 4467</a>, May 2006.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/13.2.%20%20Informative%20References"></a><a class="selflink" href="#section-13.2" name="section-13.2">13.2</a>.  Informative References</span>

   [<a id="ref-SUBMIT" name="ref-SUBMIT">SUBMIT</a>]     Gellens, R. and J. Klensin, "Message Submission for
                Mail", <a href="rfc4409.html">RFC 4409</a>, April 2006.

   [<a id="ref-BURL" name="ref-BURL">BURL</a>]       Newman, C., "Message Submission BURL Extension", <a href="rfc4468.html">RFC</a>
                <a href="rfc4468.html">4468</a>, May 2006.

   [<a id="ref-CATENATE" name="ref-CATENATE">CATENATE</a>]   Resnick, P., "Internet Message Access Protocol (IMAP)
                CATENATE Extension", <a href="rfc4469.html">RFC 4469</a>, April 2006.

   [<a id="ref-SASL" name="ref-SASL">SASL</a>]       Melnikov, A., Ed., and K. Zeilenga, Ed., "Simple
                Authentication and Security Layer (SASL)", <a href="rfc4422.html">RFC 4422</a>,
                June 2006.

   [<a id="ref-GSSAPI" name="ref-GSSAPI">GSSAPI</a>]     Melnikov, A., Ed., "The Kerberos V5 ("GSSAPI") Simple
                Authentication and Security Layer (SASL) Mechanism", <a href="rfc4752.html">RFC</a>
                <a href="rfc4752.html">4752</a>, November 2006.

   [<a id="ref-DIGEST-MD5" name="ref-DIGEST-MD5">DIGEST-MD5</a>] Leach, P. and C. Newman, "Using Digest Authentication as
                a SASL Mechanism", <a href="rfc2831.html">RFC 2831</a>, May 2000.

   [<a id="ref-URI-REG" name="ref-URI-REG">URI-REG</a>]    Hansen, T., Hardie, T., and L. Masinter, "Guidelines and
                Registration Procedures for New URI Schemes", <a href="https://tools.ietf.org/html/bcp115">BCP 115</a>,
                <a href="rfc4395.html">RFC 4395</a>, February 2006.

















<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Sample%20Code"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Sample Code</span>

   Here is sample C source code to convert between URL paths and IMAP
   mailbox names, taking into account mapping between IMAP's modified
   UTF-7 [<a href="#ref-IMAP4" title='"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1"'>IMAP4</a>] and hex-encoded UTF-8, which is more appropriate for
   URLs.  This code has not been rigorously tested nor does it
   necessarily behave reasonably with invalid input, but it should serve
   as a useful example.  This code just converts the mailbox portion of
   the URL and does not deal with parameters, query, or server
   components of the URL.

/* Copyright (C) The IETF Trust (2007).  This version of
   sample C code is part of RFC XXXX; see the RFC itself
   for full legal notices.

   Regarding this sample C code (or any portion of it), the authors
   make no guarantees and are not responsible for any damage
   resulting from its use.  The authors grant irrevocable permission
   to anyone to use, modify, and distribute it in any way that does
   not diminish the rights of anyone else to use, modify, and
   distribute it, provided that redistributed derivative works do
   not contain misleading author or version information.

   Derivative works need not be licensed under similar terms.
 */

#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

/* hexadecimal lookup table */
static const char hex[] = "0123456789ABCDEF";

#define XX 127
/*
 * Table for decoding hexadecimal in %encoding
 */
static const char index_hex[256] = {
    XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX,
    XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX,
    XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX,
     0, 1, 2, 3,  4, 5, 6, 7,  8, 9,XX,XX, XX,XX,XX,XX,
    XX,10,11,12, 13,14,15,XX, XX,XX,XX,XX, XX,XX,XX,XX,
    XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX,
    XX,10,11,12, 13,14,15,XX, XX,XX,XX,XX, XX,XX,XX,XX,
    XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX,
    XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX,
    XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX,
    XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX,



<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


    XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX,
    XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX,
    XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX,
    XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX,
    XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX, XX,XX,XX,XX,
};
#define HEXCHAR(c)  (index_hex[(unsigned char)(c)])

/* "gen-delims" excluding "/" but including "%" */
#define GENERAL_DELIMS_NO_SLASH     ":?#[]@" "%"

/* "gen-delims" (excluding "/", but including "%")
   plus subset of "sub-delims" */
#define GENERAL_UNSAFE_NO_SLASH     GENERAL_DELIMS_NO_SLASH ";&amp;=+"
#define OTHER_UNSAFE                " \"&lt;&gt;\\^`{|}"

/* URL unsafe printable characters */
static const char mailbox_url_unsafe[] = GENERAL_UNSAFE_NO_SLASH
                                         OTHER_UNSAFE;

/* UTF7 modified base64 alphabet */
static const char base64chars[] =
  "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+,";

#define UNDEFINED 64

/* UTF16 definitions */
#define UTF16MASK   0x03FFUL
#define UTF16SHIFT  10
#define UTF16BASE   0x10000UL
#define UTF16HIGHSTART   0xD800UL
#define UTF16HIGHEND     0xDBFFUL
#define UTF16LOSTART     0xDC00UL
#define UTF16LOEND  0xDFFFUL

/* Convert an IMAP mailbox to a URL path
 *  dst needs to have roughly 4 times the storage space of src
 *    Hex encoding can triple the size of the input
 *    UTF-7 can be slightly denser than UTF-8
 *     (worst case: 8 octets UTF-7 becomes 9 octets UTF-8)
 */
void MailboxToURL(char *dst, char *src)
{
    unsigned char c, i, bitcount;
    unsigned long ucs4, utf16, bitbuf;
    unsigned char base64[256], utf8[6];

    /* initialize modified base64 decoding table */



<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


    memset(base64, UNDEFINED, sizeof (base64));
    for (i = 0; i &lt; sizeof (base64chars); ++i) {
     base64[(int) base64chars[i]] = i;
    }

    /* loop until end of string */
    while (*src != '\0') {
     c = *src++;
     /* deal with literal characters and &amp;- */
     if (c != '&amp;' || *src == '-') {
         /* NB: There are no "URL safe" characters after the '~' */
         if (c &lt; ' ' || c &gt; '~' ||
             strchr(mailbox_url_unsafe, c) != NULL) {
          /* hex encode if necessary */
          dst[0] = '%';
          dst[1] = hex[c &gt;&gt; 4];
          dst[2] = hex[c &amp; 0x0f];
          dst += 3;
         } else {
          /* encode literally */
          *dst++ = c;
         }
         /* skip over the '-' if this is an &amp;- sequence */
         if (c == '&amp;') ++src;

     } else {
        /* convert modified UTF-7 -&gt; UTF-16 -&gt; UCS-4 -&gt; UTF-8 -&gt; HEX */
         bitbuf = 0;
         bitcount = 0;
         ucs4 = 0;
         while ((c = base64[(unsigned char) *src]) != UNDEFINED) {
          ++src;
          bitbuf = (bitbuf &lt;&lt; 6) | c;
          bitcount += 6;
          /* enough bits for a UTF-16 character? */
          if (bitcount &gt;= 16) {
              bitcount -= 16;
              utf16 = (bitcount ? bitbuf &gt;&gt; bitcount
                             : bitbuf) &amp; 0xffff;
              /* convert UTF16 to UCS4 */
              if
                    (utf16 &gt;= UTF16HIGHSTART &amp;&amp; utf16 &lt;= UTF16HIGHEND) {
               ucs4 = (utf16 - UTF16HIGHSTART) &lt;&lt; UTF16SHIFT;
               continue;
              } else if
                    (utf16 &gt;= UTF16LOSTART &amp;&amp; utf16 &lt;= UTF16LOEND) {
               ucs4 += utf16 - UTF16LOSTART + UTF16BASE;
              } else {



<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


               ucs4 = utf16;
              }
              /* convert UTF-16 range of UCS4 to UTF-8 */
              if (ucs4 &lt;= 0x7fUL) {
               utf8[0] = (unsigned char) ucs4;
               i = 1;
              } else if (ucs4 &lt;= 0x7ffUL) {
               utf8[0] = 0xc0 | (unsigned char) (ucs4 &gt;&gt; 6);
               utf8[1] = 0x80 | (unsigned char) (ucs4 &amp; 0x3f);
               i = 2;
              } else if (ucs4 &lt;= 0xffffUL) {
               utf8[0] = 0xe0 | (unsigned char) (ucs4 &gt;&gt; 12);
               utf8[1] = 0x80 | (unsigned char) ((ucs4 &gt;&gt; 6) &amp; 0x3f);
               utf8[2] = 0x80 | (unsigned char) (ucs4 &amp; 0x3f);
               i = 3;
              } else {
               utf8[0] = 0xf0 | (unsigned char) (ucs4 &gt;&gt; 18);
               utf8[1] = 0x80 | (unsigned char) ((ucs4 &gt;&gt; 12) &amp; 0x3f);
               utf8[2] = 0x80 | (unsigned char) ((ucs4 &gt;&gt; 6) &amp; 0x3f);
               utf8[3] = 0x80 | (unsigned char) (ucs4 &amp; 0x3f);
               i = 4;
              }
              /* convert utf8 to hex */
              for (c = 0; c &lt; i; ++c) {
               dst[0] = '%';
               dst[1] = hex[utf8[c] &gt;&gt; 4];
               dst[2] = hex[utf8[c] &amp; 0x0f];
               dst += 3;
              }
          }
         }
         /* skip over trailing '-' in modified UTF-7 encoding */
         if (*src == '-') ++src;
     }
    }
    /* terminate destination string */
    *dst = '\0';
}

/* Convert hex coded UTF-8 URL path to modified UTF-7 IMAP mailbox
 *  dst should be about twice the length of src to deal with non-hex
 *  coded URLs
 */
int URLtoMailbox(char *dst, char *src)
{
    unsigned int utf8pos = 0;
    unsigned int utf8total, i, c, utf7mode, bitstogo, utf16flag;
    unsigned long ucs4 = 0, bitbuf = 0;



<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


    utf7mode = 0; /* is the output UTF7 currently in base64 mode? */
    utf8total = 0; /* how many octets is the current input UTF-8 char;
                      0 == between characters */
    bitstogo = 0; /* bits that need to be encoded into base64; if
                     bitstogo != 0 then utf7mode == 1 */
    while ((c = (unsigned char)*src) != '\0') {
     ++src;
     /* undo hex-encoding */
     if (c == '%' &amp;&amp; src[0] != '\0' &amp;&amp; src[1] != '\0') {
         c = HEXCHAR(src[0]);
         i = HEXCHAR(src[1]);
         if (c == XX || i == XX) {
             return 0;
         } else {
             c = (char)((c &lt;&lt; 4) | i);
         }
         src += 2;
     }
     /* normal character? */
     if (c &gt;= ' ' &amp;&amp; c &lt;= '~') {
         /* switch out of UTF-7 mode */
         if (utf7mode) {
          if (bitstogo) {
          *dst++ = base64chars[(bitbuf &lt;&lt; (6 - bitstogo)) &amp; 0x3F];
          }
          *dst++ = '-';
          utf7mode = 0;
          bitstogo = bitbuf = 0;
         }
         *dst++ = c;
         /* encode '&amp;' as '&amp;-' */
         if (c == '&amp;') {
          *dst++ = '-';
         }
         continue;
     }
     /* switch to UTF-7 mode */
     if (!utf7mode) {
         *dst++ = '&amp;';
         utf7mode = 1;
     }
     /* Encode US-ASCII characters as themselves */
     if (c &lt; 0x80) {
         ucs4 = c;
         utf8total = 1;
     } else if (utf8total) {
         /* this is a subsequent octet of a multi-octet character */
         /* save UTF8 bits into UCS4 */



<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


         ucs4 = (ucs4 &lt;&lt; 6) | (c &amp; 0x3FUL);
         if (++utf8pos &lt; utf8total) {
          continue;
         }
     } else {
         /* this is the first octet of a multi-octet character */
         utf8pos = 1;
         if (c &lt; 0xE0) {
          utf8total = 2;
          ucs4 = c &amp; 0x1F;
         } else if (c &lt; 0xF0) {
          utf8total = 3;
          ucs4 = c &amp; 0x0F;
         } else {
          /* NOTE: can't convert UTF8 sequences longer than 4 */
          utf8total = 4;
          ucs4 = c &amp; 0x03;
         }
         continue;
     }
     /* Finished with UTF-8 character.  Make sure it isn't an
        overlong sequence.  If it is, return failure. */
     if ((ucs4 &lt; 0x80 &amp;&amp; utf8total &gt; 1) ||
         (ucs4 &lt; 0x0800 &amp;&amp; utf8total &gt; 2) ||
         (ucs4 &lt; 0x00010000 &amp;&amp; utf8total &gt; 3) ||
         (ucs4 &lt; 0x00200000 &amp;&amp; utf8total &gt; 4) ||
         (ucs4 &lt; 0x04000000 &amp;&amp; utf8total &gt; 5) ||
         (ucs4 &lt; 0x80000000 &amp;&amp; utf8total &gt; 6)) {
         return 0;
     }
     /* loop to split ucs4 into two utf16 chars if necessary */
     utf8total = 0;
     do {
         if (ucs4 &gt;= UTF16BASE) {
                ucs4 -= UTF16BASE;
          bitbuf = (bitbuf &lt;&lt; 16) | ((ucs4 &gt;&gt; UTF16SHIFT)
                            + UTF16HIGHSTART);
          ucs4 = (ucs4 &amp; UTF16MASK) + UTF16LOSTART;
          utf16flag = 1;
         } else {
          bitbuf = (bitbuf &lt;&lt; 16) | ucs4;
          utf16flag = 0;
         }
         bitstogo += 16;
         /* spew out base64 */
         while (bitstogo &gt;= 6) {
          bitstogo -= 6;
          *dst++ = base64chars[(bitstogo ? (bitbuf &gt;&gt; bitstogo)



<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 29]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


                               : bitbuf)
                         &amp; 0x3F];
         }
     } while (utf16flag);
    }
    /* if in UTF-7 mode, finish in ASCII */
    if (utf7mode) {
     if (bitstogo) {
         *dst++ = base64chars[(bitbuf &lt;&lt; (6 - bitstogo)) &amp; 0x3F];
     }
     *dst++ = '-';
    }
    /* tie off string */
    *dst = '\0';
    return 1;
}

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20B.%20%20List%20of%20Changes%20since%20RFC%202192"></a><a class="selflink" href="#appendix-B" name="appendix-B">Appendix B</a>.  List of Changes since <a href="rfc2192.html">RFC 2192</a></span>

   Updated boilerplate, list of editor's, etc.
   Updated references.
   Updated ABNF not to use _, to use SP instead of SPACE, etc.
   Updated example domains to use example.org.
   Fixed ABNF error in "imessagelist" non-terminal.
   Updated ABNF, due to changes in <a href="rfc3501.html">RFC 3501</a>, <a href="rfc4466.html">RFC 4466</a>, and <a href="rfc3986.html">RFC 3986</a>.
   Renamed "iuserauth" non-terminal to &lt;iuserinfo&gt;.
   Clarified that the userinfo component describes both authorization
   identity and mailbox naming scope.
   Allow for non-synchronizing literals in "enc-search".
   Added "ipartial" specifier that denotes a partial FETCH.
   Moved URLAUTH text from <a href="rfc4467.html">RFC 4467</a> to this document.
   Updated ABNF for the whole server to allow missing trailing "/"
   (e.g., "imap://imap.example.com" is now valid and is the same as
   "imap://imap.example.com/").
   Clarified how relative-path references are constructed.
   Added more examples demonstrating relative-path references.
   Added rules for relative URLs and restructured ABNF as the result.
   Removed text on use of relative URLs in MHTML.
   Added examples demonstrating security considerations when resolving
   URLs.
   Recommend usage of STARTTLS/SASL security layer to protect
   confidential data.
   Removed some advices about connection reuse that were incorrect.
   Removed URLs referencing a list of mailboxes, as this feature
   hasn't seen any deployments.
   Clarified that user name "anonymous" is case-insensitive.





<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 30]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20C.%20%20List%20of%20Changes%20since%20RFC%204467"></a><a class="selflink" href="#appendix-C" name="appendix-C">Appendix C</a>.  List of Changes since <a href="rfc4467.html">RFC 4467</a></span>

   Renamed &lt;mechanism&gt; to &lt;uauth-mechanism&gt;.  Restructured ABNF.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20D.%20%20Acknowledgments"></a><a class="selflink" href="#appendix-D" name="appendix-D">Appendix D</a>.  Acknowledgments</span>

   Text describing URLAUTH was lifted from [<a href="#ref-URLAUTH" title='"Internet Message Access Protocol (IMAP) - URLAUTH Extension"'>URLAUTH</a>] by Mark Crispin.

   Stephane H. Maes contributed some ideas to this document; he also
   co-edited early versions of this document.

   The editors would like to thank Mark Crispin, Ken Murchison, Ted
   Hardie, Zoltan Ordogh, Dave Cridland, Kjetil Torgrim Homme, Lisa
   Dusseault, Spencer Dawkins, Filip Navara, Shawn M. Emery, Sam
   Hartman, Russ Housley, and Lars Eggert for the time they devoted to
   reviewing this document and/or for the comments received.

Authors' Addresses

   Chris Newman (Author/Editor)
   Sun Microsystems
   3401 Centrelake Dr., Suite 410
   Ontario, CA 91761
   EMail: chris.newman@sun.com

   Alexey Melnikov (Editor)
   Isode Limited
   5 Castle Business Village
   36 Station Road
   Hampton, Middlesex
   TW12 2BX, UK
   EMail: Alexey.Melnikov@isode.com
   URI:   <a href="http://www.melnikov.ca/">http://www.melnikov.ca/</a>


















<span class="grey">Melnikov &amp; Newman           Standards Track                    [Page 31]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc5092.html">RFC 5092</a>                    IMAP URL Scheme                November 2007</span>


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.












Melnikov &amp; Newman           Standards Track                    [Page 32]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc5092 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:37 GMT --></html>