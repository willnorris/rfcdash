<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7161 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:23 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-ietf-multimob-fast-handover" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:7161" name="DC.Identifier"/>
<meta content="March, 2014" name="DC.Date.Issued"/>
<meta content="Ignacio Soto &lt;isoto@it.uc3m.es&gt;" name="DC.Creator"/>
<meta content="This document specifies an experimental multicast handover
optimization mechanism for Proxy Mobile IPv6 (PMIPv6) to accelerate
the delivery of multicast traffic to mobile nodes after handovers. The
mechanism, called Subscription Information Acquisition through the LMA
(SIAL), is based on speeding up the acquisition of mobile nodes'
multicast context by the mobile access gateways. To do that,
extensions to the current PMIPv6 protocol are proposed. These
extensions are not only applicable to the base solution for multicast
support in Proxy Mobile IPv6, but they can also be applied to other
solutions developed to avoid the tunnel convergence problem.
Furthermore, these extensions are also independent of the role played
by the mobile access gateway within the multicast network (acting as
either multicast listener discovery proxy or multicast router)." name="DC.Description.Abstract"/>
<meta content="Proxy Mobile IPv6 (PMIPv6) Multicast Handover Optimization by the Subscription Information Acquisition through the LMA (SIAL)" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7161 - Proxy Mobile IPv6 (PMIPv6) Multicast Handover Optimization by the Subscription Information Acquisition through the LMA (SIAL)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgyellow" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7161.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7161" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-multimob-handover-optimization" title="draft-ietf-multimob-handover-optimization">draft-ietf-mult...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7161" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7161" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7161" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=7161">Errata</a>]</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                            EXPERIMENTAL</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Internet Engineering Task Force (IETF)                     LM. Contreras
Request for Comments: 7161                                Telefonica I+D
Category: Experimental                                     CJ. Bernardos
ISSN: 2070-1721                                                  I. Soto
                                                                    UC3M
                                                              March 2014


       <span class="h1">Proxy Mobile IPv6 (PMIPv6) Multicast Handover Optimization</span>
   <span class="h1">by the Subscription Information Acquisition through the LMA (SIAL)</span>

Abstract

   This document specifies an experimental multicast handover
   optimization mechanism for Proxy Mobile IPv6 (PMIPv6) to accelerate
   the delivery of multicast traffic to mobile nodes after handovers.
   The mechanism, called Subscription Information Acquisition through
   the LMA (SIAL), is based on speeding up the acquisition of mobile
   nodes' multicast context by the mobile access gateways.  To do that,
   extensions to the current PMIPv6 protocol are proposed.  These
   extensions are not only applicable to the base solution for multicast
   support in Proxy Mobile IPv6, but they can also be applied to other
   solutions developed to avoid the tunnel convergence problem.
   Furthermore, these extensions are also independent of the role played
   by the mobile access gateway within the multicast network (acting as
   either multicast listener discovery proxy or multicast router).

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for examination, experimental implementation, and
   evaluation.

   This document defines an Experimental Protocol for the Internet
   community.  This document is a product of the Internet Engineering
   Task Force (IETF).  It represents the consensus of the IETF
   community.  It has received public review and has been approved for
   publication by the Internet Engineering Steering Group (IESG).  Not
   all documents approved by the IESG are a candidate for any level of
   Internet Standard; see <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7161">http://www.rfc-editor.org/info/rfc7161</a>.







<span class="grey">Contreras, et al.             Experimental                      [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     1.1.  Handover Optimization
           Requirements  . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
   <a href="#section-2">2</a>.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-3">3</a>.  Overview  . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
   <a href="#section-4">4</a>.  Proxy Mobile IPv6 Extensions  . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
     <a href="#section-4.1">4.1</a>.  Active Multicast Subscription Mobility Option . . . . . .   <a href="#page-8">8</a>
       <a href="#section-4.1.1">4.1.1</a>.  Option Application Rules  . . . . . . . . . . . . . .   <a href="#page-8">8</a>
       <a href="#section-4.1.2">4.1.2</a>.  Option Format . . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
       <a href="#section-4.1.3">4.1.3</a>.  Backward Compatibility with MLDv1 . . . . . . . . . .   <a href="#page-9">9</a>
     <a href="#section-4.2">4.2</a>.  Multicast Signaling Flag on PBU/PBA Message Headers . . .  <a href="#page-10">10</a>
       <a href="#section-4.2.1">4.2.1</a>.  Flag Application Rules  . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
         <a href="#section-4.2.1.1">4.2.1.1</a>.  Registration Process  . . . . . . . . . . . . . .  <a href="#page-11">11</a>
         <a href="#section-4.2.1.2">4.2.1.2</a>.  De-registration Process . . . . . . . . . . . . .  <a href="#page-12">12</a>
       <a href="#section-4.2.2">4.2.2</a>.  New Format of Conventional PBU/PBA Messages . . . . .  <a href="#page-12">12</a>
         <a href="#section-4.2.2.1">4.2.2.1</a>.  Proxy Binding Update Message  . . . . . . . . . .  <a href="#page-12">12</a>
         <a href="#section-4.2.2.2">4.2.2.2</a>.  Proxy Binding Acknowledgement Message . . . . . .  <a href="#page-13">13</a>
     <a href="#section-4.3">4.3</a>.  Messages for Active Multicast Subscription Query  . . . .  <a href="#page-13">13</a>
       <a href="#section-4.3.1">4.3.1</a>.  Subscription Query Message  . . . . . . . . . . . . .  <a href="#page-13">13</a>
         <a href="#section-4.3.1.1">4.3.1.1</a>.  Message Application Rules . . . . . . . . . . . .  <a href="#page-13">13</a>
         <a href="#section-4.3.1.2">4.3.1.2</a>.  Message Format  . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
       <a href="#section-4.3.2">4.3.2</a>.  Subscription Response Message . . . . . . . . . . . .  <a href="#page-15">15</a>
         <a href="#section-4.3.2.1">4.3.2.1</a>.  Message Application Rules . . . . . . . . . . . .  <a href="#page-15">15</a>
         <a href="#section-4.3.2.2">4.3.2.2</a>.  Message Format  . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
     <a href="#section-4.4">4.4</a>.  New PBA Timer in the LMA  . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
   <a href="#section-5">5</a>.  Handover Signaling Procedures . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
     <a href="#section-5.1">5.1</a>.  Handover of Proactive Type  . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
       <a href="#section-5.1.1">5.1.1</a>.  Rationale . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
       <a href="#section-5.1.2">5.1.2</a>.  Message Flow Description  . . . . . . . . . . . . . .  <a href="#page-18">18</a>
     <a href="#section-5.2">5.2</a>.  Handover of Reactive Type . . . . . . . . . . . . . . . .  <a href="#page-20">20</a>




<span class="grey">Contreras, et al.             Experimental                      [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


       <a href="#section-5.2.1">5.2.1</a>.  Rationale . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-20">20</a>
       <a href="#section-5.2.2">5.2.2</a>.  Message Flow Description  . . . . . . . . . . . . . .  <a href="#page-21">21</a>
       5.2.3.  Further Considerations for the Reactive Handover
               Signaling . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-22">22</a>
     5.3.  Prevention of Large Delays of the Binding
           Acknowledgement for Unicast Traffic . . . . . . . . . . .  <a href="#page-23">23</a>
   <a href="#section-6">6</a>.  IPv4 Support  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-26">26</a>
     <a href="#section-6.1">6.1</a>.  Active Multicast Subscription for IPv4  . . . . . . . . .  <a href="#page-26">26</a>
     <a href="#section-6.2">6.2</a>.  Signaling Procedures for IPv4 Support . . . . . . . . . .  <a href="#page-27">27</a>
     <a href="#section-6.3">6.3</a>.  Binding Cache Extensions for IPv4 Support . . . . . . . .  <a href="#page-28">28</a>
   7.  Coexistence with PMIPv6 Multicast Architectural
       Evolutions  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-28">28</a>
   <a href="#section-8">8</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-28">28</a>
   <a href="#section-9">9</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <a href="#page-31">31</a>
   <a href="#section-10">10</a>. Contributors  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-31">31</a>
   <a href="#section-11">11</a>. Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-31">31</a>
   <a href="#section-12">12</a>. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-32">32</a>
     <a href="#section-12.1">12.1</a>.  Normative References . . . . . . . . . . . . . . . . . .  <a href="#page-32">32</a>
     <a href="#section-12.2">12.2</a>.  Informative References . . . . . . . . . . . . . . . . .  <a href="#page-32">32</a>
   <a href="#appendix-A">Appendix A</a>.  Performance Comparison with Base Solution  . . . . .  <a href="#page-34">34</a>
     <a href="#appendix-A.1">A.1</a>.  Delay Characterization of the Base Solution . . . . . . .  <a href="#page-34">34</a>
     <a href="#appendix-A.2">A.2</a>.  Delay Characterization of SIAL  . . . . . . . . . . . . .  <a href="#page-35">35</a>
     <a href="#appendix-A.3">A.3</a>.  Performance Comparison  . . . . . . . . . . . . . . . . .  <a href="#page-35">35</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The base solution for providing continuous multicast service delivery
   in Proxy Mobile IPv6 (PMIPv6) domains is described in [<a href="rfc6224.html" title='"Base Deployment for Multicast Listener Support in Proxy Mobile IPv6 (PMIPv6) Domains"'>RFC6224</a>].  It
   specifies the basic functionality needed in the Proxy Mobile IPv6
   [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>] entities to provide a multicast service, so continuous
   delivery of multicast traffic is supported by obtaining, after each
   handover, the ongoing multicast subscription information directly
   from the Mobile Node (MN).  When a mobile node attaches to a new
   Mobile Access Gateway (MAG), the mobile node is queried by the mobile
   access gateway through a Multicast Listener Discovery (MLD) General
   Query, which is sent just after any new link is set up, to learn of
   any existing subscription, as specified in [<a href="rfc2710.html" title='"Multicast Listener Discovery (MLD) for IPv6"'>RFC2710</a>] and [<a href="rfc3810.html" title='"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"'>RFC3810</a>].

   However, the base solution needs to be improved to meet some
   performance requirements, especially those referring to the user-
   perceived service quality, which is seriously affected by the
   disruption of multicast content forwarding to the mobile node during
   handovers.

   A mobile node with an active multicast subscription, moving from one
   point of attachment to another within a Proxy Mobile IPv6 domain,
   experiences a certain delay until it resumes receiving again the
   multicast content that it was receiving at the previous location.



<span class="grey">Contreras, et al.             Experimental                      [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


   Such delay causes a gap in the content reception.  Two different
   actions can help mitigate such reception gap.  One of them is to
   buffer at the previous mobile access gateway a copy of the multicast
   traffic destined to the mobile node and forward it to the new mobile
   access gateway, in order to deliver that traffic to the mobile node.
   The other possible (complementary) action is to reduce the time
   needed by the new mobile access gateway to learn of the active
   multicast subscription of the mobile node (i.e., the multicast
   context), so the new mobile access gateway can subscribe to the
   multicast group(s) on behalf of the mobile node as soon as possible.

   While the first mechanism could potentially be accomplished by using
   some adaptation of [<a href="rfc5949.html" title='"Fast Handovers for Proxy Mobile IPv6"'>RFC5949</a>] to multicast traffic (despite being only
   applicable in the case the underlying radio access technology
   supports Layer 2 (L2) triggers, thus requiring additional support on
   the mobile node), there is no generic standard solution for the
   accelerated acquisition of the ongoing multicast subscription of the
   mobile node.

   The approach followed by the base solution [<a href="rfc6224.html" title='"Base Deployment for Multicast Listener Support in Proxy Mobile IPv6 (PMIPv6) Domains"'>RFC6224</a>] to learn of an
   existing multicast subscription relies on the behavior of the IGMP/
   MLD protocols.  Both protocols send multicast membership query
   messages when a new link is up.  The response to such a message
   reports any existing multicast subscriptions by the mobile node.
   While this is a straightforward approach, the mobile access gateway
   can incur in a non-negligible delay in receiving the corresponding
   MLD Report message.  This delay is caused by the time needed for the
   detection of the attachment in the new link and the re-establishment
   of the data plane after the handover, the radio transfer delays
   associated with the signaling to the mobile node, and the MLD query
   response interval time required by this procedure (whose default
   value is 10 seconds as defined in [<a href="rfc2710.html" title='"Multicast Listener Discovery (MLD) for IPv6"'>RFC2710</a>] and [<a href="rfc3810.html" title='"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"'>RFC3810</a>], or between
   5 and 10 seconds as considered in the best case wireless link
   scenario in [<a href="rfc6636.html" title='"Tuning the Behavior of the Internet Group Management Protocol (IGMP) and Multicast Listener Discovery (MLD) for Routers in Mobile and Wireless Networks"'>RFC6636</a>]).

   This document extends the Proxy Mobile IPv6 signaling protocol
   defined in the base protocol [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>] by including a new multicast
   information option to update Proxy Mobile IPv6 entities during the
   registration and de-registration processes, and new messages to
   trigger the transfer of multicast information.  No extension is
   required in any of the multicast-related protocols in use (IGMP/MLD
   or PIM protocols).  Furthermore, this specification does not
   substitute the standard procedures defined in [<a href="rfc6224.html" title='"Base Deployment for Multicast Listener Support in Proxy Mobile IPv6 (PMIPv6) Domains"'>RFC6224</a>] (e.g., the
   mobile access gateway continues sending an MLD Query to the entering
   mobile node as soon as the point-to-point link is set up), but
   complements them for accelerating the acquisition of the multicast
   content by the mobile access gateway associated to the new point-of-
   attachment.



<span class="grey">Contreras, et al.             Experimental                      [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


   This document provides a signaling method internal to the network to
   speed up the subscription information acquisition by the mobile
   access gateway, in order to accelerate the multicast delivery to the
   mobile node after having completed a handover.  By doing so, the
   knowledge by the mobile access gateway of the currently active
   multicast subscription becomes independent of the underlying radio
   technology dynamics and relaxes the requirement of a rapid response
   from the mobile node in processing IGMP/MLD control messages.  Issues
   like radio framing, radio access contention, channel reliability,
   MN's capabilities (i.e., L2 triggering support), IGMP/MLD timers
   optimization for wireless environments, etc., will not impact the
   observed multicast performance during handovers.

   The mechanisms described in this document can also be applied to the
   solutions defined in [<a href="rfc7028.html" title='"Multicast Mobility Routing Optimizations for Proxy Mobile IPv6"'>RFC7028</a>].  Furthermore, it is also independent
   of the role played by the mobile access gateway within the multicast
   network (acting as either MLD proxy or multicast router).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Handover%20Optimization%20Requirements"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Handover Optimization Requirements</span>

   A basic solution for providing support of multicast in a network-
   based mobility management environment has been specified in [<a href="rfc6224.html" title='"Base Deployment for Multicast Listener Support in Proxy Mobile IPv6 (PMIPv6) Domains"'>RFC6224</a>]
   without introducing changes on the original PMIPv6 specification
   [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>].  The focus of the present document is on improving the
   efficiency of the base solution regarding handover performance.

   One of the critical aspects of the base solution is the expected
   delay incurred by the mobile access gateway (where the mobile node is
   being attached to) to be informed about the ongoing multicast
   subscription of the entering MN, mainly due to the fact that the
   mechanisms provided in the base solution relay on the original MLD
   procedures, with long timing interactions not conceived for mobile
   environments.  Then, the requirements to be covered by a handover
   optimization solution can be established in the following manner:

   o  The solution MUST be applicable to any kind of MN (that is, not
      requiring any particular functionality such as, for example, L2
      trigger capabilities), in such a way that any type of mobile node
      in a PMIPv6 domain being served with multicast traffic can benefit
      from the optimized solution.

   o  The solution MUST NOT impact existing multicast protocols.

   o  The solution MUST optimize the handover performance with respect
      to the performance achieved with the base solution for any kind of
      handover process (i.e., for proactive and reactive handovers).





<span class="grey">Contreras, et al.             Experimental                      [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


   o  The solution SHOULD minimize the number and extent of additional
      support (i.e., capabilities) required in the network, aiming at an
      easier deployment.

   o  The solution MUST NOT impact deployments of legacy implementations
      of [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>] and [<a href="rfc6224.html" title='"Base Deployment for Multicast Listener Support in Proxy Mobile IPv6 (PMIPv6) Domains"'>RFC6224</a>].

   The present specification addresses all these requirements, as
   described in the following sections.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

   This document uses the terminology referring to PMIPv6 components as
   defined in [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>].

   Additionally, the following terms are defined and used in this
   document.

   pMAG:  The previous MAG or pMAG is the mobile access gateway where
      the MN was initially registered before a handover event.

   nMAG:  The new MAG or nMAG is the mobile access gateway where the MN
      is registered at the end of the handover event.

   Reactive Handover:  A reactive handover is a handover event in which
      the Local Mobility Anchor (LMA) receives the mobile node
      registration from the nMAG without having previously received the
      MN de-registration from the pMAG.

   Proactive Handover:  A proactive handover is a handover event where
      the mobile node is firstly de-registered on the local mobility
      anchor by the pMAG, and later on it is registered by the nMAG as a
      consequence of changing the point of attachment.

   Multicast Membership Context:  In this document, multicast membership
      context makes reference to the information relative to the
      currently active multicast subscription of an MN in a handover
      event that is transferred between the PMIPv6 entities to support
      the handover optimization.








<span class="grey">Contreras, et al.             Experimental                      [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Overview"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Overview</span>

   The local mobility anchor is a key element within the PMIPv6
   infrastructure, which traces the mobile node reachability along the
   PMIPv6 domain.  Therefore, the LMA is the best element to keep the
   MNs' multicast subscription information up-to-date and to forward it
   to the rest of PMIPv6 entities (i.e., to the mobile access gateways)
   as needed when MNs move within the domain.  The LMA has timely
   knowledge of the MNs' locations, especially during handover events,
   and it is therefore able to quickly provide information to the new
   point of attachment (e.g., by querying the previous one).  Figure 1
   summarizes the main idea of the optimization.

                                       +------+
                                       | pMAG |   |
                                       +------+   |
                                      /           |
                                     /            |
                                    /             |
                                   /              |
            -*-*-*-*-             /              (MN)
           (         )           /                |
          (           )   +-----+      +------+   |
         (  Internet   )--| LMA |------| nMAG |   v
          (           )   +-----+      +------+
           (         )
            -*-*-*-*-          Registration
                             &lt;--------------

                            Registration Ack
                          &amp; Multicast Context
                             --------------&gt;

             Figure 1: High-Level Description of the Solution

   The local mobility anchor only obtains the detailed subscription
   information or multicast context during a handover event.  There is
   no need for continuously informing the LMA about MNs' multicast state
   while the mobile nodes remain attached to the same mobile access
   gateway.  Such a continuous updating procedure would significantly
   increase the signaling load within the PMIPv6 domain without a clear
   benefit.  The multicast context is only critical during handovers:
   neither after nor before.  Indicating the active subscription while
   the handover is ongoing guarantees that such information will be up
   to date and ready to be transferred to the new MAG where the mobile
   node has just attached.  Therefore, this solution defines the
   Subscription Information Acquisition through the LMA (SIAL) as the




<span class="grey">Contreras, et al.             Experimental                      [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


   procedure to inform the new MAG about the multicast subscriptions
   maintained by the entering MN.

   To be able to transfer the multicast subscription information between
   PMIPv6 entities during a handover, this document extends the PMIPv6
   protocol in several ways.  First of all, a new mobility option is
   defined to carry the multicast context of the current subscription.
   Furthermore, additional messages are defined to manage the
   interchange of the multicast information among PMIPv6 entities.
   Finally, some flags are defined to govern the process.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Proxy%20Mobile%20IPv6%20Extensions"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Proxy Mobile IPv6 Extensions</span>

   This section outlines the extensions proposed to the PMIPv6 protocol
   specified in [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Active%20Multicast%20Subscription%20Mobility%20Option"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Active Multicast Subscription Mobility Option</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.1.%20%20Option%20Application%20Rules"></a><a class="selflink" href="#section-4.1.1" name="section-4.1.1">4.1.1</a>.  Option Application Rules</span>

   A new TLV-encoded mobility option, Active Multicast Subscription
   option is defined for use with the Proxy Binding Update (PBU) and
   Proxy Binding Acknowledgement (PBA) messages exchanged between a
   local mobility anchor and a mobility access gateway to transfer the
   multicast subscription information.  This option is used for
   exchanging the multicast membership context.  This information is
   carried by directly using the format defined in the original MLD
   specifications.  There can be multiple Active Multicast Subscription
   options present in the message, one for each active subscription
   maintained by the mobile node when the handover is taking place
   (i.e., one per multicast membership context).

   This new option is also used for the same purposes by the new
   Subscription Response message defined later in this document.

   MLDv2 [<a href="rfc3810.html" title='"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"'>RFC3810</a>] is the primary objective for the definition of the
   option format.  MLDv1 [<a href="rfc2710.html" title='"Multicast Listener Discovery (MLD) for IPv6"'>RFC2710</a>] is also considered for backward
   compatibility.













<span class="grey">Contreras, et al.             Experimental                      [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.2.%20%20Option%20Format"></a><a class="selflink" href="#section-4.1.2" name="section-4.1.2">4.1.2</a>.  Option Format</span>

   The format of this new option is as follows:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                      |      Type     |     Length    |    MLD Type   |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      +                  Multicast Membership Context                 +
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The alignment requirement of this option is 8n+1.

   Type:

      57, which indicates the Active Multicast Subscription IPv6 option.

   Length:

      8-bit unsigned integer indicating the length of the option in
      octets, excluding the type and length fields.

   MLD type:

      Field used to identify the IPv6 multicast membership protocol in
      use, and the corresponding format of the next Multicast Membership
      Context information field.  This field maps the type codification
      used in the original MLD specifications for the Report message.
      For MLDv2, the MLD Type value is 143, as specified in [<a href="rfc3810.html" title='"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"'>RFC3810</a>].

   Multicast Membership Context:

      Multicast subscription information corresponding to a single
      subscribed multicast address.  For MLDv2, the format of this field
      follows the Multicast Address Record format as defined in
      [<a href="rfc3810.html" title='"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"'>RFC3810</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.3.%20%20Backward%20Compatibility%20with%20MLDv1"></a><a class="selflink" href="#section-4.1.3" name="section-4.1.3">4.1.3</a>.  Backward Compatibility with MLDv1</span>

   The following values are adopted when MLDv1 is used.

   MLD type:

      For MLDv1, the MLD Type value is 131, as specified in [<a href="rfc2710.html" title='"Multicast Listener Discovery (MLD) for IPv6"'>RFC2710</a>].




<span class="grey">Contreras, et al.             Experimental                      [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


   Multicast Membership Context:

      For MLDv1, the relevant information for multicast context is
      simply given, according to [<a href="rfc2710.html" title='"Multicast Listener Discovery (MLD) for IPv6"'>RFC2710</a>], by the multicast address of
      the subscribed content.

      In consequence, the Multicast Membership Context is defined as a
      4-octet reserved field and the Multicast Address of the subscribed
      content as in [<a href="rfc2710.html" title='"Multicast Listener Discovery (MLD) for IPv6"'>RFC2710</a>], as shown next.

        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                           Reserved                            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       *                                                               *
       |                                                               |
       *                       Multicast Address                       *
       |                                                               |
       *                                                               *
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Multicast%20Signaling%20Flag%20on%20PBU%2FPBA%20Message%20Headers"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Multicast Signaling Flag on PBU/PBA Message Headers</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.1.%20%20Flag%20Application%20Rules"></a><a class="selflink" href="#section-4.2.1" name="section-4.2.1">4.2.1</a>.  Flag Application Rules</span>

   A new flag S has been added in both the PBU and PBA message headers
   to advertise the mobile access gateway and the local mobility anchor
   capabilities of processing multicast-related signaling for the MN
   that caused the message.

   This flag governs the multicast-related signaling between the LMA and
   the MAG.  As a general rule, the value of the flag in the PBA message
   is a copy of the value received in the PBU message.  Specific rules
   are described in next subsections.














<span class="grey">Contreras, et al.             Experimental                     [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.1.1.%20%20Registration%20Process"></a><a class="selflink" href="#section-4.2.1.1" name="section-4.2.1.1">4.2.1.1</a>.  Registration Process</span>

   During handover, the entities involved in this process are the nMAG
   and the LMA.  These rules also apply for the initial binding
   registration process.

   o  PBU message

      *  S=0 indicates that the MAG sending the PBU message does not
         accept multicast-related signaling for the MN being attached.
         This can be used to discriminate PMIPv6 nodes that are not
         multicast enabled, for backward compatibility reasons.

      *  S=1 indicates that the MAG sending the PBU message accepts
         multicast-related signaling for the MN being attached.
         Depending on the type of handover (reactive or proactive) the
         LMA takes some actions, described later in this document.

   o  PBA message

      *  If S=0 in the corresponding PBU message, the value of the flag
         in the PBA message MUST be a copy of the value received in the
         PBU message (thus S=0), without any further meaning.

      *  If S=1 in the corresponding PBU message, two subcases are
         possible:

         +  S=1 and Active Multicast Subscription mobility option in the
            PBA message.  When the MN maintains an active multicast
            session, if the LMA is able to provide the multicast
            subscription information during registration, the PBA
            message MUST include the Active Multicast Subscription
            mobility option.  If the LMA is not able to provide such
            information during registration, the PBA message MUST NOT
            include the Active Multicast Subscription mobility option.
            This case is useful to decouple unicast and multicast
            signaling for an MN being registered at nMAG.  A way for
            obtaining later active multicast-subscription information is
            described later in this document.

         +  S=0 in the PBA message if the MN does not maintain an active
            multicast subscription (note that for backward compatibility
            reasons, an LMA not supporting multicast related signaling
            would always send S=0).







<span class="grey">Contreras, et al.             Experimental                     [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.1.2.%20%20De-registration%20Process"></a><a class="selflink" href="#section-4.2.1.2" name="section-4.2.1.2">4.2.1.2</a>.  De-registration Process</span>

   During handover, the entities involved in this process are the pMAG
   and the LMA.  These rules apply for the binding de-registration
   process.

   o  PBU message

      *  S=0 indicates that the MN has no active multicast session (note
         that for backward compatibility reasons, a pMAG not supporting
         multicast related signaling would always send S=0).

      *  S=1 indicates that the MN has an active multicast session, and
         the multicast context MUST be transported in the Active
         Multicast Subscription mobility option.

   o  PBA message

      *  The value of the flag in the PBA message SHOULD be 0, without
         any further meaning (note that for backward compatibility
         reasons, an LMA not supporting multicast related signaling
         would always send S=0).

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.2.%20%20New%20Format%20of%20Conventional%20PBU%2FPBA%20Messages"></a><a class="selflink" href="#section-4.2.2" name="section-4.2.2">4.2.2</a>.  New Format of Conventional PBU/PBA Messages</span>

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.2.1.%20%20Proxy%20Binding%20Update%20Message"></a><a class="selflink" href="#section-4.2.2.1" name="section-4.2.2.1">4.2.2.1</a>.  Proxy Binding Update Message</span>

   As result of the new defined flag, the PBU message format is updated
   as follows:

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                     |           Sequence #          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |A|H|L|K|M|R|P|S|   Reserved    |            Lifetime           |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     .                                                               .
     .                          Mobility Options                     .
     .                                                               .
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+








<span class="grey">Contreras, et al.             Experimental                     [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.2.2.2.%20%20Proxy%20Binding%20Acknowledgement%20Message"></a><a class="selflink" href="#section-4.2.2.2" name="section-4.2.2.2">4.2.2.2</a>.  Proxy Binding Acknowledgement Message</span>

   As result of the new defined flag, the PBA message format is updated
   as follows:

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                     |    Status     |K|R|P|S| Rsrvd |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |           Sequence #          |           Lifetime            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     .                                                               .
     .                        Mobility Options                       .
     .                                                               .
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Messages%20for%20Active%20Multicast%20Subscription%20Query"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Messages for Active Multicast Subscription Query</span>

   A new pair of messages is defined for querying entities about the
   active multicast subscription of the MN when the handover is of
   reactive type.

   These messages are sent using the Mobility Header as defined in
   [<a href="rfc6275.html" title='"Mobility Support in IPv6"'>RFC6275</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.3.1.%20%20Subscription%20Query%20Message"></a><a class="selflink" href="#section-4.3.1" name="section-4.3.1">4.3.1</a>.  Subscription Query Message</span>

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.3.1.1.%20%20Message%20Application%20Rules"></a><a class="selflink" href="#section-4.3.1.1" name="section-4.3.1.1">4.3.1.1</a>.  Message Application Rules</span>

   The Subscription Query message (value 22) is sent by the LMA towards
   the pMAG to query it about any existing multicast subscriptions of
   the MN that is being registered by the nMAG.  This message is
   generated in case the handover is of reactive type.

   Additionally, this message is sent by the nMAG towards the LMA to
   query it about the existing multicast subscriptions of the MN when
   the LMA acknowledges the PBU sent by the nMAG but the multicast
   context is not provided (namely, when the PBU message has set the
   flag S to 1, and the PBA message has set the flag S to 1 but the
   multicast context is missing).








<span class="grey">Contreras, et al.             Experimental                     [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.3.1.2.%20%20Message%20Format"></a><a class="selflink" href="#section-4.3.1.2" name="section-4.3.1.2">4.3.1.2</a>.  Message Format</span>

   The Subscription Query message has the following format.

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                     |  Sequence #   |   Reserved    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     .                                                               .
     .                        Mobility Options                       .
     .                                                               .
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Sequence Number:

      The Sequence Number field establishes the order of the messages
      sent in the Subscription Query / Subscription Response dialogue
      between the LMA and the MAG for a certain MN.  The initial
      Sequence Number MUST be determined by the entity that creates the
      message (either LMA or MAG, depending on the scenario), which is
      responsible for managing this counter.

      This Sequence Number comparison MUST be performed modulo 2**8,
      i.e., the number is a free-running counter represented modulo 256.
      A Sequence Number in a received Subscription Query message is
      considered less than or equal to the last received number if its
      value lies in the range of the last received number and the
      preceding 128 values, inclusive.  For example, if the last
      received sequence number was 15, then messages with sequence
      numbers 0 through 15, as well as 143 through 255, would be
      considered less than or equal.

   Reserved:

      This field is unused for now.  The value MUST be initialized to 0.

   Mobility options:

      This message carries one or more TLV-encoded mobility options.
      The valid mobility options for this message are the following:

      *  Mobile Node Identifier option [<a href="rfc4283.html" title='"Mobile Node Identifier Option for Mobile IPv6 (MIPv6)"'>RFC4283</a>] (mandatory).

      *  Home Network Prefix option [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>] (optional).




<span class="grey">Contreras, et al.             Experimental                     [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


      There can be one or more instances of the Home Network Prefix
      option, but only one instance of the Mobile Node Identifier
      option.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.3.2.%20%20Subscription%20Response%20Message"></a><a class="selflink" href="#section-4.3.2" name="section-4.3.2">4.3.2</a>.  Subscription Response Message</span>

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.3.2.1.%20%20Message%20Application%20Rules"></a><a class="selflink" href="#section-4.3.2.1" name="section-4.3.2.1">4.3.2.1</a>.  Message Application Rules</span>

   The Subscription Response message (value 23) is sent by the pMAG
   towards the LMA, or by the LMA towards the nMAG, to answer a
   previously received Subscription Query message, as described above.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/4.3.2.2.%20%20Message%20Format"></a><a class="selflink" href="#section-4.3.2.2" name="section-4.3.2.2">4.3.2.2</a>.  Message Format</span>

   The Subscription Response message has the following format.

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                     |  Sequence #   |I|  Reserved   |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     .                                                               .
     .                        Mobility Options                       .
     .                                                               .
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Sequence Number:

      The value of the Sequence Number field in the Subscriber Response
      message MUST be a copy of the Sequence Number received in the
      Subscription Query message.

   Multicast Information (I):

      The multicast Information flag I specifies whether or not there is
      multicast subscription information available for the MN.  The
      meaning is the following:

         I=0: there is no multicast subscription information available
         for the MN identified by the Mobile Node Identifier option in
         this message.

         I=1: there is multicast subscription information available for
         the MN identified by the Mobile Node Identifier option in this
         message.  The multicast subscription information MUST be




<span class="grey">Contreras, et al.             Experimental                     [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


         carried on one or more instances of the Active Multicast
         Subscription option in this message (one instance for each
         active subscription).

   Reserved:

      This field is unused for now.  The value MUST be initialized to 0.

   Mobility options:

      This message carries one or more TLV-encoded mobility options.
      The valid mobility options for this message are the following:

      *  Mobile Node Identifier option [<a href="rfc4283.html" title='"Mobile Node Identifier Option for Mobile IPv6 (MIPv6)"'>RFC4283</a>] (mandatory).

      *  Active Multicast Subscription option (mandatory) only when flag
         I=1; it MUST NOT be present in any other case.

      *  Home Network Prefix option [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>] (optional).

      There can be one or more instances of the Home Network Prefix
      option (in all cases) and the Active Multicast Subscription option
      (only when I=1), but only one instance of the Mobile Node
      Identifier option.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.4.%20%20New%20PBA%20Timer%20in%20the%20LMA"></a><a class="selflink" href="#section-4.4" name="section-4.4">4.4</a>.  New PBA Timer in the LMA</span>

   A new timer named "PBA timer" is used in the LMA to define the
   maximum waiting time before the PBA message is sent to the nMAG in
   case the multicast subscription information relative to the MN is not
   yet available.  The aim of this timer is to prevent potential large
   delays in the forwarding of unicast traffic towards the MN being
   registered at the nMAG.  This timer allows decoupling the unicast
   signaling from the multicast one in the SIAL solution.

   This timer SHOULD be upper bounded by the constant defined in
   [<a href="rfc6275.html" title='"Mobility Support in IPv6"'>RFC6275</a>] INITIAL_BINDACK_TIMEOUT, whose default value is 1 s.  This
   constant sets the time when the nMAG will retry the MN registration
   by sending again the PBU message.  The "PBA timer" has to be set to a
   value that ensures that the nMAG does not enter the retry mode.
   Operational experience is needed on how to set up the PBA timer, and
   therefore it is RECOMMENDED to set the "PBA timer" to zero, except
   for experimental purposes.








<span class="grey">Contreras, et al.             Experimental                     [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Handover%20Signaling%20Procedures"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Handover Signaling Procedures</span>

   As the MN moves from one access gateway to another, the mobility-
   related signaling due to the handover event is carried out
   independently by the pMAG and the nMAG.  That signaling process is
   not synchronized; thus, two scenarios need to be considered depending
   on the order in which the LMA receives notification of the MN
   registration and de-registration in the nMAG and the pMAG,
   respectively.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Handover%20of%20Proactive%20Type"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Handover of Proactive Type</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.1.%20%20Rationale"></a><a class="selflink" href="#section-5.1.1" name="section-5.1.1">5.1.1</a>.  Rationale</span>

   In the proactive case, the MN is firstly de-registered by the pMAG,
   and later on it is registered by the nMAG as a consequence of
   changing the point of attachment.

   Only for those MNs that maintain an active multicast subscription,
   the pMAG includes the Active Multicast Subscription mobility option
   carrying the multicast context of the MN at that moment as part of
   the PBU message (with flag S set to 1).

   The local mobility anchor stores that information in the
   corresponding binding cache.  If later on the MN attaches to an nMAG,
   this information is sent (using the same TLV option) to the nMAG as
   part of the PBA confirmation of the registration process (if the PBU
   message sent by the nMAG has the flag S set to 1).  On the other
   hand, if no further registration happens, the multicast information
   is removed together with the rest of binding database for that MN.

   After receiving the multicast context, the nMAG can subscribe to the
   multicast flow(s) on behalf of the MN in case there is no other MN
   already receiving it at the nMAG.  The multicast status can also be
   set in advance for the point-to-point link towards the MN.

   Note that the SIAL solution described here does not prevent
   benefiting from extended support in the mobile node / network that
   facilitates the proactive mode operation of the solution, e.g., based
   on L2 capabilities.











<span class="grey">Contreras, et al.             Experimental                     [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.2.%20%20Message%20Flow%20Description"></a><a class="selflink" href="#section-5.1.2" name="section-5.1.2">5.1.2</a>.  Message Flow Description</span>

   Figure 2 summarizes this process.

          +-----+          +----+           +-----+          +----+
          | MN  |          |pMAG|           | LMA |          |nMAG|
          +-----+          +----+           +-----+          +----+
             |                |                |                |
             |                |==Bi-Dir Tunnel=|                |
             | Multicast Data |                |                |
             |&lt;---------------|                |                |
             |                |                |                |
      1) MN Detached          |                |                |
             |         MN Detached Event       |                |
             |                |                |                |
             |                |Ext'd DeReg PBU |                |
      2)     |                |---------------&gt;|                |
             |                |                |                |
      3)     |                |            Accept PBU           |
             |                |(Multicast Subscription info stored)
             |                |                |                |
             |                |      PBA       |                |
      4)     |                |&lt;---------------|                |
             |                |                |                |
      5) MN Attached          |                |                |
             |                |                |   MN Attached Event
             |                |                |                |
             |                |                |       PBU      |
      6)     |                |                |&lt;---------------|
             |                |                |                |
             |                |                |   Ext'd PBA    |
      7)     |                |                |---------------&gt;|
             |                |                |                |
      8)     |                |                |          Accept PBA,
             |                |                |   Multicast Group join
             |                |                | and P-t-P status setup
             |                |                |                |
             |                |                |==Bi-Dir Tunnel=|
             |                |                |                |
             |                |                | Multicast Data |
             |&lt;-------------------------------------------------|
             |                |                |                |
             |                |                |                |

                       Figure 2: Proactive Handover






<span class="grey">Contreras, et al.             Experimental                     [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


   The message flow is as follows:

   1.  A registered MN is receiving a multicast content that has been
       previously subscribed to by sending a standard MLD report from
       the mobile node to the currently serving mobile access gateway,
       pMAG.  The pMAG keeps the multicast state of the point-to-point
       link with the MN.

   2.  The MN initiates a handover process (e.g., because of better
       radio conditions) over a radio access controlled by a new MAG.
       As a consequence, pMAG determines a detachment event
       corresponding to this mobile node, and updates the attachment
       status of this MN to the local mobility anchor by sending an
       extended Proxy Binding Update message, including the Active
       Multicast Subscription, which contains the multicast context of
       the active multicast subscriptions in the moment of handover.

   3.  The LMA processes the PBU message.  Additionally, the LMA stores
       in the binding cache the information regarding the ongoing
       multicast subscription(s) when the detachment is initiated.  This
       information is kept until a new registration of the MN is
       completed by another MAG, or until the binding cache expiration,
       according to [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>].

   4.  The local mobility anchor acknowledges to the pMAG the previous
       PBU message.

   5.  As a result of the handover process, the mobile node attaches to
       another mobility access gateway, called nMAG.

   6.  The nMAG triggers a registration process by sending a PBU message
       (with flag S set to 1) to the local mobility anchor.

   7.  After the analysis of the PBU message, the LMA sends an extended
       PBA including the Active Multicast Subscription option, which
       contains the multicast context of the active subscriptions in the
       moment of handover.

   8.  The nMAG processes the PBA message following all the standard
       procedures described in [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>].  Additionally, with the new
       information relative to multicast subscription, the nMAG sets up
       the multicast status of the point-to-point link between the nMAG
       and the MN, and joins the content identified by (S,G) on behalf
       of the MN in case the nMAG is not receiving already such content
       due to a previous subscription ordered by another MN attached to
       it.  From that instant, the multicast content is served to the
       MN.




<span class="grey">Contreras, et al.             Experimental                     [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Handover%20of%20Reactive%20Type"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Handover of Reactive Type</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.1.%20%20Rationale"></a><a class="selflink" href="#section-5.2.1" name="section-5.2.1">5.2.1</a>.  Rationale</span>

   In the reactive case, the LMA receives the mobile node registration
   from the nMAG without having previously received the MN de-
   registration from the pMAG.

   As the nMAG is not aware of any active multicast subscription of the
   mobile node, the nMAG starts a conventional registration process, by
   sending a normal PBU message (with flag S set to 1) towards the local
   mobility anchor.

   In the reactive handover case, after MN registration at the nMAG, the
   local mobility anchor SHOULD generically query the pMAG to retrieve
   the multicast context of the ongoing multicast subscription of the
   mobile node.  However, the LMA may know in advance if the pMAG
   supports multicast signaling based on the value of the flag S
   received during the MN registration in pMAG.  Specifically, in case
   the pMAG does not support multicast signaling (e.g., the S flag value
   received from pMAG at the time of registering the mobile node was 0),
   the LMA MAY decide not to query pMAG even in the case of receiving an
   nMAG indication of supporting multicast signaling.

   Once the multicast subscription information is retrieved from the
   pMAG, the LMA encapsulates it in the PBA message by using the TLV
   option Active Multicast Subscription and forwards the PBA message to
   the nMAG.  Then, the nMAG can subscribe the multicast flow on behalf
   of the MN, if there is no other mobile node receiving it already at
   the nMAG.  The multicast status can be also set in advance for the
   point-to-point link towards the mobile node.




















<span class="grey">Contreras, et al.             Experimental                     [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.2.%20%20Message%20Flow%20Description"></a><a class="selflink" href="#section-5.2.2" name="section-5.2.2">5.2.2</a>.  Message Flow Description</span>

   Figure 3 summarizes this process.

       +-----+          +----+           +-----+          +----+
       | MN  |          |pMAG|           | LMA |          |nMAG|
       +-----+          +----+           +-----+          +----+
          |                |                |                |
          |                |                |         MN Attached Event
          |                |                |                |
          |                |                |       PBU      |
   1)     |                |                |&lt;---------------|
          |                |                |                |
          |                |  Subscr Query  |                |
   2)     |                |&lt;---------------|                |
          |                |                |                |
          |                |  Subscr Resp   |                |
   3)     |                |---------------&gt;|                |
          |                |                |                |
          |                |    (Multicast Subscription      |
          |                |        info forwarding)         |
          |                |                |                |
          |                |                |   Ext'd PBA    |
   4)     |                |                |---------------&gt;|
          |                |                |                |
   5)     |                |                |           Accept PBA,
          |                |                |      Multicast Group join
          |                |                |     and P-t-P status setup
          |                |                |                |
          |                |                |==Bi-Dir Tunnel=|
          |                |                |                |
          |                |                |   (S,G) Data   |
          |&lt;-------------------------------------------------|
          |                |                |                |
          |                |                |                |

                        Figure 3: Reactive Handover

   We next take as starting point the situation where an MN is attached
   to the pMAG, being multicast enabled and maintaining an active
   multicast subscription at this moment.

   The sequence of messages for the handover of the mobile node is the
   following (as depicted in Figure 3):

   1.  At a certain time, the MN initiates a handover process (e.g.,
       because of better radio conditions) over a radio access
       controlled by a new MAG.  Then, the nMAG triggers a registration



<span class="grey">Contreras, et al.             Experimental                     [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


       process by sending a PBU message (with flag S set to 1) to the
       local mobility anchor.  As it is a reactive case, the pMAG is not
       aware of the detachment process.

   2.  Prior to acknowledging the received PBU message, the LMA queries
       the pMAG about if there is any active multicast subscription for
       the MN, by sending a Subscription Query message.

   3.  The pMAG answers the LMA with a Subscription Response message
       including the multicast context of the existing subscriptions.

   4.  After processing the pMAG answer, the LMA acknowledges (with flag
       S set to 1) the PBU message, including the multicast subscription
       information within the Active Multicast Subscription option.  The
       nMAG then processes the extended PBA message.

   5.  The nMAG processes the PBA message, and it proceeds to set up the
       multicast status of the point-to-point link between the nMAG and
       the mobile node, and to join the content identified by (S,G) on
       behalf of the MN in case the nMAG is not receiving already such
       content.  The bidirectional tunnel is also set up between the
       nMAG and the local mobility anchor if it has not been established
       before by another MN connection.  At this moment, the multicast
       content can be served to the MN.  The unicast traffic for the
       mobile node can be forwarded as well.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.3.%20%20Further%20Considerations%20for%20the%20Reactive%20Handover%20Signaling"></a><a class="selflink" href="#section-5.2.3" name="section-5.2.3">5.2.3</a>.  Further Considerations for the Reactive Handover Signaling</span>

   A handover event is managed independently by the pMAG and nMAG.  It
   is not a synchronized process.  In a reactive handover, the LMA
   receives a registration PBU from nMAG before a de-registration PBU is
   received from pMAG.

   In the message flows detailed above, it could be the case that the
   LMA receives a de-registration PBU from pMAG just after sending the
   Subscription Query message, but before receiving the Subscription
   Response message.  That de-registration PBU message from pMAG carries
   the multicast subscription information required to assist the MN in
   the handover, so such valuable information SHOULD be kept by the LMA.
   Furthermore, it is possible that once the Subscription Query message
   arrives to pMAG, the pMAG could have already removed the multicast
   related information for the MN.

   In order to avoid losing the multicast subscription information sent
   in the de-registration PBU message, the local mobility anchor SHOULD
   store it, and SHOULD include it in the PBA message towards the nMAG
   in case the Subscription Response message from the pMAG does not
   contain multicast subscription information for the mobile node.



<span class="grey">Contreras, et al.             Experimental                     [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Prevention%20of%20Large%20Delays%20of%20the%20Binding%20Acknowledgement%20for"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Prevention of Large Delays of the Binding Acknowledgement for</span>
<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/Unicast%20Traffic"></a>      Unicast Traffic</span>

   According to the message sequences described for the reactive
   handover case, in case the LMA has to request the multicast
   subscription information from the pMAG, the binding request sent by
   the nMAG is maintained on-hold until the local mobility anchor
   receives, processes and includes the multicast subscription
   information into the extended PBA message.  As a consequence, the
   unicast traffic may then suffer an extra delay motivated by the
   multicast-related signaling.  During that time, the unicast traffic
   with destination the MN being registered by the nMAG MAY be buffered
   by the local mobility anchor.

   In order to avoid any potential large delay in the forwarding of
   unicast traffic arriving at the LMA towards the MN, a mechanism
   SHOULD be implemented to decouple multicast from unicast traffic
   reception by the MN.  Figure 4 shows this mechanism.

































<span class="grey">Contreras, et al.             Experimental                     [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


       +-----+          +----+           +-----+          +----+
       | MN  |          |pMAG|           | LMA |          |nMAG|
       +-----+          +----+           +-----+          +----+
   1)     |                |==Bi-Dir Tunnel=|                |
          |  unicast data  |                |                |
          |&lt;-v-v-v-v-v-v-v-|                |                |
          |                |                |                |
          | Multicast Data |                |                |
          |&lt;---------------|                |                |
          |                |                |        MN Attached Event
          |                |                |       PBU      |
   2)     |                |                |&lt;---------------|
          |                |  Subscr Query  |                |
   3)     |                |&lt;---------------|                |
          |                |                |                |
   4)     |                |       &lt;PBA timer starts&gt;        |
          |                |               ///               |
          |                |               ///               |
   5)     |                |       &lt;PBA timer expires&gt;       |
          |                |                |                |
          |                |                |   Ext'd PBA    |
          |                |                |---------------&gt;|
          |                |                |                |
          |                |                |          Accept PBA
          |                |                |                |
          |                |                |==Bi-Dir Tunnel=|
          |                |                |                |
          |                |                |  Unicast Data  |
          |&lt;-v-v-v-v-v-v-v-v-v-v-v-v-v-v-v-v-v-v-v-v-v-v-v-v-|
          |                |                |                |
          |                |                |  Subscr Query  |
   6)     |                |                |&lt;---------------|
          |                |  Subscr Resp   |                |
   7)     |                |---------------&gt;|                |
          |                |                |                |
          |                |    (Multicast Subscription      |
          |                |        info forwarding)         |
          |                |                |                |
          |                |                |  Subscr Resp   |
   8)     |                |                |---------------&gt;|
          |                |                |                |
          |                |                |   Multicast Group join
          |                |                | and P-t-P status setup
          |                | Multicast Data |                |
          |&lt;-------------------------------------------------|
          |                |                |                |

          Figure 4: Decoupling of Unicast and Multicast Signaling



<span class="grey">Contreras, et al.             Experimental                     [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


   The sequence of messages is the following:

   1.  An MN is attached to the pMAG.  The MN is a multicast-enabled
       node, and it is receiving both unicast and multicast traffic
       simultaneously.

   2.  Some time later, The MN initiates a handover process (e.g.,
       because of better radio conditions) over a radio access
       controlled by a new mobile access gateway.  Then, the nMAG
       triggers a registration process by sending a PBU message (with
       flag S set to 1) to the local mobility anchor.  As it is a
       reactive case, the pMAG is not aware of the detachment process.

   3.  Prior to acknowledging the received PBU message, the LMA decides
       to query the pMAG about if there is any active multicast
       subscription for the mobile node, by sending a Subscription Query
       message.

   4.  Immediately after sending the Subscription Query message, the LMA
       starts the timer "PBA timer", which determines the maximum
       waiting time before the PBA is sent to avoid any potential large
       delay in the forwarding of unicast traffic towards the MN.

   5.  In case the "PBA timer" expires, the LMA acknowledges the PBU
       message, by sending the PBA message with flag S=1, without the
       multicast context information.  The nMAG then processes the
       extended PBA message.  Such acknowledgement allows the mobile
       node to receive the unicast traffic from that time on.  The
       bidirectional tunnel is also set up between the nMAG and the LMA
       if it has not been established before.

   6.  In parallel, the nMAG sends a Subscription Query message to the
       LMA requesting the multicast-subscription details yet unknown for
       the mobile node.

   7.  The pMAG answers the Subscription Query message originally sent
       by the local mobility anchor, including the multicast context.

   8.  After processing the pMAG answer, the LMA sends a Subscription
       Response message to the nMAG, including the multicast
       subscription information within the Active Multicast Subscription
       option.  The nMAG processes the PBA message, and it proceeds to
       set up the multicast status of the point-to-point link between
       the nMAG and the mobile node, and to join the content identified
       by (S,G) on behalf of the MN in case the nMAG is not receiving
       already such content.  The bidirectional tunnel is also set up





<span class="grey">Contreras, et al.             Experimental                     [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


       between the nMAG and the LMA if it has not been established
       before.  At this moment, the multicast content can also be served
       to the mobile node.

   The "PBA timer" in the LMA determines if the signaling flow follows
   Figure 3 or Figure 4 in a reactive handover.  A value of 0 for the
   "PBA timer" guarantees that the unicast traffic does not suffer any
   delay (according to the Figure 4 signaling flow), because the PBA is
   sent immediately after the LMA receives the PBU from the nMAG.  A
   small non-zero "PBA timer" value MAY be used to reduce the signaling
   load in the LMA and MAGs (as shown in the signaling flow of Figure 3
   if the Subscription Response message from the pMAG is received at the
   LMA before the "PBA timer" expires), but this has to be carefully
   balanced against added delay to the unicast traffic.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20IPv4%20Support"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  IPv4 Support</span>

   IPv4-based mobile nodes (being either IPv4/IPv6 dual-stack or
   IPv4-only enabled) can be supported in a PMIPv6 domain according to
   [<a href="rfc5844.html" title='"IPv4 Support for Proxy Mobile IPv6"'>RFC5844</a>].  When referring to multicast membership protocols and
   procedures, this means that IGMP functionality has to be also
   supported between the PMIPv6 entities, as documented in [<a href="rfc6224.html" title='"Base Deployment for Multicast Listener Support in Proxy Mobile IPv6 (PMIPv6) Domains"'>RFC6224</a>], to
   allow the mobile access gateway requesting multicast contents to the
   mobility anchor on behalf of the mobile nodes attached to it.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Active%20Multicast%20Subscription%20for%20IPv4"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Active Multicast Subscription for IPv4</span>

   The Active Multicast Subscription option defined in <a href="#section-4.1">Section 4.1</a>,
   which transports the multicast membership context of the mobile node
   during handover, should be compatible with IGMP-based formats.
   Specifically, the option format is defined for IPv4-based MNs as
   follows:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                      |      Type     |     Length    |   IGMP Type   |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      +                  Multicast Membership Context                 +
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   IGMPv3 is the primary objective for the definition of the option
   format.  IGMPv1 and IGMPv2 are also considered for backward
   compatibility.  The alignment requirement of this option is 4n+1.





<span class="grey">Contreras, et al.             Experimental                     [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


   Type:

      56, which indicates the Active Multicast Subscription IPv4 option.

   Length:

      8-bit unsigned integer indicating the length of the option in
      octets, excluding the type and length fields.

   IGMP type:

      Field used to identify the IPv4 multicast membership protocol in
      use, and the corresponding format of the next Multicast Membership
      Context information field.  This field maps the type codification
      used in the original IGMP specifications for the Report message.

      0x12: Use of IGMPv1 multicast membership protocol.

      0x16: Use of IGMPv2 multicast membership protocol.

      0x22: Use of IGMPv3 multicast membership protocol.

   Multicast Membership Context:

      Multicast subscription information corresponding to a single
      subscribed multicast address.  Depending on the IGMP version being
      used by the mobile node, the format of the Multicast Membership
      Context could follow the following formats:

      *  For IGMPv1, the Group Address format as defined in [<a href="rfc1112.html" title='"Host extensions for IP multicasting"'>RFC1112</a>].

      *  For IGMPv2, the Group Address format as defined in [<a href="rfc2236.html" title='"Internet Group Management Protocol, Version 2"'>RFC2236</a>].

      *  For IGMPv3, the Group Record format as defined in [<a href="rfc3376.html" title='"Internet Group Management Protocol, Version 3"'>RFC3376</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Signaling%20Procedures%20for%20IPv4%20Support"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Signaling Procedures for IPv4 Support</span>

   Generic signaling procedures for the support of IPv4 in PMIPv6
   domains have been already specified in [<a href="rfc5844.html" title='"IPv4 Support for Proxy Mobile IPv6"'>RFC5844</a>].  In order to
   prevent errors while signaling the ongoing multicast subscription for
   a mobile node during the handover process, the following extensions
   have to be considered in SIAL.

   o  If the registration/de-registration process in a handover is for
      an IPv6-only MN, and the type of the received Active Multicast
      Subscription option indicates IPv4, then the multicast membership
      context received MUST be silently discarded.




<span class="grey">Contreras, et al.             Experimental                     [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


   o  If the registration/de-registration process in a handover is for
      an IPv4-only MN, and the type of the received Active Multicast
      Subscription option indicates IPv6, then the multicast membership
      context received MUST be silently discarded.

   o  If the registration/de-registration process in a handover is for a
      dual stack MN, the received Active Multicast Subscription option
      (or options) MUST be accepted independently of the type
      indication.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20Binding%20Cache%20Extensions%20for%20IPv4%20Support"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  Binding Cache Extensions for IPv4 Support</span>

   Additionally, since the multicast membership information is
   temporally stored in the mobility anchor under some circumstances
   (e.g., proactive handover), the binding cache entry for an IPv4-based
   multicast-enabled MN should be extended for storing the IGMP-based
   context formats mentioned above, including the IGMP version
   indicator.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Coexistence%20with%20PMIPv6%20Multicast%20Architectural%20Evolutions"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Coexistence with PMIPv6 Multicast Architectural Evolutions</span>

   Throughout this document, the base solution for multicast support in
   Proxy Mobile IPv6, described in [<a href="rfc6224.html" title='"Base Deployment for Multicast Listener Support in Proxy Mobile IPv6 (PMIPv6) Domains"'>RFC6224</a>], has been implicitly
   considered, i.e., both unicast and multicast traffic addressing a
   mobile node is delivered via the standard PMIPv6 bidirectional tunnel
   between LMA and MAG.  While here all multicast traffic is assumed to
   be delivered via the local mobility anchor, the SIAL approach
   described in this document can be also applied to other solutions in
   which the multicast content is served from other entities in the
   PMIPv6 domain, as described in [<a href="rfc7028.html" title='"Multicast Mobility Routing Optimizations for Proxy Mobile IPv6"'>RFC7028</a>] to solve the tunnel
   convergence problem.

   In this case, the transfer of the multicast context would also pass
   through the local mobility anchor, as described here.  However, the
   nMAG subscribes to the multicast content through the node in charge
   of distributing multicast according to the adopted solution for
   multicast distribution in the PMIPv6 domain.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Security%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Security Considerations</span>

   This proposal does not pose any additional security threats to those
   already identified in [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>].  All the security considerations in
   [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>] are directly applicable to this protocol.  The signaling
   messages, Proxy Binding Update, and Proxy Binding Acknowledgement
   (extended with the new options defined in this document), the
   Subscription Query Message, and the Subscription Response Message





<span class="grey">Contreras, et al.             Experimental                     [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


   exchanged between the mobile access gateway and the local mobility
   anchor, MUST be protected using end-to-end security association(s)
   offering integrity and data origin authentication.

   The mobile access gateway and the local mobility anchor MUST
   implement the IPsec security mechanism mandated by Proxy Mobile IPv6
   [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>] to secure the signaling described in this document.  In the
   following, we describe the Security Policy Database (SPD) and
   Security Association Database (SAD) entries necessary to protect the
   new signaling introduced by this specification (Subscription Query
   Message and Subscription Response Message).  We use the same format
   used by [<a href="rfc4877.html" title='"Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture"'>RFC4877</a>].  The SPD and SAD entries are only example
   configurations.  A particular mobile access gateway implementation
   and a local mobility anchor home agent implementation could configure
   different SPD and SAD entries as long as they provide the required
   security of the signaling messages.

   For the examples described in this document, a mobile access gateway
   with address "mag_address_1", and a local mobility anchor with
   address "lma_address_1" are assumed.































<span class="grey">Contreras, et al.             Experimental                     [Page 29]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


      mobile access gateway SPD-S:
      - IF local_address = mag_address_1 &amp;
      remote_address = lma_address_1 &amp;
      proto = MH &amp; (remote_mh_type = Subscription Query |
      local_mh_type = Subscription Response |
      remote_mh_type = Multicast Activity Indication Ack.|
      local_mh_type = Multicast Activity Indication)
      Then use SA1 (OUT) and SA2 (IN)

      mobile access gateway SAD:
      - SA1(OUT, spi_a, lma_address_1, ESP, TRANSPORT):
      local_address = mag_address_1 &amp;
      remote_address = lma_address_1 &amp;
      proto = MH
      - SA2(IN, spi_b, mag_address_1, ESP, TRANSPORT):
      local_address = lma_address_1 &amp;
      remote_address = mag_address_1 &amp;
      proto = MH

      local mobility anchor SPD-S:
      - IF local_address = lma_address_1 &amp;
      remote_address =mag_address_1 &amp;
      proto = MH &amp; (remote_mh_type = Subscription Response |
      local_mh_type = Subscription Query |
      remote_mh_type = Multicast Activity Indication |
      local_mh_type = Multicast Activity Indication Ack.)
      Then use SA2 (OUT) and SA1 (IN)

      local mobility anchor SAD:
      - SA2(OUT, spi_b, mag_address_1, ESP, TRANSPORT):
      local_address = lma_address_1 &amp;
      remote_address = mag_address_1 &amp;
      proto = MH
      - SA1(IN, spi_a, lma_address_1, ESP, TRANSPORT):
      local_address = mag_address_1 &amp;
      remote_address = lma_address_1 &amp;
      proto = MH

   While in the base solution the LMA has learned of the subscribed
   multicast groups per MAG, in this specification the LMA is aware
   (during a handover process) of the multicast groups to which an MN
   visiting the PMIP domain is subscribed.









<span class="grey">Contreras, et al.             Experimental                     [Page 30]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  IANA Considerations</span>

   This document establishes new assignments to the IANA mobility
   parameters registry.

   o  Mobility Header types: the Subscription Query (22) and
      Subscription Response (23) mobility header types.  The Type value
      for these Headers has been assigned from the "Mobility Header
      Types - for the MH Type field in the Mobility Header" registry
      defined in &lt;<a href="http://www.iana.org/assignments/mobility-parameters">http://www.iana.org/assignments/mobility-parameters</a>&gt;.

   o  Mobility options: the Active Multicast Subscription mobility
      option for both IPv4 (56) and IPv6 (57) modes of operation.  The
      Type value for these Mobility options has been assigned from the
      "Mobility Options" registry defined in &lt;<a href="http://www.iana.org/assignments/mobility-parameters">http://www.iana.org/</a>
      <a href="http://www.iana.org/assignments/mobility-parameters">assignments/mobility-parameters</a>&gt;.

   o  Flags: this document reserves a new multicast Signaling flag (S).
      This flag has been reserved as value 0x0020 in the "Binding Update
      Flags" registry and value 0x04 in the "Binding Acknowledgment
      Flags" registry.  These registries appear on &lt;<a href="http://www.iana.org/assignments/mobility-parameters">http://www.iana.org/</a>
      <a href="http://www.iana.org/assignments/mobility-parameters">assignments/mobility-parameters</a>&gt;.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Contributors"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Contributors</span>

   Dirk Von Hugo (Telekom Innovation Laboratories,
   Dirk.von-Hugo@telekom.de) extensively contributed to this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20Acknowledgments"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  Acknowledgments</span>

   The authors would like to thank (in alphabetical order) Hitoshi
   Asaeda, Sergio Figueiredo, Georgios Karagiannis, Marco Liebsch,
   Behcet Sarikaya, Thomas C. Schmidt, and Stig Venaas for their
   valuable comments and discussions on the MULTIMOB mailing list.  The
   authors are also grateful with Hitoshi Asaeda, Akbar Rahman, Behcet
   Sarikaya, and Stig Venaas for their reviews of this document.

   The research of Carlos J. Bernardos leading to these results has
   received funding from the European Community's Seventh Framework
   Programme (FP7-ICT-2009-5) under grant agreement n. 258053 (MEDIEVAL
   project), being also partially supported by the Ministry of Science
   and Innovation (MICINN) of Spain under the QUARTET project (TIN2009-
   13992-C02-01).

   The research of Ignacio Soto has also received funding from the
   Spanish MICINN through the I-MOVING project (TEC2010-18907).





<span class="grey">Contreras, et al.             Experimental                     [Page 31]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/12.%20%20References"></a><a class="selflink" href="#section-12" name="section-12">12</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.1.%20%20Normative%20References"></a><a class="selflink" href="#section-12.1" name="section-12.1">12.1</a>.  Normative References</span>

   [<a id="ref-RFC1112" name="ref-RFC1112">RFC1112</a>]  Deering, S., "Host extensions for IP multicasting", STD 5,
              <a href="rfc1112.html">RFC 1112</a>, August 1989.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC2236" name="ref-RFC2236">RFC2236</a>]  Fenner, W., "Internet Group Management Protocol, Version
              2", <a href="rfc2236.html">RFC 2236</a>, November 1997.

   [<a id="ref-RFC2710" name="ref-RFC2710">RFC2710</a>]  Deering, S., Fenner, W., and B. Haberman, "Multicast
              Listener Discovery (MLD) for IPv6", <a href="rfc2710.html">RFC 2710</a>, October
              1999.

   [<a id="ref-RFC3376" name="ref-RFC3376">RFC3376</a>]  Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A.
              Thyagarajan, "Internet Group Management Protocol, Version
              3", <a href="rfc3376.html">RFC 3376</a>, October 2002.

   [<a id="ref-RFC3810" name="ref-RFC3810">RFC3810</a>]  Vida, R. and L. Costa, "Multicast Listener Discovery
              Version 2 (MLDv2) for IPv6", <a href="rfc3810.html">RFC 3810</a>, June 2004.

   [<a id="ref-RFC4283" name="ref-RFC4283">RFC4283</a>]  Patel, A., Leung, K., Khalil, M., Akhtar, H., and K.
              Chowdhury, "Mobile Node Identifier Option for Mobile IPv6
              (MIPv6)", <a href="rfc4283.html">RFC 4283</a>, November 2005.

   [<a id="ref-RFC4877" name="ref-RFC4877">RFC4877</a>]  Devarapalli, V. and F. Dupont, "Mobile IPv6 Operation with
              IKEv2 and the Revised IPsec Architecture", <a href="rfc4877.html">RFC 4877</a>, April
              2007.

   [<a id="ref-RFC5213" name="ref-RFC5213">RFC5213</a>]  Gundavelli, S., Leung, K., Devarapalli, V., Chowdhury, K.,
              and B. Patil, "Proxy Mobile IPv6", <a href="rfc5213.html">RFC 5213</a>, August 2008.

   [<a id="ref-RFC5844" name="ref-RFC5844">RFC5844</a>]  Wakikawa, R. and S. Gundavelli, "IPv4 Support for Proxy
              Mobile IPv6", <a href="rfc5844.html">RFC 5844</a>, May 2010.

   [<a id="ref-RFC6275" name="ref-RFC6275">RFC6275</a>]  Perkins, C., Johnson, D., and J. Arkko, "Mobility Support
              in IPv6", <a href="rfc6275.html">RFC 6275</a>, July 2011.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.2.%20%20Informative%20References"></a><a class="selflink" href="#section-12.2" name="section-12.2">12.2</a>.  Informative References</span>

   [<a id="ref-Papagiannaki" name="ref-Papagiannaki">Papagiannaki</a>]
              Papagiannaki, K., Moon, S., Fraliegh, C., Thiran, P., and
              C. Diot, "Measurement and Analysis of Single-Hop Delay on
              an IP Backbone Network", IEEE Journal on Selected Areas in
              Communications, vol. 21, no. 6, August 2003.



<span class="grey">Contreras, et al.             Experimental                     [Page 32]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


   [<a id="ref-RFC5949" name="ref-RFC5949">RFC5949</a>]  Yokota, H., Chowdhury, K., Koodli, R., Patil, B., and F.
              Xia, "Fast Handovers for Proxy Mobile IPv6", <a href="rfc5949.html">RFC 5949</a>,
              September 2010.

   [<a id="ref-RFC6224" name="ref-RFC6224">RFC6224</a>]  Schmidt, T., Waehlisch, M., and S. Krishnan, "Base
              Deployment for Multicast Listener Support in Proxy Mobile
              IPv6 (PMIPv6) Domains", <a href="rfc6224.html">RFC 6224</a>, April 2011.

   [<a id="ref-RFC6636" name="ref-RFC6636">RFC6636</a>]  Asaeda, H., Liu, H., and Q. Wu, "Tuning the Behavior of
              the Internet Group Management Protocol (IGMP) and
              Multicast Listener Discovery (MLD) for Routers in Mobile
              and Wireless Networks", <a href="rfc6636.html">RFC 6636</a>, May 2012.

   [<a id="ref-RFC7028" name="ref-RFC7028">RFC7028</a>]  Zuniga, JC., Contreras, LM., Bernardos, CJ., Jeon, S., and
              Y. Kim, "Multicast Mobility Routing Optimizations for
              Proxy Mobile IPv6", <a href="rfc7028.html">RFC 7028</a>, September 2013.

   [<a id="ref-Verizon" name="ref-Verizon">Verizon</a>]  Verizon, "LTE: The Future of Mobile Broadband Technology",
              Verizon White Paper, 2010,
              &lt;<a href="http://opennetwork.verizonwireless.com/pdfs/VZW_LTE_White_Paper_12-10.pdf">http://opennetwork.verizonwireless.com/pdfs/</a>
              <a href="http://opennetwork.verizonwireless.com/pdfs/VZW_LTE_White_Paper_12-10.pdf">VZW_LTE_White_Paper_12-10.pdf</a>&gt;.

   [<a id="ref-Y.1541" name="ref-Y.1541">Y.1541</a>]   ITU-T, "Network performance objectives for IP-based
              services", ITU-T Recommendation Y.1541, December 2011.



























<span class="grey">Contreras, et al.             Experimental                     [Page 33]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-34" id="page-34" name="page-34"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Performance%20Comparison%20with%20Base%20Solution"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Performance Comparison with Base Solution</span>

   This informative annex briefly analyzes and compares the performance
   improvement provided by the fast handover extensions specified in
   this document with the base multicast solution defined in [<a href="rfc6224.html" title='"Base Deployment for Multicast Listener Support in Proxy Mobile IPv6 (PMIPv6) Domains"'>RFC6224</a>].
   The main aim is to determine the potential delay reduction in the
   acquisition of the multicast subscription information by the nMAG
   during the MN handover.  To do that, the analysis focuses on the
   delay additional to the unicast handover due to the multicast
   operation in both cases.

   Different delay components have to be taken into account for this
   comparison.  Since the interaction between the actors during the
   handover process (MN, pMAG, nMAG, LMA) is different for each of the
   solutions, different sources of delay can be expected for each of
   them.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.1.%20%20Delay%20Characterization%20of%20the%20Base%20Solution"></a><a class="selflink" href="#appendix-A.1" name="appendix-A.1">A.1</a>.  Delay Characterization of the Base Solution</span>

   The base solution relies on the standard MLD procedures to obtain the
   multicast subscription information directly from the MN.  Once the
   nMAG completes the configuration of point-to-point link to the
   attaching MN (the configuration of this link as downstream interface
   of an MLD proxy instance can run in parallel), it immediately sends
   an MLD General Query towards the MN for learning of any active
   multicast subscription by the MN.  When the MN receives the MLD
   Query, the MN provides information about the active memberships it
   maintains in the form of an MLD Report message.  After successful
   transmission of this information via the wireless point of attachment
   to nMAG, the corresponding MLD proxy instance at the nMAG sets up the
   multicast status of the downstream interface.  According to this
   process, the delay is originated on the MAG-MN communication.

   The delay components to be considered for the base solution are the
   following:

   o  D_bh, which is the unidirectional (one-way) delay encountered in
      the transmission path between the nMAG and the wireless point of
      attachment.

   o  D_radio, which is the unidirectional delay due to the transfer of
      MLD control messages over the radio channel (user plane) between
      the wireless point of attachment and the MN, for the MLD Query and
      Report messages.

   o  D_mld, which is the delay incurred by the MN to answer the MLD
      Query.




<span class="grey">Contreras, et al.             Experimental                     [Page 34]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-35" id="page-35" name="page-35"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


   The total observed delay can be then formulated as:

   D_base = 2 x (D_bh + D_radio) + D_mld

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.2.%20%20Delay%20Characterization%20of%20SIAL"></a><a class="selflink" href="#appendix-A.2" name="appendix-A.2">A.2</a>.  Delay Characterization of SIAL</span>

   As described in this document, it is possible to distinguish two
   scenarios depending on the order in which the LMA receives the
   notifications of the MN registration and de-registration in the nMAG
   and the pMAG, respectively.

   In the proactive case, the MN is firstly de-registered by the pMAG,
   and later on it is registered by the nMAG.  As specified in this
   document, the LMA stores the multicast subscription information,
   which is provided to the nMAG during the MN registration process.
   Since the registration process necessarily happens before the MLD
   Query and Report process described in the base solution, the
   proactive case is inherently faster than the base solution.  In fact,
   since the multicast subscription information is acquired properly
   during the registration process, the delay incurred is null.

   In the reactive case, the LMA receives the MN registration from the
   nMAG without having previously received the MN de-registration from
   the pMAG.  In case the MN maintains an active subscription, the LMA
   queries the pMAG to retrieve the multicast subscription information,
   which is forwarded to the nMAG.  According to this process, the delay
   is originated on the MAG-LMA communication.

   The delay components to be considered for the base solution are the
   following:

   o  D_net, which is the unidirectional delay found in the network path
      between the LMA and the MAG.

   The total observed delay can be then formulated as:

   D_sial = 2 x D_net

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.3.%20%20Performance%20Comparison"></a><a class="selflink" href="#appendix-A.3" name="appendix-A.3">A.3</a>.  Performance Comparison</span>

   The performance of the base solution is highly dependent on the radio
   technology used by the MN to attach to the PMIPv6 domain.  Different
   radio technologies have distinct properties in terms of radio
   framing, radio access contention or collision avoidance, channel
   reliability, etc.






<span class="grey">Contreras, et al.             Experimental                     [Page 35]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-36" id="page-36" name="page-36"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


   New radio access technologies, such as the one specified in new Long
   Term Evolution (LTE) standards intend to reduce the latency in order
   to provide high-speed communications.  Even though, typical one-way
   latencies in the LTE radio access will stay around 15 ms [<a href="#ref-Verizon" title='"LTE: The Future of Mobile Broadband Technology"'>Verizon</a>].

   The backhaul delay characterization becomes problematic.  In a real
   network, there are several solutions for the backhaul connection in
   terms of network topology (ring, star, point-to-point, etc.) and
   technology (optical fiber, microwave transmission, xDSL-based
   accesses, etc.), all of them having distinct properties in terms of
   performance, reliability, and delay.  These solutions commonly
   coexist in a real mobile network, in such a way that an MN changing
   the point of attachment can pass smoothly from one solution to
   another.  A value of D_bh = 5 ms can be established as the typical
   value for the backhaul latency in modern networks.

   Finally, the MLD induced delay is intrinsic to the MLD protocol
   specification.  A host receiving an MLD Query message waits a random
   time in the range (0, Maximum Response Delay) to send the MLD Report
   message.  The default value of the Maximum Response Delay
   (configurable through the Query Response Interval in MLD) is 10 s in
   [<a href="rfc2710.html" title='"Multicast Listener Discovery (MLD) for IPv6"'>RFC2710</a>] and [<a href="rfc3810.html" title='"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"'>RFC3810</a>].  In [<a href="rfc6636.html" title='"Tuning the Behavior of the Internet Group Management Protocol (IGMP) and Multicast Listener Discovery (MLD) for Routers in Mobile and Wireless Networks"'>RFC6636</a>] the effect of tuning the value
   of the Query Response Interval is analyzed and 5 s is the smallest
   value recommended (best case).  Then, on average, a potential delay
   of 5 s or 2.5 s, default and best case respectively, can be expected.

   As we have seen, D_base is, on average, greater than 2.5 s with the
   best case of the values of Query Response Interval in MLD that are
   recommended in [<a href="rfc6636.html" title='"Tuning the Behavior of the Internet Group Management Protocol (IGMP) and Multicast Listener Discovery (MLD) for Routers in Mobile and Wireless Networks"'>RFC6636</a>].  That means that the handover delay of the
   base solution is on the order of seconds, while in the solution
   presented in this specification it is on the order of milliseconds
   (as shown below).  To improve the performance of the base solution,
   we could further reduce the value of Query Response Interval, but the
   implications of doing so would need to be carefully analyzed.  Even
   if we assume that Query Response Interval is 0 s, D_base would be
   around 2 x (5 ms + 15 ms) = 40 ms for last-generation systems.  Note
   that this calculation does not take into account the necessary time
   to re-establish the data plane after the handover to make possible
   the MLD Query reception.  The expected delay will get much worse for
   older generation systems (e.g., 3G-based radio systems can suffer
   radio delays in the order of hundreds of ms).

   For the SIAL case, the delay in the MAG-LMA communication will be
   derived from the network diameter (i.e., the number of hops found
   between the MAG and the LMA in the PMIPv6 domain).  This is largely
   influenced by the internal network planning.  An administrative
   domain can typically have in the order of five hops from access to
   the interconnection gateway providing connectivity to other networks.



<span class="grey">Contreras, et al.             Experimental                     [Page 36]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-37" id="page-37" name="page-37"> </a>
<span class="grey"><a href="rfc7161.html">RFC 7161</a>         PMIPv6 Multicast Handover Optimization       March 2014</span>


   Even if the LMA plays a central role topologically in the PMIPv6
   domain, such number of hops seems reasonable in a common nation-wide
   network.  Each hop in the path between MAG and LMA will add a certain
   delay, which can be estimated to be around 1 ms in the best case
   [<a href="#ref-Papagiannaki">Papagiannaki</a>]  and 3 ms in the worst case [<a href="#ref-Y.1541" title='"Network performance objectives for IP-based services"'>Y.1541</a>].  With this in
   mind, a total delay D_sial of around 2 x 5 x 3 ms = 30 ms can be
   expected in the worst case.

   Then, in conclusion, in a typical deployment, it can be stated that
   the SIAL proposal, even for the worst-case consideration, will
   perform better than the best-case situation for the base solution,
   which consists of the last-generation radio technology, LTE.  For any
   other radio technology, the base solution will show even larger
   deviations from the delay achievable with the SIAL solution.

Authors' Addresses

   Luis M. Contreras
   Telefonica I+D
   Ronda de la Comunicacion, s/n
   Sur-3 building, 3rd floor
   Madrid  28050
   Spain

   EMail: lmcm@tid.es


   Carlos J. Bernardos
   Universidad Carlos III de Madrid
   Av. Universidad, 30
   Leganes, Madrid  28911
   Spain

   Phone: +34 91624 6236
   EMail: cjbc@it.uc3m.es
   URI:   <a href="http://www.it.uc3m.es/cjbc/">http://www.it.uc3m.es/cjbc/</a>


   Ignacio Soto
   Universidad Carlos III de Madrid
   Av. Universidad, 30
   Leganes, Madrid  28911
   Spain

   EMail: isoto@it.uc3m.es






Contreras, et al.             Experimental                     [Page 37]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7161 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:23 GMT --></html>