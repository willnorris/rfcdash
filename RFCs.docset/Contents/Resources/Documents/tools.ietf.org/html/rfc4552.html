<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc4552 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:40 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-gupta-ospf-ospfv3-auth" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:4552" name="DC.Identifier"/>
<meta content="June, 2006" name="DC.Date.Issued"/>
<meta content="Melam, Nagavenkata Suresh" name="DC.Creator"/>
<meta content="Gupta, Mukesh" name="DC.Creator"/>
<meta content="This document describes means and mechanisms to provide
authentication/confidentiality to OSPFv3 using an IPv6 Authentication
Header/Encapsulating Security Payload (AH/ESP) extension header.
[STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="Authentication/Confidentiality for OSPFv3" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 4552 - Authentication/Confidentiality for OSPFv3</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc4552.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc4552" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-ospf-ospfv3-auth" title="draft-ietf-ospf-ospfv3-auth">draft-ietf-ospf...</a>] [<a href="https://datatracker.ietf.org/doc/rfc4552" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4552" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc4552" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=4552">Errata</a>]</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Network Working Group                                           M. Gupta
Request for Comments: 4552                               Tropos Networks
Category: Standards Track                                       N. Melam
                                                        Juniper Networks
                                                               June 2006


               <span class="h1">Authentication/Confidentiality for OSPFv3</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2006).

Abstract

   This document describes means and mechanisms to provide
   authentication/confidentiality to OSPFv3 using an IPv6 Authentication
   Header/Encapsulating Security Payload (AH/ESP) extension header.

























<span class="grey">Gupta &amp; Melam               Standards Track                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc4552.html">RFC 4552</a>       Authentication/Confidentiality for OSPFv3       June 2006</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
      <a href="#section-1.1">1.1</a>. Conventions Used in This Document ..........................<a href="#page-2">2</a>
   <a href="#section-2">2</a>. Transport Mode vs. Tunnel Mode ..................................<a href="#page-3">3</a>
   <a href="#section-3">3</a>. Authentication ..................................................<a href="#page-3">3</a>
   <a href="#section-4">4</a>. Confidentiality .................................................<a href="#page-3">3</a>
   <a href="#section-5">5</a>. Distinguishing OSPFv3 from OSPFv2 ...............................<a href="#page-4">4</a>
   <a href="#section-6">6</a>. IPsec Requirements ..............................................<a href="#page-4">4</a>
   <a href="#section-7">7</a>. Key Management ..................................................<a href="#page-5">5</a>
   <a href="#section-8">8</a>. SA Granularity and Selectors ....................................<a href="#page-7">7</a>
   <a href="#section-9">9</a>. Virtual Links ...................................................<a href="#page-8">8</a>
   <a href="#section-10">10</a>. Rekeying .......................................................<a href="#page-9">9</a>
      <a href="#section-10.1">10.1</a>. Rekeying Procedure ........................................<a href="#page-9">9</a>
      <a href="#section-10.2">10.2</a>. KeyRolloverInterval .......................................<a href="#page-9">9</a>
      <a href="#section-10.3">10.3</a>. Rekeying Interval ........................................<a href="#page-10">10</a>
   <a href="#section-11">11</a>. IPsec Protection Barrier and SPD ..............................<a href="#page-10">10</a>
   <a href="#section-12">12</a>. Entropy of Manual Keys ........................................<a href="#page-12">12</a>
   <a href="#section-13">13</a>. Replay Protection .............................................<a href="#page-12">12</a>
   <a href="#section-14">14</a>. Security Considerations .......................................<a href="#page-12">12</a>
   <a href="#section-15">15</a>. References ....................................................<a href="#page-13">13</a>
      <a href="#section-15.1">15.1</a>. Normative References .....................................<a href="#page-13">13</a>
      <a href="#section-15.2">15.2</a>. Informative References ...................................<a href="#page-13">13</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   OSPF (Open Shortest Path First) Version 2 [<a href="#ref-N1" title='"OSPF Version 2"'>N1</a>] defines the fields
   AuType and Authentication in its protocol header to provide security.
   In OSPF for IPv6 (OSPFv3) [<a href="#ref-N2" title='"OSPF for IPv6"'>N2</a>], both of the authentication fields
   were removed from OSPF headers.  OSPFv3 relies on the IPv6
   Authentication Header (AH) and IPv6 Encapsulating Security Payload
   (ESP) to provide integrity, authentication, and/or confidentiality.

   This document describes how IPv6 AH/ESP extension headers can be used
   to provide authentication/confidentiality to OSPFv3.

   It is assumed that the reader is familiar with OSPFv3 [<a href="#ref-N2" title='"OSPF for IPv6"'>N2</a>], AH [<a href="#ref-N5" title='"IP Authentication Header"'>N5</a>],
   ESP [<a href="#ref-N4" title='"IP Encapsulating Security Payload (ESP)"'>N4</a>], the concept of security associations, tunnel and transport
   mode of IPsec, and the key management options available for AH and
   ESP (manual keying [<a href="#ref-N3" title='"Security Architecture for the Internet Protocol"'>N3</a>] and Internet Key Exchange (IKE)[<a href="#ref-I1" title='"Internet Key Exchange (IKEv2) Protocol"'>I1</a>]).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="#ref-N7" title='"Key words for use in RFCs to Indicate Requirement Levels"'>N7</a>].





<span class="grey">Gupta &amp; Melam               Standards Track                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc4552.html">RFC 4552</a>       Authentication/Confidentiality for OSPFv3       June 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Transport%20Mode%20vs.%20Tunnel%20Mode"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Transport Mode vs. Tunnel Mode</span>

   The transport mode Security Association (SA) is generally used
   between two hosts or routers/gateways when they are acting as hosts.
   The SA must be a tunnel mode SA if either end of the security
   association is a router/gateway.  Two hosts MAY establish a tunnel
   mode SA between themselves.  OSPFv3 packets are exchanged between
   routers.  However, since the packets are locally delivered, the
   routers assume the role of hosts in the context of tunnel mode SA.
   All implementations conforming to this specification MUST support
   transport mode SA to provide required IPsec security to OSPFv3
   packets.  They MAY also support tunnel mode SA to provide required
   IPsec security to OSPFv3 packets.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Authentication"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Authentication</span>

   Implementations conforming to this specification MUST support
   authentication for OSPFv3.

   In order to provide authentication to OSPFv3, implementations MUST
   support ESP and MAY support AH.

   If ESP in transport mode is used, it will only provide authentication
   to OSPFv3 protocol packets excluding the IPv6 header, extension
   headers, and options.

   If AH in transport mode is used, it will provide authentication to
   OSPFv3 protocol packets, selected portions of IPv6 header, selected
   portions of extension headers, and selected options.

   When OSPFv3 authentication is enabled,

      o  OSPFv3 packets that are not protected with AH or ESP MUST be
         silently discarded.

      o  OSPFv3 packets that fail the authentication checks MUST be
         silently discarded.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Confidentiality"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Confidentiality</span>

   Implementations conforming to this specification SHOULD support
   confidentiality for OSPFv3.

   If confidentiality is provided, ESP MUST be used.







<span class="grey">Gupta &amp; Melam               Standards Track                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc4552.html">RFC 4552</a>       Authentication/Confidentiality for OSPFv3       June 2006</span>


   When OSPFv3 confidentiality is enabled,

      o  OSPFv3 packets that are not protected with ESP MUST be silently
         discarded.

      o  OSPFv3 packets that fail the confidentiality checks MUST be
         silently discarded.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Distinguishing%20OSPFv3%20from%20OSPFv2"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Distinguishing OSPFv3 from OSPFv2</span>

   The IP/IPv6 Protocol Type for OSPFv2 and OSPFv3 is the same (89), and
   OSPF distinguishes them based on the OSPF header version number.
   However, current IPsec standards do not allow using arbitrary
   protocol-specific header fields as the selectors.  Therefore, the
   OSPF version field in the OSPF header cannot be used to distinguish
   OSPFv3 packets from OSPFv2 packets.  As OSPFv2 is only for IPv4 and
   OSPFv3 is only for IPv6, the version field in the IP header can be
   used to distinguish OSPFv3 packets from OSPFv2 packets.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20IPsec%20Requirements"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  IPsec Requirements</span>

   In order to implement this specification, the following IPsec
   capabilities are required.

   Transport mode
      IPsec in transport mode MUST be supported. [<a href="#ref-N3" title='"Security Architecture for the Internet Protocol"'>N3</a>]

   Multiple Security Policy Databases (SPDs)
      The implementation MUST support multiple SPDs with an SPD
      selection function that provides an ability to choose a specific
      SPD based on interface. [<a href="#ref-N3" title='"Security Architecture for the Internet Protocol"'>N3</a>]

   Selectors
      The implementation MUST be able to use source address, destination
      address, protocol, and direction as selectors in the SPD.

   Interface ID tagging
      The implementation MUST be able to tag the inbound packets with
      the ID of the interface (physical or virtual) via which it
      arrived. [<a href="#ref-N3" title='"Security Architecture for the Internet Protocol"'>N3</a>]

   Manual key support
      Manually configured keys MUST be able to secure the specified
      traffic. [<a href="#ref-N3" title='"Security Architecture for the Internet Protocol"'>N3</a>]







<span class="grey">Gupta &amp; Melam               Standards Track                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc4552.html">RFC 4552</a>       Authentication/Confidentiality for OSPFv3       June 2006</span>


   Encryption and authentication algorithms
      The implementation MUST NOT allow the user to choose stream
      ciphers as the encryption algorithm for securing OSPFv3 packets
      since the stream ciphers are not suitable for manual keys.

      Except when in conflict with the above statement, the key words
      "MUST", "MUST NOT", "REQUIRED", "SHOULD", and "SHOULD NOT" that
      appear in the [<a href="#ref-N6" title='"Cryptographic Algorithm Implementation Requirements for Encapsulating Security Payload (ESP) and Authentication Header (AH)"'>N6</a>] document for algorithms to be supported are to
      be interpreted as described in [<a href="#ref-N7" title='"Key words for use in RFCs to Indicate Requirement Levels"'>N7</a>] for OSPFv3 support as well.

   Dynamic IPsec rule configuration
      The routing module SHOULD be able to configure, modify, and delete
      IPsec rules on the fly.  This is needed mainly for securing
      virtual links.

   Encapsulation of ESP packet
      IP encapsulation of ESP packets MUST be supported.  For
      simplicity, UDP encapsulation of ESP packets SHOULD NOT be used.

   Different SAs for different Differentiated Services Code Points
      (DSCPs)
      As per [<a href="#ref-N3" title='"Security Architecture for the Internet Protocol"'>N3</a>], the IPsec implementation MUST support the
      establishment and maintenance of multiple SAs with the same
      selectors between a given sender and receiver.  This allows the
      implementation to associate different classes of traffic with the
      same selector values in support of Quality of Service (QoS).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Key%20Management"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Key Management</span>

   OSPFv3 exchanges both multicast and unicast packets.  While running
   OSPFv3 over a broadcast interface, the authentication/confidentiality
   required is "one to many".  Since IKE is based on the Diffie-Hellman
   key agreement protocol and works only for two communicating parties,
   it is not possible to use IKE for providing the required "one to
   many" authentication/confidentiality.  This specification mandates
   the usage of Manual Keying with current IPsec implementations.
   Future specifications can explore the usage of protocols like
   Kerberized Internet Negotiation of Keys/Group Secure Association Key
   Management Protocol (KINK/GSAKMP) when they are widely available.  In
   manual keying, SAs are statically installed on the routers and these
   static SAs are used to authenticate/encrypt packets.

   The following discussion explains that it is not scalable and is
   practically infeasible to use different security associations for
   inbound and outbound traffic to provide the required "one to many"
   security.  Therefore, the implementations MUST use manually





<span class="grey">Gupta &amp; Melam               Standards Track                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc4552.html">RFC 4552</a>       Authentication/Confidentiality for OSPFv3       June 2006</span>


   configured keys with the same SA parameters (Security Parameter Index
   (SPI), keys, etc.) for both inbound and outbound SAs (as shown in
   Figure 3).

          A                  |
        SAa     ------------&gt;|
        SAb     &lt;------------|
                             |
          B                  |
        SAb     ------------&gt;|
        SAa     &lt;------------|                 Figure 1
                             |
          C                  |
        SAa/SAb ------------&gt;|
        SAa/SAb &lt;------------|
                             |
                         Broadcast
                          Network

   If we consider communication between A and B in Figure 1, everything
   seems to be fine.  A uses security association SAa for outbound
   packets and B uses the same for inbound packets and vice versa.  Now
   if we include C in the group and C sends a packet using SAa, then
   only A will be able to understand it.  Similarly, if C sends a packet
   using SAb, then only B will be able to understand it.  Since the
   packets are multicast and they are going to be processed by both A
   and B, there is no SA for C to use so that both A and B can
   understand them.

          A                  |
        SAa     ------------&gt;|
        SAb     &lt;------------|
        SAc     &lt;------------|
                             |
          B                  |
        SAb     ------------&gt;|
        SAa     &lt;------------|                 Figure 2
        SAc     &lt;------------|
                             |
          C                  |
        SAc     ------------&gt;|
        SAa     &lt;------------|
        SAb     &lt;------------|
                             |
                         Broadcast
                          Network





<span class="grey">Gupta &amp; Melam               Standards Track                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc4552.html">RFC 4552</a>       Authentication/Confidentiality for OSPFv3       June 2006</span>


   The problem can be solved by configuring SAs for all the nodes on
   every other node as shown in Figure 2.  So A, B, and C will use SAa,
   SAb, and SAc, respectively, for outbound traffic.  Each node will
   lookup the SA to be used based on the source (A will use SAb and SAc
   for packets received from B and C, respectively).  This solution is
   not scalable and practically infeasible because a large number of SAs
   will need to be configured on each node.  Also, the addition of a
   node in the broadcast network will require the addition of another SA
   on every other node.

         A                   |
        SAo     ------------&gt;|
        SAi     &lt;------------|
                             |
         B                   |
        SAo     ------------&gt;|
        SAi     &lt;------------|                 Figure 3
                             |
         C                   |
        SAo     ------------&gt;|
        SAi     &lt;------------|
                             |
                         Broadcast
                          Network

   The problem can be solved by using the same SA parameters (SPI, keys,
   etc.) for both inbound (SAi) and outbound (SAo) SAs as shown in
   Figure 3.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20SA%20Granularity%20and%20Selectors"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  SA Granularity and Selectors</span>

   The user SHOULD be given the choice of sharing the same SA among
   multiple interfaces or using a unique SA per interface.

   OSPFv3 supports running multiple instances over one interface using
   the "Instance Id" field contained in the OSPFv3 header.  As IPsec
   does not support arbitrary fields in the protocol header to be used
   as the selectors, it is not possible to use different SAs for
   different OSPFv3 instances running over the same interface.
   Therefore, all OSPFv3 instances running over the same interface will
   have to use the same SA.  In OSPFv3 RFC terminology, SAs are per-link
   and not per-interface.









<span class="grey">Gupta &amp; Melam               Standards Track                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc4552.html">RFC 4552</a>       Authentication/Confidentiality for OSPFv3       June 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Virtual%20Links"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Virtual Links</span>

   A different SA than the SA of the underlying interface MUST be
   provided for virtual links.  Packets sent on virtual links use
   unicast non-link local IPv6 addresses as the IPv6 source address,
   while packets sent on other interfaces use multicast and unicast link
   local addresses.  This difference in the IPv6 source address
   differentiates the packets sent on virtual links from other OSPFv3
   interface types.

   As the virtual link end point IPv6 addresses are not known, it is not
   possible to install SPD/Security Association Database (SAD) entries
   at the time of configuration.  The virtual link end point IPv6
   addresses are learned during the routing table computation process.
   The packet exchange over the virtual links starts only after the
   discovery of the end point IPv6 addresses.  In order to protect these
   exchanges, the routing module must install the corresponding SPD/SAD
   entries before starting these exchanges.  Note that manual SA
   parameters are preconfigured but not installed in the SAD until the
   end point addresses are learned.

   According to the OSPFv3 RFC [<a href="#ref-N2" title='"OSPF for IPv6"'>N2</a>], the virtual neighbor's IP address
   is set to the first prefix with the "LA-bit" set from the list of
   prefixes in intra-area-prefix-Link State Advertisements (LSAs)
   originated by the virtual neighbor.  But when it comes to choosing
   the source address for the packets that are sent over the virtual
   link, the RFC [<a href="#ref-N2" title='"OSPF for IPv6"'>N2</a>] simply suggests using one of the router's own
   global IPv6 addresses.  In order to install the required security
   rules for virtual links, the source address also needs to be
   predictable.  Hence, routers that implement this specification MUST
   change the way the source and destination addresses are chosen for
   packets exchanged over virtual links when IPsec is enabled.

   The first IPv6 address with the "LA-bit" set in the list of prefixes
   advertised in intra-area-prefix-LSAs in the transit area MUST be used
   as the source address for packets exchanged over the virtual link.
   When multiple intra-area-prefix-LSAs are originated, they are
   considered concatenated and are ordered by ascending Link State ID.

   The first IPv6 address with the "LA-bit" set in the list of prefixes
   received in intra-area-prefix-LSAs from the virtual neighbor in the
   transit area MUST be used as the destination address for packets
   exchanged over the virtual link.  When multiple intra-area-prefix-
   LSAs are received, they are considered concatenated and are ordered
   by ascending Link State ID.

   This makes both the source and destination addresses of packets
   exchanged over the virtual link predictable when IPsec is enabled.



<span class="grey">Gupta &amp; Melam               Standards Track                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc4552.html">RFC 4552</a>       Authentication/Confidentiality for OSPFv3       June 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Rekeying"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Rekeying</span>

   To maintain the security of a link, the authentication and encryption
   key values SHOULD be changed periodically.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Rekeying%20Procedure"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Rekeying Procedure</span>

   The following three-step procedure SHOULD be provided to rekey the
   routers on a link without dropping OSPFv3 protocol packets or
   disrupting the adjacency.

   (1) For every router on the link, create an additional inbound SA for
       the interface being rekeyed using a new SPI and the new key.

   (2) For every router on the link, replace the original outbound SA
       with one using the new SPI and key values.  The SA replacement
       operation should be atomic with respect to sending OSPFv3 packets
       on the link so that no OSPFv3 packets are sent without
       authentication/encryption.

   (3) For every router on the link, remove the original inbound SA.

   Note that all routers on the link must complete step 1 before any
   begin step 2.  Likewise, all the routers on the link must complete
   step 2 before any begin step 3.

   One way to control the progression from one step to the next is for
   each router to have a configurable time constant KeyRolloverInterval.
   After the router begins step 1 on a given link, it waits for this
   interval and then moves to step 2.  Likewise, after moving to step 2,
   it waits for this interval and then moves to step 3.

   In order to achieve smooth key transition, all routers on a link
   should use the same value for KeyRolloverInterval and should initiate
   the key rollover process within this time period.

   At the end of this procedure, all the routers on the link will have a
   single inbound and outbound SA for OSPFv3 with the new SPI and key
   values.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.2.%20%20KeyRolloverInterval"></a><a class="selflink" href="#section-10.2" name="section-10.2">10.2</a>.  KeyRolloverInterval</span>

   The configured value of KeyRolloverInterval should be long enough to
   allow the administrator to change keys on all the OSPFv3 routers.  As
   this value can vary significantly depending upon the implementation
   and the deployment, it is left to the administrator to choose an
   appropriate value.




<span class="grey">Gupta &amp; Melam               Standards Track                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc4552.html">RFC 4552</a>       Authentication/Confidentiality for OSPFv3       June 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.3.%20%20Rekeying%20Interval"></a><a class="selflink" href="#section-10.3" name="section-10.3">10.3</a>.  Rekeying Interval</span>

   This section analyzes the security provided by manual keying and
   recommends that the encryption and authentication keys SHOULD be
   changed at least every 90 days.

   The weakest security provided by the security mechanisms discussed in
   this specification is when NULL encryption (for ESP) or no encryption
   (for AH) is used with the HMAC-MD5 authentication.  Any other
   algorithm combinations will at least be as hard to break as the ones
   mentioned above.  This is shown by the following reasonable
   assumptions:

      o  NULL Encryption and HMAC-SHA-1 Authentication will be more
         secure as HMAC-SHA-1 is considered to be more secure than
         HMAC-MD5.

      o  NON-NULL Encryption and NULL Authentication combination is not
         applicable as this specification mandates authentication when
         OSPFv3 security is enabled.

      o  Data Encryption Security (DES) Encryption and HMAC-MD5
         Authentication will be more secure because of the additional
         security provided by DES.

      o  Other encryption algorithms like 3DES and the Advanced
         Encryption Standard (AES) will be more secure than DES.

   <a href="rfc3562.html">RFC 3562</a> [<a href="#ref-I4" title='"Key Management Considerations for the TCP MD5 Signature Option"'>I4</a>] analyzes the rekeying requirements for the TCP MD5
   signature option.  The analysis provided in <a href="rfc3562.html">RFC 3562</a> is also
   applicable to this specification as the analysis is independent of
   data patterns.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20IPsec%20Protection%20Barrier%20and%20SPD"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  IPsec Protection Barrier and SPD</span>

   The IPsec protection barrier MUST be around the OSPF protocol.
   Therefore, all the inbound and outbound OSPF traffic goes through
   IPsec processing.

   The SPD selection function MUST return an SPD with the following rule
   for all the interfaces that have OSPFv3
   authentication/confidentiality disabled.

      No.  source       destination       protocol        action
      1     any            any              OSPF          bypass






<span class="grey">Gupta &amp; Melam               Standards Track                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc4552.html">RFC 4552</a>       Authentication/Confidentiality for OSPFv3       June 2006</span>


   The SPD selection function MUST return an SPD with the following
   rules for all the interfaces that have OSPFv3
   authentication/confidentiality enabled.

      No.  source       destination       protocol        action
      2   fe80::/10        any             OSPF           protect
      3   fe80::/10        any       ESP/OSPF or AH/OSPF  protect
      4   src/128        dst/128           OSPF           protect
      5   src/128        dst/128     ESP/OSPF or AH/OSPF  protect

   For rules 2 and 4, action "protect" means encrypting/calculating
   Integrity Check Value (ICV) and adding an ESP or AH header.  For
   rules 3 and 5, action "protect" means decrypting/authenticating the
   packets and stripping the ESP or AH header.

   Rule 1 will bypass the OSPFv3 packets without any IPsec processing on
   the interfaces that have OSPFv3 authentication/confidentiality
   disabled.

   Rules 2 and 4 will drop the inbound OSPFv3 packets that have not been
   secured with ESP/AH headers.

   ESP/OSPF or AH/OSPF in rules 3 and 5 mean that it is an OSPF packet
   secured with ESP or AH.

   Rules 2 and 3 are meant to secure the unicast and multicast OSPF
   packets that are not being exchanged over the virtual links.

   Rules 4 and 5 are meant to secure the packets being exchanged over
   virtual links.  These rules are installed after learning the virtual
   link end point IPv6 addresses.  These rules MUST be installed in the
   SPD for the interfaces that are connected to the transit area for the
   virtual link.  These rules MAY alternatively be installed on all the
   interfaces.  If these rules are not installed on all the interfaces,
   clear text or malicious OSPFv3 packets with the same source and
   destination addresses as the virtual link end point IPv6 addresses
   will be delivered to OSPFv3.  Though OSPFv3 drops these packets as
   they were not received on the right interface, OSPFv3 receives some
   clear text or malicious packets even when the security is enabled.
   Installing these rules on all the interfaces ensures that OSPFv3 does
   not receive these clear text or malicious packets when security is
   enabled.  On the other hand, installing these rules on all the
   interfaces increases the processing overhead on the interfaces where
   there is no other IPsec processing.  The decision of whether to
   install these rules on all the interfaces or on just the interfaces
   that are connected to the transit area is a private decision and
   doesn't affect the interoperability in any way.  Hence it is an
   implementation choice.



<span class="grey">Gupta &amp; Melam               Standards Track                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc4552.html">RFC 4552</a>       Authentication/Confidentiality for OSPFv3       June 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/12.%20%20Entropy%20of%20Manual%20Keys"></a><a class="selflink" href="#section-12" name="section-12">12</a>.  Entropy of Manual Keys</span>

   The implementations MUST allow the administrator to configure the
   cryptographic and authentication keys in hexadecimal format rather
   than restricting it to a subset of ASCII characters (letters,
   numbers, etc.).  A restricted character set will reduce key entropy
   significantly as discussed in [<a href="#ref-I2" title='"OSPF Security Vulnerabilities Analysis"'>I2</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/13.%20%20Replay%20Protection"></a><a class="selflink" href="#section-13" name="section-13">13</a>.  Replay Protection</span>

   Since it is not possible using the current standards to provide
   complete replay protection while using manual keying, the proposed
   solution will not provide protection against replay attacks.

   Detailed analysis of various vulnerabilities of the routing protocols
   and OSPF in particular is discussed in [<a href="#ref-I3" title='"Generic Threats to Routing Protocols"'>I3</a>] and [<a href="#ref-I2" title='"OSPF Security Vulnerabilities Analysis"'>I2</a>].  The conclusion
   is that replay of OSPF packets can cause adjacencies to be disrupted,
   which can lead to a DoS attack on the network.  It can also cause
   database exchange process to occur continuously thus causing CPU
   overload as well as micro loops in the network.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/14.%20%20Security%20Considerations"></a><a class="selflink" href="#section-14" name="section-14">14</a>.  Security Considerations</span>

   This memo discusses the use of IPsec AH and ESP headers to provide
   security to OSPFv3 for IPv6.  Hence, security permeates throughout
   this document.

   OSPF Security Vulnerabilities Analysis [<a href="#ref-I2" title='"OSPF Security Vulnerabilities Analysis"'>I2</a>] identifies OSPF
   vulnerabilities in two scenarios -- one with no authentication or
   simple password authentication and the other with cryptographic
   authentication.  The solution described in this specification
   provides protection against all the vulnerabilities identified for
   scenarios with cryptographic authentication with the following
   exceptions:

   Limitations of manual key:

   This specification mandates the usage of manual keys.  The following
   are the known limitations of the usage of manual keys.

      o  As the sequence numbers cannot be negotiated, replay protection
         cannot be provided.  This leaves OSPF insecure against all the
         attacks that can be performed by replaying OSPF packets.

      o  Manual keys are usually long lived (changing them often is a
         tedious task).  This gives an attacker enough time to discover
         the keys.




<span class="grey">Gupta &amp; Melam               Standards Track                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc4552.html">RFC 4552</a>       Authentication/Confidentiality for OSPFv3       June 2006</span>


      o  As the administrator is manually configuring the keys, there is
         a chance that the configured keys are weak (there are known
         weak keys for DES/3DES at least).

   Impersonating attacks:

   The usage of the same key on all the OSPF routers connected to a link
   leaves them all insecure against impersonating attacks if any one of
   the OSPF routers is compromised, malfunctioning, or misconfigured.

   Detailed analysis of various vulnerabilities of routing protocols is
   discussed in [<a href="#ref-I3" title='"Generic Threats to Routing Protocols"'>I3</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/15.%20%20References"></a><a class="selflink" href="#section-15" name="section-15">15</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.1.%20%20Normative%20References"></a><a class="selflink" href="#section-15.1" name="section-15.1">15.1</a>.  Normative References</span>

   [<a id="ref-N1" name="ref-N1">N1</a>] Moy, J., "OSPF Version 2", STD 54, <a href="rfc2328.html">RFC 2328</a>, April 1998.

   [<a id="ref-N2" name="ref-N2">N2</a>] Coltun, R., Ferguson, D., and J. Moy, "OSPF for IPv6", <a href="rfc2740.html">RFC 2740</a>,
        December 1999.

   [<a id="ref-N3" name="ref-N3">N3</a>] Kent, S. and K. Seo, "Security Architecture for the Internet
        Protocol", <a href="rfc4301.html">RFC 4301</a>, December 2005.

   [<a id="ref-N4" name="ref-N4">N4</a>] Kent, S., "IP Encapsulating Security Payload (ESP)", <a href="rfc4303.html">RFC 4303</a>,
        December 2005.

   [<a id="ref-N5" name="ref-N5">N5</a>] Kent, S., "IP Authentication Header", <a href="rfc4302.html">RFC 4302</a>, December 2005.

   [<a id="ref-N6" name="ref-N6">N6</a>] Eastlake 3rd, D., "Cryptographic Algorithm Implementation
        Requirements for Encapsulating Security Payload (ESP) and
        Authentication Header (AH)", <a href="rfc4305.html">RFC 4305</a>, December 2005.

   [<a id="ref-N7" name="ref-N7">N7</a>] Bradner, S., "Key words for use in RFCs to Indicate Requirement
        Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.2.%20%20Informative%20References"></a><a class="selflink" href="#section-15.2" name="section-15.2">15.2</a>.  Informative References</span>

   [<a id="ref-I1" name="ref-I1">I1</a>] Kaufman, C., "Internet Key Exchange (IKEv2) Protocol", <a href="rfc4306.html">RFC 4306</a>,
        December 2005.

   [<a id="ref-I2" name="ref-I2">I2</a>] Jones, E. and O. Moigne, "OSPF Security Vulnerabilities
        Analysis", Work in Progress.

   [<a id="ref-I3" name="ref-I3">I3</a>] Barbir, A., Murphy, S., and Y. Yang, "Generic Threats to Routing
        Protocols", Work in Progress.




<span class="grey">Gupta &amp; Melam               Standards Track                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc4552.html">RFC 4552</a>       Authentication/Confidentiality for OSPFv3       June 2006</span>


   [<a id="ref-I4" name="ref-I4">I4</a>] Leech, M., "Key Management Considerations for the TCP MD5
        Signature Option", <a href="rfc3562.html">RFC 3562</a>, July 2003.

Acknowledgements

   The authors would like to extend sincere thanks to Marc Solsona,
   Janne Peltonen, John Cruz, Dhaval Shah, Abhay Roy, Paul Wells,
   Vishwas Manral, and Sam Hartman for providing useful information and
   critiques on this memo.  The authors would like to extend special
   thanks to Acee Lindem for many editorial changes.

   We would also like to thank members of the IPsec and OSPF WG for
   providing valuable review comments.

Authors' Addresses

   Mukesh Gupta
   Tropos Networks
   555 Del Rey Ave
   Sunnyvale, CA 94085

   Phone: 408-331-6889
   EMail: mukesh.gupta@tropos.com


   Nagavenkata Suresh Melam
   Juniper Networks
   1194 N. Mathilda Ave
   Sunnyvale, CA 94089

   Phone: 408-505-4392
   EMail: nmelam@juniper.net



















<span class="grey">Gupta &amp; Melam               Standards Track                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc4552.html">RFC 4552</a>       Authentication/Confidentiality for OSPFv3       June 2006</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).







Gupta &amp; Melam               Standards Track                    [Page 15]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc4552 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:40 GMT --></html>