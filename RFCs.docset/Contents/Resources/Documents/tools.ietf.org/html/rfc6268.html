<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from tools.ietf.org/html/rfc6268 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:48:28 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.129c" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Identifier" content="urn:ietf:rfc:6268" />
<meta name="DC.Description.Abstract" content="The Cryptographic Message Syntax (CMS) format, and many associated
formats, are expressed using ASN.1. The current ASN.1 modules conform
to the 1988 version of ASN.1. This document updates some auxiliary
ASN.1 modules to conform to the 2008 version of ASN.1; the 1988 ASN.1
modules remain the normative version. There are no bits- on-the-wire
changes to any of the formats; this is simply a change to the syntax." />
<meta name="DC.Creator" content="Turner, Sean" />
<meta name="DC.Creator" content="Schaad, Jim" />
<meta name="DC.Date.Issued" content="July, 2011" />
<meta name="DC.Title" content="Additional New ASN.1 Modules for the Cryptographic Message Syntax (CMS) and the Public Key Infrastructure Using X.509 (PKIX)" />

    <link rel="icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 6268 - Additional New ASN.1 Modules for the Cryptographic Message Syntax (CMS) and the Public Key Infrastructure Using X.509 (PKIX)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgorange"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6268.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6268" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-turner-additional-new-asn" title="draft-turner-additional-new-asn">draft-turner-ad...</a>] [<a href='https://datatracker.ietf.org/doc/rfc6268' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6268" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6268" title="Side-by-side diff">Diff2</a>]         </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Internet Engineering Task Force (IETF)                         J. Schaad
Request for Comments: 6268                       Soaring Hawk Consulting
Updates: <a href="rfc5911.html">5911</a>                                                  S. Turner
Category: Informational                                       IECA, Inc.
ISSN: 2070-1721                                                July 2011


Additional New ASN.1 Modules for the Cryptographic Message Syntax (CMS)
          and the Public Key Infrastructure Using X.509 (PKIX)

Abstract

   The Cryptographic Message Syntax (CMS) format, and many associated
   formats, are expressed using ASN.1.  The current ASN.1 modules
   conform to the 1988 version of ASN.1.  This document updates some
   auxiliary ASN.1 modules to conform to the 2008 version of ASN.1; the
   1988 ASN.1 modules remain the normative version.  There are no bits-
   on-the-wire changes to any of the formats; this is simply a change to
   the syntax.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">Section&nbsp;2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6268">http://www.rfc-editor.org/info/rfc6268</a>.

Copyright Notice

   Copyright (c) 2011 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must




<span class="grey">Schaad &amp; Turner               Informational                     [Page 1]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-1.1">1.1</a>.  ASN.1 Updates (2002 to 2008) . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-1.2">1.2</a>.  Requirements Terminology . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
   <a href="#section-2">2</a>.  ASN.1 Module <a href="rfc3274.html">RFC 3274</a>  . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
   <a href="#section-3">3</a>.  ASN.1 Module <a href="rfc3779.html">RFC 3779</a>  . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
   <a href="#section-4">4</a>.  ASN.1 Module <a href="rfc6019.html">RFC 6019</a>  . . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
   <a href="#section-5">5</a>.  ASN.1 Module <a href="rfc4073.html">RFC 4073</a>  . . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
   <a href="#section-6">6</a>.  ASN.1 Module <a href="rfc4231.html">RFC 4231</a>  . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
   <a href="#section-7">7</a>.  ASN.1 Module <a href="rfc4334.html">RFC 4334</a>  . . . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
   <a href="#section-8">8</a>.  ASN.1 Module <a href="rfc5083.html">RFC 5083</a>  . . . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
   <a href="#section-9">9</a>.  ASN.1 Module <a href="rfc5652.html">RFC 5652</a>  . . . . . . . . . . . . . . . . . . . . <a href="#page-18">18</a>
   <a href="#section-10">10</a>. ASN.1 Module <a href="rfc5752.html">RFC 5752</a>  . . . . . . . . . . . . . . . . . . . . <a href="#page-29">29</a>
   <a href="#section-11">11</a>. Module Identifiers in ASN.1  . . . . . . . . . . . . . . . . . <a href="#page-30">30</a>
   <a href="#section-12">12</a>. Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-32">32</a>
   <a href="#section-13">13</a>. References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-32">32</a>
     <a href="#section-13.1">13.1</a>. Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-32">32</a>
     <a href="#section-13.2">13.2</a>. Informative References . . . . . . . . . . . . . . . . . . <a href="#page-33">33</a>
















<span class="grey">Schaad &amp; Turner               Informational                     [Page 2]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   Some developers would like the IETF to use the latest version of
   ASN.1 in its standards.  Most of the RFCs that relate to security
   protocols still use ASN.1 from the 1988 standard, which has been
   deprecated.  This is particularly true for the standards that relate
   to PKIX, CMS, and Secure/Multipurpose Internet Mail Extensions
   (S/MIME).

   In this document we have either changed the syntax to use the 2008
   ASN.1 standard, or done some updates from previous conversions.  The
   ASN.1 modules updated came from the following RFCs:

   o  <a href="rfc3274.html">RFC 3274</a>, Compressed Data Content Type for Cryptographic Message
      Syntax (CMS) [<a href="rfc3274.html" title="&quot;Compressed Data Content Type for Cryptographic Message Syntax (CMS)&quot;">RFC3274</a>].

   o  <a href="rfc3779.html">RFC 3779</a>, X.509 Extensions for IP Addresses and AS Identifiers
      [<a href="rfc3779.html" title="&quot;X.509 Extensions for IP Addresses and AS Identifiers&quot;">RFC3779</a>].

   o  <a href="rfc6019.html">RFC 6019</a>, BinaryTime: An Alternate Format for Representing Date
      and Time in ASN.1 [<a href="rfc6019.html" title="&quot;BinaryTime: An Alternate Format for Representing Date and Time in ASN.1&quot;">RFC6019</a>].

   o  <a href="rfc4073.html">RFC 4073</a>, Protecting Multiple Contents with the Cryptographic
      Message Syntax (CMS) [<a href="rfc4073.html" title="&quot;Protecting Multiple Contents with the Cryptographic Message Syntax (CMS)&quot;">RFC4073</a>].

   o  <a href="rfc4231.html">RFC 4231</a>, Identifiers and Test Vectors for HMAC-SHA-224,
      HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 [<a href="rfc4231.html" title="&quot;Identifiers and Test Vectors for HMAC-SHA-224, HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA- 512&quot;">RFC4231</a>].

   o  <a href="rfc4334.html">RFC 4334</a>, Certificate Extensions and Attributes Supporting
      Authentication in Point-to-Point Protocol (PPP) and Wireless Local
      Area Networks (WLAN) [<a href="rfc4334.html" title="&quot;Certificate Extensions and Attributes Supporting Authentication in Point-to-Point Protocol (PPP) and Wireless Local Area Networks (WLAN)&quot;">RFC4334</a>].

   o  <a href="rfc5083.html">RFC 5083</a>, Cryptographic Message Syntax (CMS) Authenticated-
      Enveloped-Data Content Type [<a href="rfc5083.html" title="&quot;Cryptographic Message Syntax (CMS) Authenticated-Enveloped-Data Content Type&quot;">RFC5083</a>].

   o  <a href="rfc5652.html">RFC 5652</a>, Cryptographic Message Syntax (CMS) [<a href="rfc5652.html" title="&quot;Cryptographic Message Syntax (CMS)&quot;">RFC5652</a>].

   o  <a href="rfc5752.html">RFC 5752</a>, Multiple Signatures in Cryptographic Message Syntax
      (CMS) [<a href="rfc5752.html" title="&quot;Multiple Signatures in Cryptographic Message Syntax (CMS)&quot;">RFC5752</a>].

   Note that some of the modules in this document get some of their
   definitions from places different than the modules in the original
   RFCs.  The idea is that these modules, when combined with the modules
   in [<a href="rfc5911.html" title="&quot;New ASN.1 Modules for Cryptographic Message Syntax (CMS) and S/MIME&quot;">RFC5911</a>] and [<a href="rfc5912.html" title="&quot;New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)&quot;">RFC5912</a>], can stand on their own and do not need to
   import definitions from anywhere else.






<span class="grey">Schaad &amp; Turner               Informational                     [Page 3]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


   This document does not explicitly update the RFCs from which the
   ASN.1 modules have been extracted.  This is because the original 1988
   ASN.1 syntax remains the normative version and the modules in this
   document as well as in [<a href="rfc5911.html" title="&quot;New ASN.1 Modules for Cryptographic Message Syntax (CMS) and S/MIME&quot;">RFC5911</a>] and [<a href="rfc5912.html" title="&quot;New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)&quot;">RFC5912</a>] are informative (but
   hopefully useful) annexes.

<span class="h3"><a class="selflink" name="section-1.1" href="#section-1.1">1.1</a>.  ASN.1 Updates (2002 to 2008)</span>

   The modules defined in this document are compatible with the most
   current ASN.1 specification published in 2008 (see [<a href="#ref-ASN1-2008" title="&quot;ITU-T Recommendations X.680, X.681, X.682, and X.683&quot;">ASN1-2008</a>]).  The
   changes between the 2002 specification and the 2008 specification
   include the creation of additional pre-defined types (DATE, DATE-
   TIME, DURATION, NOT-A-NUMBER, OID-IRI, RELATIVE-OID-IRI, TIME, TIME-
   OF-DAY) and the ability to define different encoding rules (ENCODING-
   CONTROL, INSTRUCTIONS).  None of the newly defined tokens are
   currently used in any of the ASN.1 specifications published here.

   Information on the changes to ASN.1 between the 1988 and 2002
   versions can be found in [<a href="rfc6025.html" title="&quot;ASN.1 Translation&quot;">RFC6025</a>].

<span class="h3"><a class="selflink" name="section-1.2" href="#section-1.2">1.2</a>.  Requirements Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].


























<span class="grey">Schaad &amp; Turner               Informational                     [Page 4]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  ASN.1 Module <a href="rfc3274.html">RFC 3274</a></span>

   We have updated the ASN.1 module associated with this document to be
   2008 compliant and to use the set of classes previously defined in
   [<a href="rfc5911.html" title="&quot;New ASN.1 Modules for Cryptographic Message Syntax (CMS) and S/MIME&quot;">RFC5911</a>].

   CompressedDataContent-2010
      { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
        smime(16) modules(0) id-mod-compressedDataContent(54) }

   DEFINITIONS IMPLICIT TAGS ::=
   BEGIN

   IMPORTS
     CMSVersion, ContentSet,
     CONTENT-TYPE
     FROM CryptographicMessageSyntax-2010
       { iso(1) member-body(2) us(840) rsadsi(113549)
          pkcs(1) pkcs-9(9) smime(16) modules(0) id-mod-cms-2009(58) }

     AlgorithmIdentifier{}, SMIME-CAPS, ParamOptions
     FROM AlgorithmInformation-2009
       {iso(1) identified-organization(3) dod(6) internet(1) security(5)
       mechanisms(5) pkix(7) id-mod(0)
       id-mod-algorithmInformation-02(58)}
     ;

     --
     --  ContentTypes contains the set of content types that are
     --    defined in this module.
     --
     --  The contents of ContentTypes should be added to
     --    ContentSet defined in [<a href="rfc5652.html" title="&quot;Cryptographic Message Syntax (CMS)&quot;">RFC5652</a>]
     --

     ContentTypes CONTENT-TYPE ::= {ct-compressedData}

     --
     --  SMimeCaps contains the set of S/MIME capabilities that
     --    are associated with the algorithms defined in this
     --    document.
     --
     --  SMimeCaps are added to the SMimeCapsSet defined in
     --  [<a href="rfc5751.html" title="&quot;Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.2 Message Specification&quot;">RFC5751</a>] as updated by [<a href="rfc5911.html" title="&quot;New ASN.1 Modules for Cryptographic Message Syntax (CMS) and S/MIME&quot;">RFC5911</a>].

     SMimeCaps SMIME-CAPS ::= {cpa-zlibCompress.&amp;smimeCaps, ...}





<span class="grey">Schaad &amp; Turner               Informational                     [Page 5]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


     --
     --  Define the compressed data content type
     --

     ct-compressedData CONTENT-TYPE ::= {
       TYPE CompressedData IDENTIFIED BY id-ct-compressedData
     }

     CompressedData ::= SEQUENCE {
        version CMSVersion (v0),  -- Always set to 0
        compressionAlgorithm CompressionAlgorithmIdentifier,
        encapContentInfo EncapsulatedContentInfo
     }

     EncapsulatedContentInfo ::= SEQUENCE {
        eContentType       CONTENT-TYPE.&amp;id({ContentSet}),
        eContent           [0] EXPLICIT OCTET STRING OPTIONAL }

     CompressionAlgorithmIdentifier ::=
        AlgorithmIdentifier{COMPRESS-ALGORITHM, {CompressAlgorithmSet}}

     CompressAlgorithmSet COMPRESS-ALGORITHM ::= {
       cpa-zlibCompress, ...
     }

     -- Algorithm Identifiers

     id-alg-zlibCompress OBJECT IDENTIFIER ::= { iso(1) member-body(2)
          us(840) rsadsi(113549) pkcs(1) pkcs-9(9) smime(16) alg(3) 8 }

     cpa-zlibCompress COMPRESS-ALGORITHM ::= {
       IDENTIFIER id-alg-zlibCompress
       PARAMS TYPE NULL ARE preferredAbsent
       SMIME-CAPS {IDENTIFIED BY id-alg-zlibCompress}
     }

     -- Content Type Object Identifiers

     id-ct-compressedData OBJECT IDENTIFIER ::= { iso(1) member-body(2)
          us(840) rsadsi(113549) pkcs(1) pkcs-9(9) smime(16) ct(1) 9 }

     --
     --  Class defined for compression algorithms
     --







<span class="grey">Schaad &amp; Turner               Informational                     [Page 6]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


     COMPRESS-ALGORITHM ::= CLASS {
       &amp;id                OBJECT IDENTIFIER UNIQUE,
       &amp;Params            OPTIONAL,
       &amp;paramPresence     ParamOptions DEFAULT absent,
       &amp;smimeCaps         SMIME-CAPS OPTIONAL
     }
     WITH SYNTAX {
       IDENTIFIER &amp;id
       [PARAMS [TYPE &amp;Params] ARE &amp;paramPresence]
       [SMIME-CAPS &amp;smimeCaps]
     }

    END

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  ASN.1 Module <a href="rfc3779.html">RFC 3779</a></span>

   We have updated the ASN.1 module associated with <a href="rfc3779.html">RFC 3779</a> to be ASN.1
   2008 compliant and to use the set of classes previously defined in
   [<a href="rfc5912.html" title="&quot;New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)&quot;">RFC5912</a>].

   IPAddrAndASCertExtn-2010 { iso(1) identified-organization(3) dod(6)
            internet(1) security(5) mechanisms(5) pkix(7) mod(0)
            id-mod-ip-addr-and-as-ident-2(72) }
   DEFINITIONS EXPLICIT TAGS ::=
   BEGIN
      EXPORTS ALL;

      IMPORTS

      -- PKIX specific OIDs and arcs --
      id-pe
      FROM PKIX1Explicit-2009
        { iso(1) identified-organization(3) dod(6) internet(1)
          security(5) mechanisms(5) pkix(7) id-mod(0)
          id-mod-pkix1-explicit-02(51)}

      EXTENSION
      FROM PKIX-CommonTypes-2009
        { iso(1) identified-organization(3) dod(6) internet(1)
          security(5) mechanisms(5) pkix(7) id-mod(0)
          id-mod-pkixCommon-02(57)}
      ;









<span class="grey">Schaad &amp; Turner               Informational                     [Page 7]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


      --
      --  Extensions contains the set of extensions defined in this
      --      module
      --
      --  These are intended to be placed in public key certificates
      --     and thus should be added to the CertExtensions extension
      --     set in PKIXImplicit-2009 defined for [<a href="rfc5280.html" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC5280</a>]
      --

      Extensions EXTENSION ::= {
         ext-pe-ipAddrBlocks | ext-pe-autonomousSysIds
      }

      -- IP Address Delegation Extension OID --

      ext-pe-ipAddrBlocks EXTENSION ::= {
        SYNTAX IPAddrBlocks
        IDENTIFIED BY id-pe-ipAddrBlocks
      }

      id-pe-ipAddrBlocks  OBJECT IDENTIFIER ::= { id-pe 7 }

      -- IP Address Delegation Extension Syntax --

      IPAddrBlocks        ::= SEQUENCE OF IPAddressFamily

      IPAddressFamily     ::= SEQUENCE { -- AFI &amp; opt SAFI --
         addressFamily        OCTET STRING (SIZE (2..3)),
         ipAddressChoice      IPAddressChoice }

      IPAddressChoice     ::= CHOICE {
         inherit              NULL, -- inherit from issuer --
         addressesOrRanges    SEQUENCE OF IPAddressOrRange }

      IPAddressOrRange    ::= CHOICE {
         addressPrefix        IPAddress,
         addressRange         IPAddressRange }

      IPAddressRange      ::= SEQUENCE {
         min                  IPAddress,
         max                  IPAddress }

      IPAddress           ::= BIT STRING








<span class="grey">Schaad &amp; Turner               Informational                     [Page 8]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


      -- Autonomous System Identifier Delegation Extension OID --

      ext-pe-autonomousSysIds EXTENSION ::= {
        SYNTAX ASIdentifiers
        IDENTIFIED BY id-pe-autonomousSysIds
      }

      id-pe-autonomousSysIds  OBJECT IDENTIFIER ::= { id-pe 8 }

      -- Autonomous System Identifier Delegation Extension Syntax --

      ASIdentifiers       ::= SEQUENCE {
          asnum               [0] ASIdentifierChoice OPTIONAL,
          rdi                 [1] ASIdentifierChoice OPTIONAL }
          (WITH COMPONENTS {..., asnum PRESENT} |
           WITH COMPONENTS {..., rdi PRESENT})

      ASIdentifierChoice  ::= CHOICE {
         inherit              NULL, -- inherit from issuer --
         asIdsOrRanges        SEQUENCE OF ASIdOrRange }

      ASIdOrRange         ::= CHOICE {
          id                  ASId,
          range               ASRange }

      ASRange             ::= SEQUENCE {
          min                 ASId,
          max                 ASId }

      ASId                ::= INTEGER

   END



















<span class="grey">Schaad &amp; Turner               Informational                     [Page 9]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  ASN.1 Module <a href="rfc6019.html">RFC 6019</a></span>

   We have updated the ASN.1 module associated with this document to be
   2008 compliant and to use the set of classes previously defined in
   [<a href="rfc5911.html" title="&quot;New ASN.1 Modules for Cryptographic Message Syntax (CMS) and S/MIME&quot;">RFC5911</a>].

   BinarySigningTimeModule-2010
         { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)
           pkcs-9(9) smime(16) modules(0)
           id-mod-binSigningTime-2009(55) }
   DEFINITIONS IMPLICIT TAGS ::=
   BEGIN
     IMPORTS

     -- From PKIX-CommonTypes-2009 [<a href="rfc5912.html" title="&quot;New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)&quot;">RFC5912</a>]

     ATTRIBUTE
       FROM PKIX-CommonTypes-2009
         { iso(1) identified-organization(3) dod(6) internet(1)
           security(5) mechanisms(5) pkix(7) id-mod(0)
           id-mod-pkixCommon-02(57) }
    ;

     --
     -- BinaryTime Definition
     --
     --  BinaryTime contains the number seconds since
     --  midnight Jan 1, 1970 UTC.
     --  Leap seconds are EXCLUDED from the computation.
     --

     BinaryTime ::= INTEGER (0..MAX)

     --
     -- Signing Binary Time Attribute
     --
     --   The binary signing time should be added to
     --   SignedAttributeSet and AuthAttributeSet in CMS [<a href="rfc5652.html" title="&quot;Cryptographic Message Syntax (CMS)&quot;">RFC5652</a>]
     --   and to AuthEnvDataAttributeSet in [<a href="rfc5083.html" title="&quot;Cryptographic Message Syntax (CMS) Authenticated-Enveloped-Data Content Type&quot;">RFC5083</a>] with the
     --   new modules in this document, <a href="rfc6268.html">RFC 6268</a>.
     --










<span class="grey">Schaad &amp; Turner               Informational                    [Page 10]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


     aa-binarySigningTime ATTRIBUTE ::= {
       TYPE BinarySigningTime
       IDENTIFIED BY id-aa-binarySigningTime }

     id-aa-binarySigningTime OBJECT IDENTIFIER ::= { iso(1)
       member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs9(9)
       smime(16) aa(2) 46 }

     BinarySigningTime ::= BinaryTime

   END

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  ASN.1 Module <a href="rfc4073.html">RFC 4073</a></span>

   We have updated the ASN.1 module associated with this document to be
   2008 compliant and to use the set of classes previously defined in
   [<a href="rfc5911.html" title="&quot;New ASN.1 Modules for Cryptographic Message Syntax (CMS) and S/MIME&quot;">RFC5911</a>].

  ContentCollectionModule-2010
      { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)
        pkcs-9(9) smime(16) modules(0) id-mod-context-Collect-2009(56) }
  DEFINITIONS IMPLICIT TAGS ::=
  BEGIN
    IMPORTS

    -- From CryptographicMessageSyntax-2010 [<a href="rfc6268.html">RFC6268</a>]

    CONTENT-TYPE, ContentInfo
      FROM CryptographicMessageSyntax-2010
      { iso(1) member-body(2) us(840) rsadsi(113549)
         pkcs(1) pkcs-9(9) smime(16) modules(0) id-mod-cms-2009(58) }

    AttributeSet{}, ATTRIBUTE
      FROM PKIX-CommonTypes-2009
        { iso(1) identified-organization(3) dod(6) internet(1)
          security(5) mechanisms(5) pkix(7) id-mod(0)
          id-mod-pkixCommon-02(57) }
    ;

    --
    --  An object set of all content types defined by this module.
    --    This is to be added to ContentSet in the CMS module
    --

    ContentSet CONTENT-TYPE ::= {
        ct-ContentCollection | ct-ContentWithAttributes, ...
    }




<span class="grey">Schaad &amp; Turner               Informational                    [Page 11]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


    --
    -- Content Collection Content Type and Object Identifier
    --

    ct-ContentCollection CONTENT-TYPE ::= {
      TYPE ContentCollection IDENTIFIED BY id-ct-contentCollection }

    id-ct-contentCollection OBJECT IDENTIFIER ::= {
      iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
      smime(16) ct(1) 19 }

    ContentCollection ::= SEQUENCE SIZE (1..MAX) OF ContentInfo

    --
    -- Content With Attributes Content Type and Object Identifier
    --

    ct-ContentWithAttributes CONTENT-TYPE ::= {
      TYPE ContentWithAttributes IDENTIFIED BY id-ct-contentWithAttrs }

    id-ct-contentWithAttrs OBJECT IDENTIFIER ::= {
      iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
      smime(16) ct(1) 20 }

    ContentWithAttributes ::= SEQUENCE {
       content  ContentInfo,
       attrs    SEQUENCE SIZE (1..MAX) OF AttributeSet
                                               {{ ContentAttributeSet }}
    }

     ContentAttributeSet ATTRIBUTE ::= { ... }
  END

<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  ASN.1 Module <a href="rfc4231.html">RFC 4231</a></span>

   <a href="rfc4231.html">RFC 4231</a> does not contain an ASN.1 module to be updated.  We have
   therefore created an ASN.1 module to represent the ASN.1 that is
   present in the document.  Note that the parameters are defined as
   expecting a parameter for the algorithm identifiers in this module;
   this is different from most of the algorithms used in PKIX and
   S/MIME.  There is no concept of being able to truncate the MAC
   (Message Authentication Code) value in the ASN.1 unlike the XML
   definitions.  This is reflected by not having a minimum MAC length
   defined in the ASN.1.







<span class="grey">Schaad &amp; Turner               Informational                    [Page 12]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


  HMAC-2010  { iso(1) identified-organization(3) dod(6) internet(1)
     security(5) mechanisms(5) pkix(7) mod(0) id-mod-hmac(74) }
  DEFINITIONS EXPLICIT TAGS ::=
  BEGIN
    EXPORTS ALL;

    IMPORTS

    MAC-ALGORITHM, SMIME-CAPS
    FROM AlgorithmInformation-2009
      { iso(1) identified-organization(3) dod(6) internet(1) security(5)
        mechanisms(5) pkix(7) id-mod(0)
        id-mod-algorithmInformation-02(58)};

    --
    --  This object set contains all of the MAC algorithms that are
    --    defined in this module.
    --  One would add it to a constraining set of objects such as the
    --    MessageAuthenticationCodeAlgorithmSet in [<a href="rfc5652.html" title="&quot;Cryptographic Message Syntax (CMS)&quot;">RFC5652</a>]
    --

    MessageAuthAlgs MAC-ALGORITHM ::= {
      maca-hMAC-SHA224 |
      maca-hMAC-SHA256 |
      maca-hMAC-SHA384 |
      maca-hMAC-SHA512
    }

    --
    --  This object set contains all of the S/MIME capabilities that
    --     have been defined for all the MAC algorithms in this module.
    --  One would add this to an object set that is used to restrict
    --    S/MIME capabilities such as the SMimeCapsSet variable in
    --    <a href="rfc3851.html">RFC 3851</a> (obsoleted by <a href="rfc5751.html">RFC 5751</a>) as modified in <a href="rfc5911.html">RFC 5911</a>.
    --

    SMimeCaps SMIME-CAPS ::= {
      maca-hMAC-SHA224.&amp;smimeCaps     |
      maca-hMAC-SHA256.&amp;smimeCaps     |
      maca-hMAC-SHA384.&amp;smimeCaps     |
      maca-hMAC-SHA512.&amp;smimeCaps
    }

    --
    --  Define the base OID for the algorithm identifiers
    --





<span class="grey">Schaad &amp; Turner               Informational                    [Page 13]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


    rsadsi OBJECT IDENTIFIER ::=
         {iso(1) member-body(2) us(840) rsadsi(113549)}

    digestAlgorithm   OBJECT IDENTIFIER ::= {rsadsi 2}

    --
    --  Define the necessary algorithm identifiers
    --

    id-hmacWithSHA224 OBJECT IDENTIFIER ::= {digestAlgorithm 8}
    id-hmacWithSHA256 OBJECT IDENTIFIER ::= {digestAlgorithm 9}
    id-hmacWithSHA384 OBJECT IDENTIFIER ::= {digestAlgorithm 10}
    id-hmacWithSHA512 OBJECT IDENTIFIER ::= {digestAlgorithm 11}

    --
    --  Define each of the MAC-ALGORITHM objects to describe the
    --    algorithms defined
    --

    maca-hMAC-SHA224 MAC-ALGORITHM ::= {
      IDENTIFIER id-hmacWithSHA224
      PARAMS TYPE NULL ARE preferredPresent
      IS-KEYED-MAC TRUE
      SMIME-CAPS {IDENTIFIED BY id-hmacWithSHA224}
    }


    maca-hMAC-SHA256 MAC-ALGORITHM ::= {
      IDENTIFIER id-hmacWithSHA256
      PARAMS TYPE NULL ARE preferredPresent
      IS-KEYED-MAC TRUE
      SMIME-CAPS {IDENTIFIED BY id-hmacWithSHA256}
    }


    maca-hMAC-SHA384 MAC-ALGORITHM ::= {
      IDENTIFIER id-hmacWithSHA384
      PARAMS TYPE NULL ARE preferredPresent
      IS-KEYED-MAC TRUE
      SMIME-CAPS {IDENTIFIED BY id-hmacWithSHA384}
    }










<span class="grey">Schaad &amp; Turner               Informational                    [Page 14]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-15" id="page-15" href="#page-15" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


    maca-hMAC-SHA512 MAC-ALGORITHM ::= {
      IDENTIFIER id-hmacWithSHA512
      PARAMS TYPE NULL ARE preferredPresent
      IS-KEYED-MAC TRUE
      SMIME-CAPS {IDENTIFIED BY id-hmacWithSHA512}
    }

  END

<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  ASN.1 Module <a href="rfc4334.html">RFC 4334</a></span>

   We have updated the ASN.1 module associated with <a href="rfc4334.html">RFC 4334</a> to be ASN.1
   2008 compliant and to use the set of classes previously defined in
   [<a href="rfc5912.html" title="&quot;New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)&quot;">RFC5912</a>].

  WLANCertExtn-2010
     { iso(1) identified-organization(3) dod(6) internet(1)
       security(5) mechanisms(5) pkix(7) id-mod(0)
       id-mod-wlan-extns-2(73) }

  DEFINITIONS IMPLICIT TAGS ::=
  BEGIN
    EXPORTS ALL;

    IMPORTS

    EXTENSION, ATTRIBUTE
    FROM PKIX-CommonTypes-2009
      {iso(1) identified-organization(3) dod(6) internet(1) security(5)
      mechanisms(5) pkix(7) id-mod(0) id-mod-pkixCommon-02(57)}

    id-pe, id-kp
    FROM PKIX1Explicit-2009
      { iso(1) identified-organization(3) dod(6) internet(1) security(5)
        mechanisms(5) pkix(7) id-mod(0) id-mod-pkix1-explicit-02(51)}

    id-aca
    FROM PKIXAttributeCertificate-2009
      { iso(1) identified-organization(3) dod(6) internet(1) security(5)
        mechanisms(5) pkix(7) id-mod(0) id-mod-attribute-cert-02(47)}

    ;

    -- Extended Key Usage Values

    KeyUsageValues OBJECT IDENTIFIER ::= {
        id-kp-eapOverPPP | id-kp-eapOverLAN
    }



<span class="grey">Schaad &amp; Turner               Informational                    [Page 15]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-16" id="page-16" href="#page-16" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


    id-kp-eapOverPPP  OBJECT IDENTIFIER  ::=  { id-kp 13 }

    id-kp-eapOverLAN  OBJECT IDENTIFIER  ::=  { id-kp 14 }


    -- Wireless LAN SSID Extension


    ext-pe-wlanSSID EXTENSION ::= {
      SYNTAX SSIDList
      IDENTIFIED BY id-pe-wlanSSID
      CRITICALITY {FALSE}
    }

    id-pe-wlanSSID  OBJECT IDENTIFIER  ::=  { id-pe 13 }

    SSIDList  ::=  SEQUENCE SIZE (1..MAX) OF SSID

    SSID  ::=  OCTET STRING (SIZE (1..32))

    -- Wireless LAN SSID Attribute Certificate Attribute
    -- Uses same syntax as the certificate extension: SSIDList


     at-aca-wlanSSID ATTRIBUTE ::= {
       TYPE SSIDList
       IDENTIFIED BY id-aca-wlanSSID
     }


     id-aca-wlanSSID  OBJECT IDENTIFIER ::= { id-aca 7 }

    END

<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  ASN.1 Module <a href="rfc5083.html">RFC 5083</a></span>

   This module is updated from <a href="rfc5911.html">RFC 5911</a> [<a href="rfc5911.html" title="&quot;New ASN.1 Modules for Cryptographic Message Syntax (CMS) and S/MIME&quot;">RFC5911</a>] by the following
   changes:

   1.  Define separate attribute sets for the unprotected attributes
       used in EnvelopedData, EncryptedData, and
       AuthenticatedEnvelopedData (<a href="rfc5083.html">RFC 5083</a>).

   2.  Define a parameterized type EncryptedContentInfoType so that the
       basic type can be used with different algorithm sets (used for
       EnvelopedData, EncryptedData, and AuthenticatedEnvelopedData (RFC





<span class="grey">Schaad &amp; Turner               Informational                    [Page 16]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-17" id="page-17" href="#page-17" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


       5083)).  The parameterized type is assigned to an unparameterized
       type of EncryptedContentInfo to minimize the output changes from
       previous versions.

   Protocol designers can make use of the '08 ASN.1 constraints to
   define different sets of attributes for EncryptedData and
   EnvelopedData and for AuthenticatedData and AuthEnvelopedData.
   Previously, attributes could only be constrained based on whether
   they were in the clear or unauthenticated not on the encapsulating
   content type.

 CMS-AuthEnvelopedData-2010
     {iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
     smime(16) modules(0) id-mod-cmsAuthEnvData-2009(57) }
 DEFINITIONS IMPLICIT TAGS ::=
 BEGIN
 IMPORTS

 CMSVersion, EncryptedContentInfoType{},
   MessageAuthenticationCode, OriginatorInfo, RecipientInfos,
   CONTENT-TYPE, Attributes{}, ATTRIBUTE, CONTENT-ENCRYPTION,
   AlgorithmIdentifier{},
   aa-signingTime, aa-messageDigest, aa-contentType
 FROM CryptographicMessageSyntax-2010
   { iso(1) member-body(2) us(840) rsadsi(113549)
      pkcs(1) pkcs-9(9) smime(16) modules(0) id-mod-cms-2009(58) }

 ContentEncryptionAlgs
 FROM CMS-AES-CCM-and-AES-GCM-2009
   { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)
     pkcs-9(9) smime(16) modules(0) id-mod-cms-aes-ccm-gcm-02(44) }
 ;

 ContentTypes CONTENT-TYPE ::= {ct-authEnvelopedData, ... }

 ct-authEnvelopedData CONTENT-TYPE ::= {
   TYPE AuthEnvelopedData IDENTIFIED BY id-ct-authEnvelopedData
 }

 id-ct-authEnvelopedData OBJECT IDENTIFIER ::=
   {iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
   smime(16) ct(1) 23}

 AuthEnvelopedData ::= SEQUENCE {
   version CMSVersion,
   originatorInfo [0] IMPLICIT OriginatorInfo OPTIONAL,
   recipientInfos RecipientInfos,
   authEncryptedContentInfo EncryptedContentInfo,



<span class="grey">Schaad &amp; Turner               Informational                    [Page 17]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-18" id="page-18" href="#page-18" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


   authAttrs [1] IMPLICIT AuthAttributes OPTIONAL,
   mac MessageAuthenticationCode,
   unauthAttrs [2] IMPLICIT UnauthAttributes OPTIONAL
 }

 EncryptedContentInfo ::=
   EncryptedContentInfoType { AuthContentEncryptionAlgorithmIdentifier }

 AuthContentEncryptionAlgorithmIdentifier ::= AlgorithmIdentifier
   {CONTENT-ENCRYPTION, {AuthContentEncryptionAlgorithmSet}}

 AuthContentEncryptionAlgorithmSet CONTENT-ENCRYPTION ::= {
   ContentEncryptionAlgs, ...}

 AuthAttributes ::= Attributes{{AuthEnvDataAttributeSet}}

 UnauthAttributes ::= Attributes{{UnauthEnvDataAttributeSet}}

 AuthEnvDataAttributeSet ATTRIBUTE ::= {
   aa-contentType | aa-messageDigest | aa-signingTime, ... }

 UnauthEnvDataAttributeSet ATTRIBUTE ::= {...}

 END

<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  ASN.1 Module <a href="rfc5652.html">RFC 5652</a></span>

   This module is updated from <a href="rfc5911.html">RFC 5911</a> [<a href="rfc5911.html" title="&quot;New ASN.1 Modules for Cryptographic Message Syntax (CMS) and S/MIME&quot;">RFC5911</a>] by the following
   changes:

   1.  Define separate attribute sets for the unprotected attributes
       used in EnvelopedData, EncryptedData, and
       AuthenticatedEnvelopedData (<a href="rfc5083.html">RFC 5083</a>).

   2.  Define a parameterized type EncryptedContentInfoType so that the
       basic type can be used with algorithm sets (used for
       EnvelopedData, EncryptedData, and AuthenticatedEnvelopedData (<a href="rfc5083.html">RFC</a>
       <a href="rfc5083.html">5083</a>)).  The parameterized type is assigned to an unparameterized
       type of EncryptedContentInfo to minimize the output changes from
       previous versions.

   We are anticipating the definition of attributes that are going to be
   restricted to the use of only EnvelopedData.  We are therefore
   separating the different attribute sets so that protocol designers
   that need to do this will be able to define attributes that are used
   for EnvelopedData, but not for EncryptedData.  The same separation is
   also being applied to AuthenticatedData and AuthEnvelopedData.




<span class="grey">Schaad &amp; Turner               Informational                    [Page 18]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-19" id="page-19" href="#page-19" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


   CryptographicMessageSyntax-2010
       { iso(1) member-body(2) us(840) rsadsi(113549)
          pkcs(1) pkcs-9(9) smime(16) modules(0) id-mod-cms-2009(58) }
   DEFINITIONS IMPLICIT TAGS ::=
   BEGIN
   IMPORTS

   ParamOptions, DIGEST-ALGORITHM, SIGNATURE-ALGORITHM,
     PUBLIC-KEY, KEY-DERIVATION, KEY-WRAP, MAC-ALGORITHM,
     KEY-AGREE, KEY-TRANSPORT, CONTENT-ENCRYPTION, ALGORITHM,
     AlgorithmIdentifier{}
   FROM AlgorithmInformation-2009
     {iso(1) identified-organization(3) dod(6) internet(1) security(5)
     mechanisms(5) pkix(7) id-mod(0)
     id-mod-algorithmInformation-02(58)}

   SignatureAlgs, MessageDigestAlgs, KeyAgreementAlgs,
     MessageAuthAlgs, KeyWrapAlgs, ContentEncryptionAlgs,
     KeyTransportAlgs, KeyDerivationAlgs, KeyAgreePublicKeys
   FROM CryptographicMessageSyntaxAlgorithms-2009
     { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
     smime(16) modules(0) id-mod-cmsalg-2001-02(37) }

   Certificate, CertificateList, CertificateSerialNumber,
     Name, ATTRIBUTE
   FROM PKIX1Explicit-2009
     { iso(1) identified-organization(3) dod(6) internet(1)
     security(5) mechanisms(5) pkix(7) id-mod(0)
     id-mod-pkix1-explicit-02(51) }

   AttributeCertificate
   FROM PKIXAttributeCertificate-2009
     { iso(1) identified-organization(3) dod(6) internet(1)
     security(5) mechanisms(5) pkix(7) id-mod(0)
     id-mod-attribute-cert-02(47) }

   AttributeCertificateV1
   FROM AttributeCertificateVersion1-2009
     { iso(1) identified-organization(3) dod(6) internet(1)
     security(5) mechanisms(5) pkix(7) id-mod(0)
     id-mod-v1AttrCert-02(49) } ;










<span class="grey">Schaad &amp; Turner               Informational                    [Page 19]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-20" id="page-20" href="#page-20" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


   -- Cryptographic Message Syntax

   -- The following are used for version numbers using the ASN.1
   -- NOTE: The document reference represents where the versioned
   --   feature was introduced to the module.
   --
   --   idiom "[[n:"
   --   Version 1 = PKCS #7
   --   Version 2 = S/MIME V2
   --   Version 3 = <a href="rfc2630.html">RFC 2630</a>
   --   Version 4 = <a href="rfc3369.html">RFC 3369</a>
   --   Version 5 = <a href="rfc3852.html">RFC 3852</a>

   CONTENT-TYPE ::= CLASS {
     &amp;id        OBJECT IDENTIFIER UNIQUE,
     &amp;Type      OPTIONAL
   } WITH SYNTAX {
       [TYPE &amp;Type] IDENTIFIED BY &amp;id
   }

   ContentType ::= CONTENT-TYPE.&amp;id

   ContentInfo ::= SEQUENCE {
     contentType        CONTENT-TYPE.
                     &amp;id({ContentSet}),
     content            [0] EXPLICIT CONTENT-TYPE.
                     &amp;Type({ContentSet}{@contentType})}

   ContentSet CONTENT-TYPE ::= {
     --  Define the set of content types to be recognized.
     ct-Data | ct-SignedData | ct-EncryptedData | ct-EnvelopedData |
     ct-AuthenticatedData | ct-DigestedData, ... }

   SignedData ::= SEQUENCE {
     version CMSVersion,
     digestAlgorithms SET OF DigestAlgorithmIdentifier,
     encapContentInfo EncapsulatedContentInfo,
     certificates [0] IMPLICIT CertificateSet OPTIONAL,
     crls [1] IMPLICIT RevocationInfoChoices OPTIONAL,
     signerInfos SignerInfos }

   SignerInfos ::= SET OF SignerInfo

   EncapsulatedContentInfo ::= SEQUENCE {
     eContentType       CONTENT-TYPE.&amp;id({ContentSet}),
     eContent           [0] EXPLICIT OCTET STRING
             ( CONTAINING CONTENT-TYPE.
                 &amp;Type({ContentSet}{@eContentType})) OPTIONAL }



<span class="grey">Schaad &amp; Turner               Informational                    [Page 20]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-21" id="page-21" href="#page-21" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


   SignerInfo ::= SEQUENCE {
     version CMSVersion,
     sid SignerIdentifier,
     digestAlgorithm DigestAlgorithmIdentifier,
     signedAttrs [0] IMPLICIT SignedAttributes OPTIONAL,
     signatureAlgorithm SignatureAlgorithmIdentifier,
     signature SignatureValue,
     unsignedAttrs [1] IMPLICIT Attributes
         {{UnsignedAttributes}} OPTIONAL }

   SignedAttributes ::= Attributes {{ SignedAttributesSet }}

   SignerIdentifier ::= CHOICE {
     issuerAndSerialNumber IssuerAndSerialNumber,
     ...,
     [[3: subjectKeyIdentifier [0] SubjectKeyIdentifier ]] }

   SignedAttributesSet ATTRIBUTE ::=
     { aa-signingTime | aa-messageDigest | aa-contentType, ... }

   UnsignedAttributes ATTRIBUTE ::= { aa-countersignature, ... }

   SignatureValue ::= OCTET STRING

   EnvelopedData ::= SEQUENCE {
     version CMSVersion,
     originatorInfo [0] IMPLICIT OriginatorInfo OPTIONAL,
     recipientInfos RecipientInfos,
     encryptedContentInfo EncryptedContentInfo,
     ...,
     [[2: unprotectedAttrs [1] IMPLICIT Attributes
         {{ UnprotectedEnvAttributes }} OPTIONAL ]] }

   OriginatorInfo ::= SEQUENCE {
     certs [0] IMPLICIT CertificateSet OPTIONAL,
     crls [1] IMPLICIT RevocationInfoChoices OPTIONAL }

   RecipientInfos ::= SET SIZE (1..MAX) OF RecipientInfo

   EncryptedContentInfo ::=
     EncryptedContentInfoType { ContentEncryptionAlgorithmIdentifier }

   EncryptedContentInfoType { AlgorithmIdentifierType } ::= SEQUENCE {
     contentType        CONTENT-TYPE.&amp;id({ContentSet}),
     contentEncryptionAlgorithm AlgorithmIdentifierType,
     encryptedContent   [0] IMPLICIT OCTET STRING OPTIONAL }





<span class="grey">Schaad &amp; Turner               Informational                    [Page 21]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-22" id="page-22" href="#page-22" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


   -- If you want to do constraints, you might use:
   -- EncryptedContentInfo ::= SEQUENCE {
   --  contentType        CONTENT-TYPE.&amp;id({ContentSet}),
   --  contentEncryptionAlgorithm ContentEncryptionAlgorithmIdentifier,
   --  encryptedContent   [0] IMPLICIT ENCRYPTED {CONTENT-TYPE.
   --      &amp;Type({ContentSet}{@contentType}) OPTIONAL }
   -- ENCRYPTED {ToBeEncrypted} ::= OCTET STRING ( CONSTRAINED BY
   --        { ToBeEncrypted } )

   UnprotectedEnvAttributes ATTRIBUTE ::=  { ... }
   UnprotectedEncAttributes ATTRIBUTE ::=  { ... }

   RecipientInfo ::= CHOICE {
     ktri           KeyTransRecipientInfo,
     ...,
     [[3: kari  [1] KeyAgreeRecipientInfo ]],
     [[4: kekri [2] KEKRecipientInfo]],
     [[5: pwri  [3] PasswordRecipientInfo,
          ori   [4] OtherRecipientInfo ]] }

   EncryptedKey ::= OCTET STRING

   KeyTransRecipientInfo ::= SEQUENCE {
     version CMSVersion,  -- always set to 0 or 2
     rid RecipientIdentifier,
     keyEncryptionAlgorithm AlgorithmIdentifier
         {KEY-TRANSPORT, {KeyTransportAlgorithmSet}},
     encryptedKey EncryptedKey }

   KeyTransportAlgorithmSet KEY-TRANSPORT ::= { KeyTransportAlgs, ... }

   RecipientIdentifier ::= CHOICE {
     issuerAndSerialNumber IssuerAndSerialNumber,
     ...,
     [[2: subjectKeyIdentifier [0] SubjectKeyIdentifier ]] }
   KeyAgreeRecipientInfo ::= SEQUENCE {
     version CMSVersion,  -- always set to 3
     originator [0] EXPLICIT OriginatorIdentifierOrKey,
     ukm [1] EXPLICIT UserKeyingMaterial OPTIONAL,
     keyEncryptionAlgorithm AlgorithmIdentifier
         {KEY-AGREE, {KeyAgreementAlgorithmSet}},
     recipientEncryptedKeys RecipientEncryptedKeys }

   KeyAgreementAlgorithmSet KEY-AGREE ::= { KeyAgreementAlgs, ... }







<span class="grey">Schaad &amp; Turner               Informational                    [Page 22]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-23" id="page-23" href="#page-23" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


   OriginatorIdentifierOrKey ::= CHOICE {
     issuerAndSerialNumber IssuerAndSerialNumber,
     subjectKeyIdentifier [0] SubjectKeyIdentifier,
     originatorKey [1] OriginatorPublicKey }

   OriginatorPublicKey ::= SEQUENCE {
     algorithm AlgorithmIdentifier {PUBLIC-KEY, {OriginatorKeySet}},
     publicKey BIT STRING }

   OriginatorKeySet PUBLIC-KEY ::= { KeyAgreePublicKeys, ... }

   RecipientEncryptedKeys ::= SEQUENCE OF RecipientEncryptedKey

   RecipientEncryptedKey ::= SEQUENCE {
     rid KeyAgreeRecipientIdentifier,
     encryptedKey EncryptedKey }

   KeyAgreeRecipientIdentifier ::= CHOICE {
     issuerAndSerialNumber IssuerAndSerialNumber,
     rKeyId [0] IMPLICIT RecipientKeyIdentifier }

   RecipientKeyIdentifier ::= SEQUENCE {
     subjectKeyIdentifier SubjectKeyIdentifier,
     date GeneralizedTime OPTIONAL,
     other OtherKeyAttribute OPTIONAL }

   SubjectKeyIdentifier ::= OCTET STRING

   KEKRecipientInfo ::= SEQUENCE {
     version CMSVersion,  -- always set to 4
     kekid KEKIdentifier,
     keyEncryptionAlgorithm KeyEncryptionAlgorithmIdentifier,
     encryptedKey EncryptedKey }

   KEKIdentifier ::= SEQUENCE {
     keyIdentifier OCTET STRING,
     date GeneralizedTime OPTIONAL,
     other OtherKeyAttribute OPTIONAL }
   PasswordRecipientInfo ::= SEQUENCE {
     version CMSVersion,   -- always set to 0
     keyDerivationAlgorithm [0] KeyDerivationAlgorithmIdentifier
                             OPTIONAL,
     keyEncryptionAlgorithm KeyEncryptionAlgorithmIdentifier,
     encryptedKey EncryptedKey }

   OTHER-RECIPIENT ::= TYPE-IDENTIFIER





<span class="grey">Schaad &amp; Turner               Informational                    [Page 23]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-24" id="page-24" href="#page-24" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


   OtherRecipientInfo ::= SEQUENCE {
     oriType    OTHER-RECIPIENT.
             &amp;id({SupportedOtherRecipInfo}),
     oriValue   OTHER-RECIPIENT.
             &amp;Type({SupportedOtherRecipInfo}{@oriType})}

   SupportedOtherRecipInfo OTHER-RECIPIENT ::= { ... }

   DigestedData ::= SEQUENCE {
     version CMSVersion,
     digestAlgorithm DigestAlgorithmIdentifier,
     encapContentInfo EncapsulatedContentInfo,
     digest Digest, ... }

   Digest ::= OCTET STRING

   EncryptedData ::= SEQUENCE {
     version CMSVersion,
     encryptedContentInfo EncryptedContentInfo,
     ...,
     [[2: unprotectedAttrs [1] IMPLICIT Attributes
         {{UnprotectedEncAttributes}} OPTIONAL ]] }

   AuthenticatedData ::= SEQUENCE {
     version CMSVersion,
     originatorInfo [0] IMPLICIT OriginatorInfo OPTIONAL,
     recipientInfos RecipientInfos,
     macAlgorithm MessageAuthenticationCodeAlgorithm,
     digestAlgorithm [1] DigestAlgorithmIdentifier OPTIONAL,
     encapContentInfo EncapsulatedContentInfo,
     authAttrs [2] IMPLICIT AuthAttributes OPTIONAL,
     mac MessageAuthenticationCode,
     unauthAttrs [3] IMPLICIT UnauthAttributes OPTIONAL }

   AuthAttributes ::= SET SIZE (1..MAX) OF Attribute
     {{AuthAttributeSet}}

   AuthAttributeSet ATTRIBUTE ::= { aa-contentType | aa-messageDigest
                                        | aa-signingTime, ...}

   MessageAuthenticationCode ::= OCTET STRING

   UnauthAttributes ::= SET SIZE (1..MAX) OF Attribute
       {{UnauthAttributeSet}}

   UnauthAttributeSet ATTRIBUTE ::= {...}





<span class="grey">Schaad &amp; Turner               Informational                    [Page 24]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-25" id="page-25" href="#page-25" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


   --
   --  General algorithm definitions
   --

   DigestAlgorithmIdentifier ::= AlgorithmIdentifier
     {DIGEST-ALGORITHM, {DigestAlgorithmSet}}

   DigestAlgorithmSet DIGEST-ALGORITHM ::= {
     CryptographicMessageSyntaxAlgorithms-2009.MessageDigestAlgs, ... }

   SignatureAlgorithmIdentifier ::= AlgorithmIdentifier
     {SIGNATURE-ALGORITHM, {SignatureAlgorithmSet}}

   SignatureAlgorithmSet SIGNATURE-ALGORITHM ::=
     { SignatureAlgs, ... }

   KeyEncryptionAlgorithmIdentifier ::= AlgorithmIdentifier
     {KEY-WRAP, {KeyEncryptionAlgorithmSet}}

   KeyEncryptionAlgorithmSet KEY-WRAP ::= { KeyWrapAlgs, ... }

   ContentEncryptionAlgorithmIdentifier ::= AlgorithmIdentifier
     {CONTENT-ENCRYPTION, {ContentEncryptionAlgorithmSet}}

   ContentEncryptionAlgorithmSet CONTENT-ENCRYPTION ::=
     { ContentEncryptionAlgs, ... }

   MessageAuthenticationCodeAlgorithm ::= AlgorithmIdentifier
     {MAC-ALGORITHM, {MessageAuthenticationCodeAlgorithmSet}}

   MessageAuthenticationCodeAlgorithmSet MAC-ALGORITHM ::=
     { MessageAuthAlgs, ... }

   KeyDerivationAlgorithmIdentifier ::= AlgorithmIdentifier
     {KEY-DERIVATION, {KeyDerivationAlgs, ...}}

   RevocationInfoChoices ::= SET OF RevocationInfoChoice

   RevocationInfoChoice ::= CHOICE {
     crl CertificateList,
     ...,
     [[5: other [1] IMPLICIT OtherRevocationInfoFormat ]] }

   OTHER-REVOK-INFO ::= TYPE-IDENTIFIER







<span class="grey">Schaad &amp; Turner               Informational                    [Page 25]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-26" id="page-26" href="#page-26" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


   OtherRevocationInfoFormat ::= SEQUENCE {
     otherRevInfoFormat    OTHER-REVOK-INFO.
             &amp;id({SupportedOtherRevokInfo}),
     otherRevInfo          OTHER-REVOK-INFO.
             &amp;Type({SupportedOtherRevokInfo}{@otherRevInfoFormat})}

   SupportedOtherRevokInfo OTHER-REVOK-INFO ::= { ... }

   CertificateChoices ::= CHOICE {
     certificate Certificate,
     extendedCertificate [0] IMPLICIT ExtendedCertificate,
          -- Obsolete
     ...,
     [[3: v1AttrCert [1] IMPLICIT AttributeCertificateV1]],
          -- Obsolete
     [[4: v2AttrCert [2] IMPLICIT AttributeCertificateV2]],
     [[5: other      [3] IMPLICIT OtherCertificateFormat]] }

   AttributeCertificateV2 ::= AttributeCertificate

   OTHER-CERT-FMT ::= TYPE-IDENTIFIER

   OtherCertificateFormat ::= SEQUENCE {
     otherCertFormat OTHER-CERT-FMT.
             &amp;id({SupportedCertFormats}),
     otherCert       OTHER-CERT-FMT.
             &amp;Type({SupportedCertFormats}{@otherCertFormat})}

   SupportedCertFormats OTHER-CERT-FMT ::= { ... }

   CertificateSet ::= SET OF CertificateChoices

   IssuerAndSerialNumber ::= SEQUENCE {
     issuer Name,
     serialNumber CertificateSerialNumber }

   CMSVersion ::= INTEGER  { v0(0), v1(1), v2(2), v3(3), v4(4), v5(5) }

   UserKeyingMaterial ::= OCTET STRING

   KEY-ATTRIBUTE ::= TYPE-IDENTIFIER

   OtherKeyAttribute ::= SEQUENCE {
     keyAttrId  KEY-ATTRIBUTE.
             &amp;id({SupportedKeyAttributes}),
     keyAttr    KEY-ATTRIBUTE.
             &amp;Type({SupportedKeyAttributes}{@keyAttrId})}




<span class="grey">Schaad &amp; Turner               Informational                    [Page 26]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-27" id="page-27" href="#page-27" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


   SupportedKeyAttributes KEY-ATTRIBUTE ::= { ... }

   -- Content Type Object Identifiers

   id-ct-contentInfo OBJECT IDENTIFIER ::= { iso(1) member-body(2)
     us(840) rsadsi(113549) pkcs(1) pkcs9(9) smime(16) ct(1) 6 }

   ct-Data CONTENT-TYPE ::= { IDENTIFIED BY id-data }

   id-data OBJECT IDENTIFIER ::= { iso(1) member-body(2)
     us(840) rsadsi(113549) pkcs(1) pkcs7(7) 1 }

   ct-SignedData CONTENT-TYPE ::=
     { TYPE SignedData IDENTIFIED BY id-signedData}

   id-signedData OBJECT IDENTIFIER ::= { iso(1) member-body(2)
     us(840) rsadsi(113549) pkcs(1) pkcs7(7) 2 }

   ct-EnvelopedData CONTENT-TYPE ::=
     { TYPE EnvelopedData IDENTIFIED BY id-envelopedData}

   id-envelopedData OBJECT IDENTIFIER ::= { iso(1) member-body(2)
     us(840) rsadsi(113549) pkcs(1) pkcs7(7) 3 }

   ct-DigestedData CONTENT-TYPE ::=
     { TYPE DigestedData IDENTIFIED BY id-digestedData}

   id-digestedData OBJECT IDENTIFIER ::= { iso(1) member-body(2)
     us(840) rsadsi(113549) pkcs(1) pkcs7(7) 5 }

   ct-EncryptedData CONTENT-TYPE ::=
     { TYPE EncryptedData IDENTIFIED BY id-encryptedData}

   id-encryptedData OBJECT IDENTIFIER ::= { iso(1) member-body(2)
     us(840) rsadsi(113549) pkcs(1) pkcs7(7) 6 }

   ct-AuthenticatedData CONTENT-TYPE ::=
     { TYPE AuthenticatedData IDENTIFIED BY id-ct-authData}

   id-ct-authData OBJECT IDENTIFIER ::= { iso(1) member-body(2)
     us(840) rsadsi(113549) pkcs(1) pkcs-9(9) smime(16) ct(1) 2 }

   --
   -- The CMS Attributes
   --

   MessageDigest ::= OCTET STRING




<span class="grey">Schaad &amp; Turner               Informational                    [Page 27]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-28" id="page-28" href="#page-28" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


   SigningTime  ::= Time

   Time ::= CHOICE {
     utcTime UTCTime,
     generalTime GeneralizedTime }

   Countersignature ::= SignerInfo

   -- Attribute Object Identifiers

   aa-contentType ATTRIBUTE ::=
     { TYPE ContentType IDENTIFIED BY id-contentType }
   id-contentType OBJECT IDENTIFIER ::= { iso(1) member-body(2)
     us(840) rsadsi(113549) pkcs(1) pkcs9(9) 3 }

   aa-messageDigest ATTRIBUTE ::=
     { TYPE MessageDigest IDENTIFIED BY id-messageDigest}
   id-messageDigest OBJECT IDENTIFIER ::= { iso(1) member-body(2)
     us(840) rsadsi(113549) pkcs(1) pkcs9(9) 4 }

   aa-signingTime ATTRIBUTE ::=
     { TYPE SigningTime IDENTIFIED BY id-signingTime }
   id-signingTime OBJECT IDENTIFIER ::= { iso(1) member-body(2)
     us(840) rsadsi(113549) pkcs(1) pkcs9(9) 5 }

   aa-countersignature ATTRIBUTE ::=
     { TYPE Countersignature IDENTIFIED BY id-countersignature }
   id-countersignature OBJECT IDENTIFIER ::= { iso(1) member-body(2)
     us(840) rsadsi(113549) pkcs(1) pkcs9(9) 6 }

   --
   -- Obsolete Extended Certificate syntax from PKCS#6
   --

   ExtendedCertificateOrCertificate ::= CHOICE {
     certificate Certificate,
     extendedCertificate [0] IMPLICIT ExtendedCertificate }

   ExtendedCertificate ::= SEQUENCE {
     extendedCertificateInfo ExtendedCertificateInfo,
     signatureAlgorithm SignatureAlgorithmIdentifier,
     signature Signature }

   ExtendedCertificateInfo ::= SEQUENCE {
     version CMSVersion,
     certificate Certificate,
     attributes UnauthAttributes }




<span class="grey">Schaad &amp; Turner               Informational                    [Page 28]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-29" id="page-29" href="#page-29" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


   Signature ::= BIT STRING

   Attribute{ ATTRIBUTE:AttrList } ::= SEQUENCE {
     attrType           ATTRIBUTE.
             &amp;id({AttrList}),
     attrValues         SET OF ATTRIBUTE.
             &amp;Type({AttrList}{@attrType})  }

   Attributes { ATTRIBUTE:AttrList } ::=
     SET SIZE (1..MAX) OF Attribute {{ AttrList }}

   END

<span class="h2"><a class="selflink" name="section-10" href="#section-10">10</a>.  ASN.1 Module <a href="rfc5752.html">RFC 5752</a></span>

   We have updated the ASN.1 module associated with this document to be
   2008 compliant and to use the set of classes previously defined in
   [<a href="rfc5911.html" title="&quot;New ASN.1 Modules for Cryptographic Message Syntax (CMS) and S/MIME&quot;">RFC5911</a>].

   MultipleSignatures-2010
     { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs9(9)
       smime(16) modules(0) id-mod-multipleSign-2009(59) }
   DEFINITIONS IMPLICIT TAGS ::=
   BEGIN
     -- EXPORTS All
     -- The types and values defined in this module are exported for use
     -- in the other ASN.1 modules.  Other applications may use them for
     -- their own purposes.

     IMPORTS

     -- Imports from PKIX-Common-Types-2009 [<a href="rfc5912.html" title="&quot;New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)&quot;">RFC5912</a>]

     ATTRIBUTE
       FROM PKIX-CommonTypes-2009
           { iso(1) identified-organization(3) dod(6) internet(1)
             security(5) mechanisms(5) pkix(7) id-mod(0)
             id-mod-pkixCommon-02(57)}

     -- Imports from CryptographicMessageSyntax-2010 [<a href="rfc6268.html">RFC6268</a>]

     DigestAlgorithmIdentifier, SignatureAlgorithmIdentifier
       FROM CryptographicMessageSyntax-2010
       { iso(1) member-body(2) us(840) rsadsi(113549)
          pkcs(1) pkcs-9(9) smime(16) modules(0) id-mod-cms-2009(58) }






<span class="grey">Schaad &amp; Turner               Informational                    [Page 29]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-30" id="page-30" href="#page-30" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


     -- Imports from ExtendedSecurityServices-2009 [<a href="rfc5911.html" title="&quot;New ASN.1 Modules for Cryptographic Message Syntax (CMS) and S/MIME&quot;">RFC5911</a>]

     ESSCertIDv2
       FROM ExtendedSecurityServices-2009
       { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
         smime(16) modules(0) id-mod-ess-2006-02(42) }
     ;

     --
     -- <a href="#section-3.0">Section 3.0</a>
     --
     --  at-multipleSignatures should be added ONLY to the
     --    SignedAttributesSet defined in [<a href="rfc5652.html" title="&quot;Cryptographic Message Syntax (CMS)&quot;">RFC5652</a>]
     --

     at-multipleSignatures ATTRIBUTE ::= {
       TYPE MultipleSignatures
       IDENTIFIED BY id-aa-multipleSignatures
     }

     id-aa-multipleSignatures OBJECT IDENTIFIER ::= {
       iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs9(9)
       id-aa(2) 51 }

     MultipleSignatures ::= SEQUENCE {
       bodyHashAlg     DigestAlgorithmIdentifier,
       signAlg         SignatureAlgorithmIdentifier,
       signAttrsHash   SignAttrsHash,
       cert            ESSCertIDv2 OPTIONAL
     }

     SignAttrsHash ::= SEQUENCE {
       algID            DigestAlgorithmIdentifier,
       hash             OCTET STRING
     }

   END

<span class="h2"><a class="selflink" name="section-11" href="#section-11">11</a>.  Module Identifiers in ASN.1</span>

   One potential issue that can occur when updating modules is the fact
   that a large number of modules may need to be updated if they import
   from a newly updated module.  This section addresses one method that
   can be used to deal with this problem, but the modules in this
   document don't currently implement the solution discussed here.






<span class="grey">Schaad &amp; Turner               Informational                    [Page 30]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-31" id="page-31" href="#page-31" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


   When looking at an import statement, there are three portions: The
   list of items imported, a textual name for the module, and an object
   identifier for the module.  Full implementations of ASN.1 do module
   matching using first the object identifier, and if that is not
   present, the textual name of the module.  Note however that some
   older implementations used the textual name of the module for the
   purposes of matching.  In a full implementation, the name assigned to
   the module is scoped to the ASN.1 module that it appears in (and thus
   the need to match the module it is importing from).

   One can create a module that contains only the module number
   assignments and import the module assignments from the new module.
   This means that when a module is replaced, one can replace the
   previous module, update the module number assignment module, and
   recompile without having to modify any other modules.

   A sample module assignment module would be:

   ModuleNumbers
   DEFINITIONS TAGS ::=
   BEGIN
      id-mod-CMS ::= { iso(1) member-body(2) us(840) rsadsi(113549)
         pkcs(1) pkcs-9(9) smime(16) modules(0) 58 }

      id-mod-AlgInfo ::=
         {iso(1) identified-organization(3) dod(6) internet(1)
          security(5) mechanisms(5) pkix(7) id-mod(0)
          id-mod-algorithmInformation-02(58)}
   END

   This would be used in the following import statement:

   IMPORTS
     id-mod-CMS, id-mod-AlgInfo
     FROM ModuleNumbers  -- Note it will match on the name since no
                         -- OID is provided

     CMSVersion, EncapsulatedContentInfo, CONTENT-TYPE
     FROM CryptographicMessageSyntax-2010
       id-mod-CMS

     AlgorithmIdentifier{}, SMIME-CAPS, ParamOptions
     FROM AlgorithmInformation-2009 id-mod-AlgInfo
     ;







<span class="grey">Schaad &amp; Turner               Informational                    [Page 31]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-32" id="page-32" href="#page-32" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


<span class="h2"><a class="selflink" name="section-12" href="#section-12">12</a>.  Security Considerations</span>

   This document itself does not have any security considerations.  The
   ASN.1 modules keep the same bits-on-the-wire as the modules that they
   replace.

<span class="h2"><a class="selflink" name="section-13" href="#section-13">13</a>.  References</span>

<span class="h3"><a class="selflink" name="section-13.1" href="#section-13.1">13.1</a>.  Normative References</span>

   [<a name="ref-ASN1-2008" id="ref-ASN1-2008">ASN1-2008</a>]  ITU-T, "ITU-T Recommendations X.680, X.681, X.682, and
                X.683", 2008.

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]    Bradner, S., "Key words for use in RFCs to Indicate
                Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a name="ref-RFC3274" id="ref-RFC3274">RFC3274</a>]    Gutmann, P., "Compressed Data Content Type for
                Cryptographic Message Syntax (CMS)", <a href="rfc3274.html">RFC 3274</a>,
                June 2002.

   [<a name="ref-RFC3779" id="ref-RFC3779">RFC3779</a>]    Lynn, C., Kent, S., and K. Seo, "X.509 Extensions for IP
                Addresses and AS Identifiers", <a href="rfc3779.html">RFC 3779</a>, June 2004.

   [<a name="ref-RFC4073" id="ref-RFC4073">RFC4073</a>]    Housley, R., "Protecting Multiple Contents with the
                Cryptographic Message Syntax (CMS)", <a href="rfc4073.html">RFC 4073</a>, May 2005.

   [<a name="ref-RFC4231" id="ref-RFC4231">RFC4231</a>]    Nystrom, M., "Identifiers and Test Vectors for
                HMAC-SHA-224, HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-
                512", <a href="rfc4231.html">RFC 4231</a>, December 2005.

   [<a name="ref-RFC4334" id="ref-RFC4334">RFC4334</a>]    Housley, R. and T. Moore, "Certificate Extensions and
                Attributes Supporting Authentication in Point-to-Point
                Protocol (PPP) and Wireless Local Area Networks (WLAN)",
                <a href="rfc4334.html">RFC 4334</a>, February 2006.

   [<a name="ref-RFC5083" id="ref-RFC5083">RFC5083</a>]    Housley, R., "Cryptographic Message Syntax (CMS)
                Authenticated-Enveloped-Data Content Type", <a href="rfc5083.html">RFC 5083</a>,
                November 2007.

   [<a name="ref-RFC5280" id="ref-RFC5280">RFC5280</a>]    Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
                Housley, R., and W. Polk, "Internet X.509 Public Key
                Infrastructure Certificate and Certificate Revocation
                List (CRL) Profile", <a href="rfc5280.html">RFC 5280</a>, May 2008.

   [<a name="ref-RFC5652" id="ref-RFC5652">RFC5652</a>]    Housley, R., "Cryptographic Message Syntax (CMS)",
                STD 70, <a href="rfc5652.html">RFC 5652</a>, September 2009.





<span class="grey">Schaad &amp; Turner               Informational                    [Page 32]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-33" id="page-33" href="#page-33" class="invisible"> </a>
<span class="grey"><a href="rfc6268.html">RFC 6268</a>              Additional New ASN.1 Modules             July 2011</span>


   [<a name="ref-RFC5752" id="ref-RFC5752">RFC5752</a>]    Turner, S. and J. Schaad, "Multiple Signatures in
                Cryptographic Message Syntax (CMS)", <a href="rfc5752.html">RFC 5752</a>,
                January 2010.

   [<a name="ref-RFC5911" id="ref-RFC5911">RFC5911</a>]    Hoffman, P. and J. Schaad, "New ASN.1 Modules for
                Cryptographic Message Syntax (CMS) and S/MIME",
                <a href="rfc5911.html">RFC 5911</a>, June 2010.

   [<a name="ref-RFC5912" id="ref-RFC5912">RFC5912</a>]    Hoffman, P. and J. Schaad, "New ASN.1 Modules for the
                Public Key Infrastructure Using X.509 (PKIX)", <a href="rfc5912.html">RFC 5912</a>,
                June 2010.

   [<a name="ref-RFC6019" id="ref-RFC6019">RFC6019</a>]    Housley, R., "BinaryTime: An Alternate Format for
                Representing Date and Time in ASN.1", <a href="rfc6019.html">RFC 6019</a>,
                September 2010.

<span class="h3"><a class="selflink" name="section-13.2" href="#section-13.2">13.2</a>.  Informative References</span>

   [<a name="ref-RFC5751" id="ref-RFC5751">RFC5751</a>]    Ramsdell, B. and S. Turner, "Secure/Multipurpose
                Internet Mail Extensions (S/MIME) Version 3.2 Message
                Specification", <a href="rfc5751.html">RFC 5751</a>, January 2010.

   [<a name="ref-RFC6025" id="ref-RFC6025">RFC6025</a>]    Wallace, C. and C. Gardiner, "ASN.1 Translation",
                <a href="rfc6025.html">RFC 6025</a>, October 2010.

Authors' Addresses

   Jim Schaad
   Soaring Hawk Consulting

   EMail: ietf@augustcellars.com


   Sean Turner
   IECA, Inc.
   3057 Nutley Street, Suite 106
   Fairfax, VA  22031

   EMail: turners@ieca.com












Schaad &amp; Turner               Informational                    [Page 33]

</pre><br />
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.129c, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>
</body>

<!-- Mirrored from tools.ietf.org/html/rfc6268 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:48:28 GMT -->
</html>
