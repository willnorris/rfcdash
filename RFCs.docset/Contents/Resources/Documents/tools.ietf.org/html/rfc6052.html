<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6052 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:32 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-ietf-behave-translator-addressing" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:6052" name="DC.Identifier"/>
<meta content="October, 2010" name="DC.Date.Issued"/>
<meta content="Bao, Congxiao" name="DC.Creator"/>
<meta content="Li, Xing" name="DC.Creator"/>
<meta content="Bagnulo, Marcelo" name="DC.Creator"/>
<meta content="Boucadair, Mohamed" name="DC.Creator"/>
<meta content="Huitema, Christian" name="DC.Creator"/>
<meta content="This document discusses the algorithmic translation of an IPv6 address
to a corresponding IPv4 address, and vice versa, using only statically
configured information. It defines a well-known prefix for use in
algorithmic translations, while allowing organizations to also use
network-specific prefixes when appropriate. Algorithmic translation is
used in IPv4/IPv6 translators, as well as other types of proxies and
gateways (e.g., for DNS) used in IPv4/IPv6 scenarios." name="DC.Description.Abstract"/>
<meta content="IPv6 Addressing of IPv4/IPv6 Translators" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6052 - IPv6 Addressing of IPv4/IPv6 Translators</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6052.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6052" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-behave-address-format" title="draft-ietf-behave-address-format">draft-ietf-beha...</a>] [<a href="https://datatracker.ietf.org/doc/rfc6052" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6052" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6052" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                            C. Bao
Request for Comments: 6052             CERNET Center/Tsinghua University
Updates: <a href="rfc4291.html">4291</a>                                                 C. Huitema
Category: Standards Track                          Microsoft Corporation
ISSN: 2070-1721                                               M. Bagnulo
                                                                    UC3M
                                                            M. Boucadair
                                                          France Telecom
                                                                   X. Li
                                       CERNET Center/Tsinghua University
                                                            October 2010


                <span class="h1">IPv6 Addressing of IPv4/IPv6 Translators</span>

Abstract

   This document discusses the algorithmic translation of an IPv6
   address to a corresponding IPv4 address, and vice versa, using only
   statically configured information.  It defines a well-known prefix
   for use in algorithmic translations, while allowing organizations to
   also use network-specific prefixes when appropriate.  Algorithmic
   translation is used in IPv4/IPv6 translators, as well as other types
   of proxies and gateways (e.g., for DNS) used in IPv4/IPv6 scenarios.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6052">http://www.rfc-editor.org/info/rfc6052</a>.













<span class="grey">Bao, et al.                  Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6052.html">RFC 6052</a>        IPv6 Addressing of IPv4/IPv6 Translators    October 2010</span>


Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-1.1">1.1</a>.  Applicability Scope  . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-1.2">1.2</a>.  Conventions  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-1.3">1.3</a>.  Terminology  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
   <a href="#section-2">2</a>.  IPv4-Embedded IPv6 Address Prefix and Format . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-2.1">2.1</a>.  Well-Known Prefix  . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-2.2">2.2</a>.  IPv4-Embedded IPv6 Address Format  . . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-2.3">2.3</a>.  Address Translation Algorithms . . . . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-2.4">2.4</a>.  Text Representation  . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
   <a href="#section-3">3</a>.  Deployment Guidelines  . . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
     <a href="#section-3.1">3.1</a>.  Restrictions on the Use of the Well-Known Prefix . . . . .  <a href="#page-8">8</a>
     <a href="#section-3.2">3.2</a>.  Impact on Inter-Domain Routing . . . . . . . . . . . . . .  <a href="#page-8">8</a>
     <a href="#section-3.3">3.3</a>.  Choice of Prefix for Stateless Translation Deployments . .  <a href="#page-9">9</a>
     <a href="#section-3.4">3.4</a>.  Choice of Prefix for Stateful Translation Deployments  . . <a href="#page-11">11</a>
   <a href="#section-4">4</a>.  Design Choices . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
     <a href="#section-4.1">4.1</a>.  Choice of Suffix . . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
     <a href="#section-4.2">4.2</a>.  Choice of the Well-Known Prefix  . . . . . . . . . . . . . <a href="#page-13">13</a>
   <a href="#section-5">5</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
     <a href="#section-5.1">5.1</a>.  Protection against Spoofing  . . . . . . . . . . . . . . . <a href="#page-14">14</a>
     <a href="#section-5.2">5.2</a>.  Secure Configuration . . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
     <a href="#section-5.3">5.3</a>.  Firewall Configuration . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
   <a href="#section-6">6</a>.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
   <a href="#section-7">7</a>.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
   <a href="#section-8">8</a>.  Contributors . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
   <a href="#section-9">9</a>.  References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#section-9.1">9.1</a>.  Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#section-9.2">9.2</a>.  Informative References . . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>







<span class="grey">Bao, et al.                  Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6052.html">RFC 6052</a>        IPv6 Addressing of IPv4/IPv6 Translators    October 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   This document is part of a series of IPv4/IPv6 translation documents.
   A framework for IPv4/IPv6 translation is discussed in
   [<a href="#ref-v4v6-FRAMEWORK">v4v6-FRAMEWORK</a>], including a taxonomy of scenarios that will be used
   in this document.  Other documents specify the behavior of various
   types of translators and gateways, including mechanisms for
   translating between IP headers and other types of messages that
   include IP addresses.  This document specifies how an individual IPv6
   address is translated to a corresponding IPv4 address, and vice
   versa, in cases where an algorithmic mapping is used.  While specific
   types of devices are used herein as examples, it is the
   responsibility of the specification of such devices to reference this
   document for algorithmic mapping of the addresses themselves.

   <a href="#section-2">Section 2</a> describes the prefixes and the format of "IPv4-embedded
   IPv6 addresses", i.e., IPv6 addresses in which 32 bits contain an
   IPv4 address.  This format is common to both "IPv4-converted" and
   "IPv4-translatable" IPv6 addresses.  This section also defines the
   algorithms for translating addresses, and the text representation of
   IPv4-embedded IPv6 addresses.

   <a href="#section-3">Section 3</a> discusses the choice of prefixes, the conditions in which
   they can be used, and the use of IPv4-embedded IPv6 addresses with
   stateless and stateful translation.

   <a href="#section-4">Section 4</a> provides a summary of the discussions behind two specific
   design decisions, the choice of a null suffix and the specific value
   of the selected prefix.

   <a href="#section-5">Section 5</a> discusses security concerns.

   In some scenarios, a dual-stack host will unnecessarily send its
   traffic through an IPv6/IPv4 translator.  This can be caused by the
   host's default address selection algorithm [<a href="rfc3484.html" title='"Default Address Selection for Internet Protocol version 6 (IPv6)"'>RFC3484</a>], referrals, or
   other reasons.  Optimizing these scenarios for dual-stack hosts is
   for future study.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Applicability%20Scope"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Applicability Scope</span>

   This document is part of a series defining address translation
   services.  We understand that the address format could also be used
   by other interconnection methods between IPv6 and IPv4, e.g., methods
   based on encapsulation.  If encapsulation methods are developed by
   the IETF, we expect that their descriptions will document their
   specific use of IPv4-embedded IPv6 addresses.





<span class="grey">Bao, et al.                  Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6052.html">RFC 6052</a>        IPv6 Addressing of IPv4/IPv6 Translators    October 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Conventions"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Conventions</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20Terminology"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  Terminology</span>

   This document makes use of the following terms:

   Address translator:  any entity that has to derive an IPv4 address
      from an IPv6 address or vice versa.  This applies not only to
      devices that do IPv4/IPv6 packet translation, but also to other
      entities that manipulate addresses, such as name resolution
      proxies (e.g., DNS64 [<a href="#ref-DNS64" title='"DNS64: DNS extensions for Network Address Translation from IPv6 Clients to IPv4 Servers"'>DNS64</a>]) and possibly other types of
      Application Layer Gateways (ALGs).

   IPv4-converted IPv6 addresses:  IPv6 addresses used to represent IPv4
      nodes in an IPv6 network.  They are a variant of IPv4-embedded
      IPv6 addresses and follow the format described in <a href="#section-2.2">Section 2.2</a>.

   IPv4-embedded IPv6 addresses:  IPv6 addresses in which 32 bits
      contain an IPv4 address.  Their format is described in
      <a href="#section-2.2">Section 2.2</a>.

   IPv4/IPv6 translator:  an entity that translates IPv4 packets to IPv6
      packets, and vice versa.  It may do "stateless" translation,
      meaning that there is no per-flow state required, or "stateful"
      translation, meaning that per-flow state is created when the first
      packet in a flow is received.

   IPv4-translatable IPv6 addresses:  IPv6 addresses assigned to IPv6
      nodes for use with stateless translation.  They are a variant of
      IPv4-embedded IPv6 addresses and follow the format described in
      <a href="#section-2.2">Section 2.2</a>.

   Network-Specific Prefix:  an IPv6 prefix assigned by an organization
      for use in algorithmic mapping.  Options for the Network-Specific
      Prefix are discussed in Sections <a href="#section-3.3">3.3</a> and <a href="#section-3.4">3.4</a>.

   Well-Known Prefix:  the IPv6 prefix defined in this document for use
      in an algorithmic mapping.









<span class="grey">Bao, et al.                  Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6052.html">RFC 6052</a>        IPv6 Addressing of IPv4/IPv6 Translators    October 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20IPv4-Embedded%20IPv6%20Address%20Prefix%20and%20Format"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  IPv4-Embedded IPv6 Address Prefix and Format</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Well-Known%20Prefix"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Well-Known Prefix</span>

   This document reserves a "Well-Known Prefix" for use in an
   algorithmic mapping.  The value of this IPv6 prefix is:

      64:ff9b::/96

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20IPv4-Embedded%20IPv6%20Address%20Format"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  IPv4-Embedded IPv6 Address Format</span>

   IPv4-converted IPv6 addresses and IPv4-translatable IPv6 addresses
   follow the same format, described here as the IPv4-embedded IPv6
   address Format.  IPv4-embedded IPv6 addresses are composed of a
   variable-length prefix, the embedded IPv4 address, and a variable-
   length suffix, as presented in the following diagram, in which PL
   designates the prefix length:

    +--+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |PL| 0-------------32--40--48--56--64--72--80--88--96--104---------|
    +--+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |32|     prefix    |v4(32)         | u | suffix                    |
    +--+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |40|     prefix        |v4(24)     | u |(8)| suffix                |
    +--+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |48|     prefix            |v4(16) | u | (16)  | suffix            |
    +--+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |56|     prefix                |(8)| u |  v4(24)   | suffix        |
    +--+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |64|     prefix                    | u |   v4(32)      | suffix    |
    +--+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |96|     prefix                                    |    v4(32)     |
    +--+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+

                                 Figure 1

   In these addresses, the prefix shall be either the "Well-Known
   Prefix" or a "Network-Specific Prefix" unique to the organization
   deploying the address translators.  The prefixes can only have one of
   the following lengths: 32, 40, 48, 56, 64, or 96.  (The Well-Known
   Prefix is 96 bits long, and can only be used in the last form of the
   table.)

   Various deployments justify different prefix lengths with Network-
   Specific Prefixes.  The trade-off between different prefix lengths
   are discussed in Sections <a href="#section-3.3">3.3</a> and <a href="#section-3.4">3.4</a>.





<span class="grey">Bao, et al.                  Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6052.html">RFC 6052</a>        IPv6 Addressing of IPv4/IPv6 Translators    October 2010</span>


   Bits 64 to 71 of the address are reserved for compatibility with the
   host identifier format defined in the IPv6 addressing architecture
   [<a href="rfc4291.html" title='"IP Version 6 Addressing Architecture"'>RFC4291</a>].  These bits MUST be set to zero.  When using a /96
   Network-Specific Prefix, the administrators MUST ensure that the bits
   64 to 71 are set to zero.  A simple way to achieve that is to
   construct the /96 Network-Specific Prefix by picking a /64 prefix,
   and then adding 4 octets set to zero.

   The IPv4 address is encoded following the prefix, most significant
   bits first.  Depending of the prefix length, the 4 octets of the
   address may be separated by the reserved octet "u", whose 8 bits MUST
   be set to zero.  In particular:

   o  When the prefix is 32 bits long, the IPv4 address is encoded in
      positions 32 to 63.

   o  When the prefix is 40 bits long, 24 bits of the IPv4 address are
      encoded in positions 40 to 63, with the remaining 8 bits in
      position 72 to 79.

   o  When the prefix is 48 bits long, 16 bits of the IPv4 address are
      encoded in positions 48 to 63, with the remaining 16 bits in
      position 72 to 87.

   o  When the prefix is 56 bits long, 8 bits of the IPv4 address are
      encoded in positions 56 to 63, with the remaining 24 bits in
      position 72 to 95.

   o  When the prefix is 64 bits long, the IPv4 address is encoded in
      positions 72 to 103.

   o  When the prefix is 96 bits long, the IPv4 address is encoded in
      positions 96 to 127.

   There are no remaining bits, and thus no suffix, if the prefix is 96
   bits long.  In the other cases, the remaining bits of the address
   constitute the suffix.  These bits are reserved for future extensions
   and SHOULD be set to zero.  Address translators who receive IPv4-
   embedded IPv6 addresses where these bits are not zero SHOULD ignore
   the bits' value and proceed as if the bits' value were zero.  (Future
   extensions may specify a different behavior.)










<span class="grey">Bao, et al.                  Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6052.html">RFC 6052</a>        IPv6 Addressing of IPv4/IPv6 Translators    October 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20Address%20Translation%20Algorithms"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  Address Translation Algorithms</span>

   IPv4-embedded IPv6 addresses are composed according to the following
   algorithm:

   o  Concatenate the prefix, the 32 bits of the IPv4 address, and the
      suffix (if needed) to obtain a 128-bit address.

   o  If the prefix length is less than 96 bits, insert the null octet
      "u" at the appropriate position (bits 64 to 71), thus causing the
      least significant octet to be excluded, as documented in Figure 1.

   The IPv4 addresses are extracted from the IPv4-embedded IPv6
   addresses according to the following algorithm:

   o  If the prefix is 96 bits long, extract the last 32 bits of the
      IPv6 address;

   o  For the other prefix lengths, remove the "u" octet to obtain a
      120-bit sequence (effectively shifting bits 72-127 to positions
      64-119), then extract the 32 bits following the prefix.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.4.%20%20Text%20Representation"></a><a class="selflink" href="#section-2.4" name="section-2.4">2.4</a>.  Text Representation</span>

   IPv4-embedded IPv6 addresses will be represented in text in
   conformity with <a href="rfc4291.html#section-2.2">Section 2.2 of [RFC4291]</a>.  IPv4-embedded IPv6
   addresses constructed using the Well-Known Prefix or a /96 Network-
   Specific Prefix may be represented using the alternative form
   presented in <a href="rfc4291.html#section-2.2">Section 2.2 of [RFC4291]</a>, with the embedded IPv4 address
   represented in dotted decimal notation.  Examples of such
   representations are presented in Tables 1 and 2.

   +-----------------------+------------+------------------------------+
   | Network-Specific      |    IPv4    | IPv4-embedded IPv6 address   |
   | Prefix                |   address  |                              |
   +-----------------------+------------+------------------------------+
   | 2001:db8::/32         | 192.0.2.33 | 2001:db8:c000:221::          |
   | 2001:db8:100::/40     | 192.0.2.33 | 2001:db8:1c0:2:21::          |
   | 2001:db8:122::/48     | 192.0.2.33 | 2001:db8:122:c000:2:2100::   |
   | 2001:db8:122:300::/56 | 192.0.2.33 | 2001:db8:122:3c0:0:221::     |
   | 2001:db8:122:344::/64 | 192.0.2.33 | 2001:db8:122:344:c0:2:2100:: |
   | 2001:db8:122:344::/96 | 192.0.2.33 | 2001:db8:122:344::192.0.2.33 |
   +-----------------------+------------+------------------------------+

    Table 1: Text Representation of IPv4-Embedded IPv6 Addresses Using
                         Network-Specific Prefixes





<span class="grey">Bao, et al.                  Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6052.html">RFC 6052</a>        IPv6 Addressing of IPv4/IPv6 Translators    October 2010</span>


     +-------------------+--------------+----------------------------+
     | Well-Known Prefix | IPv4 address | IPv4-Embedded IPv6 address |
     +-------------------+--------------+----------------------------+
     | 64:ff9b::/96      |  192.0.2.33  | 64:ff9b::192.0.2.33        |
     +-------------------+--------------+----------------------------+

    Table 2: Text Representation of IPv4-Embedded IPv6 Addresses Using
                           the Well-Known Prefix

   The Network-Specific Prefix examples in Table 1 are derived from the
   IPv6 prefix reserved for documentation in [<a href="rfc3849.html" title='"IPv6 Address Prefix Reserved for Documentation"'>RFC3849</a>].  The IPv4
   address 192.0.2.33 is part of the subnet 192.0.2.0/24 reserved for
   documentation in [<a href="rfc5735.html" title='"Special Use IPv4 Addresses"'>RFC5735</a>].  The representation of IPv6 addresses is
   compatible with [<a href="rfc5952.html" title='"A Recommendation for IPv6 Address Text Representation"'>RFC5952</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Deployment%20Guidelines"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Deployment Guidelines</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Restrictions%20on%20the%20Use%20of%20the%20Well-Known%20Prefix"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Restrictions on the Use of the Well-Known Prefix</span>

   The Well-Known Prefix MUST NOT be used to represent non-global IPv4
   addresses, such as those defined in [<a href="rfc1918.html" title='"Address Allocation for Private Internets"'>RFC1918</a>] or listed in <a href="rfc5735.html#section-3">Section 3
   of [RFC5735]</a>.  Address translators MUST NOT translate packets in
   which an address is composed of the Well-Known Prefix and a non-
   global IPv4 address; they MUST drop these packets.

   The Well-Known Prefix SHOULD NOT be used to construct IPv4-
   translatable IPv6 addresses.  The nodes served by IPv4-translatable
   IPv6 addresses should be able to receive global IPv6 traffic bound to
   their IPv4-translatable IPv6 address without incurring intermediate
   protocol translation.  This is only possible if the specific prefix
   used to build the IPv4-translatable IPv6 addresses is advertised in
   inter-domain routing, but the advertisement of more specific prefixes
   derived from the Well-Known Prefix is not supported, as explained in
   <a href="#section-3.2">Section 3.2</a>.  Network-Specific Prefixes SHOULD be used in these
   scenarios, as explained in <a href="#section-3.3">Section 3.3</a>.

   The Well-Known Prefix MAY be used by organizations deploying
   translation services, as explained in <a href="#section-3.4">Section 3.4</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Impact%20on%20Inter-Domain%20Routing"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Impact on Inter-Domain Routing</span>

   The Well-Known Prefix MAY appear in inter-domain routing tables, if
   service providers decide to provide IPv6-IPv4 interconnection
   services to peers.  Advertisement of the Well-Known Prefix SHOULD be
   controlled either by upstream and/or downstream service providers
   according to inter-domain routing policies, e.g., through





<span class="grey">Bao, et al.                  Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6052.html">RFC 6052</a>        IPv6 Addressing of IPv4/IPv6 Translators    October 2010</span>


   configuration of BGP [<a href="rfc4271.html" title='"A Border Gateway Protocol 4 (BGP-4)"'>RFC4271</a>].  Organizations that advertise the
   Well-Known Prefix in inter-domain routing MUST be able to provide
   IPv4/IPv6 translation service.

   When the IPv4/IPv6 translation relies on the Well-Known Prefix, IPv4-
   embedded IPv6 prefixes longer than the Well-Known Prefix MUST NOT be
   advertised in BGP (especially External BGP) [<a href="rfc4271.html" title='"A Border Gateway Protocol 4 (BGP-4)"'>RFC4271</a>] because this
   leads to importing the IPv4 routing table into the IPv6 one and
   therefore introduces scalability issues to the global IPv6 routing
   table.  Administrators of BGP nodes SHOULD configure filters that
   discard advertisements of embedded IPv6 prefixes longer than the
   Well-Known Prefix.

   When the IPv4/IPv6 translation service relies on Network-Specific
   Prefixes, the IPv4-translatable IPv6 prefixes used in stateless
   translation MUST be advertised with proper aggregation to the IPv6
   Internet.  Similarly, if translators are configured with multiple
   Network-Specific Prefixes, these prefixes MUST be advertised to the
   IPv6 Internet with proper aggregation.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Choice%20of%20Prefix%20for%20Stateless%20Translation%20Deployments"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Choice of Prefix for Stateless Translation Deployments</span>

   Organizations may deploy translation services using stateless
   translation.  In these deployments, internal IPv6 nodes are addressed
   using IPv4-translatable IPv6 addresses, which enable them to be
   accessed by IPv4 nodes.  The addresses of these external IPv4 nodes
   are then represented in IPv4-converted IPv6 addresses.

   Organizations deploying stateless IPv4/IPv6 translation SHOULD assign
   a Network-Specific Prefix to their IPv4/IPv6 translation service.
   IPv4-translatable and IPv4-converted IPv6 addresses MUST be
   constructed as specified in <a href="#section-2.2">Section 2.2</a>.  IPv4-translatable IPv6
   addresses MUST use the selected Network-Specific Prefix.  Both IPv4-
   translatable IPv6 addresses and IPv4-converted IPv6 addresses SHOULD
   use the same prefix.

   Using the same prefix ensures that IPv6 nodes internal to the
   organization will use the most efficient paths to reach the nodes
   served by IPv4-translatable IPv6 addresses.  Specifically, if a node
   learns the IPv4 address of a target internal node without knowing
   that this target is in fact located behind the same translator that
   the node also uses, translation rules will ensure that the IPv6
   address constructed with the Network-Specific Prefix is the same as
   the IPv4-translatable IPv6 address assigned to the target.  Standard
   routing preference (i.e., "most specific match wins") will then
   ensure that the IPv6 packets are delivered directly, without
   requiring that translators receive the packets and then return them
   in the direction from which they came.



<span class="grey">Bao, et al.                  Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6052.html">RFC 6052</a>        IPv6 Addressing of IPv4/IPv6 Translators    October 2010</span>


   The intra-domain routing protocol must be able to deliver packets to
   the nodes served by IPv4-translatable IPv6 addresses.  This may
   require routing on some or all of the embedded IPv4 address bits.
   Security considerations detailed in <a href="#section-5">Section 5</a> require that routers
   check the validity of the IPv4-translatable IPv6 source addresses,
   using some form of reverse path check.

   The management of stateless address translation can be illustrated
   with a small example:

      We will consider an IPv6 network with the prefix 2001:db8:
      122::/48.  The network administrator has selected the Network-
      Specific Prefix 2001:db8:122:344::/64 for managing stateless IPv4/
      IPv6 translation.  The IPv4-translatable address block for IPv4
      subnet 192.0.2.0/24 is 2001:db8:122:344:c0:2::/96.  In this
      network, the host A is assigned the IPv4-translatable IPv6 address
      2001:db8:122:344:c0:2:2100::, which corresponds to the IPv4
      address 192.0.2.33.  Host A's address is configured either
      manually or through DHCPv6.

      In this example, host A is not directly connected to the
      translator, but instead to a link managed by a router R.  The
      router R is configured to forward to A the packets bound to 2001:
      db8:122:344:c0:2:2100::.  To receive these packets, R will
      advertise reachability of the prefix 2001:db8:122:344:c0:2:2100::/
      104 in the intra-domain routing protocol -- or perhaps a shorter
      prefix if many hosts on link have IPv4-translatable IPv6 addresses
      derived from the same IPv4 subnet.  If a packet bound to
      192.0.2.33 reaches the translator, the destination address will be
      translated to 2001:db8:122:344:c0:2:2100::, and the packet will be
      routed towards R and then to A.

      Let's suppose now that a host B of the same domain learns the IPv4
      address of A, maybe through an application-specific referral.  If
      B has translation-aware software, B can compose a destination
      address by combining the Network-Specific Prefix 2001:db8:122:
      344::/64 and the IPv4 address 192.0.2.33, resulting in the address
      2001:db8:122:344:c0:2:2100::.  The packet sent by B will be
      forwarded towards R, and then to A, avoiding protocol translation.

   Forwarding, and reverse path checks, are more efficient when
   performed on the combination of the prefix and the IPv4 address.  In
   theory, routers are able to route on prefixes of any length, but in
   practice there may be routers for which routing on prefixes larger
   than 64 bits is slower.  However, routing efficiency is not the only
   consideration in the choice of a prefix length.  Organizations also
   need to consider the availability of prefixes, and the potential
   impact of all-zero identifiers.



<span class="grey">Bao, et al.                  Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc6052.html">RFC 6052</a>        IPv6 Addressing of IPv4/IPv6 Translators    October 2010</span>


   If a /32 prefix is used, all the routing bits are contained in the
   top 64 bits of the IPv6 address, leading to excellent routing
   properties.  These prefixes may however be hard to obtain, and
   allocation of a /32 to a small set of IPv4-translatable IPv6
   addresses may be seen as wasteful.  In addition, the /32 prefix and a
   zero suffix lead to an all-zero interface identifier, which is an
   issue that we discuss in <a href="#section-4.1">Section 4.1</a>.

   Intermediate prefix lengths such as /40, /48, or /56 appear as
   compromises.  Only some of the IPv4 bits are part of the /64
   prefixes.  Reverse path checks, in particular, may have a limited
   efficiency.  Reverse path checks limited to the most significant bits
   of the IPv4 address will reduce the possibility of spoofing external
   IPv4 addresses, but would allow IPv6 nodes to spoof internal IPv4-
   translatable IPv6 addresses.

   We propose a compromise, based on using no more than 1/256th of an
   organization's allocation of IPv6 addresses for the IPv4/IPv6
   translation service.  For example, if the organization is an Internet
   Service Provider with an allocated IPv6 prefix /32 or shorter, the
   ISP could dedicate a /40 prefix to the translation service.  An end
   site with a /48 allocation could dedicate a /56 prefix to the
   translation service, or possibly a /96 prefix if all IPv4-
   translatable IPv6 addresses are located on the same link.

   The recommended prefix length is also a function of the deployment
   scenario.  The stateless translation can be used for Scenario 1,
   Scenario 2, Scenario 5, and Scenario 6 defined in [<a href="#ref-v4v6-FRAMEWORK">v4v6-FRAMEWORK</a>].
   For different scenarios, the prefix length recommendations are:

   o  For Scenario 1 (an IPv6 network to the IPv4 Internet) and Scenario
      2 (the IPv4 Internet to an IPv6 network), an ISP holding a /32
      allocation SHOULD use a /40 prefix, and a site holding a /48
      allocation SHOULD use a /56 prefix.

   o  For Scenario 5 (an IPv6 network to an IPv4 network) and Scenario 6
      (an IPv4 network to an IPv6 network), the deployment SHOULD use a
      /64 or a /96 prefix.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Choice%20of%20Prefix%20for%20Stateful%20Translation%20Deployments"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Choice of Prefix for Stateful Translation Deployments</span>

   Organizations may deploy translation services based on stateful
   translation technology.  An organization may decide to use either a
   Network-Specific Prefix or the Well-Known Prefix for its stateful
   IPv4/IPv6 translation service.






<span class="grey">Bao, et al.                  Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc6052.html">RFC 6052</a>        IPv6 Addressing of IPv4/IPv6 Translators    October 2010</span>


   When these services are used, IPv6 nodes are addressed through
   standard IPv6 addresses, while IPv4 nodes are represented by IPv4-
   converted IPv6 addresses, as specified in <a href="#section-2.2">Section 2.2</a>.

   The stateful nature of the translation creates a potential stability
   issue when the organization deploys multiple translators.  If several
   translators use the same prefix, there is a risk that packets
   belonging to the same connection may be routed to different
   translators as the internal routing state changes.  This issue can be
   avoided either by assigning different prefixes to different
   translators or by ensuring that all translators using the same prefix
   coordinate their state.

   Stateful translation can be used in scenarios defined in
   [<a href="#ref-v4v6-FRAMEWORK">v4v6-FRAMEWORK</a>].  The Well-Known Prefix SHOULD be used in these
   scenarios, with two exceptions:

   o  In all scenarios, the translation MAY use a Network-Specific
      Prefix, if deemed appropriate for management reasons.

   o  The Well-Known Prefix MUST NOT be used for Scenario 3 (the IPv6
      Internet to an IPv4 network), as this would lead to using the
      Well-Known Prefix with non-global IPv4 addresses.  That means a
      Network-Specific Prefix (for example, a /96 prefix) MUST be used
      in that scenario.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Design%20Choices"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Design Choices</span>

   The prefix that we have chosen reflects two design choices, the null
   suffix and the specific value of the Well-Known Prefix.  We provide
   here a summary of the discussions leading to those two choices.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Choice%20of%20Suffix"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Choice of Suffix</span>

   The address format described in <a href="#section-2.2">Section 2.2</a> recommends a zero suffix.
   Before making this recommendation, we considered different options:
   checksum neutrality, the encoding of a port range, and a value
   different than 0.

   In the case of stateless translation, there would be no need for the
   translator to recompute a one's complement checksum if both the IPv4-
   translatable and the IPv4-converted IPv6 addresses were constructed
   in a "checksum-neutral" manner, that is, if the IPv6 addresses would
   have the same one's complement checksum as the embedded IPv4 address.
   In the case of stateful translation, checksum neutrality does not
   eliminate checksum computation during translation, as only one of the
   two addresses would be checksum neutral.  We considered reserving 16
   bits in the suffix to guarantee checksum neutrality, but declined



<span class="grey">Bao, et al.                  Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc6052.html">RFC 6052</a>        IPv6 Addressing of IPv4/IPv6 Translators    October 2010</span>


   because it would not help with stateful translation and because
   checksum neutrality can also be achieved by an appropriate choice of
   the Network-Specific Prefix, i.e., selecting a prefix whose one's
   complement checksum equals either 0 or 0xffff.

   There have been proposals to complement stateless translation with a
   port-range feature.  Instead of mapping an IPv4 address to exactly
   one IPv6 prefix, the options would allow several IPv6 nodes to share
   an IPv4 address, with each node managing a different range of ports.
   If a port range extension is needed, it could be defined later, using
   bits currently reserved as null in the suffix.

   When a /32 prefix is used, an all-zero suffix results in an all-zero
   interface identifier.  We understand the conflict with <a href="rfc4291.html#section-2.6.1">Section 2.6.1
   of RFC4291</a>, which specifies that all zeroes are used for the subnet-
   router anycast address.  However, in our specification, there is only
   one node with an IPv4-translatable IPv6 address in the /64 subnet, so
   the anycast semantic does not create confusion.  We thus decided to
   keep the null suffix for now.  This issue does not exist for prefixes
   larger than 32 bits, such as the /40, /56, /64, and /96 prefixes that
   we recommend in <a href="#section-3.3">Section 3.3</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Choice%20of%20the%20Well-Known%20Prefix"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Choice of the Well-Known Prefix</span>

   Before making our recommendation of the Well-Known Prefix, we were
   faced with three choices:

   o  reuse the IPv4-mapped prefix, ::ffff:0:0/96, as specified in <a href="rfc2765.html">RFC</a>
      <a href="rfc2765.html">2765</a>, <a href="#section-2.1">Section 2.1</a>;

   o  request IANA to allocate a /32 prefix, or

   o  request allocation of a new /96 prefix.

   We weighted the pros and cons of these choices before settling on the
   recommended /96 Well-Known Prefix.

   The main advantage of the existing IPv4-mapped prefix is that it is
   already defined.  Reusing that prefix would require minimal
   standardization efforts.  However, being already defined is not just
   an advantage, as there may be side effects of current
   implementations.  When presented with the IPv4-mapped prefix, current
   versions of Windows and Mac OS generate IPv4 packets, but will not
   send IPv6 packets.  If we used the IPv4-mapped prefix, these nodes
   would not be able to support translation without modification.  This
   will defeat the main purpose of the translation techniques.  We thus
   eliminated the first choice, i.e., decided to not reuse the IPv4-
   mapped prefix, ::ffff:0:0/96.



<span class="grey">Bao, et al.                  Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc6052.html">RFC 6052</a>        IPv6 Addressing of IPv4/IPv6 Translators    October 2010</span>


   A /32 prefix would have allowed the embedded IPv4 address to fit
   within the top 64 bits of the IPv6 address.  This would have
   facilitated routing and load balancing when an organization deploys
   several translators.  However, such destination-address-based load
   balancing may not be desirable.  It is not compatible with Session
   Traversal Utilities for NAT (STUN) [<a href="rfc5389.html" title='"Session Traversal Utilities for NAT (STUN)"'>RFC5389</a>] in the deployments
   involving multiple stateful translators, each one having a different
   pool of IPv4 addresses.  STUN compatibility would only be achieved if
   the translators managed the same pool of IPv4 addresses and were able
   to coordinate their translation state, in which case there is no big
   advantage to using a /32 prefix rather than a /96 prefix.

   According to <a href="rfc4291.html#section-2.2">Section 2.2 of [RFC4291]</a>, in the legal textual
   representations of IPv6 addresses, dotted decimal can only appear at
   the end.  The /96 prefix is compatible with that requirement.  It
   enables the dotted decimal notation without requiring an update to
   [<a href="rfc4291.html" title='"IP Version 6 Addressing Architecture"'>RFC4291</a>].  This representation makes the address format easier to
   use and the log files easier to read.

   The prefix that we recommend has the particularity of being "checksum
   neutral".  The sum of the hexadecimal numbers "0064" and "ff9b" is
   "ffff", i.e., a value equal to zero in one's complement arithmetic.
   An IPv4-embedded IPv6 address constructed with this prefix will have
   the same one's complement checksum as the embedded IPv4 address.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Security%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Security Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Protection%20against%20Spoofing"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Protection against Spoofing</span>

   IPv4/IPv6 translators can be modeled as special routers, are subject
   to the same risks, and can implement the same mitigations.  (The
   discussion of generic threats to routers and their mitigations is
   beyond the scope of this document.)  There is, however, a particular
   risk that directly derives from the practice of embedding IPv4
   addresses in IPv6: address spoofing.

   An attacker could use an IPv4-embedded IPv6 address as the source
   address of malicious packets.  After translation, the packets will
   appear as IPv4 packets from the specified source, and the attacker
   may be hard to track.  If left without mitigation, the attack would
   allow malicious IPv6 nodes to spoof arbitrary IPv4 addresses.

   The mitigation is to implement reverse path checks and to verify
   throughout the network that packets are coming from an authorized
   location.






<span class="grey">Bao, et al.                  Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc6052.html">RFC 6052</a>        IPv6 Addressing of IPv4/IPv6 Translators    October 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Secure%20Configuration"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Secure Configuration</span>

   The prefixes used for address translation are used by IPv6 nodes to
   send packets to IPv6/IPv4 translators.  Attackers could attempt to
   fool nodes, DNS gateways, and IPv4/IPv6 translators into using wrong
   values for these parameters, resulting in network disruption, denial
   of service, and possible information disclosure.  To mitigate such
   attacks, network administrators need to ensure that prefixes are
   configured in a secure way.

   The mechanisms for achieving secure configuration of prefixes are
   beyond the scope of this document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Firewall%20Configuration"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Firewall Configuration</span>

   Many firewalls and other security devices filter traffic based on
   IPv4 addresses.  Attackers could attempt to fool these firewalls by
   sending IPv6 packets to or from IPv6 addresses that translate to the
   filtered IPv4 addresses.  If the attack is successful, traffic that
   was previously blocked might be able to pass through the firewalls
   disguised as IPv6 packets.  In all such scenarios, administrators
   should assure that packets that send to or from IPv4-embedded IPv6
   addresses are subject to the same filtering as those directly sent to
   or from the embedded IPv4 addresses.

   The mechanisms for configuring firewalls and security devices to
   achieve this filtering are beyond the scope of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  IANA Considerations</span>

   IANA has made the following changes in the "Internet Protocol Version
   6 Address Space" registry located at <a href="http://www.iana.org/">http://www.iana.org</a>.

   OLD:

      IPv6 Prefix Allocation       Reference    Note
      ----------- ---------------- ------------ ----------------
      0000::/8    Reserved by IETF [<a href="rfc4291.html" title='"IP Version 6 Addressing Architecture"'>RFC4291</a>]    [1][5]

   NEW:

      IPv6 Prefix Allocation       Reference    Note
      ----------- ---------------- ------------ ----------------
      0000::/8    Reserved by IETF [<a href="rfc4291.html" title='"IP Version 6 Addressing Architecture"'>RFC4291</a>]    [1][5][<a href="#ref-6" title='"Well-Known Prefix"'>6</a>]

      [<a id="ref-6" name="ref-6">6</a>] The "Well-Known Prefix" 64:ff9b::/96 used in an algorithmic
          mapping between IPv4 to IPv6 addresses is defined out of the
          0000::/8 address block, per <a href="rfc6052.html">RFC 6052</a>.



<span class="grey">Bao, et al.                  Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc6052.html">RFC 6052</a>        IPv6 Addressing of IPv4/IPv6 Translators    October 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Acknowledgements"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Acknowledgements</span>

   Many people in the BEHAVE WG have contributed to the discussion that
   led to this document, including Andrew Sullivan, Andrew Yourtchenko,
   Ari Keranen, Brian Carpenter, Charlie Kaufman, Dan Wing, Dave Thaler,
   David Harrington, Ed Jankiewicz, Fred Baker, Hiroshi Miyata, Iljitsch
   van Beijnum, John Schnizlein, Keith Moore, Kevin Yin, Magnus
   Westerlund, Margaret Wasserman, Masahito Endo, Phil Roberts, Philip
   Matthews, Remi Denis-Courmont, Remi Despres, and William Waites.

   Marcelo Bagnulo is partly funded by Trilogy, a research project
   supported by the European Commission under its Seventh Framework
   Program.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Contributors"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Contributors</span>

   The following individuals co-authored documents from which text has
   been incorporated, and are listed in alphabetical order.

       Dave Thaler
       Microsoft Corporation
       One Microsoft Way
       Redmond, WA  98052
       USA
       Phone: +1 425 703 8835
       EMail: dthaler@microsoft.com

       Fred Baker
       Cisco Systems
       Santa Barbara, California  93117
       USA
       Phone: +1-408-526-4257
       Fax:   +1-413-473-2403
       EMail: fred@cisco.com

       Hiroshi Miyata
       Yokogawa Electric Corporation
       2-9-32 Nakacho
       Musashino-shi, Tokyo  180-8750
       JAPAN
       EMail: h.miyata@jp.yokogawa.com










<span class="grey">Bao, et al.                  Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc6052.html">RFC 6052</a>        IPv6 Addressing of IPv4/IPv6 Translators    October 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20References"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20Normative%20References"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC4291" name="ref-RFC4291">RFC4291</a>]  Hinden, R. and S. Deering, "IP Version 6 Addressing
              Architecture", <a href="rfc4291.html">RFC 4291</a>, February 2006.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20Informative%20References"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  Informative References</span>

   [<a id="ref-DNS64" name="ref-DNS64">DNS64</a>]    Bagnulo, M., Sullivan, A., Matthews, P., and I. Beijnum,
              "DNS64: DNS extensions for Network Address Translation
              from IPv6 Clients to IPv4 Servers", Work in Progress,
              October 2010.

   [<a id="ref-RFC1918" name="ref-RFC1918">RFC1918</a>]  Rekhter, Y., Moskowitz, R., Karrenberg, D., Groot, G., and
              E. Lear, "Address Allocation for Private Internets",
              <a href="https://tools.ietf.org/html/bcp5">BCP 5</a>, <a href="rfc1918.html">RFC 1918</a>, February 1996.

   [<a id="ref-RFC3484" name="ref-RFC3484">RFC3484</a>]  Draves, R., "Default Address Selection for Internet
              Protocol version 6 (IPv6)", <a href="rfc3484.html">RFC 3484</a>, February 2003.

   [<a id="ref-RFC3849" name="ref-RFC3849">RFC3849</a>]  Huston, G., Lord, A., and P. Smith, "IPv6 Address Prefix
              Reserved for Documentation", <a href="rfc3849.html">RFC 3849</a>, July 2004.

   [<a id="ref-RFC4271" name="ref-RFC4271">RFC4271</a>]  Rekhter, Y., Li, T., and S. Hares, "A Border Gateway
              Protocol 4 (BGP-4)", <a href="rfc4271.html">RFC 4271</a>, January 2006.

   [<a id="ref-RFC5389" name="ref-RFC5389">RFC5389</a>]  Rosenberg, J., Mahy, R., Matthews, P., and D. Wing,
              "Session Traversal Utilities for NAT (STUN)", <a href="rfc5389.html">RFC 5389</a>,
              October 2008.

   [<a id="ref-RFC5735" name="ref-RFC5735">RFC5735</a>]  Cotton, M. and L. Vegoda, "Special Use IPv4 Addresses",
              <a href="https://tools.ietf.org/html/bcp153">BCP 153</a>, <a href="rfc5735.html">RFC 5735</a>, January 2010.

   [<a id="ref-RFC5952" name="ref-RFC5952">RFC5952</a>]  Kawamura, S. and M. Kawashima, "A Recommendation for IPv6
              Address Text Representation", <a href="rfc5952.html">RFC 5952</a>, August 2010.

   [<a id="ref-v4v6-FRAMEWORK" name="ref-v4v6-FRAMEWORK">v4v6-FRAMEWORK</a>]
              Baker, F., Li, X., Bao, C., and K. Yin, "Framework for
              IPv4/IPv6 Translation", Work in Progress, August 2010.








<span class="grey">Bao, et al.                  Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc6052.html">RFC 6052</a>        IPv6 Addressing of IPv4/IPv6 Translators    October 2010</span>


Authors' Addresses

   Congxiao Bao
   CERNET Center/Tsinghua University
   Room 225, Main Building, Tsinghua University
   Beijing,   100084
   China
   Phone: +86 10-62785983
   EMail: congxiao@cernet.edu.cn


   Christian Huitema
   Microsoft Corporation
   One Microsoft Way
   Redmond, WA  98052-6399
   U.S.A.
   EMail: huitema@microsoft.com


   Marcelo Bagnulo
   UC3M
   Av. Universidad 30
   Leganes, Madrid  28911
   Spain
   Phone: +34-91-6249500
   EMail: marcelo@it.uc3m.es
   URI:   <a href="http://www.it.uc3m.es/marcelo">http://www.it.uc3m.es/marcelo</a>


   Mohamed Boucadair
   France Telecom
   3, Av Francois Chateaux
   Rennes  350000
   France
   EMail: mohamed.boucadair@orange-ftgroup.com


   Xing Li
   CERNET Center/Tsinghua University
   Room 225, Main Building, Tsinghua University
   Beijing,   100084
   China
   Phone: +86 10-62785983
   EMail: xing@cernet.edu.cn







Bao, et al.                  Standards Track                   [Page 18]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc6052 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:32 GMT --></html>