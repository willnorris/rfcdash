<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7510 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 23 Aug 2016 18:35:03 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.119" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-xu-mpls-in-udp" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:7510" name="DC.Identifier"/>
<meta content="April, 2015" name="DC.Date.Issued"/>
<meta content="Xu, Xiaohu" name="DC.Creator"/>
<meta content="Callon, Ross" name="DC.Creator"/>
<meta content="Yong, Lucy" name="DC.Creator"/>
<meta content="Black, David" name="DC.Creator"/>
<meta content="Sheth, Nischal" name="DC.Creator"/>
<meta content="This document specifies an IP-based encapsulation for MPLS, called
MPLS-in-UDP for situations where UDP (User Datagram Protocol)
encapsulation is preferred to direct use of MPLS, e.g., to enable UDP-
based ECMP (Equal-Cost Multipath) or link aggregation. The MPLS- in-
UDP encapsulation technology must only be deployed within a single
network (with a single network operator) or networks of an adjacent
set of cooperating network operators where traffic is managed to avoid
congestion, rather than over the Internet where congestion control is
required. Usage restrictions apply to MPLS-in-UDP usage for traffic
that is not congestion controlled and to UDP zero checksum usage with
IPv6." name="DC.Description.Abstract"/>
<meta content="Encapsulating MPLS in UDP" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7510 - Encapsulating MPLS in UDP</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7510.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7510" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-mpls-in-udp" title="draft-ietf-mpls-in-udp">draft-ietf-mpls-i...</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7510" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7510" title="Side-by-side diff">Diff2</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=7510&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=7510">Errata</a>]  </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Internet Engineering Task Force (IETF)                             X. Xu
Request for Comments: 7510                           Huawei Technologies
Category: Standards Track                                       N. Sheth
ISSN: 2070-1721                                         Juniper Networks
                                                                 L. Yong
                                                              Huawei USA
                                                               R. Callon
                                                        Juniper Networks
                                                                D. Black
                                                         EMC Corporation
                                                              April 2015


                       <span class="h1">Encapsulating MPLS in UDP</span>

Abstract

   This document specifies an IP-based encapsulation for MPLS, called
   MPLS-in-UDP for situations where UDP (User Datagram Protocol)
   encapsulation is preferred to direct use of MPLS, e.g., to enable
   UDP-based ECMP (Equal-Cost Multipath) or link aggregation.  The MPLS-
   in-UDP encapsulation technology must only be deployed within a single
   network (with a single network operator) or networks of an adjacent
   set of cooperating network operators where traffic is managed to
   avoid congestion, rather than over the Internet where congestion
   control is required.  Usage restrictions apply to MPLS-in-UDP usage
   for traffic that is not congestion controlled and to UDP zero
   checksum usage with IPv6.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7510">http://www.rfc-editor.org/info/rfc7510</a>.









<span class="grey">Xu, et al.                   Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7510.html">RFC 7510</a>                Encapsulating MPLS in UDP             April 2015</span>


Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-1.1">1.1</a>.  Existing Encapsulations . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-1.2">1.2</a>.  Motivations for MPLS-in-UDP Encapsulation . . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-1.3">1.3</a>.  Applicability Statements  . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-2">2</a>.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-3">3</a>.  Encapsulation in UDP  . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-3.1">3.1</a>.  UDP Checksum Usage with IPv6  . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-3.2">3.2</a>.  Middlebox Considerations for IPv6 UDP Zero Checksums  . .  <a href="#page-10">10</a>
   <a href="#section-4">4</a>.  Processing Procedures . . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
   <a href="#section-5">5</a>.  Congestion Considerations . . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
   <a href="#section-6">6</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
   <a href="#section-7">7</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
   <a href="#section-8">8</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
     <a href="#section-8.1">8.1</a>.  Normative References  . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
     <a href="#section-8.2">8.2</a>.  Informative References  . . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
   Contributors  . . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-19">19</a>
















<span class="grey">Xu, et al.                   Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7510.html">RFC 7510</a>                Encapsulating MPLS in UDP             April 2015</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   This document specifies an IP-based encapsulation for MPLS, i.e.,
   MPLS-in-UDP, which is applicable in some circumstances where IP-based
   encapsulation for MPLS is required and further fine-grained load
   balancing of MPLS packets over IP networks over Equal-Cost Multipath
   (ECMP) and/or Link Aggregation Groups (LAGs) is required as well.
   There are already IP-based encapsulations for MPLS that allow for
   fine-grained load balancing by using some special field in the
   encapsulation header as an entropy field.  However, MPLS-in-UDP can
   be advantageous since networks have used the UDP port number fields
   as a basis for load-balancing solutions for some time.

   Like other IP-based encapsulation methods for MPLS, this
   encapsulation allows for two Label Switching Routers (LSR) to be
   adjacent on a Label Switched Path (LSP), while separated by an IP
   network.  In order to support this encapsulation, each LSR needs to
   know the capability to decapsulate MPLS-in-UDP by the remote LSRs.
   This specification defines only the data-plane encapsulation and does
   not concern itself with how the knowledge to use this encapsulation
   is conveyed.  Specifically, this capability can be either manually
   configured on each LSR or dynamically advertised in manners that are
   outside the scope of this document.

   Similarly, the MPLS-in-UDP encapsulation format defined in this
   document by itself cannot ensure the integrity and privacy of data
   packets being transported through the MPLS-in-UDP tunnels and cannot
   enable the tunnel decapsulators to authenticate the tunnel
   encapsulator.  Therefore, in the case where any of the above security
   issues is concerned, the MPLS-in-UDP SHOULD be secured with IPsec
   [<a href="rfc4301.html" title='"Security Architecture for the Internet Protocol"'>RFC4301</a>] or Datagram Transport Layer Security (DTLS) [<a href="rfc6347.html" title='"Datagram Transport Layer Security Version 1.2"'>RFC6347</a>].  For
   more details, please see <a href="#section-6">Section 6</a> (Security Considerations).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Existing%20Encapsulations"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Existing Encapsulations</span>

   Currently, there are several IP-based encapsulations for MPLS such as
   MPLS-in-IP, MPLS-in-GRE (Generic Routing Encapsulation) [<a href="rfc4023.html" title='"Encapsulating MPLS in IP or Generic Routing Encapsulation (GRE)"'>RFC4023</a>],
   and MPLS-in-L2TPv3 (Layer 2 Tunneling Protocol Version 3) [<a href="rfc4817.html" title='"Encapsulation of MPLS over Layer 2 Tunneling Protocol Version 3"'>RFC4817</a>].
   In all these methods, the IP addresses can be varied to achieve load
   balancing.

   All these IP-based encapsulations for MPLS are specified for both
   IPv4 and IPv6.  In the case of IPv6-based encapsulations, the IPv6
   Flow Label can be used for ECMP and LAGs [<a href="rfc6438.html" title='"Using the IPv6 Flow Label for Equal Cost Multipath Routing and Link Aggregation in Tunnels"'>RFC6438</a>].  However, there
   is no such entropy field in the IPv4 header.






<span class="grey">Xu, et al.                   Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7510.html">RFC 7510</a>                Encapsulating MPLS in UDP             April 2015</span>


   For MPLS-in-GRE as well as MPLS-in-L2TPv3, protocol fields (the GRE
   Key and the L2TPv3 Session ID, respectively) can be used as the load-
   balancing key as described in [<a href="rfc5640.html" title='"Load- Balancing for Mesh Softwires"'>RFC5640</a>].  For this, intermediate
   routers need to understand these fields in the context of being used
   as load-balancing keys.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Motivations%20for%20MPLS-in-UDP%20Encapsulation"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Motivations for MPLS-in-UDP Encapsulation</span>

   Most existing routers in IP networks are already capable of
   distributing IP traffic "microflows" [<a href="rfc2474.html" title='"Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers"'>RFC2474</a>] over ECMPs and/or LAG
   based on the hash of the five-tuple of UDP [<a href="rfc768.html" title='"User Datagram Protocol"'>RFC768</a>] and TCP packets
   (i.e., source IP address, destination IP address, source port,
   destination port, and protocol).  By encapsulating the MPLS packets
   into a UDP tunnel and using the source port of the UDP header as an
   entropy field, the existing load-balancing capability as mentioned
   above can be leveraged to provide fine-grained load balancing of MPLS
   traffic over IP networks.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20Applicability%20Statements"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  Applicability Statements</span>

   The MPLS-in-UDP encapsulation technology MUST only be deployed within
   a single network (with a single network operator) or networks of an
   adjacent set of cooperating network operators where traffic is
   managed to avoid congestion, rather than over the Internet where
   congestion control is required.  Furthermore, packet filters SHOULD
   be added to prevent MPLS-in-UDP packets from escaping from the
   network due to misconfiguration or packet errors.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].


















<span class="grey">Xu, et al.                   Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7510.html">RFC 7510</a>                Encapsulating MPLS in UDP             April 2015</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Encapsulation%20in%20UDP"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Encapsulation in UDP</span>

   MPLS-in-UDP encapsulation format is shown as follows:

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Source Port = Entropy      |       Dest Port = MPLS        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |           UDP Length          |        UDP Checksum           |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     ~                       MPLS Label Stack                        ~
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                                                               |
     ~                         Message Body                          ~
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      Source Port of UDP

         This field contains a 16-bit entropy value that is generated by
         the encapsulator to uniquely identify a flow.  What constitutes
         a flow is locally determined by the encapsulator and therefore
         is outside the scope of this document.  What algorithm is
         actually used by the encapsulator to generate an entropy value
         is outside the scope of this document.

         In case the tunnel does not need entropy, this field of all
         packets belonging to a given flow SHOULD be set to a randomly
         selected constant value so as to avoid packet reordering.

         To ensure that the source port number is always in the range
         49152 to 65535 (note that those ports less than 49152 are
         reserved by IANA to identify specific applications/protocols),
         which may be required in some cases, instead of calculating a
         16-bit hash, the encapsulator SHOULD calculate a 14-bit hash
         and use those 14 bits as the least significant bits of the
         source port field.  Also, the most significant two bits SHOULD
         be set to binary 11.  That still conveys 14 bits of entropy
         information, which would be enough in practice.

      Destination Port of UDP

         This field is set to a value (6635) allocated by IANA to
         indicate that the UDP tunnel payload is an MPLS packet.



<span class="grey">Xu, et al.                   Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7510.html">RFC 7510</a>                Encapsulating MPLS in UDP             April 2015</span>


      UDP Length

         The usage of this field is in accordance with the current UDP
         specification [<a href="rfc768.html" title='"User Datagram Protocol"'>RFC768</a>].

      UDP Checksum

         For IPv4 UDP encapsulation, this field is RECOMMENDED to be set
         to zero for performance or implementation reasons because the
         IPv4 header includes a checksum and use of the UDP checksum is
         optional with IPv4, unless checksum protection of VPN labels is
         important (see <a href="#section-6">Section 6</a>).  For IPv6 UDP encapsulation, the
         IPv6 header does not include a checksum, so this field MUST
         contain a UDP checksum that MUST be used as specified in
         [<a href="rfc768.html" title='"User Datagram Protocol"'>RFC768</a>] and [<a href="rfc2460.html" title='"Internet Protocol, Version 6 (IPv6) Specification"'>RFC2460</a>] unless one of the exceptions that allows
         use of UDP zero-checksum mode (as specified in [<a href="rfc6935.html" title='"IPv6 and UDP Checksums for Tunneled Packets"'>RFC6935</a>])
         applies.  See <a href="#section-3.1">Section 3.1</a> for specification of these exceptions
         and additional requirements that apply when UDP zero-checksum
         mode is used for MPLS-in-UDP traffic over IPv6.

      MPLS Label Stack

         This field contains an MPLS Label Stack as defined in
         [<a href="rfc3032.html" title='"MPLS Label Stack Encoding"'>RFC3032</a>].

      Message Body

         This field contains one MPLS message body.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20UDP%20Checksum%20Usage%20with%20IPv6"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  UDP Checksum Usage with IPv6</span>

   When UDP is used over IPv6, the UDP checksum is relied upon to
   protect both the IPv6 and UDP headers from corruption and MUST be
   used unless the requirements in [<a href="rfc6935.html" title='"IPv6 and UDP Checksums for Tunneled Packets"'>RFC6935</a>] and [<a href="rfc6936.html" title='"Applicability Statement for the Use of IPv6 UDP Datagrams with Zero Checksums"'>RFC6936</a>] for use of
   UDP zero-checksum mode with a tunnel protocol are satisfied.  MPLS-
   in-UDP is a tunnel protocol, and there is significant successful
   deployment of MPLS-in-IPv6 without UDP (i.e., without a checksum that
   covers the IPv6 header or the MPLS label stack), as described in
   <a href="rfc6936.html#section-3.1">Section 3.1 of [RFC6936]</a>:

      There is extensive experience with deployments using tunnel
      protocols in well-managed networks (e.g., corporate networks and
      service provider core networks).  This has shown the robustness of
      methods such as Pseudowire Emulation Edge-to-Edge (PWE3) and MPLS
      that do not employ a transport protocol checksum and that have not
      specified mechanisms to protect from corruption of the unprotected
      headers (such as the VPN Identifier in MPLS).




<span class="grey">Xu, et al.                   Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7510.html">RFC 7510</a>                Encapsulating MPLS in UDP             April 2015</span>


   The UDP checksum MUST be implemented and MUST be used in accordance
   with [<a href="rfc768.html" title='"User Datagram Protocol"'>RFC768</a>] and [<a href="rfc2460.html" title='"Internet Protocol, Version 6 (IPv6) Specification"'>RFC2460</a>] for MPLS-in-UDP traffic over IPv6 unless
   one or more of the following exceptions applies and the additional
   requirements stated below are complied with.  There are three
   exceptions that allow use of UDP zero-checksum mode for IPv6 with
   MPLS-in-UDP, subject to the additional requirements stated below in
   this section.  The three exceptions are:

   a.  Use of MPLS-in-UDP in networks under single administrative
       control (such as within a single operator's network) where it is
       known (perhaps through knowledge of equipment types and lower-
       layer checks) that packet corruption is exceptionally unlikely
       and where the operator is willing to take the risk of undetected
       packet corruption.

   b.  Use of MPLS-in-UDP in networks under single administrative
       control (such as within a single operator's network) where it is
       judged through observational measurements (perhaps of historic or
       current traffic flows that use a non-zero checksum) that the
       level of packet corruption is tolerably low and where the
       operator is willing to take the risk of undetected packet
       corruption.

   c.  Use of MPLS-in-UDP for traffic delivery for applications that are
       tolerant of misdelivered or corrupted packets (perhaps through
       higher-layer checksum, validation, and retransmission or
       transmission redundancy) where the operator is willing to rely on
       the applications using the tunnel to survive any corrupt packets.

   These exceptions may also be extended to the use of MPLS-in-UDP
   within a set of closely cooperating network administrations (such as
   network operators who have agreed to work together in order to
   jointly provide specific services).  Even when one of the above
   exceptions applies, use of UDP checksums may be appropriate when VPN
   services are provided over MPLS-in-UDP; see <a href="#section-6">Section 6</a>.

   As such, for IPv6, the UDP checksum for MPLS-in-UDP MUST be used as
   specified in [<a href="rfc768.html" title='"User Datagram Protocol"'>RFC768</a>] and [<a href="rfc2460.html" title='"Internet Protocol, Version 6 (IPv6) Specification"'>RFC2460</a>] for tunnels that span multiple
   networks whose network administrations do not cooperate closely, even
   if each non-cooperating network administration independently
   satisfies one or more of the exceptions for UDP zero-checksum mode
   usage with MPLS-in-UDP over IPv6.

   The following additional requirements apply to implementation and use
   of UDP zero-checksum mode for MPLS-in-UDP over IPv6:

   a.  Use of the UDP checksum with IPv6 MUST be the default
       configuration of all MPLS-in-UDP implementations.



<span class="grey">Xu, et al.                   Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7510.html">RFC 7510</a>                Encapsulating MPLS in UDP             April 2015</span>


   b.  The MPLS-in-UDP implementation MUST comply with all requirements
       specified in <a href="rfc6936.html#section-4">Section 4 of [RFC6936]</a> and with requirement 1
       specified in <a href="rfc6936.html#section-5">Section 5 of [RFC6936]</a>.

   c.  The tunnel decapsulator SHOULD only allow the use of UDP zero-
       checksum mode for IPv6 on a single received UDP Destination Port
       regardless of the encapsulator.  The motivation for this
       requirement is possible corruption of the UDP Destination Port,
       which may cause packet delivery to the wrong UDP port.  If that
       other UDP port requires the UDP checksum, the misdelivered packet
       will be discarded

   d.  The tunnel decapsulator MUST check that the source and
       destination IPv6 addresses are valid for the MPLS-in-UDP tunnel
       on which the packet was received if that tunnel uses UDP zero-
       checksum mode and discard any packet for which this check fails.

   e.  The tunnel encapsulator SHOULD use different IPv6 addresses for
       each MPLS-in-UDP tunnel that uses UDP zero-checksum mode
       (regardless of decapsulator) in order to strengthen the
       decapsulator's check of the IPv6 source address (i.e., the same
       IPv6 source address SHOULD NOT be used with more than one IPv6
       destination address, independent of whether that destination
       address is a unicast or multicast address).  When this is not
       possible, it is RECOMMENDED to use each source IPv6 address for
       as few UDP zero-checksum mode MPLS-in-UDP tunnels (i.e., with as
       few destination IPv6 addresses) as is feasible.

   f.  Any middlebox support for MPLS-in-UDP with UDP zero-checksum mode
       for IPv6 MUST comply with requirements 1 and 8-10 in <a href="rfc6936.html#section-5">Section 5 of
       [RFC6936]</a>.

   g.  Measures SHOULD be taken to prevent IPv6 traffic with zero UDP
       checksums from "escaping" to the general Internet; see <a href="#section-5">Section 5</a>
       for examples of such measures.

   h.  IPv6 traffic with zero UDP checksums MUST be actively monitored
       for errors by the network operator.

   The above requirements do not change either the requirements
   specified in [<a href="rfc2460.html" title='"Internet Protocol, Version 6 (IPv6) Specification"'>RFC2460</a>] as modified by [<a href="rfc6935.html" title='"IPv6 and UDP Checksums for Tunneled Packets"'>RFC6935</a>] or the requirements
   specified in [<a href="rfc6936.html" title='"Applicability Statement for the Use of IPv6 UDP Datagrams with Zero Checksums"'>RFC6936</a>].

   The requirement to check the source IPv6 address in addition to the
   destination IPv6 address, plus the strong recommendation against
   reuse of source IPv6 addresses among MPLS-in-UDP tunnels collectively
   provide some mitigation for the absence of UDP checksum coverage of
   the IPv6 header.  In addition, the MPLS data plane only forwards



<span class="grey">Xu, et al.                   Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7510.html">RFC 7510</a>                Encapsulating MPLS in UDP             April 2015</span>


   packets with valid labels (i.e., labels that have been distributed by
   the tunnel egress LSR), providing some additional opportunity to
   detect MPLS-in-UDP packet misdelivery when the misdelivered packet
   contains a label that is not valid for forwarding at the receiving
   LSR.  The expected result for IPv6 UDP zero-checksum mode for MPLS-
   in-UDP is that corruption of the destination IPv6 address will
   usually cause packet discard, as offsetting corruptions to the source
   IPv6 and/or MPLS top label are unlikely.  Additional assurance is
   provided by the restrictions in the above exceptions that limit usage
   of IPv6 UDP zero-checksum mode to well-managed networks for which
   MPLS packet corruption has not been a problem in practice.

   Hence, MPLS-in-UDP is suitable for transmission over lower layers in
   the well-managed networks that are allowed by the exceptions stated
   above, and the rate of corruption of the inner IP packet on such
   networks is not expected to increase by comparison to MPLS traffic
   that is not encapsulated in UDP.  For these reasons, MPLS-in-UDP does
   not provide an additional integrity check when UDP zero-checksum mode
   is used with IPv6, and this design is in accordance with requirements
   2, 3, and 5 specified in <a href="rfc6936.html#section-5">Section 5 of [RFC6936]</a>.

   MPLS does not accumulate incorrect state as a consequence of label
   stack corruption.  A corrupt MPLS label results in either packet
   discard or forwarding (and forgetting) of the packet without
   accumulation of MPLS protocol state.  Active monitoring of MPLS-in-
   UDP traffic for errors is REQUIRED as occurrence of errors will
   result in some accumulation of error information outside the MPLS
   protocol for operational and management purposes.  This design is in
   accordance with requirement 4 specified in <a href="rfc6936.html#section-5">Section 5 of [RFC6936]</a>.

   The remaining requirements specified in <a href="rfc6936.html#section-5">Section 5 of [RFC6936]</a> are
   inapplicable to MPLS-in-UDP.  Requirements 6 and 7 do not apply
   because MPLS does not have an MPLS-generic control feedback
   mechanism.  Requirements 8-10 are middlebox requirements that do not
   apply to MPLS-in-UDP tunnel endpoints, but see <a href="#section-3.2">Section 3.2</a> for
   further middlebox discussion.

   In summary, UDP zero-checksum mode for IPv6 is allowed to be used
   with MPLS-in-UDP when one of the three exceptions specified above
   applies, provided that the additional requirements specified in this
   section are complied with.  Otherwise, the UDP checksum MUST be used
   for IPv6 as specified in [<a href="rfc768.html" title='"User Datagram Protocol"'>RFC768</a>] and [<a href="rfc2460.html" title='"Internet Protocol, Version 6 (IPv6) Specification"'>RFC2460</a>].

   This entire section and its requirements apply only to use of UDP
   zero-checksum mode for IPv6; they can be avoided by using the UDP
   checksum as specified in [<a href="rfc768.html" title='"User Datagram Protocol"'>RFC768</a>] and [<a href="rfc2460.html" title='"Internet Protocol, Version 6 (IPv6) Specification"'>RFC2460</a>].





<span class="grey">Xu, et al.                   Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7510.html">RFC 7510</a>                Encapsulating MPLS in UDP             April 2015</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Middlebox%20Considerations%20for%20IPv6%20UDP%20Zero%20Checksums"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Middlebox Considerations for IPv6 UDP Zero Checksums</span>

   IPv6 datagrams with a zero UDP checksum will not be passed by any
   middlebox that validates the checksum based on [<a href="rfc2460.html" title='"Internet Protocol, Version 6 (IPv6) Specification"'>RFC2460</a>] or that
   updates the UDP checksum field, such as NATs or firewalls.  Changing
   this behavior would require such middleboxes to be updated to
   correctly handle datagrams with zero UDP checksums.  The MPLS-in-UDP
   encapsulation does not provide a mechanism to safely fall back to
   using a checksum when a path change occurs redirecting a tunnel over
   a path that includes a middlebox that discards IPv6 datagrams with a
   zero UDP checksum.  In this case, the MPLS-in-UDP tunnel will be
   black-holed by that middlebox.  Recommended changes to allow
   firewalls, NATs, and other middleboxes to support use of an IPv6 zero
   UDP checksum are described in <a href="rfc6936.html#section-5">Section 5 of [RFC6936]</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Processing%20Procedures"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Processing Procedures</span>

   This MPLS-in-UDP encapsulation causes MPLS packets to be forwarded
   through "UDP tunnels".  When performing MPLS-in-UDP encapsulation by
   the encapsulator, the entropy value would be generated by the
   encapsulator and then be filled in the Source Port field of the UDP
   header.  The Destination Port field is set to a value (6635)
   allocated by IANA to indicate that the UDP tunnel payload is an MPLS
   packet.  As for whether the top label of the encapsulated MPLS packet
   is downstream-assigned or upstream-assigned, it is determined
   according to the following criteria, which are compatible with
   [<a href="rfc5332.html" title='"MPLS Multicast Encapsulations"'>RFC5332</a>]:

   a.  If the tunnel destination IP address is a unicast address, the
       top label MUST be downstream-assigned;

   b.  If the tunnel destination IP address is an IP multicast address,
       either all encapsulated MPLS packets in the particular tunnel
       have a downstream-assigned label at the top of the stack, or all
       encapsulated MPLS packets in that tunnel have an upstream-
       assigned label at the top of the stack.  The means by which this
       is determined for a particular tunnel is outside the scope of
       this specification.  In the absence of any knowledge about a
       specific tunnel, the label SHOULD be presumed to be upstream-
       assigned.

   Intermediate routers, upon receiving these UDP encapsulated packets,
   could balance these packets based on the hash of the five-tuple of
   UDP packets.  Upon receiving these UDP-encapsulated packets, the
   decapsulator would decapsulate them by removing the UDP headers and
   then process them accordingly.  For other common processing
   procedures associated with tunneling encapsulation technologies
   including but not limited to Maximum Transmission Unit (MTU) and



<span class="grey">Xu, et al.                   Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7510.html">RFC 7510</a>                Encapsulating MPLS in UDP             April 2015</span>


   preventing fragmentation and reassembly, Time to Live (TTL), and
   differentiated services, the corresponding "Common Procedures"
   defined in [<a href="rfc4023.html" title='"Encapsulating MPLS in IP or Generic Routing Encapsulation (GRE)"'>RFC4023</a>], which are applicable for MPLS-in-IP and
   MPLS-in-GRE encapsulation formats SHOULD be followed.

   Note: Each UDP tunnel is unidirectional, as MPLS-in-UDP traffic is
   sent to the IANA-allocated UDP Destination Port, and in particular,
   is never sent back to any port used as a UDP Source Port (which
   serves solely as a source of entropy).  This is at odds with a
   typical middlebox (e.g., firewall) assumption that bidirectional
   traffic uses a common pair of UDP ports.  As a result, arranging to
   pass bidirectional MPLS-in-UDP traffic through middleboxes may
   require separate configuration for each direction of traffic.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Congestion%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Congestion Considerations</span>

   <a href="rfc5405.html#section-3.1.3">Section 3.1.3 of [RFC5405]</a> discussed the congestion implications of
   UDP tunnels.  As discussed in [<a href="rfc5405.html" title='"Unicast UDP Usage Guidelines for Application Designers"'>RFC5405</a>], because other flows can
   share the path with one or more UDP tunnels, congestion control
   [<a href="rfc2914.html" title='"Congestion Control Principles"'>RFC2914</a>] needs to be considered.

   A major motivation for encapsulating MPLS in UDP is to improve the
   use of multipath (such as ECMP) in cases where traffic is to traverse
   routers that are able to hash on UDP Port and IP address.  As such,
   in many cases this may reduce the occurrence of congestion and
   improve usage of available network capacity.  However, it is also
   necessary to ensure that the network, including applications that use
   the network, responds appropriately in more difficult cases, such as
   when link or equipment failures have reduced the available capacity.

   The impact of congestion must be considered both in terms of the
   effect on the rest of the network of a UDP tunnel that is consuming
   excessive capacity, and in terms of the effect on the flows using the
   UDP tunnels.  The potential impact of congestion from a UDP tunnel
   depends upon what sort of traffic is carried over the tunnel, as well
   as the path of the tunnel.

   MPLS is widely used to carry an extensive range of traffic.  In many
   cases, MPLS is used to carry IP traffic.  IP traffic is generally
   assumed to be congestion controlled, and thus a tunnel carrying
   general IP traffic (as might be expected to be carried across the
   Internet) generally does not need additional congestion control
   mechanisms.  As specified in [<a href="rfc5405.html" title='"Unicast UDP Usage Guidelines for Application Designers"'>RFC5405</a>]:








<span class="grey">Xu, et al.                   Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7510.html">RFC 7510</a>                Encapsulating MPLS in UDP             April 2015</span>


      IP-based traffic is generally assumed to be congestion-controlled,
      i.e., it is assumed that the transport protocols generating IP-
      based traffic at the sender already employ mechanisms that are
      sufficient to address congestion on the path.  Consequently, a
      tunnel carrying IP-based traffic should already interact
      appropriately with other traffic sharing the path, and specific
      congestion control mechanisms for the tunnel are not necessary.

   For this reason, where MPLS-in-UDP tunneling is used to carry IP
   traffic that is known to be congestion controlled, the UDP tunnels
   MAY be used within a single network or across multiple networks, with
   cooperating network operators.  Internet IP traffic is generally
   assumed to be congestion controlled.  Similarly, in general, Layer 3
   VPNs are carrying IP traffic that is similarly assumed to be
   congestion controlled.

   Whether or not Layer 2 VPN traffic is congestion controlled may
   depend upon the specific services being offered and what use is being
   made of the Layer 2 services.

   However, MPLS is also used in many cases to carry traffic that is not
   necessarily congestion controlled.  For example, MPLS may be used to
   carry pseudowire or VPN traffic where specific bandwidth guarantees
   are provided to each pseudowire or to each VPN.

   In such cases, network operators may avoid congestion by careful
   provisioning of their networks, by rate limiting of user data
   traffic, and/or by using MPLS Traffic Engineering (MPLS-TE) to assign
   specific bandwidth guarantees to each LSP.  Where MPLS is carried
   over UDP over IP, the identity of each individual MPLS flow is lost,
   in general, and MPLS-TE cannot be used to guarantee bandwidth to
   specific flows (since many LSPs may be multiplexed over a single UDP
   tunnel, and many UDP tunnels may be mixed in an IP network).

   For this reason, where the MPLS traffic is not congestion controlled,
   MPLS-in-UDP tunnels MUST only be used within a single operator's
   network that utilizes careful provisioning (e.g., rate limiting at
   the entries of the network while over-provisioning network capacity)
   to ensure against congestion, or within a limited number of networks
   whose operators closely cooperate in order to jointly provide this
   same careful provisioning.

   As such, MPLS-in-UDP MUST NOT be used over the general Internet, or
   over non-cooperating network operators, to carry traffic that is not
   congestion controlled.






<span class="grey">Xu, et al.                   Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc7510.html">RFC 7510</a>                Encapsulating MPLS in UDP             April 2015</span>


   Measures SHOULD be taken to prevent non-congestion-controlled MPLS-
   in-UDP traffic from "escaping" to the general Internet, e.g.:

   a.  Physical or logical isolation of the links carrying MPLS-over-UDP
       from the general Internet.

   b.  Deployment of packet filters that block the UDP Destination Ports
       used for MPLS-over-UDP.

   c.  Imposition of restrictions on MPLS-in-UDP traffic by software
       tools used to set up MPLS-in-UDP tunnels between specific end
       systems (as might be used within a single data center).

   d.  Use of a "Managed Circuit Breaker" for the MPLS traffic as
       described in [<a href="#ref-CIRCUIT-BREAKER">CIRCUIT-BREAKER</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Security Considerations</span>

   The security problems faced with the MPLS-in-UDP tunnel are exactly
   the same as those faced with MPLS-in-IP and MPLS-in-GRE tunnels
   [<a href="rfc4023.html" title='"Encapsulating MPLS in IP or Generic Routing Encapsulation (GRE)"'>RFC4023</a>].  In other words, the MPLS-in-UDP tunnel as defined in this
   document by itself cannot ensure the integrity and privacy of data
   packets being transported through the MPLS-in-UDP tunnel and cannot
   enable the tunnel decapsulator to authenticate the tunnel
   encapsulator.  In the case where any of the above security issues is
   concerned, the MPLS-in-UDP tunnel SHOULD be secured with IPsec or
   DTLS.  IPsec was designed as a network security mechanism, and
   therefore it resides at the network layer.  As such, if the tunnel is
   secured with IPsec, the UDP header would not be visible to
   intermediate routers anymore in either IPsec tunnel or transport
   mode.  As a result, the meaning of adopting the MPLS-in-UDP tunnel as
   an alternative to the MPLS-in-GRE or MPLS-in-IP tunnel is lost.  By
   comparison, DTLS is better suited for application security and can
   better preserve network- and transport-layer protocol information.
   Specifically, if DTLS is used, the destination port of the UDP header
   MUST be set to an IANA-assigned value (6636) indicating MPLS-in-UDP
   with DTLS, and that UDP port MUST NOT be used for other traffic.  The
   UDP source port field can still be used to add entropy, e.g., for
   load-sharing purposes.  DTLS usage is limited to a single DTLS
   session for any specific tunnel encapsulator/decapsulator pair
   (identified by source and destination IP addresses).  Both IP
   addresses MUST be unicast addresses -- multicast traffic is not
   supported when DTLS is used.  An MPLS-in-UDP tunnel decapsulator
   implementation that supports DTLS is expected to be able to establish
   DTLS sessions with multiple tunnel encapsulators.  Likewise, an MPLS-
   in-UDP tunnel encapsulator implementation is expected to be able to
   establish DTLS sessions with multiple decapsulators.  (However,




<span class="grey">Xu, et al.                   Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc7510.html">RFC 7510</a>                Encapsulating MPLS in UDP             April 2015</span>


   different source and/or destination IP addresses may be involved.
   See <a href="#section-3.1">Section 3.1</a> for discussion of one situation where use of
   different source IP addresses is important.)

   If the tunnel is not secured with IPsec or DTLS, some other method
   should be used to ensure that packets are decapsulated and forwarded
   by the tunnel tail only if those packets were encapsulated by the
   tunnel head.  If the tunnel lies entirely within a single
   administrative domain, address filtering at the boundaries can be
   used to ensure that no packet with the IP source address of a tunnel
   endpoint or with the IP destination address of a tunnel endpoint can
   enter the domain from outside.  However, when the tunnel head and the
   tunnel tail are not in the same administrative domain, this may
   become difficult, and filtering based on the destination address can
   even become impossible if the packets must traverse the public
   Internet.  Sometimes only source address filtering (but not
   destination address filtering) is done at the boundaries of an
   administrative domain.  If this is the case, the filtering does not
   provide effective protection at all unless the decapsulator of an
   MPLS-in-UDP validates the IP source address of the packet.

   This document does not require that the decapsulator validate the IP
   source address of the tunneled packets (with the exception that the
   IPv6 source address MUST be validated when UDP zero-checksum mode is
   used with IPv6), but it should be understood that failure to do so
   presupposes that there is effective destination-based (or a
   combination of source-based and destination-based) filtering at the
   boundaries.  MPLS-based VPN services rely on a VPN label in the MPLS
   label stack to identify the VPN.  Corruption of that label could leak
   traffic across VPN boundaries.  Such leakage is highly undesirable
   when inter-VPN isolation is used for privacy or security reasons.
   When that is the case, UDP checksums SHOULD be used for MPLS-in-UDP
   with both IPv4 and IPv6, and in particular, UDP zero-checksum mode
   SHOULD NOT be used with IPv6.  Each UDP checksum covers the VPN
   label, thereby providing increased assurance of isolation among VPNs.
















<span class="grey">Xu, et al.                   Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc7510.html">RFC 7510</a>                Encapsulating MPLS in UDP             April 2015</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  IANA Considerations</span>

   One UDP destination port number indicating MPLS has been allocated by
   IANA:

      Service Name: MPLS-UDP

      Transport Protocol(s): UDP

      Assignee: IESG &lt;iesg@ietf.org&gt;

      Contact: IETF Chair &lt;chair@ietf.org&gt;.

      Description: Encapsulate MPLS packets in UDP tunnels.

      Reference: <a href="rfc7510.html">RFC 7510</a>

      Port Number: 6635

   One UDP destination port number indicating MPLS with DTLS has been
   allocated by IANA:

      Service Name: MPLS-UDP-DTLS

      Transport Protocol(s): UDP

      Assignee: IESG &lt;iesg@ietf.org&gt;

      Contact: IETF Chair &lt;chair@ietf.org&gt;.

      Description: Encapsulate MPLS packets in UDP tunnels with DTLS.

      Reference: <a href="rfc7510.html">RFC 7510</a>

      Port Number: 6636

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20References"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Normative%20References"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Normative References</span>

   [<a id="ref-RFC768" name="ref-RFC768">RFC768</a>]   Postel, J., "User Datagram Protocol", STD 6, <a href="rfc768.html">RFC 768</a>,
              August 1980, &lt;<a href="http://www.rfc-editor.org/info/rfc768">http://www.rfc-editor.org/info/rfc768</a>&gt;.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.





<span class="grey">Xu, et al.                   Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc7510.html">RFC 7510</a>                Encapsulating MPLS in UDP             April 2015</span>


   [<a id="ref-RFC2460" name="ref-RFC2460">RFC2460</a>]  Deering, S. and R. Hinden, "Internet Protocol, Version 6
              (IPv6) Specification", <a href="rfc2460.html">RFC 2460</a>, December 1998,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2460">http://www.rfc-editor.org/info/rfc2460</a>&gt;.

   [<a id="ref-RFC3032" name="ref-RFC3032">RFC3032</a>]  Rosen, E., Tappan, D., Fedorkow, G., Rekhter, Y.,
              Farinacci, D., Li, T., and A. Conta, "MPLS Label Stack
              Encoding", <a href="rfc3032.html">RFC 3032</a>, January 2001,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3032">http://www.rfc-editor.org/info/rfc3032</a>&gt;.

   [<a id="ref-RFC4301" name="ref-RFC4301">RFC4301</a>]  Kent, S. and K. Seo, "Security Architecture for the
              Internet Protocol", <a href="rfc4301.html">RFC 4301</a>, December 2005,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4301">http://www.rfc-editor.org/info/rfc4301</a>&gt;.

   [<a id="ref-RFC5332" name="ref-RFC5332">RFC5332</a>]  Eckert, T., Rosen, E., Ed., Aggarwal, R., and Y. Rekhter,
              "MPLS Multicast Encapsulations", <a href="rfc5332.html">RFC 5332</a>, August 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5332">http://www.rfc-editor.org/info/rfc5332</a>&gt;.

   [<a id="ref-RFC5405" name="ref-RFC5405">RFC5405</a>]  Eggert, L. and G. Fairhurst, "Unicast UDP Usage Guidelines
              for Application Designers", <a href="https://tools.ietf.org/html/bcp145">BCP 145</a>, <a href="rfc5405.html">RFC 5405</a>, November
              2008, &lt;<a href="http://www.rfc-editor.org/info/rfc5405">http://www.rfc-editor.org/info/rfc5405</a>&gt;.

   [<a id="ref-RFC6347" name="ref-RFC6347">RFC6347</a>]  Rescorla, E. and N. Modadugu, "Datagram Transport Layer
              Security Version 1.2", <a href="rfc6347.html">RFC 6347</a>, January 2012,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6347">http://www.rfc-editor.org/info/rfc6347</a>&gt;.

   [<a id="ref-RFC6935" name="ref-RFC6935">RFC6935</a>]  Eubanks, M., Chimento, P., and M. Westerlund, "IPv6 and
              UDP Checksums for Tunneled Packets", <a href="rfc6935.html">RFC 6935</a>, April 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6935">http://www.rfc-editor.org/info/rfc6935</a>&gt;.

   [<a id="ref-RFC6936" name="ref-RFC6936">RFC6936</a>]  Fairhurst, G. and M. Westerlund, "Applicability Statement
              for the Use of IPv6 UDP Datagrams with Zero Checksums",
              <a href="rfc6936.html">RFC 6936</a>, April 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6936">http://www.rfc-editor.org/info/rfc6936</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Informative%20References"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Informative References</span>

   [<a id="ref-CIRCUIT-BREAKER" name="ref-CIRCUIT-BREAKER">CIRCUIT-BREAKER</a>]
              Fairhurst, G., <a href="https://www.google.com/search?sitesearch=tools.ietf.org%2Fhtml%2F&amp;q=inurl:draft-+%22Network+Transport+Circuit+Breakers%22" style="text-decoration: none">"Network Transport Circuit Breakers"</a>, Work
              in Progress, <a href="https://tools.ietf.org/html/draft-ietf-tsvwg-circuit-breaker-01">draft-ietf-tsvwg-circuit-breaker-01</a>, April
              2015.

   [<a id="ref-RFC2474" name="ref-RFC2474">RFC2474</a>]  Nichols, K., Blake, S., Baker, F., and D. Black,
              "Definition of the Differentiated Services Field (DS
              Field) in the IPv4 and IPv6 Headers", <a href="rfc2474.html">RFC 2474</a>, December
              1998, &lt;<a href="http://www.rfc-editor.org/info/rfc2474">http://www.rfc-editor.org/info/rfc2474</a>&gt;.






<span class="grey">Xu, et al.                   Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc7510.html">RFC 7510</a>                Encapsulating MPLS in UDP             April 2015</span>


   [<a id="ref-RFC2914" name="ref-RFC2914">RFC2914</a>]  Floyd, S., "Congestion Control Principles", <a href="https://tools.ietf.org/html/bcp41">BCP 41</a>, <a href="rfc2914.html">RFC</a>
              <a href="rfc2914.html">2914</a>, September 2000,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2914">http://www.rfc-editor.org/info/rfc2914</a>&gt;.

   [<a id="ref-RFC4023" name="ref-RFC4023">RFC4023</a>]  Worster, T., Rekhter, Y., and E. Rosen, Ed.,
              "Encapsulating MPLS in IP or Generic Routing Encapsulation
              (GRE)", <a href="rfc4023.html">RFC 4023</a>, March 2005,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4023">http://www.rfc-editor.org/info/rfc4023</a>&gt;.

   [<a id="ref-RFC4817" name="ref-RFC4817">RFC4817</a>]  Townsley, M., Pignataro, C., Wainner, S., Seely, T., and
              J. Young, "Encapsulation of MPLS over Layer 2 Tunneling
              Protocol Version 3", <a href="rfc4817.html">RFC 4817</a>, March 2007,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4817">http://www.rfc-editor.org/info/rfc4817</a>&gt;.

   [<a id="ref-RFC5640" name="ref-RFC5640">RFC5640</a>]  Filsfils, C., Mohapatra, P., and C. Pignataro, "Load-
              Balancing for Mesh Softwires", <a href="rfc5640.html">RFC 5640</a>, August 2009,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5640">http://www.rfc-editor.org/info/rfc5640</a>&gt;.

   [<a id="ref-RFC6438" name="ref-RFC6438">RFC6438</a>]  Carpenter, B. and S. Amante, "Using the IPv6 Flow Label
              for Equal Cost Multipath Routing and Link Aggregation in
              Tunnels", <a href="rfc6438.html">RFC 6438</a>, November 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6438">http://www.rfc-editor.org/info/rfc6438</a>&gt;.

Acknowledgements

   Thanks to Shane Amante, Dino Farinacci, Keshava A K, Ivan Pepelnjak,
   Eric Rosen, Andrew G. Malis, Kireeti Kompella, Marshall Eubanks,
   George Swallow, Loa Andersson, Vivek Kumar, Stewart Bryant, Wen
   Zhang, Joel M. Halpern, Noel Chiappa, Scott Brim, Alia Atlas,
   Alexander Vainshtein, Joel Jaeggli, Edward Crabbe, Mark Tinka, Lars
   Eggert, Joe Touch, Lloyd Wood, Gorry Fairhurst, Weiguo Hao, Mark
   Szczesniak, Stephen Farrell, Martin Stiemerling, Zhenxiao Liu, and
   Xing Tong for their valuable comments and suggestions on this
   document.

   Special thanks to Alia Atlas for her insightful suggestion of adding
   an applicability statement.

   Thanks to Daniel King, Gregory Mirsky, and Eric Osborne for their
   valuable MPLS-RT reviews on this document.  Thanks to Charlie Kaufman
   for his SecDir review of this document.  Thanks to Nevil Brownlee for
   the OPS-Dir review of this document.  Thanks to Roni Even for the
   Gen-ART review of this document.  Thanks to Pearl Liang for the IANA
   review of this document.







<span class="grey">Xu, et al.                   Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc7510.html">RFC 7510</a>                Encapsulating MPLS in UDP             April 2015</span>


Contributors

   Note that contributors are listed in alphabetical order according to
   their last names.

      Yongbing Fan
      China Telecom
      EMail: fanyb@gsta.com

      Adrian Farrel
      Juniper Networks
      EMail: adrian@olddog.co.uk

      Zhenbin Li
      Huawei Technologies
      EMail: lizhenbin@huawei.com

      Carlos Pignataro
      Cisco Systems
      EMail: cpignata@cisco.com

      Curtis Villamizar
      Outer Cape Cod Network Consulting, LLC
      EMail: curtis@occnc.com



























<span class="grey">Xu, et al.                   Standards Track                   [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc7510.html">RFC 7510</a>                Encapsulating MPLS in UDP             April 2015</span>


Authors' Addresses

   Xiaohu Xu
   Huawei Technologies
   No.156 Beiqing Rd
   Beijing  100095
   China

   Phone: +86-10-60610041
   EMail: xuxiaohu@huawei.com


   Nischal Sheth
   Juniper Networks
   1194 N. Mathilda Ave
   Sunnyvale, CA  94089
   United States

   EMail: nsheth@juniper.net


   Lucy Yong
   Huawei USA

   EMail: Lucy.yong@huawei.com


   Ross Callon
   Juniper Networks

   EMail: rcallon@juniper.net


   David Black
   EMC Corporation
   176 South Street
   Hopkinton, MA  01748
   United States

   EMail: david.black@emc.com











Xu, et al.                   Standards Track                   [Page 19]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.119, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7510 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 23 Aug 2016 18:35:03 GMT --></html>