<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7610 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 23 Aug 2016 18:34:44 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.119" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-gont-opsec-dhcpv6-shield" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:7610" name="DC.Identifier"/>
<meta content="August, 2015" name="DC.Date.Issued"/>
<meta content="Velde, Gunter Van de" name="DC.Creator"/>
<meta content="Gont, Fernando" name="DC.Creator"/>
<meta content="This document specifies a mechanism for protecting hosts connected to
a switched network against rogue DHCPv6 servers. It is based on DHCPv6
packet filtering at the layer 2 device at which the packets are
received. A similar mechanism has been widely deployed in IPv4
networks ('DHCP snooping'); hence, it is desirable that similar
functionality be provided for IPv6 networks. This document specifies a
Best Current Practice for the implementation of DHCPv6-Shield." name="DC.Description.Abstract"/>
<meta content="DHCPv6-Shield: Protecting against Rogue DHCPv6 Servers" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7610 - DHCPv6-Shield: Protecting against Rogue DHCPv6 Servers</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgmagenta" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7610.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7610" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-opsec-dhcpv6-shield" title="draft-ietf-opsec-dhcpv6-shield">draft-ietf-opsec-...</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7610" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7610" title="Side-by-side diff">Diff2</a>]                 </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                   BEST CURRENT PRACTICE</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                           F. Gont
Request for Comments: 7610                        SI6 Networks / UTN-FRH
BCP: 199                                                          W. Liu
Category: Best Current Practice                      Huawei Technologies
ISSN: 2070-1721                                          G. Van de Velde
                                                          Alcatel-Lucent
                                                             August 2015


         <span class="h1">DHCPv6-Shield: Protecting against Rogue DHCPv6 Servers</span>

Abstract

   This document specifies a mechanism for protecting hosts connected to
   a switched network against rogue DHCPv6 servers.  It is based on
   DHCPv6 packet filtering at the layer 2 device at which the packets
   are received.  A similar mechanism has been widely deployed in IPv4
   networks ('DHCP snooping'); hence, it is desirable that similar
   functionality be provided for IPv6 networks.  This document specifies
   a Best Current Practice for the implementation of DHCPv6-Shield.

Status of This Memo

   This memo documents an Internet Best Current Practice.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   BCPs is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7610">http://www.rfc-editor.org/info/rfc7610</a>.

















<span class="grey">Gont, et al.              Best Current Practice                 [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7610.html">RFC 7610</a>                      DHCPv6-Shield                  August 2015</span>


Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Requirements Language ...........................................<a href="#page-3">3</a>
   <a href="#section-3">3</a>. Terminology .....................................................<a href="#page-3">3</a>
   <a href="#section-4">4</a>. DHCPv6-Shield Configuration .....................................<a href="#page-5">5</a>
   <a href="#section-5">5</a>. DHCPv6-Shield Implementation Requirements .......................<a href="#page-5">5</a>
   <a href="#section-6">6</a>. Security Considerations .........................................<a href="#page-7">7</a>
   <a href="#section-7">7</a>. References ......................................................<a href="#page-9">9</a>
      <a href="#section-7.1">7.1</a>. Normative References .......................................<a href="#page-9">9</a>
      <a href="#section-7.2">7.2</a>. Informative References ....................................<a href="#page-10">10</a>
   Acknowledgements ..................................................<a href="#page-11">11</a>
   Authors' Addresses ................................................<a href="#page-12">12</a>























<span class="grey">Gont, et al.              Best Current Practice                 [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7610.html">RFC 7610</a>                      DHCPv6-Shield                  August 2015</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   This document specifies DHCPv6-Shield, a mechanism for protecting
   hosts connected to a switched network against rogue DHCPv6 servers
   [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>].  The basic concept behind DHCPv6-Shield is that a layer 2
   device filters DHCPv6 messages intended for DHCPv6 clients
   (henceforth, "DHCPv6-server messages"), according to a number of
   different criteria.  The most basic filtering criterion is that
   DHCPv6-server messages are discarded by the layer 2 device unless
   they are received on specific ports of the layer 2 device.

   Before the DHCPv6-Shield device is deployed, the administrator
   specifies the layer 2 port(s) on which DHCPv6-server messages are to
   be allowed.  Only those ports to which a DHCPv6 server or relay is to
   be connected should be specified as such.  Once deployed, the
   DHCPv6-Shield device inspects received packets and allows (i.e.,
   passes) DHCPv6-server messages only if they are received on layer 2
   ports that have been explicitly configured for such purpose.

   DHCPv6-Shield is analogous to the Router Advertisement Guard
   (RA-Guard) mechanism [<a href="rfc6104.html" title='"Rogue IPv6 Router Advertisement Problem Statement"'>RFC6104</a>] [<a href="rfc6105.html" title='"IPv6 Router Advertisement Guard"'>RFC6105</a>] [<a href="rfc7113.html" title='"Implementation Advice for IPv6 Router Advertisement Guard (RA-Guard)"'>RFC7113</a>], intended for
   protection against rogue Router Advertisement [<a href="rfc4861.html" title='"Neighbor Discovery for IP version 6 (IPv6)"'>RFC4861</a>] messages.

   We note that DHCPv6-Shield mitigates only DHCPv6-based attacks
   against hosts.  Attack vectors based on other messages meant for
   network configuration (such as ICMPv6 Router Advertisements) are not
   addressed by DHCPv6-Shield itself.  In a similar vein, DHCPv6-Shield
   does not mitigate attacks against DHCPv6 servers (e.g., Denial of
   Service).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Requirements%20Language"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Requirements Language</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Terminology"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Terminology</span>

   DHCPv6-Shield:

      The set of filtering rules specified in this document, meant to
      mitigate attacks that employ DHCPv6-server packets.

   DHCPv6-Shield device:

      A layer 2 device (typically a layer 2 switch) that enforces the
      filtering policy specified in this document.




<span class="grey">Gont, et al.              Best Current Practice                 [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7610.html">RFC 7610</a>                      DHCPv6-Shield                  August 2015</span>


   For the purposes of this document, the terms "IPv6 Extension Header",
   "First Fragment", "IPv6 Header Chain", and "Upper-Layer Header" are
   used as specified in [<a href="rfc7112.html" title='"Implications of Oversized IPv6 Header Chains"'>RFC7112</a>]:

   IPv6 Extension Header:

      IPv6 Extension Headers are defined in <a href="rfc2460.html#section-4">Section 4 of [RFC2460]</a>.  As
      a result of [<a href="rfc7045.html" title='"Transmission and Processing of IPv6 Extension Headers"'>RFC7045</a>], [<a href="#ref-IANA-PROTO" title='"Protocol Numbers"'>IANA-PROTO</a>] provides a list of assigned
      Internet Protocol Numbers and designates which of those protocol
      numbers also represent IPv6 Extension Headers.

   First Fragment:

      An IPv6 fragment with a Fragment Offset equal to 0.

   IPv6 Header Chain:

      The IPv6 Header Chain contains an initial IPv6 header, zero or
      more IPv6 Extension Headers, and optionally, a single Upper-Layer
      Header.  If an Upper-Layer Header is present, it terminates the
      IPv6 Header Chain; otherwise, the "No Next Header" value (Next
      Header = 59) terminates it.

      The first member of the IPv6 Header Chain is always an IPv6
      header.  For a subsequent header to qualify as a member of the
      IPv6 Header Chain, it must be referenced by the "Next Header"
      field of the previous member of the IPv6 Header Chain.  However,
      if a second IPv6 header appears in the IPv6 Header Chain, as is
      the case when IPv6 is tunneled over IPv6, the second IPv6 header
      is considered to be an Upper-Layer Header and terminates the IPv6
      Header Chain.  Likewise, if an Encapsulating Security Payload
      (ESP) header appears in the IPv6 Header Chain, it is considered to
      be an Upper-Layer Header, and it terminates the IPv6 Header Chain.

   Upper-Layer Header:

      In the general case, the Upper-Layer Header is the first member of
      the Header Chain that is neither an IPv6 header nor an IPv6
      Extension Header.  However, if either an ESP header or a second
      IPv6 header occurs in the IPv6 Header Chain, it is considered to
      be an Upper-Layer Header, and it terminates the IPv6 Header Chain.

      Neither the upper-layer payload nor any protocol data following
      the upper-layer payload is considered to be part of the IPv6
      Header Chain.  In a simple example, if the Upper-Layer Header is a
      TCP header, the TCP payload is not part of the IPv6 Header Chain.
      In a more complex example, if the Upper-Layer Header is an ESP




<span class="grey">Gont, et al.              Best Current Practice                 [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7610.html">RFC 7610</a>                      DHCPv6-Shield                  August 2015</span>


      header, neither the payload data nor any of the fields that follow
      the payload data in the ESP header are part of the IPv6 Header
      Chain.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20DHCPv6-Shield%20Configuration"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  DHCPv6-Shield Configuration</span>

   Before being deployed for production, the DHCPv6-Shield device is
   explicitly configured with respect to which layer 2 ports are allowed
   to receive DHCPv6 packets destined to DHCPv6 clients (i.e.,
   DHCPv6-server messages).  Only those layer 2 ports explicitly
   configured for such purpose are allowed to receive DHCPv6 packets to
   pass to DHCPv6 clients.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20DHCPv6-Shield%20Implementation%20Requirements"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  DHCPv6-Shield Implementation Requirements</span>

   Following are the filtering rules that are enforced as part of a
   DHCPv6-Shield implementation on those ports that are not allowed to
   receive DHCPv6 packets to DHCPv6 clients:

   1.  DHCPv6-Shield implementations MUST parse the entire IPv6 Header
       Chain present in the packet to identify whether or not it is a
       DHCPv6 packet meant for a DHCPv6 client (i.e., a DHCPv6-server
       message).

          RATIONALE: DHCPv6-Shield implementations MUST NOT enforce a
          limit on the number of bytes they can inspect (starting from
          the beginning of the IPv6 packet), since this could introduce
          false negatives: DHCP6-server packets received on ports not
          allowed to receive such packets could be allowed simply
          because the DHCPv6-Shield device does not parse the entire
          IPv6 Header Chain present in the packet.

   2.  When parsing the IPv6 Header Chain, if the packet is a First
       Fragment (i.e., a packet containing a Fragment Header with the
       Fragment Offset set to 0) and it fails to contain the entire IPv6
       Header Chain (i.e., all the headers starting from the IPv6 header
       up to, and including, the Upper-Layer Header), DHCPv6-Shield MUST
       drop the packet and ought to log the packet drop event in an
       implementation-specific manner as a security fault.

          RATIONALE: Packets that fail to contain the entire IPv6 Header
          Chain could otherwise be leveraged for circumventing
          DHCPv6-Shield.  [<a href="rfc7112.html" title='"Implications of Oversized IPv6 Header Chains"'>RFC7112</a>] requires that the First Fragment
          (i.e., the fragment with the Fragment Offset set to 0) contain
          the entire IPv6 Header Chain.  [<a href="rfc7112.html" title='"Implications of Oversized IPv6 Header Chains"'>RFC7112</a>] also allows
          intermediate systems such as routers to drop packets that fail
          to comply with this requirement.




<span class="grey">Gont, et al.              Best Current Practice                 [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7610.html">RFC 7610</a>                      DHCPv6-Shield                  August 2015</span>


          NOTE: This rule should only be applied to IPv6 fragments with
          a Fragment Offset of 0 (non-First Fragments can be safely
          passed, since they will never reassemble into a complete
          datagram if they are part of a DHCPv6 packet meant for a
          DHCPv6 client received on a port where such packets are not
          allowed).

   3.  DHCPv6-Shield MUST provide a configuration knob that controls
       whether or not packets with unrecognized Next Header values are
       dropped; this configuration knob MUST default to "drop".  When
       parsing the IPv6 Header Chain, if the packet contains an
       unrecognized Next Header value and the configuration knob is
       configured to "drop", DHCPv6-Shield MUST drop the packet and
       ought to log the packet drop event in an implementation-specific
       manner as a security fault.

          RATIONALE: An unrecognized Next Header value could possibly
          identify an IPv6 Extension Header and thus be leveraged to
          conceal a DHCPv6-server packet (since there is no way for
          DHCPv6-Shield to parse past unrecognized Next Header values
          [<a href="#ref-IPV6-UEH" title='"IPv6 Universal Extension Header"'>IPV6-UEH</a>]).  [<a href="rfc7045.html" title='"Transmission and Processing of IPv6 Extension Headers"'>RFC7045</a>] requires that nodes be configurable
          with respect to whether or not packets with unrecognized
          headers are forwarded and allows the default behavior to be
          that such packets be dropped.

   4.  When parsing the IPv6 Header Chain, if the packet is identified
       to be a DHCPv6 packet meant for a DHCPv6 client, DHCPv6-Shield
       MUST drop the packet and SHOULD log the packet drop event in an
       implementation-specific manner as a security alert.

          RATIONALE: Ultimately, the goal of DHCPv6-Shield is to drop
          DHCPv6 packets destined to DHCPv6 clients (i.e., DHCPv6-server
          messages) that are received on ports that have not been
          explicitly configured to allow the receipt of such packets.

   5.  In all other cases, DHCPv6-Shield MUST pass the packet as usual.

      NOTE: For the purpose of enforcing the DHCPv6-Shield filtering
      policy, an ESP header [<a href="rfc4303.html" title='"IP Encapsulating Security Payload (ESP)"'>RFC4303</a>] should be considered to be an
      "upper-layer protocol" (that is, it should be considered the last
      header in the IPv6 Header Chain).  This means that packets
      employing ESP would be passed by the DHCPv6-Shield device to the
      intended destination.  If the destination host does not have a
      security association with the sender of the aforementioned IPv6
      packet, the packet would be dropped.  Otherwise, if the packet is
      considered valid by the IPsec implementation at the receiving host
      and encapsulates a DHCPv6 message, what to do with such a packet
      is up to the receiving host.



<span class="grey">Gont, et al.              Best Current Practice                 [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7610.html">RFC 7610</a>                      DHCPv6-Shield                  August 2015</span>


   The rules above indicate that if a packet is dropped due to this
   filtering policy, the packet drop event should be logged in an
   implementation-specific manner as a security fault.  It is useful for
   the logging mechanism to include a per-port drop counter dedicated to
   DHCPv6-Shield packet drops.

   In order to protect current end-node IPv6 implementations, Rule #2
   has been defined such that the default is for packets that cannot be
   positively identified as not being DHCPv6-server packets (because the
   packet is a fragment that fails to include the entire IPv6 Header
   Chain) to be dropped.  This means that, at least in theory,
   DHCPv6-Shield could result in false-positive blocking of some
   legitimate (non-DHCPv6-server) packets.  However, as noted in
   [<a href="rfc7112.html" title='"Implications of Oversized IPv6 Header Chains"'>RFC7112</a>], IPv6 packets that fail to include the entire IPv6 Header
   Chain are virtually impossible to police with stateless filters and
   firewalls; hence, they are unlikely to survive in real networks.
   [<a href="rfc7112.html" title='"Implications of Oversized IPv6 Header Chains"'>RFC7112</a>] requires that hosts employing fragmentation include the
   entire IPv6 Header Chain in the First Fragment (the fragment with the
   Fragment Offset set to 0), thus eliminating the aforementioned false
   positives.

   The aforementioned filtering rules implicitly handle the case of
   fragmented packets: if the DHCPv6-Shield device fails to identify the
   upper-layer protocol as a result of the use of fragmentation, the
   corresponding packets would be dropped.

   Finally, we note that IPv6 implementations that allow overlapping
   fragments (i.e., that do not comply with [<a href="rfc5722.html" title='"Handling of Overlapping IPv6 Fragments"'>RFC5722</a>]) might still be
   subject of DHCPv6-based attacks.  However, a recent assessment of
   IPv6 implementations [<a href="#ref-SI6-FRAG" title='"IPv6 NIDS evasion and improvements in IPv6 fragmentation/reassembly"'>SI6-FRAG</a>] with respect to their fragment
   reassembly policy seems to indicate that most current implementations
   comply with [<a href="rfc5722.html" title='"Handling of Overlapping IPv6 Fragments"'>RFC5722</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Security Considerations</span>

   The recommendations in this document represent the ideal behavior of
   a DHCPv6-Shield device.  However, in order to implement DHCPv6-Shield
   on the fast path, it may be necessary to limit the depth into the
   packet that can be scanned before giving up.  In circumstances where
   there is such a limitation, it is recommended that implementations
   drop packets after attempting to find a protocol header up to that
   limit, whatever it is.  Ideally, such devices should be configurable
   with a list of protocol header identifiers so that if new transport
   protocols are standardized after the device is released, they can be
   added to the list of protocol header types that the device
   recognizes.  Since any protocol header that is not a UDP header would
   be passed by the DHCPv6-Shield algorithm, this would allow such
   devices to avoid blocking the use of new transport protocols.  When



<span class="grey">Gont, et al.              Best Current Practice                 [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7610.html">RFC 7610</a>                      DHCPv6-Shield                  August 2015</span>


   an implementation must stop searching for recognizable header types
   in a packet due to such limitations, the device SHOULD be
   configurable to either pass or drop that packet.

   The mechanism specified in this document can be used to mitigate
   DHCPv6-based attacks against hosts.  Attack vectors based on other
   messages meant for network configuration (such as ICMPv6 Router
   Advertisements) are out of the scope of this document.  Additionally,
   the mechanism specified in this document does not mitigate attacks
   against DHCPv6 servers (e.g., Denial of Service).

   If deployed in a layer 2 domain with several cascading switches,
   there will be an ingress port on the host's local switch that will
   need to be enabled for receiving DHCPv6-server messages.  However,
   this local switch will be reliant on the upstream devices filtering
   out rogue DHCPv6-server messages, as the local switch has no way of
   determining which upstream DHCP-server messages are valid.
   Therefore, in order to be effective, DHCPv6-Shield should be deployed
   and enabled on all layer 2 switches of a given layer 2 domain.

   As noted in <a href="#section-5">Section 5</a>, IPv6 implementations that allow overlapping
   fragments (i.e., that do not comply with [<a href="rfc5722.html" title='"Handling of Overlapping IPv6 Fragments"'>RFC5722</a>]) might still be
   subject to DHCPv6-based attacks.  However, most current
   implementations seem to comply with [<a href="rfc5722.html" title='"Handling of Overlapping IPv6 Fragments"'>RFC5722</a>] and hence forbid IPv6
   overlapping fragments.

   We note that if an attacker sends a fragmented DHCPv6 packet on a
   port not allowed to receive such packets, the First Fragment would be
   dropped, and the rest of the fragments would be passed.  This means
   that the victim node would tie memory buffers for the aforementioned
   fragments, which would never reassemble into a complete datagram.  If
   a large number of such packets were sent by an attacker, and the
   victim node failed to implement proper resource management for the
   fragment reassembly buffer, this could lead to a Denial of Service
   (DoS).  However, this does not really introduce a new attack vector,
   since an attacker could always perform the same attack by sending a
   forged fragmented datagram in which at least one of the fragments is
   missing.  [<a href="#ref-CPNI-IPv6" title='"Security Assessment of the Internet Protocol version 6 (IPv6)"'>CPNI-IPv6</a>] discusses some resource management strategies
   that could be implemented for the fragment reassembly buffer.

   Additionally, we note that the security of a site employing
   DHCPv6-Shield could be further improved by deploying [<a href="rfc7513.html" title='"Source Address Validation Improvement (SAVI) Solution for DHCP"'>RFC7513</a>] to
   mitigate IPv6 address spoofing attacks.








<span class="grey">Gont, et al.              Best Current Practice                 [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7610.html">RFC 7610</a>                      DHCPv6-Shield                  August 2015</span>


   Finally, we note that other mechanisms for mitigating attacks based
   on DHCPv6-server messages are available that have different
   deployment considerations.  For example, [<a href="#ref-SECURE-DHCPV6">SECURE-DHCPV6</a>] allows for
   authentication of DHCPv6-server packets if the IPv6 addresses of the
   DHCPv6 servers can be pre-configured at the client nodes.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20References"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Normative%20References"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]    Bradner, S., "Key words for use in RFCs to Indicate
                Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>,
                DOI 10.17487/RFC2119, March 1997,
                &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC2460" name="ref-RFC2460">RFC2460</a>]    Deering, S. and R. Hinden, "Internet Protocol, Version 6
                (IPv6) Specification", <a href="rfc2460.html">RFC 2460</a>, DOI 10.17487/RFC2460,
                December 1998, &lt;<a href="http://www.rfc-editor.org/info/rfc2460">http://www.rfc-editor.org/info/rfc2460</a>&gt;.

   [<a id="ref-RFC3315" name="ref-RFC3315">RFC3315</a>]    Droms, R., Ed., Bound, J., Volz, B., Lemon, T., Perkins,
                C., and M. Carney, "Dynamic Host Configuration Protocol
                for IPv6 (DHCPv6)", <a href="rfc3315.html">RFC 3315</a>, DOI 10.17487/RFC3315, July
                2003, &lt;<a href="http://www.rfc-editor.org/info/rfc3315">http://www.rfc-editor.org/info/rfc3315</a>&gt;.

   [<a id="ref-RFC4303" name="ref-RFC4303">RFC4303</a>]    Kent, S., "IP Encapsulating Security Payload (ESP)", <a href="rfc4303.html">RFC</a>
                <a href="rfc4303.html">4303</a>, DOI 10.17487/RFC4303, December 2005,
                &lt;<a href="http://www.rfc-editor.org/info/rfc4303">http://www.rfc-editor.org/info/rfc4303</a>&gt;.

   [<a id="ref-RFC4861" name="ref-RFC4861">RFC4861</a>]    Narten, T., Nordmark, E., Simpson, W., and H. Soliman,
                "Neighbor Discovery for IP version 6 (IPv6)", <a href="rfc4861.html">RFC 4861</a>,
                DOI 10.17487/RFC4861, September 2007,
                &lt;<a href="http://www.rfc-editor.org/info/rfc4861">http://www.rfc-editor.org/info/rfc4861</a>&gt;.

   [<a id="ref-RFC5722" name="ref-RFC5722">RFC5722</a>]    Krishnan, S., "Handling of Overlapping IPv6 Fragments",
                <a href="rfc5722.html">RFC 5722</a>, DOI 10.17487/RFC5722, December 2009,
                &lt;<a href="http://www.rfc-editor.org/info/rfc5722">http://www.rfc-editor.org/info/rfc5722</a>&gt;.

   [<a id="ref-RFC7045" name="ref-RFC7045">RFC7045</a>]    Carpenter, B. and S. Jiang, "Transmission and Processing
                of IPv6 Extension Headers", <a href="rfc7045.html">RFC 7045</a>,
                DOI 10.17487/RFC7045, December 2013,
                &lt;<a href="http://www.rfc-editor.org/info/rfc7045">http://www.rfc-editor.org/info/rfc7045</a>&gt;.

   [<a id="ref-RFC7112" name="ref-RFC7112">RFC7112</a>]    Gont, F., Manral, V., and R. Bonica, "Implications of
                Oversized IPv6 Header Chains", <a href="rfc7112.html">RFC 7112</a>,
                DOI 10.17487/RFC7112, January 2014,
                &lt;<a href="http://www.rfc-editor.org/info/rfc7112">http://www.rfc-editor.org/info/rfc7112</a>&gt;.





<span class="grey">Gont, et al.              Best Current Practice                 [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7610.html">RFC 7610</a>                      DHCPv6-Shield                  August 2015</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Informative%20References"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-CPNI-IPv6" name="ref-CPNI-IPv6">CPNI-IPv6</a>]  Gont, F., "Security Assessment of the Internet Protocol
                version 6 (IPv6)", UK Centre for the Protection of
                National Infrastructure, (available on request).

   [<a id="ref-IANA-PROTO" name="ref-IANA-PROTO">IANA-PROTO</a>] IANA, "Protocol Numbers",
                &lt;<a href="http://www.iana.org/assignments/protocol-numbers">http://www.iana.org/assignments/protocol-numbers</a>&gt;.

   [<a id="ref-IPV6-UEH" name="ref-IPV6-UEH">IPV6-UEH</a>]   Gont, F., Liu, W., Krishnan, S., and H. Pfeifer, "IPv6
                Universal Extension Header", Work in Progress,
                <a href="https://tools.ietf.org/html/draft-gont-6man-rfc6564bis-00">draft-gont-6man-rfc6564bis-00</a>, April 2014.

   [<a id="ref-RFC6104" name="ref-RFC6104">RFC6104</a>]    Chown, T. and S. Venaas, "Rogue IPv6 Router
                Advertisement Problem Statement", <a href="rfc6104.html">RFC 6104</a>,
                DOI 10.17487/RFC6104, February 2011,
                &lt;<a href="http://www.rfc-editor.org/info/rfc6104">http://www.rfc-editor.org/info/rfc6104</a>&gt;.

   [<a id="ref-RFC6105" name="ref-RFC6105">RFC6105</a>]    Levy-Abegnoli, E., Van de Velde, G., Popoviciu, C., and
                J.  Mohacsi, "IPv6 Router Advertisement Guard", <a href="rfc6105.html">RFC</a>
                <a href="rfc6105.html">6105</a>, DOI 10.17487/RFC6105, February 2011,
                &lt;<a href="http://www.rfc-editor.org/info/rfc6105">http://www.rfc-editor.org/info/rfc6105</a>&gt;.

   [<a id="ref-RFC7113" name="ref-RFC7113">RFC7113</a>]    Gont, F., "Implementation Advice for IPv6 Router
                Advertisement Guard (RA-Guard)", <a href="rfc7113.html">RFC 7113</a>,
                DOI 10.17487/RFC7113, February 2014,
                &lt;<a href="http://www.rfc-editor.org/info/rfc7113">http://www.rfc-editor.org/info/rfc7113</a>&gt;.

   [<a id="ref-RFC7513" name="ref-RFC7513">RFC7513</a>]    Bi, J., Wu, J., Yao, G., and F. Baker, "Source Address
                Validation Improvement (SAVI) Solution for DHCP", <a href="rfc7513.html">RFC</a>
                <a href="rfc7513.html">7513</a>, DOI 10.17487/RFC7513, May 2015,
                &lt;<a href="http://www.rfc-editor.org/info/rfc7513">http://www.rfc-editor.org/info/rfc7513</a>&gt;.

   [<a id="ref-SECURE-DHCPV6" name="ref-SECURE-DHCPV6">SECURE-DHCPV6</a>]
                Jiang, S. and S. Shen, <a href="https://www.google.com/search?sitesearch=tools.ietf.org%2Fhtml%2F&amp;q=inurl:draft-+%22Secure+DHCPv6+Using+CGAs%22" style="text-decoration: none">"Secure DHCPv6 Using CGAs"</a>, Work
                in Progress, <a href="https://tools.ietf.org/html/draft-ietf-dhc-secure-dhcpv6-07">draft-ietf-dhc-secure-dhcpv6-07</a>, September
                2012.

   [<a id="ref-SI6-FRAG" name="ref-SI6-FRAG">SI6-FRAG</a>]   SI6 Networks, "IPv6 NIDS evasion and improvements in
                IPv6 fragmentation/reassembly", 2012,
                &lt;<a href="http://blog.si6networks.com/2012/02/ipv6-nids-evasion-and-improvements-in.html">http://blog.si6networks.com/2012/02/</a>
                <a href="http://blog.si6networks.com/2012/02/ipv6-nids-evasion-and-improvements-in.html">ipv6-nids-evasion-and-improvements-in.html</a>&gt;.









<span class="grey">Gont, et al.              Best Current Practice                [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7610.html">RFC 7610</a>                      DHCPv6-Shield                  August 2015</span>


Acknowledgements

   The authors would like to thank Mike Heard, who provided detailed
   feedback on earlier draft versions of this document and helped a lot
   in producing a technically sound document throughout the whole
   publication process.

   The authors would like to thank (in alphabetical order) Ben Campbell,
   Jean-Michel Combes, Sheng Jiang, Ted Lemon, Pete Resnick, Carsten
   Schmoll, Juergen Schoenwaelder, Robert Sleigh, Donald Smith, Mark
   Smith, Hannes Tschofenig, Eric Vyncke, and Qin Wu for providing
   valuable comments on earlier draft versions of this document.

   Part of <a href="#section-3">Section 3</a> of this document was borrowed from [<a href="rfc7112.html" title='"Implications of Oversized IPv6 Header Chains"'>RFC7112</a>],
   authored by Fernando Gont, Vishwas Manral, and Ron Bonica.

   This document is heavily based on [<a href="rfc7113.html" title='"Implementation Advice for IPv6 Router Advertisement Guard (RA-Guard)"'>RFC7113</a>], authored by Fernando
   Gont.  Thus, the authors would like to thank the following
   individuals for providing valuable comments on [<a href="rfc7113.html" title='"Implementation Advice for IPv6 Router Advertisement Guard (RA-Guard)"'>RFC7113</a>]: Ran
   Atkinson, Karl Auer, Robert Downie, Washam Fan, David Farmer, Mike
   Heard, Marc Heuse, Nick Hilliard, Ray Hunter, Joel Jaeggli, Simon
   Perreault, Arturo Servin, Gunter Van de Velde, James Woodyatt, and
   Bjoern A. Zeeb.

   The authors would like to thank Joel Jaeggli for his advice and
   guidance throughout the IETF process.

   Fernando Gont would like to thank Diego Armando Maradona for his
   magic and inspiration.






















<span class="grey">Gont, et al.              Best Current Practice                [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7610.html">RFC 7610</a>                      DHCPv6-Shield                  August 2015</span>


Authors' Addresses

   Fernando Gont
   SI6 Networks / UTN-FRH
   Evaristo Carriego 2644
   Haedo, Provincia de Buenos Aires  1706
   Argentina

   Phone: +54 11 4650 8472
   Email: fgont@si6networks.com
   URI:   <a href="http://www.si6networks.com/">http://www.si6networks.com</a>


   Will (Shucheng) Liu
   Huawei Technologies
   Bantian, Longgang District
   Shenzhen  518129
   China

   Email: liushucheng@huawei.com


   Gunter Van de Velde
   Alcatel-Lucent
   Copernicuslaan 50
   Antwerp, Antwerp  2018
   Belgium

   Phone: +32 476 476 022
   Email: gunter.van_de_velde@alcatel-lucent.com





















Gont, et al.              Best Current Practice                [Page 12]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.119, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7610 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 23 Aug 2016 18:34:44 GMT --></html>