<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6668 by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 07 Jun 2014 20:18:39 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.107" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:6668" name="DC.Identifier"/>
<meta content="This memo defines algorithm names and parameters for use in some of\nthe SHA-2 family of secure hash algorithms for data integrity\nverification in the Secure Shell (SSH) protocol. It also updates RFC\n4253 by specifying a new RECOMMENDED data integrity algorithm.\n[STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="Mark Baushke &lt;mdb@juniper.net&gt;" name="DC.Creator"/>
<meta content="July, 2012" name="DC.Date.Issued"/>
<meta content="SHA-2 Data Integrity Verification for the Secure Shell (SSH) Transport Layer Protocol" name="DC.Title"/>

    <link href="http://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="http://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6668 - SHA-2 Data Integrity Verification for the Secure Shell (SSH) Transport Layer Protocol</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc6668.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc6668" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-dbider-sha2-mac-for-ssh" title="draft-dbider-sha2-mac-for-ssh">draft-dbider-sha2...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6668" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc6668" title="Side-by-side diff">Diff2</a>]                 </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                          D. Bider
Request for Comments: 6668                               Bitvise Limited
Updates: <a href="rfc4253.html">4253</a>                                                 M. Baushke
Category: Standards Track                         Juniper Networks, Inc.
ISSN: 2070-1721                                                July 2012


                 <span class="h1">SHA-2 Data Integrity Verification for</span>
            <span class="h1">the Secure Shell (SSH) Transport Layer Protocol</span>

Abstract

   This memo defines algorithm names and parameters for use in some of
   the SHA-2 family of secure hash algorithms for data integrity
   verification in the Secure Shell (SSH) protocol.  It also updates <a href="rfc4253.html">RFC</a>
   <a href="rfc4253.html">4253</a> by specifying a new RECOMMENDED data integrity algorithm.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6668">http://www.rfc-editor.org/info/rfc6668</a>.

Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in <a href="#section-4">Section 4</a>.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.






<span class="grey">Bider &amp; Baushke              Standards Track                    [Page 1]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6668.html">RFC 6668</a>              Sha2-Transport Layer Protocol            July 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Overview%20and%20Rationale"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Overview and Rationale</span>

   The Secure Shell (SSH) [<a href="rfc4251.html" title='"The Secure Shell (SSH) Protocol Architecture"'>RFC4251</a>] is a very common protocol for secure
   remote login on the Internet.  Currently, SSH defines data integrity
   verification using SHA-1 and MD5 algorithms [<a href="rfc4253.html" title='"The Secure Shell (SSH) Transport Layer Protocol"'>RFC4253</a>].  Due to recent
   security concerns with these two algorithms ([<a href="rfc6194.html" title='"Security Considerations for the SHA-0 and SHA-1 Message-Digest Algorithms"'>RFC6194</a>] and [<a href="rfc6151.html" title='"Updated Security Considerations for the MD5 Message-Digest and the HMAC-MD5 Algorithms"'>RFC6151</a>],
   respectively), implementors and users request support for data
   integrity verification using some of the SHA-2 family of secure hash
   algorithms.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Requirements%20Terminology"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Requirements Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Data%20Integrity%20Algorithms"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Data Integrity Algorithms</span>

   This memo adopts the style and conventions of [<a href="rfc4253.html" title='"The Secure Shell (SSH) Transport Layer Protocol"'>RFC4253</a>] in specifying
   how the use of new data integrity algorithms are indicated in SSH.

   The following new data integrity algorithms are defined:

   hmac-sha2-256     RECOMMENDED   HMAC-SHA2-256
                                   (digest length = 32 bytes,
                                    key length    = 32 bytes)

   hmac-sha2-512     OPTIONAL      HMAC-SHA2-512
                                   (digest length = 64 bytes,
                                    key length    = 64 bytes)

                          Figure 1

   The Hashed Message Authentication Code (HMAC) mechanism was
   originally defined in [<a href="rfc2104.html" title='"HMAC: Keyed- Hashing for Message Authentication"'>RFC2104</a>] and has been updated in [<a href="rfc6151.html" title='"Updated Security Considerations for the MD5 Message-Digest and the HMAC-MD5 Algorithms"'>RFC6151</a>].

   The SHA-2 family of secure hash algorithms is defined in
   [<a href="#ref-FIPS-180-3">FIPS-180-3</a>].

   Sample code for the SHA-based HMAC algorithms are available in
   [<a href="rfc6234.html" title='"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"'>RFC6234</a>].  The variants, HMAC-SHA2-224 and HMAC-SHA2-384 algorithms,
   were considered but not added to this list as they have the same
   computational requirements of HMAC-SHA2-256 and HMAC-SHA2-512,
   respectively, and do not seem to be much used in practice.







<span class="grey">Bider &amp; Baushke              Standards Track                    [Page 2]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6668.html">RFC 6668</a>              Sha2-Transport Layer Protocol            July 2012</span>


   Test vectors for use of HMAC with SHA-2 are provided in [<a href="rfc4231.html" title='"Identifiers and Test Vectors for HMAC- SHA-224, HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512"'>RFC4231</a>].
   Users, implementors, and administrators may choose to put these new
   MACs into the proposal ahead of the REQUIRED hmac-sha1 algorithm
   defined in [<a href="rfc4253.html" title='"The Secure Shell (SSH) Transport Layer Protocol"'>RFC4253</a>] so that they are negotiated first.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  IANA Considerations</span>

   This document augments the MAC Algorithm Names in [<a href="rfc4253.html" title='"The Secure Shell (SSH) Transport Layer Protocol"'>RFC4253</a>] and
   [<a href="rfc4250.html" title='"The Secure Shell (SSH) Protocol Assigned Numbers"'>RFC4250</a>].

   IANA has updated the "Secure Shell (SSH) Protocol Parameters"
   registry with the following entries:

   MAC Algorithm Name      Reference       Note
   hmac-sha2-256           <a href="rfc6668.html#section-2">RFC 6668        Section 2</a>
   hmac-sha2-512           <a href="rfc6668.html#section-2">RFC 6668        Section 2</a>

                        Figure 2

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Security%20Considerations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Security Considerations</span>

   The security considerations of <a href="rfc4253.html">RFC 4253</a> [<a href="rfc4253.html" title='"The Secure Shell (SSH) Transport Layer Protocol"'>RFC4253</a>] apply to this
   document.

   The National Institute of Standards and Technology (NIST)
   publications: NIST Special Publication (SP) 800-107 [<a href="#ref-800-107" title='"Recommendation for Applications Using Approved Hash Algorithms"'>800-107</a>] and
   NIST SP 800-131A [<a href="#ref-800-131A" title='"Transitions: Recommendation for the Transitioning of the Use of Cryptographic Algorithms and Key Lengths"'>800-131A</a>] suggest that HMAC-SHA1 and HMAC-SHA2-256
   have a security strength of 128 bits and 256 bits, respectively,
   which are considered acceptable key lengths.

   Many users seem to be interested in the perceived safety of using the
   SHA2-based algorithms for hashing.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20References"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Normative%20References"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Normative References</span>

   [<a id="ref-FIPS-180-3" name="ref-FIPS-180-3">FIPS-180-3</a>]
              National Institute of Standards and Technology (NIST),
              United States of America, "Secure Hash Standard (SHS)",
              FIPS PUB 180-3, October 2008, &lt;<a href="http://csrc.nist.gov/publications/fips/fips180-3/fips180-3_final.pdf">http://csrc.nist.gov/</a>
              <a href="http://csrc.nist.gov/publications/fips/fips180-3/fips180-3_final.pdf">publications/fips/fips180-3/fips180-3_final.pdf</a>&gt;.

   [<a id="ref-RFC2104" name="ref-RFC2104">RFC2104</a>]  Krawczyk, H., Bellare, M., and R. Canetti, "HMAC: Keyed-
              Hashing for Message Authentication", <a href="rfc2104.html">RFC 2104</a>, February
              1997.





<span class="grey">Bider &amp; Baushke              Standards Track                    [Page 3]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6668.html">RFC 6668</a>              Sha2-Transport Layer Protocol            July 2012</span>


   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC4231" name="ref-RFC4231">RFC4231</a>]  Nystrom, M., "Identifiers and Test Vectors for HMAC-
              SHA-224, HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512",
              <a href="rfc4231.html">RFC 4231</a>, December 2005.

   [<a id="ref-RFC4253" name="ref-RFC4253">RFC4253</a>]  Ylonen, T. and C. Lonvick, Ed., "The Secure Shell (SSH)
              Transport Layer Protocol", <a href="rfc4253.html">RFC 4253</a>, January 2006.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Informative%20References"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Informative References</span>

   [<a id="ref-800-107" name="ref-800-107">800-107</a>]  National Institute of Standards and Technology (NIST),
              "Recommendation for Applications Using Approved Hash
              Algorithms", NIST Special Publication 800-107, February
              2009, &lt;<a href="http://csrc.nist.gov/publications/nistpubs/800-107/NIST-SP-800-107.pdf">http://csrc.nist.gov/publications/</a>
              <a href="http://csrc.nist.gov/publications/nistpubs/800-107/NIST-SP-800-107.pdf">nistpubs/800-107/NIST-SP-800-107.pdf</a>&gt;.

   [<a id="ref-800-131A" name="ref-800-131A">800-131A</a>] National Institute of Standards and Technology (NIST),
              "Transitions: Recommendation for the Transitioning of the
              Use of Cryptographic Algorithms and Key Lengths", DRAFT
              NIST Special Publication 800-131A, January 2011,
              &lt;<a href="http://csrc.nist.gov/publications/nistpubs/800-131A/sp800-131A.pdf">http://csrc.nist.gov/publications/nistpubs/800-131A/</a>
              <a href="http://csrc.nist.gov/publications/nistpubs/800-131A/sp800-131A.pdf">sp800-131A.pdf</a>&gt;.

   [<a id="ref-RFC4250" name="ref-RFC4250">RFC4250</a>]  Lehtinen, S. and C. Lonvick, Ed., "The Secure Shell (SSH)
              Protocol Assigned Numbers", <a href="rfc4250.html">RFC 4250</a>, January 2006.

   [<a id="ref-RFC4251" name="ref-RFC4251">RFC4251</a>]  Ylonen, T. and C. Lonvick, Ed., "The Secure Shell (SSH)
              Protocol Architecture", <a href="rfc4251.html">RFC 4251</a>, January 2006.

   [<a id="ref-RFC6151" name="ref-RFC6151">RFC6151</a>]  Turner, S. and L. Chen, "Updated Security Considerations
              for the MD5 Message-Digest and the HMAC-MD5 Algorithms",
              <a href="rfc6151.html">RFC 6151</a>, March 2011.

   [<a id="ref-RFC6194" name="ref-RFC6194">RFC6194</a>]  Polk, T., Chen, L., Turner, S., and P. Hoffman, "Security
              Considerations for the SHA-0 and SHA-1 Message-Digest
              Algorithms", <a href="rfc6194.html">RFC 6194</a>, March 2011.

   [<a id="ref-RFC6234" name="ref-RFC6234">RFC6234</a>]  Eastlake 3rd, D. and T. Hansen, "US Secure Hash Algorithms
              (SHA and SHA-based HMAC and HKDF)", <a href="rfc6234.html">RFC 6234</a>, May 2011.










<span class="grey">Bider &amp; Baushke              Standards Track                    [Page 4]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6668.html">RFC 6668</a>              Sha2-Transport Layer Protocol            July 2012</span>


Authors' Addresses

   Denis Bider
   Bitvise Limited
   Suites 41/42, Victoria House
   26 Main Street
   GI

   Phone: +1 869 762 1410
   EMail: ietf-ssh2@denisbider.com
   URI:   <a href="http://www.bitvise.com/">http://www.bitvise.com/</a>


   Mark D. Baushke
   Juniper Networks, Inc.
   1194 N Mathilda Av
   Sunnyvale, CA 94089-1206
   US

   Phone: +1 408 745 2952
   EMail: mdb@juniper.net
   URI:   <a href="http://www.juniper.net/">http://www.juniper.net/</a>





























Bider &amp; Baushke              Standards Track                    [Page 5]

</pre><br/>
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.107, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>



</body><!-- Mirrored from tools.ietf.org/html/rfc6668 by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 07 Jun 2014 20:18:39 GMT --></html>