<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6142 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 23 Aug 2016 18:39:29 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.119" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:6142" name="DC.Identifier"/>
<meta content="This RFC provides a framework for transporting ANSI C12.22/IEEE
1703/MC12.22 Advanced Metering Infrastructure (AMI) Application Layer
Messages on an IP network.  This document is not an official
submission on behalf of the ANSI C12.19 and C12.22 working groups. It
was created by participants in those groups, building on knowledge of
several proprietary C12.22- over-IP implementations. The content of
this document is an expression of a consensus aggregation of those
implementations. This document is not an Internet Standards Track
specification; it is published for informational purposes." name="DC.Description.Abstract"/>
<meta content="Moise, Avygdor" name="DC.Creator"/>
<meta content="Brodkin, Jonathan" name="DC.Creator"/>
<meta content="March, 2011" name="DC.Date.Issued"/>
<meta content="ANSI C12.22, IEEE 1703, and MC12.22 Transport Over IP" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6142 - ANSI C12.22, IEEE 1703, and MC12.22 Transport Over IP</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6142.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6142" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-c1222-transport-over-ip" title="draft-c1222-transport-over-ip">draft-c1222-trans...</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6142" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6142" title="Side-by-side diff">Diff2</a>]                 </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                          A. Moise
Request for Comments: 6142                                    J. Brodkin
Category: Informational                              Future DOS R&amp;D Inc.
ISSN: 2070-1721                                               March 2011


         <span class="h1">ANSI C12.22, IEEE 1703, and MC12.22 Transport Over IP</span>

Abstract

   This RFC provides a framework for transporting ANSI C12.22/IEEE
   1703/MC12.22 Advanced Metering Infrastructure (AMI) Application Layer
   Messages on an IP network.

   This document is not an official submission on behalf of the ANSI
   C12.19 and C12.22 working groups.  It was created by participants in
   those groups, building on knowledge of several proprietary C12.22-
   over-IP implementations.  The content of this document is an
   expression of a consensus aggregation of those implementations.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">SectionÂ 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6142">http://www.rfc-editor.org/info/rfc6142</a>.

Copyright Notice

   Copyright (c) 2011 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in <a href="#section-4">Section 4</a>.e of



<span class="grey">Moise &amp; Brodkin               Informational                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Terminology .....................................................<a href="#page-3">3</a>
   <a href="#section-3">3</a>. Definitions .....................................................<a href="#page-3">3</a>
   <a href="#section-4">4</a>. The C12.22 IP Network Segment ...................................<a href="#page-6">6</a>
      <a href="#section-4.1">4.1</a>. Composition of a C12.22 IP Network Segment .................<a href="#page-6">6</a>
      <a href="#section-4.2">4.2</a>. Native IP Address ..........................................<a href="#page-7">7</a>
      <a href="#section-4.3">4.3</a>. Encoding of Native IP Addresses ............................<a href="#page-7">7</a>
      <a href="#section-4.4">4.4</a>. Standardized Port Numbers ..................................<a href="#page-9">9</a>
      <a href="#section-4.5">4.5</a>. Use of UDP Source Port 0 ...................................<a href="#page-9">9</a>
      <a href="#section-4.6">4.6</a>. IP Multicast ..............................................<a href="#page-10">10</a>
      <a href="#section-4.7">4.7</a>. IP Broadcast ..............................................<a href="#page-12">12</a>
      <a href="#section-4.8">4.8</a>. Encoding of Multicast and Broadcast Addresses .............<a href="#page-12">12</a>
   <a href="#section-5">5</a>. IP Message Transport ...........................................<a href="#page-14">14</a>
      <a href="#section-5.1">5.1</a>. C12.22 Connection Types and TCP/UDP Transport Modes .......<a href="#page-14">14</a>
      <a href="#section-5.2">5.2</a>. IP Message Transport Details ..............................<a href="#page-15">15</a>
           <a href="#section-5.2.1">5.2.1</a>. TCP and UDP Port Use ...............................<a href="#page-15">15</a>
           <a href="#section-5.2.2">5.2.2</a>. Active-OPEN UDP Mode (CL=1, CL Accept=0) ...........<a href="#page-16">16</a>
           <a href="#section-5.2.3">5.2.3</a>. Passive-OPEN UDP Mode (CL=1, CL Accept=1) ..........<a href="#page-17">17</a>
           <a href="#section-5.2.4">5.2.4</a>. Active-OPEN TCP Mode (CO=1, CO Accept=0) ...........<a href="#page-17">17</a>
           <a href="#section-5.2.5">5.2.5</a>. Passive-OPEN TCP Mode (CO=1, CO Accept=1) ..........<a href="#page-18">18</a>
           <a href="#section-5.2.6">5.2.6</a>. TCP and C12.22 Message Directionality ..............<a href="#page-18">18</a>
      <a href="#section-5.3">5.3</a>. Using IP Broadcast/Multicast ..............................<a href="#page-19">19</a>
      <a href="#section-5.4">5.4</a>. Transport Protocol Decisions ..............................<a href="#page-20">20</a>
           <a href="#section-5.4.1">5.4.1</a>. Unicast Versus Multicast Versus Broadcast ..........<a href="#page-20">20</a>
           <a href="#section-5.4.2">5.4.2</a>. Sending Large C12.22 APDUs Using UDP ...............<a href="#page-20">20</a>
           <a href="#section-5.4.3">5.4.3</a>. Choice of Protocol for C12.22 Response APDUs .......<a href="#page-20">20</a>
      <a href="#section-5.5">5.5</a>. Quality of Service ........................................<a href="#page-20">20</a>
      <a href="#section-5.6">5.6</a>. Congestion Control ........................................<a href="#page-21">21</a>
   <a href="#section-6">6</a>. Security Considerations ........................................<a href="#page-21">21</a>
   <a href="#section-7">7</a>. IANA Considerations ............................................<a href="#page-23">23</a>
   <a href="#section-8">8</a>. Acknowledgments ................................................<a href="#page-23">23</a>
   <a href="#section-9">9</a>. References .....................................................<a href="#page-23">23</a>
      <a href="#section-9.1">9.1</a>. Normative References ......................................<a href="#page-23">23</a>
      <a href="#section-9.2">9.2</a>. Informative References ....................................<a href="#page-25">25</a>












<span class="grey">Moise &amp; Brodkin               Informational                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The ANSI C12.22 standard [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>] provides a set of application layer
   messaging services that are applicable for the enterprise and End
   Device components of an Advanced Metering Infrastructure (AMI) for
   the Smart Grid.  The messaging services are tailored for, but not
   limited to, the exchange of the Data Table Elements defined and
   co-published in ANSI C12.19 [<a href="#ref-2" title='"Utility Industry End Device Data Tables"'>2</a>], IEEE P1377 [<a href="#ref-3" title='"Draft Standard for Utility Industry Metering Communication Protocol Application Layer (End Device Data Tables)"'>3</a>], and MC12.19 [<a href="#ref-23" title='"Specification for Utility Industry Metering Communication Protocol Application Layer (End Device Data Tables)"'>23</a>].
   These standards were developed jointly by ANSI (ANSI C12.22 and ANSI
   C12.19), IEEE (IEEE 1377 and IEEE 1703), and Measurement Canada
   (MC12.19 and MC12.22).

   ANSI C12.22, which is an application level messaging protocol, may be
   transported over any underlying transport network.  This RFC defines
   the requirements governing the transmission of ANSI C12.22 Messages
   via the TCP and UDP transports in IP networks (whereby the OSI
   Session, Presentation, and Application Layers of ANSI C12.22 are
   collapsed into a single Application Layer).

   Specifically, this RFC applies to the operational details of
   <a href="#section-5">Section 5</a>, "C12.22 Node to C12.22 Network Segment Details", of ANSI
   C12.22, and covers the mapping, encoding, and interpreting of ANSI
   C12.19 Device Network Table Elements and Native Addresses for use on
   IP networks.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="#ref-4" title='"Key words for use in RFCs to Indicate Requirement Levels"'>4</a>].

   Throughout this document, we use terms like "ANSI C12.22" or "ANSI
   C12.19", as in "C12.22 Relay" or "ANSI C12.19 Device".  These terms
   are interchangeable with the terms "IEEE 1703 Relay" and "IEEE 1377
   Device", respectively.  However, the recent versions of the Utility
   End Device communication standards were developed under the auspices
   of ANSI C12 SC17 WG1 and ANSI C12 SC17 WG2.  For that reason, the
   terminology used in this document expands on the ANSI C12.22-2008 [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>]
   and ANSI C12.19-2008 [<a href="#ref-2" title='"Utility Industry End Device Data Tables"'>2</a>] definitions as revised by IEEE 1703-2010 [<a href="#ref-5" title='"Standard for Local Area Network/Wide Area Network (LAN/ WAN) Node Communication Protocol to Complement the Utility Industry End Device Data Tables"'>5</a>]
   and IEEE 1377-2010 [<a href="#ref-3" title='"Draft Standard for Utility Industry Metering Communication Protocol Application Layer (End Device Data Tables)"'>3</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Definitions"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Definitions</span>

   This specification uses a number of terms to refer to the roles
   played by participants (actors) in, and objects of, the ANSI C12.22
   [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>], IEEE 1703 [<a href="#ref-5" title='"Standard for Local Area Network/Wide Area Network (LAN/ WAN) Node Communication Protocol to Complement the Utility Industry End Device Data Tables"'>5</a>], and MC12.22 [<a href="#ref-24" title='"Specification for Local Area Network/Wide Area Network (LAN/WAN) Node Communication Protocol to Complement the Utility Industry End Device Data Tables"'>24</a>] protocol.  Any terms prefixed by
   "C12.22" or "C12.19" that are not defined in this document can be
   resolved in [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>], [<a href="#ref-5" title='"Standard for Local Area Network/Wide Area Network (LAN/ WAN) Node Communication Protocol to Complement the Utility Industry End Device Data Tables"'>5</a>], [<a href="#ref-24" title='"Specification for Local Area Network/Wide Area Network (LAN/WAN) Node Communication Protocol to Complement the Utility Industry End Device Data Tables"'>24</a>] or in [<a href="#ref-2" title='"Utility Industry End Device Data Tables"'>2</a>], [<a href="#ref-3" title='"Draft Standard for Utility Industry Metering Communication Protocol Application Layer (End Device Data Tables)"'>3</a>], [<a href="#ref-23" title='"Specification for Utility Industry Metering Communication Protocol Application Layer (End Device Data Tables)"'>23</a>].



<span class="grey">Moise &amp; Brodkin               Informational                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


   ACSE

      Association Control Service Element.  In the context of this
      specification and of [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>], ACSEs are encoded per ISO/IEC 10035-1
      [<a href="#ref-6" title='"Information Technology-Open Systems Interconnection- Connectionless Protocol for the Association Control Service Element: Protocol Specification"'>6</a>] using the ASN.1 Basic Encoding Rules (BER) [<a href="#ref-7" title='"Information Technology-ASN.1 Encoding Rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"'>7</a>].

   Active-OPEN UDP

      Active-OPEN UDP is a state used by a local C12.22 IP Node to
      expect and receive incoming C12.22 Messages that it solicited from
      a foreign C12.22 IP Node using UDP.  The local C12.22 IP Node MAY
      exit the Active-OPEN UDP state when it has received all of the
      expected C12.22 Messages or a C12.22 Message timeout has occurred.
      The local C12.22 IP Node receives all C12.22 Response Messages
      solicited from the foreign C12.22 IP Node that arrive at the local
      port number that matches the source port number used to solicit
      the C12.22 Messages from the foreign C12.22 IP Node.

   Active-OPEN TCP

      Active-OPEN TCP is a state used by a local C12.22 IP Node to
      establish a TCP connection with a fully specified foreign C12.22
      IP Node using TCP and the foreign C12.22 IP Node's registered
      Native IP Address.  The Active-OPEN TCP state is identical to a
      local "Active-OPEN" as defined in [<a href="#ref-9" title='"Transmission Control Protocol"'>9</a>].

   APDU

      Application Protocol Data Unit.  In the context of the ANSI C12.22
      Application, it is an ACSE C12.22 Message.

   ACSE APDU

      ACSE Application Protocol Data Unit; same as APDU.

   ApTitle

      An ANSI C12.22 Application-process Title.  An ApTitle is a name
      for a system-independent application activity that exposes
      application services to the application agent, e.g., a set of
      application service elements that together perform all or part of
      the communication aspects of an application process.  An ApTitle
      is encoded as a unique registered (as per [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>]) object identifier.

   C12.22 IP Node

      A C12.22 Node that is located on a C12.22 IP Network Segment and
      communicates using the Internet Protocol.



<span class="grey">Moise &amp; Brodkin               Informational                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


   C12.22 IP Network Segment

      A collection of all C12.22 IP Nodes that implement the IP-based
      protocols, as defined in this specification, and can communicate
      with each other using IP routers, switches, and bridges and
      without the use of a C12.22 Relay.

   C12.22 IP Relay

      A C12.22 IP Node that performs the functions of a C12.22 Relay.
      A C12.22 IP Relay acts as a bridge between a C12.22 IP Network
      Segment and an adjacent, C12.22 Network Segment.

   C12.22 Message

      An ACSE APDU that is fully assembled, or a segment of a C12.22
      Request Message, or a segment of a C12.22 Response Message.  The
      C12.22 Message described in this specification MUST be encoded
      using [<a href="#ref-7" title='"Information Technology-ASN.1 Encoding Rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"'>7</a>].

   C12.22 Request Message

      A fully assembled C12.22 APDU that contains an ACSE user-
      information element, which includes one or more EPSEM Service
      Requests.

   C12.22 Response Message

      A fully assembled C12.22 APDU that contains an ACSE user-
      information element, which includes one or more EPSEM service
      responses.

   Connection

      A logical and physical binding between two or more users of a
      service [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>].

   EPSEM

      Extended Protocol Specification for Electronic Metering.  EPSEM
      defines structures and services used to encode multiple requests
      and responses for use by devices such as gas, water, electricity,
      and related electronic modules or appliances.

   Initiating C12.22 IP Node

      A role of a C12.22 IP Node in which it initiates the transmission
      of a C12.22 Request Message.



<span class="grey">Moise &amp; Brodkin               Informational                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


   Native Address

      The term "Native Address" refers to the transport address that may
      be used to reach a C12.22 Node on its C12.22 Network Segment [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>].
      In this specification, the Native Address refers to the Native IP
      Address.

   Passive-OPEN UDP

      Passive-OPEN UDP is a state used by a local C12.22 IP Node to
      expect and receive incoming C12.22 Messages from any foreign
      C12.22 IP Node using UDP.  When the Passive-OPEN UDP state is
      active, the local C12.22 IP Node accepts all C12.22 Messages that
      arrive at the local port number that was registered by the local
      C12.22 IP Node.

   Passive-OPEN TCP

      Passive-OPEN TCP is a state used by a local C12.22 IP Node that
      wants to establish a TCP connection with an unspecified foreign
      C12.22 IP Node using TCP.  In this case, any foreign C12.22 IP
      Node MAY connect to the local C12.22 IP Node as long as the local
      port matches the port used by the foreign C12.22 IP Node.  The
      Passive-OPEN TCP state is identical to "local passive OPEN"
      defined in [<a href="#ref-9" title='"Transmission Control Protocol"'>9</a>].

   Responding C12.22 IP Node

      A role of a C12.22 IP Node in which it responds to the reception
      of a C12.22 Request Message.

   Target C12.22 IP Node

      The C12.22 IP Node that is the destination for a C12.22 Message.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20The%20C12.22%20IP%20Network%20Segment"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  The C12.22 IP Network Segment</span>

   This section defines the characteristics of the C12.22 IP Network
   Segment.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Composition%20of%20a%20C12.22%20IP%20Network%20Segment"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Composition of a C12.22 IP Network Segment</span>

   A C12.22 Network Segment is a collection of C12.22 Nodes that can
   communicate with each other directly -- without having to forward
   C12.22 Messages through a C12.22 Relay.

   A C12.22 IP Network Segment comprises C12.22 IP Nodes and the network
   infrastructure that enables any one node to reach all other nodes on



<span class="grey">Moise &amp; Brodkin               Informational                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


   the same segment.  All C12.22 IP Nodes on the C12.22 IP Network
   Segment employ the same IP address encoding scheme (per Figures 1
   and 2) and the same network and transport protocols in accordance
   with this specification.

   There is no restriction on the size of a C12.22 IP Network Segment.
   It MAY be as small as a single LAN or subnet, or it MAY include
   numerous, heterogeneous LANs and WANs connected by routers, bridges,
   and switches.  The C12.22 IP Network Segment MAY be completely
   private, or include communication across the global Internet.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Native%20IP%20Address"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Native IP Address</span>

   The term "Native IP Address" denotes a Native Address that MAY be
   used to reach a C12.22 Node on its C12.22 IP Network Segment.  The
   Native IP Address includes the binary IP address, and an OPTIONAL
   port number that MAY be followed by an OPTIONAL protocol identifier.
   The Native IP Address SHALL be encoded as described below in
   <a href="#section-4.3">Section 4.3</a>, "Encoding of Native IP Addresses".

   The IP address of the C12.22 IP Node MUST be configured before the
   C12.22 IP Node attempts to send or receive any C12.22 Message on its
   C12.22 IP Network Segment.  If the port number is not explicitly
   configured by the controlling application, it SHALL be set to the
   default port number, 1153 (see <a href="#section-4.4">Section 4.4</a>, "Standardized Port
   Numbers", below).

   It is beyond the scope of this specification to define the method of
   configuration, the configuration parameters, or any administrative
   controls that the system administrator may wish to implement to
   assign an IP address.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Encoding%20of%20Native%20IP%20Addresses"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Encoding of Native IP Addresses</span>

   ANSI C12.22 defines binary fields for encoding a C12.22 Native
   Address for transport within C12.22 Messages and for storage in
   C12.19 Device Tables.  In this RFC, the fields SHALL contain an IPv4
   or an IPv6 binary native IP address that is followed by an OPTIONAL
   two-byte TCP or UDP port number.  The TCP or UDP port number, when
   present, MAY be followed by an OPTIONAL one-byte transport protocol
   identifier ("Protocol" for IPv4 or "Next Header" for IPv6).  The
   transport protocol identifier SHALL be set to 17 (0x11) for UDP
   transport, or to 6 (0x06) for TCP transport, or not set (absent) for
   both UDP and TCP transports.  The transport protocol values SHALL be
   consistent with the C12.22 Node's registered attributes (see
   Connectionless (CL) and Connection-Oriented (CO) flags in
   <a href="#section-5.1">Section 5.1</a>, "C12.22 Connection Types and TCP/UDP Transport Modes",
   below).



<span class="grey">Moise &amp; Brodkin               Informational                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


   ANSI C12.22 allows the Native Address fields to be conveyed in select
   ANSI C12.22 EPSEM service elements (e.g., ANSI C12.22 Registration
   Service &lt;native-address&gt;, ANSI C12.22 Resolve Service response
   &lt;local-address&gt;, and ANSI C12.19 INTERFACE_CTRL_TBL Element
   NATIVE_ADDRESS).  The length of the C12.22 Native Address is
   qualified by an ANSI C12.22 address length field (e.g., ANSI C12.22
   Registration Service &lt;address-length&gt;, ANSI C12.22 Resolve Service
   response &lt;local-address-length&gt;, and ANSI C12.19 ACT_NETWORK_TBL
   Element NATIVE_ADDRESS_LEN).

   The ANSI C12.22 Registration Service permits only one Native Address
   to be recorded with each registered ApTitle.  For this reason, a
   C12.22 IP Node that wishes to register different port numbers for UDP
   and TCP MUST register twice using different ApTitles.

   The binary Native IP Address fields SHALL be encoded in network byte
   order, as shown in Figure 1.

                             IP Address (ADDR), Port (P), Transport (T)
                  Address
                   Length                        Octet
                               0                   1
                               0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8
                              +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       IPv4          4        | ADDR4 |
                              +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                              +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       IPv4+Port     6        | ADDR4 | P |
                              +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                              +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       IPv4+Port     7        | ADDR4 | P |T|
       +Transport             +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                              +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       IPv6         16        |             ADDR6             |
                              +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                              +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       IPv6+Port    18        |             ADDR6             | P |
                              +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                              +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       IPv6+Port    19        |             ADDR6             | P |T|
       +Transport             +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       Figure 1: Encoding of the Native IP Addresses for ANSI C12.22



<span class="grey">Moise &amp; Brodkin               Informational                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


   When an ANSI C12.22 Native Address is encoded in the ANSI C12.19
   Tables' BINARY data Elements, the size of the Native Address Element
   is defined by ACT_NETWORK_TBL.NATIVE_ADDRESS_LEN (see Table 121 of
   [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>], and [<a href="#ref-2" title='"Utility Industry End Device Data Tables"'>2</a>]).  This is the actual number of octets that are placed
   inside the C12.19 BINARY Element.  This value is common to all of the
   C12.22 Node's interfaces, including those that are not IP based (thus
   not conforming to this specification).  For this reason, the
   ACT_NETWORK_TBL.NATIVE_ADDRESS_LEN MAY be greater than, and SHALL NOT
   be smaller than, the actual length needed to encode a Native IP
   Address per Figure 1.  When this is the case, the C12.22 Native IP
   Address SHALL be padded with zero (0) to fill the Table's BINARY data
   Element.

   In instances where the Native IP Address length does not exactly
   match any of the Address Lengths listed in Figure 1, the actual
   Address Length SHALL be determined by stripping all trailing binary
   zeros (0x00) and then adjusting the Address Length upwards to the
   next largest value shown in Figure 1.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.4.%20%20Standardized%20Port%20Numbers"></a><a class="selflink" href="#section-4.4" name="section-4.4">4.4</a>.  Standardized Port Numbers</span>

   IANA (Internet Assigned Numbers Authority) has assigned port 1153 for
   UDP [<a href="#ref-8" title='"User Datagram Protocol"'>8</a>] and TCP [<a href="#ref-9" title='"Transmission Control Protocol"'>9</a>] C12.22 IP Messages.

   By default, C12.22 IP Nodes SHALL send all C12.22 Application
   association initiation message requests with 1153 set as the
   destination port number.

   To ensure interoperability among C12.22 IP Nodes, all C12.22 IP
   Relays and Master Relays SHALL monitor and accept UDP and TCP
   messages destined to port 1153.

   Any IP firewalls or Access Control Lists (ACLs) shielding C12.22
   Nodes and the IP network MUST be configured to forward UDP and TCP
   traffic destined to port 1153 and other ports that are assigned and
   registered by the network administrator, in order to maintain the
   continuity of the C12.22 IP Network Segment.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.5.%20%20Use%20of%20UDP%20Source%20Port%200"></a><a class="selflink" href="#section-4.5" name="section-4.5">4.5</a>.  Use of UDP Source Port 0</span>

   Although <a href="rfc768.html">RFC 768</a> [<a href="#ref-8" title='"User Datagram Protocol"'>8</a>] allows for a source port number of zero (0),
   C12.22 IP Nodes SHALL NOT send datagrams on UDP with the source port
   set to zero.  A C12.22 IP Node SHALL ignore and SHALL NOT respond to
   any C12.22 Message that it receives from source port 0.

   Further details of the C12.22 IP Node's use of UDP, and of TCP, are
   given in <a href="#section-5">Section 5</a>, "IP Message Transport", below.




<span class="grey">Moise &amp; Brodkin               Informational                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.6.%20%20IP%20Multicast"></a><a class="selflink" href="#section-4.6" name="section-4.6">4.6</a>.  IP Multicast</span>

   In addition to unicast, the ANSI C12.22 protocol requires the support
   of a multicast message delivery service from the network.  In cases
   where C12.22 IP Nodes MUST perform Native IP Address discovery (e.g.,
   the discovery of the Native IP Address of C12.22 IP Relays that
   provide a route out of the C12.22 IP Network Segment, or the
   discovery of the Native IP Address of a C12.22 IP Master Relay on the
   C12.22 IP Network), the C12.22 IP Nodes use IP multicast to send a
   C12.22 Message that contains an EPSEM Resolve Service Request on the
   IP LAN.

   IP multicast is also desirable, for example, when a C12.22 Host needs
   to read a multitude of C12.22 Nodes (e.g., meters) that are
   configured with a common C12.22 multicast group ApTitle.  Using IP
   multicast, the C12.22 Host MAY send a C12.22 Message containing an
   EPSEM Read Service Request that reaches all C12.22 Nodes on the
   C12.22 IP Network Segment.

   For these reasons, all C12.22 IP Relays and Master Relays SHALL
   support IP multicast, and it is RECOMMENDED that all C12.22 Nodes
   support IP multicast.  Any IPv4 C12.22 IP Node that supports IP
   multicast SHALL use the Internet Group Management Protocol version 1
   (IGMPv1) [<a href="#ref-10" title='"Host extensions for IP multicasting"'>10</a>] as a minimum, to report (i.e., request) membership in
   the C12.22 multicast group to its local router(s).  It is RECOMMENDED
   that C12.22 IP Nodes implement IGMPv3 [<a href="#ref-11" title='"Internet Group Management Protocol, Version 3"'>11</a>].

   Any IPv6 C12.22 IP Node that supports IP multicast SHALL use
   Multicast Listener Discovery version 2 (MLDv2) (<a href="rfc3810.html">RFC 3810</a> [<a href="#ref-12" title='"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"'>12</a>]),
   possibly within ICMPv6 (<a href="rfc4443.html">RFC 4443</a> [<a href="#ref-13" title='"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification"'>13</a>]), to report membership.

   Routers that interconnect C12.22 IP Nodes on the C12.22 IP Network
   Segment MUST support Protocol Independent Multicast - Sparse Mode
   (PIM-SM) (<a href="rfc4601.html">RFC 4601</a> [<a href="#ref-14" title='"Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised)"'>14</a>]) along with IGMPv1 (<a href="rfc1112.html">RFC 1112</a> [<a href="#ref-10" title='"Host extensions for IP multicasting"'>10</a>]) as a
   minimum for IPv4, or MLDv2 for IPv6 (<a href="rfc3810.html">RFC 3810</a> [<a href="#ref-12" title='"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"'>12</a>]).  It is
   RECOMMENDED that they implement IGMPv3 [<a href="#ref-11" title='"Internet Group Management Protocol, Version 3"'>11</a>].  It is beyond the scope
   of this specification to define the mechanism for selecting an
   initial Rendezvous Point (RP) for the C12.22 multicast group, the use
   of shared versus source trees, or the mechanism for inter-domain
   multicast routing.

   IANA has registered the "All C1222 Nodes" multicast group, and has
   assigned the IPv4 multicast address of 224.0.2.4 and the IPv6
   multicast address of FF0X::204, where X represents the Scope field as
   defined in <a href="rfc4291.html">RFC 4291</a>, "IP Version 6 Addressing Architecture" [<a href="#ref-15" title='"IP Version 6 Addressing Architecture"'>15</a>].






<span class="grey">Moise &amp; Brodkin               Informational                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


   For IPv6, all C12.22 IP Relays, C12.22 IP Master Relays, and all
   C12.22 IP Nodes configured to support broadcast and multicast (see
   <a href="#section-5.3">Section 5.3</a>, "Using IP Broadcast/Multicast", below) SHALL join the
   global-scope multicast address, FF0E::204, as well as all of the
   assigned, reduced-scope, multicast addresses:

                    link-local         -- FF02::204;
                    admin-local        -- FF04::204;
                    site-local         -- FF05::204; and
                    organization-local -- FF08::204.

   IPv6 C12.22 IP Nodes SHOULD use the minimum scope needed, when
   initiating IP multicast messages to reach another C12.22 IP Node on
   the C12.22 Network.  This practice allows the sender to limit
   unnecessary propagation of C12.22 IP Multicast Messages.

   To determine the minimum scope required to reach the closest C12.22
   IP Relay on the C12.22 Node's IP Network Segment, this specification
   RECOMMENDS the following simple steps:

   1.  Starting with the smallest (local-most) scope (i.e., link-local
       scope or another pre-configured scope), send the C12.22 EPSEM
       Resolve Service Request for the purpose of C12.22 IP Relay
       discovery.

   2.  Listen for a response from a C12.22 IP Relay; then:

       A.  If no response is received, assign the next wider scope
           level, then repeat steps (1) and (2) at the newly assigned
           scope.

       B.  If a response is received, then record the scope level as the
           minimum scope to use on the node's C12.22 IP Network Segment.

   A C12.22 IPv6 Node that initiates any EPSEM Service Request SHOULD
   use the minimum scope necessary to reach its Target C12.22 IP Nodes.
   A C12.22 IPv6 Relay SHALL use the global scope for any C12.22 Message
   destined for the global Internet.

   This specification does not preclude the use of the unassigned scope
   values defined in [<a href="#ref-15" title='"IP Version 6 Addressing Architecture"'>15</a>]; those scope values MAY be used on a private
   basis, or through mutual operating agreements.

   For IPv4, all C12.22 IP Relays, C12.22 IP Master Relays, and all
   C12.22 IP Nodes configured to support broadcast/multicast SHALL join
   the assigned multicast address of 224.0.2.4.  This global address
   does not provide for the type of scoping discussed above for IPv6,
   nor is it compatible with the administratively scoped IP multicast



<span class="grey">Moise &amp; Brodkin               Informational                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


   specification in <a href="rfc2365.html">RFC 2365</a> [<a href="#ref-16" title='"Administratively Scoped IP Multicast"'>16</a>].  Therefore, a different technique to
   limit the propagation of C12.22 IP Multicast Messages is needed.  One
   available technique to control IPv4 multicast scope is through the
   use of the Time-to-Live (TTL) attribute in the IP packet header.
   This attribute is not managed by the C12.22 protocol.

   In the implementation of this technique, an administrative domain
   MUST include at least one C12.22 IP Relay, and all C12.22 IP Nodes in
   the administrative domain SHOULD be configured with a TTL
   sufficiently large to reach that C12.22 IP Relay.

   A C12.22 IPv4 Node that initiates any C12.22 Request Message SHOULD
   use the minimum TTL needed to reach its Target C12.22 IP Nodes.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.7.%20%20IP%20Broadcast"></a><a class="selflink" href="#section-4.7" name="section-4.7">4.7</a>.  IP Broadcast</span>

   IP broadcast is not generally suitable as a replacement for, or an
   alternative to, multicast in a C12.22 IP Network Segment.  IP
   broadcast is not supported in IPv6, and it suffers from limited scope
   in IPv4.  This specification, however, does not preclude the use of
   IP network directed or limited/local scope (address 255.255.255.255)
   broadcast within a controlled management domain (as per <a href="rfc2644.html">RFC 2644</a>
   [<a href="#ref-17" title='"Changing the Default for Directed Broadcasts in Routers"'>17</a>]).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.8.%20%20Encoding%20of%20Multicast%20and%20Broadcast%20Addresses"></a><a class="selflink" href="#section-4.8" name="section-4.8">4.8</a>.  Encoding of Multicast and Broadcast Addresses</span>

   ANSI C12.22 Tables provide BINARY Elements for encoding a broadcast
   or multicast Native IP Address for transport within a C12.22 Message.
   The encoding of these Table Elements is identical to that defined in
   <a href="#section-4.3">Section 4.3</a>, "Encoding of Native IP Addresses".  These fields SHALL
   be used as shown in Figure 2.




















<span class="grey">Moise &amp; Brodkin               Informational                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


                             IP Address (ADDR), Port (P), Transport (T)
                   Address
                    Length                       Octet
                               0                   1
                               0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8
       IPv4                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       Broadcast      4       |BADDR4 |
                              +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       IPv4                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       Broadcast      6       |BADDR4 | P |
       +Port                  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       IPv4                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       Broadcast      7       |BADDR4 | P |T|
       +Port+Transport        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       IPv4                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       Multicast      4       |MADDR4 |
                              +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       IPv4                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       Multicast      6       |MADDR4 | P |
       +Port                  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       IPv4                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       Multicast      7       |MADDR4 | P |T|
       +Port+Transport        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       IPv6                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       Multicast     16       |            MADDR6             |
                              +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       IPv6                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       Multicast     18       |            MADDR6             | P |
       +Port                  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       IPv6                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       Multicast     19       |            MADDR6             | P |T|
       +Port+Transport        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       Figure 2: Encoding of Broadcast/Multicast Native IP Addresses

   The IPv4 and IPv6 multicast addresses -- MADDR4 and MADDR6,
   respectively -- are those assigned by IANA for use by ANSI C12.22.






<span class="grey">Moise &amp; Brodkin               Informational                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


   When a broadcast/multicast Native IP Address is encoded in the ANSI
   C12.19 Tables' BINARY data Elements, the size of the Native Address
   Element transmitted is defined by ACT_NETWORK_TBL.NATIVE_ADDRESS_LEN
   (see Table 121 of [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>], and [<a href="#ref-2" title='"Utility Industry End Device Data Tables"'>2</a>]).  This is the actual number of octets
   that are placed inside the C12.19 BINARY Element.  This value is
   common to all of the C12.22 Node's interfaces, including those that
   are not IP based (thus not conforming to this specification).  For
   this reason, the ACT_NETWORK_TBL.NATIVE_ADDRESS_LEN MAY be greater
   than, and SHALL NOT be smaller than, the actual length needed to
   encode a broadcast/multicast Native IP Address per Figure 2.  When
   this is the case, the C12.22 Native IP Address SHALL be padded with
   zero (0) to fill the Table's BINARY data Element.

   The IPv4 network directed broadcast address can be computed by
   performing a bitwise OR between the bit complement of the subnet mask
   of the target IP subnet and the IP address of any host on that IP
   subnet.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20IP%20Message%20Transport"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  IP Message Transport</span>

   This section defines a C12.22 Node's usage of the Connection-Oriented
   (CO) and Connectionless (CL) transport layer protocols -- TCP and
   UDP, respectively.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20C12.22%20Connection%20Types%20and%20TCP%2FUDP%20Transport%20Modes"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  C12.22 Connection Types and TCP/UDP Transport Modes</span>

   A C12.22 IP Node's use of TCP and UDP is based on its registered
   capabilities as defined in its configuration parameters (flags) and
   as expressed in the Node's accepted registration attributes [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>]:

         CL Flag = &lt;connection-type&gt;.CONNECTIONLESS_MODE_SUPPORTED;
         CL Accept Flag = &lt;connection-type&gt;.ACCEPT_CONNECTIONLESS;
         CO Flag = &lt;connection-type&gt;.CONNECTION_MODE_SUPPORTED; and
         CO Accept Flag = &lt;connection-type&gt;.ACCEPT_CONNECTIONS.

   The mapping of the connection-type parameters to the IP-based
   transport variants that a C12.22 Node MAY support is defined in
   Table 1.













<span class="grey">Moise &amp; Brodkin               Informational                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


   +------+------+----------+----------+-------------------------------+
   |  CL  |  CO  |    CL    |    CO    | IP Transport Mode Supported   |
   | Flag | Flag |  Accept  |  Accept  |                               |
   |      |      |   Flag   |   Flag   |                               |
   +------+------+----------+----------+-------------------------------+
   |   0  |   0  |     x    |     x    | Invalid                       |
   |   0  |   1  |     0    |     0    | TCP, Active-OPEN              |
   |   0  |   1  |     0    |     1    | TCP, Passive- and Active-OPEN |
   |   0  |   1  |     1    |     0    | Invalid                       |
   |   0  |   1  |     1    |     1    | Invalid                       |
   |   1  |   0  |     0    |     0    | UDP, Active-OPEN              |
   |   1  |   0  |     0    |     1    | Invalid                       |
   |   1  |   0  |     1    |     0    | UDP, Passive- and Active-OPEN |
   |   1  |   0  |     1    |     1    | Invalid                       |
   |   1  |   1  |     0    |     0    | UDP, Active-OPEN; TCP         |
   |      |      |          |          | Active-OPEN                   |
   |   1  |   1  |     0    |     1    | UDP, Active-OPEN; TCP,        |
   |      |      |          |          | Passive- and Active-OPEN      |
   |   1  |   1  |     1    |     0    | UDP, Passive- and             |
   |      |      |          |          | Active-OPEN; TCP, Active-OPEN |
   |   1  |   1  |     1    |     1    | UDP, Passive- and             |
   |      |      |          |          | Active-OPEN; TCP, Passive-    |
   |      |      |          |          | and Active-OPEN               |
   +------+------+----------+----------+-------------------------------+

          Table 1: C12.22 Node Parameters to IP Transport Mapping

   Every C12.22 IP Node MUST support at least one of the unicast CO or
   CL operating capabilities (as advertised in Decade 12, "Node Network
   Control Tables" [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>], where available, and as registered using the
   C12.22 Registration Service [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>]).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20IP%20Message%20Transport%20Details"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  IP Message Transport Details</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.1.%20%20TCP%20and%20UDP%20Port%20Use"></a><a class="selflink" href="#section-5.2.1" name="section-5.2.1">5.2.1</a>.  TCP and UDP Port Use</span>

   General rules:

   1.  A C12.22 IP Node that implements [CL Accept=1] SHALL receive
       incoming UDP C12.22 Messages on its registered Native IP Address
       (IP address and port number).

   2.  A C12.22 IP Node that implements [CO Accept=1] SHALL receive
       incoming TCP connections on its registered Native IP Address (IP
       address and port number).






<span class="grey">Moise &amp; Brodkin               Informational                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


   3.  A C12.22 IP Relay that forwards a UDP C12.22 Message to a C12.22
       IP Node on the C12.22 IP Network Segment SHALL send the C12.22
       Message to the C12.22 IP Node's registered Native IP Address (IP
       address and port number).

   4.  A C12.22 IP Relay that forwards a TCP C12.22 Message to a C12.22
       IP Node on the C12.22 IP Network Segment MAY use an established
       TCP connection to that C12.22 IP Node, or it SHALL establish a
       new TCP connection to the C12.22 IP Node's registered Native IP
       Address (IP address and port number).

   5.  A C12.22 IP Node that implements [CL=1] SHOULD set the source
       port number in outbound UDP C12.22 Messages to its registered
       port number.  When the target UDP C12.22 IP Node is reachable
       using direct messaging (as defined in [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>]), the C12.22 IP Node
       MAY set the source port number to a UDP port number that is
       different than its registered port number.

   6.  When the registered Native IP Address of a C12.22 IP Node does
       not include the OPTIONAL port number, then port 1153 SHALL be
       assumed and used as the registered port number.

   7.  All C12.22 IP Nodes SHOULD use port 1153 in their Native IP
       Address when registering.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.2.%20%20Active-OPEN%20UDP%20Mode%20%28CL%3D1%2C%20CL%20Accept%3D0%29"></a><a class="selflink" href="#section-5.2.2" name="section-5.2.2">5.2.2</a>.  Active-OPEN UDP Mode (CL=1, CL Accept=0)</span>

   A C12.22 IP Node that supports this mode SHALL NOT monitor for
   unsolicited incoming C12.22 Messages via UDP.  As a result, the
   C12.22 IP Node is incapable of receiving unsolicited C12.22 Messages
   using UDP.

   The C12.22 IP Node MAY enter the Active-OPEN UDP state by initiating
   an unsolicited UDP transmission to a Target C12.22 IP Node, which is
   expected to implement the Passive-OPEN UDP mode.

   C12.22 IP Nodes SHOULD use their registered UDP port number, or if
   not yet registered, then they SHOULD use port 1153 as the source port
   number for all UDP C12.22 IP Messages.












<span class="grey">Moise &amp; Brodkin               Informational                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.3.%20%20Passive-OPEN%20UDP%20Mode%20%28CL%3D1%2C%20CL%20Accept%3D1%29"></a><a class="selflink" href="#section-5.2.3" name="section-5.2.3">5.2.3</a>.  Passive-OPEN UDP Mode (CL=1, CL Accept=1)</span>

   A C12.22 IP Node that operates in this mode SHALL be capable of
   receiving solicited and unsolicited C12.22 Messages from other C12.22
   IP Nodes.  The C12.22 Node MAY change the port number that it
   monitors by using the &lt;native-address&gt; parameter of the ANSI C12.22
   Registration Service.  The C12.22 IP Node MAY initiate unsolicited
   Active-OPEN UDP transmissions to other C12.22 IP Nodes that implement
   the Passive-OPEN UDP mode.

   When operating in this mode, the C12.22 IP Nodes SHALL use their
   registered UDP port number as the source port number for all UDP
   C12.22 IP Messages.

   All C12.22 IP Relays SHALL support the Passive-OPEN UDP mode.  C12.22
   Authentication Hosts and C12.22 Notification Hosts that implement UDP
   SHALL support the Passive-OPEN UDP mode.  For all other C12.22 IP
   Nodes, the Passive-OPEN UDP mode is the RECOMMENDED mode when
   implementing UDP.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.4.%20%20Active-OPEN%20TCP%20Mode%20%28CO%3D1%2C%20CO%20Accept%3D0%29"></a><a class="selflink" href="#section-5.2.4" name="section-5.2.4">5.2.4</a>.  Active-OPEN TCP Mode (CO=1, CO Accept=0)</span>

   A C12.22 IP Node that supports this mode SHALL NOT monitor for
   inbound TCP connections.  As a result, the node is incapable of
   accepting incoming connections via TCP.  The C12.22 IP Node MAY
   initiate TCP connections to Target C12.22 IP Nodes, which are
   expected to implement the Passive-OPEN TCP mode.

   In this mode, C12.22 Messages exchanged by a pair of associated
   C12.22 IP Nodes can only be communicated through any of the TCP
   connections that were initiated by the C12.22 IP Node that implements
   this mode.  The loss or closure of a connection SHALL NOT
   automatically result in the termination of the C12.22 associations
   between the peer nodes.  In order to continue exchanging C12.22
   Messages without loss of association, the initiating C12.22 IP Node
   MAY re-establish new TCP connections with the peer node, or use
   existing connections to the peer node.  The termination of the C12.22
   Application associations is dependent upon C12.22 Application timeout
   attributes and C12.22 link management services (such as Procedure 25,
   "Network Interface Control" [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>]).











<span class="grey">Moise &amp; Brodkin               Informational                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.5.%20%20Passive-OPEN%20TCP%20Mode%20%28CO%3D1%2C%20CO%20Accept%3D1%29"></a><a class="selflink" href="#section-5.2.5" name="section-5.2.5">5.2.5</a>.  Passive-OPEN TCP Mode (CO=1, CO Accept=1)</span>

   A C12.22 IP Node that operates in this mode SHALL monitor and accept
   incoming TCP connections.  The C12.22 Node MAY change the port number
   that it monitors by using the &lt;native-address&gt; parameter of the ANSI
   C12.22 Registration Service.  The C12.22 IP Node MAY initiate Active-
   OPEN TCP connections to other C12.22 IP Nodes that implement the
   Passive-OPEN TCP mode.

   In this mode, C12.22 Messages exchanged by a pair of associated
   C12.22 IP Nodes can arrive through any of the TCP connections that
   were established by either node.  The loss or closure of a connection
   SHALL NOT automatically result in the termination of the C12.22
   associations between the peer nodes.  In order to continue exchanging
   C12.22 Messages without loss of association, either C12.22 IP Node
   MAY re-establish new TCP connections with the peer node, or use
   existing connections to the peer node.  The termination of the C12.22
   Application associations is dependent upon C12.22 Application timeout
   attributes and C12.22 link management services (such as Procedure 25,
   "Network Interface Control" [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>]).

   All C12.22 IP Relays SHALL support the Passive-OPEN TCP mode.  C12.22
   Authentication Hosts and C12.22 Notification Hosts that implement TCP
   SHALL support Passive-OPEN TCP mode.  For all other C12.22 IP Nodes,
   Passive-OPEN TCP mode is the RECOMMENDED mode when implementing TCP.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.6.%20%20TCP%20and%20C12.22%20Message%20Directionality"></a><a class="selflink" href="#section-5.2.6" name="section-5.2.6">5.2.6</a>.  TCP and C12.22 Message Directionality</span>

   C12.22 IP Nodes MAY use TCP in one of two ways: bi-directional
   traffic flow or uni-directional traffic flow.

   When TCP connections are used, any new or established TCP connection
   between the two C12.22 IP Nodes MAY be used equivalently by the
   C12.22 IP Nodes to send and to receive C12.22 Messages.  This is the
   RECOMMENDED and default mode of operation because ANSI C12.22
   requires the transport network to be reliable and connectionless (per
   connectionless-mode ACSE).  For this reason, ANSI C12.22 defines
   peer-to-peer application associations and not peer-to-peer
   connections.

   It is known that some C12.22 implementations have been deployed in
   which TCP is used for uni-directional traffic flow.  For these types
   of implementations, an established TCP connection SHALL be used by
   the initiator of that connection to send C12.22 Messages and by the







<span class="grey">Moise &amp; Brodkin               Informational                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


   target node (that accepted the connection) to receive C12.22
   Messages.  If a C12.22 IP Node wishes to send a C12.22 Message to a
   peer C12.22 IP Node, it MUST establish and use a new TCP connection,
   or use an existing TCP connection that it had previously initiated,
   for its outbound uni-directional traffic flow.

   For increased interoperability, the initiator of the connection
   SHOULD accept incoming C12.22 Messages on that connection in case the
   target node attempts to use the connection for bi-directional traffic
   flow.

   Uni-directional use of TCP is a special mode of operation; it is NOT
   RECOMMENDED because multiple one-way channel communication is not
   described by ANSI C12.22, and it utilizes one-half of the TCP
   connection capability.  As a result, it doubles the number of TCP
   connections used to communicate C12.22 Messages and thus could become
   a burden when a large number of connections are required.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Using%20IP%20Broadcast%2FMulticast"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Using IP Broadcast/Multicast</span>

   A C12.22 IP Node's use of broadcast/multicast is based on its
   capabilities as defined in its configuration parameters (flags) and
   as expressed in the Node's accepted registration attributes [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>]
   (&lt;connection-type&gt;.BROADCAST_AND_MULTICAST_SUPPORTED).  The mapping
   of the C12.22 IP Node's Broadcast/Multicast parameter (flag) to IP
   broadcast/multicast usage is defined in Table 2.

    C12.22 Broadcast and  IP Broadcast/Multicast Supported
     Multicast Supported
            Flag
   ---------------------- ----------------------------------------------
              0           The C12.22 IP Node does not accept IP
                          broadcast, and it does not accept IP multicast
                          messages.
              1           The C12.22 IP Node accepts both IP broadcast
                          (IPv4 only) and IP multicast messages (IPv4
                          and IPv6).

             Table 2: C12.22 to IP Broadcast/Multicast Mapping

   If a C12.22 IP Node is configured to accept IP broadcast and
   multicast messages, it SHALL join the "All C1222 Nodes" multicast
   group (see <a href="#section-4.6">Section 4.6</a>, "IP Multicast", above), and SHALL use the
   default port 1153.  In addition, it SHALL accept IP network directed
   or limited (local scope) broadcast messages sent to port 1153.  Note
   that successful communication using network directed broadcast
   requires configuration of network routers, which by default SHALL NOT
   forward directed broadcasts as per <a href="rfc2644.html">RFC 2644</a> [<a href="#ref-17" title='"Changing the Default for Directed Broadcasts in Routers"'>17</a>].



<span class="grey">Moise &amp; Brodkin               Informational                    [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20Transport%20Protocol%20Decisions"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  Transport Protocol Decisions</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.4.1.%20%20Unicast%20Versus%20Multicast%20Versus%20Broadcast"></a><a class="selflink" href="#section-5.4.1" name="section-5.4.1">5.4.1</a>.  Unicast Versus Multicast Versus Broadcast</span>

   An initiating C12.22 IP Node MAY send any C12.22 Message using UDP or
   TCP.  However, in accordance with <a href="#section-5.3.2.4.12">Section 5.3.2.4.12</a>, "Resolve
   Service", of ANSI C12.22, it is RECOMMENDED that the C12.22 Resolve
   Request Message be transported using UDP/IP multicast when the Native
   IP Address of the Target C12.22 Node is not known.  The use of UDP/IP
   multicast is preferred over the use of IP network directed or limited
   broadcast; therefore, when UDP/IP multicast is supported, its use is
   RECOMMENDED over network broadcast.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.4.2.%20%20Sending%20Large%20C12.22%20APDUs%20Using%20UDP"></a><a class="selflink" href="#section-5.4.2" name="section-5.4.2">5.4.2</a>.  Sending Large C12.22 APDUs Using UDP</span>

   When sending via UDP a large C12.22 Message that exceeds the path
   MTU, the sender SHALL segment the ACSE APDU in accordance with the
   ANSI C12.22 Datagram Segmentation and Reassembly algorithm, such that
   the size of the resulting IP datagram does not exceed the path MTU
   and thus avoids UDP packet fragmentation.  The fundamental issue with
   fragmentation exists for both IPv4 and IPv6.  <a href="rfc5405.html#section-3.2">SectionÂ 3.2 of RFC 5405</a>
   [<a href="#ref-18" title='"Unicast UDP Usage Guidelines for Application Designers"'>18</a>] provides additional guidelines for determining the appropriate
   UDP message size.  When the path MTU is not known, the sender SHALL
   follow the guidelines stipulated in <a href="rfc5405.html#section-3.2">SectionÂ 3.2 of RFC 5405</a> [<a href="#ref-18" title='"Unicast UDP Usage Guidelines for Application Designers"'>18</a>]: for
   IPv4, use the smaller of 576 bytes and the first-hop MTU [<a href="#ref-19" title='"Requirements for Internet Hosts - Communication Layers"'>19</a>], and
   for IPv6, use 1280 bytes [<a href="#ref-20" title='"Internet Protocol, Version 6 (IPv6) Specification"'>20</a>].  Sending large APDUs via UDP may lead
   to network congestion.  For more information on avoiding network
   congestion see <a href="#section-5.6">Section 5.6</a>, "Congestion Control".

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.4.3.%20%20%20Choice%20of%20Protocol%20for%20C12.22%20Response%20APDUs"></a><a class="selflink" href="#section-5.4.3" name="section-5.4.3">5.4.3</a>.   Choice of Protocol for C12.22 Response APDUs</span>

   When a Target C12.22 IP Node receives a C12.22 Request Message from
   an initiating C12.22 IP Node, it SHALL send a C12.22 Response Message
   using the same transport protocol (i.e., TCP to TCP, UDP to UDP).

   In the case of UDP, the target SHALL send the C12.22 Response Message
   to the source IP address and port number.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.5.%20%20Quality%20of%20Service"></a><a class="selflink" href="#section-5.5" name="section-5.5">5.5</a>.  Quality of Service</span>

   The ANSI C12.22 standard provides a configuration parameter in the
   APDU's &lt;calling-AE-qualifier&gt;.URGENT attribute to mark a message as
   urgent.  There are numerous IP-based technologies that enable
   enhanced levels of message delivery and quality of service.  This
   specification does not define the technology to be used to send
   urgent messages over IP.





<span class="grey">Moise &amp; Brodkin               Informational                    [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.6.%20%20Congestion%20Control"></a><a class="selflink" href="#section-5.6" name="section-5.6">5.6</a>.  Congestion Control</span>

   Designers of unicast applications that implement the upper layers of
   C12.22 messaging over UDP SHOULD follow the congestion control
   guidelines in <a href="rfc5405.html#section-3.1">SectionÂ 3.1 of RFC 5405</a> [<a href="#ref-18" title='"Unicast UDP Usage Guidelines for Application Designers"'>18</a>].

   For the transmission of C12.22 Messages that are greater than what
   the TCP initial window would be over a given Internet path, TCP
   SHOULD be used rather than UDP as the transport protocol.  TCP's
   initial window depends on the maximum segment size (MSS), which in
   turn depends on the path MTU, and is computed according to formula
   (1) in <a href="rfc3390.html">RFC 3390</a> [<a href="#ref-21" title="&quot;Increasing TCP's Initial Window&quot;">21</a>].  For unknown path MTUs, the smallest allowable
   MSS MUST be used, and the C12.22 Application SHOULD assume the
   maximum C12.22 Message size to be 2048 bytes.  By using TCP, the
   C12.22 Application benefits from the built-in TCP congestion control
   mechanism.

   When UDP is the preferred transport mechanism, or when UDP multicast
   or broadcast are the preferred modes of communication, then the
   C12.22 Application SHOULD use C12.22 acknowledged Messages that are
   smaller than TCP's initial window over the return path, as computed
   by formula (1) in [<a href="#ref-21" title="&quot;Increasing TCP's Initial Window&quot;">21</a>] and described above.  The size of the C12.22
   Message MAY be managed through the use of ANSI C12.22 EPSEM Partial
   Table Read/Write Service Requests and Responses.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Security Considerations</span>

   The ANSI C12.22 Application Layer Security is defined in
   <a href="#section-5.3.4.13">Section 5.3.4.13</a>, "C12.22 Security Mechanism", of the ANSI C12.22
   standard.  The security mechanisms include provisions for message
   privacy and authentication, playback rejection, and message
   acceptance windows, as well as ANSI C12.19 [<a href="#ref-2" title='"Utility Industry End Device Data Tables"'>2</a>] role-based data access
   and secured register mechanisms.  The ANSI C12.22 Application Layer
   default security mechanism provides three options to choose from when
   sending C12.22 Messages:

   1.  Sending cleartext messages over the C12.22 Network [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>], [<a href="#ref-5" title='"Standard for Local Area Network/Wide Area Network (LAN/ WAN) Node Communication Protocol to Complement the Utility Industry End Device Data Tables"'>5</a>],
       which MAY result in altered C12.22 Messages and exposure to
       password sniffing attacks, as described in <a href="rfc3552.html">RFC 3552</a> [<a href="#ref-22" title='"Guidelines for Writing RFC Text on Security Considerations"'>22</a>].

   2.  Sending of authenticated plaintext messages over the C12.22
       Network [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>], [<a href="#ref-5" title='"Standard for Local Area Network/Wide Area Network (LAN/ WAN) Node Communication Protocol to Complement the Utility Industry End Device Data Tables"'>5</a>], which MAY result in password sniffing attacks
       as described in <a href="rfc3552.html">RFC 3552</a> [<a href="#ref-22" title='"Guidelines for Writing RFC Text on Security Considerations"'>22</a>].

   3.  Sending of authenticated ciphertext over the C12.22 Network,
       providing for message and peer node authentication and privacy.





<span class="grey">Moise &amp; Brodkin               Informational                    [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


   When option 1 is used, then it is RECOMMENDED that the network or
   transport layer provide authentication and confidentiality service.
   When option 2 is used, then it is RECOMMENDED that the network or
   transport layer provide confidentiality services.  When option 3 is
   used, then no additional network or transport layer security services
   are necessary.

   Additional transport or network layer security protocols are not
   required by ANSI C12.22, but they MAY be provided transparently by
   C12.22 IP Network Segment integrators (e.g., in C12.22 IP Relays) in
   order to improve on the security provisions cited above.  However,
   any added transport security (e.g., Transport Layer Security (TLS),
   <a href="rfc5246.html">RFC 5246</a> [<a href="#ref-27" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>27</a>]) or IP security (e.g., IPsec, <a href="rfc4302.html">RFC 4302</a> [<a href="#ref-25" title='"IP Authentication Header"'>25</a>], <a href="rfc4303.html">RFC 4303</a>
   [<a href="#ref-26" title='"IP Encapsulating Security Payload (ESP)"'>26</a>], <a href="rfc5996.html">RFC 5996</a> [<a href="#ref-28" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>28</a>]) features SHALL act only to enhance (i.e., not be
   a substitute for, or an alteration of) the interoperable ANSI C12.22
   and ANSI C12.19 security provisions, and SHALL NOT corrupt and SHALL
   NOT alter the C12.22 Message as presented by the C12.22 Application
   Layer.

   The ANSI C12.22 [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>] and ANSI C12.19 [<a href="#ref-2" title='"Utility Industry End Device Data Tables"'>2</a>] standards provide for the
   transmission of keys and their storage in C12.19 End Devices (e.g.,
   meters and head-end systems).  The key management protocol (when and
   how keys are exchanged) is not described in the ANSI C12.22 [<a href="#ref-1" title='"Protocol Specification for Interfacing to Data Communication Networks"'>1</a>] and
   ANSI C12.19 [<a href="#ref-2" title='"Utility Industry End Device Data Tables"'>2</a>] standards, except to state that keys MAY not be
   readable from a C12.19 End Device (in response to a Read Service
   Request).  It is RECOMMENDED that all C12.22 Nodes encrypt user
   information element key fields and passwords.  It is also RECOMMENDED
   that all C12.22 Nodes mask user information element key fields and
   password fields of EPSEM Read Service Responses (e.g., by replacing
   all key and password bytes with zeros (0x00) or spaces (0x20)).

   Legacy deployments exist that are not connected to the Internet, so
   there are some implementations that do not include security.  It is
   likely that multi-homed C12.22 Nodes with interfaces to the Internet
   will exist in future deployments, so security mechanisms MUST be used
   by those C12.22 Nodes to ensure C12.22 Message authentication and
   confidentiality.














<span class="grey">Moise &amp; Brodkin               Informational                    [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  IANA Considerations</span>

   UDP and TCP port 1153, which is used for C12.22 communication over
   IP, is registered with IANA.

   <a href="#section-4.6">Section 4.6</a>, "IP Multicast", defines the use of multicast.  The
   following multicast addresses have been registered by IANA for use by
   the ANSI C12.22 standard:

      IPv4 -- "All C1222 Nodes" address 224.0.2.4

      IPv6 -- "All C1222 Nodes" address FF0X::204

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Acknowledgments"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Acknowledgments</span>

   The authors wish to recognize Alexander Shulgin for providing
   valuable comments and for conducting feasibility testing in support
   of this work.

   The following people have improved this document through thoughtful
   comments and suggestions: Fred Baker, Ralph Droms, Vijay Gurbani,
   Michael Stuber, Spencer Dawkins, Alfred Hoenes, Russ Housley, Paul
   Hoffman, Lars Eggert, and Sean Turner.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20References"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20Normative%20References"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  Normative References</span>

   [<a id="ref-1" name="ref-1">1</a>]   ANSI, "Protocol Specification for Interfacing to Data
         Communication Networks", ANSI C12.22-2008, January 2009.

   [<a id="ref-2" name="ref-2">2</a>]   ANSI, "Utility Industry End Device Data Tables", ANSI C12.19-
         2008, February 2009.

   [<a id="ref-3" name="ref-3">3</a>]   IEEE, "Draft Standard for Utility Industry Metering
         Communication Protocol Application Layer (End Device Data
         Tables)", IEEE P1377-2010, October 2010.

   [<a id="ref-4" name="ref-4">4</a>]   Bradner, S., "Key words for use in RFCs to Indicate Requirement
         Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-5" name="ref-5">5</a>]   IEEE, "Standard for Local Area Network/Wide Area Network (LAN/
         WAN) Node Communication Protocol to Complement the Utility
         Industry End Device Data Tables", IEEE P1703-2010,
         October 2010.






<span class="grey">Moise &amp; Brodkin               Informational                    [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


   [<a id="ref-6" name="ref-6">6</a>]   ISO/IEC, "Information Technology-Open Systems Interconnection-
         Connectionless Protocol for the Association Control Service
         Element: Protocol Specification", ISO/IEC 10035-1, 1995.

   [<a id="ref-7" name="ref-7">7</a>]   ISO/IEC, "Information Technology-ASN.1 Encoding Rules:
         Specification of Basic Encoding Rules (BER), Canonical Encoding
         Rules (CER) and Distinguished Encoding Rules (DER)", ISO/
         IEC 8825-1, 2002.

   [<a id="ref-8" name="ref-8">8</a>]   Postel, J., "User Datagram Protocol", STD 6, <a href="rfc768.html">RFC 768</a>,
         August 1980.

   [<a id="ref-9" name="ref-9">9</a>]   Postel, J., "Transmission Control Protocol", STD 7, <a href="rfc793.html">RFC 793</a>,
         September 1981.

   [<a id="ref-10" name="ref-10">10</a>]  Deering, S., "Host extensions for IP multicasting", STD 5,
         <a href="rfc1112.html">RFC 1112</a>, August 1989.

   [<a id="ref-11" name="ref-11">11</a>]  Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A.
         Thyagarajan, "Internet Group Management Protocol, Version 3",
         <a href="rfc3376.html">RFC 3376</a>, October 2002.

   [<a id="ref-12" name="ref-12">12</a>]  Vida, R., Ed., and L. Costa, Ed., "Multicast Listener Discovery
         Version 2 (MLDv2) for IPv6", <a href="rfc3810.html">RFC 3810</a>, June 2004.

   [<a id="ref-13" name="ref-13">13</a>]  Conta, A., Deering, S., and M. Gupta, Ed., "Internet Control
         Message Protocol (ICMPv6) for the Internet Protocol Version 6
         (IPv6) Specification", <a href="rfc4443.html">RFC 4443</a>, March 2006.

   [<a id="ref-14" name="ref-14">14</a>]  Fenner, B., Handley, M., Holbrook, H., and I. Kouvelas,
         "Protocol Independent Multicast - Sparse Mode (PIM-SM):
         Protocol Specification (Revised)", <a href="rfc4601.html">RFC 4601</a>, August 2006.

   [<a id="ref-15" name="ref-15">15</a>]  Hinden, R. and S. Deering, "IP Version 6 Addressing
         Architecture", <a href="rfc4291.html">RFC 4291</a>, February 2006.

   [<a id="ref-16" name="ref-16">16</a>]  Meyer, D., "Administratively Scoped IP Multicast", <a href="https://tools.ietf.org/html/bcp23">BCP 23</a>,
         <a href="rfc2365.html">RFC 2365</a>, July 1998.

   [<a id="ref-17" name="ref-17">17</a>]  Senie, D., "Changing the Default for Directed Broadcasts in
         Routers", <a href="https://tools.ietf.org/html/bcp34">BCP 34</a>, <a href="rfc2644.html">RFC 2644</a>, August 1999.

   [<a id="ref-18" name="ref-18">18</a>]  Eggert, L. and G. Fairhurst, "Unicast UDP Usage Guidelines for
         Application Designers", <a href="https://tools.ietf.org/html/bcp145">BCP 145</a>, <a href="rfc5405.html">RFC 5405</a>, November 2008.

   [<a id="ref-19" name="ref-19">19</a>]  Braden, R., Ed., "Requirements for Internet Hosts -
         Communication Layers", STD 3, <a href="rfc1122.html">RFC 1122</a>, October 1989.




<span class="grey">Moise &amp; Brodkin               Informational                    [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


   [<a id="ref-20" name="ref-20">20</a>]  Deering, S. and R. Hinden, "Internet Protocol, Version 6 (IPv6)
         Specification", <a href="rfc2460.html">RFC 2460</a>, December 1998.

   [<a id="ref-21" name="ref-21">21</a>]  Allman, M., Floyd, S., and C. Partridge, "Increasing TCP's
         Initial Window", <a href="rfc3390.html">RFC 3390</a>, October 2002.

   [<a id="ref-22" name="ref-22">22</a>]  Rescorla, E. and B. Korver, "Guidelines for Writing RFC Text on
         Security Considerations", <a href="https://tools.ietf.org/html/bcp72">BCP 72</a>, <a href="rfc3552.html">RFC 3552</a>, July 2003.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20Informative%20References"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  Informative References</span>

   [<a id="ref-23" name="ref-23">23</a>]  Measurement Canada, "Specification for Utility Industry
         Metering Communication Protocol Application Layer (End Device
         Data Tables)", Draft MC12.19, 2011.

   [<a id="ref-24" name="ref-24">24</a>]  Measurement Canada, "Specification for Local Area Network/Wide
         Area Network (LAN/WAN) Node Communication Protocol to
         Complement the Utility Industry End Device Data Tables",
         Draft MC12.22, 2011.

   [<a id="ref-25" name="ref-25">25</a>]  Kent, S., "IP Authentication Header", <a href="rfc4302.html">RFC 4302</a>, December 2005.

   [<a id="ref-26" name="ref-26">26</a>]  Kent, S., "IP Encapsulating Security Payload (ESP)", <a href="rfc4303.html">RFC 4303</a>,
         December 2005.

   [<a id="ref-27" name="ref-27">27</a>]  Dierks, T. and E. Rescorla, "The Transport Layer Security (TLS)
         Protocol Version 1.2", <a href="rfc5246.html">RFC 5246</a>, August 2008.

   [<a id="ref-28" name="ref-28">28</a>]  Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen, "Internet Key
         Exchange Protocol Version 2 (IKEv2)", <a href="rfc5996.html">RFC 5996</a>, September 2010.





















<span class="grey">Moise &amp; Brodkin               Informational                    [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc6142.html">RFC 6142</a>          ANSI C12.22/IEEE 1703/MC12.22 Over IP       March 2011</span>


Authors' Addresses

   Avygdor Moise
   Future DOS R&amp;D Inc.
   #303 - 6707 Elbow Drive SW
   Calgary, Alberta  T2V 0E5
   Canada

   EMail: avy@fdos.ca
   URI:   <a href="http://www.fdos.ca/">http://www.fdos.ca</a>


   Jonathan Brodkin
   Future DOS R&amp;D Inc.
   #303 - 6707 Elbow Drive SW
   Calgary, Alberta  T2V 0E5
   Canada

   EMail: jonathan.brodkin@fdos.ca
   URI:   <a href="http://www.fdos.ca/">http://www.fdos.ca</a>































Moise &amp; Brodkin               Informational                    [Page 26]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.119, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc6142 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 23 Aug 2016 18:39:29 GMT --></html>