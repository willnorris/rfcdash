<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6377 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:30 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-kucherawy-dkim-lists" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:6377" name="DC.Identifier"/>
<meta content="September, 2011" name="DC.Date.Issued"/>
<meta content="Murray S. Kucherawy &lt;msk@cloudmark.com&gt;" name="DC.Creator"/>
<meta content="DomainKeys Identified Mail (DKIM) allows an administrative mail domain
(ADMD) to assume some responsibility for a message. Based on
deployment experience with DKIM, this document provides guidance for
the use of DKIM with scenarios that include Mailing List Managers
(MLMs)." name="DC.Description.Abstract"/>
<meta content="DKIM And Mailing Lists" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6377 - DKIM And Mailing Lists</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgmagenta" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6377.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6377" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-dkim-mailinglists" title="draft-ietf-dkim-mailinglists">draft-ietf-dkim...</a>] [<a href="https://datatracker.ietf.org/doc/rfc6377" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6377" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6377" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=6377">Errata</a>]</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                   BEST CURRENT PRACTICE</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Internet Engineering Task Force (IETF)                      M. Kucherawy
Request for Comments: 6377                                     Cloudmark
BCP: 167                                                  September 2011
Category: Best Current Practice
ISSN: 2070-1721


          <span class="h1">DomainKeys Identified Mail (DKIM) and Mailing Lists</span>

Abstract

   DomainKeys Identified Mail (DKIM) allows an ADministrative Management
   Domain (ADMD) to assume some responsibility for a message.  Based on
   deployment experience with DKIM, this document provides guidance for
   the use of DKIM with scenarios that include Mailing List Managers
   (MLMs).

Status of This Memo

   This memo documents an Internet Best Current Practice.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   BCPs is available in <a href="rfc5741.html#section-2">SectionÂ 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6377">http://www.rfc-editor.org/info/rfc6377</a>.

Copyright Notice

   Copyright (c) 2011 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.






<span class="grey">Kucherawy                 Best Current Practice                 [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-1.1">1.1</a>.  Background . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-1.2">1.2</a>.  MLMs in Infrastructure . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-1.3">1.3</a>.  Feedback Loops and Other Bilateral Agreements  . . . . . .  <a href="#page-5">5</a>
     <a href="#section-1.4">1.4</a>.  Document Scope and Goals . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
   <a href="#section-2">2</a>.  Definitions  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-2.1">2.1</a>.  Key Words  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-2.2">2.2</a>.  Messaging Terms  . . . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-2.3">2.3</a>.  DKIM-Specific References . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-2.4">2.4</a>.  'DKIM-Friendly'  . . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-2.5">2.5</a>.  Message Streams  . . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
   <a href="#section-3">3</a>.  Mailing Lists and DKIM . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-3.1">3.1</a>.  Roles and Realities  . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-3.2">3.2</a>.  Types of Mailing Lists . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
     <a href="#section-3.3">3.3</a>.  Current MLM Effects on Signatures  . . . . . . . . . . . . <a href="#page-10">10</a>
   <a href="#section-4">4</a>.  Non-Participating MLMs . . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
     <a href="#section-4.1">4.1</a>.  Author-Related Signing . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
     <a href="#section-4.2">4.2</a>.  Verification Outcomes at Receivers . . . . . . . . . . . . <a href="#page-12">12</a>
     <a href="#section-4.3">4.3</a>.  Handling Choices at Receivers  . . . . . . . . . . . . . . <a href="#page-13">13</a>
     <a href="#section-4.4">4.4</a>.  Wrapping a Non-Participating MLM . . . . . . . . . . . . . <a href="#page-13">13</a>
   <a href="#section-5">5</a>.  Participating MLMs . . . . . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
     <a href="#section-5.1">5.1</a>.  General  . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
     <a href="#section-5.2">5.2</a>.  DKIM Author Domain Signing Practices . . . . . . . . . . . <a href="#page-14">14</a>
     <a href="#section-5.3">5.3</a>.  Subscriptions  . . . . . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
     <a href="#section-5.4">5.4</a>.  Exceptions to ADSP Recommendations . . . . . . . . . . . . <a href="#page-15">15</a>
     <a href="#section-5.5">5.5</a>.  Author-Related Signing . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
     <a href="#section-5.6">5.6</a>.  Verification Outcomes at MLMs  . . . . . . . . . . . . . . <a href="#page-16">16</a>
     <a href="#section-5.7">5.7</a>.  Signature Removal Issues . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#section-5.8">5.8</a>.  MLM Signatures . . . . . . . . . . . . . . . . . . . . . . <a href="#page-19">19</a>
     <a href="#section-5.9">5.9</a>.  Verification Outcomes at Final Receiving Sites . . . . . . <a href="#page-20">20</a>
     <a href="#section-5.10">5.10</a>. Use with FBLs  . . . . . . . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
     <a href="#section-5.11">5.11</a>. Handling Choices at Receivers  . . . . . . . . . . . . . . <a href="#page-21">21</a>
   <a href="#section-6">6</a>.  DKIM Reporting . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-22">22</a>
   <a href="#section-7">7</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-22">22</a>
     <a href="#section-7.1">7.1</a>.  Security Considerations from DKIM and ADSP . . . . . . . . <a href="#page-22">22</a>
     <a href="#section-7.2">7.2</a>.  Authentication Results When Relaying . . . . . . . . . . . <a href="#page-23">23</a>
   <a href="#section-8">8</a>.  References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-23">23</a>
     <a href="#section-8.1">8.1</a>.  Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-23">23</a>
     <a href="#section-8.2">8.2</a>.  Informative References . . . . . . . . . . . . . . . . . . <a href="#page-23">23</a>
   <a href="#appendix-A">Appendix A</a>.  Acknowledgements  . . . . . . . . . . . . . . . . . . <a href="#page-25">25</a>
   <a href="#appendix-B">Appendix B</a>.  Example Scenarios . . . . . . . . . . . . . . . . . . <a href="#page-25">25</a>
     <a href="#appendix-B.1">B.1</a>.  MLMs and ADSP  . . . . . . . . . . . . . . . . . . . . . . <a href="#page-25">25</a>
     <a href="#appendix-B.2">B.2</a>.  MLMs and FBLs  . . . . . . . . . . . . . . . . . . . . . . <a href="#page-25">25</a>






<span class="grey">Kucherawy                 Best Current Practice                 [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   DomainKeys Identified Mail [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] allows an ADministrative Management
   Domain (ADMD) to take some responsibility for a [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>] message.  Such
   responsibility can be taken by an Author's organization, an
   operational relay (Mail Transfer Agent, or MTA), or one of their
   agents.  Assertion of responsibility is made through a cryptographic
   signature.  Message transit from Author to recipient is through
   relays that typically make no substantive change to the message
   content and thus preserve the validity of the DKIM signature.

   In contrast to relays, there are intermediaries, such as Mailing List
   Managers (MLMs), that actively take delivery of messages, reformat
   them, and repost them, often invalidating DKIM signatures.  The goal
   for this document is to explore the use of DKIM for scenarios that
   include intermediaries and recommend best current practices based on
   acquired experience.  Questions that will be discussed include:

   o  Under what circumstances is it advisable for an Author, or its
      organization, to apply DKIM to mail sent to mailing lists?

   o  What are the trade-offs regarding having an MLM verify and use
      DKIM identifiers?

   o  What are the trade-offs regarding having an MLM remove existing
      DKIM signatures prior to reposting the message?

   o  What are the trade-offs regarding having an MLM add its own DKIM
      signature?

   These are open questions for which there may be no definitive
   answers.  However, based on experience since the publication of the
   original version of [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] and its gradual deployment, there are some
   views that are useful to consider and some recommended procedures.

   In general, there are two categories of MLMs in relation to DKIM:
   participating and non-participating.  As each type has its own issues
   regarding DKIM-signed messages that are either handled or produced by
   them (or both), the types are discussed in separate sections.

   The best general recommendation for dealing with MLMs is that the MLM
   or an MTA in the MLM's domain apply its own DKIM signature to each
   message it forwards and that assessors on the receiving end consider
   the MLM's domain signature in making their assessments.  (See
   <a href="#section-5">Section 5</a>, especially <a href="#section-5.2">Section 5.2</a>.)






<span class="grey">Kucherawy                 Best Current Practice                 [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


   With the understanding that this is not always possible or practical
   and the consideration that it might not always be sufficient, this
   document provides additional guidance.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Background"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Background</span>

   DKIM signatures permit an agent of the email architecture (see
   [<a href="#ref-EMAIL-ARCH">EMAIL-ARCH</a>]) to make a claim of responsibility for a message by
   affixing a validated domain-level identifier to the message as it
   passes through a relay.  Although not the only possibility, this is
   most commonly done as a message passes through a boundary Mail
   Transport Agent (MTA) as it departs an ADministrative Management
   Domain (ADMD) across the open Internet.

   A DKIM signature will fail to verify if a portion of the message
   covered by one of its hashes is altered.  An MLM commonly alters
   messages to provide information specific to the mailing list for
   which it is providing service.  Common modifications are enumerated
   and described in <a href="#section-3.3">Section 3.3</a>.  However, note that MLMs vary widely in
   behavior and often allow subscribers to select individual behaviors.
   Further, the MTA might make changes that are independent of those
   applied by the MLM.

   The DKIM Signatures specification [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] deliberately rejects the
   notion of tying the signing domain (the "d=" tag in a DKIM signature)
   to any other identifier within a message; any ADMD that handles a
   message could sign it, regardless of its origin or Author domain.  In
   particular, DKIM does not define any meaning to the occurrence of a
   match between the content of a "d=" tag and the value of, for
   example, a domain name in the <a href="rfc5322.html">RFC5322</a>.From field, nor is there any
   obvious degraded value to a signature where they do not match.  Since
   any DKIM signature is merely an assertion of "some" responsibility by
   an ADMD, a DKIM signature added by an MLM has no more or less meaning
   than a signature with any other "d=" value.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20MLMs%20in%20Infrastructure"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  MLMs in Infrastructure</span>

   An MLM is an autonomous agent that takes delivery of a message and
   can repost it as a new message or construct a digest of it along with
   other messages to the members of the list (see [<a href="#ref-EMAIL-ARCH">EMAIL-ARCH</a>], <a href="#section-5.3">Section</a>
   <a href="#section-5.3">5.3</a>).  However, the fact that the <a href="rfc5322.html">RFC5322</a>.From field of such a
   message (in the non-digest case) is typically the same as that of the
   original message, and that recipients perceive the message as "from"
   the original Author rather than the MLM, creates confusion about
   responsibility and autonomy for the reposted message.  This has
   important implications for the use of DKIM.





<span class="grey">Kucherawy                 Best Current Practice                 [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


   <a href="#section-3.3">Section 3.3</a> describes some of the things MLMs commonly do that
   produce broken signatures, thus reducing the perceived value of DKIM.

   Further, while there are published standards that are specific to MLM
   behavior (e.g., [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>], [<a href="#ref-LIST-ID" title='"List-Id: A Structured Field and Namespace for the Identification of Mailing Lists"'>LIST-ID</a>], and [<a href="#ref-LIST-URLS">LIST-URLS</a>]), their adoption
   has been spotty at best.  Hence, efforts to specify the use of DKIM
   in the context of MLMs need to be incremental and value-based.

   Some MLM behaviors are well-established and their effects on DKIM
   signature validity can be argued as frustrating wider DKIM adoption.
   Still, those behaviors are not standards violations.  Hence, this
   memo specifies practices for all parties involved, defining the
   minimum changes possible to MLMs themselves.

   A DKIM signature on a message is an expression of some responsibility
   for the message taken by the signing domain.  An open issue that is
   addressed by this document is the ways a signature might be used by a
   recipient's evaluation module, after the message has gone through a
   mailing list and might or might not have been rendered invalid.  The
   document also considers how invalidation might have happened.

   Note that where in this document there is discussion of an MLM
   conducting validation of DKIM signatures or Author Domain Signing
   Practices ([<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>]) policies, the actual implementation could be one
   where the validation is done by the MTA or an agent attached to it,
   and the results of that work are relayed by a trusted channel not
   specified here.  See [<a href="#ref-AUTH-RESULTS">AUTH-RESULTS</a>] for a discussion of this.  This
   document does not favor any particular arrangement of these agents
   over another; it merely talks about the MLM itself doing the work as
   a matter of simplicity.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20Feedback%20Loops%20and%20Other%20Bilateral%20Agreements"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  Feedback Loops and Other Bilateral Agreements</span>

   A Feedback Loop (FBL) is a bilateral agreement between two parties to
   exchange reports of abuse.  Typically, a sender registers with a
   receiving site to receive abuse reports from that site for mail
   coming from the sender.

   An FBL reporting address (i.e., an address to which FBL reports are
   sent) is part of this bilateral registration.  Some FBLs require DKIM
   use by the registrant.

   See <a href="#section-6">Section 6</a> for additional discussion.

   FBLs tend to use the [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>] or the [<a href="#ref-IODEF" title='"The Incident Object Description Exchange Format"'>IODEF</a>] formats.






<span class="grey">Kucherawy                 Best Current Practice                 [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.4.%20%20Document%20Scope%20and%20Goals"></a><a class="selflink" href="#section-1.4" name="section-1.4">1.4</a>.  Document Scope and Goals</span>

   This document provides discussion on the above issues to improve the
   handling of possible interactions between DKIM and MLMs.  In general,
   the preference is to impose changes to behavior at the Signer and
   Verifier rather than at the MLM.

   Wherever possible, the document's discussion of MLMs is conceptually
   decoupled from MTAs despite the very tight integration that is
   sometimes observed in implementation.  This is done to emphasize the
   functional independence of MLM services and responsibilities from
   those of an MTA.

   Parts of this document explore possible changes to common practice by
   Signers, Verifiers, and MLMs.  The suggested enhancements are largely
   predictive in nature, taking into account the current email
   infrastructure, the facilities DKIM can provide as it gains wider
   deployment, and working group consensus.  There is no substantial
   implementation history upon which these suggestions are based, and
   their efficacy, performance, and security characteristics have not
   yet been fully explored.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Definitions"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Definitions</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Key%20Words"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Key Words</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   [<a href="#ref-KEYWORDS" title='"Key words for use in RFCs to Indicate Requirement Levels"'>KEYWORDS</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Messaging%20Terms"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Messaging Terms</span>

   See [<a href="#ref-EMAIL-ARCH">EMAIL-ARCH</a>] for a general description of the current messaging
   architecture and for definitions of various terms used in this
   document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20DKIM-Specific%20References"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  DKIM-Specific References</span>

   Readers are encouraged to become familiar with [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] and [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>],
   which are core specification documents, as well as [<a href="#ref-DKIM-OVERVIEW">DKIM-OVERVIEW</a>]
   and [<a href="#ref-DKIM-DEPLOYMENT">DKIM-DEPLOYMENT</a>], which are DKIM's primary tutorial documents.









<span class="grey">Kucherawy                 Best Current Practice                 [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.4.%20%20%27DKIM-Friendly%27"></a><a class="selflink" href="#section-2.4" name="section-2.4">2.4</a>.  'DKIM-Friendly'</span>

   The term "DKIM-friendly" is used to describe an email intermediary
   that, when handling a message, makes no changes to the message that
   cause valid [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] signatures present on the message on input to fail
   to verify on output.

   Various features of MTAs and MLMs seen as helpful to users often have
   side effects that do render DKIM signatures unverifiable.  These
   would not qualify for this label.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.5.%20%20Message%20Streams"></a><a class="selflink" href="#section-2.5" name="section-2.5">2.5</a>.  Message Streams</span>

   A "message stream" identifies a group of messages originating from
   within an ADMD that are distinct in intent, origin, and/or use and
   partitions them somehow (e.g., via changing the value in the "d=" tag
   value in the context of DKIM) so as to keep them associated to users
   yet distinct in terms of their evaluation and handling by Verifiers
   or Receivers.

   A good example might be user mail generated by a company's employees,
   versus operational or transactional mail that comes from automated
   sources or marketing or sales campaigns.  Each of these could have
   different sending policies imposed against them, or there might be a
   desire to insulate one from the other (e.g., a marketing campaign
   that gets reported by many spam filters could cause the marketing
   stream's reputation to degrade without automatically punishing the
   transactional or user streams).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Mailing%20Lists%20and%20DKIM"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Mailing Lists and DKIM</span>

   It is important to make some distinctions among different styles of
   intermediaries, their typical implementations, and the effects they
   have in a DKIM-aware environment.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Roles%20and%20Realities"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Roles and Realities</span>

   Across DKIM activities, there are several key roles in the transit of
   a message.  Most of these are defined in [<a href="#ref-EMAIL-ARCH">EMAIL-ARCH</a>] but are
   reviewed here for quick reference.

   Author:  The agent that provided the content of the message being
      sent through the system.  The Author delivers that content to the
      Originator in order to begin a message's journey to its intended
      final recipients.  The Author can be a human using an MUA (Mail
      User Agent) or an automated process that may send mail (for
      example, the "cron" Unix system utility).




<span class="grey">Kucherawy                 Best Current Practice                 [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


   Originator:  The agent that accepts a message from the Author,
      ensures it conforms to the relevant standards such as [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>], and
      then sends it toward its destination(s).  This is often referred
      to as the Mail Submission Agent (MSA).

   Signer:  Any agent that affixes one or more DKIM signature(s) to a
      message on its way toward its ultimate destination.  There is
      typically a Signer running at the MTA that sits between the
      Author's ADMD and the general Internet.  The Originator and/or
      Author might also be a Signer.

   Verifier:  Any agent that conducts DKIM signature validation.  One is
      typically running at the MTA that sits between the public Internet
      and the Receiver's ADMD.  Note that any agent that handles a
      signed message can conduct verification; this document only
      considers that action and its outcomes either at an MLM or at the
      Receiver.  Filtering decisions could be made by this agent based
      on verification results.

   Receiver:  The agent that is the final transit relay for the message
      and performs final delivery to the recipient(s) of the message.
      Filtering decisions based on results made by the Verifier could be
      applied by the Receiver.  The Verifier and the Receiver could be
      the same agent.  This is sometimes the same as or coupled with the
      Mail Delivery Agent (MDA).

   In the case of simple user-to-user mail, these roles are fairly
   straightforward.  However, when one is sending mail to a list and the
   mail then gets relayed to all of that list's subscribers, the roles
   are often less clear to the general user as particular agents may
   hold multiple important but separable roles.  The above definitions
   are intended to enable more precise discussion of the mechanisms
   involved.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Types%20of%20Mailing%20Lists"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Types of Mailing Lists</span>

   There are four common MLM implementation modes:

   aliasing:  An aliasing MLM (see Section 5.1 of [<a href="#ref-EMAIL-ARCH">EMAIL-ARCH</a>]) is one
      that makes no changes to the message itself as it redistributes;
      any modifications are constrained to changes to the [<a href="#ref-SMTP" title='"Simple Mail Transfer Protocol"'>SMTP</a>]
      envelope recipient list (RCPT commands) only.  There are no
      changes to the message header or body at all, except for the
      addition of [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>] trace header fields.  The output of such an MLM
      is considered to be a continuation of the Author's original
      message transit.  An example of such an MLM is an address that





<span class="grey">Kucherawy                 Best Current Practice                 [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


      expands directly in the MTA, such as a list of local system
      administrators used for relaying operational or other internal-
      only messages.  See also Section 3.9.2 of [<a href="#ref-SMTP" title='"Simple Mail Transfer Protocol"'>SMTP</a>].

   resending:  A resending MLM (see Sections <a href="#section-5.2">5.2</a> and <a href="#section-5.3">5.3</a> of
      [<a href="#ref-EMAIL-ARCH">EMAIL-ARCH</a>]) is one that may make changes to a message.  The
      output of such an MLM is considered to be a new message; delivery
      of the original has been completed prior to distribution of the
      reposted message.  Such messages are often reformatted, such as
      with list-specific header fields or other properties, to
      facilitate discussion among list subscribers.

   authoring:  An authoring MLM is one that creates the content being
      sent as well as initiating its transport, rather than basing it on
      one or more messages received earlier.  This is not a "mediator"
      in terms of [<a href="#ref-EMAIL-ARCH">EMAIL-ARCH</a>] since it originates the message, but
      after creation, its message processing and posting behavior
      otherwise do match the MLM paradigm.  Typically, replies are not
      generated, or if they are, they go to a specific recipient and not
      back to the list's full set of recipients.  Examples include
      newsletters and bulk marketing mail.

   digesting:  A special case of the resending MLM is one that sends a
      single message comprising an aggregation of recent MLM
      submissions, which might be a message of [<a href="#ref-MIME" title='"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"'>MIME</a>] type "multipart/
      digest" (see [<a href="#ref-MIME-TYPES">MIME-TYPES</a>]).  This is obviously a new message, but
      it may contain a sequence of original messages that may themselves
      have been DKIM-signed.

   In the remainder of this document, we distinguish two relevant steps
   corresponding to the following SMTP transactions:

   MLM Input:  Originating user is Author; originating ADMD is
      Originator and Signer; MLM's ADMD is Verifier; MLM's input
      function is Receiver.

   MLM Output:  MLM (sending its reconstructed copy of the originating
      user's message) is Author; MLM's ADMD is Originator and Signer;
      the ADMD of each subscriber of the list is a Verifier; each
      subscriber is a Receiver.

   Much of this document focuses on the resending class of MLM as it has
   the most direct conflict operationally with DKIM.

   The dissection of the overall MLM operation into these two distinct
   phases allows the DKIM-specific issues with respect to MLMs to be
   isolated and handled in a logical way.  The main issue is that the
   repackaging and reposting of a message by an MLM is actually the



<span class="grey">Kucherawy                 Best Current Practice                 [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


   construction of a completely new message, and as such, the MLM is
   introducing new content into the email ecosystem, consuming the
   Author's copy of the message, and creating its own.  When considered
   in this way, the dual role of the MLM and its ADMD becomes clear.

   Some issues about these activities are discussed in Section 3.6.4 of
   [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>] and in <a href="#section-3.4.1">Section 3.4.1</a> of [<a href="#ref-EMAIL-ARCH">EMAIL-ARCH</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Current%20MLM%20Effects%20on%20Signatures"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Current MLM Effects on Signatures</span>

   As described above, an aliasing MLM does not affect any existing
   signature, and an authoring MLM is always creating new content; thus,
   there is never an existing signature.  However, the changes a
   resending MLM typically makes affect the <a href="rfc5322.html">RFC5322</a>.Subject header
   field, the addition of some list-specific header fields, and/or the
   modification of the message body.  The effects of each of these on
   DKIM verification are discussed below.

   Subject tags:  A popular feature of MLMs is the "tagging" of an
      <a href="rfc5322.html">RFC5322</a>.Subject field by prefixing the field's contents with the
      name of the list, such as "[example]" for a list called "example".
      Altering the <a href="rfc5322.html">RFC5322</a>.Subject field on new submissions by adding a
      list-specific prefix or suffix will invalidate the Signer's
      signature if that header field was included in the hash when
      creating that signature.  Section 5.5 of [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] lists
      <a href="rfc5322.html">RFC5322</a>.Subject as one that should be covered as it contains
      important user-visible text, so this is expected to be an issue
      for any list that makes such changes.

   List-specific header fields:  Some lists will add header fields
      specific to list administrative functions such as those defined in
      [<a href="#ref-LIST-ID" title='"List-Id: A Structured Field and Namespace for the Identification of Mailing Lists"'>LIST-ID</a>] and [<a href="#ref-LIST-URLS">LIST-URLS</a>] or the "Resent-" fields defined in
      [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>].  It is unlikely that a typical MUA would include such
      fields in an original message, and DKIM is resilient to the
      addition of header fields in general (see notes about the "h=" tag
      in Section 3.5 of [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>]).  Therefore, this is not seen as a
      concern.

   Other header fields:  Some lists will add or replace header fields
      such as "Reply-To" or "Sender" in order to establish that the
      message is being sent in the context of the mailing list, so that
      the list is identified ("Sender") and any user replies go to the
      list ("Reply-To").  If these fields were included in the original
      message, it is possible that one or more of them may have been
      included in the signature hash, and those signatures will thus be
      broken.





<span class="grey">Kucherawy                 Best Current Practice                [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


   Minor body changes:  Some lists prepend or append a few lines to each
      message to remind subscribers of an administrative URL for
      subscription issues, of list policy, etc.  Changes to the body
      will alter the body hash computed at the DKIM Verifier, so these
      will render any existing signatures that cover those portions of
      the message body unverifiable.  [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] includes the capability to
      limit the length of the body covered by its body hash so that
      appended text will not interfere with signature validation, but
      this has security implications.

   Major body changes:  There are some MLMs that make more substantial
      changes to message bodies when preparing them for redistribution,
      such as adding, deleting, reordering, or reformatting [<a href="#ref-MIME" title='"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"'>MIME</a>]
      parts, "flattening" HTML messages into plain text, or inserting
      headers or footers within HTML messages.  Most or all of these
      changes will invalidate a DKIM signature.

   MIME part removal:  Some MLMs that are MIME-aware will remove large
      MIME parts from submissions and replace them with URLs to reduce
      the size of the distributed form of the message and to prevent
      inadvertent automated malware delivery.  Except in some cases
      where a body length limit is applied in generation of the DKIM
      signature, the signature will be broken.

   There reportedly still exist some mailing lists in operation that are
   actually run manually by a human list manager, whose workings in
   preparing a message for distribution could include the above or even
   some other changes.

   In general, absent a general movement by MLM developers and operators
   toward more DKIM-friendly practices, an MLM subscriber cannot expect
   signatures applied before the message was processed by the MLM to be
   valid on delivery to a Receiver.  Such an evolution is not expected
   in the short term due to general development and deployment inertia.
   Moreover, even if an MLM currently passes messages unmodified such
   that Author signatures validate, it is possible that a configuration
   change or software upgrade to that MLM will cause that no longer to
   be true.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Non-Participating%20MLMs"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Non-Participating MLMs</span>

   This section contains a discussion of issues regarding sending DKIM-
   signed mail to or through an MLM that is not DKIM-aware.
   Specifically, the header fields introduced by [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] and
   [<a href="#ref-AUTH-RESULTS">AUTH-RESULTS</a>] carry no special meaning to such an MLM.






<span class="grey">Kucherawy                 Best Current Practice                [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Author-Related%20Signing"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Author-Related Signing</span>

   In an idealized world, if an Author knows that the MLM to which a
   message is being sent is a non-participating resending MLM, the
   Author needs to be cautious when deciding whether or not to send a
   signed message to the list.  The MLM could make a change that would
   invalidate the Author's signature but not remove it prior to
   redistribution.  Hence, list recipients would receive a message
   purportedly from the Author but bearing a DKIM signature that would
   not verify.  Some mail filtering software incorrectly penalizes a
   message containing a DKIM signature that fails verification.  This
   may have detrimental effects outside of the Author's control.
   (Additional discussion of this is below.)  This problem can be
   compounded if there are Receivers that apply signing policies (e.g.,
   [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>]) and the Author publishes any kind of strict policy, i.e., a
   policy that requests that Receivers reject or otherwise deal severely
   with non-compliant messages.

   For domains that do publish strict ADSP policies, the originating
   site SHOULD use a separate message stream (see <a href="#section-2.5">Section 2.5</a>), such as
   a signing and Author subdomain, for the "personal" mail -- a
   subdomain that is different from domain(s) used for other mail
   streams.  This allows each to develop an independent reputation, and
   more stringent policies (including ADSP) can be applied to the mail
   stream(s) that do not go through mailing lists or perhaps do not get
   signed at all.

   However, all of this presupposes a level of infrastructure
   understanding that is not expected to be common.  Thus, it will be
   incumbent upon site administrators to consider how support of users
   wishing to participate in mailing lists might be accomplished as DKIM
   achieves wider adoption.

   In general, the stricter practices and policies are likely to be
   successful only for the mail streams subject to the most end-to-end
   control by the originating organization.  That typically excludes
   mail going through MLMs.  Therefore, site administrators wishing to
   employ ADSP with a "discardable" setting SHOULD separate the
   controlled mail stream warranting this handling from other mail
   streams that are less controlled, such as personal mail that transits
   MLMs.  (See also <a href="#section-5.7">Section 5.7</a> below.)

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Verification%20Outcomes%20at%20Receivers"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Verification Outcomes at Receivers</span>

   There is no reliable way to determine that a piece of mail arrived
   via a non-participating MLM.  Sites whose users subscribe to non-
   participating MLMs SHOULD ensure that such user mail streams are not
   subject to strict DKIM-related handling policies.



<span class="grey">Kucherawy                 Best Current Practice                [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Handling%20Choices%20at%20Receivers"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Handling Choices at Receivers</span>

   In order to exempt some mail from the expectation of signature
   verification, as discussed in <a href="#section-4.1">Section 4.1</a>, receiving ADMDs would need
   to register non-participating lists and confirm that mail transited
   them.  However, such an approach requires excessive effort and even
   then is likely to be unreliable.  Hence, it is not a scalable
   solution.

   Any treatment of a verification failure as having special meaning is
   a violation of the basic DKIM Signatures specification [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>].  The
   only valid, standardized basis for going beyond that specification is
   with specific ADSP direction.

   Use of restrictive domain policies such as [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>] "discardable"
   presents an additional challenge.  In that case, when a message is
   unsigned or the signature can no longer be verified, discarding of
   the message is requested.  There is no exception in the policy for a
   message that may have been altered by an MLM, nor is there a reliable
   way to identify such mail.  Therefore, participants SHOULD honor the
   policy and disallow the message.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.4.%20%20Wrapping%20a%20Non-Participating%20MLM"></a><a class="selflink" href="#section-4.4" name="section-4.4">4.4</a>.  Wrapping a Non-Participating MLM</span>

   One approach for adding DKIM support to an otherwise non-
   participating MLM is to "wrap" the MLM or, in essence, place it
   between other DKIM-aware components (such as MTAs) that provide some
   DKIM services.  For example, the ADMD operating a non-participating
   MLM could have its DKIM Verifier act on messages from list
   subscribers, enforcing some of the features and recommendations of
   <a href="#section-5">Section 5</a> on behalf of the MLM, and the MTA or MSA receiving the MLM
   Output could also add a DKIM signature for the MLM's domain.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Participating%20MLMs"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Participating MLMs</span>

   This section contains a discussion of issues regarding DKIM-signed
   mail that transits an MLM that is DKIM-aware.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20General"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  General</span>

   Changes that merely add new header fields, such as those specified by
   [<a href="#ref-LIST-ID" title='"List-Id: A Structured Field and Namespace for the Identification of Mailing Lists"'>LIST-ID</a>], [<a href="#ref-LIST-URLS">LIST-URLS</a>], and [<a href="#ref-MAIL" title='"Internet Message Format"'>MAIL</a>], are generally the most friendly
   to a DKIM-participating email infrastructure.  Their addition by an
   MLM will not affect any existing DKIM signatures unless those fields
   were already present and covered by a signature's hash, or a
   signature was created specifically to disallow their addition (see
   the note about "h=" in Section 3.5 of [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>]).




<span class="grey">Kucherawy                 Best Current Practice                [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


   However, the practice of applying headers and footers to message
   bodies is common and not expected to fade regardless of what
   documents any standards body might produce.  This sort of change will
   invalidate the signature on a message where the body hash covers the
   entire message.  Thus, the following sections also discuss and
   suggest other processing alternatives.

   A possible mitigation to this incompatibility is use of the "l=" tag
   to bound the portion of the body covered by the DKIM body hash, but
   this is not workable for [<a href="#ref-MIME" title='"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"'>MIME</a>] messages; moreover, it has security
   considerations (see Section 3.5 of [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>]).  Therefore, its use is
   discouraged.

   Expressions of list-specific policy (e.g., rules for participation,
   small advertisements, etc.) are often added to outgoing messages by
   MLM operators.  There is currently no header field proposed for
   relaying such general operational MLM details apart from what
   [<a href="#ref-LIST-URLS">LIST-URLS</a>] already supports.  This sort of information is commonly
   included footer text appended to the body of the message or header
   text prepended above the original body.  It is RECOMMENDED that
   periodic, automatic mailings to the list are sent to remind
   subscribers of list policy.  It is also RECOMMENDED that standard
   header fields, rather than body changes, be used to express list
   operation parameters.  These periodic mailings will be repetitive, of
   course, but by being generally the same each time, they can be easily
   filtered if desired.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20DKIM%20Author%20Domain%20Signing%20Practices"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  DKIM Author Domain Signing Practices</span>

   ADSP presents a particular challenge.  An Author domain posting a
   policy of "discardable" imposes a very tight restriction on the use
   of mailing lists, essentially constraining that domain's users to
   lists operated by aliasing MLMs only; any MLM that alters a message
   from such a domain or removes its signature subjects the message to
   severe action by Verifiers or Receivers.  A resending MLM SHOULD
   reject outright any mail from an Author whose domain posts such a
   policy, as those messages are likely to be discarded or rejected by
   any ADSP-aware recipients.  See also the discussion in <a href="#section-5.3">Section 5.3</a>.

   Where such rejection of "discardable" mail is not enforced, and such
   mail arrives to a Verifier that applies ADSP checks that fail, the
   message SHOULD be either discarded (i.e., accept the message at the
   [<a href="#ref-SMTP" title='"Simple Mail Transfer Protocol"'>SMTP</a>] level but discard it without delivery) or rejected by
   returning a 5xx error code.  In the latter case, some advice for how
   to conduct the rejection in a potentially meaningful way can be found
   in <a href="#section-5.11">Section 5.11</a>.





<span class="grey">Kucherawy                 Best Current Practice                [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


   The reason for these recommendations is best illustrated by example.
   Suppose the following:

   o  users U1 and U2 are subscribers of list L;

   o  U1 is within an ADMD that advertises a "discardable" policy using
      ADSP;

   o  L alters submissions prior to resending in a way that invalidates
      the DKIM signature added by U1's ADMD;

   o  U2's ADMD enforces ADSP at the border by issuing an SMTP error
      code; and

   o  L is configured to remove subscribers whose mail is bouncing.

   It follows then that a submission to L from U1 will be received at
   U2, but since the DKIM signature fails to verify, U2's ADMD will
   reject it based on the ADSP protocol.  That rejection is received at
   L, which proceeds to remove U2 from the list.

   See also <a href="#appendix-B.5">Appendix B.5</a> of [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>] for further discussion.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Subscriptions"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Subscriptions</span>

   At subscription time, an ADSP-aware MLM SHOULD check for a published
   ADSP record for the new subscriber's domain.  If the policy specifies
   "discardable", the MLM SHOULD disallow the subscription or present a
   warning that the subscriber's submissions to the mailing list might
   not be deliverable to some recipients because of the published policy
   of the subscriber's ADMD.

   Of course, such a policy record could be created after subscription,
   so this is not a universal solution.  An MLM implementation MAY do
   periodic checks of its subscribers and issue warnings where such a
   policy is detected or simply check upon each submission.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20Exceptions%20to%20ADSP%20Recommendations"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  Exceptions to ADSP Recommendations</span>

   Where an ADMD has established some out-of-band trust agreement with
   another ADMD such that an Authentication-Results field applied by one
   is trusted by the other, the above recommendations for MLM operation
   with respect to ADSP do not apply because it is then possible to
   establish whether or not a valid Author signature can be inferred
   even if one is not present on receipt.






<span class="grey">Kucherawy                 Best Current Practice                [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


   For example, suppose domains example.com and example.net have an
   explicit agreement to trust one another's authentication assertions.
   Now, consider a message with an <a href="rfc5322.html">RFC5322</a>.From domain of "example.org"
   that is also bearing a valid DKIM signature by the same domain, which
   arrives at a mailing list run by example.com.  Upon evaluation,
   example.com validates the signature and adds an [<a href="#ref-AUTH-RESULTS">AUTH-RESULTS</a>] field
   indicating this.  However, the MLM also makes changes to the message
   body that invalidate the signature.  The MLM then re-signs the
   modified message using DKIM and sends it on to the list's
   subscribers, one of whom is at example.net.

   On arrival at example.net, the DKIM signature for example.org is no
   longer valid, so ADSP would generally fail.  However, example.net
   trusts the assertion of example.com's Authentication-Results field
   that indicated that there was a valid signature from example.org, so
   the ADSP failure can be ignored.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.5.%20%20Author-Related%20Signing"></a><a class="selflink" href="#section-5.5" name="section-5.5">5.5</a>.  Author-Related Signing</span>

   An important consideration is that Authors rarely have any direct
   influence over the management of an MLM.  Specifically, the behavior
   of an intermediary (e.g., an MLM that is not careful about filtering
   out junk mail or being diligent about unsubscription requests) can
   trigger recipient complaints that reflect back on those agents that
   appear to be responsible for the message, in this case an Author via
   the address found in the <a href="rfc5322.html">RFC5322</a>.From field.  In the future, as DKIM
   signature outputs (i.e., the signing domain) are used as inputs to
   reputation modules, there may be a desire to insulate one's
   reputation from influence by the unknown results of sending mail
   through an MLM.  In that case, Authors SHOULD create a mail stream
   specifically used for generating DKIM signatures when sending traffic
   to MLMs.

   This suggestion can be made more general.  Mail that is of a
   transactional or generally end-to-end nature, and not likely to be
   forwarded around by either MLMs or users, SHOULD be signed with a
   mail stream identifier different from that used for a stream that
   serves more varied uses.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.6.%20%20Verification%20Outcomes%20at%20MLMs"></a><a class="selflink" href="#section-5.6" name="section-5.6">5.6</a>.  Verification Outcomes at MLMs</span>

   MLMs typically attempt to authenticate messages posted through them.
   They usually do this through the trivial (and insecure) means of
   verifying the <a href="rfc5322.html">RFC5322</a>.From field email address (or, less frequently,
   the <a href="rfc5321.html">RFC5321</a>.MailFrom parameter) against a list subscription registry.
   DKIM enables a stronger form of authentication: the MLM can require
   that messages using a given <a href="rfc5322.html">RFC5322</a>.From address also have a DKIM




<span class="grey">Kucherawy                 Best Current Practice                [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


   signature with a corresponding "d=" domain.  This feature would be
   somewhat similar to using ADSP, except that the requirement for it
   would be imposed by the MLM and not the Author's organization.

   (Note, however, that this goes beyond DKIM's documented semantics.
   It is presented as a possible workable enhancement.)

   As described, the MLM might conduct DKIM verification of a signed
   message to attempt to confirm the identity of the Author.  Although
   it is a common and intuitive conclusion, few signed messages will
   include an Author signature (see [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>]).  MLM implementers adding
   such support would have to accommodate this.  For example, an MLM
   might be designed to accommodate a list of possible signing domains
   (the "d=" portion of a DKIM signature) for a given Author and
   determine at verification time if any of those are present.  This
   enables a more reliable method of authentication at the expense of
   having to store a mapping of authorized signing domains for
   subscribers and trusting that it will be kept current.

   A message that cannot be thus authenticated MAY be held for
   moderation or rejected outright.

   This logic could apply to any list operation, not just list
   submission.  In particular, this improved authentication MAY apply to
   subscription, unsubscription, and/or changes to subscriber options
   that are sent via email rather than through an authenticated,
   interactive channel such as the web.

   In the case of verification of signatures on submissions, MLMs SHOULD
   add an [<a href="#ref-AUTH-RESULTS">AUTH-RESULTS</a>] header field to indicate the signature(s)
   observed on the submission as it arrived at the MLM and what the
   outcome of the evaluation was.  Downstream agents might or might not
   trust the content of that header field depending on their own a
   priori knowledge of the operation of the ADMD generating (and,
   preferably, signing) that header field.  See [<a href="#ref-AUTH-RESULTS">AUTH-RESULTS</a>] for
   further discussion.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.7.%20%20Signature%20Removal%20Issues"></a><a class="selflink" href="#section-5.7" name="section-5.7">5.7</a>.  Signature Removal Issues</span>

   A message that arrives signed with DKIM means some domain prior to
   MLM Input has made a claim of some responsibility for the message.
   An obvious benefit to leaving the input-side signatures intact, then,
   is to preserve that original assertion of responsibility for the
   message so that the Receivers of the final message have an
   opportunity to evaluate the message with that information available
   to them.





<span class="grey">Kucherawy                 Best Current Practice                [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


   However, if the MLM is configured to make changes to the message
   prior to reposting that would invalidate the original signature(s),
   further action is RECOMMENDED to prevent invalidated signatures from
   arriving at final recipients, possibly triggering unwarranted filter
   actions.  (Note, however, that such filtering actions are plainly
   wrong; [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] stipulates that an invalid signature is to be treated
   as no signature at all.)

   A possible solution would be to:

   1.  Attempt verification of all DKIM signatures present on the input
       message;

   2.  Apply local policy to authenticate the identity of the Author;

   3.  Remove all existing [<a href="#ref-AUTH-RESULTS">AUTH-RESULTS</a>] fields (optional);

   4.  Add an [<a href="#ref-AUTH-RESULTS">AUTH-RESULTS</a>] header field to the message to indicate the
       results of the above;

   5.  Remove all previously evaluated DKIM signatures;

   6.  Affix a new signature that includes in its hashes the entire
       message on the output side, including the Authentication-Results
       header field just added (see <a href="#section-5.8">Section 5.8</a>).

   Removing the original signature(s) seems particularly appropriate
   when the MLM knows it is likely to invalidate any or all of them due
   to the nature of the reformatting it will do.  This avoids false
   negatives for list subscribers in their roles as Receivers of the
   message; although [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] stipulates that an invalid signature is the
   same as no signature, it is anticipated that there will be some
   implementations that ignore this advice.

   The MLM could re-evaluate existing signatures after making its
   message changes to determine whether or not any of them have been
   invalidated.  The cost of this is reduced by the fact that,
   presumably, the necessary public keys have already been downloaded
   and one or both of the message hashes could be reused.

   Per the discussion in [<a href="#ref-AUTH-RESULTS">AUTH-RESULTS</a>], a Receiver's choice to put any
   faith in the veracity of the header field requires an a priori
   assessment of the agent that created it.  Absent that assessment, a
   Receiver cannot interpret the field as valid.  Thus, the final
   recipients of the message have no way to verify on their own the
   authenticity of the Author's identity on that message.  However, if
   that field is the only one on the message when the Verifier gets it,
   and the Verifier explicitly trusts the Signer that included the



<span class="grey">Kucherawy                 Best Current Practice                [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


   Authentication-Results field in its header hash (in this case, the
   MLM), the Verifier is in a position to believe that a valid Author
   signature was present on the message.

   This can be generalized as follows: a Receiver SHOULD consider only
   [<a href="#ref-AUTH-RESULTS">AUTH-RESULTS</a>] fields bearing an authserv-id that appears in a list
   of sites the Receiver trusts and that is also included in the header
   hash of a [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] signature added by a domain in the same trusted
   list.

   Since an aliasing MLM makes no substantive changes to a message, it
   need not consider the issue of signature removal as the original
   signatures should at least arrive to the next MTA unmodified.  It is
   possible that future domain-based reputations would prefer a richer
   data set on receipt of a message, and, in that case, signature
   removal would be undesirable.

   An authoring MLM is closed to outside submitters; thus, much of this
   discussion does not apply in that case.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.8.%20%20MLM%20Signatures"></a><a class="selflink" href="#section-5.8" name="section-5.8">5.8</a>.  MLM Signatures</span>

   DKIM-aware resending MLMs and authoring MLMs SHOULD affix their own
   signatures when distributing messages.  The MLM is responsible for
   the alterations it makes to the original messages it is resending and
   should express this via a signature.  This is also helpful for
   getting feedback from any FBLs that might be set up so that undesired
   list mail can generate appropriate action.

   MLM signatures will likely be used by recipient systems to recognize
   list mail, and they give the MLM's ADMD an opportunity to develop a
   good reputation for the list itself.

   A signing MLM, as any other MLM, is free to omit redistribution of a
   message if that message was not signed in accordance with its own
   local configuration or policy.  It could also redistribute but not
   sign such mail.  However, selective signing is NOT RECOMMENDED;
   essentially that would create two message streams from the MLM, one
   signed and one not, which can confuse DKIM-aware Verifiers and
   Receivers.

   A signing MLM could add a List-Post: header field (see [<a href="#ref-LIST-URLS">LIST-URLS</a>])
   using the DNS domain matching the one used in the "d=" tag of the
   DKIM signature that is added by the MLM.  This can be used by
   Verifiers or Receivers to identify the DKIM signature that was added
   by the MLM.  This is not required, however; it is believed the





<span class="grey">Kucherawy                 Best Current Practice                [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


   reputation of the Signer will be a more critical data point than this
   suggested binding.  Furthermore, this is not a binding recognized by
   any current specification document.

   A DKIM-aware resending MLM SHOULD sign the entire message after the
   message is prepared for distribution (i.e., the MLM Output from
   <a href="#section-3.2">Section 3.2</a>).  Any other configuration might generate signatures that
   will not validate.

   DKIM-aware authoring MLMs sign the mail they send according to the
   regular signing guidelines given in [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>].

   One concern is that having an MLM apply its signature to unsigned
   mail might cause some Verifiers or Receivers to interpret the
   signature as conferring more authority or authenticity to the message
   content than is defined by [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>].  This is an issue beyond MLMs and
   primarily entails receive-side processing outside of the scope of
   [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>].  It is, nevertheless, worth noting here.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.9.%20%20Verification%20Outcomes%20at%20Final%20Receiving%20Sites"></a><a class="selflink" href="#section-5.9" name="section-5.9">5.9</a>.  Verification Outcomes at Final Receiving Sites</span>

   In general, Verifiers and Receivers SHOULD treat a signed message
   from an MLM like any other signed message; indeed, it would be
   difficult to discern any difference since specifications such as
   [<a href="#ref-LIST-URLS">LIST-URLS</a>] and [<a href="#ref-LIST-ID" title='"List-Id: A Structured Field and Namespace for the Identification of Mailing Lists"'>LIST-ID</a>] are not universally deployed and can be
   trivially spoofed.

   However, because the Author domain will commonly be different from
   the MLM's signing domain, there may be a conflict with [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>] as
   discussed in Sections <a href="#section-4.3">4.3</a> and <a href="#section-5.7">5.7</a>, especially where an ADMD has
   misused ADSP.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.10.%20%20Use%20with%20FBLs"></a><a class="selflink" href="#section-5.10" name="section-5.10">5.10</a>.  Use with FBLs</span>

   An FBL operator might wish to act on a complaint from a user about a
   message sent to a list.  Some FBLs could choose to generate feedback
   reports based on DKIM verifications in the subject message.  Such
   operators SHOULD send a report to each domain with a valid signature
   that has an FBL agreement established, as DKIM signatures are claims
   of some responsibility for that message.  Because Authors generally
   have limited control over the operation of a list, this point makes
   MLM signing all the more important.

   MLM operators SHOULD register with FBLs from major service providers.
   In the context of DKIM, there SHOULD be an exchange of information
   with the FBL provider including what signing domain the MLM will use,
   if any.




<span class="grey">Kucherawy                 Best Current Practice                [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


   Where the FBL wishes to be more specific, it MAY act solely on a DKIM
   signature where the signing domain matches the DNS domain found in a
   List-Post: header field (or similar).

   Use of FBLs in this way SHOULD be made explicit to list subscribers.
   For example, if it is the policy of the MLM's ADMD to handle an FBL
   item by unsubscribing the user that was the apparent sender of the
   offending message, advising subscribers of this in advance would help
   to avoid surprises later.

   A DKIM-signed message sent to an MLM, and then distributed to all of
   a list's recipients, could result in a complaint from one of the
   final recipients for some reason.  This could be an actual complaint
   from some subscriber that finds the message abusive or otherwise
   undesirable, or it could be an automated complaint such as Receiver
   detection of an invalidated DKIM signature or some other condition.
   It could also be a complaint that results from antagonistic behavior,
   such as is common when a subscriber to a list is having trouble
   unsubscribing and then begins issuing complaints about all
   submissions to the list.  This would result in a complaint being
   generated in the context of an FBL report back to the message Author.
   However, the original Author has no involvement in operation of the
   MLM itself, meaning the FBL report is not actionable and is thus
   undesirable.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.11.%20%20Handling%20Choices%20at%20Receivers"></a><a class="selflink" href="#section-5.11" name="section-5.11">5.11</a>.  Handling Choices at Receivers</span>

   A recipient that explicitly trusts signatures from a particular MLM
   MAY wish to extend that trust to an [<a href="#ref-AUTH-RESULTS">AUTH-RESULTS</a>] header field
   signed by that MLM.  The recipient MAY then do additional processing
   of the message, using the results recorded in the Authentication-
   Results header field instead of the original Author's DKIM signature.
   This includes possibly processing the message as per ADSP
   requirements.

   Receivers SHOULD ignore or remove all unsigned externally applied
   Authentication-Results header fields and those not signed by an ADMD
   that can be trusted by the Receiver.  See Sections <a href="#section-5">5</a> and <a href="#section-7">7</a> of
   [<a href="#ref-AUTH-RESULTS">AUTH-RESULTS</a>] for further discussion.

   Upon DKIM and ADSP evaluation during an SMTP session (a common
   implementation), an agent MAY decide to reject a message during an
   SMTP session.  If this is done, [<a href="#ref-SMTP" title='"Simple Mail Transfer Protocol"'>SMTP</a>] stipulates that 550 is the
   correct response code.  However, if the SMTP server supports
   [<a href="#ref-ENHANCED" title='"Enhanced Mail System Status Codes"'>ENHANCED</a>] status codes, a status code not normally used for "user
   unknown" (5.1.1) is preferred; therefore, a 5.7.0 code SHOULD be
   used.  If the rejecting SMTP server supports this, it thus makes a
   distinction between messages rejected deliberately due to policy



<span class="grey">Kucherawy                 Best Current Practice                [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


   decisions rather than those rejected because of other delivery
   issues.  In particular, a policy rejection SHOULD be relayed using
   the above enhanced status code and some appropriate wording in the
   text part of the reply.  Those MLMs that automatically attempt to
   remove users with prolonged delivery problems (such as account
   deletion) SHOULD thus detect the difference between policy rejection
   and other delivery failures and act accordingly.  It would also be
   beneficial for SMTP servers doing so to use appropriate wording in
   the text portion of the reply, perhaps explicitly using the string
   "ADSP" to facilitate searching for relevant data in logs.

   The preceding paragraph does not apply to an [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>] policy of
   "discardable".  In such cases where the submission fails that test,
   the Receiver or Verifier SHOULD discard the message but return an
   SMTP success code, i.e., accept the message but drop it without
   delivery.  An SMTP rejection of such mail instead of the requested
   discard action causes more harm than good.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20DKIM%20Reporting"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  DKIM Reporting</span>

   As mechanisms become available for reporting forensic details about
   DKIM verification failures, MLMs will benefit from their use.

   MLMs SHOULD apply DKIM failure-reporting mechanisms as a method for
   providing feedback to Signers about issues with DKIM infrastructure.
   This is especially important for MLMs that implement DKIM
   verification as a mechanism for authentication of list configuration
   commands and submissions from subscribers.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Security%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Security Considerations</span>

   This document provides suggested or best current practices for use
   with DKIM and, as such, does not introduce any new technologies for
   consideration.  However, the following security issues should be
   considered when implementing the practices described in this
   document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Security%20Considerations%20from%20DKIM%20and%20ADSP"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Security Considerations from DKIM and ADSP</span>

   Readers should be familiar with the material in the "Security
   Considerations" sections in [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>], [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>], and [<a href="#ref-AUTH-RESULTS">AUTH-RESULTS</a>] as
   appropriate.









<span class="grey">Kucherawy                 Best Current Practice                [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Authentication%20Results%20When%20Relaying"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Authentication Results When Relaying</span>

   <a href="#section-5">Section 5</a> advocates addition of an [<a href="#ref-AUTH-RESULTS">AUTH-RESULTS</a>] header field to
   indicate authentication status of a message received as MLM Input.
   Per Section 7.2 of [<a href="#ref-AUTH-RESULTS">AUTH-RESULTS</a>], Receivers generally should not
   trust such data without a good reason to do so, such as an a priori
   agreement with the MLM's ADMD.

   Such agreements are strongly advised to include a requirement that
   those header fields be covered by a [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] signature added by the
   MLM's ADMD.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20References"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Normative%20References"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Normative References</span>

   [<a id="ref-ADSP" name="ref-ADSP">ADSP</a>]     Allman, E., Fenton, J., Delany, M., and J. Levine,
              "DomainKeys Identified Mail (DKIM) Author Domain Signing
              Practices (ADSP)", <a href="rfc5617.html">RFC 5617</a>, August 2009.

   [<a id="ref-AUTH-RESULTS" name="ref-AUTH-RESULTS">AUTH-RESULTS</a>]
              Kucherawy, M., "Message Header Field for Indicating
              Message Authentication Status", <a href="rfc5451.html">RFC 5451</a>, April 2009.

   [<a id="ref-DKIM" name="ref-DKIM">DKIM</a>]     Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed.,
              "DomainKeys Identified Mail (DKIM) Signatures", <a href="rfc6376.html">RFC 6376</a>,
              September 2011.

   [<a id="ref-EMAIL-ARCH" name="ref-EMAIL-ARCH">EMAIL-ARCH</a>]
              Crocker, D., "Internet Mail Architecture", <a href="rfc5598.html">RFC 5598</a>,
              July 2009.

   [<a id="ref-KEYWORDS" name="ref-KEYWORDS">KEYWORDS</a>] Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-MAIL" name="ref-MAIL">MAIL</a>]     Resnick, P., Ed., "Internet Message Format", <a href="rfc5322.html">RFC 5322</a>,
              October 2008.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Informative%20References"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Informative References</span>

   [<a id="ref-ARF" name="ref-ARF">ARF</a>]      Shafranovich, Y., Levine, J., and M. Kucherawy, "An
              Extensible Format for Email Feedback Reports", <a href="rfc5965.html">RFC 5965</a>,
              August 2010.

   [<a id="ref-DKIM-DEPLOYMENT" name="ref-DKIM-DEPLOYMENT">DKIM-DEPLOYMENT</a>]
              Hansen, T., Siegel, E., Hallam-Baker, P., and D. Crocker,
              "DomainKeys Identified Mail (DKIM) Development,
              Deployment, and Operations", <a href="rfc5863.html">RFC 5863</a>, May 2010.



<span class="grey">Kucherawy                 Best Current Practice                [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


   [<a id="ref-DKIM-OVERVIEW" name="ref-DKIM-OVERVIEW">DKIM-OVERVIEW</a>]
              Hansen, T., Crocker, D., and P. Hallam-Baker, "DomainKeys
              Identified Mail (DKIM) Service Overview", <a href="rfc5585.html">RFC 5585</a>,
              July 2009.

   [<a id="ref-ENHANCED" name="ref-ENHANCED">ENHANCED</a>] Vaudreuil, G., "Enhanced Mail System Status Codes",
              <a href="rfc3463.html">RFC 3463</a>, January 2003.

   [<a id="ref-IODEF" name="ref-IODEF">IODEF</a>]    Danyliw, R., Meijer, J., and Y. Demchenko, "The Incident
              Object Description Exchange Format", <a href="rfc5070.html">RFC 5070</a>,
              December 2007.

   [<a id="ref-LIST-ID" name="ref-LIST-ID">LIST-ID</a>]  Chandhok, R. and G. Wenger, "List-Id: A Structured Field
              and Namespace for the Identification of Mailing Lists",
              <a href="rfc2919.html">RFC 2919</a>, March 2001.

   [<a id="ref-LIST-URLS" name="ref-LIST-URLS">LIST-URLS</a>]
              Neufeld, G. and J. Baer, "The Use of URLs as Meta-Syntax
              for Core Mail List Commands and their Transport through
              Message Header Fields", <a href="rfc2369.html">RFC 2369</a>, July 1998.

   [<a id="ref-MIME" name="ref-MIME">MIME</a>]     Freed, N. and N. Borenstein, "Multipurpose Internet Mail
              Extensions (MIME) Part One: Format of Internet Message
              Bodies", <a href="rfc2045.html">RFC 2045</a>, November 1996.

   [<a id="ref-MIME-TYPES" name="ref-MIME-TYPES">MIME-TYPES</a>]
              Freed, N. and N. Borenstein, "Multipurpose Internet Mail
              Extensions (MIME) Part Two: Media Types", <a href="rfc2046.html">RFC 2046</a>,
              November 1996.

   [<a id="ref-SMTP" name="ref-SMTP">SMTP</a>]     Klensin, J., "Simple Mail Transfer Protocol", <a href="rfc5321.html">RFC 5321</a>,
              October 2008.



















<span class="grey">Kucherawy                 Best Current Practice                [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Acknowledgements"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Acknowledgements</span>

   The author wishes to acknowledge the following individuals for their
   review and constructive criticism of this document: Serge Aumont,
   Daniel Black, Dave Crocker, J.D. Falk, Tony Hansen, Eliot Lear,
   Charles Lindsey, John Levine, Jeff Macdonald, S. Moonesamy, Rolf E.
   Sonneveld, and Alessandro Vesely.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20B.%20%20Example%20Scenarios"></a><a class="selflink" href="#appendix-B" name="appendix-B">Appendix B</a>.  Example Scenarios</span>

   This section describes a few MLM-related DKIM scenarios that were
   part of the impetus for this work and the recommended resolutions for
   each.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.1.%20%20MLMs%20and%20ADSP"></a><a class="selflink" href="#appendix-B.1" name="appendix-B.1">B.1</a>.  MLMs and ADSP</span>

   Problem:

   o  Author ADMD advertises an ADSP policy of "dkim=discardable"

   o  Author sends DKIM-signed mail to a non-participating MLM, which
      invalidates the signature

   o  Receiver MTA checks DKIM and ADSP at SMTP time and is configured
      to reject ADSP failures, so rejects this message

   o  process repeats a few times, after which the MLM unsubscribes the
      Receiver

   Solution: MLMs should refuse mail from domains advertising ADSP
   policies of "discardable" unless the MLMs are certain they make no
   changes that invalidate DKIM signatures.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.2.%20%20MLMs%20and%20FBLs"></a><a class="selflink" href="#appendix-B.2" name="appendix-B.2">B.2</a>.  MLMs and FBLs</span>

   Problem:

   o  subscriber sends signed mail to a non-participating MLM that does
      not invalidate the signature

   o  a recipient reports the message as spam

   o  FBL at recipient ADMD sends report to contributor rather than list
      manager







<span class="grey">Kucherawy                 Best Current Practice                [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc6377.html">RFC 6377</a>                 DKIM and Mailing Lists           September 2011</span>


   Solution: MLMs should sign mail they send and might also strip
   existing signatures.  FBLs should report to list operators instead of
   subscribers where such can be distinguished; otherwise, FBLs should
   report to all parties with valid signatures.

Author's Address

   Murray S. Kucherawy
   Cloudmark
   128 King St., 2nd Floor
   San Francisco, CA  94107
   USA

   Phone: +1 415 946 3800
   EMail: msk@cloudmark.com




































Kucherawy                 Best Current Practice                [Page 26]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc6377 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:30 GMT --></html>