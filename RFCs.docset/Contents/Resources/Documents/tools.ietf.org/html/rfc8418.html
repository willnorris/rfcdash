<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from tools.ietf.org/html/rfc8418 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:12:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.129c" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Relation.Replaces" content="draft-housley-cms-ecdh-new-curves" />
<meta name="DC.Identifier" content="urn:ietf:rfc:8418" />
<meta name="DC.Date.Issued" content="August, 2018" />
<meta name="DC.Creator" content="Russ Housley &lt;housley@vigilsec.com&gt;" />
<meta name="DC.Description.Abstract" content="This document describes the conventions for using Elliptic Curve
Diffie-Hellman (ECDH) key agreement algorithm using curve25519 and
curve448 in the Cryptographic Message Syntax (CMS)." />
<meta name="DC.Title" content="Use of the Elliptic Curve Diffie-Hellman Key Agreement Algorithm with X25519 and X448 in the Cryptographic Message Syntax (CMS)" />

    <link rel="icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 8418 - Use of the Elliptic Curve Diffie-Hellman Key Agreement Algorithm with X25519 and X448 in the Cryptographic Message Syntax (CMS)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgblue"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc8418.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc8418" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-curdle-cms-ecdh-new-curves" title="draft-ietf-curdle-cms-ecdh-new-curves">draft-ietf-curd...</a>] [<a href='https://datatracker.ietf.org/doc/rfc8418' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc8418" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc8418" title="Side-by-side diff">Diff2</a>]         </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Internet Engineering Task Force (IETF)                        R. Housley
Request for Comments: 8418                                Vigil Security
Category: Standards Track                                    August 2018
ISSN: 2070-1721


    <span class="h1">Use of the Elliptic Curve Diffie-Hellman Key Agreement Algorithm</span>
     <span class="h1">with X25519 and X448 in the Cryptographic Message Syntax (CMS)</span>

Abstract

   This document describes the conventions for using the Elliptic Curve
   Diffie-Hellman (ECDH) key agreement algorithm with curve25519 and
   curve448 in the Cryptographic Message Syntax (CMS).

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by
   the Internet Engineering Steering Group (IESG).  Further
   information on Internet Standards is available in <a href="rfc7841.html#section-2">Section&nbsp;2 of
   RFC 7841</a>.

   Information about the current status of this document, any
   errata, and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8418">https://www.rfc-editor.org/info/rfc8418</a>.

Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.







<span class="grey">Housley                      Standards Track                    [Page 1]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc8418.html">RFC 8418</a>             Using X25519 and X448 with CMS          August 2018</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
      <a href="#section-1.1">1.1</a>. Terminology ................................................<a href="#page-3">3</a>
      <a href="#section-1.2">1.2</a>. ASN.1 ......................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Key Agreement ...................................................<a href="#page-3">3</a>
      <a href="#section-2.1">2.1</a>. ANSI-X9.63-KDF .............................................<a href="#page-4">4</a>
      <a href="#section-2.2">2.2</a>. HKDF .......................................................<a href="#page-5">5</a>
   <a href="#section-3">3</a>. Enveloped-data Conventions ......................................<a href="#page-5">5</a>
      <a href="#section-3.1">3.1</a>. EnvelopedData Fields .......................................<a href="#page-6">6</a>
      <a href="#section-3.2">3.2</a>. KeyAgreeRecipientInfo Fields ...............................<a href="#page-6">6</a>
   <a href="#section-4">4</a>. Authenticated-data Conventions ..................................<a href="#page-7">7</a>
      <a href="#section-4.1">4.1</a>. AuthenticatedData Fields ...................................<a href="#page-8">8</a>
      <a href="#section-4.2">4.2</a>. KeyAgreeRecipientInfo Fields ...............................<a href="#page-8">8</a>
   <a href="#section-5">5</a>. Authenticated-enveloped-data Conventions ........................<a href="#page-8">8</a>
      <a href="#section-5.1">5.1</a>. AuthEnvelopedData Fields ...................................<a href="#page-8">8</a>
      <a href="#section-5.2">5.2</a>. KeyAgreeRecipientInfo Fields ...............................<a href="#page-8">8</a>
   <a href="#section-6">6</a>. Certificate Conventions .........................................<a href="#page-9">9</a>
   <a href="#section-7">7</a>. Key Agreement Algorithm Identifiers .............................<a href="#page-9">9</a>
   <a href="#section-8">8</a>. SMIMECapabilities Attribute Conventions ........................<a href="#page-10">10</a>
   <a href="#section-9">9</a>. Security Considerations ........................................<a href="#page-11">11</a>
   <a href="#section-10">10</a>. IANA Considerations ...........................................<a href="#page-12">12</a>
   <a href="#section-11">11</a>. References ....................................................<a href="#page-13">13</a>
      <a href="#section-11.1">11.1</a>. Normative References .....................................<a href="#page-13">13</a>
      <a href="#section-11.2">11.2</a>. Informative References ...................................<a href="#page-14">14</a>
   <a href="#appendix-A">Appendix A</a>. ASN.1 Module ..........................................<a href="#page-16">16</a>
   Acknowledgements ..................................................<a href="#page-18">18</a>
   Author's Address ..................................................<a href="#page-18">18</a>

<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   This document describes the conventions for using Elliptic Curve
   Diffie-Hellman (ECDH) key agreement using curve25519 and curve448
   [<a href="#ref-CURVES" title="&quot;Elliptic Curves for Security&quot;">CURVES</a>] in the Cryptographic Message Syntax (CMS) [<a href="#ref-CMS" title="&quot;Cryptographic Message Syntax (CMS)&quot;">CMS</a>].  Key
   agreement is supported in three CMS content types: the enveloped-data
   content type [<a href="#ref-CMS" title="&quot;Cryptographic Message Syntax (CMS)&quot;">CMS</a>], authenticated-data content type [<a href="#ref-CMS" title="&quot;Cryptographic Message Syntax (CMS)&quot;">CMS</a>], and the
   authenticated-enveloped-data content type [<a href="#ref-AUTHENV" title="&quot;Cryptographic Message Syntax (CMS) Authenticated-Enveloped-Data Content Type&quot;">AUTHENV</a>].

   The conventions for using some Elliptic Curve Cryptography (ECC)
   algorithms in CMS are described in [<a href="#ref-CMSECC" title="&quot;Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)&quot;">CMSECC</a>].  These conventions cover
   the use of ECDH with some curves other than curve25519 and curve448
   [<a href="#ref-CURVES" title="&quot;Elliptic Curves for Security&quot;">CURVES</a>].  Those other curves are not deprecated.

   Using curve25519 with Diffie-Hellman key agreement is referred to as
   "X25519".  Using curve448 with Diffie-Hellman key agreement is
   referred to as "X448".





<span class="grey">Housley                      Standards Track                    [Page 2]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc8418.html">RFC 8418</a>             Using X25519 and X448 with CMS          August 2018</span>


<span class="h3"><a class="selflink" name="section-1.1" href="#section-1.1">1.1</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   <a href="https://tools.ietf.org/html/bcp14">BCP 14</a> [<a href="rfc2119.html" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>] [<a href="rfc8174.html" title="&quot;Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words&quot;">RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

<span class="h3"><a class="selflink" name="section-1.2" href="#section-1.2">1.2</a>.  ASN.1</span>

   CMS values are generated using ASN.1 [<a href="#ref-X680" title="&quot;Information technology -- Abstract Syntax Notation One (ASN.1): Specification of basic notation&quot;">X680</a>], which uses the Basic
   Encoding Rules (BER) and the Distinguished Encoding Rules (DER)
   [<a href="#ref-X690" title="&quot;Information technology -- ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)&quot;">X690</a>].

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Key Agreement</span>

   In 1976, Diffie and Hellman described a means for two parties to
   agree upon a shared secret value in a manner that prevents
   eavesdroppers from learning the shared secret value [<a href="#ref-DH1976" title="&quot;New Directions in Cryptography&quot;">DH1976</a>].  This
   secret may then be converted into pairwise symmetric keying material
   for use with other cryptographic algorithms.  Over the years, many
   variants of this fundamental technique have been developed.  This
   document describes the conventions for using Ephemeral-Static
   Elliptic Curve Diffie-Hellman (ECDH) key agreement using X25519 and
   X448 [<a href="#ref-CURVES" title="&quot;Elliptic Curves for Security&quot;">CURVES</a>].

   The originator MUST use an ephemeral public/private key pair that is
   generated on the same elliptic curve as the public key of the
   recipient.  The ephemeral key pair MUST be used for a single CMS-
   protected content type, and then it MUST be discarded.  The
   originator obtains the recipient's static public key from the
   recipient's certificate [<a href="#ref-PROFILE" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">PROFILE</a>].

   X25519 is described in Section 6.1 of [<a href="#ref-CURVES" title="&quot;Elliptic Curves for Security&quot;">CURVES</a>], and X448 is described
   in Section 6.2 of [<a href="#ref-CURVES" title="&quot;Elliptic Curves for Security&quot;">CURVES</a>].  Conforming implementations MUST check
   whether the computed Diffie-Hellman shared secret is the all-zero
   value, and abort if so, as described in Section 6 of [<a href="#ref-CURVES" title="&quot;Elliptic Curves for Security&quot;">CURVES</a>].  If an
   alternative implementation of these elliptic curves to that
   documented in Section 6 of [<a href="#ref-CURVES" title="&quot;Elliptic Curves for Security&quot;">CURVES</a>] is employed, then the additional
   checks specified in Section 7 of [<a href="#ref-CURVES" title="&quot;Elliptic Curves for Security&quot;">CURVES</a>] SHOULD be performed.

   In [<a href="#ref-CURVES" title="&quot;Elliptic Curves for Security&quot;">CURVES</a>], the shared secret value that is produced by ECDH is
   called K.  (In some other specifications, the shared secret value is
   called Z.)  A Key Derivation Function (KDF) is used to produce a
   pairwise key-encryption key (KEK) from the shared secret value (K),
   the length of the KEK, and the DER-encoded ECC-CMS-SharedInfo
   structure [<a href="#ref-CMSECC" title="&quot;Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)&quot;">CMSECC</a>].




<span class="grey">Housley                      Standards Track                    [Page 3]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc8418.html">RFC 8418</a>             Using X25519 and X448 with CMS          August 2018</span>


   The ECC-CMS-SharedInfo definition from [<a href="#ref-CMSECC" title="&quot;Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)&quot;">CMSECC</a>] is repeated here for
   convenience.

      ECC-CMS-SharedInfo ::= SEQUENCE {
        keyInfo         AlgorithmIdentifier,
        entityUInfo [0] EXPLICIT OCTET STRING OPTIONAL,
        suppPubInfo [2] EXPLICIT OCTET STRING  }

   The ECC-CMS-SharedInfo keyInfo field contains the object identifier
   of the key-encryption algorithm and associated parameters.  This
   algorithm will be used to wrap the content-encryption key.  For
   example, the AES Key Wrap algorithm [<a href="#ref-AESKW" title="&quot;Advanced Encryption Standard (AES) Key Wrap Algorithm&quot;">AESKW</a>] does not need parameters,
   so the algorithm identifier parameters are absent.

   The ECC-CMS-SharedInfo entityUInfo field optionally contains
   additional keying material supplied by the sending agent.  Note that
   [<a href="#ref-CMS" title="&quot;Cryptographic Message Syntax (CMS)&quot;">CMS</a>] requires implementations to accept a KeyAgreeRecipientInfo
   SEQUENCE that includes the ukm field.  If the ukm field is present,
   the ukm is placed in the entityUInfo field.  By including the ukm, a
   different KEK is generated even when the originator ephemeral private
   key is improperly used more than once.  Therefore, if the ukm field
   is present, it MUST be selected in a manner that provides, with very
   high probability, a unique value; however, there is no security
   benefit to using a ukm value that is longer than the KEK that will be
   produced by the KDF.

   The ECC-CMS-SharedInfo suppPubInfo field contains the length of the
   generated KEK, in bits, represented as a 32-bit number in network
   byte order.  For example, the key length for AES-256 [<a href="#ref-AES" title="&quot;Advanced Encryption Standard (AES)&quot;">AES</a>] would be
   0x00000100.

<span class="h3"><a class="selflink" name="section-2.1" href="#section-2.1">2.1</a>.  ANSI-X9.63-KDF</span>

   The ANSI-X9.63-KDF key derivation function is a simple construct
   based on a one-way hash function described in American National
   Standard X9.63 [<a href="#ref-X963" title="&quot;Public-Key Cryptography for the Financial Services Industry: Key Agreement and Key Transport Using Elliptic Curve Cryptography&quot;">X963</a>].  This KDF is also described in Section 3.6.1
   of [<a href="#ref-SEC1" title="&quot;SEC 1: Elliptic Curve Cryptography&quot;">SEC1</a>].

   Three values are concatenated to produce the input string to the KDF:
      1. The shared secret value generated by ECDH, K.
      2. The iteration counter, starting with one, as described below.
      3. The DER-encoded ECC-CMS-SharedInfo structure.

   To generate a key-encryption key (KEK), the KDF generates one or more
   keying material (KM) blocks, with the counter starting at 0x00000001,
   and incrementing the counter for each subsequent KM block until
   enough material has been generated.  The 32-bit counter is




<span class="grey">Housley                      Standards Track                    [Page 4]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc8418.html">RFC 8418</a>             Using X25519 and X448 with CMS          August 2018</span>


   represented in network byte order.  The KM blocks are concatenated
   left to right, and then the leftmost portion of the result is used as
   the pairwise key-encryption key, KEK:

      KM(i) = Hash(K || INT32(counter=i) || DER(ECC-CMS-SharedInfo))

      KEK = KM(counter=1) || KM(counter=2) ...

<span class="h3"><a class="selflink" name="section-2.2" href="#section-2.2">2.2</a>.  HKDF</span>

   The Extract-and-Expand HMAC-based Key Derivation Function (HKDF) is a
   robust construct based on a one-way hash function described in <a href="rfc5869.html">RFC</a>
   <a href="rfc5869.html">5869</a> [<a href="#ref-HKDF" title="&quot;HMAC-based Extract-and-Expand Key Derivation Function (HKDF)&quot;">HKDF</a>].  HKDF is comprised of two steps: HKDF-Extract followed
   by HKDF-Expand.

   Three values are used as inputs to the HKDF:
      1. The shared secret value generated by ECDH, K.
      2. The length in octets of the keying data to be generated.
      3. The DER-encoded ECC-CMS-SharedInfo structure.

   The ECC-CMS-SharedInfo structure optionally includes the ukm.  If the
   ukm is present, the ukm is also used as the HKDF salt.  HKDF uses an
   appropriate number of zero octets when no salt is provided.

   The length of the generated KEK is used in two places, once in bits
   and once in octets.  The ECC-CMS-SharedInfo structure includes the
   length of the generated KEK in bits.  The HKDF-Expand function takes
   an argument for the length of the generated KEK in octets.

   In summary, to produce the pairwise key-encryption key, KEK:

      if ukm is provided, then salt = ukm, else salt is not provided
      PRK = HKDF-Extract(salt, K)

      KEK = HKDF-Expand(PRK, DER(ECC-CMS-SharedInfo), SizeInOctets(KEK))

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>. Enveloped-data Conventions</span>

   The CMS enveloped-data content type [<a href="#ref-CMS" title="&quot;Cryptographic Message Syntax (CMS)&quot;">CMS</a>] consists of an encrypted
   content and wrapped content-encryption keys for one or more
   recipients.  The ECDH key agreement algorithm is used to generate a
   pairwise KEK between the originator and a particular recipient.
   Then, the KEK is used to wrap the content-encryption key for that
   recipient.  When there is more than one recipient, the same content-
   encryption key MUST be wrapped for each of them.






<span class="grey">Housley                      Standards Track                    [Page 5]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc8418.html">RFC 8418</a>             Using X25519 and X448 with CMS          August 2018</span>


   A compliant implementation MUST meet the requirements for
   constructing an enveloped-data content type in Section 6 of [<a href="#ref-CMS" title="&quot;Cryptographic Message Syntax (CMS)&quot;">CMS</a>].

   A content-encryption key MUST be randomly generated for each instance
   of an enveloped-data content type.  The content-encryption key is
   used to encrypt the content.

<span class="h3"><a class="selflink" name="section-3.1" href="#section-3.1">3.1</a>.  EnvelopedData Fields</span>

   The enveloped-data content type is ASN.1 encoded using the
   EnvelopedData syntax.  The fields of the EnvelopedData syntax MUST be
   populated as described in Section 6 of [<a href="#ref-CMS" title="&quot;Cryptographic Message Syntax (CMS)&quot;">CMS</a>].  The RecipientInfo
   choice is described in Section 6.2 of [<a href="#ref-CMS" title="&quot;Cryptographic Message Syntax (CMS)&quot;">CMS</a>], and repeated here for
   convenience.

      RecipientInfo ::= CHOICE {
        ktri KeyTransRecipientInfo,
        kari [1] KeyAgreeRecipientInfo,
        kekri [2] KEKRecipientInfo,
        pwri [3] PasswordRecipientinfo,
        ori [4] OtherRecipientInfo }

   For the recipients that use X25519 or X448, the RecipientInfo kari
   choice MUST be used.

<span class="h3"><a class="selflink" name="section-3.2" href="#section-3.2">3.2</a>.  KeyAgreeRecipientInfo Fields</span>

   The fields of the KeyAgreeRecipientInfo syntax MUST be populated as
   described in this section when X25519 or X448 is employed for one or
   more recipients.

   The KeyAgreeRecipientInfo version MUST be 3.

   The KeyAgreeRecipientInfo originator provides three alternatives for
   identifying the originator's public key, and the originatorKey
   alternative MUST be used.  The originatorKey MUST contain an
   ephemeral key for the originator.  The originatorKey algorithm field
   MUST contain the id-X25519 or the id-X448 object identifier.  The
   originator's ephemeral public key MUST be encoded as an OCTET STRING.

   The object identifiers for X25519 and X448 have been assigned in
   [<a href="rfc8410.html" title="&quot;Algorithm Identifiers for Ed25519,Ed448, Ed448ph, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure&quot;">RFC8410</a>].  They are repeated below for convenience.









<span class="grey">Housley                      Standards Track                    [Page 6]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc8418.html">RFC 8418</a>             Using X25519 and X448 with CMS          August 2018</span>


   When using X25519, the public key contains exactly 32 octets, and the
   id-X25519 object identifier is used:

      id-X25519 OBJECT IDENTIFIER ::= { 1 3 101 110 }

   When using X448, the public key contains exactly 56 octets, and the
   id-X448 object identifier is used:

      id-X448 OBJECT IDENTIFIER ::= { 1 3 101 111 }

   KeyAgreeRecipientInfo ukm is optional.  The processing of the ukm
   with the ANSI-X9.63-KDF key derivation function is described in
   <a href="#section-2.1">Section 2.1</a>, and the processing of the ukm with the HKDF key
   derivation function is described in <a href="#section-2.2">Section 2.2</a>.

   The KeyAgreeRecipientInfo keyEncryptionAlgorithm MUST contain the
   object identifier of the key-encryption algorithm that will be used
   to wrap the content-encryption key.  The conventions for using
   AES-128, AES-192, and AES-256 in the key wrap mode are specified in
   [<a href="#ref-CMSAES" title="&quot;Use of the Advanced Encryption Standard (AES) Encryption Algorithm in Cryptographic Message Syntax (CMS)&quot;">CMSAES</a>].

   The KeyAgreeRecipientInfo recipientEncryptedKeys includes a recipient
   identifier and encrypted key for one or more recipients.  The
   RecipientEncryptedKey KeyAgreeRecipientIdentifier MUST contain either
   the issuerAndSerialNumber identifying the recipient's certificate or
   the RecipientKeyIdentifier containing the subject key identifier from
   the recipient's certificate.  In both cases, the recipient's
   certificate contains the recipient's static X25519 or X448 public
   key.  The RecipientEncryptedKey EncryptedKey MUST contain the
   content-encryption key encrypted with the pairwise key-encryption key
   using the algorithm specified by the KeyWrapAlgorithm.

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Authenticated-data Conventions</span>

   The CMS authenticated-data content type [<a href="#ref-CMS" title="&quot;Cryptographic Message Syntax (CMS)&quot;">CMS</a>] consists of an
   authenticated content, a message authentication code (MAC), and
   encrypted authentication keys for one or more recipients.  The ECDH
   key agreement algorithm is used to generate a pairwise KEK between
   the originator and a particular recipient.  Then, the KEK is used to
   wrap the authentication key for that recipient.  When there is more
   than one recipient, the same authentication key MUST be wrapped for
   each of them.

   A compliant implementation MUST meet the requirements for
   constructing an authenticated-data content type in Section 9 of
   [<a href="#ref-CMS" title="&quot;Cryptographic Message Syntax (CMS)&quot;">CMS</a>].





<span class="grey">Housley                      Standards Track                    [Page 7]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc8418.html">RFC 8418</a>             Using X25519 and X448 with CMS          August 2018</span>


   An authentication key MUST be randomly generated for each instance of
   an authenticated-data content type.  The authentication key is used
   to compute the MAC over the content.

<span class="h3"><a class="selflink" name="section-4.1" href="#section-4.1">4.1</a>.  AuthenticatedData Fields</span>

   The authenticated-data content type is ASN.1 encoded using the
   AuthenticatedData syntax.  The fields of the AuthenticatedData syntax
   MUST be populated as described in [<a href="#ref-CMS" title="&quot;Cryptographic Message Syntax (CMS)&quot;">CMS</a>]; for the recipients that use
   X25519 or X448, the RecipientInfo kari choice MUST be used.

<span class="h3"><a class="selflink" name="section-4.2" href="#section-4.2">4.2</a>.  KeyAgreeRecipientInfo Fields</span>

   The fields of the KeyAgreeRecipientInfo syntax MUST be populated as
   described in <a href="#section-3.2">Section 3.2</a> of this document.

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  Authenticated-enveloped-data Conventions</span>

   The CMS authenticated-enveloped-data content type [<a href="#ref-AUTHENV" title="&quot;Cryptographic Message Syntax (CMS) Authenticated-Enveloped-Data Content Type&quot;">AUTHENV</a>] consists
   of an authenticated and encrypted content and encrypted content-
   authenticated-encryption keys for one or more recipients.  The ECDH
   key agreement algorithm is used to generate a pairwise KEK between
   the originator and a particular recipient.  Then, the KEK is used to
   wrap the content-authenticated-encryption key for that recipient.
   When there is more than one recipient, the same content-
   authenticated-encryption key MUST be wrapped for each of them.

   A compliant implementation MUST meet the requirements for
   constructing an authenticated-data content type in Section 2 of
   [<a href="#ref-AUTHENV" title="&quot;Cryptographic Message Syntax (CMS) Authenticated-Enveloped-Data Content Type&quot;">AUTHENV</a>].

   A content-authenticated-encryption key MUST be randomly generated for
   each instance of an authenticated-enveloped-data content type.  The
   content-authenticated-encryption key is used to authenticate and
   encrypt the content.

<span class="h3"><a class="selflink" name="section-5.1" href="#section-5.1">5.1</a>.  AuthEnvelopedData Fields</span>

   The authenticated-enveloped-data content type is ASN.1 encoded using
   the AuthEnvelopedData syntax.  The fields of the AuthEnvelopedData
   syntax MUST be populated as described in [<a href="#ref-AUTHENV" title="&quot;Cryptographic Message Syntax (CMS) Authenticated-Enveloped-Data Content Type&quot;">AUTHENV</a>]; for the
   recipients that use X25519 or X448, the RecipientInfo kari choice
   MUST be used.

<span class="h3"><a class="selflink" name="section-5.2" href="#section-5.2">5.2</a>.  KeyAgreeRecipientInfo Fields</span>

   The fields of the KeyAgreeRecipientInfo syntax MUST be populated as
   described in <a href="#section-3.2">Section 3.2</a> of this document.



<span class="grey">Housley                      Standards Track                    [Page 8]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc8418.html">RFC 8418</a>             Using X25519 and X448 with CMS          August 2018</span>


<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Certificate Conventions</span>

   <a href="rfc5280.html">RFC 5280</a> [<a href="#ref-PROFILE" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">PROFILE</a>] specifies the profile for using X.509 Certificates
   in Internet applications.  A recipient static public key is needed
   for X25519 or X448, and the originator obtains that public key from
   the recipient's certificate.  The conventions for carrying X25519 and
   X448 public keys are specified in [<a href="rfc8410.html" title="&quot;Algorithm Identifiers for Ed25519,Ed448, Ed448ph, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure&quot;">RFC8410</a>].

<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  Key Agreement Algorithm Identifiers</span>

   The following object identifiers are assigned in [<a href="#ref-CMSECC" title="&quot;Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)&quot;">CMSECC</a>] to indicate
   ECDH with ANSI-X9.63-KDF using various one-way hash functions.  These
   are expected to be used as AlgorithmIdentifiers with a parameter that
   specifies the key-encryption algorithm.  These are repeated here for
   convenience.

      secg-scheme OBJECT IDENTIFIER ::= {
        iso(1) identified-organization(3) certicom(132) schemes(1) }

      dhSinglePass-stdDH-sha256kdf-scheme OBJECT IDENTIFIER ::= {
        secg-scheme 11 1 }

      dhSinglePass-stdDH-sha384kdf-scheme OBJECT IDENTIFIER ::= {
        secg-scheme 11 2 }

      dhSinglePass-stdDH-sha512kdf-scheme OBJECT IDENTIFIER ::= {
        secg-scheme 11 3 }

   The following object identifiers are assigned to indicate ECDH with
   HKDF using various one-way hash functions.  These are expected to be
   used as AlgorithmIdentifiers with a parameter that specifies the
   key-encryption algorithm.

      smime-alg OBJECT IDENTIFIER ::= {
         iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)
         pkcs-9(9) smime(16) alg(3) }

      dhSinglePass-stdDH-hkdf-sha256-scheme OBJECT IDENTIFIER ::= {
         smime-alg 19 }

      dhSinglePass-stdDH-hkdf-sha384-scheme OBJECT IDENTIFIER ::= {
         smime-alg 20 }

      dhSinglePass-stdDH-hkdf-sha512-scheme OBJECT IDENTIFIER ::= {
         smime-alg 21 }






<span class="grey">Housley                      Standards Track                    [Page 9]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc8418.html">RFC 8418</a>             Using X25519 and X448 with CMS          August 2018</span>


<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  SMIMECapabilities Attribute Conventions</span>

   A sending agent MAY announce to other agents that it supports ECDH
   key agreement using the SMIMECapabilities signed attribute in a
   signed message [<a href="#ref-SMIME" title="&quot;Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.2 Message Specification&quot;">SMIME</a>] or a certificate [<a href="#ref-CERTCAP" title="&quot;X.509 Certificate Extension for Secure/Multipurpose Internet Mail Extensions (S/MIME) Capabilities&quot;">CERTCAP</a>].  Following the
   pattern established in [<a href="#ref-CMSECC" title="&quot;Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)&quot;">CMSECC</a>], the SMIMECapabilities associated
   with ECDH carries a DER-encoded object identifier that identifies
   support for ECDH in conjunction with a particular KDF, and it
   includes a parameter that names the key wrap algorithm.

   The following SMIMECapabilities values (in hexadecimal) from [<a href="#ref-CMSECC" title="&quot;Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)&quot;">CMSECC</a>]
   might be of interest to implementations that support X25519 and X448:

      ECDH with ANSI-X9.63-KDF using SHA-256; uses AES-128 key wrap:
         30 15 06 06 2B 81 04 01 0B 01 30 0B 06 09 60 86 48 01 65 03 04
         01 05

      ECDH with ANSI-X9.63-KDF using SHA-384; uses AES-128 key wrap:
         30 15 06 06 2B 81 04 01 0B 02 30 0B 06 09 60 86 48 01 65 03 04
         01 05

      ECDH with ANSI-X9.63-KDF using SHA-512; uses AES-128 key wrap:
         30 15 06 06 2B 81 04 01 0B 03 30 0B 06 09 60 86 48 01 65 03 04
         01 05

      ECDH with ANSI-X9.63-KDF using SHA-256; uses AES-256 key wrap:
         30 15 06 06 2B 81 04 01 0B 01 30 0B 06 09 60 86 48 01 65 03 04
         01 2D

      ECDH with ANSI-X9.63-KDF using SHA-384; uses AES-256 key wrap:
         30 15 06 06 2B 81 04 01 0B 02 30 0B 06 09 60 86 48 01 65 03 04
         01 2D

      ECDH with ANSI-X9.63-KDF using SHA-512; uses AES-256 key wrap:
         30 15 06 06 2B 81 04 01 0B 03 30 0B 06 09 60 86 48 01 65 03 04
         01 2D















<span class="grey">Housley                      Standards Track                   [Page 10]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc8418.html">RFC 8418</a>             Using X25519 and X448 with CMS          August 2018</span>


   The following SMIMECapabilities values (in hexadecimal) based on the
   algorithm identifiers in <a href="#section-7">Section 7</a> of this document might be of
   interest to implementations that support X25519 and X448:

      ECDH with HKDF using SHA-256; uses AES-128 key wrap:
         30 1A 06 0B 2A 86 48 86 F7 0D 01 09 10 03 13 30 0B 06 09 60 86
         48 01 65 03 04 01 05

      ECDH with HKDF using SHA-384; uses AES-128 key wrap:
         30 1A 06 0B 2A 86 48 86 F7 0D 01 09 10 03 14 30 0B 06 09 60 86
         48 01 65 03 04 01 05

      ECDH with HKDF using SHA-512; uses AES-128 key wrap:
         30 1A 06 0B 2A 86 48 86 F7 0D 01 09 10 03 15 30 0B 06 09 60 86
         48 01 65 03 04 01 05

      ECDH with HKDF using SHA-256; uses AES-256 key wrap:
         30 1A 06 0B 2A 86 48 86 F7 0D 01 09 10 03 13 30 0B 06 09 60 86
         48 01 65 03 04 01 2D

      ECDH with HKDF using SHA-384; uses AES-256 key wrap:
         30 1A 06 0B 2A 86 48 86 F7 0D 01 09 10 03 14 30 0B 06 09 60 86
         48 01 65 03 04 01 2D

      ECDH with HKDF using SHA-512; uses AES-256 key wrap:
         30 1A 06 0B 2A 86 48 86 F7 0D 01 09 10 03 15 30 0B 06 09 60 86
         48 01 65 03 04 01 2D

<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  Security Considerations</span>

   Please consult the security considerations of [<a href="#ref-CMS" title="&quot;Cryptographic Message Syntax (CMS)&quot;">CMS</a>] for security
   considerations related to the enveloped-data content type and the
   authenticated-data content type.

   Please consult the security considerations of [<a href="#ref-AUTHENV" title="&quot;Cryptographic Message Syntax (CMS) Authenticated-Enveloped-Data Content Type&quot;">AUTHENV</a>] for security
   considerations related to the authenticated-enveloped-data content
   type.

   Please consult the security considerations of [<a href="#ref-CURVES" title="&quot;Elliptic Curves for Security&quot;">CURVES</a>] for security
   considerations related to the use of X25519 and X448.

   The originator uses an ephemeral public/private key pair that is
   generated on the same elliptic curve as the public key of the
   recipient.  The ephemeral key pair is used for a single CMS protected
   content type, and then it is discarded.  If the originator wants to
   be able to decrypt the content (for enveloped-data and authenticated-
   enveloped-data) or check the authentication (for authenticated-data),
   then the originator needs to treat themselves as a recipient.



<span class="grey">Housley                      Standards Track                   [Page 11]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc8418.html">RFC 8418</a>             Using X25519 and X448 with CMS          August 2018</span>


   As specified in [<a href="#ref-CMS" title="&quot;Cryptographic Message Syntax (CMS)&quot;">CMS</a>], implementations MUST support processing of the
   KeyAgreeRecipientInfo ukm field; this ensures that interoperability
   is not a concern whether the ukm is present or absent.  The ukm is
   placed in the entityUInfo field of the ECC-CMS-SharedInfo structure.
   When present, the ukm ensures that a different key-encryption key is
   generated, even when the originator ephemeral private key is
   improperly used more than once.

<span class="h2"><a class="selflink" name="section-10" href="#section-10">10</a>.  IANA Considerations</span>

   One object identifier for the ASN.1 module in <a href="#appendix-A">Appendix A</a> was assigned
   in the "SMI Security for S/MIME Module Identifiers
   (1.2.840.113549.1.9.16.0)" registry on [<a href="#ref-IANA-SMI" title="&quot;Structure of Management Information (SMI) Numbers (MIB Module Registrations)&quot;">IANA-SMI</a>]:

      id-mod-cms-ecdh-alg-2017 OBJECT IDENTIFIER ::= {
         iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)
         pkcs-9(9) smime(16) mod(0) 67 }

   Three object identifiers for the Key Agreement Algorithm Identifiers
   in <a href="#section-7">Section 7</a> were assigned in the "SMI Security for S/MIME Algorithms
   (1.2.840.113549.1.9.16.3)" registry on [<a href="#ref-IANA-SMI" title="&quot;Structure of Management Information (SMI) Numbers (MIB Module Registrations)&quot;">IANA-SMI</a>]:

      smime-alg OBJECT IDENTIFIER ::= {
         iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)
         pkcs-9(9) smime(16) alg(3) }

      dhSinglePass-stdDH-hkdf-sha256-scheme OBJECT IDENTIFIER ::= {
         smime-alg 19 }

      dhSinglePass-stdDH-hkdf-sha384-scheme OBJECT IDENTIFIER ::= {
         smime-alg 20 }

      dhSinglePass-stdDH-hkdf-sha512-scheme OBJECT IDENTIFIER ::= {
         smime-alg 21 }

















<span class="grey">Housley                      Standards Track                   [Page 12]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey"><a href="rfc8418.html">RFC 8418</a>             Using X25519 and X448 with CMS          August 2018</span>


<span class="h2"><a class="selflink" name="section-11" href="#section-11">11</a>. References</span>

<span class="h3"><a class="selflink" name="section-11.1" href="#section-11.1">11.1</a>.  Normative References</span>

   [<a name="ref-AUTHENV" id="ref-AUTHENV">AUTHENV</a>]  Housley, R., "Cryptographic Message Syntax (CMS)
              Authenticated-Enveloped-Data Content Type", <a href="rfc5083.html">RFC 5083</a>,
              DOI 10.17487/RFC5083, November 2007,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5083">https://www.rfc-editor.org/info/rfc5083</a>&gt;.

   [<a name="ref-CERTCAP" id="ref-CERTCAP">CERTCAP</a>]  Santesson, S., "X.509 Certificate Extension for
              Secure/Multipurpose Internet Mail Extensions (S/MIME)
              Capabilities", <a href="rfc4262.html">RFC 4262</a>, DOI 10.17487/RFC4262, December
              2005, &lt;<a href="https://www.rfc-editor.org/info/rfc4262">https://www.rfc-editor.org/info/rfc4262</a>&gt;.

   [<a name="ref-CMS" id="ref-CMS">CMS</a>]      Housley, R., "Cryptographic Message Syntax (CMS)", STD 70,
              <a href="rfc5652.html">RFC 5652</a>, DOI 10.17487/RFC5652, September 2009,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5652">https://www.rfc-editor.org/info/rfc5652</a>&gt;.

   [<a name="ref-CMSASN1" id="ref-CMSASN1">CMSASN1</a>]  Hoffman, P. and J. Schaad, "New ASN.1 Modules for
              Cryptographic Message Syntax (CMS) and S/MIME", <a href="rfc5911.html">RFC 5911</a>,
              DOI 10.17487/RFC5911, June 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5911">https://www.rfc-editor.org/info/rfc5911</a>&gt;.

   [<a name="ref-CMSECC" id="ref-CMSECC">CMSECC</a>]   Turner, S. and D. Brown, "Use of Elliptic Curve
              Cryptography (ECC) Algorithms in Cryptographic Message
              Syntax (CMS)", <a href="rfc5753.html">RFC 5753</a>, DOI 10.17487/RFC5753, January
              2010, &lt;<a href="https://www.rfc-editor.org/info/rfc5753">https://www.rfc-editor.org/info/rfc5753</a>&gt;.

   [<a name="ref-CURVES" id="ref-CURVES">CURVES</a>]   Langley, A., Hamburg, M., and S. Turner, "Elliptic Curves
              for Security", <a href="rfc7748.html">RFC 7748</a>, DOI 10.17487/RFC7748, January
              2016, &lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;.

   [<a name="ref-HKDF" id="ref-HKDF">HKDF</a>]     Krawczyk, H. and P. Eronen, "HMAC-based Extract-and-Expand
              Key Derivation Function (HKDF)", <a href="rfc5869.html">RFC 5869</a>,
              DOI 10.17487/RFC5869, May 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;.

   [<a name="ref-PROFILE" id="ref-PROFILE">PROFILE</a>]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
              Housley, R., and W. Polk, "Internet X.509 Public Key
              Infrastructure Certificate and Certificate Revocation List
              (CRL) Profile", <a href="rfc5280.html">RFC 5280</a>, DOI 10.17487/RFC5280, May 2008,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;.

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.




<span class="grey">Housley                      Standards Track                   [Page 13]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey"><a href="rfc8418.html">RFC 8418</a>             Using X25519 and X448 with CMS          August 2018</span>


   [<a name="ref-RFC8174" id="ref-RFC8174">RFC8174</a>]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in <a href="rfc2119.html">RFC</a>
              <a href="rfc2119.html">2119</a> Key Words", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc8174.html">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a name="ref-RFC8410" id="ref-RFC8410">RFC8410</a>]  Josefsson, S., and J. Schaad, "Algorithm Identifiers for
              Ed25519,Ed448, Ed448ph, X25519, and X448 for Use in the
              Internet X.509 Public Key Infrastructure", <a href="rfc8410.html">RFC 8410</a>,
              DOI 10.17487/RFC8410, August 2018,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8410">https://www.rfc-editor.org/info/rfc8410</a>&gt;.

   [<a name="ref-SEC1" id="ref-SEC1">SEC1</a>]     Standards for Efficient Cryptography, "SEC 1: Elliptic
              Curve Cryptography", Cericom Research, version 2.0, May
              2009, &lt;<a href="http://www.secg.org/sec1-v2.pdf">http://www.secg.org/sec1-v2.pdf</a>&gt;.

   [<a name="ref-SMIME" id="ref-SMIME">SMIME</a>]    Ramsdell, B. and S. Turner, "Secure/Multipurpose Internet
              Mail Extensions (S/MIME) Version 3.2 Message
              Specification", <a href="rfc5751.html">RFC 5751</a>, DOI 10.17487/RFC5751, January
              2010, &lt;<a href="https://www.rfc-editor.org/info/rfc5751">https://www.rfc-editor.org/info/rfc5751</a>&gt;.

   [<a name="ref-X680" id="ref-X680">X680</a>]     ITU-T, "Information technology -- Abstract Syntax Notation
              One (ASN.1): Specification of basic notation", ITU-T
              Recommendation X.680, ISO/IEC 8824-1, August 2015,
              &lt;<a href="https://www.itu.int/rec/T-REC-X.680/en">https://www.itu.int/rec/T-REC-X.680/en</a>&gt;.

   [<a name="ref-X690" id="ref-X690">X690</a>]     ITU-T, "Information technology -- ASN.1 encoding rules:
              Specification of Basic Encoding Rules (BER), Canonical
              Encoding Rules (CER) and Distinguished Encoding Rules
              (DER)", ITU-T Recommendation X.690, ISO/IEC 8825-1, August
              2015, &lt;<a href="https://www.itu.int/rec/T-REC-X.690/en">https://www.itu.int/rec/T-REC-X.690/en</a>&gt;.

<span class="h3"><a class="selflink" name="section-11.2" href="#section-11.2">11.2</a>.  Informative References</span>

   [<a name="ref-AES" id="ref-AES">AES</a>]      National Institute of Standards and Technology, "Advanced
              Encryption Standard (AES)", FIPS PUB 197, November 2001.

   [<a name="ref-AESKW" id="ref-AESKW">AESKW</a>]    Schaad, J. and R. Housley, "Advanced Encryption Standard
              (AES) Key Wrap Algorithm", <a href="rfc3394.html">RFC 3394</a>, DOI 10.17487/RFC3394,
              September 2002, &lt;<a href="https://www.rfc-editor.org/info/rfc3394">https://www.rfc-editor.org/info/rfc3394</a>&gt;.

   [<a name="ref-CMSAES" id="ref-CMSAES">CMSAES</a>]   Schaad, J., "Use of the Advanced Encryption Standard (AES)
              Encryption Algorithm in Cryptographic Message Syntax
              (CMS)", <a href="rfc3565.html">RFC 3565</a>, DOI 10.17487/RFC3565, July 2003,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3565">https://www.rfc-editor.org/info/rfc3565</a>&gt;.

   [<a name="ref-DH1976" id="ref-DH1976">DH1976</a>]   Diffie, W., and M. E. Hellman, "New Directions in
              Cryptography", IEEE Trans. on Info. Theory, Vol. IT-22,
              November 1976, pp. 644-654.




<span class="grey">Housley                      Standards Track                   [Page 14]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-15" id="page-15" href="#page-15" class="invisible"> </a>
<span class="grey"><a href="rfc8418.html">RFC 8418</a>             Using X25519 and X448 with CMS          August 2018</span>


   [<a name="ref-IANA-SMI" id="ref-IANA-SMI">IANA-SMI</a>] IANA, "Structure of Management Information (SMI) Numbers
              (MIB Module Registrations)",
              &lt;<a href="https://www.iana.org/assignments/smi-numbers">https://www.iana.org/assignments/smi-numbers</a>&gt;.

   [<a name="ref-X963" id="ref-X963">X963</a>]     American National Standards Institute, "Public-Key
              Cryptography for the Financial Services Industry: Key
              Agreement and Key Transport Using Elliptic Curve
              Cryptography", American National Standard X9.63-2001,
              November 2001.










































<span class="grey">Housley                      Standards Track                   [Page 15]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-16" id="page-16" href="#page-16" class="invisible"> </a>
<span class="grey"><a href="rfc8418.html">RFC 8418</a>             Using X25519 and X448 with CMS          August 2018</span>


<span class="h2"><a class="selflink" name="appendix-A" href="#appendix-A">Appendix A</a>.  ASN.1 Module</span>

   CMSECDHAlgs-2017
     { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
       smime(16) modules(0) id-mod-cms-ecdh-alg-2017(67) }

   DEFINITIONS IMPLICIT TAGS ::=
   BEGIN

   -- EXPORTS ALL

   IMPORTS

     KeyWrapAlgorithm
       FROM CryptographicMessageSyntaxAlgorithms-2009  -- in [<a href="#ref-CMSASN1" title="&quot;New ASN.1 Modules for Cryptographic Message Syntax (CMS) and S/MIME&quot;">CMSASN1</a>]
         { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)
           pkcs-9(9) smime(16) modules(0) id-mod-cmsalg-2001-02(37) }

     KEY-AGREE, SMIME-CAPS
       FROM AlgorithmInformation-2009  -- in [<a href="#ref-CMSASN1" title="&quot;New ASN.1 Modules for Cryptographic Message Syntax (CMS) and S/MIME&quot;">CMSASN1</a>]
         { iso(1) identified-organization(3) dod(6) internet(1)
           security(5) mechanisms(5) pkix(7) id-mod(0)
           id-mod-algorithmInformation-02(58) }

     dhSinglePass-stdDH-sha256kdf-scheme,
     dhSinglePass-stdDH-sha384kdf-scheme,
     dhSinglePass-stdDH-sha512kdf-scheme,
     kaa-dhSinglePass-stdDH-sha256kdf-scheme,
     kaa-dhSinglePass-stdDH-sha384kdf-scheme,
     kaa-dhSinglePass-stdDH-sha512kdf-scheme,
     cap-kaa-dhSinglePass-stdDH-sha256kdf-scheme,
     cap-kaa-dhSinglePass-stdDH-sha384kdf-scheme,
     cap-kaa-dhSinglePass-stdDH-sha512kdf-scheme
       FROM CMSECCAlgs-2009-02  -- in [<a href="#ref-CMSECC" title="&quot;Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)&quot;">CMSECC</a>]
         { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)
           pkcs-9(9) smime(16) modules(0)
           id-mod-cms-ecc-alg-2009-02(46) }
     ;













<span class="grey">Housley                      Standards Track                   [Page 16]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-17" id="page-17" href="#page-17" class="invisible"> </a>
<span class="grey"><a href="rfc8418.html">RFC 8418</a>             Using X25519 and X448 with CMS          August 2018</span>


   --
   -- Object Identifiers
   --

   smime-alg OBJECT IDENTIFIER ::= {
      iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)
      pkcs-9(9) smime(16) alg(3) }

   dhSinglePass-stdDH-hkdf-sha256-scheme OBJECT IDENTIFIER ::= {
      smime-alg 19 }

   dhSinglePass-stdDH-hkdf-sha384-scheme OBJECT IDENTIFIER ::= {
      smime-alg 20 }

   dhSinglePass-stdDH-hkdf-sha512-scheme OBJECT IDENTIFIER ::= {
      smime-alg 21 }

   --
   -- Extend the Key Agreement Algorithms in [<a href="#ref-CMSECC" title="&quot;Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)&quot;">CMSECC</a>]
   --

   KeyAgreementAlgs KEY-AGREE ::= { ...,
     kaa-dhSinglePass-stdDH-sha256kdf-scheme   |
     kaa-dhSinglePass-stdDH-sha384kdf-scheme   |
     kaa-dhSinglePass-stdDH-sha512kdf-scheme   |
     kaa-dhSinglePass-stdDH-hkdf-sha256-scheme |
     kaa-dhSinglePass-stdDH-hkdf-sha384-scheme |
     kaa-dhSinglePass-stdDH-hkdf-sha512-scheme }

   kaa-dhSinglePass-stdDH-hkdf-sha256-scheme KEY-AGREE ::= {
     IDENTIFIER dhSinglePass-stdDH-hkdf-sha256-scheme
     PARAMS TYPE KeyWrapAlgorithm ARE required
     UKM -- TYPE unencoded data -- ARE preferredPresent
     SMIME-CAPS cap-kaa-dhSinglePass-stdDH-hkdf-sha256-scheme }

   kaa-dhSinglePass-stdDH-hkdf-sha384-scheme KEY-AGREE ::= {
     IDENTIFIER dhSinglePass-stdDH-hkdf-sha384-scheme
     PARAMS TYPE KeyWrapAlgorithm ARE required
     UKM -- TYPE unencoded data -- ARE preferredPresent
     SMIME-CAPS cap-kaa-dhSinglePass-stdDH-hkdf-sha384-scheme }

   kaa-dhSinglePass-stdDH-hkdf-sha512-scheme KEY-AGREE ::= {
     IDENTIFIER dhSinglePass-stdDH-hkdf-sha512-scheme
     PARAMS TYPE KeyWrapAlgorithm ARE required
     UKM -- TYPE unencoded data -- ARE preferredPresent
     SMIME-CAPS cap-kaa-dhSinglePass-stdDH-hkdf-sha512-scheme }





<span class="grey">Housley                      Standards Track                   [Page 17]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-18" id="page-18" href="#page-18" class="invisible"> </a>
<span class="grey"><a href="rfc8418.html">RFC 8418</a>             Using X25519 and X448 with CMS          August 2018</span>


   --
   -- Extend the S/MIME CAPS in [<a href="#ref-CMSECC" title="&quot;Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)&quot;">CMSECC</a>]
   --

   SMimeCAPS SMIME-CAPS ::= { ...,
     kaa-dhSinglePass-stdDH-sha256kdf-scheme.&amp;smimeCaps   |
     kaa-dhSinglePass-stdDH-sha384kdf-scheme.&amp;smimeCaps   |
     kaa-dhSinglePass-stdDH-sha512kdf-scheme.&amp;smimeCaps   |
     kaa-dhSinglePass-stdDH-hkdf-sha256-scheme.&amp;smimeCaps |
     kaa-dhSinglePass-stdDH-hkdf-sha384-scheme.&amp;smimeCaps |
     kaa-dhSinglePass-stdDH-hkdf-sha512-scheme.&amp;smimeCaps }

   cap-kaa-dhSinglePass-stdDH-hkdf-sha256-scheme SMIME-CAPS ::= {
     TYPE KeyWrapAlgorithm
     IDENTIFIED BY dhSinglePass-stdDH-hkdf-sha256-scheme }

   cap-kaa-dhSinglePass-stdDH-hkdf-sha384-scheme SMIME-CAPS ::= {
     TYPE KeyWrapAlgorithm
     IDENTIFIED BY dhSinglePass-stdDH-hkdf-sha384-scheme}

   cap-kaa-dhSinglePass-stdDH-hkdf-sha512-scheme SMIME-CAPS ::= {
     TYPE KeyWrapAlgorithm
     IDENTIFIED BY dhSinglePass-stdDH-hkdf-sha512-scheme }

   END

Acknowledgements

   Many thanks to Roni Even, Daniel Migault, Eric Rescorla, Jim Schaad,
   Stefan Santesson, and Sean Turner for their review and insightful
   suggestions.

Author's Address

   Russ Housley
   918 Spring Knoll Drive
   Herndon, VA  20170
   United States of America

   Email: housley@vigilsec.com











Housley                      Standards Track                   [Page 18]

</pre><br />
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.129c, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>
</body>

<!-- Mirrored from tools.ietf.org/html/rfc8418 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:12:35 GMT -->
</html>
