<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from tools.ietf.org/html/rfc4261 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 13:17:09 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.129c" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Identifier" content="urn:ietf:rfc:4261" />
<meta name="DC.Description.Abstract" content="This memo describes how to use TLS to secure COPS connections over the
Internet.  Please send comments on this document to the
rap@ops.ietf.org mailing list." />
<meta name="DC.Creator" content="Walker, Jesse R." />
<meta name="DC.Creator" content="Kulkarni, Amol" />
<meta name="DC.Date.Issued" content="December, 2005" />
<meta name="DC.Title" content="Common Open Policy Service (COPS) Over Transport Layer Security (TLS)" />

    <link rel="icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 4261 - Common Open Policy Service (COPS) Over Transport Layer Security (TLS)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgblue"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc4261.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc4261" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-rap-cops-tls" title="draft-ietf-rap-cops-tls">draft-ietf-rap-...</a>] [<a href='https://datatracker.ietf.org/doc/rfc4261' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4261" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc4261" title="Side-by-side diff">Diff2</a>]         </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Network Working Group                                          J. Walker
Request for Comments: 4261                              A. Kulkarni, Ed.
Updates: <a href="rfc2748.html">2748</a>                                                Intel Corp.
Category: Standards Track                                  December 2005


                   <span class="h1">Common Open Policy Service (COPS)</span>
                  <span class="h1">Over Transport Layer Security (TLS)</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2005).

Abstract

   This document describes how to use Transport Layer Security (TLS) to
   secure Common Open Policy Service (COPS) connections over the
   Internet.

   This document also updates <a href="rfc2748.html">RFC 2748</a> by modifying the contents of the
   Client-Accept message.






















<span class="grey">Walker &amp; Kulkarni           Standards Track                     [Page 1]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc4261.html">RFC 4261</a>                     COPS Over TLS                 December 2005</span>


Table Of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
   <a href="#section-2">2</a>. COPS Over TLS ...................................................<a href="#page-3">3</a>
   <a href="#section-3">3</a>. Separate Ports versus Upward Negotiation ........................<a href="#page-3">3</a>
   <a href="#section-4">4</a>. COPS/TLS Objects and Error codes ................................<a href="#page-4">4</a>
      <a href="#section-4.1">4.1</a>. The TLS Message Integrity Object (Integrity-TLS) ...........<a href="#page-4">4</a>
      <a href="#section-4.2">4.2</a>. Error Codes ................................................<a href="#page-4">4</a>
   <a href="#section-5">5</a>. COPS/TLS Secure Connection Initiation ...........................<a href="#page-5">5</a>
      <a href="#section-5.1">5.1</a>. PEP Initiated Security Negotiation .........................<a href="#page-5">5</a>
      <a href="#section-5.2">5.2</a>. PDP Initiated Security Negotiation .........................<a href="#page-6">6</a>
   <a href="#section-6">6</a>. Connection Closure ..............................................<a href="#page-7">7</a>
      <a href="#section-6.1">6.1</a>. PEP System Behavior ........................................<a href="#page-7">7</a>
      <a href="#section-6.2">6.2</a>. PDP System Behavior ........................................<a href="#page-8">8</a>
   <a href="#section-7">7</a>. Endpoint Identification and Access Control ......................<a href="#page-8">8</a>
      <a href="#section-7.1">7.1</a>. PEP Identity ...............................................<a href="#page-9">9</a>
      <a href="#section-7.2">7.2</a>. PDP Identity ...............................................<a href="#page-9">9</a>
   <a href="#section-8">8</a>. Cipher Suite Requirements ......................................<a href="#page-10">10</a>
   <a href="#section-9">9</a>. Backward Compatibility .........................................<a href="#page-10">10</a>
   <a href="#section-10">10</a>. IANA Considerations ...........................................<a href="#page-10">10</a>
   <a href="#section-11">11</a>. Security Considerations .......................................<a href="#page-11">11</a>
   <a href="#section-12">12</a>. Acknowledgements ..............................................<a href="#page-11">11</a>
   <a href="#section-13">13</a>. References ....................................................<a href="#page-12">12</a>
      <a href="#section-13.1">13.1</a>. Normative References .....................................<a href="#page-12">12</a>
      <a href="#section-13.2">13.2</a>. Informative References ...................................<a href="#page-12">12</a>

<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   COPS [<a href="rfc2748.html" title="&quot;The COPS (Common Open Policy Service) Protocol&quot;">RFC2748</a>] was designed to distribute clear-text policy
   information from a centralized Policy Decision Point (PDP) to a set
   of Policy Enforcement Points (PEP) in the Internet.  COPS provides
   its own security mechanisms to protect the per-hop integrity of the
   deployed policy.  However, the use of COPS for sensitive applications
   (e.g., some types of security policy distribution) requires
   additional security measures, such as data confidentiality.  This is
   because some organizations find it necessary to hide some or all of
   their security policies, e.g., because policy distribution to devices
   such as mobile platforms can cross domain boundaries.

   TLS [<a href="rfc2246.html" title="&quot;The TLS Protocol Version 1.0&quot;">RFC2246</a>] was designed to provide channel-oriented security.  TLS
   standardizes SSL and may be used with any connection-oriented
   service.  TLS provides mechanisms for both one- and two-way
   authentication, dynamic session keying, and data stream privacy and
   integrity.

   This document describes how to use COPS over TLS.  "COPS over TLS" is
   abbreviated COPS/TLS.




<span class="grey">Walker &amp; Kulkarni           Standards Track                     [Page 2]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc4261.html">RFC 4261</a>                     COPS Over TLS                 December 2005</span>


Glossary

   COPS - Common Open Policy Service.  See [<a href="rfc2748.html" title="&quot;The COPS (Common Open Policy Service) Protocol&quot;">RFC2748</a>].

   COPS/TCP - A plain-vanilla implementation of COPS.

   COPS/TLS - A secure implementation of COPS using TLS.

   PDP - Policy Decision Point.  Also referred to as the Policy Server.
         See [<a href="rfc2753.html" title="&quot;A Framework for Policy-based Admission Control&quot;">RFC2753</a>].

   PEP - Policy Enforcement Point.  Also referred to as the Policy
         Client.  See [<a href="rfc2753.html" title="&quot;A Framework for Policy-based Admission Control&quot;">RFC2753</a>].

Conventions used in this document

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  COPS Over TLS</span>

   COPS/TLS is very simple: use COPS over TLS similar to how you would
   use COPS over TCP (COPS/TCP).  Apart from a specific procedure used
   to initialize the connection, there is no difference between COPS/TLS
   and COPS/TCP.

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Separate Ports versus Upward Negotiation</span>

   There are two ways in which insecure and secure versions of the same
   protocol can be run simultaneously.

   In the first method, the secure version of the protocol is also
   allocated a well-known port.  This strategy of having well-known port
   numbers for both, the secure and insecure versions, is known as
   'Separate Ports'.  The clients requiring security can simply connect
   to the well-known secure port.  This method is easy to implement,
   with no modifications needed to existing insecure implementations.
   The disadvantage, however, is that it doesn't scale well, because a
   new port is required for each secure implementation.  More problems
   with this approach have been listed in [<a href="rfc2595.html" title="&quot;Using TLS with IMAP, POP3 and ACAP&quot;">RFC2595</a>].

   The second method is known as 'Upward Negotiation'.  In this method,
   the secure and insecure versions of the protocol run on the same
   port.  The client connects to the server, both discover each others'
   capabilities, and start security negotiations if desired.  This
   method usually requires some changes to the protocol being secured.




<span class="grey">Walker &amp; Kulkarni           Standards Track                     [Page 3]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc4261.html">RFC 4261</a>                     COPS Over TLS                 December 2005</span>


   In view of the many issues with the Separate Ports approach, the
   authors have decided to use the Upward Negotiation method for
   COPS/TLS.

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  COPS/TLS Objects and Error codes</span>

   This section describes the COPS objects and error codes needed to
   support COPS/TLS.

<span class="h3"><a class="selflink" name="section-4.1" href="#section-4.1">4.1</a>.  The TLS Message Integrity Object (Integrity-TLS)</span>

   The TLS Integrity object is used by the PDP and the PEP to start the
   TLS negotiation.  This object should be included only in the Client-
   Open or Client-Accept messages.  It MUST NOT be included in any other
   COPS message.

            0         1          2          3

      +----------+----------+----------+----------+
      |   Length (Octets)   | C-Num=16 | C-Type=2 |
      +----------+----------+----------+----------+
      |       ////////      |        Flags        |
      +----------+----------+----------+----------+

      Note: //// implies the field is reserved, set to 0, and should
            be ignored on receipt.

      Flags: 16 bits
                  0x01 = StartTLS
                  This flag indicates that the sender of the message
                  wishes to initiate a TLS handshake.

   The Client-Type of any message containing this object MUST be 0.
   Client-Type 0 is used to negotiate COPS connection level security and
   must only be used during the connection establishment phase.  Please
   refer to <a href="rfc2748.html#section-4.1">section&nbsp;4.1 of [RFC2748]</a> for more details.

<span class="h3"><a class="selflink" name="section-4.2" href="#section-4.2">4.2</a>.  Error Codes</span>

   This section uses the error codes described in <a href="#section-2.2.8">section 2.2.8</a> (Error
   Object) of [<a href="rfc2748.html" title="&quot;The COPS (Common Open Policy Service) Protocol&quot;">RFC2748</a>].

   Error Code:                13= Unknown COPS Object:








<span class="grey">Walker &amp; Kulkarni           Standards Track                     [Page 4]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc4261.html">RFC 4261</a>                     COPS Over TLS                 December 2005</span>


   Sub-code (octet 2) contains the unknown object's C-Num, and (octet 3)
   contains unknown object's C-Type.  If the PEP or PDP does not support
   TLS, the C-Num specified MUST be 16 and the C-Type MUST be 2.  This
   demonstrates that the TLS version of the Integrity object is not
   known.

   This error code MUST be used by either PEP or PDP to indicate a
   security-related connection closure if it cannot support a TLS
   connection for the COPS protocol.

   If the PDP wishes to negotiate a different security mechanism than
   requested by the PEP in the Client-Open, it MUST send the following
   error code:

   Error Code:                  15= Authentication Required

   Where the Sub-code (octet 2) contains the C-Num=16 value for the
   Integrity Object and (octet 3) MUST specify the PDP
   required/preferred Integrity object C-Type.  If the server does not
   support any form of COPS-Security, it MUST set the Sub-code (octet 2)
   to 16 and (octet 3) to zero instead, signifying that no type of the
   Integrity object is supported.

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  COPS/TLS Secure Connection Initiation</span>

   Security negotiation may be initiated by either the PDP or the PEP.
   The PEP can initiate a negotiation via a Client-Open message, while a
   PDP can initiate a negotiation via a Client-Accept message.

   Once the TLS connection is established, all COPS data MUST be sent as
   TLS "application data".

<span class="h3"><a class="selflink" name="section-5.1" href="#section-5.1">5.1</a>.  PEP Initiated Security Negotiation</span>

   A PEP MAY initiate a TLS security negotiation with a PDP using the
   Client-Open message.  To do this, the Client-Open message MUST have a
   Client-Type of 0 and MUST include the Integrity-TLS object.

   Upon receiving the Client-Open message, the PDP SHOULD respond with a
   Client-Accept message containing the Integrity-TLS object.

   Note that in order to carry the Integrity-TLS object, the contents of
   the Client-Accept message defined in <a href="rfc2748.html#section-3.7">section&nbsp;3.7 of [RFC2748]</a> need
   not change, except that the C-Type of the integrity object contained
   there-in should now be C-Type=2.  For Example:






<span class="grey">Walker &amp; Kulkarni           Standards Track                     [Page 5]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc4261.html">RFC 4261</a>                     COPS Over TLS                 December 2005</span>


      &lt;Client-Accept&gt; ::= &lt;Common Header&gt;
                          &lt;KA Timer&gt;
                          [&lt;ACCT Timer&gt;]
                          [&lt;Integrity (C-Num=16, C-Type=2)&gt;]

   Note also that this new format of the Client-Accept message does not
   replace or obsolete the existing Client-Accept message format, which
   can continue to be used for non-secure COPS session negotiations.

   Upon receiving the appropriate Client-Accept message, the PEP SHOULD
   initiate the TLS handshake.

   The message exchange is as follows:

      C: Client-Open   (Client-Type = 0, Integrity-TLS)
      S: Client-Accept (Client-Type = 0, Integrity-TLS)
      &lt;TLS handshake&gt;
      C/S: &lt;...further messages...&gt;

   In case the PDP does not wish to open a secure connection with the
   PEP, it MUST reply with a Client-Close message and close the
   connection.  The Client-Close message MUST include the error code 15=
   Authentication required, with the Sub-code (octet 2) set to 16 for
   the Integrity object's C-Num, and (octet 3) set to the C-Type
   corresponding to the server's preferred Integrity type, or zero for
   no security.

   A PEP requiring the Integrity-TLS object in a Client-Accept message
   MUST close the connection if the Integrity-TLS object is missing.
   The ensuing Client-Close message MUST include the error code 15=
   Authentication required, with the Sub-code (octet 2) containing the
   required Integrity object's C-Num=16, and (octet 3) containing the
   required Integrity object's C-Type=2.

<span class="h3"><a class="selflink" name="section-5.2" href="#section-5.2">5.2</a>.  PDP Initiated Security Negotiation</span>

   The PEP initially opens a TCP connection with the PDP on the standard
   COPS port and sends a Client-Open message.  This Client-Open message
   MUST have a Client-Type of 0.

   The PDP SHOULD then reply with a Client-Accept message.  In order to
   signal the PEP to start the TLS handshake, the PDP MUST include the
   Integrity-TLS object in the Client-Accept message.

   Upon receiving the Client-Accept message with the Integrity-TLS
   object, the PEP SHOULD initiate the TLS handshake.  If for any reason
   the PEP cannot initiate the handshake, it MUST close the connection.




<span class="grey">Walker &amp; Kulkarni           Standards Track                     [Page 6]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc4261.html">RFC 4261</a>                     COPS Over TLS                 December 2005</span>


   The message exchange is as follows:

      C: Client-Open   (Client-Type = 0)
      S: Client-Accept (Client-Type = 0, Integrity-TLS)
      &lt;TLS handshake&gt;
      C/S: &lt;...further messages...&gt;

   After receiving the Client-Accept, the PEP MUST NOT send any messages
   until the TLS handshake is complete.  Upon receiving any message from
   the PEP before the TLS handshake starts, the PDP MUST issue a
   Client-Close message with an error code 15= Authentication Required.

   A PDP wishing to negotiate security with a PEP having an existing
   non-secure connection MUST send a Client-Close with the error code
   15= Authentication required, with the Sub-code (octet 2) containing
   the required Integrity object's C-Num=16, and (octet 3) containing
   the required Integrity object's C-Type=2, and then wait for the PEP
   to reconnect.  Upon receiving the Client-Open message, it SHOULD use
   the Client-Accept message to initiate security negotiation.

<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Connection Closure</span>

   TLS provides facilities to securely close its connections.  Reception
   of a valid closure alert assures an implementation that no further
   data will arrive on that connection.  The TLS specification requires
   TLS implementations to initiate a closure alert exchange before
   closing a connection.  It also permits TLS implementations to close
   connections without waiting to receive closure alerts from the peer,
   provided they send their own first.  A connection closed in this way
   is known as an "incomplete close".  TLS allows implementations to
   reuse the session in this case, but COPS/TLS makes no use of this
   capability.

   A connection closed without first sending a closure alert is known as
   a "premature close".  Note that a premature close does not call into
   question the security of the data already received, but simply
   indicates that subsequent data might have been truncated.  Because
   TLS is oblivious to COPS message boundaries, it is necessary to
   examine the COPS data itself (specifically the Message header) to
   determine whether truncation occurred.

<span class="h3"><a class="selflink" name="section-6.1" href="#section-6.1">6.1</a>.  PEP System Behavior</span>

   PEP implementations MUST treat premature closes as errors and any
   data received as potentially truncated.  The COPS protocol allows the
   PEP system to find out whether truncation took place.  A PEP system
   detecting an incomplete close SHOULD recover gracefully.




<span class="grey">Walker &amp; Kulkarni           Standards Track                     [Page 7]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc4261.html">RFC 4261</a>                     COPS Over TLS                 December 2005</span>


   PEP systems SHOULD send a closure alert before closing the
   connection.  PEPs unprepared to receive any more data MAY choose not
   to wait for the PDP system's closure alert and simply close the
   connection, thus generating an incomplete close on the PDP side.

<span class="h3"><a class="selflink" name="section-6.2" href="#section-6.2">6.2</a>.  PDP System Behavior</span>

   COPS permits a PEP to close the connection at any time, and requires
   PDPs to recover gracefully.  In particular, PDPs SHOULD be prepared
   to receive an incomplete close from the PEP, since a PEP often shuts
   down for operational reasons unrelated to the transfer of policy
   information between the PEP and PDP.

      Implementation note: The PDP ordinarily expects to be able to
      signal the end of data by closing the connection.  However, the
      PEP may have already sent the closure alert and dropped the
      connection.

   PDP systems MUST attempt to initiate an exchange of closure alerts
   with the PEP system before closing the connection.  PDP systems MAY
   close the connection after sending the closure alert, thus generating
   an incomplete close on the PEP side.

<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  Endpoint Identification and Access Control</span>

   All PEP implementations of COPS/TLS MUST support an access control
   mechanism to identify authorized PDPs.  This requirement provides a
   level of assurance that the policy arriving at the PEP is actually
   valid.  PEP deployments SHOULD require the use of this access control
   mechanism for operation of COPS over TLS.  When access control is
   enabled, the PEP implementation MUST NOT initiate COPS/TLS
   connections to systems not authorized as PDPs by the access control
   mechanism.

   Similarly, PDP COPS/TLS implementations MUST support an access
   control mechanism permitting them to restrict their services to
   authorized PEP systems only.  However, deployments MAY choose not to
   use an access control mechanism at the PDP, as organizations might
   not consider the types of policy being deployed as sensitive, and
   therefore do not need to incur the expense of managing credentials
   for the PEP systems.  If access controls are used, however, the PDP
   implementation MUST terminate COPS/TLS connections from unauthorized
   PEP systems and log an error if an auditable logging mechanism is
   present.

   Implementations of COPS/TLS MUST use X.509 v3 certificates conforming
   to [<a href="rfc3280.html" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC3280</a>] to identify PDP and PEP systems.  COPS/TLS systems MUST
   perform certificate verification processing conforming to [<a href="rfc3280.html" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC3280</a>].



<span class="grey">Walker &amp; Kulkarni           Standards Track                     [Page 8]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc4261.html">RFC 4261</a>                     COPS Over TLS                 December 2005</span>


   If a subjectAltName extension of type dNSName or iPAddress is present
   in the PDP's certificate, it MUST be used as the PDP identity.  If
   both types are present, dNSName SHOULD be used as the PDP identity.
   If neither type is present, the most specific Common Name field in
   the Subject field of the certificate SHOULD be used.

   Matching is performed using the matching rules specified by
   [<a href="rfc3280.html" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC3280</a>].  If more than one identity of a given type is present in
   the certificate (e.g., more than one dNSName in the subjectAltName
   certificate extension), a match in any one of the provided identities
   is acceptable.  Generally, the COPS system uses the first name for
   matching, except as noted below in the IP address checking
   requirements.

<span class="h3"><a class="selflink" name="section-7.1" href="#section-7.1">7.1</a>.  PEP Identity</span>

   When PEP systems are not access controlled, the PDP does not need
   external knowledge of what the PEP's identity ought to be and so
   checks are neither possible nor necessary.  In this case, there is no
   requirement for PEP systems to register with a certificate authority,
   and COPS over TLS uses one-way authentication, of the PDP to the PEP.

   When PEP systems are access controlled, PEPs MUST be the subjects of
   end entity certificates [<a href="rfc3280.html" title="&quot;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile&quot;">RFC3280</a>].  In this case, COPS over TLS uses
   two-way authentication, and the PDP MUST perform the same identity
   checks for the PEPs as described above for the PDP.

   When access controls are in effect at the PDP, PDP implementations
   MUST have a mechanism to securely acquire the trust anchor for each
   authorized Certification Authority (CA) that issues certificates to
   supported PEPs.

<span class="h3"><a class="selflink" name="section-7.2" href="#section-7.2">7.2</a>.  PDP Identity</span>

   Generally, COPS/TLS requests are generated by the PEP consulting
   bootstrap policy information that identifies PDPs that the PEP is
   authorized to connect to.  This policy provides the PEP with the
   hostname or IP address of the PDP.  How this bootstrap policy
   information arrives at the PEP is outside the scope of this document.
   However, all PEP implementations MUST provide a mechanism to securely
   deliver or configure the bootstrap policy.

   All PEP implementations MUST be able to securely acquire the trust
   anchor for each authorized Certification Authority (CA) that issues
   PDP certificates.  Also, the PEPs MUST support a mechanism to
   securely acquire an access control list (ACL) or filter identifying
   the set of authorized PDPs associated with each CA.  Deployments must
   take care to avoid circular dependencies in accessing trust anchors



<span class="grey">Walker &amp; Kulkarni           Standards Track                     [Page 9]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc4261.html">RFC 4261</a>                     COPS Over TLS                 December 2005</span>


   and ACLs.  At a minimum, trust anchors and ACLs may be installed
   manually.

   PEP deployments that participate in multiple domains, such as those
   on mobile platforms, MAY use different CAs and access control lists
   in each domain.

   If the PDP hostname or IP address is available via the bootstrap
   policy, the PEP MUST check it against the PDP's identity as presented
   in the PDP's TLS Certificate message.

   In some cases, the bootstrap policy will identify the authorized PDP
   only by an IP address of the PDP system.  In this case, the
   subjectAltName MUST be present in the certificate, and it MUST
   include an iPAddress format matching the expected name of the policy
   server.

   If the hostname of the PDP does not match the identity in the
   certificate, a PEP on a user-oriented system MUST either notify the
   user (PEP systems MAY afford the user the opportunity to continue
   with the connection in any case) or terminate the connection with a
   bad certificate error.  PEPs on unattended systems MUST log the error
   to an appropriate audit log (if available) and MUST terminate the
   connection with a bad certificate error.  Unattended PEP systems MAY
   provide a configuration setting that disables this check, but then
   MUST provide a setting that enables it.

<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>. Cipher Suite Requirements</span>

   Implementations MUST support the TLS_RSA_WITH_3DES_EDE_CBC_SHA cipher
   suite.  All other cipher suites are optional.

<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  Backward Compatibility</span>

   The PEP and PDP SHOULD be backward compatible with peers that have
   not been modified to support COPS/TLS.  They SHOULD handle errors
   generated in response to the Integrity-TLS object.

<span class="h2"><a class="selflink" name="section-10" href="#section-10">10</a>.  IANA Considerations</span>

   The IANA has added the following C-Num, C-Type combination for the
   Integrity-TLS object to the registry at
   <a href="http://www.iana/">http://www.iana</a>.org/assignments/cops-parameters:

   0x10  0x02    Message Integrity, Integrity-TLS      [<a href="rfc4261.html">RFC4261</a>]






<span class="grey">Walker &amp; Kulkarni           Standards Track                    [Page 10]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc4261.html">RFC 4261</a>                     COPS Over TLS                 December 2005</span>


   For Client-Type 0, the IANA has added the following Flags value for
   the Integrity-TLS object:

      0x01 = StartTLS

   Further, for Client-Type 0, the IANA has added the following text for
   Error Sub-Codes:

      Error Code: 15
      Error Sub-Code:
      Octet 2: C-Num of the Integrity object
      Octet 3: C-Type of the supported/preferred Integrity object or
               Zero.

     Error-Code    Error-SubCode      Description
                 Octet 2  Octet 3
     ---------------------------------------------------
       15          16        0        No security
       15          16        2        Integrity-TLS supported/preferred

   Further values for the Flags field and the reserved field can only be
   assigned by IETF Consensus rule, as defined in [<a href="rfc2434.html" title="&quot;Guidelines for Writing an IANA Considerations Section in RFCs&quot;">RFC2434</a>].

<span class="h2"><a class="selflink" name="section-11" href="#section-11">11</a>.  Security Considerations</span>

   A COPS PDP and PEP MUST check the results of the TLS negotiation to
   see whether an acceptable degree of authentication and privacy have
   been achieved.  If the negotiation has resulted in unacceptable
   algorithms or key lengths, either side MAY choose to terminate the
   connection.

   A man-in-the-middle attack can be launched by deleting the
   Integrity-TLS object or altering the Client-Open or Client-Accept
   messages.  If security is required, the PEP and PDP bootstrap policy
   must specify this, and PEP and PDP implementations should reject
   Client-Open or Client-Accept messages that fail to include an
   Integrity-TLS object.

<span class="h2"><a class="selflink" name="section-12" href="#section-12">12</a>.  Acknowledgements</span>

   This document freely plagiarizes and adapts Eric Rescorla's similar
   document [<a href="rfc2818.html" title="&quot;HTTP Over TLS&quot;">RFC2818</a>] that specifies how HTTP runs over TLS.

   Discussions with David Durham, Scott Hahn, and Ylian Sainte-Hillaire
   also lead to improvements in this document.

   The authors wish to thank Uri Blumenthal for doing a thorough
   security review of the document.



<span class="grey">Walker &amp; Kulkarni           Standards Track                    [Page 11]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc4261.html">RFC 4261</a>                     COPS Over TLS                 December 2005</span>


<span class="h2"><a class="selflink" name="section-13" href="#section-13">13</a>.  References</span>

<span class="h3"><a class="selflink" name="section-13.1" href="#section-13.1">13.1</a>.  Normative References</span>

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>] Bradner, S., "Key words for use in RFCs to Indicate
             Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a name="ref-RFC2748" id="ref-RFC2748">RFC2748</a>] Durham, D., Boyle, J., Cohen, R., Herzog, S., Rajan, R.,
             and A. Sastry, "The COPS (Common Open Policy Service)
             Protocol", <a href="rfc2748.html">RFC 2748</a>, January 2000.

   [<a name="ref-RFC2753" id="ref-RFC2753">RFC2753</a>] Yavatkar, R., Pendarakis, D., and R. Guerin, "A Framework
             for Policy-based Admission Control", <a href="rfc2753.html">RFC 2753</a>, January
             2000.

   [<a name="ref-RFC3280" id="ref-RFC3280">RFC3280</a>] Housley, R., Polk, W., Ford, W., and D. Solo, "Internet
             X.509 Public Key Infrastructure Certificate and Certificate
             Revocation List (CRL) Profile", <a href="rfc3280.html">RFC 3280</a>, April 2002.

   [<a name="ref-RFC2246" id="ref-RFC2246">RFC2246</a>] Dierks, T. and C. Allen, "The TLS Protocol Version 1.0",
             <a href="rfc2246.html">RFC 2246</a>, January 1999.

<span class="h3"><a class="selflink" name="section-13.2" href="#section-13.2">13.2</a>.  Informative References</span>

   [<a name="ref-RFC2818" id="ref-RFC2818">RFC2818</a>] Rescorla, E., "HTTP Over TLS", <a href="rfc2818.html">RFC 2818</a>, May 2000.

   [<a name="ref-RFC2595" id="ref-RFC2595">RFC2595</a>] Newman, C., "Using TLS with IMAP, POP3 and ACAP", <a href="rfc2595.html">RFC 2595</a>,
             June 1999.

   [<a name="ref-RFC2434" id="ref-RFC2434">RFC2434</a>] Narten, T. and H. Alvestrand, "Guidelines for Writing an
             IANA Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc2434.html">RFC 2434</a>,
             October 1998.



















<span class="grey">Walker &amp; Kulkarni           Standards Track                    [Page 12]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey"><a href="rfc4261.html">RFC 4261</a>                     COPS Over TLS                 December 2005</span>


Authors' Addresses

   Amol Kulkarni
   Intel Corporation
   2111 N.E. 25th Avenue
   Hillsboro, OR  97214
   USA

   EMail: amol.kulkarni@intel.com


   Jesse R. Walker
   Intel Corporation
   2111 N.E. 25th Avenue
   Hillsboro, OR  97214
   USA

   EMail: jesse.walker@intel.com

































<span class="grey">Walker &amp; Kulkarni           Standards Track                    [Page 13]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey"><a href="rfc4261.html">RFC 4261</a>                     COPS Over TLS                 December 2005</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2005).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at ietf-
   ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.







Walker &amp; Kulkarni           Standards Track                    [Page 14]

</pre><br />
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.129c, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>
</body>

<!-- Mirrored from tools.ietf.org/html/rfc4261 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 13:17:09 GMT -->
</html>
