<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from tools.ietf.org/html/rfc5062 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:37 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.126" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Relation.Replaces" content="draft-stewart-tsvwg-sctpthreat" />
<meta name="DC.Identifier" content="urn:ietf:rfc:5062" />
<meta name="DC.Date.Issued" content="September, 2007" />
<meta name="DC.Creator" content="Tuexen, Michael" />
<meta name="DC.Creator" content="Camarillo, Gonzalo" />
<meta name="DC.Creator" content="Stewart, Randall" />
<meta name="DC.Description.Abstract" content="This document describes certain security threats to SCTP. It also
describes ways to mitigate these threats, in particular by using
techniques from the SCTP Specification Errata and Issues memo (RFC
4460). These techniques are included in RFC 4960, which obsoletes RFC
2960. It is hoped that this information will provide some useful
background information for many of the newest requirements spelled out
in the SCTP Specification Errata and Issues and included in RFC 4960.
This memo provides information for the Internet community." />
<meta name="DC.Title" content="Security Attacks Found Against the Stream Control Transmission Protocol (SCTP) and Current Countermeasures" />

    <link rel="icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 5062 - Security Attacks Found Against the Stream Control Transmission Protocol (SCTP) and Current Countermeasures</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgorange"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc5062.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc5062" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-tsvwg-sctpthreat" title="draft-ietf-tsvwg-sctpthreat">draft-ietf-tsvw...</a>] [<a href='https://datatracker.ietf.org/doc/rfc5062' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5062" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc5062" title="Side-by-side diff">Diff2</a>]         </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Network Working Group                                         R. Stewart
Request for Comments: 5062                           Cisco Systems, Inc.
Category: Informational                                        M. Tuexen
                                      Muenster Univ. of Applied Sciences
                                                            G. Camarillo
                                                                Ericsson
                                                          September 2007


                    <span class="h1">Security Attacks Found Against</span>
            <span class="h1">the Stream Control Transmission Protocol (SCTP)</span>
                      <span class="h1">and Current Countermeasures</span>

Status of This Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Abstract

   This document describes certain security threats to SCTP.  It also
   describes ways to mitigate these threats, in particular by using
   techniques from the SCTP Specification Errata and Issues memo (<a href="rfc4460.html">RFC</a>
   <a href="rfc4460.html">4460</a>).  These techniques are included in <a href="rfc4960.html">RFC 4960</a>, which obsoletes
   <a href="rfc2960.html">RFC 2960</a>.  It is hoped that this information will provide some useful
   background information for many of the newest requirements spelled
   out in the SCTP Specification Errata and Issues and included in <a href="rfc4960.html">RFC</a>
   <a href="rfc4960.html">4960</a>.






















<span class="grey">Stewart, et al.              Informational                      [Page 1]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc5062.html">RFC 5062</a>                 SCTP Security Attacks            September 2007</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-2">2</a>
   <a href="#section-2">2</a>.  Address Camping or Stealing  . . . . . . . . . . . . . . . . .  <a href="#page-2">2</a>
   <a href="#section-3">3</a>.  Association Hijacking 1  . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-4">4</a>.  Association Hijacking 2  . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
   <a href="#section-5">5</a>.  Bombing Attack (Amplification) 1 . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
   <a href="#section-6">6</a>.  Bombing Attack (Amplification) 2 . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
   <a href="#section-7">7</a>.  Association Redirection  . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
   <a href="#section-8">8</a>.  Bombing Attack (Amplification) 3 . . . . . . . . . . . . . . . <a href="#page-10">10</a>
   <a href="#section-9">9</a>.  Bombing Attack (Amplification) 4 . . . . . . . . . . . . . . . <a href="#page-11">11</a>
   <a href="#section-10">10</a>. Bombing Attack (amplification) 5 . . . . . . . . . . . . . . . <a href="#page-11">11</a>
   <a href="#section-11">11</a>. Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
   <a href="#section-12">12</a>. References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>

<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   Stream Control Transmission Protocol, originally defined in
   [<a href="rfc2960.html" title="&quot;Stream Control Transmission Protocol&quot;">RFC2960</a>], is a multi-homed transport protocol.  As such, unique
   security threats exists that are addressed in various ways within the
   protocol itself.  This document describes certain security threats to
   SCTP.  It also describes ways to mitigate these threats, in
   particular by using techniques from the SCTP Specification Errata and
   Issues memo [<a href="rfc4460.html" title="&quot;Stream Control Transmission Protocol (SCTP) Specification Errata and Issues&quot;">RFC4460</a>].  These techniques are included in [<a href="rfc4960.html" title="&quot;Stream Control Transmission Protocol&quot;">RFC4960</a>],
   which obsoletes [<a href="rfc2960.html" title="&quot;Stream Control Transmission Protocol&quot;">RFC2960</a>].  It is hoped that this information will
   provide some useful background information for many of the newest
   requirements spelled out in the [<a href="rfc4460.html" title="&quot;Stream Control Transmission Protocol (SCTP) Specification Errata and Issues&quot;">RFC4460</a>] and included in [<a href="rfc4960.html" title="&quot;Stream Control Transmission Protocol&quot;">RFC4960</a>].

   This work and some of the changes that went into [<a href="rfc4460.html" title="&quot;Stream Control Transmission Protocol (SCTP) Specification Errata and Issues&quot;">RFC4460</a>] and
   [<a href="rfc4960.html" title="&quot;Stream Control Transmission Protocol&quot;">RFC4960</a>] are much indebted to the paper on potential SCTP security
   risks [<a href="#ref-EFFECTS" title="&quot;Effects of Mobility and Multihoming on Transport-Layer Security&quot;">EFFECTS</a>] by Aura, Nikander, and Camarillo.  Without their
   work, some of these changes would remain undocumented and potential
   threats.

   The rest of this document will concentrate on the various attacks
   that were illustrated in [<a href="#ref-EFFECTS" title="&quot;Effects of Mobility and Multihoming on Transport-Layer Security&quot;">EFFECTS</a>] and detail the preventative
   measures now in place, if any, within the current SCTP standards.

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Address Camping or Stealing</span>

   This attack is a form of denial of service attack crafted around
   SCTP's multi-homing.  In effect, an illegitimate endpoint connects to
   a server and "camps upon" or "holds up" a valid peer's address.  This
   is done to prevent the legitimate peer from communicating with the
   server.






<span class="grey">Stewart, et al.              Informational                      [Page 2]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc5062.html">RFC 5062</a>                 SCTP Security Attacks            September 2007</span>


<span class="h3"><a class="selflink" name="section-2.1" href="#section-2.1">2.1</a>.  Attack Details</span>

      +----------+            +----------+           +----------+
      | Evil     |            |  Server  |           | Client   |
      |     IP-A=+------------+          +-----------+=IP-C &amp; D |
      | Attacker |            |          |           | Victim   |
      +----------+            +----------+           +----------+

                            Figure 1: Camping

   Consider the scenario illustrated in Figure 1.  The attacker
   legitimately holds IP-A and wishes to prevent the 'Client-Victim'
   from communicating with the 'Server'.  Note also that the client is
   multi-homed.  The attacker first guesses the port number our client
   will use in its association attempt.  It then uses this port and sets
   up an association with the server listing not only IP-A but also IP-C
   in its initial INIT chunk.  The server will respond and set up the
   association, noting that the attacker is multi-homed and holds both
   IP-A and IP-C.

   Next, the victim sends in an INIT message listing its two valid
   addresses, IP-C and IP-D.  In response, it will receive an ABORT
   message with possibly an error code indicating that a new address was
   added in its attempt to set up an existing association (a restart
   with new addresses).  At this point, 'Client-Victim' is now prevented
   from setting up an association with the server until the server
   realizes that the attacker does not hold the address IP-C at some
   future point by using a HEARTBEAT based mechanism.  See the
   mitigation option subsection of this section.

<span class="h3"><a class="selflink" name="section-2.2" href="#section-2.2">2.2</a>.  Analysis</span>

   This particular attack was discussed in detail on the SCTP
   implementors list in March of 2003.  Out of that discussion, changes
   were made in the BSD implementation that are now present in
   [<a href="rfc4960.html" title="&quot;Stream Control Transmission Protocol&quot;">RFC4960</a>].  In close examination, this attack depends on a number of
   specific things to occur.

   1) The attacker must set up the association before the victim and
      must correctly guess the port number that the victim will use.  If
      the victim uses any other port number the attack will fail.










<span class="grey">Stewart, et al.              Informational                      [Page 3]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc5062.html">RFC 5062</a>                 SCTP Security Attacks            September 2007</span>


   2) SCTP's existing HEARTBEAT mechanism as defined already in
      [<a href="rfc2960.html" title="&quot;Stream Control Transmission Protocol&quot;">RFC2960</a>] will eventually catch this situation and abort the evil
      attacker's association.  This may take several seconds based on
      default HEARTBEAT timers but the attacker himself will lose any
      association.

   3) If the victim is either not multi-homed, or the address set that
      it uses is completely camped upon by the attacker (in our example
      if the attacker had included IP-D in its INIT as well), then the
      client's INIT message would initiate an association between the
      client and the server while destroying the association between the
      attacker and the server.  From the servers' perspective, this is a
      restart of the association.

<span class="h3"><a class="selflink" name="section-2.3" href="#section-2.3">2.3</a>.  Mitigation Option</span>

   [<a name="ref-RFC4960" id="ref-RFC4960">RFC4960</a>] adds a new set of requirements to better counter this
   attack.  In particular, the HEARTBEAT mechanism was modified so that
   addresses unknown to an endpoint (i.e., presented in an INIT with no
   pre-knowledge given by the application) enter a new state called
   "UNCONFIRMED".  During the time that any address is UNCONFIRMED and
   yet considered available, heartbeating will be done on those
   UNCONFIRMED addresses at an accelerated rate.  This will lessen the
   time that an attacker can "camp" on an address.  In particular, the
   rate of heartbeats to UNCONFIRMED addresses is done every RTO.  Along
   with this expanded rate of heartbeating, a new 64-bit random nonce is
   required to be inside HEARTBEATs to UNCONFIRMED addresses.  In the
   HEARTBEAT-ACK, the random nonce must match the value sent in the
   HEARTBEAT before an address can leave the UNCONFIRMED state.  This
   will prevent an attacker from generating false HEARTBEAT-ACKs with
   the victim's source address(es).  In addition, clients that do not
   need to use a specific port number should choose their port numbers
   on a random basis.  This makes it hard for an attacker to guess that
   number.

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Association Hijacking 1</span>

   Association hijacking is the ability of some other user to assume the
   session created by another endpoint.  In cases of a true man-in-the-
   middle, only a strong end-to-end security model can prevent this.
   However, with the addition of the SCTP extension specified in
   [<a href="rfc5061.html" title="&quot;Stream Control Transmission Protocol (SCTP) Dynamic Address Reconfiguration&quot;">RFC5061</a>], an endpoint that is NOT a man-in-the-middle may be able to
   assume another endpoint's association.








<span class="grey">Stewart, et al.              Informational                      [Page 4]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc5062.html">RFC 5062</a>                 SCTP Security Attacks            September 2007</span>


<span class="h3"><a class="selflink" name="section-3.1" href="#section-3.1">3.1</a>.  Attack Details</span>

   The attack is made possible by any mechanism that lets an endpoint
   acquire some other IP address that was recently in use by an SCTP
   endpoint.  For example, DHCP may be used in a mobile network with
   short IP address lifetimes to reassign IP addresses to migrant hosts.

        IP-A                 DHCP-Server's       Peer-Server
          |
          |
       1  |-DHCP-Rel(IP-A)----&gt;|
       2  |------ASCONF(ADD-IP(IP-B), DEL-IP(IP-A)----&gt;XXlost
         time
          |
          |-DHCP-new-net------&gt;|
       3  |&lt;---Assign (IP-A)
          |
       4  |&lt;------------Tag:X-DATA()------------------
          |
          |-------------INIT()------------------------&gt;
       5  |&lt;------------INIT-ACK()---------------------
          |
       6  |----ASCONF(ADD-IP(IP-Z),DEL-IP(IP-A))------&gt;

                   Figure 2: Association Hijack via DHCP

   At point 1, our valid client releases the IP address IP-A.  It
   presumably acquires a new address (IP-B) and sends an ASCONF to ADD
   the new address and delete to old address at point 2, but this packet
   is lost.  Thus, our peer (Peer-Server) has no idea that the former
   peer is no longer at IP-A.  Now at point 3, a new "evil" peer obtains
   an address via DHCP and it happens to get the re-assigned address
   IP-A.  Our Peer-Server sends a chunk of DATA at point 4.  This
   reveals to the new owner of IP-A that the former owner of IP-A had an
   association with Peer-Server.  So at point 5, the new owner of IP-A
   sends an INIT.  The INIT-ACK is sent back and inside it is a COOKIE.
   The cookie would of course hold tie-tags, which would list both sets
   of tags that could then be used at point 6 to add in any other IP
   addresses that the owner of IP-A holds and thus acquire the
   association.

   It should be noted that this attack is possible in general whenever
   the attacker is able to send packets with source address IP-A and
   receive packets with destination address IP-A.







<span class="grey">Stewart, et al.              Informational                      [Page 5]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc5062.html">RFC 5062</a>                 SCTP Security Attacks            September 2007</span>


<span class="h3"><a class="selflink" name="section-3.2" href="#section-3.2">3.2</a>.  Analysis</span>

   This attack depends on a number of events:

   1) Both endpoints must support the SCTP extension specified in
      [<a href="rfc5061.html" title="&quot;Stream Control Transmission Protocol (SCTP) Dynamic Address Reconfiguration&quot;">RFC5061</a>].

   2) One of the endpoints must be using the SCTP extension for mobility
      specified in [<a href="rfc5061.html" title="&quot;Stream Control Transmission Protocol (SCTP) Dynamic Address Reconfiguration&quot;">RFC5061</a>].

   3) The IP address must be acquired in such a way as to make the
      endpoint the owner of that IP address as far as the network is
      concerned.

   4) The true peer must not receive the ASCONF packet that deletes IP-A
      and adds its new address to the peer before the new "evil" peer
      gets control of the association.

   5) The new "evil" peer must have an alternate address, aside from the
      IP-A that it can add to the association, so it can delete IP-A,
      preventing the real peer from re-acquiring the association when it
      finally retransmits the ASCONF (from step 2).

<span class="h3"><a class="selflink" name="section-3.3" href="#section-3.3">3.3</a>.  Mitigation Option</span>

   [<a name="ref-RFC4960" id="ref-RFC4960">RFC4960</a>] adds a new counter measure to this threat.  It is now
   required that Tie-Tags in the State-Cookie parameter not be the
   actual tags.  Instead, a new pair of two 32-bit nonces must be used
   to represent the real tags within the association.  This prevents the
   attacker from acquiring the real tags and thus prevents this attack.
   Furthermore, the use of the SCTP extension specified in [<a href="rfc5061.html" title="&quot;Stream Control Transmission Protocol (SCTP) Dynamic Address Reconfiguration&quot;">RFC5061</a>]
   requires the use of the authentication mechanism defined in
   [<a href="rfc4895.html" title="&quot;Authenticated Chunks for Stream Control Transmission Protocol (SCTP)&quot;">RFC4895</a>].  This requires the attacker to be able to capture the
   traffic during the association setup.  If in addition an endpoint-
   pair shared key is used, capturing or intercepting these setup
   messages does not enable the attacker to hijack the association.

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Association Hijacking 2</span>

   Association hijacking is the ability of some other user to assume the
   session created by another endpoint.  In cases where an attacker can
   send packets using the victims IP-address as a source address and can
   receive packets with the victims' address as a destination address,
   the attacker can easily restart the association.  If the peer does
   not pay attention to the restart notification, the attacker has taken
   over the association.





<span class="grey">Stewart, et al.              Informational                      [Page 6]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc5062.html">RFC 5062</a>                 SCTP Security Attacks            September 2007</span>


<span class="h3"><a class="selflink" name="section-4.1" href="#section-4.1">4.1</a>.  Attack Details</span>

   Assume that an endpoint E1 having an IP-address A has an SCTP
   association with endpoint E2.  After the attacker is able to receive
   packets to destination address A and send packets with source address
   A, the attacker can perform a full four-way handshake using the IP-
   addresses and port numbers from the received packet.  E2 will
   consider this a restart of the association.  If and only if the SCTP
   user of E2 does not process the restart notification, the user will
   not recognize that the association just restarted.  From this
   perspective, the association has been hijacked.

<span class="h3"><a class="selflink" name="section-4.2" href="#section-4.2">4.2</a>.  Analysis</span>

   This attack depends on a number of circumstances:

   1) The IP address must be acquired in such a way as to make the evil
      endpoint the owner of that IP address as far as the network or
      local LAN is concerned.

   2) The attacker must receive a packet belonging to the association or
      connection.

   3) The other endpoint's user does not pay attention to restart
      notifications.

<span class="h3"><a class="selflink" name="section-4.3" href="#section-4.3">4.3</a>.  Mitigation Option</span>

   It is important to note that this attack is not based on a weakness
   of the protocol, but on the ignorance of the upper layer.  This
   attack is not possible if the upper layer processes the restart
   notifications provided by SCTP as described in <a href="rfc2960.html#section-10">section&nbsp;10 of
   [RFC2960]</a> or [<a href="rfc4960.html" title="&quot;Stream Control Transmission Protocol&quot;">RFC4960</a>].  Note that other IP protocols may also be
   affected by this attack.

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  Bombing Attack (Amplification) 1</span>

   The bombing attack is a method to get a server to amplify packets to
   an innocent victim.

<span class="h3"><a class="selflink" name="section-5.1" href="#section-5.1">5.1</a>.  Attack Details</span>

   This attack is performed by setting up an association with a peer and
   listing the victims IP address in the INIT's list of addresses.
   After the association is setup, the attacker makes a request for a
   large data transfer.  After making the request, the attacker does not
   acknowledge data sent to it.  This then causes the server to re-
   transmit the data to the alternate address, i.e., that of the victim.



<span class="grey">Stewart, et al.              Informational                      [Page 7]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc5062.html">RFC 5062</a>                 SCTP Security Attacks            September 2007</span>


   After waiting an appropriate time period, the attacker acknowledges
   the data for the victim.  At some point, the attackers address is
   considered unreachable since only data sent to the victims address is
   acknowledged.  At this point, the attacker can send strategic
   acknowledgments so that the server continues to send data to the
   victim.

   Alternatively, instead of stopping the sending of SACKs to enforce a
   path failover, the attacker can use the ADD-IP extension to add the
   address of the victim and make that address the primary path.

<span class="h3"><a class="selflink" name="section-5.2" href="#section-5.2">5.2</a>.  Analysis</span>

   This attack depends on a number of circumstances:

   1) The victim must NOT support SCTP, otherwise it would respond with
      an "out of the blue" (OOTB) abort.

   2) The attacker must time its sending of acknowledgments correctly in
      order to get its address into the failed state and the victim's
      address as the only valid alternative.

   3) The attacker must guess TSN values that are accepted by the
      receiver once the bombing begins since it must acknowledge packets
      it is no longer seeing.

<span class="h3"><a class="selflink" name="section-5.3" href="#section-5.3">5.3</a>.  Mitigation Option</span>

   [<a name="ref-RFC4960" id="ref-RFC4960">RFC4960</a>] makes two changes to prevent this attack.  First, it
   details proper handling of ICMP messages.  With SCTP, the ICMP
   messages provide valuable clues to the SCTP stack that can be
   verified with the tags for authenticity.  Proper handling of an ICMP
   protocol unreachable (or equivalent) would cause the association
   setup by the attacker to be immediately failed upon the first
   retransmission to the victim's address.

   The second change made in [<a href="rfc4960.html" title="&quot;Stream Control Transmission Protocol&quot;">RFC4960</a>] is the requirement that no
   address that is not CONFIRMED is allowed to have DATA chunks sent to
   it.  This prevents the switch-over to the alternate address from
   occurring, even when ICMP messages are lost in the network and
   prevents any DATA chunks from being sent to any other destination
   other then the attacker itself.  This also prevents the alternative
   way of using ADD-IP to add the new address and make it the primary
   address.







<span class="grey">Stewart, et al.              Informational                      [Page 8]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc5062.html">RFC 5062</a>                 SCTP Security Attacks            September 2007</span>


   An SCTP implementation should abort the association if it receives a
   SACK acknowledging a TSN that has not been sent.  This makes TSN
   guessing for the attacker quite hard because if the attacker
   acknowledges one TSN too fast, the association will be aborted.

<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Bombing Attack (Amplification) 2</span>

   This attack allows an attacker to use an arbitrary SCTP endpoint to
   send multiple packets to a victim in response to one packet.

<span class="h3"><a class="selflink" name="section-6.1" href="#section-6.1">6.1</a>.  Attack Details</span>

   The attacker sends an INIT listing multiple IP addresses of the
   victim in the INIT's list of addresses to an arbitrary endpoint.
   Optionally, it requests a long cookie lifetime.  Upon reception of
   the INIT-ACK, it stores the cookie and sends it back to the other
   endpoint.  When the other endpoint receives the COOKIE, it will send
   back a COOKIE-ACK to the attacker and up to HB.Max.Burst HEARTBEATS
   to the victim's address(es) (to confirm these addresses).  The victim
   responds with ABORTs or ICMP messages resulting in the removal of the
   TCB at the other endpoint.  The attacker can now resend the stored
   cookie as long as it is valid, and this will again result in up to
   HB.Max.Burst HEARTBEATs sent to the victim('s).

<span class="h3"><a class="selflink" name="section-6.2" href="#section-6.2">6.2</a>.  Analysis</span>

   The multiplication factor is limited by the number of addresses of
   the victim and of the endpoint HB.Max.Burst.  Also, the shorter the
   cookie lifetime, the earlier the attacker has to go through the
   initial stage of sending an INIT instead of just sending the COOKIE.
   It should also be noted that the attack is more effective if large
   HEARTBEATs are used for path confirmation.

<span class="h3"><a class="selflink" name="section-6.3" href="#section-6.3">6.3</a>.  Mitigation Option</span>

   To limit the effectiveness of this attack, the new parameter
   HB.Max.Burst was introduced in [<a href="rfc4960.html" title="&quot;Stream Control Transmission Protocol&quot;">RFC4960</a>] and an endpoint should:

   1) not allow very large cookie lifetimes, even if they are requested.

   2) not use larger HB.Max.Burst parameter values than recommended.
      Note that an endpoint may decide to send only one Heartbeat per
      RTT instead of the maximum (i.e., HB.Max.Burst).  An endpoint that
      chooses this approach will however slow down detection of
      endpoints camping on valid addresses.

   3) not use large HEARTBEATs for path confirmation.




<span class="grey">Stewart, et al.              Informational                      [Page 9]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc5062.html">RFC 5062</a>                 SCTP Security Attacks            September 2007</span>


<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  Association Redirection</span>

   This attack allows an attacker to wrongly set up an association to a
   different endpoint.

<span class="h3"><a class="selflink" name="section-7.1" href="#section-7.1">7.1</a>.  Attack Details</span>

   The attacker sends an INIT sourced from port 'X' and directed towards
   port 'Y'.  When the INIT-ACK is returned, the attacker sends the
   COOKIE-ECHO chunk and either places a different destination or source
   port in the SCTP common header, i.e., X+1 or Y+1.  This possibly sets
   up the association using the modified port numbers.

<span class="h3"><a class="selflink" name="section-7.2" href="#section-7.2">7.2</a>.  Analysis</span>

   This attack depends on the failure of an SCTP implementation to store
   and verify the ports within the COOKIE structure.

<span class="h3"><a class="selflink" name="section-7.3" href="#section-7.3">7.3</a>.  Mitigation Option</span>

   This attack is easily defeated by an implementation including the
   ports of both the source and destination within the COOKIE.  If the
   source and destination ports do not match those within the COOKIE
   chunk when the COOKIE is returned, the SCTP implementation silently
   discards the invalid COOKIE.

<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  Bombing Attack (Amplification) 3</span>

   This attack allows an attacker to use an SCTP endpoint to send a
   large number of packets in response to one packet.

<span class="h3"><a class="selflink" name="section-8.1" href="#section-8.1">8.1</a>.  Attack Details</span>

   The attacker sends a packet to an SCTP endpoint, which requires the
   sending of multiple chunks.  If the SCTP endpoint does not support
   bundling on the sending side, it might send each chunk per packet.
   These packets can either be sent to a victim by using the victim's
   address as the sources address, or it can be considered an attack
   against the network.  Since the chunks, which need to be sent in
   response to the received packet, may not fit into one packet, an
   endpoint supporting bundling on the sending side might send multiple
   packets.

   Examples of these packets are packets containing a lot of unknown
   chunks that require an ERROR chunk to be sent, known chunks that
   initiate the sending of ERROR chunks, packets containing a lot of
   HEARTBEAT chunks, and so on.




<span class="grey">Stewart, et al.              Informational                     [Page 10]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc5062.html">RFC 5062</a>                 SCTP Security Attacks            September 2007</span>


<span class="h3"><a class="selflink" name="section-8.2" href="#section-8.2">8.2</a>.  Analysis</span>

   This attack depends on the fact that the SCTP endpoint does not
   support bundling on the sending side or provides a bad implementation
   of bundling on the sending side.

<span class="h3"><a class="selflink" name="section-8.3" href="#section-8.3">8.3</a>.  Mitigation Option</span>

   First of all, path verification must happen before sending chunks
   other than HEARTBEATs for path verification.  This ensures that the
   above attack cannot be used against other hosts.  To avoid the
   attack, an SCTP endpoint should implement bundling on the sending
   side and should not send multiple packets in response.  If the SCTP
   endpoint does not support bundling on the sending side, it should not
   send in general more than one packet in response to a received one.
   The details of the required handling are described in [<a href="rfc4960.html" title="&quot;Stream Control Transmission Protocol&quot;">RFC4960</a>].

<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  Bombing Attack (Amplification) 4</span>

   This attack allows an attacker to use an SCTP server to send a larger
   packet to a victim than it sent to the SCTP server.

<span class="h3"><a class="selflink" name="section-9.1" href="#section-9.1">9.1</a>.  Attack Details</span>

   The attacker sends packets using the victim's address as the source
   address containing an INIT chunk to an SCTP Server.  The server then
   sends a packet containing an INIT-ACK chunk to the victim, which is
   most likely larger than the packet containing the INIT.

<span class="h3"><a class="selflink" name="section-9.2" href="#section-9.2">9.2</a>.  Analysis</span>

   This attack is a byte and not a packet amplification attack and,
   without protocol changes, is hard to avoid.  A possible method to
   avoid this attack would be the usage the PAD parameter defined in
   [<a href="rfc4820.html" title="&quot;Padding Chunk and Parameter for the Stream Control Transmission Protocol (SCTP)&quot;">RFC4820</a>].

<span class="h3"><a class="selflink" name="section-9.3" href="#section-9.3">9.3</a>.  Mitigation Option</span>

   A server should be implemented in a way that the generated INIT-ACK
   chunks are as small as possible.

<span class="h2"><a class="selflink" name="section-10" href="#section-10">10</a>.  Bombing Attack (amplification) 5</span>

   This attack allows an attacker to use an SCTP endpoint to send a
   large number of packets in response to one packet.






<span class="grey">Stewart, et al.              Informational                     [Page 11]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc5062.html">RFC 5062</a>                 SCTP Security Attacks            September 2007</span>


<span class="h3"><a class="selflink" name="section-10.1" href="#section-10.1">10.1</a>.  Attack Details</span>

   The attacker sends a packet to an SCTP endpoint, which requires the
   sending of multiple chunks.  If the MTU towards the attacker is
   smaller than the MTU towards the victim, the victim might need to
   send more than one packet to send all the chunks.  The difference
   between the MTUs might be extremely large if the attacker sends
   malicious ICMP packets to make use of the path MTU discovery.

<span class="h3"><a class="selflink" name="section-10.2" href="#section-10.2">10.2</a>.  Analysis</span>

   This attack depends on the fact that an SCTP implementation might not
   limit the number of response packets correctly.

<span class="h3"><a class="selflink" name="section-10.3" href="#section-10.3">10.3</a>.  Mitigation Option</span>

   First of all, path verification must happen before sending chunks
   other than HEARTBEATs for path verification.  This makes sure that
   the above attack cannot be used against other hosts.  To avoid the
   attack, an SCTP endpoint should not send multiple packets in response
   to a single packet.  The chunks not fitting in this packet should be
   dropped.

<span class="h2"><a class="selflink" name="section-11" href="#section-11">11</a>.  Security Considerations</span>

   This document is about security; as such, there are no additional
   security considerations.

<span class="h2"><a class="selflink" name="section-12" href="#section-12">12</a>.  References</span>

<span class="h3"><a class="selflink" name="section-12.1" href="#section-12.1">12.1</a>.  Normative References</span>

   [<a name="ref-RFC2960" id="ref-RFC2960">RFC2960</a>]  Stewart, R., Xie, Q., Morneault, K., Sharp, C.,
              Schwarzbauer, H., Taylor, T., Rytina, I., Kalla, M.,
              Zhang, L., and V. Paxson, "Stream Control Transmission
              Protocol", <a href="rfc2960.html">RFC 2960</a>, October 2000.

   [<a name="ref-RFC4460" id="ref-RFC4460">RFC4460</a>]  Stewart, R., Arias-Rodriguez, I., Poon, K., Caro, A., and
              M. Tuexen, "Stream Control Transmission Protocol (SCTP)
              Specification Errata and Issues", <a href="rfc4460.html">RFC 4460</a>, April 2006.

   [<a name="ref-RFC4820" id="ref-RFC4820">RFC4820</a>]  Tuexen, M., Stewart, R., and P. Lei, "Padding Chunk and
              Parameter for the Stream Control Transmission Protocol
              (SCTP)", <a href="rfc4820.html">RFC 4820</a>, March 2007.

   [<a name="ref-RFC4895" id="ref-RFC4895">RFC4895</a>]  Tuexen, M., Stewart, R., Lei, P., and E. Rescorla,
              "Authenticated Chunks for Stream Control Transmission
              Protocol (SCTP)", <a href="rfc4895.html">RFC 4895</a>, August 2007.



<span class="grey">Stewart, et al.              Informational                     [Page 12]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey"><a href="rfc5062.html">RFC 5062</a>                 SCTP Security Attacks            September 2007</span>


   [<a name="ref-RFC5061" id="ref-RFC5061">RFC5061</a>]  Stewart, R., Xie, Q., Tuexen, M., Maruyama, S., and M.
              Kozuka, "Stream Control Transmission Protocol (SCTP)
              Dynamic Address Reconfiguration", <a href="rfc5061.html">RFC 5061</a>,
              September 2007.

   [<a name="ref-RFC4960" id="ref-RFC4960">RFC4960</a>]  Stewart, R., Ed., "Stream Control Transmission Protocol",
              <a href="rfc4960.html">RFC 4960</a>, June 2007.

<span class="h3"><a class="selflink" name="section-12.2" href="#section-12.2">12.2</a>.  Informative References</span>

   [<a name="ref-EFFECTS" id="ref-EFFECTS">EFFECTS</a>]  Aura, T., Nikander, P., and G. Camarillo, "Effects of
              Mobility and Multihoming on Transport-Layer Security",
              Security and Privacy 2004, IEEE Symposium , URL <a href="http://research.microsoft.com/users/tuomaura/Publications/">http://</a>
              <a href="http://research.microsoft.com/users/tuomaura/Publications/">research.microsoft.com/users/tuomaura/Publications/</a>
              aura-nikander-camarillo-ssp04.pdf, May 2004.

Authors' Addresses

   Randall R. Stewart
   Cisco Systems, Inc.
   4785 Forest Drive
   Suite 200
   Columbia, SC  29206
   USA

   EMail: rrs@cisco.com


   Michael Tuexen
   Muenster Univ. of Applied Sciences
   Stegerwaldstr. 39
   48565 Steinfurt
   Germany

   EMail: tuexen@fh-muenster.de


   Gonzalo Camarillo
   Ericsson
   Hirsalantie 11
   Jorvas  02420
   Finland

   EMail: Gonzalo.Camarillo@ericsson.com







<span class="grey">Stewart, et al.              Informational                     [Page 13]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey"><a href="rfc5062.html">RFC 5062</a>                 SCTP Security Attacks            September 2007</span>


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.












Stewart, et al.              Informational                     [Page 14]

</pre><br />
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>
</body>

<!-- Mirrored from tools.ietf.org/html/rfc5062 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:37 GMT -->
</html>
