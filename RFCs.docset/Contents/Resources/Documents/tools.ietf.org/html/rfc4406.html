<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc4406 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:41 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:4406" name="DC.Identifier"/>
<meta content='Internet mail suffers from the fact that much unwanted mail is sent
using spoofed addresses -- "spoofed" in this case means that the
address is used without the permission of the domain owner. This
document describes a family of tests by which SMTP servers can
determine whether an e-mail address in a received message was used
with the permission of the owner of the domain contained in that
e-mail address. This memo defines an Experimental Protocol for the
Internet community.' name="DC.Description.Abstract"/>
<meta content="Wong, Meng Weng" name="DC.Creator"/>
<meta content="Lyon, Jim" name="DC.Creator"/>
<meta content="April, 2006" name="DC.Date.Issued"/>
<meta content="Sender ID: Authenticating E-Mail" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 4406 - Sender ID: Authenticating E-Mail</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgyellow" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc4406.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc4406" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-lyon-senderid-core" title="draft-lyon-senderid-core">draft-lyon-send...</a>] [<a href="https://datatracker.ietf.org/doc/rfc4406" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4406" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc4406" title="Side-by-side diff">Diff2</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=4406&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>]   </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                            EXPERIMENTAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                            J. Lyon
Request for Comments: 4406                               Microsoft Corp.
Category: Experimental                                           M. Wong
                                                               pobox.com
                                                              April 2006


                    <span class="h1">Sender ID: Authenticating E-Mail</span>

Status of This Memo

   This memo defines an Experimental Protocol for the Internet
   community.  It does not specify an Internet standard of any kind.
   Discussion and suggestions for improvement are requested.
   Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2006).

IESG Note

   The following documents  (<a href="rfc4405.html">RFC 4405</a>, <a href="rfc4406.html">RFC 4406</a>, <a href="rfc4407.html">RFC 4407</a>, and <a href="rfc4408.html">RFC 4408</a>)
   are published simultaneously as Experimental RFCs, although there is
   no general technical consensus and efforts to reconcile the two
   approaches have failed.  As such, these documents have not received
   full IETF review and are published "AS-IS" to document the different
   approaches as they were considered in the MARID working group.

   The IESG takes no position about which approach is to be preferred
   and cautions the reader that there are serious open issues for each
   approach and concerns about using them in tandem.  The IESG believes
   that documenting the different approaches does less harm than not
   documenting them.

   Note that the Sender ID experiment may use DNS records that may have
   been created for the current SPF experiment or earlier versions in
   this set of experiments.  Depending on the content of the record,
   this may mean that Sender-ID heuristics would be applied incorrectly
   to a message.  Depending on the actions associated by the recipient
   with those heuristics, the message may not be delivered or may be
   discarded on receipt.

   Participants relying on Sender ID experiment DNS records are warned
   that they may lose valid messages in this set of circumstances.
   Participants publishing SPF experiment DNS records should consider





<span class="grey">Lyon &amp; Wong                   Experimental                      [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc4406.html">RFC 4406</a>            Sender ID: Authenticating E-Mail          April 2006</span>


   the advice given in <a href="rfc4406.html#section-3.4">section 3.4 of RFC 4406</a> and may wish to publish
   both v=spf1 and spf2.0 records to avoid the conflict.

   Participants in the Sender-ID experiment need to be aware that the
   way Resent-* header fields are used will result in failure to receive
   legitimate email when interacting with standards-compliant systems
   (specifically automatic forwarders which comply with the standards by
   not adding Resent-* headers, and systems which comply with <a href="rfc822.html">RFC 822</a>
   but have not yet implemented <a href="rfc2822.html">RFC 2822</a> Resent-* semantics).  It would
   be inappropriate to advance Sender-ID on the standards track without
   resolving this interoperability problem.

   The community is invited to observe the success or failure of the two
   approaches during the two years following publication, in order that
   a community consensus can be reached in the future.

Abstract

   Internet mail suffers from the fact that much unwanted mail is sent
   using spoofed addresses -- "spoofed" in this case means that the
   address is used without the permission of the domain owner.  This
   document describes a family of tests by which SMTP servers can
   determine whether an e-mail address in a received message was used
   with the permission of the owner of the domain contained in that
   e-mail address.


























<span class="grey">Lyon &amp; Wong                   Experimental                      [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc4406.html">RFC 4406</a>            Sender ID: Authenticating E-Mail          April 2006</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Conventions Used in This Document ..........................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. Problem Statement ...............................................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. SPF 2.0 Records .................................................<a href="#page-5">5</a>
      <a href="#section-3.1">3.1</a>. Version and Scope ..........................................<a href="#page-5">5</a>
           <a href="#section-3.1.1">3.1.1</a>. Minor Version .......................................<a href="#page-6">6</a>
      <a href="#section-3.2">3.2</a>. Multiple Records ...........................................<a href="#page-6">6</a>
      <a href="#section-3.3">3.3</a>. Positional Modifiers .......................................<a href="#page-7">7</a>
      <a href="#section-3.4">3.4</a>. Compatibility ..............................................<a href="#page-8">8</a>
   <a href="#section-4">4</a>. Decision Model ..................................................<a href="#page-8">8</a>
      <a href="#section-4.1">4.1</a>. Arguments ..................................................<a href="#page-9">9</a>
      <a href="#section-4.2">4.2</a>. Results ....................................................<a href="#page-9">9</a>
      <a href="#section-4.3">4.3</a>. Record Lookup ..............................................<a href="#page-9">9</a>
      <a href="#section-4.4">4.4</a>. Record Selection ...........................................<a href="#page-9">9</a>
   <a href="#section-5">5</a>. Actions Based on the Decision ..................................<a href="#page-10">10</a>
      <a href="#section-5.1">5.1</a>. Neutral, None, SoftFail, or PermError .....................<a href="#page-11">11</a>
      <a href="#section-5.2">5.2</a>. Pass ......................................................<a href="#page-11">11</a>
      <a href="#section-5.3">5.3</a>. Fail ......................................................<a href="#page-11">11</a>
      <a href="#section-5.4">5.4</a>. TempError .................................................<a href="#page-11">11</a>
   <a href="#section-6">6</a>. Security Considerations ........................................<a href="#page-11">11</a>
      <a href="#section-6.1">6.1</a>. DNS Attacks ...............................................<a href="#page-12">12</a>
      <a href="#section-6.2">6.2</a>. TCP Attacks ...............................................<a href="#page-12">12</a>
      <a href="#section-6.3">6.3</a>. Forged Sender Attacks .....................................<a href="#page-12">12</a>
      <a href="#section-6.4">6.4</a>. Address Space Hijacking ...................................<a href="#page-12">12</a>
      <a href="#section-6.5">6.5</a>. Malicious DNS Attacks on Third Parties ....................<a href="#page-13">13</a>
   <a href="#section-7">7</a>. Implementation Guidance ........................................<a href="#page-13">13</a>
      <a href="#section-7.1">7.1</a>. Simple E-Mailers ..........................................<a href="#page-14">14</a>
      <a href="#section-7.2">7.2</a>. E-Mail Forwarders .........................................<a href="#page-14">14</a>
      <a href="#section-7.3">7.3</a>. Mailing List Servers ......................................<a href="#page-15">15</a>
      <a href="#section-7.4">7.4</a>. Third-Party Mailers .......................................<a href="#page-15">15</a>
      <a href="#section-7.5">7.5</a>. MUA Implementers ..........................................<a href="#page-15">15</a>
   <a href="#section-8">8</a>. Acknowledgements ...............................................<a href="#page-16">16</a>
   <a href="#section-9">9</a>. References .....................................................<a href="#page-17">17</a>
      <a href="#section-9.1">9.1</a>. Normative References ......................................<a href="#page-17">17</a>
      <a href="#section-9.2">9.2</a>. Informative References ....................................<a href="#page-17">17</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   Today, a huge majority of unwanted e-mail contains headers that lie
   about the origin of the mail.  This is true of most spam and
   substantially all of the virus e-mail that is sent.

   This document describes a mechanism such that receiving Mail Transfer
   Agents (MTAs), Mail Delivery Agents (MDAs), and/or Mail User Agents
   (MUAs) can recognize mail in the above category and take appropriate
   action.  For example, an MTA might refuse to accept a message, an MDA



<span class="grey">Lyon &amp; Wong                   Experimental                      [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc4406.html">RFC 4406</a>            Sender ID: Authenticating E-Mail          April 2006</span>


   might discard a message rather than placing it into a mailbox, and an
   MUA might render that message in some distinctive fashion.

   In order to avoid further fragmentation of the Internet e-mail
   system, it is desirable that the Internet community as a whole come
   to a consensus as to what mail senders should do to make their mail
   appear non-spoofed, and how mail receivers should determine whether
   mail is spoofed.  On the other hand, it is not necessary to reach a
   consensus regarding the actions that various parties take once a
   message has been determined to be spoofed.  This can be done
   unilaterally -- one agent might decide to discard a spoofed message
   whereas another decides to add a disclaimer.

   This document defines a pair of closely-related tests.  One validates
   a message's Purported Responsible Address (PRA) as defined in
   [<a href="rfc4407.html" title='"Purported Responsible Address in E-Mail Messages"'>RFC4407</a>].  The other validates a message's Reverse-Path (also known
   as MAIL-FROM address) as defined in [<a href="rfc4408.html" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail"'>RFC4408</a>].

   An e-mail sender complying with this specification SHOULD publish
   information for both tests, and SHOULD arrange that any mail that is
   sent will pass both tests.  An e-mail receiver complying with this
   specification SHOULD perform at least one of these tests.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Conventions Used in This Document</span>

   In this document, the key words "MUST", "MUST NOT", "REQUIRED",
   "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
   and "OPTIONAL" are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Problem%20Statement"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Problem Statement</span>

   Briefly stated, the mechanisms of this document allow one to answer
   the following question:

      When a message is transferred via SMTP between two unrelated
      parties, does the SMTP client host have permission to send mail on
      behalf of a mailbox referenced by the message?

   As seen from the question, this mechanism applies to unrelated
   parties:  It is useful at the point where a message passes across the
   Internet from one organization to another.  It is beyond the scope of
   this document to describe authentication mechanisms that can be
   deployed within an organization.

   The PRA version of the test seeks to authenticate the mailbox
   associated with the most recent introduction of a message into the
   mail delivery system.  In simple cases, this is who the mail is from.
   However, in the case of a third-party mailer, a forwarder, or a



<span class="grey">Lyon &amp; Wong                   Experimental                      [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc4406.html">RFC 4406</a>            Sender ID: Authenticating E-Mail          April 2006</span>


   mailing list server, the address being authenticated is that of the
   third party, the forwarder, or the mailing list.

   On the other hand, the MAIL-FROM version of the test seeks to
   authenticate the mailbox that would receive Delivery Status
   Notifications (DSNs, or bounces) for the message.  In simple cases,
   this too is who the mail is from.  However, third-party mailers,
   forwarders, and mailing list servers MUST specify an address under
   their control, and SHOULD arrange that DSNs received at this address
   are forwarded to the original bounce address.

   In both cases, the domain associated with an e-mail address is what
   is authenticated; no attempt is made to authenticate the local-part.
   A domain owner gets to determine which SMTP clients speak on behalf
   of addresses within the domain; a responsible domain owner should not
   authorize SMTP clients that will lie about local parts.

   In the long run, once the domain of the sender is authenticated, it
   will be possible to use that domain as part of a mechanism to
   determine the likelihood that a given message is spam, using, for
   example, reputation and accreditation services. (These services are
   not the subject of the present mechanism, but it should enable them.)

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20SPF%202.0%20Records"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  SPF 2.0 Records</span>

   Domains declare which hosts are and are not authorized to transmit
   e-mail messages on their behalf by publishing Sender Policy Framework
   (SPF) records in the Domain Name System.  [<a href="rfc4408.html" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail"'>RFC4408</a>] defines a format
   for these records identified by the version prefix "v=spf1".  This
   section defines an amended format, identified by the version prefix
   "spf2.0", that allows sending domains to explicitly specify how their
   records should be interpreted, and provides for additional
   extensibility.  Sending domains MAY publish either or both formats.

   Since the two formats are identical in most respects, the following
   subsections define the "spf2.0" format relative to [<a href="rfc4408.html" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail"'>RFC4408</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Version%20and%20Scope"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Version and Scope</span>

   Under Sender ID, receiving domains may perform a check of either the
   PRA identity or the MAIL-FROM identity.  Sending domains therefore
   require a method for declaring whether their published list of
   authorized outbound e-mail servers can be used for the PRA check, the
   MAIL-FROM check, or both.

   This section replaces the definition of the version identifier in
   <a href="rfc4408.html#section-4.5">Section 4.5 of [RFC4408]</a> and adds the concept of SPF record scopes.




<span class="grey">Lyon &amp; Wong                   Experimental                      [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc4406.html">RFC 4406</a>            Sender ID: Authenticating E-Mail          April 2006</span>


   SPF records begin with a version identifier and may also include a
   scope:

      record      = version terms *SP
      version     = "v=spf1" | ( "spf2." ver-minor scope)
      ver-minor   = 1*DIGIT
      scope       = "/" scope-id *( "," scope-id )
      scope-id    = "mfrom" / "pra" / name

   For example, the SPF record

          spf2.0/mfrom,pra +mx +ip4:192.168.0.100 -all

   defines an SPF record that can be used for either MAIL FROM or PRA
   checks.

   This document only defines the existence of two scopes: "mfrom" and
   "pra".  The details of these two scopes are defined in other
   documents: "mfrom" is defined in [<a href="rfc4408.html" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail"'>RFC4408</a>]; "pra" is defined in
   [<a href="rfc4407.html" title='"Purported Responsible Address in E-Mail Messages"'>RFC4407</a>].

   Other scopes may be defined by future documents only.  There is no
   registry for scopes.  A scope definition must define what it
   identifies as the sending mailbox for a message, how to extract that
   information from a message, how to determine the initial arguments
   for the check_host() function, and what the compliant responses to
   the result are.  This ensures that domains with published records and
   mail receiver agree on the semantics of the scope.

   A compliant domain SHOULD publish authorizations for every defined
   scope.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.1.%20%20Minor%20Version"></a><a class="selflink" href="#section-3.1.1" name="section-3.1.1">3.1.1</a>.  Minor Version</span>

   All published records that use the "spf2" version identifier MUST
   start with "spf2.0".  This document only specifies records with a
   minor version of "0".

   Future versions of this document may define other minor versions to
   be used.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Multiple%20Records"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Multiple Records</span>

   A domain MAY publish multiple SPF 2.0 records, provided that each
   scope appears in at most one SPF 2.0 record.  In addition, a domain
   MAY also publish an SPF record that uses the "v=spf1" version
   identifier defined in [<a href="rfc4408.html" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail"'>RFC4408</a>].  The selection rules in <a href="#section-4.4">Section 4.4</a>
   define the precedence of these records.



<span class="grey">Lyon &amp; Wong                   Experimental                      [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc4406.html">RFC 4406</a>            Sender ID: Authenticating E-Mail          April 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Positional%20Modifiers"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Positional Modifiers</span>

   This section replaces <a href="rfc4408.html#section-4.6.3">Section 4.6.3 of [RFC4408]</a> and adds the concept
   of positional modifiers.

   Modifiers are key/value pairs that affect the evaluation of the
   check_host() function.

   Modifiers are either global or positional:

      Global modifiers MAY appear anywhere in the record, but SHOULD
      appear at the end, after all mechanisms and positional modifiers.

      Positional modifiers apply only to the mechanism they follow.  It
      is a syntax error for a positional modifier to appear before the
      first mechanism.

   Modifiers of either type are also either singular or multiple:

      Singular modifiers may appear only once in the record if they are
      global, or once after each mechanism if they are positional.

      Multiple modifiers may appear multiple times in the record if they
      are global, or multiple times after each mechanism if they are
      positional.

   A modifier is not allowed to be defined as both global and
   positional.

   The modifiers "redirect" and "exp" described in <a href="rfc4408.html#section-6">Section 6 of
   [RFC4408]</a> are global and singular.

   Ordering of modifiers does not matter, except that:

   1. positional modifiers must appear after the mechanism they affect
      and before any subsequent mechanisms; and

   2. when a multiple modifier appears more than one time, the ordering
      of the appearances may be significant to the modifier.

   Other than these constraints, implementations MUST treat different
   orders of modifiers the same.  An intended side effect of these rules
   is that modifiers cannot be defined that modify other modifiers.

   These rules allow an implementation to correctly pre-parse a record.
   Furthermore, they are crafted to allow the parsing algorithm to be
   stable, even when new modifiers are introduced.




<span class="grey">Lyon &amp; Wong                   Experimental                      [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc4406.html">RFC 4406</a>            Sender ID: Authenticating E-Mail          April 2006</span>


   Modifiers that are unrecognized MUST be ignored.  This allows older
   implementations to handle records with modifiers that were defined
   after they were written.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Compatibility"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Compatibility</span>

   Domain administrators complying with this specification are required
   to publish information in DNS regarding their authorized outbound
   e-mail servers.  [<a href="rfc4408.html" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail"'>RFC4408</a>] describes a format for this information
   identified by the version prefix "v=spf1".  Many domains have
   published information in DNS using this format.  In order to provide
   compatibility for these domains, Sender ID implementations SHOULD
   interpret the version prefix "v=spf1" as equivalent to
   "spf2.0/mfrom,pra", provided no record starting with "spf2.0" exists.

   Administrators who have already published "v=spf1" records SHOULD
   review these records to determine whether they are also valid for use
   with PRA checks.  If the information in a "v=spf1" record is not
   correct for a PRA check, administrators SHOULD publish either an
   "spf2.0/pra" record with correct information or an "spf2.0/pra ?all"
   record indicating that the result of a PRA check is explicitly
   inconclusive.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Decision%20Model"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Decision Model</span>

   Sender ID enables receiving e-mail systems to answer the following
   question:

   Given an e-mail message, and given an IP address from which it has
   been (or will be) received, is the SMTP client at that IP address
   authorized to send that e-mail message?

   This question will usually be asked by an SMTP server as part of
   deciding whether to accept an incoming mail message.  However, this
   question could also be asked later by a different party.  An MUA, for
   example, could use the result of this question to determine how to
   file or present a message.

   There are three steps to answering this question:

   1. From an e-mail message, extract the address to verify.  The PRA
      variant of this test does so as specified in [<a href="rfc4407.html" title='"Purported Responsible Address in E-Mail Messages"'>RFC4407</a>], or
      alternatively, using the submitter address as specified in
      [<a href="rfc4405.html" title='"SMTP Service Extension for Indicating the Responsible Submitter of an E-Mail Message"'>RFC4405</a>].  The MAIL FROM variant of this test does so as
      specified in [<a href="rfc4408.html" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail"'>RFC4408</a>].

   2. Extract the domain part of the address determined in step 1.




<span class="grey">Lyon &amp; Wong                   Experimental                      [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc4406.html">RFC 4406</a>            Sender ID: Authenticating E-Mail          April 2006</span>


   3. Call the check_host() function defined in [<a href="rfc4408.html" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail"'>RFC4408</a>] and modified
      by the following subsections.

   If the Sender ID check is being performed by an MTA as part of
   receiving an e-mail message, and it cannot determine an address in
   step 1 above (because the message or address is malformed), then the
   message SHOULD be rejected with error "550 5.7.1 Missing Purported
   Responsible Address" or error "550 5.7.1 Missing Reverse-Path
   address".

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Arguments"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Arguments</span>

   Sender ID modifies the check_host() function by the addition of a
   scope parameter.  Thus, for Sender ID the check_host() function is
   called passing the following parameters:

      a. A scope of "pra" (for the PRA variant of the test), or "mfrom"
         (for the MAIL FROM variant of the test).
      b. The IP address (either IPv4 or IPv6) from which the message is
         being or has been received.
      c. The domain from step 2 above.
      d. The address from step 1 above.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Results"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Results</span>

   The result of the check_host() function is one of the values
   "Neutral", "Pass", "Fail", "SoftFail", "None", "TempError", or
   "PermError".  <a href="#section-5">Section 5</a> describes how these results are used by MTAs
   receiving messages.  This specification imposes no requirements on
   parties performing this test in other environments.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Record%20Lookup"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Record Lookup</span>

   SPF records are looked up in DNS in accordance with <a href="rfc4408.html#section-4.4">Section 4.4 of
   [RFC4408]</a>.

   When performing the PRA version of the test, if the DNS query returns
   "non-existent domain" (RCODE 3), then check_host() exits immediately
   with the result "Fail".

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.4.%20%20Record%20Selection"></a><a class="selflink" href="#section-4.4" name="section-4.4">4.4</a>.  Record Selection</span>

   This section replaces the record selection steps described in <a href="rfc4408.html#section-4.5">Section</a>
   <a href="rfc4408.html#section-4.5">4.5 of [RFC4408]</a>.

   Starting with the set of records that were returned by the lookup,
   record selection proceeds in these steps:




<span class="grey">Lyon &amp; Wong                   Experimental                      [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc4406.html">RFC 4406</a>            Sender ID: Authenticating E-Mail          April 2006</span>


   1. If any records of type SPF are in the set, then all records of
      type TXT are discarded.

   2. Records that do not begin with proper version and scope sections
      are discarded.  The version section for "spf2" records contains a
      ver-minor field that is for backward-compatible future extensions.
      This field must be well formed for a record to be retained, but is
      otherwise ignored.

   3. Records that use the "spf2" version identifier and do not have a
      scope-id that matches &lt;scope&gt; are discarded.  Note that this is a
      complete string match on the scope-id tokens: If &lt;scope&gt; is "pra",
      then the record starting "spf2.0/mfrom,prattle,fubar" would be
      discarded, but a record starting "spf2.0/mfrom,pra,fubar" would be
      retained.

   4. If the lookup returned two records, one containing the "v=spf1"
      version identifier and the other containing the "spf2" version
      identifier, the "spf2" version takes precedence for the desired
      scope-id.  If the "spf2" record does not contain the desired
      scope-id, then the "v=spf1" record is selected.

   5. If an "spf2" record does not contain the desired scope-id and
      there is no "v=spf1" record for the domain, then no record is
      selected.

   After the above steps, there should be one record remaining and
   evaluation can proceed.  If there are two or more records remaining,
   then check_host() exits immediately with the error "PermError".

   If there are no matching records remaining after the initial DNS
   query or any subsequent optional DNS queries, then check_host() exits
   immediately with the result "None".

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Actions%20Based%20on%20the%20Decision"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Actions Based on the Decision</span>

   When the Sender ID test is used by an SMTP server as part of
   receiving a message, the server should take the actions described by
   this section.

   The check_host() function returns one of the following results.  See
   [<a href="rfc4408.html" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail"'>RFC4408</a>] for the meaning of these results.









<span class="grey">Lyon &amp; Wong                   Experimental                     [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc4406.html">RFC 4406</a>            Sender ID: Authenticating E-Mail          April 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Neutral%2C%20None%2C%20SoftFail%2C%20or%20PermError"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Neutral, None, SoftFail, or PermError</span>

   An SMTP server receiving one of these results SHOULD NOT reject the
   message for this reason alone, but MAY subject the message to
   heightened scrutiny by other measures, and MAY reject the message as
   a result of this heightened scrutiny.

   Such additional security measures MAY take into account that a
   message for which the result is "SoftFail" is less likely to be
   authentic than a message for which the result is "Neutral".

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Pass"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Pass</span>

   An SMTP server receiving this result SHOULD treat the message as
   authentic.  It may accept or reject the message depending on other
   policies.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Fail"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Fail</span>

   When performing the Sender ID test during an SMTP transaction, an MTA
   that chooses to reject a message receiving this result SHOULD reject
   the message with a "550 5.7.1 Sender ID (xxx) yyy - zzz" SMTP error,
   where "xxx" is replaced with "PRA" or "MAIL FROM", "yyy" is replaced
   with the additional reason returned by the check_host() function, and
   "zzz" is replaced with the explanation string returned by the
   check_host() function.

   When performing the Sender ID test after accepting an e-mail message
   for delivery, an MTA that chooses to reject a message receiving this
   result SHOULD NOT deliver the message.  Instead, it should create a
   DSN message, consistent with the usual rules for DSN messages.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20TempError"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  TempError</span>

   An SMTP server receiving this result MAY reject the message with a
   "450 4.4.3 Sender ID check is temporarily unavailable" error code.
   Alternatively, an SMTP server receiving this result MAY accept a
   message and optionally subject it to heightened scrutiny by other
   anti-spam measures.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Security Considerations</span>

   This entire document describes a new mechanism for mitigating spoofed
   e-mail, which is today a pervasive security problem in the Internet.

   Assuming that this mechanism is widely deployed, the following
   sections describe counter attacks that could be used to defeat this
   mechanism.



<span class="grey">Lyon &amp; Wong                   Experimental                     [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc4406.html">RFC 4406</a>            Sender ID: Authenticating E-Mail          April 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20DNS%20Attacks"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  DNS Attacks</span>

   The new mechanism is entirely dependent on DNS lookups, and is
   therefore only as secure as DNS.  An attacker bent on spoofing
   messages could attempt to get his messages accepted by sending forged
   answers to DNS queries.

   An MTA could largely defeat such an attack by using a properly
   paranoid DNS resolver.  DNS Security (DNSSEC) may ultimately provide
   a way to completely neutralize this class of attacks.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20TCP%20Attacks"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  TCP Attacks</span>

   This mechanism is designed to be used in conjunction with SMTP over
   TCP.  A sufficiently resourceful attacker might be able to send TCP
   packets with forged from-addresses, and thus execute an entire SMTP
   session that appears to come from somewhere other than its true
   origin.

   Such an attack requires guessing what TCP sequence numbers an SMTP
   server will use.  It also requires transmitting completely in the
   blind -- the attack will be unable to hear any of the server's side
   of the conversation.

   Attacks of this sort can be ameliorated if IP gateways refuse to
   forward packets when the source address is clearly bogus.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20Forged%20Sender%20Attacks"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  Forged Sender Attacks</span>

   This mechanism chooses an address to validate either from one of a
   number of message headers or from the <a href="rfc2821.html">RFC 2821</a> MAIL command, and then
   uses that address for validation.  A message with a true Resent-From
   header or Return-Path, but a forged From header, will be accepted.
   Since many MUAs do not display all of the headers of received
   messages, the message will appear to be forged when displayed.

   In order to neutralize this attack, MUAs will need to start
   displaying at least the address that was verified.  In addition, MTAs
   could subject messages to heightened scrutiny when the validated
   address differs from the From header.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.4.%20%20Address%20Space%20Hijacking"></a><a class="selflink" href="#section-6.4" name="section-6.4">6.4</a>.  Address Space Hijacking</span>

   This mechanism assumes the integrity of IP address space for
   determining whether a given client is authorized to send messages
   from a given PRA.  In addition to the TCP attack given in <a href="#section-6.2">Section</a>
   <a href="#section-6.2">6.2</a>, a sufficiently resourceful attacker might be able to alter the
   IP routing structure to permit two-way communication using a



<span class="grey">Lyon &amp; Wong                   Experimental                     [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc4406.html">RFC 4406</a>            Sender ID: Authenticating E-Mail          April 2006</span>


   specified IP address.  It would then be possible to execute an SMTP
   session that appears to come from an authorized address, without the
   need to guess TCP sequence numbers or transmit in the blind.

   Such an attack might occur if the attacker obtained access to a
   router that participates in external BGP routing.  Such a router
   could advertise a more specific route to a rogue SMTP client,
   temporarily overriding the legitimate owner of the address.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.5.%20%20Malicious%20DNS%20Attacks%20on%20Third%20Parties"></a><a class="selflink" href="#section-6.5" name="section-6.5">6.5</a>.  Malicious DNS Attacks on Third Parties</span>

   There is class of attacks in which an attacker A can entice a
   participant P to send a malicious message to a victim V.

   These attacks are undertaken by A citing the address of V in the SMTP
   MAIL FROM request and then by causing P to generate (or invoke the
   generation of) a Delivery Status Notification 'bounce' message
   (<a href="rfc3464.html">RFC3464</a>), which is sent to the victim V.

   The attacker relies upon it being common practice to copy the
   original message into the 'bounce' report, thereby causing the malice
   to be sent onward to V.

   This mode of attack has the advantages (to the attacker) of
   obfuscating the location of the host from which the attack was
   mounted, and of possibly damaging the reputation of P by making it
   appear that P originated or was an active participant in the sending
   of the malicious message.

   In current practice, A causes P to cause the 'bounce' by addressing
   the original message to a nonexistent recipient.

   Sender ID enables a new variant of this attack.

   In this variant, the attacker A sends a message whose PRA (<a href="#section-4">Section 4</a>)
   is selected by the attacker to be such that, when P undertakes the
   Sender ID test, a Fail will result (<a href="#section-5.3">Section 5.3</a>).

   The message will be rejected (as the attacker intended) and a
   malicious 'bounce' message may be generated and sent to the victim V.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Implementation%20Guidance"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Implementation Guidance</span>

   This section describes the actions that certain members of the
   Internet e-mail ecosystem must take to be compliant with this
   specification.





<span class="grey">Lyon &amp; Wong                   Experimental                     [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc4406.html">RFC 4406</a>            Sender ID: Authenticating E-Mail          April 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Simple%20E-Mailers"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Simple E-Mailers</span>

   A domain that injects original e-mail into the Internet, using its
   own name in From headers, need do nothing to be compliant.  However,
   such domains SHOULD publish records in DNS as defined by [<a href="rfc4408.html" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail"'>RFC4408</a>]
   and this specification.

   In the majority of cases, the domain's published information will be
   the same for both the PRA and MAIL FROM variants of this test.  In
   this case, domains SHOULD publish their information using an SPF
   record with the prefix "v=spf1".  Doing so will render their
   published information usable by the older SPF protocol, too.  (See
   [<a href="rfc4408.html" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail"'>RFC4408</a>] for information on the SPF protocol.)

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20E-Mail%20Forwarders"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  E-Mail Forwarders</span>

   In order to pass the PRA variant of the test, a program that forwards
   received mail to other addresses MUST add an appropriate header that
   contains an e-mail address that it is authorized to use.  Such
   programs SHOULD use the Resent-From header for this purpose.

   In order to pass the MAIL FROM variant of the test, a program that
   forwards received mail to other addresses MUST alter the MAIL FROM
   address to an address under its control.  Should that address
   eventually receive a DSN relating to the original message, that DSN
   SHOULD be forwarded to the original MAIL FROM address.  However, if
   this altered address receives any messages other than DSNs related to
   the original message, these messages MUST NOT be forwarded to the
   original MAIL FROM address; they SHOULD be refused during an SMTP
   transaction.

   In addition, e-mail forwarders SHOULD publish Sender ID records for
   their domains, and SHOULD use MTAs for which the Sender ID check
   yields a "pass" result.

   Some of today's forwarders already add an appropriate header
   (although many of them use Sender rather than Resent-From.) Most of
   them do not perform the address-rewriting specified above.

   Note that an e-mail forwarder might receive a single message for two
   or more recipients, each of whom requests forwarding to a new
   address.  In this case, the forwarder's MTA SHOULD transmit the
   message to each new recipient individually, with each copy of the
   message containing a different newly inserted Resent-From header
   field.






<span class="grey">Lyon &amp; Wong                   Experimental                     [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc4406.html">RFC 4406</a>            Sender ID: Authenticating E-Mail          April 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.3.%20%20Mailing%20List%20Servers"></a><a class="selflink" href="#section-7.3" name="section-7.3">7.3</a>.  Mailing List Servers</span>

   In order to pass the PRA variant of the test, a mailing list server
   MUST add an appropriate header that contains an e-mail address that
   it is authorized to use.  Such programs SHOULD use the Resent-From
   header for this purpose.

   In order to pass the MAIL FROM variant of the test, a mailing list
   server MUST alter the MAIL FROM address to an address under its
   control.

   In addition, mailing list servers SHOULD publish Sender ID records
   for their domains, and SHOULD use MTAs for which the Sender ID check
   yields a "pass" result.

   Most of today's mailing list software already adds an appropriate
   header (although most of them use Sender rather than Resent-From),
   and most of them already alter the MAIL FROM address.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.4.%20%20Third-Party%20Mailers"></a><a class="selflink" href="#section-7.4" name="section-7.4">7.4</a>.  Third-Party Mailers</span>

   In order to pass the PRA variant of this test, a program that sends
   mail on behalf of another user MUST add an appropriate header that
   contains an e-mail address that it is authorized to use.  Such
   programs SHOULD use the Sender header for this purpose.

   In order to pass the MAIL FROM variant of this test, a program that
   sends mail on behalf of another user MUST use a MAIL FROM address
   that is under its control.  Defining what the program does with any
   mail received at that address is beyond the scope of this document.

   In addition, third-party mailers, servers SHOULD publish Sender ID
   records for their domains, and SHOULD use MTAs for which the Sender
   ID check yields a "pass" result.

   Many, but not all, of today's third-party mailers are already
   compliant with the PRA variant of the test.  The extent to which
   mailers are already compliant with the MAIL FROM variant of this test
   is unknown.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.5.%20%20MUA%20Implementers"></a><a class="selflink" href="#section-7.5" name="section-7.5">7.5</a>.  MUA Implementers</span>

   When displaying a received message, an MUA SHOULD display the
   purported responsible address as defined by this document whenever
   that address differs from the <a href="rfc2822.html">RFC 2822</a> From address.  This display
   SHOULD be in addition to the <a href="rfc2822.html">RFC 2822</a> From address.





<span class="grey">Lyon &amp; Wong                   Experimental                     [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc4406.html">RFC 4406</a>            Sender ID: Authenticating E-Mail          April 2006</span>


   When a received message contains multiple headers that might be used
   for the purported responsible address determination, an MUA should
   consider displaying all of them.  That is, if a message contains
   several Resent-From's, a Sender, and a From, an MUA should consider
   displaying all of them.

   Sender ID also does not validate the display name that may be
   transmitted along with an e-mail address.  The display name is also
   vulnerable to spoofing and other forms of attacks.  In order to
   reduce the occurrence and effectiveness of such attacks, MUA
   implementers should consider methods to safeguard the display name.
   This could include the following:

   * Not presenting the display name to the user at all, or not
     presenting the display name unless the corresponding e-mail address
     is listed in the user's address book.

   * Treating as suspicious any e-mail where the display name is itself
     in the form of an e-mail address, especially when it differs from
     the actual e-mail address in the header.

   * Making it clear to users that the e-mail address has been checked
     rather than the display name.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Acknowledgements"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Acknowledgements</span>

   This design is based on earlier work published in 2003 in [<a href="#ref-RMX" title='"The RMX DNS RR and method for lightweight SMTP sender authorization"'>RMX</a>] and
   [<a href="#ref-DMP" title='"Designated Mailers Protocol"'>DMP</a>] drafts (by Hadmut Danisch and Gordon Fecyk, respectively).  The
   idea of using a DNS record to check the legitimacy of an e-mail
   address traces its ancestry to "Repudiating Mail From" draft by Paul
   Vixie [<a href="#ref-Vixie" title='"Repudiating Mail From"'>Vixie</a>] (based on suggestion by Jim Miller) and to "Domain-
   Authorized SMTP Mail" draft by David Green [<a href="#ref-Green" title='"Mail-Transmitter RR"'>Green</a>], who first
   introduced this idea on the namedroppers mailing list in 2002.

   The current document borrows heavily from each of the above, as well
   as earlier versions of [<a href="rfc4408.html" title='"Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail"'>RFC4408</a>] and [<a href="#ref-CallerID" title="Caller ID for E-Mail Technical Specification">CallerID</a>], and incorporates
   ideas proposed by many members of the MARID working group.  The
   contributions of each of the above are gratefully acknowledged.













<span class="grey">Lyon &amp; Wong                   Experimental                     [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc4406.html">RFC 4406</a>            Sender ID: Authenticating E-Mail          April 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20References"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20Normative%20References"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]   Bradner, S., "Key words for use in RFCs to Indicate
               Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC4405" name="ref-RFC4405">RFC4405</a>]   Allman E. and H. Katz, "SMTP Service Extension for
               Indicating the Responsible Submitter of an E-Mail
               Message", <a href="rfc4405.html">RFC 4405</a>, April 2006.

   [<a id="ref-RFC4407" name="ref-RFC4407">RFC4407</a>]   Lyon, J., "Purported Responsible Address in E-Mail
               Messages", <a href="rfc4407.html">RFC 4407</a>, April 2006.

   [<a id="ref-RFC4408" name="ref-RFC4408">RFC4408</a>]   Wong, M. and W. Schlitt, "Sender Policy Framework (SPF)
               for Authorizing Use of Domains in E-Mail", <a href="rfc4408.html">RFC 4408</a>,
               April 2006.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20Informative%20References"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  Informative References</span>

   [<a id="ref-CallerID" name="ref-CallerID">CallerID</a>]  Microsoft Corporation, Caller ID for E-Mail Technical
               Specification, <a href="http://www.microsoft.com/mscorp/safety/technologies/senderid/resources.mspx">http://www.microsoft.com/mscorp/safety/</a>
               <a href="http://www.microsoft.com/mscorp/safety/technologies/senderid/resources.mspx">technologies/senderid/resources.mspx</a>

   [<a id="ref-DMP" name="ref-DMP">DMP</a>]       Fecyk, G., "Designated Mailers Protocol",
               <a href="http://www.pan-am.ca/dmp/draft-fecyk-dmp-01.txt">http://www.pan-am.ca/dmp/draft-fecyk-dmp-01.txt</a>, December
               2003.

   [<a id="ref-Green" name="ref-Green">Green</a>]     David Green, "Mail-Transmitter RR",
               <a href="http://ops.ietf.org/lists/namedroppers/namedroppers.2002/msg00656.html">http://ops.ietf.org/lists/namedroppers/namedroppers.2002/</a>
               <a href="http://ops.ietf.org/lists/namedroppers/namedroppers.2002/msg00656.html">msg00656.html</a>, June 2002.

   [<a id="ref-RMX" name="ref-RMX">RMX</a>]       H. Danisch, "The RMX DNS RR and method for lightweight
               SMTP sender authorization",
               <a href="http://www.danisch.de/work/security/txt/draft-danisch-dns-rr-smtp-04.txt">http://www.danisch.de/work/security/txt/</a>
               <a href="http://www.danisch.de/work/security/txt/draft-danisch-dns-rr-smtp-04.txt">draft-danisch-dns-rr-smtp-04.txt</a>

   [<a id="ref-Vixie" name="ref-Vixie">Vixie</a>]     Paul Vixie, "Repudiating Mail From",
               <a href="http://ops.ietf.org/lists/namedroppers/namedroppers.2002/msg00658.html">http://ops.ietf.org/lists/namedroppers/namedroppers.2002/</a>
               <a href="http://ops.ietf.org/lists/namedroppers/namedroppers.2002/msg00658.html">msg00658.html</a>, June 2002.











<span class="grey">Lyon &amp; Wong                   Experimental                     [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc4406.html">RFC 4406</a>            Sender ID: Authenticating E-Mail          April 2006</span>


Authors' Addresses

   Jim Lyon
   Microsoft Corporation
   One Microsoft Way
   Redmond, WA 98052
   USA

   EMail: jimlyon@microsoft.com


   Meng Weng Wong
   Singapore

   EMail: mengwong@dumbo.pobox.com




































<span class="grey">Lyon &amp; Wong                   Experimental                     [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc4406.html">RFC 4406</a>            Sender ID: Authenticating E-Mail          April 2006</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).







Lyon &amp; Wong                   Experimental                     [Page 19]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc4406 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:41 GMT --></html>