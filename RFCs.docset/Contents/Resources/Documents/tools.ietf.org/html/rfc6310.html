<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6310 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:30 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-nadeau-pwe3-oam-msg-map" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:6310" name="DC.Identifier"/>
<meta content="July, 2011" name="DC.Date.Issued"/>
<meta content="Nadeau, Thomas D." name="DC.Creator"/>
<meta content="Busschbach, Peter B." name="DC.Creator"/>
<meta content="Aissaoui, Mustapha" name="DC.Creator"/>
<meta content="Networks, Nortel" name="DC.Creator"/>
<meta content="Martini, Luca" name="DC.Creator"/>
<meta content="Morrow, Monique" name="DC.Creator"/>
<meta content="This document specifies the mapping of defect states between a Pseudo
Wire and the Attachment Circuits (AC) of the end-to-end emulated
service. This document covers the case whereby the ACs and the PWs are
of the same type in accordance to the PWE3 architecture [RFC3985] such
that a homogenous PW service can be constructed." name="DC.Description.Abstract"/>
<meta content="Pseudo Wire (PW) OAM Message Mapping" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6310 - Pseudo Wire (PW) OAM Message Mapping</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6310.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6310" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-pwe3-oam-msg-map" title="draft-ietf-pwe3-oam-msg-map">draft-ietf-pwe3...</a>] [<a href="https://datatracker.ietf.org/doc/rfc6310" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6310" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6310" title="Side-by-side diff">Diff2</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=6310&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=6310">Errata</a>]</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Internet Engineering Task Force (IETF)                       M. Aissaoui
Request for Comments: 6310                                 P. Busschbach
Category: Standards Track                                 Alcatel-Lucent
ISSN: 2070-1721                                               L. Martini
                                                               M. Morrow
                                                     Cisco Systems, Inc.
                                                               T. Nadeau
                                                         CA Technologies
                                                             Y(J). Stein
                                                 RAD Data Communications
                                                               July 2011


   <span class="h1">Pseudowire (PW) Operations, Administration, and Maintenance (OAM)</span>
                            <span class="h1">Message Mapping</span>

Abstract

   This document specifies the mapping and notification of defect states
   between a pseudowire (PW) and the Attachment Circuits (ACs) of the
   end-to-end emulated service.  It standardizes the behavior of
   Provider Edges (PEs) with respect to PW and AC defects.  It addresses
   ATM, Frame Relay, Time Division Multiplexing (TDM), and Synchronous
   Optical Network / Synchronous Digital Hierarchy (SONET/SDH) PW
   services, carried over MPLS, MPLS/IP, and Layer 2 Tunneling Protocol
   version 3/IP (L2TPv3/IP) Packet Switched Networks (PSNs).

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6310">http://www.rfc-editor.org/info/rfc6310</a>.











<span class="grey">Aissaoui, et al.             Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


Copyright Notice

   Copyright (c) 2011 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

























<span class="grey">Aissaoui, et al.             Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. Abbreviations and Conventions ...................................<a href="#page-5">5</a>
      <a href="#section-2.1">2.1</a>. Abbreviations ..............................................<a href="#page-5">5</a>
      <a href="#section-2.2">2.2</a>. Conventions ................................................<a href="#page-6">6</a>
   <a href="#section-3">3</a>. Reference Model and Defect Locations ............................<a href="#page-7">7</a>
   <a href="#section-4">4</a>. Abstract Defect States ..........................................<a href="#page-8">8</a>
   <a href="#section-5">5</a>. OAM Modes .......................................................<a href="#page-9">9</a>
   <a href="#section-6">6</a>. PW Defect States and Defect Notifications ......................<a href="#page-11">11</a>
      <a href="#section-6.1">6.1</a>. PW Defect Notification Mechanisms .........................<a href="#page-11">11</a>
           <a href="#section-6.1.1">6.1.1</a>. LDP Status TLV .....................................<a href="#page-13">13</a>
           <a href="#section-6.1.2">6.1.2</a>. L2TP Circuit Status AVP ............................<a href="#page-14">14</a>
           <a href="#section-6.1.3">6.1.3</a>. BFD Diagnostic Codes ...............................<a href="#page-16">16</a>
      <a href="#section-6.2">6.2</a>. PW Defect State Entry/Exit ................................<a href="#page-18">18</a>
           <a href="#section-6.2.1">6.2.1</a>. PW Receive Defect State Entry/Exit Criteria ........<a href="#page-18">18</a>
           <a href="#section-6.2.2">6.2.2</a>. PW Transmit Defect State Entry/Exit Criteria .......<a href="#page-19">19</a>
   <a href="#section-7">7</a>. Procedures for ATM PW Service ..................................<a href="#page-19">19</a>
      <a href="#section-7.1">7.1</a>. AC Receive Defect State Entry/Exit Criteria ...............<a href="#page-19">19</a>
      <a href="#section-7.2">7.2</a>. AC Transmit Defect State Entry/Exit Criteria ..............<a href="#page-20">20</a>
      <a href="#section-7.3">7.3</a>. Consequent Actions ........................................<a href="#page-21">21</a>
           <a href="#section-7.3.1">7.3.1</a>. PW Receive Defect State Entry/Exit .................<a href="#page-21">21</a>
           <a href="#section-7.3.2">7.3.2</a>. PW Transmit Defect State Entry/Exit ................<a href="#page-21">21</a>
           <a href="#section-7.3.3">7.3.3</a>. PW Defect State in ATM Port Mode PW Service ........<a href="#page-22">22</a>
           <a href="#section-7.3.4">7.3.4</a>. AC Receive Defect State Entry/Exit .................<a href="#page-22">22</a>
           <a href="#section-7.3.5">7.3.5</a>. AC Transmit Defect State Entry/Exit ................<a href="#page-23">23</a>
   <a href="#section-8">8</a>. Procedures for Frame Relay PW Service ..........................<a href="#page-24">24</a>
      <a href="#section-8.1">8.1</a>. AC Receive Defect State Entry/Exit Criteria ...............<a href="#page-24">24</a>
      <a href="#section-8.2">8.2</a>. AC Transmit Defect State Entry/Exit Criteria ..............<a href="#page-24">24</a>
      <a href="#section-8.3">8.3</a>. Consequent Actions ........................................<a href="#page-24">24</a>
           <a href="#section-8.3.1">8.3.1</a>. PW Receive Defect State Entry/Exit .................<a href="#page-24">24</a>
           <a href="#section-8.3.2">8.3.2</a>. PW Transmit Defect State Entry/Exit ................<a href="#page-25">25</a>
           <a href="#section-8.3.3">8.3.3</a>. PW Defect State in the FR Port Mode PW Service .....<a href="#page-25">25</a>
           <a href="#section-8.3.4">8.3.4</a>. AC Receive Defect State Entry/Exit .................<a href="#page-25">25</a>
           <a href="#section-8.3.5">8.3.5</a>. AC Transmit Defect State Entry/Exit ................<a href="#page-26">26</a>
   <a href="#section-9">9</a>. Procedures for TDM PW Service ..................................<a href="#page-26">26</a>
      <a href="#section-9.1">9.1</a>. AC Receive Defect State Entry/Exit Criteria ...............<a href="#page-27">27</a>
      <a href="#section-9.2">9.2</a>. AC Transmit Defect State Entry/Exit Criteria ..............<a href="#page-27">27</a>
      <a href="#section-9.3">9.3</a>. Consequent Actions ........................................<a href="#page-27">27</a>
           <a href="#section-9.3.1">9.3.1</a>. PW Receive Defect State Entry/Exit .................<a href="#page-27">27</a>
           <a href="#section-9.3.2">9.3.2</a>. PW Transmit Defect State Entry/Exit ................<a href="#page-27">27</a>
           <a href="#section-9.3.3">9.3.3</a>. AC Receive Defect State Entry/Exit .................<a href="#page-28">28</a>
   <a href="#section-10">10</a>. Procedures for CEP PW Service .................................<a href="#page-28">28</a>
      <a href="#section-10.1">10.1</a>. Defect States ............................................<a href="#page-29">29</a>
           <a href="#section-10.1.1">10.1.1</a>. PW Receive Defect State Entry/Exit ................<a href="#page-29">29</a>
           <a href="#section-10.1.2">10.1.2</a>. PW Transmit Defect State Entry/Exit ...............<a href="#page-29">29</a>
           <a href="#section-10.1.3">10.1.3</a>. AC Receive Defect State Entry/Exit ................<a href="#page-29">29</a>
           <a href="#section-10.1.4">10.1.4</a>. AC Transmit Defect State Entry/Exit ...............<a href="#page-30">30</a>



<span class="grey">Aissaoui, et al.             Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


      <a href="#section-10.2">10.2</a>. Consequent Actions .......................................<a href="#page-30">30</a>
           <a href="#section-10.2.1">10.2.1</a>. PW Receive Defect State Entry/Exit ................<a href="#page-30">30</a>
           <a href="#section-10.2.2">10.2.2</a>. PW Transmit Defect State Entry/Exit ...............<a href="#page-30">30</a>
           <a href="#section-10.2.3">10.2.3</a>. AC Receive Defect State Entry/Exit ................<a href="#page-30">30</a>
   <a href="#section-11">11</a>. Security Considerations .......................................<a href="#page-31">31</a>
   <a href="#section-12">12</a>. Contributors and Acknowledgments ..............................<a href="#page-31">31</a>
   <a href="#section-13">13</a>. References ....................................................<a href="#page-32">32</a>
      <a href="#section-13.1">13.1</a>. Normative References .....................................<a href="#page-32">32</a>
      <a href="#section-13.2">13.2</a>. Informative References ...................................<a href="#page-34">34</a>
   <a href="#appendix-A">Appendix A</a>. Native Service Management (Informative) ...............<a href="#page-36">36</a>
     <a href="#appendix-A.1">A.1</a>. Frame Relay Management .....................................<a href="#page-36">36</a>
     <a href="#appendix-A.2">A.2</a>. ATM Management .............................................<a href="#page-37">37</a>
   <a href="#appendix-B">Appendix B</a>. PW Defects and Detection Tools ........................<a href="#page-38">38</a>
     <a href="#appendix-B.1">B.1</a>. PW Defects .................................................<a href="#page-38">38</a>
     <a href="#appendix-B.2">B.2</a>. Packet Loss ................................................<a href="#page-38">38</a>
     <a href="#appendix-B.3">B.3</a>. PW Defect Detection Tools ..................................<a href="#page-38">38</a>
     <a href="#appendix-B.4">B.4</a>. PW Specific Defect Detection Mechanisms ....................<a href="#page-39">39</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   This document specifies the mapping and notification of defect states
   between a pseudowire and the Attachment Circuits (AC) of the end-to-
   end emulated service.  It covers the case where the ACs and the PWs
   are of the same type in accordance to the Pseudowire Emulation Edge-
   to-Edge (PWE3) architecture [<a href="rfc3985.html" title='"Pseudo Wire Emulation Edge-to-Edge (PWE3) Architecture"'>RFC3985</a>] such that a homogeneous PW
   service can be constructed.

   This document is motivated by the requirements put forth in [<a href="rfc4377.html" title='"Operations and Management (OAM) Requirements for Multi-Protocol Label Switched (MPLS) Networks"'>RFC4377</a>]
   and [<a href="rfc3916.html" title='"Requirements for Pseudo-Wire Emulation Edge-to- Edge (PWE3)"'>RFC3916</a>].  Its objective is to standardize the behavior of PEs
   with respect to defects on PWs and ACs, so that there is no ambiguity
   about the alarms generated and consequent actions undertaken by PEs
   in response to specific failure conditions.

   This document addresses PWs over MPLS, MPLS/IP, L2TPv3/IP PSNs, ATM,
   Frame Relay, TDM, and SONET/SDH PW native services.  Due to its
   unique characteristics, the Ethernet PW service is covered in a
   separate document [<a href="#ref-Eth-OAM-Inter" title='"MPLS and Ethernet OAM Interworking"'>Eth-OAM-Inter</a>].

   This document provides procedures for PWs set up using Label
   Distribution Protocol (LDP) [<a href="rfc4447.html" title='"Pseudowire Setup and Maintenance Using the Label Distribution Protocol (LDP)"'>RFC4447</a>] or L2TPv3 [<a href="rfc3931.html" title='"Layer Two Tunneling Protocol - Version 3 (L2TPv3)"'>RFC3931</a>] control
   protocols.  While we mention fault reporting options for PWs
   established by other means (e.g., by static configuration or via
   BGP), we do not provide detailed procedures for such cases.








<span class="grey">Aissaoui, et al.             Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   This document is scoped only to single segment PWs.  The mechanisms
   described in this document could also be applied to terminating PEs
   (T-PEs) for multi-segment PWs (MS-PWs) ([<a href="rfc5254.html" title='"Requirements for Multi-Segment Pseudowire Emulation Edge-to-Edge (PWE3)"'>RFC5254</a>]).  <a href="rfc6073.html#section-10">Section 10 of
   [RFC6073]</a> details procedures for generating or relaying PW status by
   a switching PE (S-PE).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Abbreviations%20and%20Conventions"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Abbreviations and Conventions</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Abbreviations"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Abbreviations</span>

   AAL5  ATM Adaptation Layer 5
   AIS   Alarm Indication Signal
   AC    Attachment Circuit
   ATM   Asynchronous Transfer Mode
   AVP   Attribute Value Pair
   BFD   Bidirectional Forwarding Detection
   CC    Continuity Check
   CDN   Call Disconnect Notify
   CE    Customer Edge
   CV    Connectivity Verification
   DBA   Dynamic Bandwidth Allocation
   DLC   Data Link Connection
   FDI   Forward Defect Indication
   FR    Frame Relay
   FRBS  Frame Relay Bearer Service
   ICMP  Internet Control Message Protocol
   LB    Loopback
   LCCE  L2TP Control Connection Endpoint
   LDP   Label Distribution Protocol
   LSP   Label Switched Path
   L2TP  Layer 2 Tunneling Protocol
   MPLS  Multiprotocol Label Switching
   NE    Network Element
   NS    Native Service
   OAM   Operations, Administration, and Maintenance
   PE    Provider Edge
   PSN   Packet Switched Network
   PW    Pseudowire
   RDI   Reverse Defect Indication
   PDU   Protocol Data Unit
   SDH   Synchronous Digital Hierarchy
   SDU   Service Data Unit
   SONET   Synchronous Optical Network
   TDM   Time Division Multiplexing
   TLV   Type Length Value
   VCC   Virtual Channel Connection
   VCCV  Virtual Connection Connectivity Verification
   VPC   Virtual Path Connection



<span class="grey">Aissaoui, et al.             Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Conventions"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Conventions</span>

   The words "defect" and "fault" are used interchangeably to mean any
   condition that negatively impacts forwarding of user traffic between
   the CE endpoints of the PW service.

   The words "defect notification" and "defect indication" are used
   interchangeably to mean any OAM message generated by a PE and sent to
   other nodes in the network to convey the defect state local to this
   PE.

   The PW can be carried over three types of Packet Switched Networks
   (PSNs).  An "MPLS PSN" makes use of MPLS Label Switched Paths
   [<a href="rfc3031.html" title='"Multiprotocol Label Switching Architecture"'>RFC3031</a>] as the tunneling technology to forward the PW packets.  An
   "MPLS/IP PSN" makes use of MPLS-in-IP tunneling [<a href="rfc4023.html" title='"Encapsulating MPLS in IP or Generic Routing Encapsulation (GRE)"'>RFC4023</a>], with an
   MPLS shim header used as PW demultiplexer.  An "L2TPv3/IP PSN" makes
   use of L2TPv3/IP [<a href="rfc3931.html" title='"Layer Two Tunneling Protocol - Version 3 (L2TPv3)"'>RFC3931</a>] as the tunneling technology with the
   L2TPv3/IP Session ID as the PW demultiplexer.

   If LSP-Ping [<a href="rfc4379.html" title='"Detecting Multi- Protocol Label Switched (MPLS) Data Plane Failures"'>RFC4379</a>] is run over a PW as described in [<a href="rfc5085.html" title='"Pseudowire Virtual Circuit Connectivity Verification (VCCV): A Control Channel for Pseudowires"'>RFC5085</a>], it
   will be referred to as "VCCV-Ping".  If BFD is run over a PW as
   described in [<a href="rfc5885.html" title='"Bidirectional Forwarding Detection (BFD) for the Pseudowire Virtual Circuit Connectivity Verification (VCCV)"'>RFC5885</a>], it will be referred to as "VCCV-BFD".

   While PWs are inherently bidirectional entities, defects and OAM
   messaging are related to a specific traffic direction.  We use the
   terms "upstream" and "downstream" to identify PEs in relation to the
   traffic direction.  A PE is upstream for the traffic it is forwarding
   and is downstream for the traffic it is receiving.

   We use the terms "local" and "remote" to identify native service
   networks and ACs in relation to a specific PE.  The local AC is
   attached to the PE in question, while the remote AC is attached to
   the PE at the other end of the PW.

   A "transmit defect" is any defect that uniquely impacts traffic sent
   or relayed by the observing PE.  A "receive defect" is any defect
   that impacts information transfer to the observing PE.  Note that a
   receive defect also impacts traffic meant to be relayed, and thus can
   be considered to incorporate two defect states.  Thus, when a PE
   enters both receive and transmit defect states of a PW service, the
   receive defect takes precedence over the transmit defect in terms of
   the consequent actions.

   A "forward defect indication" (FDI) is sent in the same direction as
   the user traffic impacted by the defect.  A "reverse defect
   indication" (RDI) is sent in the direction opposite to that of the
   impacted traffic.




<span class="grey">Aissaoui, et al.             Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Reference%20Model%20and%20Defect%20Locations"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Reference Model and Defect Locations</span>

   Figure 1 illustrates the PWE3 network reference model with an
   indication of the possible defect locations.  This model will be
   referenced in the remainder of this document for describing the OAM
   procedures.

                 ACs             PSN tunnel              ACs
                        +----+                  +----+
        +----+          | PE1|==================| PE2|          +----+
        |    |---(a)---(b)..(c)......PW1..(d)..(e)..(f)---(g)---|    |
        | CE1|   (N1)   |    |                  |    |    (N2)  |CE2 |
        |    |----------|............PW2.............|----------|    |
        +----+          |    |==================|    |          +----+
             ^          +----+                  +----+          ^
             |      Provider Edge 1         Provider Edge 2     |
             |                                                  |
             |&lt;-------------- Emulated Service ----------------&gt;|
       Customer                                                Customer
        Edge 1                                                  Edge 2

                  Figure 1: PWE3 Network Defect Locations

   The procedures will be described in this document from the viewpoint
   of PE1, so that N1 is the local native service network and N2 is the
   remote native service network.  PE2 will typically implement the same
   functionality.  Note that PE1 is the upstream PE for traffic
   originating in the local NS network N1, while it is the downstream PE
   for traffic originating in the remote NS network N2.

   The following is a brief description of the defect locations:

   a. Defect in NS network N1.  This covers any defect in network N1
      (including any CE1 defect) that impacts all or some ACs attached
      to PE1, and is thus a local AC defect.  The defect is conveyed to
      PE1 and to NS network N2 using NS specific OAM defect indications.

   b. Defect on a PE1 AC interface (another local AC defect).

   c. Defect on a PE1 PSN interface.

   d. Defect in the PSN network.  This covers any defect in the PSN that
      impacts all or some PWs between PE1 and PE2.  The defect is
      conveyed to the PE using a PSN and/or a PW specific OAM defect



<span class="grey">Aissaoui, et al.             Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


      indication.  Note that both data plane defects and control plane
      defects must be taken into consideration.  Although control
      messages may follow a different path than PW data plane traffic, a
      control plane defect may affect the PW status.

   e. Defect on a PE2 PSN interface.

   f. Defect on a PE2 AC interface (a remote AC defect).

   g. Defect in NS network N2 (another remote AC defect).  This covers
      any defect in N2 (including any CE2 defect) that impacts all or a
      subset of ACs attached to PE2.  The defect is conveyed to PE2 and
      to NS network N1 using the NS OAM defect indication.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Abstract%20Defect%20States"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Abstract Defect States</span>

   PE1 must track four defect states that reflect the observed states of
   both directions of the PW service on both the AC and the PW sides.
   Defects may impact one or both directions of the PW service.

   The observed state is a combination of defects directly detected by
   PE1 and defects of which it has been made aware via notifications.

                             +-----+
          ----AC receive----&gt;|     |-----PW transmit----&gt;
     CE1                     | PE1 |                       PE2/CE2
          &lt;---AC transmit----|     |&lt;----PW receive-----
                             +-----+
       (arrows indicate direction of user traffic impacted by a defect)

               Figure 2: Receive and Transmit Defect States

   PE1 will directly detect or be notified of AC receive or PW receive
   defects as they occur upstream of PE1 and impact traffic being sent
   to PE1.  As a result, PE1 enters the AC or PW receive defect state.

   In Figure 2, PE1 may be notified of a receive defect in the AC by
   receiving a forward defect indication, e.g., ATM AIS, from CE1 or an
   intervening network.  This defect notification indicates that user
   traffic sent by CE1 may not be received by PE1 due to a defect.  PE1
   can also directly detect an AC receive defect if it resulted from a
   failure of the receive side in the local port or link over which the
   AC is configured.

   Similarly, PE1 may detect or be notified of a receive defect in the
   PW by receiving a forward defect indication from PE2.  If the PW
   status TLV is used for fault notification, this message will indicate
   a Local PSN-facing PW (egress) Transmit Fault or a Local AC (ingress)



<span class="grey">Aissaoui, et al.             Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   Receive Fault at PE2, as described in <a href="#section-6.1.1">Section 6.1.1</a>.  This defect
   notification indicates that user traffic sent by CE2 may not be
   received by PE1 due to a defect.  As a result, PE1 enters the PW
   receive defect state.

   Note that a forward defect indication is sent in the same direction
   as the user traffic impacted by the defect.

   Generally, a PE cannot detect transmit defects by itself and will
   therefore need to be notified of AC transmit or PW transmit defects
   by other devices.

   In Figure 2, PE1 may be notified of a transmit defect in the AC by
   receiving a reverse defect indication, e.g., ATM RDI, from CE1.  This
   defect relates to the traffic sent by PE1 to CE1 on the AC.

   Similarly, PE1 may be notified of a transmit defect in the PW by
   receiving a reverse defect indication from PE2.  If PW status is used
   for fault notification, this message will indicate a Local PSN-
   facing PW (ingress) Receive Fault or a Local Attachment Circuit
   (egress) Transmit Fault at PE2, as described in <a href="#section-6.1.1">Section 6.1.1</a>.  This
   defect impacts the traffic sent by PE1 to CE2.  As a result, PE1
   enters the PW transmit defect state.

   Note that a reverse defect indication is sent in the reverse
   direction to the user traffic impacted by the defect.

   The procedures outlined in this document define the entry and exit
   criteria for each of the four states with respect to the set of PW
   services within the document scope and the consequent actions that
   PE1 must perform.

   When a PE enters both receive and transmit defect states related to
   the same PW service, then the receive defect takes precedence over
   transmit defect in terms of the consequent actions.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20OAM%20Modes"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  OAM Modes</span>

   A homogeneous PW service forwards packets between an AC and a PW of
   the same type.  It thus implements both NS OAM and PW OAM mechanisms.
   PW OAM defect notification messages are described in <a href="#section-6.1">Section 6.1</a>.  NS
   OAM messages are described in <a href="#appendix-A">Appendix A</a>.

   This document defines two different OAM modes, the distinction being
   the method of mapping between the NS and PW OAM defect notification
   messages.





<span class="grey">Aissaoui, et al.             Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   The first mode, illustrated in Figure 3, is called the "single
   emulated OAM loop" mode.  Here, a single end-to-end NS OAM loop is
   emulated by transparently passing NS OAM messages over the PW.  Note
   that the PW OAM is shown outside the PW in Figure 3, as it is
   transported in LDP messages or in the associated channel, not inside
   the PW itself.
                       +-----+                 +-----+
      +-----+          |     |=================|     |          +-----+
      | CE1 |-=NS-OAM=&gt;| PE1 |----=NS-OAM=&gt;----| PE2 |-=NS-OAM=&gt;| CE2 |
      +-----+          |     |=================|     |          +-----+
                       +-----+                 +-----+
                          \                       /
                           -------=PW-OAM=&gt;-------

                  Figure 3: Single Emulated OAM Loop Mode

   The single emulated OAM loop mode implements the following behavior:

   a. The upstream PE (PE1) MUST transparently relay NS OAM messages
      over the PW.

   b. The upstream PE MUST signal local defects affecting the AC using a
      NS defect notification message sent over the PW.  In the case that
      it is not possible to generate NS OAM messages (e.g., because the
      defect interferes with NS OAM message generation), the PE MUST
      signal local defects affecting the AC using a PW defect
      notification message.

   c. The upstream PE MUST signal local defects affecting the PW using a
      PW defect notification message.

   d. The downstream PE (PE2) MUST insert NS defect notification
      messages into its local AC when it detects or is notified of a
      defect in the PW or remote AC.  This includes translating received
      PW defect notification messages into NS defect notification
      messages for defects signaled by the upstream PE.

   The single emulated OAM loop mode is suitable for PW services that
   have a widely deployed NS OAM mechanism.  This document specifies the
   use of this mode for ATM PW, TDM PW, and Circuit Emulation over
   Packet (CEP) PW services.  It is the default mode of operation for
   all ATM cell mode PW services and the only mode specified for CEP and
   Structure-Agnostic TDM over Packets / Circuit Emulation Service over
   Packet Switched Network (SAToP/CESoPSN) TDM PW services.  It is
   optional for AAL5 PDU transport and AAL5 SDU transport modes.






<span class="grey">Aissaoui, et al.             Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   The second OAM mode operates three OAM loops joined at the AC/PW
   boundaries of the PEs.  This is referred to as the "coupled OAM
   loops" mode and is illustrated in Figure 4.  Note that in contrast to
   Figure 3, NS OAM messages are never carried over the PW.
                       +-----+                 +-----+
      +-----+          |     |=================|     |          +-----+
      | CE1 |-=NS-OAM=&gt;| PE1 |                 | PE2 |-=NS-OAM=&gt;| CE2 |
      +-----+          |     |=================|     |          +-----+
                       +-----+                 +-----+
                          \                       /
                           -------=PW-OAM=&gt;-------

                     Figure 4: Coupled OAM Loops Mode

   The coupled OAM loops mode implements the following behavior:

   a. The upstream PE (PE1) MUST terminate and translate a received NS
      defect notification message into a PW defect notification message.

   b. The upstream PE MUST signal local failures affecting its local AC
      using PW defect notification messages to the downstream PE.

   c. The upstream PE MUST signal local failures affecting the PW using
      PW defect notification messages.

   d. The downstream PE (PE2) MUST insert NS defect notification
      messages into the AC when it detects or is notified of defects in
      the PW or remote AC.  This includes translating received PW defect
      notification messages into NS defect notification messages.

   This document specifies the coupled OAM loops mode as the default
   mode for the Frame Relay, ATM AAL5 PDU transport, and AAL5 SDU
   transport services.  It is an optional mode for ATM VCC cell mode
   services.  This mode is not specified for TDM, CEP, or ATM VPC cell
   mode PW services.  <a href="rfc5087.html">RFC 5087</a> defines a similar but distinct mode, as
   will be explained in <a href="#section-9">Section 9</a>.  For the ATM VPC cell mode case a
   pure coupled OAM loops mode is not possible as a PE MUST
   transparently pass VC-level (F5) ATM OAM cells over the PW while
   terminating and translating VP-level (F4) OAM cells.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20PW%20Defect%20States%20and%20Defect%20Notifications"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  PW Defect States and Defect Notifications</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20PW%20Defect%20Notification%20Mechanisms"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  PW Defect Notification Mechanisms</span>

   For MPLS and MPLS/IP PSNs, a PE that establishes a PW using the Label
   Distribution Protocol [<a href="rfc5036.html" title='"LDP Specification"'>RFC5036</a>], and that has negotiated use of the
   LDP status TLV per <a href="rfc4447.html#section-5.4.3">Section 5.4.3 of [RFC4447]</a>, MUST use the PW status




<span class="grey">Aissaoui, et al.             Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   TLV mechanism for AC and PW status and defect notification.
   Additionally, such a PE MAY use VCCV-BFD Connectivity Verification
   (CV) for fault detection only (CV types 0x04 and 0x10 [<a href="rfc5885.html" title='"Bidirectional Forwarding Detection (BFD) for the Pseudowire Virtual Circuit Connectivity Verification (VCCV)"'>RFC5885</a>]).

   A PE that establishes an MPLS PW using means other than LDP, e.g., by
   static configuration or by use of BGP, MUST support some alternative
   method of status reporting.  The design of a suitable mechanism to
   carry the aforementioned status TLV in the PW associated channel is
   work in progress [<a href="#ref-Static-PW-Status" title='"Pseudowire Status for Static Pseudowires"'>Static-PW-Status</a>].  Additionally, such a PE MAY use
   VCCV-BFD CV for both fault detection and status notification (CV
   types 0x08 and 0x20 [<a href="rfc5885.html" title='"Bidirectional Forwarding Detection (BFD) for the Pseudowire Virtual Circuit Connectivity Verification (VCCV)"'>RFC5885</a>]).

   For a L2TPv3/IP PSN, a PE SHOULD use the Circuit Status Attribute
   Value Pair (AVP) as the mechanism for AC and PW status and defect
   notification.  In its most basic form, the Circuit Status AVP
   [<a href="rfc3931.html" title='"Layer Two Tunneling Protocol - Version 3 (L2TPv3)"'>RFC3931</a>] in a Set-Link-Info (SLI) message can signal active/inactive
   AC status.  The Circuit Status AVP as described in [<a href="rfc5641.html" title='"Layer 2 Tunneling Protocol Version 3 (L2TPv3) Extended Circuit Status Values"'>RFC5641</a>] is
   proposed to be extended to convey status and defects in the AC and
   the PSN-facing PW in both ingress and egress directions, i.e., four
   independent status bits, without the need to tear down the sessions
   or control connection.

   When a PE does not support the Circuit Status AVP, it MAY use the
   Stop-Control-Connection-Notification (StopCCN) and the Call-
   Disconnect-Notify (CDN) messages to tear down L2TP sessions in a
   fashion similar to LDP's use of Label Withdrawal to tear down a PW.
   A PE may use the StopCCN to shut down the L2TP control connection,
   and implicitly all L2TP sessions associated with that control
   connection, without any explicit session control messages.  This is
   useful for the case of a failure which impacts all L2TP sessions (all
   PWs) managed by the control connection.  It MAY use CDN to disconnect
   a specific L2TP session when a failure only affects a specific PW.

   Additionally, a PE MAY use VCCV-BFD CV types 0x04 and 0x10 for fault
   detection only, but SHOULD notify the remote PE using the Circuit
   Status AVP.  A PE that establishes a PW using means other than the
   L2TP control plane, e.g., by static configuration or by use of BGP,
   MAY use VCCV-BFD CV types 0x08 and 0x20 for AC and PW status and
   defect notification.  These CV types SHOULD NOT be used when the PW
   is established via the L2TP control plane.

   The CV types are defined in <a href="#section-6.1.3">Section 6.1.3</a> of this document.









<span class="grey">Aissaoui, et al.             Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.1.%20%20LDP%20Status%20TLV"></a><a class="selflink" href="#section-6.1.1" name="section-6.1.1">6.1.1</a>.  LDP Status TLV</span>

   [<a id="ref-RFC4446" name="ref-RFC4446">RFC4446</a>] defines the following PW status code points:

   0x00000000 -  Pseudowire forwarding (clear all failures)

   0x00000001 -  Pseudowire Not Forwarding

   0x00000002 -  Local Attachment Circuit (ingress) Receive Fault

   0x00000004 -  Local Attachment Circuit (egress) Transmit Fault

   0x00000008 -  Local PSN-facing PW (ingress) Receive Fault

   0x00000010 -  Local PSN-facing PW (egress) Transmit Fault

   [<a id="ref-RFC4447" name="ref-RFC4447">RFC4447</a>] specifies that the "Pseudowire forwarding" code point is
   used to indicate that all faults are to be cleared.  It also
   specifies that the "Pseudowire Not Forwarding" code point means that
   a defect has been detected that is not represented by the defined
   code points.

   The code points used in the LDP status TLV in a PW status
   notification message report defects from the viewpoint of the
   originating PE.  The originating PE conveys this state in the form of
   a forward defect or a reverse defect indication.

   The forward and reverse defect indication definitions used in this
   document map to the LDP Status TLV codes as follows:

          Forward defect indication corresponds to the logical OR of:

            *  Local Attachment Circuit (ingress) Receive Fault,

            *  Local PSN-facing PW (egress) Transmit Fault, and

            *  PW Not Forwarding.

          Reverse defect indication corresponds to the logical OR of:

            *  Local Attachment Circuit (egress) Transmit Fault and

            *  Local PSN-facing PW (ingress) Receive Fault.








<span class="grey">Aissaoui, et al.             Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   A PE MUST use PW status notification messages to report all defects
   affecting the PW service including, but not restricted to, the
   following:

   o  defects detected through fault detection mechanisms in the MPLS
      and MPLS/IP PSN,

   o  defects detected through VCCV-Ping or VCCV-BFD CV types 0x04 and
      0x10 for fault detection only,

   o  defects within the PE that result in an inability to forward
      traffic between the AC and the PW,

   o  defects of the AC or in the Layer 2 network affecting the AC as
      per the rules detailed in <a href="#section-5">Section 5</a> for the "single emulated OAM
      loop" mode and "coupled OAM loops" modes.

   Note that there are two situations that require PW label withdrawal
   as opposed to a PW status notification by the PE.  The first one is
   when the PW is taken down administratively in accordance with
   [<a href="rfc4447.html" title='"Pseudowire Setup and Maintenance Using the Label Distribution Protocol (LDP)"'>RFC4447</a>].  The second one is when the Target LDP session established
   between the two PEs is lost.  In the latter case, the PW labels will
   need to be re-signaled when the Targeted LDP session is re-
   established.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.2.%20%20L2TP%20Circuit%20Status%20AVP"></a><a class="selflink" href="#section-6.1.2" name="section-6.1.2">6.1.2</a>.  L2TP Circuit Status AVP</span>

   [<a id="ref-RFC3931" name="ref-RFC3931">RFC3931</a>] defines the Circuit Status AVP in the Set-Link-Info (SLI)
   message to exchange initial status and status changes in the circuit
   to which the pseudowire is bound.  [<a href="rfc5641.html" title='"Layer 2 Tunneling Protocol Version 3 (L2TPv3) Extended Circuit Status Values"'>RFC5641</a>] defines extensions to
   the Circuit Status AVP that are analogous to the PW Status TLV
   defined for LDP.  Consequently, for L2TPv3/IP, the Circuit Status AVP
   is used in the same fashion as the PW Status described in the
   previous section.  Extended circuit status for L2TPv3/IP is described
   in [<a href="rfc5641.html" title='"Layer 2 Tunneling Protocol Version 3 (L2TPv3) Extended Circuit Status Values"'>RFC5641</a>].

   If the extended Circuit Status bits are not supported, and instead
   only the "A bit" (Active) is used as described in [<a href="rfc3931.html" title='"Layer Two Tunneling Protocol - Version 3 (L2TPv3)"'>RFC3931</a>], a PE MAY
   use CDN messages to clear L2TPv3/IP sessions in the presence of
   session-level failures detected in the L2TPv3/IP PSN.

   A PE MUST set the Active bit in the Circuit Status to clear all
   faults, and it MUST clear the Active bit in the Circuit Status to
   convey any defect that cannot be represented explicitly with specific
   Circuit Status flags from [<a href="rfc3931.html" title='"Layer Two Tunneling Protocol - Version 3 (L2TPv3)"'>RFC3931</a>] or [<a href="rfc5641.html" title='"Layer 2 Tunneling Protocol Version 3 (L2TPv3) Extended Circuit Status Values"'>RFC5641</a>].






<span class="grey">Aissaoui, et al.             Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   The forward and reverse defect indication definitions used in this
   document map to the L2TP Circuit Status AVP as follows:

          Forward defect indication corresponds to the logical OR of:

            *  Local Attachment Circuit (ingress) Receive Fault,

            *  Local PSN-facing PW (egress) Transmit Fault, and

            *  PW Not Forwarding.

          Reverse defect indication corresponds to the logical OR of:

            *  Local Attachment Circuit (egress) Transmit Fault and

            *  Local PSN-facing PW (ingress) Receive Fault.

   The status notification conveys defects from the viewpoint of the
   originating LCCE (PE).

   When the extended Circuit Status definition of [<a href="rfc5641.html" title='"Layer 2 Tunneling Protocol Version 3 (L2TPv3) Extended Circuit Status Values"'>RFC5641</a>] is
   supported, a PE SHALL use the Circuit Status to report all failures
   affecting the PW service including, but not restricted to, the
   following:

   o  defects detected through defect detection mechanisms in the
      L2TPv3/IP PSN,

   o  defects detected through VCCV-Ping or VCCV-BFD CV types 0x04 (BFD
      IP/UDP-encapsulated, for PW Fault Detection only) and 0x10 (BFD
      PW-ACH-encapsulated (without IP/UDP headers), for PW.  Fault
      Detection and AC/PW Fault Status Signaling) for fault detection
      only which are described in <a href="#section-6.1.3">Section 6.1.3</a> of this document,

   o  defects within the PE that result in an inability to forward
      traffic between the AC and the PW,

   o  defects of the AC or in the L2 network affecting the AC as per the
      rules detailed in <a href="#section-5">Section 5</a> for the "single emulated OAM loop"
      mode and the "coupled OAM loops" modes.

   When the extended Circuit Status definition of [<a href="rfc5641.html" title='"Layer 2 Tunneling Protocol Version 3 (L2TPv3) Extended Circuit Status Values"'>RFC5641</a>] is not
   supported, a PE SHALL use the A bit in the Circuit Status AVP in the
   SLI to report:

   o  defects of the AC or in the L2 network affecting the AC as per the
      rules detailed in <a href="#section-5">Section 5</a> for the "single emulated OAM loop"
      mode and the "coupled OAM loops" modes.



<span class="grey">Aissaoui, et al.             Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   When the extended Circuit Status definition of [<a href="rfc5641.html" title='"Layer 2 Tunneling Protocol Version 3 (L2TPv3) Extended Circuit Status Values"'>RFC5641</a>] is not
   supported, a PE MAY use the CDN and StopCCN messages in a similar way
   to an MPLS PW label withdrawal to report:

   o  defects detected through defect detection mechanisms in the
      L2TPv3/IP PSN (using StopCCN),

   o  defects detected through VCCV (pseudowire level) (using CDN),

   o  defects within the PE that result in an inability to forward
      traffic between ACs and PW (using CDN).

   For ATM L2TPv3/IP pseudowires, in addition to the Circuit Status AVP,
   a PE MAY use the ATM Alarm Status AVP [<a href="rfc4454.html" title='"Asynchronous Transfer Mode (ATM) over Layer 2 Tunneling Protocol Version 3 (L2TPv3)"'>RFC4454</a>] to indicate the
   reason for the ATM circuit status and the specific alarm type, if
   any.  This AVP is sent in the SLI message to indicate additional
   information about the ATM circuit status.

   L2TP control connections use Hello messages as a keep-alive facility.
   It is important to note that if PSN failure is detected by keep-alive
   timeout, the control connection is cleared.  L2TP Hello messages are
   sent in-band so as to follow the data plane with respect to the
   source and destination addresses, IP protocol number, and UDP port
   (when UDP is used).

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.3.%20%20BFD%20Diagnostic%20Codes"></a><a class="selflink" href="#section-6.1.3" name="section-6.1.3">6.1.3</a>.  BFD Diagnostic Codes</span>

   BFD [<a href="rfc5880.html" title='"Bidirectional Forwarding Detection (BFD)"'>RFC5880</a>] defines a set of diagnostic codes that partially
   overlap the set of defects that can be communicated through LDP
   Status TLV or L2TP Circuit Status AVP.  This section describes the
   behavior of the PEs with respect to using one or both of these
   methods for detecting and propagating defect state.

   In the case of an MPLS PW established via LDP signaling, the PEs
   negotiate VCCV capabilities during the label mapping messages
   exchange used to establish the two directions of the PW.  This is
   achieved by including a capability TLV in the PW Forward Error
   Correction (FEC) interface parameters TLV.  In the L2TPv3/IP case,
   the PEs negotiate the use of VCCV during the pseudowire session
   initialization using the VCCV AVP [<a href="rfc5085.html" title='"Pseudowire Virtual Circuit Connectivity Verification (VCCV): A Control Channel for Pseudowires"'>RFC5085</a>].

   The CV Type Indicators field in the OAM capability TLV or VCCV AVP
   defines a bitmask used to indicate the specific OAM capabilities that
   the PE can use over the PW being established.







<span class="grey">Aissaoui, et al.             Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   A CV type of 0x04 or 0x10 [<a href="rfc5885.html" title='"Bidirectional Forwarding Detection (BFD) for the Pseudowire Virtual Circuit Connectivity Verification (VCCV)"'>RFC5885</a>] indicates that BFD is used for PW
   fault detection only.  These CV types MAY be used any time the PW is
   established using LDP or L2TP control planes.  In this mode, only the
   following diagnostic (Diag) codes specified in [<a href="rfc5880.html" title='"Bidirectional Forwarding Detection (BFD)"'>RFC5880</a>] will be
   used:

     0 -  No diagnostic

     1 -  Control detection time expired

     3 -  Neighbor signaled session down

     7 -  Administratively Down

   A PE using VCCV-BFD MUST use diagnostic code 0 to indicate to its
   peer PE that it is correctly receiving BFD control messages.  It MUST
   use diagnostic code 1 to indicate to its peer that it has stopped
   receiving BFD control messages and will thus declare the PW to be
   down in the receive direction.  It MUST use diagnostic code 3 to
   confirm to its peer that the BFD session is going down after
   receiving diagnostic code 1 from this peer.  In this case, it will
   declare the PW to be down in the transmit direction.  A PE MUST use
   diagnostic code 7 to bring down the BFD session when the PW is
   brought down administratively.  All other defects, such as AC/PW
   defects and PE internal failures that prevent it from forwarding
   traffic, MUST be communicated through the LDP Status TLV in the case
   of MPLS or MPLS/IP PSN, or through the appropriate L2TP codes in the
   Circuit Status AVP in the case of L2TPv3/IP PSN.

   A CV type of 0x08 or 0x20 in the OAM capabilities TLV indicates that
   BFD is used for both PW fault detection and Fault Notification.  In
   addition to the above diagnostic codes, a PE uses the following codes
   to signal AC defects and other defects impacting forwarding over the
   PW service:

     6 -  Concatenated Path Down

     8 -  Reverse Concatenated Path Down

   As specified in [<a href="rfc5085.html" title='"Pseudowire Virtual Circuit Connectivity Verification (VCCV): A Control Channel for Pseudowires"'>RFC5085</a>], the PEs negotiate the use of VCCV during
   PW setup.  When a PW transported over an MPLS-PSN is established
   using LDP, the PEs negotiate the use of the VCCV capabilities using
   the optional VCCV Capability Advertisement Sub-TLV parameter in the
   Interface Parameter Sub-TLV field of the LDP PW ID FEC or using an
   Interface Parameters TLV of the LDP Generalized PW ID FEC.  In the
   case of L2TPv3/IP PSNs, the PEs negotiate the use of VCCV during the
   pseudowire session initialization using VCCV AVP.




<span class="grey">Aissaoui, et al.             Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   Note that a defect that causes the generation of the "PW not
   forwarding code" (diagnostic code 6 or 8) does not necessarily result
   in the BFD session going down.  However, if the BFD session times
   out, then diagnostic code 1 MUST be used since it signals a state
   change of the BFD session itself.  In general, when a BFD session
   changes state, the PEs MUST use state change diagnostic codes 0, 1,
   3, and 7 in accordance with [<a href="rfc5880.html" title='"Bidirectional Forwarding Detection (BFD)"'>RFC5880</a>], and they MUST override any of
   the AC/PW status diagnostic codes (codes 6 or 8) that may have been
   signaled prior to the BFD session changing state.

   The forward and reverse defect indications used in this document map
   to the following BFD codes:

          Forward defect indication corresponds to the logical OR of:

            *  Concatenated Path Down (BFD diagnostic code 06)

            *  Pseudowire Not Forwarding (PW status code 0x00000001).

          Reverse defect indication corresponds to:

            *  Reverse Concatenated Path Down (BFD diagnostic code 08).

   These diagnostic codes are used to signal forward and reverse defect
   states, respectively, when the PEs negotiated the use of BFD as the
   mechanism for AC and PW fault detection and status signaling
   notification.  As stated in <a href="#section-6.1">Section 6.1</a>, these CV types SHOULD NOT be
   used when the PW is established with the LDP or L2TP control plane.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20PW%20Defect%20State%20Entry%2FExit"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  PW Defect State Entry/Exit</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.2.1.%20%20PW%20Receive%20Defect%20State%20Entry%2FExit%20Criteria"></a><a class="selflink" href="#section-6.2.1" name="section-6.2.1">6.2.1</a>.  PW Receive Defect State Entry/Exit Criteria</span>

   PE1, as downstream PE, will enter the PW receive defect state if one
   or more of the following occurs:

   o  It receives a forward defect indication (FDI) from PE2 indicating
      either a receive defect on the remote AC or that PE2 detected or
      was notified of downstream PW fault.

   o  It detects loss of connectivity on the PSN tunnel upstream of PE1,
      which affects the traffic it receives from PE2.

   o  It detects a loss of PW connectivity through VCCV-BFD or VCCV-
      PING, which affects the traffic it receives from PE2.






<span class="grey">Aissaoui, et al.             Standards Track                   [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   Note that if the PW control session (LDP session, the L2TP session,
   or the L2TP control connection) between the PEs fails, the PW is torn
   down and needs to be re-established.  However, the consequent actions
   towards the ACs are the same as if the PW entered the receive defect
   state.

   PE1 will exit the PW receive defect state when the following
   conditions are met.  Note that this may result in a transition to the
   PW operational state or the PW transmit defect state.

   o  All previously detected defects have disappeared, and

   o  PE2 cleared the FDI, if applicable.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.2.2.%20%20PW%20Transmit%20Defect%20State%20Entry%2FExit%20Criteria"></a><a class="selflink" href="#section-6.2.2" name="section-6.2.2">6.2.2</a>.  PW Transmit Defect State Entry/Exit Criteria</span>

   PE1, as upstream PE, will enter the PW transmit defect state if the
   following conditions occur:

   o  It receives a Reverse Defect Indication (RDI) from PE2 indicating
      either a transmit fault on the remote AC or that PE2 detected or
      was notified of a upstream PW fault, and

   o  it is not already in the PW receive defect state.

   PE1 will exit the transmit defect state if it receives an OAM message
   from PE2 clearing the RDI, or it has entered the PW receive defect
   state.

   For a PW over L2TPv3/IP using the basic Circuit Status AVP [<a href="rfc3931.html" title='"Layer Two Tunneling Protocol - Version 3 (L2TPv3)"'>RFC3931</a>],
   the PW transmit defect state is not valid and a PE can only enter the
   PW receive defect state.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Procedures%20for%20ATM%20PW%20Service"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Procedures for ATM PW Service</span>

   The following procedures apply to Asynchronous Transfer Mode (ATM)
   pseudowires [<a href="rfc4717.html" title='"Encapsulation Methods for Transport of Asynchronous Transfer Mode (ATM) over MPLS Networks"'>RFC4717</a>].  ATM terminology is explained in <a href="#appendix-A.2">Appendix A.2</a>
   of this document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20AC%20Receive%20Defect%20State%20Entry%2FExit%20Criteria"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  AC Receive Defect State Entry/Exit Criteria</span>

   When operating in the coupled OAM loops mode, PE1 enters the AC
   receive defect state when any of the following conditions are met:

   a. It detects or is notified of a physical layer fault on the ATM
      interface.





<span class="grey">Aissaoui, et al.             Standards Track                   [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   b. It receives an end-to-end Flow 4 OAM (F4) Alarm Indication Signal
      (AIS) OAM flow on a Virtual Path (VP) AC or an end-to-end Flow 5
      (F5) AIS OAM flow on a Virtual Circuit (VC) as per ITU-T
      Recommendation I.610 [<a href="#ref-I.610" title='"B-ISDN operation and maintenance principles and functions"'>I.610</a>], indicating that the ATM VPC or VCC
      is down in the adjacent Layer 2 ATM network.

   c. It receives a segment F4 AIS OAM flow on a VP AC, or a segment F5
      AIS OAM flow on a VC AC, provided that the operator has
      provisioned segment OAM and the PE is not a segment endpoint.

   d. It detects loss of connectivity on the ATM VPC/VCC while
      terminating segment or end-to-end ATM continuity check (ATM CC)
      cells with the local ATM network and CE.

   When operating in the coupled OAM loops mode, PE1 exits the AC
   receive defect state when all previously detected defects have
   disappeared.

   When operating in the single emulated OAM loop mode, PE1 enters the
   AC receive defect state if any of the following conditions are met:

   a. It detects or is notified of a physical layer fault on the ATM
      interface.

   b. It detects loss of connectivity on the ATM VPC/VCC while
      terminating segment ATM continuity check (ATM CC) cells with the
      local ATM network and CE.

   When operating in the single emulated OAM loop mode, PE1 exits the AC
   receive defect state when all previously detected defects have
   disappeared.

   The exact conditions under which a PE enters and exits the AIS state,
   or declares that connectivity is restored via ATM CC, are defined in
   Section 9.2 of [<a href="#ref-I.610" title='"B-ISDN operation and maintenance principles and functions"'>I.610</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20AC%20Transmit%20Defect%20State%20Entry%2FExit%20Criteria"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  AC Transmit Defect State Entry/Exit Criteria</span>

   When operating in the coupled OAM loops mode, PE1 enters the AC
   transmit defect state if any of the following conditions are met:

   a. It terminates an end-to-end F4 RDI OAM flow, in the case of a VPC,
      or an end-to-end F5 RDI OAM flow, in the case of a VCC, indicating
      that the ATM VPC or VCC is down in the adjacent L2 ATM.

   b. It receives a segment F4 RDI OAM flow on a VP AC, or a segment F5
      RDI OAM flow on a VC AC, provided that the operator has
      provisioned segment OAM and the PE is not a segment endpoint.



<span class="grey">Aissaoui, et al.             Standards Track                   [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   PE1 exits the AC transmit defect state if the AC state transitions to
   working or to the AC receive defect state.  The exact conditions for
   exiting the RDI state are described in Section 9.2 of [<a href="#ref-I.610" title='"B-ISDN operation and maintenance principles and functions"'>I.610</a>].

   Note that the AC transmit defect state is not valid when operating in
   the single emulated OAM loop mode, as PE1 transparently forwards the
   received RDI cells as user cells over the ATM PW to the remote CE.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.3.%20%20Consequent%20Actions"></a><a class="selflink" href="#section-7.3" name="section-7.3">7.3</a>.  Consequent Actions</span>

   In the remainder of this section, the text refers to AIS, RDI, and CC
   without specifying whether there is an F4 (VP-level) flow or an F5
   (VC-level) flow, or whether it is an end-to-end or a segment flow.
   Precise ATM OAM procedures for each type of flow are specified in
   Section 9.2 of [<a href="#ref-I.610" title='"B-ISDN operation and maintenance principles and functions"'>I.610</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.3.1.%20%20PW%20Receive%20Defect%20State%20Entry%2FExit"></a><a class="selflink" href="#section-7.3.1" name="section-7.3.1">7.3.1</a>.  PW Receive Defect State Entry/Exit</span>

   On entry to the PW receive defect state:

   a. PE1 MUST commence AIS insertion into the corresponding AC.

   b. PE1 MUST cease generation of CC cells on the corresponding AC, if
      applicable.

   c. If the PW defect was detected by PE1 without receiving FDI from
      PE2, PE1 MUST assume PE2 has no knowledge of the defect and MUST
      notify PE2 by sending RDI.

   On exit from the PW receive defect state:

   a. PE1 MUST cease AIS insertion into the corresponding AC.

   b. PE1 MUST resume any CC cell generation on the corresponding AC, if
      applicable.

   c. PE1 MUST clear the RDI to PE2, if applicable.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.3.2.%20%20PW%20Transmit%20Defect%20State%20Entry%2FExit"></a><a class="selflink" href="#section-7.3.2" name="section-7.3.2">7.3.2</a>.  PW Transmit Defect State Entry/Exit</span>

   On entry to the PW Transmit Defect State:

   a. PE1 MUST commence RDI insertion into the corresponding AC.

   b. If the PW failure was detected by PE1 without receiving RDI from
      PE2, PE1 MUST assume PE2 has no knowledge of the defect and MUST
      notify PE2 by sending FDI.




<span class="grey">Aissaoui, et al.             Standards Track                   [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   On exit from the PW Transmit Defect State:

   a. PE1 MUST cease RDI insertion into the corresponding AC.

   b. PE1 MUST clear the FDI to PE2, if applicable.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.3.3.%20%20PW%20Defect%20State%20in%20ATM%20Port%20Mode%20PW%20Service"></a><a class="selflink" href="#section-7.3.3" name="section-7.3.3">7.3.3</a>.  PW Defect State in ATM Port Mode PW Service</span>

   In case of transparent cell transport PW service, i.e., "port mode",
   where the PE does not keep track of the status of individual ATM VPCs
   or VCCs, a PE cannot relay PW defect state over these VCCs and VPCs.
   If ATM CC is run on the VCCs and VPCs end-to-end (CE1 to CE2), or on
   a segment originating and terminating in the ATM network and spanning
   the PSN network, it will time out and cause the CE or ATM switch to
   enter the ATM AIS state.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.3.4.%20%20AC%20Receive%20Defect%20State%20Entry%2FExit"></a><a class="selflink" href="#section-7.3.4" name="section-7.3.4">7.3.4</a>.  AC Receive Defect State Entry/Exit</span>

   On entry to the AC receive defect state and when operating in the
   coupled OAM loops mode:

   a. PE1 MUST send FDI to PE2.

   b. PE1 MUST commence insertion of ATM RDI cells into the AC towards
      CE1.

   When operating in the single emulated OAM loop mode, PE1 must be able
   to support two options, subject to the operator's preference.  The
   default option is the following:

   On entry to the AC receive defect state:

   a. PE1 MUST transparently relay ATM AIS cells, or, in the case of a
      local AC defect, commence insertion of ATM AIS cells into the
      corresponding PW towards CE2.

   b. If the defect interferes with NS OAM message generation, PE1 MUST
      send FDI to PE2.

   c. PE1 MUST cease the generation of CC cells on the corresponding PW,
      if applicable.










<span class="grey">Aissaoui, et al.             Standards Track                   [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   In certain operational models, for example, in the case that the ATM
   access network is owned by a different provider than the PW, an
   operator may want to distinguish between defects detected in the ATM
   access network and defects detected on the AC directly adjacent to
   the PE.  Therefore, the following option MUST also be supported:

   a. PE1 MUST transparently relay ATM AIS cells over the corresponding
      PW towards CE2.

   b. Upon detection of a defect on the ATM interface on the PE or in
      the PE itself, PE1 MUST send FDI to PE2.

   c. PE1 MUST cease generation of CC cells on the corresponding PW, if
      applicable.

   On exit from the AC receive defect state and when operating in the
   coupled OAM loops mode:

   a. PE1 MUST clear the FDI to PE2.

   b. PE1 MUST cease insertion of ATM RDI cells into the AC.

   On exit from the AC receive defect state and when operating in the
   single emulated OAM loop mode:

   a. PE1 MUST cease insertion of ATM AIS cells into the corresponding
      PW.

   b. PE1 MUST clear the FDI to PE2, if applicable.

   c. PE1 MUST resume any CC cell generation on the corresponding PW, if
      applicable.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.3.5.%20%20AC%20Transmit%20Defect%20State%20Entry%2FExit"></a><a class="selflink" href="#section-7.3.5" name="section-7.3.5">7.3.5</a>.  AC Transmit Defect State Entry/Exit</span>

   On entry to the AC transmit defect state and when operating in the
   coupled OAM loops mode:

   *  PE1 MUST send RDI to PE2.

   On exit from the AC transmit defect state and when operating in the
   coupled OAM loops mode:

   *  PE1 MUST clear the RDI to PE2.







<span class="grey">Aissaoui, et al.             Standards Track                   [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Procedures%20for%20Frame%20Relay%20PW%20Service"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Procedures for Frame Relay PW Service</span>

   The following procedures apply to Frame Relay (FR) pseudowires
   [<a href="rfc4619.html" title='"Encapsulation Methods for Transport of Frame Relay over Multiprotocol Label Switching (MPLS) Networks"'>RFC4619</a>].  Frame Relay (FR) terminology is explained in <a href="#appendix-A.1">Appendix A.1</a>
   of this document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20AC%20Receive%20Defect%20State%20Entry%2FExit%20Criteria"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  AC Receive Defect State Entry/Exit Criteria</span>

   PE1 enters the AC receive defect state if one or more of the
   following conditions are met:

   a. A Permanent Virtual Circuit (PVC) is not deleted from the FR
      network and the FR network explicitly indicates in a full status
      report (and optionally by the asynchronous status message) that
      this PVC is inactive [<a href="#ref-Q.933" title='"ISDN Digital Subscriber Signalling System No. 1 (DSS1) Signalling specifications for frame mode switched and permanent virtual connection control and status monitoring"'>Q.933</a>].  In this case, this status maps
      across the PE to the corresponding PW only.

   b. The Link Integrity Verification (LIV) indicates that the link from
      the PE to the Frame Relay network is down [<a href="#ref-Q.933" title='"ISDN Digital Subscriber Signalling System No. 1 (DSS1) Signalling specifications for frame mode switched and permanent virtual connection control and status monitoring"'>Q.933</a>].  In this case,
      the link down indication maps across the PE to all corresponding
      PWs.

   c. A physical layer alarm is detected on the FR interface.  In this
      case, this status maps across the PE to all corresponding PWs.

   PE1 exits the AC receive defect state when all previously detected
   defects have disappeared.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20AC%20Transmit%20Defect%20State%20Entry%2FExit%20Criteria"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  AC Transmit Defect State Entry/Exit Criteria</span>

   The AC transmit defect state is not valid for a FR AC.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.3.%20%20Consequent%20Actions"></a><a class="selflink" href="#section-8.3" name="section-8.3">8.3</a>.  Consequent Actions</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.3.1.%20%20PW%20Receive%20Defect%20State%20Entry%2FExit"></a><a class="selflink" href="#section-8.3.1" name="section-8.3.1">8.3.1</a>.  PW Receive Defect State Entry/Exit</span>

   The A (Active) bit indicates whether the FR PVC is ACTIVE (1) or
   INACTIVE (0) as explained in [<a href="rfc4591.html" title='"Frame Relay over Layer 2 Tunneling Protocol Version 3 (L2TPv3)"'>RFC4591</a>].

   On entry to the PW receive defect state:

   a. PE1 MUST clear the Active bit for the corresponding FR AC in a
      full status report, and optionally in an asynchronous status
      message, as per [<a href="#ref-Q.933" title='"ISDN Digital Subscriber Signalling System No. 1 (DSS1) Signalling specifications for frame mode switched and permanent virtual connection control and status monitoring"'>Q.933</a>], Annex A.

   b. If the PW failure was detected by PE1 without receiving FDI from
      PE2, PE1 MUST assume PE2 has no knowledge of the defect and MUST
      notify PE2 by sending RDI.



<span class="grey">Aissaoui, et al.             Standards Track                   [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   On exit from the PW receive defect state:

   a. PE1 MUST set the Active bit for the corresponding FR AC in a full
      status report, and optionally in an asynchronous status message,
      as per [<a href="#ref-Q.933" title='"ISDN Digital Subscriber Signalling System No. 1 (DSS1) Signalling specifications for frame mode switched and permanent virtual connection control and status monitoring"'>Q.933</a>], Annex A.  PE1 does not apply this procedure on a
      transition from the PW receive defect state to the PW transmit
      defect state.

   b. PE1 MUST clear the RDI to PE2, if applicable.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.3.2.%20%20PW%20Transmit%20Defect%20State%20Entry%2FExit"></a><a class="selflink" href="#section-8.3.2" name="section-8.3.2">8.3.2</a>.  PW Transmit Defect State Entry/Exit</span>

   On entry to the PW transmit defect state:

   a. PE1 MUST clear the Active bit for the corresponding FR AC in a
      full status report, and optionally in an asynchronous status
      message, as per [<a href="#ref-Q.933" title='"ISDN Digital Subscriber Signalling System No. 1 (DSS1) Signalling specifications for frame mode switched and permanent virtual connection control and status monitoring"'>Q.933</a>], Annex A.

   b. If the PW failure was detected by PE1 without RDI from PE2, PE1
      MUST assume PE2 has no knowledge of the defect and MUST notify PE2
      by sending FDI.

   On exit from the PW transmit defect state:

   a. PE1 MUST set the Active bit for the corresponding FR AC in a full
      status report, and optionally in an asynchronous status message,
      as per [<a href="#ref-Q.933" title='"ISDN Digital Subscriber Signalling System No. 1 (DSS1) Signalling specifications for frame mode switched and permanent virtual connection control and status monitoring"'>Q.933</a>], Annex A.  PE1 does not apply this procedure on a
      transition from the PW transmit defect state to the PW receive
      defect state.

   b. PE1 MUST clear the FDI to PE2, if applicable.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.3.3.%20%20PW%20Defect%20State%20in%20the%20FR%20Port%20Mode%20PW%20Service"></a><a class="selflink" href="#section-8.3.3" name="section-8.3.3">8.3.3</a>.  PW Defect State in the FR Port Mode PW Service</span>

   In case of port mode PW service, STATUS ENQUIRY and STATUS messages
   are transported transparently over the PW.  A PW Failure will
   therefore result in timeouts of the Q.933 link and PVC management
   protocol at the Frame Relay devices at one or both sites of the
   emulated interface.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.3.4.%20%20AC%20Receive%20Defect%20State%20Entry%2FExit"></a><a class="selflink" href="#section-8.3.4" name="section-8.3.4">8.3.4</a>.  AC Receive Defect State Entry/Exit</span>

   On entry to the AC receive defect state:

   *  PE1 MUST send FDI to PE2.






<span class="grey">Aissaoui, et al.             Standards Track                   [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   On exit from the AC receive defect state:

   *  PE1 MUST clear the FDI to PE2.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.3.5.%20%20AC%20Transmit%20Defect%20State%20Entry%2FExit"></a><a class="selflink" href="#section-8.3.5" name="section-8.3.5">8.3.5</a>.  AC Transmit Defect State Entry/Exit</span>

   The AC transmit defect state is not valid for an FR AC.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Procedures%20for%20TDM%20PW%20Service"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Procedures for TDM PW Service</span>

   The following procedures apply to SAToP [<a href="rfc4553.html" title='"Structure-Agnostic Time Division Multiplexing (TDM) over Packet (SAToP)"'>RFC4553</a>], CESoPSN [<a href="rfc5086.html" title='"Structure-Aware Time Division Multiplexed (TDM) Circuit Emulation Service over Packet Switched Network (CESoPSN)"'>RFC5086</a>]
   and TDMoIP [<a href="rfc5087.html" title='"Time Division Multiplexing over IP (TDMoIP)"'>RFC5087</a>].  These technologies utilize the single emulated
   OAM loop mode.  <a href="rfc5087.html">RFC 5087</a> distinguishes between trail-extended and
   trail-terminated scenarios; the former is essentially the single
   emulated loop model.  The latter applies to cases where the NS
   networks are run by different operators and defect notifications are
   not propagated across the PW.

   Since TDM is inherently real-time in nature, many OAM indications
   must be generated or forwarded with minimal delay.  This requirement
   rules out the use of messaging protocols, such as PW status messages.
   Thus, for TDM PWs, alternate mechanisms are employed.

   The fact that TDM PW packets are sent at a known constant rate can be
   exploited as an OAM mechanism.  Thus, a PE enters the PW receive
   defect state whenever a preconfigured number of TDM PW packets do not
   arrive in a timely fashion.  It exits this state when packets once
   again arrive at their proper rate.

   Native TDM carries OAM indications in overhead fields that travel
   along with the data.  TDM PWs emulate this behavior by sending urgent
   OAM messages in the PWE control word.

   The TDM PWE3 control word contains a set of flags used to indicate PW
   and AC defect conditions.  The L bit is an AC forward defect
   indication used by the upstream PE to signal NS network defects to
   the downstream PE.  The M field may be used to modify the meaning of
   receive defects.  The R bit is a PW reverse defect indication used by
   the PE to signal PSN failures to the remote PE.  Upon reception of
   packets with the R bit set, a PE enters the PW transmit defect state.
   L bits and R bits are further described in [<a href="rfc5087.html" title='"Time Division Multiplexing over IP (TDMoIP)"'>RFC5087</a>].










<span class="grey">Aissaoui, et al.             Standards Track                   [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20AC%20Receive%20Defect%20State%20Entry%2FExit%20Criteria"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  AC Receive Defect State Entry/Exit Criteria</span>

   PE1 enters the AC receive defect state if any of the following
   conditions are met:

   a. It detects a physical layer fault on the TDM interface (Loss of
      Signal, Loss of Alignment, etc., as described in [<a href="#ref-G.775" title='"Loss of Signal (LOS), Alarm Indication Signal (AIS) and Remote Defect Indication (RDI) defect detection and clearance criteria for PDH signals"'>G.775</a>]).

   b. It is notified of a previous physical layer fault by detecting
      AIS.

   The exact conditions under which a PE enters and exits the AIS state
   are defined in [<a href="#ref-G.775" title='"Loss of Signal (LOS), Alarm Indication Signal (AIS) and Remote Defect Indication (RDI) defect detection and clearance criteria for PDH signals"'>G.775</a>].  Note that Loss of Signal and AIS detection
   can be performed by PEs for both structure-agnostic and structure-
   aware TDM PW types.  Note that PEs implementing structure-agnostic
   PWs cannot detect Loss of Alignment.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20AC%20Transmit%20Defect%20State%20Entry%2FExit%20Criteria"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  AC Transmit Defect State Entry/Exit Criteria</span>

   PE1 enters the AC transmit defect state when it detects RDI according
   to the criteria in [<a href="#ref-G.775" title='"Loss of Signal (LOS), Alarm Indication Signal (AIS) and Remote Defect Indication (RDI) defect detection and clearance criteria for PDH signals"'>G.775</a>].  Note that PEs implementing structure-
   agnostic PWs cannot detect RDI.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.3.%20%20Consequent%20Actions"></a><a class="selflink" href="#section-9.3" name="section-9.3">9.3</a>.  Consequent Actions</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/9.3.1.%20%20PW%20Receive%20Defect%20State%20Entry%2FExit"></a><a class="selflink" href="#section-9.3.1" name="section-9.3.1">9.3.1</a>.  PW Receive Defect State Entry/Exit</span>

   On entry to the PW receive defect state:

   a. PE1 MUST commence AIS insertion into the corresponding TDM AC.

   b. PE1 MUST set the R bit in all PW packets sent back to PE2.

   On exit from the PW receive defect state:

   a. PE1 MUST cease AIS insertion into the corresponding TDM AC.

   b. PE1 MUST clear the R bit in all PW packets sent back to PE2.

   Note that AIS generation can, in general, be performed by both
   structure-aware and structure-agnostic PEs.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/9.3.2.%20%20PW%20Transmit%20Defect%20State%20Entry%2FExit"></a><a class="selflink" href="#section-9.3.2" name="section-9.3.2">9.3.2</a>.  PW Transmit Defect State Entry/Exit</span>

   On entry to the PW Transmit Defect State:

   *  A structure-aware PE1 MUST commence RDI insertion into the
      corresponding AC.



<span class="grey">Aissaoui, et al.             Standards Track                   [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   On exit from the PW Transmit Defect State:

   *  A structure-aware PE1 MUST cease RDI insertion into the
      corresponding AC.

   Note that structure-agnostic PEs are not capable of injecting RDI
   into an AC.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/9.3.3.%20%20AC%20Receive%20Defect%20State%20Entry%2FExit"></a><a class="selflink" href="#section-9.3.3" name="section-9.3.3">9.3.3</a>.  AC Receive Defect State Entry/Exit</span>

   On entry to the AC receive defect state and when operating in the
   single emulated OAM loop mode:

   a. PE1 SHOULD overwrite the TDM data with AIS in the PW packets sent
      towards PE2.

   b. PE1 MUST set the L bit in these packets.

   c. PE1 MAY omit the payload in order to conserve bandwidth.

   d. A structure-aware PE1 SHOULD send RDI back towards CE1.

   e. A structure-aware PE1 that detects a potentially correctable AC
      defect MAY use the M field to indicate this.

   On exit from the AC receive defect state and when operating in the
   single emulated OAM loop mode:

   a. PE1 MUST cease overwriting PW content with AIS and return to
      forwarding valid TDM data in PW packets sent towards PE2.

   b. PE1 MUST clear the L bit in PW packets sent towards PE2.

   c. A structure-aware PE1 MUST cease sending RDI towards CE1.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Procedures%20for%20CEP%20PW%20Service"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Procedures for CEP PW Service</span>

   The following procedures apply to SONET/SDH Circuit Emulation
   [<a href="rfc4842.html" title='"Synchronous Optical Network/Synchronous Digital Hierarchy (SONET/SDH) Circuit Emulation over Packet (CEP)"'>RFC4842</a>].  They are based on the single emulated OAM loop mode.

   Since SONET and SDH are inherently real-time in nature, many OAM
   indications must be generated or forwarded with minimal delay.  This
   requirement rules out the use of messaging protocols, such as PW
   status messages.  Thus, for CEP PWs alternate mechanisms are
   employed.






<span class="grey">Aissaoui, et al.             Standards Track                   [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   The CEP PWE3 control word contains a set of flags used to indicate PW
   and AC defect conditions.  The L bit is a forward defect indication
   used by the upstream PE to signal to the downstream PE a defect in
   its local attachment circuit.  The R bit is a PW reverse defect
   indication used by the PE to signal PSN failures to the remote PE.
   The combination of N and P bits is used by the local PE to signal
   loss of pointer to the remote PE.

   The fact that CEP PW packets are sent at a known constant rate can be
   exploited as an OAM mechanism.  Thus, a PE enters the PW receive
   defect state when it loses packet synchronization.  It exits this
   state when it regains packet synchronization.  See [<a href="rfc4842.html" title='"Synchronous Optical Network/Synchronous Digital Hierarchy (SONET/SDH) Circuit Emulation over Packet (CEP)"'>RFC4842</a>] for
   further details.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Defect%20States"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Defect States</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/10.1.1.%20%20PW%20Receive%20Defect%20State%20Entry%2FExit"></a><a class="selflink" href="#section-10.1.1" name="section-10.1.1">10.1.1</a>.  PW Receive Defect State Entry/Exit</span>

   In addition to the conditions specified in <a href="#section-6.2.1">Section 6.2.1</a>, PE1 will
   enter the PW receive defect state when one of the following becomes
   true:

   o  It receives packets with the L bit set.

   o  It receives packets with both the N and P bits set.

   o  It loses packet synchronization.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/10.1.2.%20%20PW%20Transmit%20Defect%20State%20Entry%2FExit"></a><a class="selflink" href="#section-10.1.2" name="section-10.1.2">10.1.2</a>.  PW Transmit Defect State Entry/Exit</span>

   In addition to the conditions specified in <a href="#section-6.2.2">Section 6.2.2</a>, PE1 will
   enter the PW transmit defect state if it receives packets with the R
   bit set.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/10.1.3.%20%20AC%20Receive%20Defect%20State%20Entry%2FExit"></a><a class="selflink" href="#section-10.1.3" name="section-10.1.3">10.1.3</a>.  AC Receive Defect State Entry/Exit</span>

   PE1 enters the AC receive defect state when any of the following
   conditions are met:

   a. It detects a physical layer fault on the TDM interface (Loss of
      Signal, Loss of Alignment, etc.).

   b. It is notified of a previous physical layer fault by detecting of
      AIS.

   The exact conditions under which a PE enters and exits the AIS state
   are defined in [<a href="#ref-G.707" title='"Network node interface for the synchronous digital hierarchy"'>G.707</a>] and [<a href="#ref-G.783" title='"Characteristics of synchronous digital hierarchy (SDH) equipment functional blocks"'>G.783</a>].




<span class="grey">Aissaoui, et al.             Standards Track                   [Page 29]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/10.1.4.%20%20AC%20Transmit%20Defect%20State%20Entry%2FExit"></a><a class="selflink" href="#section-10.1.4" name="section-10.1.4">10.1.4</a>.  AC Transmit Defect State Entry/Exit</span>

   The AC transmit defect state is not valid for CEP PWs.  RDI signals
   are forwarded transparently.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.2.%20%20Consequent%20Actions"></a><a class="selflink" href="#section-10.2" name="section-10.2">10.2</a>.  Consequent Actions</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/10.2.1.%20%20PW%20Receive%20Defect%20State%20Entry%2FExit"></a><a class="selflink" href="#section-10.2.1" name="section-10.2.1">10.2.1</a>.  PW Receive Defect State Entry/Exit</span>

   On entry to the PW receive defect state:

   a. PE1 MUST commence AIS-P/V insertion into the corresponding AC.
      See [<a href="rfc4842.html" title='"Synchronous Optical Network/Synchronous Digital Hierarchy (SONET/SDH) Circuit Emulation over Packet (CEP)"'>RFC4842</a>].

   b. PE1 MUST set the R bit in all PW packets sent back to PE2.

   On exit from the PW receive defect state:

   a. PE1 MUST cease AIS-P/V insertion into the corresponding AC.

   b. PE1 MUST clear the R bit in all PW packets sent back to PE2.

   See [<a href="rfc4842.html" title='"Synchronous Optical Network/Synchronous Digital Hierarchy (SONET/SDH) Circuit Emulation over Packet (CEP)"'>RFC4842</a>] for further details.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/10.2.2.%20%20PW%20Transmit%20Defect%20State%20Entry%2FExit"></a><a class="selflink" href="#section-10.2.2" name="section-10.2.2">10.2.2</a>.  PW Transmit Defect State Entry/Exit</span>

   On entry to the PW Transmit Defect State:

   a. A structure-aware PE1 MUST commence RDI insertion into the
      corresponding AC.

   On exit from the PW Transmit Defect State:

   a. A structure-aware PE1 MUST cease RDI insertion into the
      corresponding AC.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/10.2.3.%20%20AC%20Receive%20Defect%20State%20Entry%2FExit"></a><a class="selflink" href="#section-10.2.3" name="section-10.2.3">10.2.3</a>.  AC Receive Defect State Entry/Exit</span>

   On entry to the AC receive defect state:

   a. PE1 MUST set the L bit in these packets.

   b. If Dynamic Bandwidth Allocation (DBA) has been enabled, PE1 MAY
      omit the payload in order to conserve bandwidth.

   c. If Dynamic Bandwidth Allocation (DBA) is not enabled, PE1 SHOULD
      insert AIS-V/P in the SDH/SONET client layer in the PW packets
      sent towards PE2.



<span class="grey">Aissaoui, et al.             Standards Track                   [Page 30]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   On exit from the AC receive defect state:

   a. PE1 MUST cease overwriting PW content with AIS-P/V and return to
      forwarding valid data in PW packets sent towards PE2.

   b. PE1 MUST clear the L bit in PW packets sent towards PE2.

   See [<a href="rfc4842.html" title='"Synchronous Optical Network/Synchronous Digital Hierarchy (SONET/SDH) Circuit Emulation over Packet (CEP)"'>RFC4842</a>] for further details.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20Security%20Considerations"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  Security Considerations</span>

   The mapping messages described in this document do not change the
   security functions inherent in the actual messages.  All generic
   security considerations applicable to PW traffic specified in <a href="rfc3985.html#section-10">Section</a>
   <a href="rfc3985.html#section-10">10 of [RFC3985]</a> are applicable to NS OAM messages transferred inside
   the PW.

   Security considerations in <a href="rfc5085.html#section-10">Section 10 of RFC 5085</a> for VCCV apply to
   the OAM messages thus transferred.  Security considerations
   applicable to the PWE3 control protocol of <a href="rfc4447.html#section-8.2">RFC 4447 Section 8.2</a> apply
   to OAM indications transferred using the LDP status message.

   Since the mechanisms of this document enable propagation of OAM
   messages and fault conditions between native service networks and
   PSNs, continuity of the end-to-end service depends on a trust
   relationship between the operators of these networks.  Security
   considerations for such scenarios are discussed in <a href="rfc5254.html#section-7">Section 7 of
   [RFC5254]</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/12.%20%20Contributors%20and%20Acknowledgments"></a><a class="selflink" href="#section-12" name="section-12">12</a>.  Contributors and Acknowledgments</span>

   Mustapha Aissaoui, Peter Busschbach, Luca Martini, Monique Morrow,
   Thomas Nadeau, and Yaakov (J) Stein, were each, in turn, editors of
   one or more revisions of this document.  All of the above were
   contributing authors, as was Dave Allan, david.i.allan@ericsson.com.

   The following contributed significant ideas or text:
      Matthew Bocci, matthew.bocci@alcatel-lucent.co.uk
      Simon Delord, Simon.A.DeLord@team.telstra.com
      Yuichi Ikejiri, y.ikejiri@ntt.com
      Kenji Kumaki, kekumaki@kddi.com
      Satoru Matsushima, satoru.matsushima@tm.softbank.co.jp
      Teruyuki Oya, teruyuki.oya@tm.softbank.co.jp
      Carlos Pignataro, cpignata@cisco.com
      Vasile Radoaca, vasile.radoaca@alcatel-lucent.com
      Himanshu Shah, hshah@ciena.com
      David Watkinson, david.watkinson@alcatel-lucent.com




<span class="grey">Aissaoui, et al.             Standards Track                   [Page 31]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   The editors would like to acknowledge the contributions of Bertrand
   Duvivier, Adrian Farrel, Tiberiu Grigoriu, Ron Insler, Michel
   Khouderchah, Vanson Lim, Amir Maleki, Neil McGill, Chris Metz, Hari
   Rakotoranto, Eric Rosen, Mark Townsley, and Ben Washam.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/13.%20%20References"></a><a class="selflink" href="#section-13" name="section-13">13</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/13.1.%20%20Normative%20References"></a><a class="selflink" href="#section-13.1" name="section-13.1">13.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]           Bradner, S., "Key words for use in RFCs to
                       Indicate Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>,
                       March 1997.

   [<a id="ref-RFC4379" name="ref-RFC4379">RFC4379</a>]           Kompella, K. and G. Swallow, "Detecting Multi-
                       Protocol Label Switched (MPLS) Data Plane
                       Failures", <a href="rfc4379.html">RFC 4379</a>, February 2006.

   [<a id="ref-RFC4447" name="ref-RFC4447">RFC4447</a>]           Martini, L., Rosen, E., El-Aawar, N., Smith, T.,
                       and G. Heron, "Pseudowire Setup and Maintenance
                       Using the Label Distribution Protocol (LDP)",
                       <a href="rfc4447.html">RFC 4447</a>, April 2006.

   [<a id="ref-RFC4553" name="ref-RFC4553">RFC4553</a>]           Vainshtein, A. and YJ. Stein, "Structure-Agnostic
                       Time Division Multiplexing (TDM) over Packet
                       (SAToP)", <a href="rfc4553.html">RFC 4553</a>, June 2006.

   [<a id="ref-RFC4591" name="ref-RFC4591">RFC4591</a>]           Townsley, M., Wilkie, G., Booth, S., Bryant, S.,
                       and J. Lau, "Frame Relay over Layer 2 Tunneling
                       Protocol Version 3 (L2TPv3)", <a href="rfc4591.html">RFC 4591</a>,
                       August 2006.

   [<a id="ref-RFC4619" name="ref-RFC4619">RFC4619</a>]           Martini, L., Kawa, C., and A. Malis,
                       "Encapsulation Methods for Transport of Frame
                       Relay over Multiprotocol Label Switching (MPLS)
                       Networks", <a href="rfc4619.html">RFC 4619</a>, September 2006.

   [<a id="ref-RFC4717" name="ref-RFC4717">RFC4717</a>]           Martini, L., Jayakumar, J., Bocci, M., El-Aawar,
                       N., Brayley, J., and G. Koleyni, "Encapsulation
                       Methods for Transport of Asynchronous Transfer
                       Mode (ATM) over MPLS Networks", <a href="rfc4717.html">RFC 4717</a>,
                       December 2006.

   [<a id="ref-RFC4842" name="ref-RFC4842">RFC4842</a>]           Malis, A., Pate, P., Cohen, R., and D. Zelig,
                       "Synchronous Optical Network/Synchronous Digital
                       Hierarchy (SONET/SDH) Circuit Emulation over
                       Packet (CEP)", <a href="rfc4842.html">RFC 4842</a>, April 2007.





<span class="grey">Aissaoui, et al.             Standards Track                   [Page 32]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   [<a id="ref-RFC5036" name="ref-RFC5036">RFC5036</a>]           Andersson, L., Minei, I., and B. Thomas, "LDP
                       Specification", <a href="rfc5036.html">RFC 5036</a>, October 2007.

   [<a id="ref-RFC5085" name="ref-RFC5085">RFC5085</a>]           Nadeau, T. and C. Pignataro, "Pseudowire Virtual
                       Circuit Connectivity Verification (VCCV): A
                       Control Channel for Pseudowires", <a href="rfc5085.html">RFC 5085</a>,
                       December 2007.

   [<a id="ref-RFC5641" name="ref-RFC5641">RFC5641</a>]           McGill, N. and C. Pignataro, "Layer 2 Tunneling
                       Protocol Version 3 (L2TPv3) Extended Circuit
                       Status Values", <a href="rfc5641.html">RFC 5641</a>, August 2009.

   [<a id="ref-RFC5880" name="ref-RFC5880">RFC5880</a>]           Katz, D. and D. Ward, "Bidirectional Forwarding
                       Detection (BFD)", <a href="rfc5880.html">RFC 5880</a>, June 2010.

   [<a id="ref-RFC5885" name="ref-RFC5885">RFC5885</a>]           Nadeau, T. and C. Pignataro, "Bidirectional
                       Forwarding Detection (BFD) for the Pseudowire
                       Virtual Circuit Connectivity Verification
                       (VCCV)", <a href="rfc5885.html">RFC 5885</a>, June 2010.

   [<a id="ref-G.707" name="ref-G.707">G.707</a>]             "Network node interface for the synchronous
                       digital hierarchy", ITU-T Recommendation G.707,
                       December 2003.

   [<a id="ref-G.775" name="ref-G.775">G.775</a>]             "Loss of Signal (LOS), Alarm Indication Signal
                       (AIS) and Remote Defect Indication (RDI) defect
                       detection and clearance criteria for PDH
                       signals", ITU-T Recommendation G.775,
                       October 1998.

   [<a id="ref-G.783" name="ref-G.783">G.783</a>]             "Characteristics of synchronous digital hierarchy
                       (SDH) equipment functional blocks", ITU-
                       T Recommendation G.783, March 2006.

   [<a id="ref-I.610" name="ref-I.610">I.610</a>]             "B-ISDN operation and maintenance principles and
                       functions", ITU-T Recommendation I.610,
                       February 1999.

   [<a id="ref-Q.933" name="ref-Q.933">Q.933</a>]             "ISDN Digital Subscriber Signalling System No. 1
                       (DSS1)  Signalling specifications for frame mode
                       switched and permanent virtual connection control
                       and status monitoring", ITU- T Recommendation
                       Q.993, February 2003.








<span class="grey">Aissaoui, et al.             Standards Track                   [Page 33]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-34" id="page-34" name="page-34"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/13.2.%20%20Informative%20References"></a><a class="selflink" href="#section-13.2" name="section-13.2">13.2</a>.  Informative References</span>

   [<a id="ref-RFC0792" name="ref-RFC0792">RFC0792</a>]           Postel, J., "Internet Control Message Protocol",
                       STD 5, <a href="rfc792.html">RFC 792</a>, September 1981.

   [<a id="ref-RFC3031" name="ref-RFC3031">RFC3031</a>]           Rosen, E., Viswanathan, A., and R. Callon,
                       "Multiprotocol Label Switching Architecture",
                       <a href="rfc3031.html">RFC 3031</a>, January 2001.

   [<a id="ref-RFC3209" name="ref-RFC3209">RFC3209</a>]           Awduche, D., Berger, L., Gan, D., Li, T.,
                       Srinivasan, V., and G. Swallow, "RSVP-TE:
                       Extensions to RSVP for LSP Tunnels", <a href="rfc3209.html">RFC 3209</a>,
                       December 2001.

   [<a id="ref-RFC3916" name="ref-RFC3916">RFC3916</a>]           Xiao, X., McPherson, D., and P. Pate,
                       "Requirements for Pseudo-Wire Emulation Edge-to-
                       Edge (PWE3)", <a href="rfc3916.html">RFC 3916</a>, September 2004.

   [<a id="ref-RFC3931" name="ref-RFC3931">RFC3931</a>]           Lau, J., Townsley, M., and I. Goyret, "Layer Two
                       Tunneling Protocol - Version 3 (L2TPv3)",
                       <a href="rfc3931.html">RFC 3931</a>, March 2005.

   [<a id="ref-RFC3985" name="ref-RFC3985">RFC3985</a>]           Bryant, S. and P. Pate, "Pseudo Wire Emulation
                       Edge-to-Edge (PWE3) Architecture", <a href="rfc3985.html">RFC 3985</a>,
                       March 2005.

   [<a id="ref-RFC4023" name="ref-RFC4023">RFC4023</a>]           Worster, T., Rekhter, Y., and E. Rosen,
                       "Encapsulating MPLS in IP or Generic Routing
                       Encapsulation (GRE)", <a href="rfc4023.html">RFC 4023</a>, March 2005.

   [<a id="ref-RFC4377" name="ref-RFC4377">RFC4377</a>]           Nadeau, T., Morrow, M., Swallow, G., Allan, D.,
                       and S. Matsushima, "Operations and Management
                       (OAM) Requirements for Multi-Protocol Label
                       Switched (MPLS) Networks", <a href="rfc4377.html">RFC 4377</a>,
                       February 2006.

   [<a id="ref-RFC4385" name="ref-RFC4385">RFC4385</a>]           Bryant, S., Swallow, G., Martini, L., and D.
                       McPherson, "Pseudowire Emulation Edge-to-Edge
                       (PWE3) Control Word for Use over an MPLS PSN",
                       <a href="rfc4385.html">RFC 4385</a>, February 2006.

   [<a id="ref-RFC4446" name="ref-RFC4446">RFC4446</a>]           Martini, L., "IANA Allocations for Pseudowire
                       Edge to Edge Emulation (PWE3)", <a href="https://tools.ietf.org/html/bcp116">BCP 116</a>,
                       <a href="rfc4446.html">RFC 4446</a>, April 2006.







<span class="grey">Aissaoui, et al.             Standards Track                   [Page 34]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-35" id="page-35" name="page-35"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   [<a id="ref-RFC4454" name="ref-RFC4454">RFC4454</a>]           Singh, S., Townsley, M., and C. Pignataro,
                       "Asynchronous Transfer Mode (ATM) over Layer 2
                       Tunneling Protocol Version 3 (L2TPv3)", <a href="rfc4454.html">RFC 4454</a>,
                       May 2006.

   [<a id="ref-RFC5086" name="ref-RFC5086">RFC5086</a>]           Vainshtein, A., Sasson, I., Metz, E., Frost, T.,
                       and P. Pate, "Structure-Aware Time Division
                       Multiplexed (TDM) Circuit Emulation Service over
                       Packet Switched Network (CESoPSN)", <a href="rfc5086.html">RFC 5086</a>,
                       December 2007.

   [<a id="ref-RFC5087" name="ref-RFC5087">RFC5087</a>]           Stein, Y(J)., Shashoua, R., Insler, R., and M.
                       Anavi, "Time Division Multiplexing over IP
                       (TDMoIP)", <a href="rfc5087.html">RFC 5087</a>, December 2007.

   [<a id="ref-RFC5254" name="ref-RFC5254">RFC5254</a>]           Bitar, N., Bocci, M., and L. Martini,
                       "Requirements for Multi-Segment Pseudowire
                       Emulation Edge-to-Edge (PWE3)", <a href="rfc5254.html">RFC 5254</a>,
                       October 2008.

   [<a id="ref-RFC6073" name="ref-RFC6073">RFC6073</a>]           Martini, L., Metz, C., Nadeau, T., Bocci, M., and
                       M. Aissaoui, "Segmented Pseudowire", <a href="rfc6073.html">RFC 6073</a>,
                       January 2011.

   [<a id="ref-Eth-OAM-Inter" name="ref-Eth-OAM-Inter">Eth-OAM-Inter</a>]     Mohan, D., Bitar, N., DeLord, S., Niger, P.,
                       Sajassi, A., and R. Qiu, "MPLS and Ethernet OAM
                       Interworking", Work in Progress, March 2011.

   [<a id="ref-Static-PW-Status" name="ref-Static-PW-Status">Static-PW-Status</a>]  Martini, L., Swallow, G., Heron, G., and M.
                       Bocci, "Pseudowire Status for Static
                       Pseudowires", Work in Progress, June 2011.

   [<a id="ref-I.620" name="ref-I.620">I.620</a>]             "Frame relay operation and maintenance principles
                       and functions", ITU-T Recommendation I.620,
                       October 1996.
















<span class="grey">Aissaoui, et al.             Standards Track                   [Page 35]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-36" id="page-36" name="page-36"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Native%20Service%20Management%20%28Informative%29"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Native Service Management (Informative)</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.1.%20%20Frame%20Relay%20Management"></a><a class="selflink" href="#appendix-A.1" name="appendix-A.1">A.1</a>.  Frame Relay Management</span>

   The management of Frame Relay Bearer Service (FRBS) connections can
   be accomplished through two distinct methodologies:

   a. Based on [<a href="#ref-Q.933" title='"ISDN Digital Subscriber Signalling System No. 1 (DSS1) Signalling specifications for frame mode switched and permanent virtual connection control and status monitoring"'>Q.933</a>], Annex A, Link Integrity Verification procedure,
      where STATUS and STATUS ENQUIRY signaling messages are sent using
      DLCI=0 over a given User-Network Interface (UNI) and Network-
      Network Interface (NNI) physical link.

   b. Based on FRBS Local Management Interface (LMI), and similar to ATM
      Integrated LMI (ILMI) where LMI is common in private Frame Relay
      networks.

   In addition, ITU-T I.620 [<a href="#ref-I.620" title='"Frame relay operation and maintenance principles and functions"'>I.620</a>] addressed Frame Relay loopback.
   This Recommendation was withdrawn in 2004, and its deployment was
   limited.

   It is possible to use either, or both, of the above options to manage
   Frame Relay interfaces.  This document will refer exclusively to
   Q.933 messages.

   The status of any provisioned Frame Relay PVC may be updated through:

   a. Frame Relay STATUS messages in response to Frame Relay STATUS
      ENQUIRY messages; these are mandatory.

   b. Optional unsolicited STATUS updates independent of STATUS ENQUIRY
      (typically, under the control of management system, these updates
      can be sent periodically (continuous monitoring) or only upon
      detection of specific defects based on configuration).

   In Frame Relay, a Data Link Connection (DLC) is either up or down.
   There is no distinction between different directions.  To achieve
   commonality with other technologies, down is represented as a receive
   defect.

   Frame Relay connection management is not implemented over the PW
   using either of the techniques native to FR; therefore, PW mechanisms
   are used to synchronize the view each PE has of the remote Native
   Service/Attachment Circuit (NS/AC).  A PE will treat a remote NS/AC
   failure in the same way it would treat a PW or PSN failure, that is,
   using AC facing FR connection management to notify the CE that FR is
   down.





<span class="grey">Aissaoui, et al.             Standards Track                   [Page 36]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-37" id="page-37" name="page-37"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.2.%20%20ATM%20Management"></a><a class="selflink" href="#appendix-A.2" name="appendix-A.2">A.2</a>.  ATM Management</span>

   ATM management and OAM mechanisms are much more evolved than those of
   Frame Relay.  There are five broad management-related categories,
   including fault management (FT), Performance management (PM),
   configuration management (CM), Accounting management (AC), and
   Security management (SM).  [<a href="#ref-I.610" title='"B-ISDN operation and maintenance principles and functions"'>I.610</a>] describes the functions for the
   operation and maintenance of the physical layer and the ATM layer,
   that is, management at the bit and cell levels.  Because of its
   scope, this document will concentrate on ATM fault management
   functions.  Fault management functions include the following:

   a. Alarm Indication Signal (AIS).

   b. Remote Defect Indication (RDI).

   c. Continuity Check (CC).

   d. Loopback (LB).

   Some of the basic ATM fault management functions are described as
   follows: Alarm Indication Signal (AIS) sends a message in the same
   direction as that of the signal, to the effect that an error has been
   detected.

   The Remote Defect Indication (RDI) sends a message to the
   transmitting terminal that an error has been detected.  Alarms
   related to the physical layer are indicated using path AIS/RDI.
   Virtual path AIS/RDI and virtual channel AIS/RDI are also generated
   for the ATM layer.

   OAM cells (F4 and F5 cells) are used to instrument virtual paths and
   virtual channels, respectively, with regard to their performance and
   availability.  OAM cells in the F4 and F5 flows are used for
   monitoring a segment of the network and end-to-end monitoring.  OAM
   cells in F4 flows have the same VPI as that of the connection being
   monitored.  OAM cells in F5 flows have the same VPI and VCI as that
   of the connection being monitored.  The AIS and RDI messages of the
   F4 and F5 flows are sent to the other network nodes via the VPC or
   the VCC to which the message refers.  The type of error and its
   location can be indicated in the OAM cells.  Continuity check is
   another fault management function.  To check whether a VCC that has
   been idle for a period of time is still functioning, the network
   elements can send continuity-check cells along that VCC.







<span class="grey">Aissaoui, et al.             Standards Track                   [Page 37]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-38" id="page-38" name="page-38"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20B.%20%20PW%20Defects%20and%20Detection%20Tools"></a><a class="selflink" href="#appendix-B" name="appendix-B">Appendix B</a>.  PW Defects and Detection Tools</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.1.%20%20PW%20Defects"></a><a class="selflink" href="#appendix-B.1" name="appendix-B.1">B.1</a>.  PW Defects</span>

   Possible defects that impact PWs are the following:

   a. Physical layer defect in the PSN interface.

   b. PSN tunnel failure that results in a loss of connectivity between
      ingress and egress PE.

   c. Control session failures between ingress and egress PE.

   In case of an MPLS PSN and an MPLS/IP PSN there are additional
   defects:

   a. PW labeling error, which is due to a defect in the ingress PE, or
      to an over-writing of the PW label value somewhere along the LSP
      path.

   b. LSP tunnel label swapping errors or LSP tunnel label merging
      errors in the MPLS network.  This could result in the termination
      of a PW at the wrong egress PE.

   c. Unintended self-replication; e.g., due to loops or denial-of-
      service attacks.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.2.%20%20Packet%20Loss"></a><a class="selflink" href="#appendix-B.2" name="appendix-B.2">B.2</a>.  Packet Loss</span>

   Persistent congestion in the PSN or in a PE could impact the proper
   operation of the emulated service.

   A PE can detect packet loss resulting from congestion through several
   methods.  If a PE uses the sequence number field in the PWE3 Control
   Word for a specific pseudowire [<a href="rfc3985.html" title='"Pseudo Wire Emulation Edge-to-Edge (PWE3) Architecture"'>RFC3985</a>] and [<a href="rfc4385.html" title='"Pseudowire Emulation Edge-to-Edge (PWE3) Control Word for Use over an MPLS PSN"'>RFC4385</a>], it has the
   ability to detect packet loss.  Translation of congestion detection
   to PW defect states is beyond the scope of this document.

   There are congestion alarms that are raised in the node and to the
   management system when congestion occurs.  The decision to declare
   the PW down and to select another path is usually at the discretion
   of the network operator.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.3.%20%20PW%20Defect%20Detection%20Tools"></a><a class="selflink" href="#appendix-B.3" name="appendix-B.3">B.3</a>.  PW Defect Detection Tools</span>

   To detect the defects listed above, Service Providers have a variety
   of options available.




<span class="grey">Aissaoui, et al.             Standards Track                   [Page 38]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-39" id="page-39" name="page-39"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


   Physical Layer defect detection and notification mechanisms include
   SONET/SDH Loss of Signal (LOS), Loss of Alignment (LOA), and AIS/RDI.

   PSN defect detection mechanisms vary according to the PSN type.

   For PWs over L2TPv3/IP PSNs, with L2TP as encapsulation protocol, the
   defect detection mechanisms described in [<a href="rfc3931.html" title='"Layer Two Tunneling Protocol - Version 3 (L2TPv3)"'>RFC3931</a>] apply.  These
   include, for example, the keep-alive mechanism performed with Hello
   messages for detection of loss of connectivity between a pair of
   LCCEs (i.e., dead PE peer and path detection).  Furthermore, the
   tools Ping and Traceroute, based on ICMP Echo Messages [<a href="https://tools.ietf.org/html/rfc0792" title='"Internet Control Message Protocol"'>RFC0792</a>]
   apply and can be used to detect defects on the IP PSN.  Additionally,
   VCCV-Ping [<a href="rfc5085.html" title='"Pseudowire Virtual Circuit Connectivity Verification (VCCV): A Control Channel for Pseudowires"'>RFC5085</a>] and VCCV-BFD [<a href="rfc5885.html" title='"Bidirectional Forwarding Detection (BFD) for the Pseudowire Virtual Circuit Connectivity Verification (VCCV)"'>RFC5885</a>] can also be used to detect
   defects at the individual pseudowire level.

   For PWs over MPLS or MPLS/IP PSNs, several tools can be used:

   a. LSP-Ping and LSP-Traceroute [<a href="rfc4379.html" title='"Detecting Multi- Protocol Label Switched (MPLS) Data Plane Failures"'>RFC4379</a>] for LSP tunnel connectivity
      verification.

   b. LSP-Ping with Bi-directional Forwarding Detection [<a href="rfc5885.html" title='"Bidirectional Forwarding Detection (BFD) for the Pseudowire Virtual Circuit Connectivity Verification (VCCV)"'>RFC5885</a>] for
      LSP tunnel continuity checking.

   c. Furthermore, if Resource Reservation Protocol - Traffic
      Engineering (RSVP-TE) is used to set up the PSN Tunnels between
      ingress and egress PE, the hello protocol can be used to detect
      loss of connectivity [<a href="rfc3209.html" title='"RSVP-TE: Extensions to RSVP for LSP Tunnels"'>RFC3209</a>], but only at the control plane.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.4.%20%20PW%20Specific%20Defect%20Detection%20Mechanisms"></a><a class="selflink" href="#appendix-B.4" name="appendix-B.4">B.4</a>.  PW Specific Defect Detection Mechanisms</span>

   [<a id="ref-RFC4377" name="ref-RFC4377">RFC4377</a>] describes how LSP-Ping and BFD can be used over individual
   PWs for connectivity verification and continuity checking,
   respectively.

   Furthermore, the detection of a fault could occur at different points
   in the network and there are several ways the observing PE determines
   a fault exists:

   a. Egress PE detection of failure (e.g., BFD).

   b. Ingress PE detection of failure (e.g., LSP-PING).

   c. Ingress PE notification of failure (e.g., RSVP Path-err).








<span class="grey">Aissaoui, et al.             Standards Track                   [Page 39]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-40" id="page-40" name="page-40"> </a>
<span class="grey"><a href="rfc6310.html">RFC 6310</a>                 PW OAM Message Mapping                July 2011</span>


Authors' Addresses

   Mustapha Aissaoui
   Alcatel-Lucent
   600 March Rd
   Kanata, ON  K2K 2E6
   Canada
   EMail: mustapha.aissaoui@alcatel-lucent.com


   Peter Busschbach
   Alcatel-Lucent
   67 Whippany Rd
   Whippany, NJ  07981
   USA
   EMail: busschbach@alcatel-lucent.com


   Luca Martini
   Cisco Systems, Inc.
   9155 East Nichols Avenue, Suite 400
   Englewood, CO  80112
   USA
   EMail: lmartini@cisco.com


   Monique Morrow
   Cisco Systems, Inc.
   Richtistrase 7
   CH-8304 Wallisellen
   Switzerland
   EMail: mmorrow@cisco.com


   Thomas Nadeau
   CA Technologies
   273 Corporate Dr.
   Portsmouth, NH  03801
   USA
   EMail: Thomas.Nadeau@ca.com


   Yaakov (Jonathan) Stein
   RAD Data Communications
   24 Raoul Wallenberg St., Bldg C
   Tel Aviv  69719
   Israel
   EMail: yaakov_s@rad.com



Aissaoui, et al.             Standards Track                   [Page 40]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc6310 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:30 GMT --></html>