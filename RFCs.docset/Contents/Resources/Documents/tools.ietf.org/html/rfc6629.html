<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6629 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:27 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:6629" name="DC.Identifier"/>
<meta content="This document discusses some considerations on the applicability of
the level 3 multihoming Shim protocol for IPv6 (Shim6) and associated
support protocols and mechanisms to provide site multihoming
capabilities in IPv6. This document is not an Internet Standards Track
specification; it is published for informational purposes." name="DC.Description.Abstract"/>
<meta content="Abley, Joe" name="DC.Creator"/>
<meta content="Bagnulo, Marcelo" name="DC.Creator"/>
<meta content="Garcia-Martinez, Alberto" name="DC.Creator"/>
<meta content="June, 2012" name="DC.Date.Issued"/>
<meta content="Considerations on the Application of the Level 3 Multihoming Shim Protocol for IPv6 (Shim6)" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6629 - Considerations on the Application of the Level 3 Multihoming Shim Protocol for IPv6 (Shim6)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6629.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6629" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-garcia-shim6-applicability" title="draft-garcia-shim6-applicability">draft-garcia-sh...</a>] [<a href="https://datatracker.ietf.org/doc/rfc6629" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6629" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6629" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                          J. Abley
Request for Comments: 6629                                         ICANN
Category: Informational                                       M. Bagnulo
ISSN: 2070-1721                                       A. Garcia-Martinez
                                                                    UC3M
                                                               June 2012


                <span class="h1">Considerations on the Application of the</span>
           <span class="h1">Level 3 Multihoming Shim Protocol for IPv6 (Shim6)</span>

Abstract

   This document discusses some considerations on the applicability of
   the level 3 multihoming Shim protocol for IPv6 (Shim6)
   and associated support protocols and mechanisms to provide site
   multihoming capabilities in IPv6.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any
   errata, and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6629">http://www.rfc-editor.org/info/rfc6629</a>.

Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



<span class="grey">Abley, et al.                 Informational                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Deployment Scenarios ............................................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. Addresses and Shim6 .............................................<a href="#page-6">6</a>
      <a href="#section-3.1">3.1</a>. Protocol Version (IPv4 vs. IPv6) ...........................<a href="#page-6">6</a>
      <a href="#section-3.2">3.2</a>. Prefix Lengths .............................................<a href="#page-7">7</a>
      <a href="#section-3.3">3.3</a>. Address Generation and Configuration .......................<a href="#page-7">7</a>
      <a href="#section-3.4">3.4</a>. Use of CGA vs. HBA .........................................<a href="#page-7">7</a>
   <a href="#section-4">4</a>. Shim6 in Multihomed Nodes .......................................<a href="#page-8">8</a>
   <a href="#section-5">5</a>. Shim6 Capabilities .............................................<a href="#page-10">10</a>
      <a href="#section-5.1">5.1</a>. Fault Tolerance ...........................................<a href="#page-10">10</a>
           <a href="#section-5.1.1">5.1.1</a>. Establishing Communications After an Outage ........<a href="#page-10">10</a>
           <a href="#section-5.1.2">5.1.2</a>. Short-Lived and Long-Lived Communications ..........<a href="#page-11">11</a>
      <a href="#section-5.2">5.2</a>. Load Balancing ............................................<a href="#page-11">11</a>
      <a href="#section-5.3">5.3</a>. Traffic Engineering .......................................<a href="#page-12">12</a>
   <a href="#section-6">6</a>. Application Considerations .....................................<a href="#page-12">12</a>
   <a href="#section-7">7</a>. Interaction with Other Protocols and Mechanisms ................<a href="#page-13">13</a>
      <a href="#section-7.1">7.1</a>. Shim6 and Mobile IPv6 .....................................<a href="#page-13">13</a>
           <a href="#section-7.1.1">7.1.1</a>. Multihomed Home Network ............................<a href="#page-14">14</a>
           <a href="#section-7.1.2">7.1.2</a>. Shim6 Between the HA and the MN ....................<a href="#page-16">16</a>
      <a href="#section-7.2">7.2</a>. Shim6 and SEND ............................................<a href="#page-16">16</a>
      <a href="#section-7.3">7.3</a>. Shim6, SCTP and MPTCP .....................................<a href="#page-17">17</a>
      <a href="#section-7.4">7.4</a>. Shim6 and NEMO ............................................<a href="#page-18">18</a>
      <a href="#section-7.5">7.5</a>. Shim6 and HIP .............................................<a href="#page-18">18</a>
      <a href="#section-7.6">7.6</a>. Shim6 and Firewalls .......................................<a href="#page-19">19</a>
      <a href="#section-7.7">7.7</a>. Shim6 and NPTv6 ...........................................<a href="#page-20">20</a>
   <a href="#section-8">8</a>. Security Considerations ........................................<a href="#page-23">23</a>
      <a href="#section-8.1">8.1</a>. Privacy Considerations ....................................<a href="#page-24">24</a>
   <a href="#section-9">9</a>. Contributors ...................................................<a href="#page-24">24</a>
   <a href="#section-10">10</a>. Acknowledgements ..............................................<a href="#page-24">24</a>
   <a href="#section-11">11</a>. References ....................................................<a href="#page-25">25</a>
      <a href="#section-11.1">11.1</a>. Normative References .....................................<a href="#page-25">25</a>
      <a href="#section-11.2">11.2</a>. Informative References ...................................<a href="#page-26">26</a>

















<span class="grey">Abley, et al.                 Informational                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   Site multihoming is an arrangement by which a site may use multiple
   paths to the rest of the Internet to provide better reliability for
   traffic passing in and out of the site than would be possible with a
   single path.  Some of the motivations for operators to multihome
   their network are described in [<a href="rfc3582.html" title='"Goals for IPv6 Site- Multihoming Architectures"'>RFC3582</a>].

   In IPv4, site multihoming is achieved by injecting the additional
   state required to allow session resilience over re-homing events
   [<a href="rfc4116.html" title='"IPv4 Multihoming Practices and Limitations"'>RFC4116</a>] into the global Internet routing system (sometimes referred
   to as the Default-Free Zone, or DFZ).  There is concern that this
   approach will not scale [<a href="rfc3221.html" title='"Commentary on Inter-Domain Routing in the Internet"'>RFC3221</a>] [<a href="rfc4984.html" title='"Report from the IAB Workshop on Routing and Addressing"'>RFC4984</a>].

   Site multihoming in IPv6 can be achieved as in IPv4, thus facing
   similar scalability concerns.  However, IPv6's large address space
   enables a different solution for site multihoming in IPv6: to assign
   multiple addresses to each host, one or more from each provider.
   Deploying site multihoming in this way does not impact the routing
   system.  So such a site multihoming strategy may be extended to a
   large number of sites, and may be applied to small sites that would
   not be eligible for site multihoming based on the injection of routes
   to Provider Independent (PI) prefixes.  A drawback of this
   multihoming approach is that it does not provide transport-layer
   stability across re-homing events.

   Shim6 provides layer-3 support for making re-homing events
   transparent to the transport layer by means of a shim approach.  Once
   a Shim6 session has been established, the failure detection mechanism
   defined for Shim6 allows finding new, valid locator combinations in
   case of failure and using these locators to continue the
   communication.  However, Shim6 does not provide failure protection to
   the communication establishment, so if a host within a multihomed
   site attempts to establish a communication with a remote host and
   selects an address that corresponds to a failed transit path, the
   communication will fail.  State information relating to the
   multihoming of two endpoints exchanging unicast traffic is retained
   on the endpoints themselves, rather than in the network.
   Communications between Shim6-capable hosts and Shim6-incapable hosts
   proceed as normal, but without the benefit of transport-layer
   stability.  The Shim6 approach is thought to have better scaling
   properties with respect to the state held in the DFZ than the PI
   approach.  In order to successfully deploy Shim6 in a multihomed
   site, additional mechanisms may be required to solve issues, such as
   selecting the source address appropriate to the destination and to
   the outgoing provider, or to allow the network manager to perform
   traffic engineering.  Such problems are not specific to Shim6, but
   are relevant to the hosts of any site that is connected to multiple



<span class="grey">Abley, et al.                 Informational                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


   transit providers, and that receives an IPv6 prefix from each of the
   providers [<a href="rfc5220.html" title='"Problem Statement for Default Address Selection in Multi-Prefix Environments: Operational Issues of RFC 3484 Default Rules"'>RFC5220</a>].  Some of these mechanisms are not defined today.
   However, note that once a Shim6 session has been established, Shim6
   reduces the impact of these problems, because if a working path
   exists, Shim6 will find it.

   This note describes the applicability of the Level 3 multihoming
   (hereafter Shim6) protocol defined in [<a href="rfc5533.html" title='"Shim6: Level 3 Multihoming Shim Protocol for IPv6"'>RFC5533</a>] and the failure
   detection mechanisms defined in [<a href="rfc5534.html" title='"Failure Detection and Locator Pair Exploration Protocol for IPv6 Multihoming"'>RFC5534</a>].

   The terminology used in this document, including terms like locator
   and Upper-Layer Identifier (ULID), is defined in [<a href="rfc5533.html" title='"Shim6: Level 3 Multihoming Shim Protocol for IPv6"'>RFC5533</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Deployment%20Scenarios"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Deployment Scenarios</span>

   The goal of the Shim6 protocol is to support locator agility in
   established communications; different layer-3 endpoint addresses may
   be used to exchange packets belonging to the same transport-layer
   session, all the time presenting a consistent identifier pair to
   upper-layer protocols.

   In order to be useful, the Shim6 protocol requires that at least one
   of the peers have more than one address that could be used on the
   wire (as locators).  In the event of communications failure between
   an active pair of addresses, the Shim6 protocol attempts to
   reestablish communication by trying different combinations of
   locators.

   While other multi-addressing scenarios are not precluded, the
   scenario in which the Shim6 protocol is expected to operate is that
   of a multihomed site that is connected to multiple transit providers,
   and that receives an IPv6 prefix from each of them.  This
   configuration is intended to provide protection for the end-site in
   the event of a failure in some subset of the available transit
   providers, without requiring the end-site to acquire PI address space
   or requiring any particular cooperation between the transit
   providers.














<span class="grey">Abley, et al.                 Informational                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


    ,------------------------------------.       ,----------------.
    |        Rest of the Internet        +-------+ Remote Host R  |
    `--+-----------+------------------+--'       `----------------'
       |           |                  |            LR[1] ... LR[m]
   ,---+----.  ,---+----.        ,----+---.
   | ISP[1] |  | ISP[2] | ...... | ISP[n] |
   `---+----'  `---+----'        `----+---'
       |           |                  |
   ,---+-----------+------------------+---.
   |   Multi-Homed Site S assigned        |
   |   prefixes P[1], P[2], ..., P[n]     |
   |                                      |
   |  ,--------. L[1] = P[1]:iid[1],      |
   |  | Host H | L[2] = P[2]:iid[2], ...  |
   |  `--------' L[n] = P[n]:iid[n]       |
   `--------------------------------------'

                                 Figure 1

   In the scenario illustrated in Figure 1, host H communicates with
   some remote host R.  Each of the addresses L[i] configured on host H
   in the multihomed site S can be reached through provider ISP[i] only,
   since ISP[i] is solely responsible for advertising a covering prefix
   for P[i] to the rest of the Internet.

   The use of locator L[i] on H hence causes inbound traffic towards H
   to be routed through ISP[i].  Changing the locator from L[i] to L[j]
   will have the effect of re-routing inbound traffic to H from ISP[i]
   to ISP[j].  This is the central mechanism by which the Shim6 protocol
   aims to provide multihoming functionality: by changing locators, host
   H can change the upstream ISP used to route inbound packets towards
   itself.  Regarding the outbound traffic to H, the path taken in this
   case depends on both the actual locator LR[j] used for R, and the
   administrative exit selection policy of site S.  As discussed in
   <a href="#section-4">Section 4</a>, the site should deliver outgoing packets that have a
   source address derived from the prefix of ISP[i] to that particular
   provider, in order to prevent those packets from being filtered due
   to ingress filtering [<a href="rfc2827.html" title='"Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing"'>RFC2827</a>] being applied by the providers.  It is
   worth noting that in a scenario such as the one depicted in Figure 1,
   the paths followed by inbound and outbound traffic are determined, to
   a large extent, by the locators in use for the communication.  This
   is not a particular issue of Shim6, but it is common to any
   deployment in which hosts are configured with addresses received from
   different providers.  Traffic Engineering in such sites will likely
   involve proper configuration of address selection policies in the
   hosts, by means of mechanisms such as the ones discussed in <a href="#section-4">Section</a>
   <a href="#section-4">4</a>.




<span class="grey">Abley, et al.                 Informational                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


   The Shim6 protocol has other potential applications beyond site
   multihoming.  For example, since Shim6 is a host-based protocol, it
   can also be used to support host multihoming.  In this case, a
   failure in communication between a multihomed host and some other
   remote host might be repaired by selecting a locator associated with
   a different interface.

   To allow nodes to benefit from the capabilities provided by Shim6,
   (discussed in <a href="#section-5">Section 5</a>) such as fault tolerance, nodes should be
   configured to initiate a Shim6 session with any peer node if they
   have multiple locators to use.  Note that this configuration can be
   performed transparently to the applications, in the sense that
   applications do not need to be aware of the Shim6 functionality
   provided by the node; in particular, nodes are not forced to use the
   Shim6 API [<a href="rfc6316.html" title='"Sockets Application Program Interface (API) for Multihoming Shim"'>RFC6316</a>] to benefit from Shim6.  The Shim6 session should
   be created after the two nodes have been communicating for some time,
   i.e., using the deferred context establishment facility provided by
   Shim6.  Otherwise, the cost of the Shim6 4-way handshake used for
   establishing the session may exceed the benefits provided for short-
   lived communications (see <a href="#section-5.1.2">Section 5.1.2</a>).  More advanced node
   configuration may involve configuring different delays for initiating
   the session for different applications, for example, based on a per-
   port configuration.  Nodes being able to use a single locator for the
   communication should not initiate the creation of a Shim6 context,
   but should participate if another node initiates it.  Note that
   Shim6-aware applications can override this behavior by means of the
   Shim6 API [<a href="rfc6316.html" title='"Sockets Application Program Interface (API) for Multihoming Shim"'>RFC6316</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Addresses%20and%20Shim6"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Addresses and Shim6</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Protocol%20Version%20%28IPv4%20vs.%20IPv6%29"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Protocol Version (IPv4 vs. IPv6)</span>

   The Shim6 protocol is defined only for IPv6.  While some Shim6-like
   approaches have been suggested to support IPv4 addresses as a locator
   [<a href="#ref-SHIM6-ESD" title='"Extended Shim6 Design for ID/loc split and Traffic Engineering"'>SHIM6-ESD</a>], it is not clear if such extensions are feasible.

   The Shim6 protocol, as specified for IPv6, incorporates cryptographic
   elements in the construction of locators (see [<a href="rfc3972.html" title='"Cryptographically Generated Addresses (CGA)"'>RFC3972</a>] and
   [<a href="rfc5535.html" title='"Hash-Based Addresses (HBA)"'>RFC5535</a>]).  Since IPv4 addresses are insufficiently large to contain
   addresses constructed in this fashion, direct use of Shim6 with IPv4
   addresses is not possible.

   In addition, there are other factors to take into account when
   considering the support of IPv4 addresses, in particular, IPv4
   locators.  Using multiple IPv4 addresses in a single host in order to
   support the Shim6 style of multihoming would result in an increased
   IPv4 address consumption, which would be problematic considering that
   the IPv4 address space has been exhausted.  Besides, Shim6 may



<span class="grey">Abley, et al.                 Informational                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


   experience additional problems if locators become translated on the
   wire.  Address translation is more likely to involve IPv4 addresses.
   IPv4 addresses can be translated to other IPv4 addresses (for
   example, a private IPv4 address into a public IPv4 address and vice
   versa) or to/from IPv6 addresses (for example, as defined by NAT64
   [<a href="rfc6146.html" title='"Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers"'>RFC6146</a>]).  When address translation occurs, a locator exchanged by
   Shim6 could be different from the address needed to reach the
   corresponding host, either because the translated version of the
   locator exchanged by Shim6 is not known or because the translation
   state no longer exists in the translator device.  Besides, the
   translated locators will not be verifiable with the current
   Cryptographically Generated Address (CGA) and Hash-Based Address
   (HBA) verification mechanisms, which protect the locators as seen by
   the node for which they are configured.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Prefix%20Lengths"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Prefix Lengths</span>

   The Shim6 protocol does not assume that all the prefixes assigned to
   the multihomed site have the same prefix length.

   However, the use of CGA [<a href="rfc3972.html" title='"Cryptographically Generated Addresses (CGA)"'>RFC3972</a>] and HBA [<a href="rfc5535.html" title='"Hash-Based Addresses (HBA)"'>RFC5535</a>] involves encoding
   information in the lower 64 bits of the locators.  This imposes the
   requirement that all interface addresses should be able to
   accommodate 64-bit interface identifiers on Shim6-capable hosts.
   Note that this is imposed by <a href="rfc4291.html">RFC 4291</a> [<a href="rfc4291.html" title='"IP Version 6 Addressing Architecture"'>RFC4291</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Address%20Generation%20and%20Configuration"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Address Generation and Configuration</span>

   The security of the Shim6 protocol is based on the use of CGA and HBA
   addresses.

   The CGA and HBA generation process can use the information provided
   by the stateless auto-configuration mechanism defined in [<a href="rfc4862.html" title='"IPv6 Stateless Address Autoconfiguration"'>RFC4862</a>]
   with the additional considerations presented in [<a href="rfc3972.html" title='"Cryptographically Generated Addresses (CGA)"'>RFC3972</a>] and
   [<a href="rfc5535.html" title='"Hash-Based Addresses (HBA)"'>RFC5535</a>].

   Stateful address auto-configuration using DHCP [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>] is not
   currently supported, because there is no defined mechanism to convey
   the CGA Parameter Data Structure and other relevant information from
   the DHCP server to the host.  An analysis of the possible
   interactions between DHCPv6 and CGA can be found in [<a href="#ref-DHCPv6-CGA" title='"Analysis of Possible DHCPv6 and CGA Interactions"'>DHCPv6-CGA</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Use%20of%20CGA%20vs.%20HBA"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Use of CGA vs. HBA</span>

   The choice between CGA and HBA is a trade-off between flexibility and
   performance.





<span class="grey">Abley, et al.                 Informational                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


   The use of HBA is more efficient in the sense that addresses require
   less computation than CGA, involving only hash operations for both
   the generation and the verification of locator sets.  However, the
   locators of an HBA set are determined during the generation process
   and cannot be subsequently changed; the addition of new locators to
   that initial set is not supported.  Therefore, a node using an HBA as
   a ULID for a Shim6 session can only use the locators associated to
   that HBA for the considered Shim6 session.  If the node wants to use
   a new set of locators, it has to generate a new HBA including the
   prefixes of the new locators (which will result with very high
   probability in different addresses to those of the previous set).
   New sessions initiated with a ULID belonging to the new HBA address
   set could use the new locators.

   The use of CGA is more computationally expensive, involving public-
   key cryptography in the verification of locator sets.  However, CGAs
   are more flexible in the sense that they support the dynamic
   modification of locator sets.

   Therefore, CGAs are well suited to support dynamic environments such
   as mobile hosts, where the locator set must be changed frequently.
   HBAs are better suited for sites where the prefix set remains
   relatively stable.

   It should be noted that since HBAs are defined as a CGA extension, it
   is possible to generate an address that incorporates the strengths of
   both HBA and CGA, i.e., that a single address can be used as an HBA,
   enabling computationally-cheap validation amongst a fixed set of
   addresses, and also as a CGA, enabling dynamic manipulation of the
   locator set.  For additional details, see [<a href="rfc5535.html" title='"Hash-Based Addresses (HBA)"'>RFC5535</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Shim6%20in%20Multihomed%20Nodes"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Shim6 in Multihomed Nodes</span>

   Shim6 multihomed nodes are likely to experience problems related to
   the attachment to different provision domains.  Note that these
   problems are not specific to Shim6.  [<a href="rfc6418.html" title='"Multiple Interfaces and Provisioning Domains Problem Statement"'>RFC6418</a>] discusses the problems
   associated with nodes with multiple interfaces, which may involve
   difficulties in

   o  managing the configuration associated with different providers.

   o  finding the appropriate DNS server to resolve a query and to match
      DNS answers to providers.

   o  routing the packets to the right provider.

   o  selecting the source address appropriate to the destination and to
      the outgoing provider.



<span class="grey">Abley, et al.                 Informational                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


   o  performing session management appropriately.

   Some of these problems may also arise in single-interface hosts
   connected to multiple networks, for example, in configurations in
   which a customer network receives multiple Provider Aggregatable
   prefixes.  These problems are relevant to other solutions supporting
   multihoming, such as Stream Control Transmission Protocol (SCTP)
   [<a href="rfc4960.html" title='"Stream Control Transmission Protocol"'>RFC4960</a>], Multipath TCP (MPTCP) [<a href="rfc6182.html" title='"Architectural Guidelines for Multipath TCP Development"'>RFC6182</a>], or Host Identity Protocol
   (HIP) [<a href="rfc4423.html" title='"Host Identity Protocol (HIP) Architecture"'>RFC4423</a>].  Note also that single-homed nodes implementing
   Shim6 to improve communications with other nodes having multiple
   addresses will not experience these problems.

   The compatibility of Shim6 with configurations or mechanisms
   developed to solve any multihoming problem has to be carefully
   considered on a case-by-case basis.  However, the interaction of
   Shim6 with some of the solutions discussed in [<a href="#ref-IPv6NAT" title='"IPv6 Multihoming without Network Address Translation"'>IPv6NAT</a>] is commented
   on in the next paragraphs.

   In order to configure source and destination address selection, tools
   such as DHCPv6 can be used to disseminate an [<a href="rfc3484.html" title='"Default Address Selection for Internet Protocol version 6 (IPv6)"'>RFC3484</a>] policy table
   to a host [<a href="#ref-6MAN" title='"Distributing Address Selection Policy using DHCPv6"'>6MAN</a>].  The impact to Shim6 using this solution, which
   disseminates the policy table to the hosts, is the following: Shim6
   selects the ULID pair to use in communication according to the
   mechanism described in [<a href="rfc3484.html" title='"Default Address Selection for Internet Protocol version 6 (IPv6)"'>RFC3484</a>].  In case different locator pairs
   need to be explored, nodes also use the rules defined by [<a href="rfc3484.html" title='"Default Address Selection for Internet Protocol version 6 (IPv6)"'>RFC3484</a>] to
   identify valid pairs, and to establish an order among them, as
   described in [<a href="rfc5534.html" title='"Failure Detection and Locator Pair Exploration Protocol for IPv6 Multihoming"'>RFC5534</a>].

   When a locator has been selected by a host to be used as the source
   address for a Shim6 session, Shim6 has no means to enforce an
   appropriate path for that source address in either the host or the
   network.  For IPv6 nodes, the next-hop router to use for a given set
   of destinations can be configured through Extensions to Router
   Advertisements, through Default Router Preference and More-Specific
   Routes [<a href="rfc4191.html" title='"Default Router Preferences and More-Specific Routes"'>RFC4191</a>], the use of a DHCPv6 option, or the use of a routing
   protocol.  It is also possible to rely on routers that consider
   source addresses in their forwarding decisions in addition to the
   usual destination-based forwarding.  All these solutions are
   compatible with Shim6 operation.  Note that an improper matching of
   source address and egress provider may result in packets being
   dropped if the provider performs ingress filtering [<a href="rfc2827.html" title='"Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing"'>RFC2827</a>], i.e.,
   dropping packets that come from customer networks with source
   addresses not belonging to the prefix assigned to them to prevent
   address spoofing.







<span class="grey">Abley, et al.                 Informational                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


   For some particular configurations, i.e., for a walled-garden or
   closed service, the node may need to identify the most appropriate
   DNS server to resolve a particular query.  For an analysis of this
   problem, the reader is referred to [<a href="#ref-IPv6NAT" title='"IPv6 Multihoming without Network Address Translation"'>IPv6NAT</a>].

   Finally, note that Shim6 is built to handle communication problems,
   so it may recover from the misconfiguration (or lack) of some of the
   mechanisms used to handle the aforementioned problems.  For example,
   if any notification is received from the router dropping the packets
   with legitimate source addresses as a result of ingress filtering,
   the affected locator could be associated with a low preference (or
   not be used at all).  But even if such a notification is not
   received, or not processed by the Shim6 layer, the defective source
   address or next-hop selection will be treated as a communication
   failure.  Therefore, Shim6 re-homing could finally select a working
   path in which packets are not filtered, if this path exists.  This
   behavior results from the powerful end-to-end resilience properties
   exhibited by the REAchability Protocol (REAP) [<a href="rfc5534.html" title='"Failure Detection and Locator Pair Exploration Protocol for IPv6 Multihoming"'>RFC5534</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Shim6%20Capabilities"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Shim6 Capabilities</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Fault%20Tolerance"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Fault Tolerance</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.1.%20%20Establishing%20Communications%20After%20an%20Outage"></a><a class="selflink" href="#section-5.1.1" name="section-5.1.1">5.1.1</a>.  Establishing Communications After an Outage</span>

   If a host within a multihomed site attempts to establish a
   communication with a remote host and selects a locator that
   corresponds to a failed transit path, bidirectional communication
   between the two hosts will not succeed.  In order to establish a new
   communication, the initiating host must try different combinations of
   (source, destination) locator pairs until it finds a pair that works.
   The mechanism for this default address selection is described in
   [<a href="rfc3484.html" title='"Default Address Selection for Internet Protocol version 6 (IPv6)"'>RFC3484</a>].  As a result of the use of this mechanism, some failures
   may not be recovered, even if a valid alternative path exists between
   two communicating hosts.  For example, assuming a failure in ISP[1]
   (see Figure 1), and host H initiating a communication with host R,
   the source address selection algorithm described in [<a href="rfc3484.html" title='"Default Address Selection for Internet Protocol version 6 (IPv6)"'>RFC3484</a>] may
   result in the selection of the source address corresponding to ISP[1]
   for every destination address being tried by the application.
   However, note that if R is the node initiating the communication, it
   will find a valid path provided that the application at R tries every
   available address for H.

   Since a Shim6 context is normally established between two hosts only
   after initial communication has been set up, there is no opportunity
   for Shim6 to participate in the discovery of a suitable, initial
   (source, destination) locator pair.  The same consideration holds for
   referrals, as described in <a href="#section-6">Section 6</a>.



<span class="grey">Abley, et al.                 Informational                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.2.%20%20Short-Lived%20and%20Long-Lived%20Communications"></a><a class="selflink" href="#section-5.1.2" name="section-5.1.2">5.1.2</a>.  Short-Lived and Long-Lived Communications</span>

   The Shim6 context establishment operation requires a 4-way packet
   exchange, and involves some overhead on the participating hosts in
   memory and CPU.

   For short-lived communications between two hosts, the benefit of
   establishing a Shim6 context might not exceed the cost, perhaps
   because the protocols concerned are fault tolerant and can arrange
   their own recovery (e.g., DNS) or because the frequency of re-homing
   events is sufficiently low that the probability of such a failure
   occurring during a short-lived exchange is not considered
   significant.

   It is anticipated that the exchange of Shim6 context will provide the
   most benefit for exchanges between hosts that are long-lived.  For
   this reason, the default behavior of Shim6-capable hosts is expected
   to employ deferred context-establishment.  Deferred context setup
   ensures that session-establishment time will not be increased by the
   use of Shim6.  This default behavior can be overridden by
   applications that prefer immediate context establishment, regardless
   of transaction longevity, by using [<a href="rfc6316.html" title='"Sockets Application Program Interface (API) for Multihoming Shim"'>RFC6316</a>].

   Note that all the above considerations refer to the lifetime of the
   interaction between the peers, and not the lifetime of a particular
   connection (e.g., TCP connection).  In other words, the Shim6 context
   is established between ULID pairs and it affects all the
   communication between these ULIDs.  So, two nodes with multiple
   short-lived communications using the same ULID pair would benefit as
   much from the Shim6 features as two nodes having a single long-lived
   communication.  One example of such a scenario would be a web-client
   software downloading web content from a server over multiple TCP
   connections.  Each TCP connection is short-lived, but the
   communication/contact between the two ULID could be long-lived.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Load%20Balancing"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Load Balancing</span>

   The Shim6 protocol does not support load balancing within a single
   context: all packets associated with a particular context are
   exchanged using a single locator pair per direction, with the
   exception of forked contexts, which are created upon explicit
   requests from the upper-layer protocol.

   It may be possible to extend the Shim6 protocol to use multiple
   locator pairs in a single context, but the impact of such an
   extension on upper-layer protocols (e.g., on TCP congestion control)
   should be considered carefully.




<span class="grey">Abley, et al.                 Informational                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


   When many contexts are considered together in aggregation, e.g., on a
   single host that participates in many simultaneous contexts or in a
   site full of hosts, some degree of load sharing should occur
   naturally due to the selection of different locator pairs in each
   context.  However, there is no mechanism defined to ensure that this
   natural load sharing is arranged to provide a statistical balance
   between transit providers.

   Note that the use of transport-layer solutions enhanced with
   mechanisms to allow the use of multiple paths for a transport session
   are more amenable for achieving load-balancing.  One such solution is
   MPTCP [<a href="rfc6182.html" title='"Architectural Guidelines for Multipath TCP Development"'>RFC6182</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Traffic%20Engineering"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Traffic Engineering</span>

   For sites with prefixes obtained from different providers, the paths
   followed by inbound and outbound traffic are determined to a large
   extent by the locators selected for each communication.  This is not
   a particular issue of Shim6, but it is common to any deployment in
   which hosts are configured with addresses received from different
   providers.  Traffic engineering in such sites will likely involve
   proper configuration of the address selection policies defined by
   [<a href="rfc3484.html" title='"Default Address Selection for Internet Protocol version 6 (IPv6)"'>RFC3484</a>].

   The Shim6 protocol provides some lightweight traffic engineering
   capabilities in the form of the Locator Preferences option, which
   allows a host to inform a remote host of local preferences for
   locator selection.  In this way, the host can influence the incoming
   path for the communication.  This mechanism is only available after a
   Shim6 context has been established, and it is a host-based capability
   rather than a site-based capability.  There is no defined mechanism
   that would allow use of the Locator Preferences option amongst a site
   full of hosts to be managed centrally by the administrator of the
   site.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Application%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Application Considerations</span>

   Shim6 provides multihoming support without forcing changes in the
   applications running on the host.  The fact that an address has been
   generated according to the CGA or HBA specification does not require
   any specific action from the application, e.g., it can obtain remote
   CGA or HBA addresses as a result of a getaddrinfo() call to trigger a
   DNS Request.  The storage of CGA or HBA addresses in DNS does not
   require any modification to this protocol, since they are recorded
   using AAAA records.  Moreover, neither the ULID/locator management
   [<a href="rfc5533.html" title='"Shim6: Level 3 Multihoming Shim Protocol for IPv6"'>RFC5533</a>] nor the failure detection and recovery [<a href="rfc5534.html" title='"Failure Detection and Locator Pair Exploration Protocol for IPv6 Multihoming"'>RFC5534</a>] functions
   require application awareness.




<span class="grey">Abley, et al.                 Informational                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


   However, a specific API [<a href="rfc6316.html" title='"Sockets Application Program Interface (API) for Multihoming Shim"'>RFC6316</a>] has been developed for those
   applications that might require additional capabilities in ULID/
   locator management, such as the locator pair in use for a given
   context, or the set of local or remote locators available for it.
   This API can also be used to disable Shim6 operation when required.

   It is worth noting that callbacks can benefit naturally from Shim6
   support.  In a callback, an application in B retrieves IP_A, the IP
   address of a peer A, and B uses IP_A to establish a new communication
   with A.  As long as the address exchanged, IP_A, is the ULID for the
   initial communication between A and B, and B uses the same address as
   in the initial communication, and this initial communication is alive
   (or the context has not been deleted), the new communication could
   use the locators exchanged by Shim6 for the first communication.  In
   this case, communication could proceed even if the ULID of A is not
   reachable.

   However, Shim6 does not provide specific protection to current
   applications when they use referrals.  A referral is the exchange of
   the IP address IP_A of a party A by party B to party C, so that party
   C could use IP_A to communicate with party A.  In a normal case, the
   ULID IP_A would be the only information sent by B to C as a referral.
   But if IP_A is no longer valid as the locator in A, C could have
   trouble establishing a communication with A.  Increased failure
   protection for referrals could be obtained if B exchanged the whole
   list of alternative locators of A; although, in this case the
   application protocol should be modified.  Note that B could send to C
   the current locator of A, instead of the ULID of A, as a way of using
   the most recent reachability information about A.  While in this case
   no modification of the application protocol is required, some
   concerns arise: host A may not accept one of its locators as ULID for
   initiating a communication, and if a CGA are used, the locator may
   not be a CGA so a Shim6 context among A and C could not be created.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Interaction%20with%20Other%20Protocols%20and%20Mechanisms"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Interaction with Other Protocols and Mechanisms</span>

   In this section we discuss the interaction between Shim6 and other
   protocols and mechanisms.  Before starting the discussion, it is
   worth noting that at the time of this writing, there is a lack of
   experience with the combination of Shim6 and these protocols and
   mechanisms.  Therefore, the conclusions stated should be reviewed as
   real experience is gained in the use of Shim6.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Shim6%20and%20Mobile%20IPv6"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Shim6 and Mobile IPv6</span>

   Here, we consider some scenarios in which the Shim6 protocol and the
   Mobile IPv6 (MIPv6) protocol [<a href="rfc6275.html" title='"Mobility Support in IPv6"'>RFC6275</a>] might be used simultaneously.




<span class="grey">Abley, et al.                 Informational                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.1.1.%20%20Multihomed%20Home%20Network"></a><a class="selflink" href="#section-7.1.1" name="section-7.1.1">7.1.1</a>.  Multihomed Home Network</span>

   In this case, the Home Network of the Mobile Node (MN) is multihomed.
   This implies the availability of multiple Home Network prefixes,
   resulting in multiple Home Addresses (HoAs) for each MN.  Since the
   MN is a node within a multihomed site, it seems reasonable to expect
   that the MN should be able to benefit from the multihoming
   capabilities provided by the Shim6 protocol.  Moreover, the MN needs
   to be able to obtain the multihoming benefits, even when it is
   roaming away from the Home Network: if the MN is away from the Home
   Network while the Home Network suffers a failure in a transit path,
   the MN should be able to continue communicating using alternate paths
   to reach the Home Network.

   The resulting scenario is the following:

       +------------------------------------+
       |               Internet             |
       +------------------------------------+
          |                   |
        +----+              +----+
        |ISP1|              |ISP2|
        +----+              +----+
          |                   |
       +------------------------------------+
       |   Multihomed Home Network          |
       |   Prefixes: P1 and P2              |
       |                                    |
       |                   Home Agent       |
       |                   //               |
       +------------------//----------------+
                         //
                        //
                      +-----+
                      | MN  | HoA1, HoA2
                      +-----+

                      Figure 2

   So, in this configuration, the Shim6 protocol is used to provide
   multiple communication paths to all the nodes within the multihomed
   sites (including the mobile nodes), and the MIPv6 protocol is used to
   support mobility of the multihomed site's mobile nodes.








<span class="grey">Abley, et al.                 Informational                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


   The proposed protocol architecture would be the following:

      +--------------+
      |  Application |
      +--------------+
      |  Transport   |
      +--------------+
      |      IP      |
      | +----------+ |
      | |  IPSec   | |
      | +----------+&lt;--ULIDs
      | | Shim6    | |
      | +----------+&lt;--HoAs
      | | MIPv6    | |
      | +----------+&lt;--CoAs
      |              |
      +--------------+
          Figure 3

   In this architecture, the upper-layer protocols and IPSec would use
   ULIDs of the Shim6 protocol (see <a href="rfc5533.html#section-16.1">Section 16.1 in [RFC5533]</a> for more
   detail on the interaction between Shim6 and IPsec).  Only the HoAs
   will be presented by the upper layers to the Shim6 layer as potential
   ULIDs.  Two Shim6 entities will exchange their own available HoAs as
   locators.  Therefore, Shim6 provides failover between different HoAs
   and allows preservation of established communications when an outage
   affects the path through the ISP that has delegated the HoA used for
   initiating the communication (similar to the case of a host within a
   multihomed site).  The Care-of Addresses (CoAs) are not presented to
   the Shim6 layer and are not included in the local locator set in this
   case.  The CoAs are managed by the MIPv6 layer, which binds each HoA
   to a CoA.  For example, if a single CoA, CoA1, is available for the
   MN in the foreign link to which it is attached, every HoA should have
   a bind to CoA1.

   So, in this case, the upper-layer protocols select a ULID pair for
   the communication.  The Shim6 protocol translates the ULID pair to an
   alternative locator in case that is needed.  Both the ULIDs and the
   alternative locators are HoAs.  Next, the MIPv6 layer maps the
   selected HoA to the corresponding CoA, which is the actual address
   included in the wire.

   The Shim6 context is established between the MN and the Correspondent
   Node (CN), and it would allow the communication to use all the
   available HoAs to provide fault tolerance.  The MIPv6 protocol is
   used between the MN and the Home Agent (HA) in the case of the
   bidirectional tunnel mode, and between the MN and the CN in case of
   the Route Optimization (RO) mode.



<span class="grey">Abley, et al.                 Informational                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.1.2.%20%20Shim6%20between%20the%20HA%20and%20the%20MN"></a><a class="selflink" href="#section-7.1.2" name="section-7.1.2">7.1.2</a>.  Shim6 between the HA and the MN</span>

   Another scenario where a Shim6-MIPv6 interaction may be useful is the
   case where a Shim6 context is established between the MN and the HA
   in order to provide fault tolerance capabilities to the bidirectional
   tunnel between them.

   Consider the case where the HA has multiple addresses (whether
   because the Home Network is multihomed or because the HA has multiple
   interfaces) and/or the MN has multiple addresses (whether because the
   visited network is multihomed or because the MN has multiple
   interfaces).  In this case, if a failure affects the address pair
   that is being used to run the tunnel between the MN and HA,
   additional mechanisms need to be used to preserve the communication.

   One possibility would be to use MIPv6 capabilities, by simply
   changing the CoA used as the tunnel endpoint.  However, MIPv6 lacks
   the failure detection mechanisms that would allow the MN and/or the
   HA to detect the failure and trigger the usage of an alternative
   address.  Shim6 provides such a failure detection protocol, so one
   possibility would be re-using the failure detection function from the
   Shim6 failure detection protocol in MIPv6.  In this case, the Shim6
   protocol wouldn't be used to create Shim6 context and provide fault
   tolerance, but just its failure detection functionality would be
   re-used.

   The other possibility would be to use the Shim6 protocol to create a
   Shim6 context between the HA and the MN, so that the Shim6 detects
   any failure and re-homes the communication in a transparent fashion
   to MIPv6.  In this case, the Shim6 protocol would be associated with
   the tunnel interface.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Shim6%20and%20SEND"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Shim6 and SEND</span>

   Secure Neighbor Discovery (SEND) [<a href="rfc3971.html" title='"SEcure Neighbor Discovery (SEND)"'>RFC3971</a>] uses CGAs to prove address
   ownership for Neighbor Discovery [<a href="rfc4861.html" title='"Neighbor Discovery for IP version 6 (IPv6)"'>RFC4861</a>].  The Shim6 protocol can
   use either CGAs or HBAs to protect locator sets included in Shim6
   contexts.  It is expected that some hosts will need to participate in
   both SEND and Shim6 simultaneously.

   In the case that both the SEND and Shim6 protocols are using the CGA
   technique to generate addresses, there is no conflict; the host will
   generate addresses for both purposes as CGAs, and since it will be in
   control of the associated private key, the same CGA can be used for
   the different protocols.






<span class="grey">Abley, et al.                 Informational                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


   In the case that a Shim6-capable host is using HBAs to protect its
   locator sets, the host will need to generate an address that is both
   a valid CGA and a valid HBA, as defined in [<a href="rfc5535.html" title='"Hash-Based Addresses (HBA)"'>RFC5535</a>].  In this case,
   the CGA Parameter Data Structure containing a valid public key and
   the Multi-Prefix extension are included as inputs to the hash
   function.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.3.%20%20Shim6%2C%20SCTP%2C%20and%20MPTCP"></a><a class="selflink" href="#section-7.3" name="section-7.3">7.3</a>.  Shim6, SCTP, and MPTCP</span>

   Both the SCTP [<a href="rfc4960.html" title='"Stream Control Transmission Protocol"'>RFC4960</a>] and MPTCP [<a href="rfc6182.html" title='"Architectural Guidelines for Multipath TCP Development"'>RFC6182</a>] protocols provide a
   reliable, stream-based communications channel between two hosts that
   provides a superset of the capabilities of TCP.  One notable feature
   of these two protocols is that they allow the exchange of endpoint
   addresses between hosts in order to recover from the failure of a
   particular endpoint pair, or to benefit from multipath communication
   in the MPTCP case, in a manner that is conceptually similar to
   locator selection in Shim6.

   SCTP and MPTCP are transport-layer protocols, higher in the protocol
   stack than Shim6; hence, there is no fundamental incompatibility that
   would prevent a Shim6-capable host from communicating using SCTP or
   MPTCP.

   However, since either SCTP or MPTCP, and Shim6 aim to exchange
   addressing information between hosts in order to meet the same
   generic goal, it is possible that their simultaneous use might result
   in unexpected behavior, e.g., lead to race conditions.

   The capabilities of these transport protocols with respect to path
   maintenance of a reliable, connection-oriented stream protocol are
   more extensive than the more general layer-3 locator agility provided
   by Shim6.  Therefore, it is recommended that Shim6 not be used for
   SCTP or MPTCP sessions, and that path maintenance be provided solely
   by SCTP or MPTCP.  There are at least two ways to enforce this
   behavior.  One option is to make the stack, and in particular the
   Shim6 sublayer, aware of the use of SCTP or MPTCP, and in this case
   refrain from creating a Shim6 context.  The other option is that the
   upper transport layer indicates, using a Shim6-capable API like the
   one proposed in [<a href="rfc6316.html" title='"Sockets Application Program Interface (API) for Multihoming Shim"'>RFC6316</a>], that no Shim6 context must be created for
   this particular communication.

   In general, the issues described here may also arise for protocols
   that handle different addresses for two communicating nodes at a
   higher level than the network layer to improve reliability,
   performance, congestion control, etc.






<span class="grey">Abley, et al.                 Informational                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.4.%20%20Shim6%20and%20NEMO"></a><a class="selflink" href="#section-7.4" name="section-7.4">7.4</a>.  Shim6 and NEMO</span>

   The Network Mobility (NEMO) [<a href="rfc3963.html" title='"Network Mobility (NEMO) Basic Support Protocol"'>RFC3963</a>] protocol extensions to MIPv6
   allow a Mobile Network to communicate through a bidirectional tunnel
   via a Mobile Router (MR) to a NEMO-compliant HA located in a Home
   Network.

   If either or both the MR or HA are multihomed, then an established
   Shim6 context preserves the integrity of the bidirectional tunnel
   between them in the event that a transit failure occurs in the
   connecting path.

   Once the tunnel between MR and HA is established, hosts within the
   Mobile Network that are Shim6-capable can establish contexts with
   remote hosts in order to receive the same multihoming benefits as any
   host located within the Home Network.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.5.%20%20Shim6%20and%20HIP"></a><a class="selflink" href="#section-7.5" name="section-7.5">7.5</a>.  Shim6 and HIP</span>

   Shim6 and HIP [<a href="rfc4423.html" title='"Host Identity Protocol (HIP) Architecture"'>RFC4423</a>] are architecturally similar in the sense that
   both solutions allow two hosts to use different locators to support
   communications between stable ULIDs.  The signaling exchange to
   establish the demultiplexing context on the hosts is very similar for
   both protocols.  However, there are a few key differences.  First,
   Shim6 avoids defining a new namespace for ULIDs, preferring instead
   to use a routable locator as a ULID, while HIP uses public keys and
   hashes thereof as ULIDs.  The use of a routable locator as the ULID
   better supports deferred context establishment, application
   callbacks, and application referrals, and avoids management and
   resolution costs of a new namespace, but requires additional security
   mechanisms to securely bind the ULID with the locators.  Second,
   Shim6 uses an explicit context header on data packets for which the
   ULIDs differ from the locators in use (this header is only needed
   after a failure/re-homing event occurs), while HIP may compress this
   context-tag function into the Encapsulating Security Payload (ESP)
   Security Parameter Index (SPI) field [<a href="rfc5201.html" title='"Host Identity Protocol"'>RFC5201</a>].  Third, HIP as
   presently defined requires the use of public-key operations in its
   signaling exchange and ESP encryption in the data plane, while the
   use of Shim6 requires neither (if only HBA addresses are used).  By
   default, HIP provides data protection, while this is a non-goal for
   Shim6.

   Shim6 aimed to provide a solution to a specific problem, multihoming,
   which minimizes deployment disruption, while HIP is considered more
   of an experimental approach intended to solve several more general
   problems (mobility, multihoming, and loss of end-to-end addressing
   transparency) through an explicit identifier/locator split.




<span class="grey">Abley, et al.                 Informational                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


   Communicating hosts that are willing to run HIP (perhaps extended
   with Shim6's failure detection protocol) likely have no reason to
   also run Shim6.  In this sense, HIP may be viewed as a possible long-
   term evolution or extension of the Shim6 architecture, or one
   possible implementation of the Extended Shim6 Design (ESD)
   [<a href="#ref-SHIM6-ESD" title='"Extended Shim6 Design for ID/loc split and Traffic Engineering"'>SHIM6-ESD</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.6.%20%20Shim6%20and%20Firewalls"></a><a class="selflink" href="#section-7.6" name="section-7.6">7.6</a>.  Shim6 and Firewalls</span>

   The ability of Shim6 to divert the communication to different paths
   may be affected by certain firewall configurations.  For example,
   consider a deployment in which one of the peers of a Shim6 session is
   protected by a firewall (i.e., all the paths to the locators of that
   peer traverse the firewall).  The firewall implements the Simple
   Security model [<a href="rfc4864.html" title='"Local Network Protection for IPv6"'>RFC4864</a>], in which incoming packets are checked
   against a state resulting from outgoing traffic, either associated
   with the locator of the internal node ('endpoint independent
   filtering') or to both the locators of the internal and external
   nodes ('address dependent filtering' or 'address and port dependent
   filtering').  If the external node changes the locator associated
   with the internal node, the packet will be discarded by the firewall.
   In addition, if the firewall implements 'address dependent filtering'
   or 'address and port dependent filtering', any change by the external
   node in the locator used to identify itself will also result in the
   packet being discarded by the firewall.

   This issue could be mitigated by making the firewalls aware of the
   different locators that could be associated with a given
   communication.  If the firewall is implemented in the communication
   node itself, the firewall could inspect the Shim6 control packet
   exchange to obtain this information, or the Shim6 software module
   could explicitly inform the firewall software module.  For firewalls
   located outside the node, the Shim6 control packet exchange can be
   used to associate the alternate locators to the communication state,
   although it may not work for topologies in which both directions for
   the communication do not traverse the firewall, or in which the
   firewall is not traversed after a locator change.  The detail of any
   of such mechanisms is out of the scope of this document.

   However, note that a failure in using the alternative locators does
   not impact the communication between the nodes as long as the path
   between them defined by the initial locator pair remains available.
   In this case, data packets flow between the communicating nodes as
   for any non-Shim6 communication.







<span class="grey">Abley, et al.                 Informational                    [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.7.%20%20Shim6%20and%20NPTv6"></a><a class="selflink" href="#section-7.7" name="section-7.7">7.7</a>.  Shim6 and NPTv6</span>

   Address translation techniques such as Network Prefix Translation
   (NPTv6) [<a href="rfc6296.html" title='"IPv6-to-IPv6 Network Prefix Translation"'>RFC6296</a>] may be used until workable solutions to avoid
   renumbering or facilitate multihoming are developed [<a href="rfc5902.html" title='"IAB Thoughts on IPv6 Network Address Translation"'>RFC5902</a>].  We
   now consider the impact of NPTv6 in Shim6 operation.  Some of the
   considerations stated in this section may also be applicable to other
   types of IPv6 NAT.

   The main purpose of Shim6 is to provide locator agility below
   transport protocols.  To prevent the risk of redirection attacks by
   abusing the locator exchange facilities provided by Shim6, the
   protocol is built upon the cryptographic properties of CGA and HBA
   addresses.  When the CGA address of a node is used as the local ULID,
   the locators configured in the node can be signed with the private
   key associated with the CGA.  A peer receiving a Shim6 message
   performs a hash of the CGA Parameter Data Structure information
   received, including a public key, to assure that this key is bound to
   the CGA address, and then checks the signature protecting the
   locators.  When an HBA address of a node is used as the local ULID,
   the HBA address securely chains the ULID and other locators of the
   node by means of a hash.  For both the CGA and the HBA, the locators
   can be exchanged at the four-way handshake used to establish the
   Shim6 context, or once the context has been established by means of
   an Update Request message.

   When a node behind an NPTv6 communicates, the NAT device translates
   the address assigned to this internal node to an address of its
   address pool.  This operation results in a mismatch between the
   address seen by external hosts and the address configured in the
   internal node, which is the locator that would be conveyed in a Shim6
   locator exchange and is also the address for which the security
   defined in the CGA and HBA specifications are provided.  Then, the
   validation processes performed by an external node may prevent the
   creation of the Shim6 context, or may allow the context to be created
   but render the alternative locator of the internal host unusable.

   However, note that the failure in creating a Shim6 context, or in
   using the alternative locators, does not impact the communication
   between the nodes as long as the path between them defined by the
   initial locator pair remains available.  Data packets flow between
   the communicating nodes as for any non-Shim6 communication.  Not
   creating the Shim6 context, or not being able to convey the local
   locators to the peer node, affect the added value provided by Shim6,
   i.e., the ability to preserve the communication in case any of the
   locators fail.  Therefore, using Shim6 with NPTv6 does not provide
   less functionality than using IPv6 in the same scenario.




<span class="grey">Abley, et al.                 Informational                    [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


   We now illustrate some cases that may occur when combining Shim6 and
   NPTv6.  The following discussion does not aim to be exhaustive in the
   cases that may arise, but just aims to provide some examples of
   possible situations.  We assume a scenario in which host A is located
   behind a NPTv6 device for its locator IP_A1, but it is connected to
   the public IPv6 Internet for its locator IP_A2.  Once translated,
   locator IP_A1 appears to external nodes as IP_T.  Node A communicates
   with node B, with public addresses IP_B1 and IP_B2.

                   +-----+
                   |  A  |
                   +-----+
              IP_A1 |  | IP_A2
                    |  |
                    |  +-----+
                    |        |
                +--------+   |
                | NPTv6  |   |
                +--------+   |
               IP_T |        |
                    |        |
           +--------------------------+
           |         Internet         |
           +--------------------------+
                     |  |
               IP_B1 |  | IP_B2
                   +-----+
                   |  B  |
                   +-----+

                   Figure 4

   We first discuss some issues related with the four-way handshake used
   to establish the Shim6 context.  When the locator information is
   included in the Shim6 exchange, either in the I2 or R2 messages, the
   receiver is required to validate the ULID of the peer node by
   performing the CGA or HBA address validation procedure.  In case the
   validation fails, the message containing the information is silently
   discarded.  In the scenario depicted in Figure 4, some of the cases
   that may occur are:

   o  Node A initiates the exchange, with IP_B1 as the destination
      address and IP_A1 as the source address, which is a CGA.  Node A
      includes IP_A2 as an alternative locator in the I2 message.  Node
      B sees IP_T as the ULID for A, so when it validates the CGA with
      the information contained in I2, the validation fails because the
      CGA Parameter Data Structure contains information bound to IP_A1.
      Therefore, B silently discards the received I2 message.  Without



<span class="grey">Abley, et al.                 Informational                    [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


      receiving a valid I2 message, B does not create the Shim6 context.
      Without receiving the R2 message, A also does not create the Shim6
      context.  However, data communication can proceed as long as the
      path between IP_A1 and IP_B1 is valid.  A similar case occurs if
      IP_A1 and IP_A2 form an HBA, instead of using CGAs for securing
      the communication.

   o  Node A initiates the exchange with IP_B1 as the destination
      address and IP_A2 (its public address) as the source address,
      which is a CGA.  Node A includes IP_A1 as an alternative locator
      in the I2 message.  In this case, B can successfully validate
      IP_A2 as a CGA.  Regarding the validation of IP_A1 as an
      alternative locator for A, the Shim6 specification [<a href="rfc5533.html" title='"Shim6: Level 3 Multihoming Shim Protocol for IPv6"'>RFC5533</a>]
      indicates that it should perform this check when the I2 message is
      received, but it may perform it later on, provided that the check
      is performed before using it as a locator.  In case the validation
      is performed when I2 is received, the I2 message would be silently
      discarded, with the same result as for the previous case.  In case
      the validation is performed later, the Shim6 context would be
      established in both nodes A and B, but B could not send to IP_A1,
      and packets sent by A from IP_A1 will not be received by B.  Note
      that in this case both IP_B1 and IP_B2 could be used by A and B,
      as long as the locator for A is IP_A2, so limited locator agility
      may be achieved.

   o  Node B initiates the exchange with IP_B1 as the source address,
      and IP_A2 as the destination address, which is a CGA.  This case
      is similar to the previous one, although it is the R2 message sent
      by A that cannot be validated.  While A can create a context with
      B, B cannot do the same for A.  Data communication using IP_B1 and
      IP_A2 can proceed.  However, A may try to use IP_B2 as an
      alternative locator, but the data packets sent carrying the Shim6
      Extension Header will not be associated by B to any established
      context, so they will be discarded.  The same occurs for packets
      sent by A with IP_A1 as the source address.

   We can also consider the case in which node A does not exchange its
   own locators in the Shim6 establishment exchange.  For example, a
   Shim6 context can be established between CGA IP_A2 and IP_B1.  B can
   convey locator IP_B2 in the four-way handshake, and validation will
   be correctly done by A.  Later on, A may send an Update Request
   message to inform B about its locator IP_A1.  Validation for this
   message will fail in B, and B will send a Shim6 Error message to A.
   Neither A nor B will use IP_A1 as a locator.  However, IP_A2, IP_B1,
   and IP_B2 can still be used as valid locators for the communication.






<span class="grey">Abley, et al.                 Informational                    [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


   Finally, note that modification of the Shim6 control packets by the
   NPTv6 would not be able to generate a valid signature when a CGA is
   being used or a Parameter Data Structure binding the translated
   locator to the other locators of a node when an HBA is being used.
   Therefore, the same failure cases described before would remain.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Security%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Security Considerations</span>

   This section considers the applicability of the Shim6 protocol from a
   security perspective, i.e., which security features can be expected
   by applications and users of the Shim6 protocol.

   First of all, it should be noted that the Shim6 protocol is not a
   security protocol, unlike HIP, for instance.  This means that, as
   opposed to HIP, it is an explicit non-goal of the Shim6 protocol to
   provide enhanced security for the communications that use the Shim6
   protocol.  The goal of the Shim6 protocol design, in terms of
   security, is not to introduce new vulnerabilities that were not
   present in the current non-Shim6 enabled communications.  In
   particular, it is an explicit non-goal of Shim6 protocol security to
   provide protection from on-path attackers.  On-path attackers are
   able to sniff and spoof packets in the current Internet, and they are
   able to do the same in Shim6 communications (as long as the
   communication flows through the path on which they are located).
   Summarizing, the Shim6 protocol does not provide data packet
   protection from on-path attackers.

   However, the Shim6 protocol does use several security techniques.
   The goal of these security measures is to protect the Shim6 signaling
   protocol from new attacks resulting from the adoption of the Shim6
   protocol.  In particular, the use of HBA/CGA prevents on-path and
   off-path attackers from injecting new locators into the locator set
   of a Shim6 context, thus preventing redirection attacks [<a href="rfc4218.html" title='"Threats Relating to IPv6 Multihoming Solutions"'>RFC4218</a>].
   Moreover, the usage of probes before re-homing to a different locator
   as a destination address prevents flooding attacks from off-path
   attackers.  Note that for nodes using CGA addresses, security depends
   on the secure handling of the private key associated with the
   signature and validation of locators.  In particular, any address
   configuration method must assure that the private key remains secret,
   as discussed in <a href="#section-3.3">Section 3.3</a>.

   In addition, the usage of a 4-way handshake for establishing the
   Shim6 context protects against DoS attacks, so hosts implementing the
   Shim6 protocol should not be more vulnerable to DoS attacks than
   regular IPv6 hosts.

   Finally, many Shim6 signaling messages contain a Context Tag, meaning
   that only attackers that know the Context Tag can forge them.  As a



<span class="grey">Abley, et al.                 Informational                    [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


   consequence, only on-path attackers can generate false Shim6
   signaling packets for an established context.  The impact of these
   attacks would be limited since they would not be able to add
   additional locators to the locator set (because of the HBA/CGA
   protection).  In general, the possible attacks have similar effects
   to the ones that an on-path attacker can launch on any regular IPv6
   communication.  The residual threats are described in the Security
   Considerations of the Shim6 protocol specification [<a href="rfc5533.html" title='"Shim6: Level 3 Multihoming Shim Protocol for IPv6"'>RFC5533</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Privacy%20Considerations"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Privacy Considerations</span>

   The Shim6 protocol is designed to provide some basic privacy
   features.  In particular, HBAs are generated in such a way that the
   different addresses assigned to a host cannot be trivially linked
   together as belonging to the same host, since there is nothing in
   common in the addresses themselves.  Similar features are provided
   when the CGA protection is used.  This means that it is not trivial
   to determine that a set of addresses is assigned to a single Shim6
   host.

   However, the Shim6 protocol does exchange the locator set in clear
   text, and it also uses a fixed Context Tag when using different
   locators in a given context.  This implies that an attacker observing
   the Shim6 context establishment exchange or seeing different payload
   packets exchanged through different locators, but with the same
   Context Tag, can determine the set of addresses assigned to a host.
   However, this requires that the attacker be located along the path
   and can capture the Shim6 signaling packets.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Contributors"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Contributors</span>

   The analysis on the interaction between the Shim6 protocol and the
   other protocols presented in this note benefited from the advice of
   various people including Tom Henderson, Erik Nordmark, Hesham
   Soliman, Vijay Devarpalli, John Loughney, and Dave Thaler.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Acknowledgements"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Acknowledgements</span>

   Joe Abley's work was supported, in part, by the US National Science
   Foundation (research grant SCI-0427144) and DNS-OARC.

   Marcelo Bagnulo worked on this document while visiting Ericsson
   Research Laboratory Nomadiclab.

   Alberto Garcia-Martinez was supported, in part, by the eeCONTET
   project (TEC2011-29688-C02-02, granted by the Spanish Science and
   Innovation Ministry).




<span class="grey">Abley, et al.                 Informational                    [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


   Shinta Sugimoto reviewed this document and provided comments and
   text.

   Brian Carpenter, Jari Arkko, Joel Halpern, Iljitsch van Beijnum, Sam
   Xia, Carsten Bormann, Dan Wing, Stephen Farrell, and Stewart Bryant
   reviewed this document and provided comments.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20References"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.1.%20%20Normative%20References"></a><a class="selflink" href="#section-11.1" name="section-11.1">11.1</a>.  Normative References</span>

   [<a id="ref-RFC2827" name="ref-RFC2827">RFC2827</a>]    Ferguson, P. and D. Senie, "Network Ingress Filtering:
                Defeating Denial of Service Attacks which employ IP
                Source Address Spoofing", <a href="https://tools.ietf.org/html/bcp38">BCP 38</a>, <a href="rfc2827.html">RFC 2827</a>, May 2000.

   [<a id="ref-RFC3315" name="ref-RFC3315">RFC3315</a>]    Droms, R., Ed., Bound, J., Volz, B., Lemon, T., Perkins,
                C., and M. Carney, "Dynamic Host Configuration Protocol
                for IPv6 (DHCPv6)", <a href="rfc3315.html">RFC 3315</a>, July 2003.

   [<a id="ref-RFC3484" name="ref-RFC3484">RFC3484</a>]    Draves, R., "Default Address Selection for Internet
                Protocol version 6 (IPv6)", <a href="rfc3484.html">RFC 3484</a>, February 2003.

   [<a id="ref-RFC3963" name="ref-RFC3963">RFC3963</a>]    Devarapalli, V., Wakikawa, R., Petrescu, A., and P.
                Thubert, "Network Mobility (NEMO) Basic Support
                Protocol", <a href="rfc3963.html">RFC 3963</a>, January 2005.

   [<a id="ref-RFC3971" name="ref-RFC3971">RFC3971</a>]    Arkko, J., Ed., Kempf, J., Zill, B., and P. Nikander,
                "SEcure Neighbor Discovery (SEND)", <a href="rfc3971.html">RFC 3971</a>, March
                2005.

   [<a id="ref-RFC3972" name="ref-RFC3972">RFC3972</a>]    Aura, T., "Cryptographically Generated Addresses (CGA)",
                <a href="rfc3972.html">RFC 3972</a>, March 2005.

   [<a id="ref-RFC4291" name="ref-RFC4291">RFC4291</a>]    Hinden, R. and S. Deering, "IP Version 6 Addressing
                Architecture", <a href="rfc4291.html">RFC 4291</a>, February 2006.

   [<a id="ref-RFC4423" name="ref-RFC4423">RFC4423</a>]    Moskowitz, R. and P. Nikander, "Host Identity Protocol
                (HIP) Architecture", <a href="rfc4423.html">RFC 4423</a>, May 2006.

   [<a id="ref-RFC4861" name="ref-RFC4861">RFC4861</a>]    Narten, T., Nordmark, E., Simpson, W., and H. Soliman,
                "Neighbor Discovery for IP version 6 (IPv6)", <a href="rfc4861.html">RFC 4861</a>,
                September 2007.

   [<a id="ref-RFC4862" name="ref-RFC4862">RFC4862</a>]    Thomson, S., Narten, T., and T. Jinmei, "IPv6 Stateless
                Address Autoconfiguration", <a href="rfc4862.html">RFC 4862</a>, September 2007.

   [<a id="ref-RFC4960" name="ref-RFC4960">RFC4960</a>]    Stewart, R., Ed., "Stream Control Transmission
                Protocol", <a href="rfc4960.html">RFC 4960</a>, September 2007.



<span class="grey">Abley, et al.                 Informational                    [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


   [<a id="ref-RFC5201" name="ref-RFC5201">RFC5201</a>]    Moskowitz, R., Nikander, P., Jokela, P., Ed., and T.
                Henderson, "Host Identity Protocol", <a href="rfc5201.html">RFC 5201</a>, April
                2008.

   [<a id="ref-RFC5533" name="ref-RFC5533">RFC5533</a>]    Nordmark, E. and M. Bagnulo, "Shim6: Level 3 Multihoming
                Shim Protocol for IPv6", <a href="rfc5533.html">RFC 5533</a>, June 2009.

   [<a id="ref-RFC5534" name="ref-RFC5534">RFC5534</a>]    Arkko, J. and I. van Beijnum, "Failure Detection and
                Locator Pair Exploration Protocol for IPv6 Multihoming",
                <a href="rfc5534.html">RFC 5534</a>, June 2009.

   [<a id="ref-RFC5535" name="ref-RFC5535">RFC5535</a>]    Bagnulo, M., "Hash-Based Addresses (HBA)", <a href="rfc5535.html">RFC 5535</a>,
                June 2009.

   [<a id="ref-RFC6146" name="ref-RFC6146">RFC6146</a>]    Bagnulo, M., Matthews, P., and I. van Beijnum, "Stateful
                NAT64: Network Address and Protocol Translation from
                IPv6 Clients to IPv4 Servers", <a href="rfc6146.html">RFC 6146</a>, April 2011.

   [<a id="ref-RFC6182" name="ref-RFC6182">RFC6182</a>]    Ford, A., Raiciu, C., Handley, M., Barre, S., and J.
                Iyengar, "Architectural Guidelines for Multipath TCP
                Development", <a href="rfc6182.html">RFC 6182</a>, March 2011.

   [<a id="ref-RFC6275" name="ref-RFC6275">RFC6275</a>]    Perkins, C., Ed., Johnson, D., and J. Arkko, "Mobility
                Support in IPv6", <a href="rfc6275.html">RFC 6275</a>, July 2011.

   [<a id="ref-RFC6316" name="ref-RFC6316">RFC6316</a>]    Komu, M., Bagnulo, M., Slavov, K., and S. Sugimoto, Ed.,
                "Sockets Application Program Interface (API) for
                Multihoming Shim", <a href="rfc6316.html">RFC 6316</a>, July 2011.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.2.%20%20Informative%20References"></a><a class="selflink" href="#section-11.2" name="section-11.2">11.2</a>.  Informative References</span>

   [<a id="ref-6MAN" name="ref-6MAN">6MAN</a>]       Matsumoto, A., Fujisaki, T., Kato, J., and T. Chown,
                "Distributing Address Selection Policy using DHCPv6",
                Work in Progress, February 2012.

   [<a id="ref-DHCPv6-CGA" name="ref-DHCPv6-CGA">DHCPv6-CGA</a>] Jiang, S. and S. Shen, "Analysis of Possible DHCPv6 and
                CGA Interactions", Work in Progress, March 2012.

   [<a id="ref-IPv6NAT" name="ref-IPv6NAT">IPv6NAT</a>]    Matsushima, S., Okimoto, T., Troan, O., Miles, D., and
                D.  Wing, "IPv6 Multihoming without Network Address
                Translation", Work in Progress, February 2012.

   [<a id="ref-RFC3221" name="ref-RFC3221">RFC3221</a>]    Huston, G., "Commentary on Inter-Domain Routing in the
                Internet", <a href="rfc3221.html">RFC 3221</a>, December 2001.

   [<a id="ref-RFC3582" name="ref-RFC3582">RFC3582</a>]    Abley, J., Black, B., and V. Gill, "Goals for IPv6 Site-
                Multihoming Architectures", <a href="rfc3582.html">RFC 3582</a>, August 2003.




<span class="grey">Abley, et al.                 Informational                    [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


   [<a id="ref-RFC4116" name="ref-RFC4116">RFC4116</a>]    Abley, J., Lindqvist, K., Davies, E., Black, B., and V.
                Gill, "IPv4 Multihoming Practices and Limitations", <a href="rfc4116.html">RFC</a>
                <a href="rfc4116.html">4116</a>, July 2005.

   [<a id="ref-RFC4191" name="ref-RFC4191">RFC4191</a>]    Draves, R. and D. Thaler, "Default Router Preferences
                and More-Specific Routes", <a href="rfc4191.html">RFC 4191</a>, November 2005.

   [<a id="ref-RFC4218" name="ref-RFC4218">RFC4218</a>]    Nordmark, E. and T. Li, "Threats Relating to IPv6
                Multihoming Solutions", <a href="rfc4218.html">RFC 4218</a>, October 2005.

   [<a id="ref-RFC4864" name="ref-RFC4864">RFC4864</a>]    Van de Velde, G., Hain, T., Droms, R., Carpenter, B.,
                and E. Klein, "Local Network Protection for IPv6", <a href="rfc4864.html">RFC</a>
                <a href="rfc4864.html">4864</a>, May 2007.

   [<a id="ref-RFC4984" name="ref-RFC4984">RFC4984</a>]    Meyer, D., Ed., Zhang, L., Ed., and K. Fall, Ed.,
                "Report from the IAB Workshop on Routing and
                Addressing", <a href="rfc4984.html">RFC 4984</a>, September 2007.

   [<a id="ref-RFC5220" name="ref-RFC5220">RFC5220</a>]    Matsumoto, A., Fujisaki, T., Hiromi, R., and K.
                Kanayama, "Problem Statement for Default Address
                Selection in Multi-Prefix Environments: Operational
                Issues of <a href="rfc3484.html">RFC 3484</a> Default Rules", <a href="rfc5220.html">RFC 5220</a>, July 2008.

   [<a id="ref-RFC5902" name="ref-RFC5902">RFC5902</a>]    Thaler, D., Zhang, L., and G. Lebovitz, "IAB Thoughts on
                IPv6 Network Address Translation", <a href="rfc5902.html">RFC 5902</a>, July 2010.

   [<a id="ref-RFC6296" name="ref-RFC6296">RFC6296</a>]    Wasserman, M. and F. Baker, "IPv6-to-IPv6 Network Prefix
                Translation", <a href="rfc6296.html">RFC 6296</a>, June 2011.

   [<a id="ref-RFC6418" name="ref-RFC6418">RFC6418</a>]    Blanchet, M. and P. Seite, "Multiple Interfaces and
                Provisioning Domains Problem Statement", <a href="rfc6418.html">RFC 6418</a>,
                November 2011.

   [<a id="ref-SHIM6-ESD" name="ref-SHIM6-ESD">SHIM6-ESD</a>]  Nordmark, E., "Extended Shim6 Design for ID/loc split
                and Traffic Engineering", Work in Progress, February
                2008.















<span class="grey">Abley, et al.                 Informational                    [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc6629.html">RFC 6629</a>           Shim6 Applicability Considerations          June 2012</span>


Authors' Addresses

   Joe Abley
   ICANN
   12025 Waterfront Drive
   Suite 300
   Los Angeles, CA 90094
   USA

   Phone: +1 519 670 9327
   EMail: joe.abley@icann.org


   Marcelo Bagnulo
   U. Carlos III de Madrid
   Av. Universidad 30
   Leganes, Madrid  28911
   Spain

   Phone: +34 91 6248814
   EMail: marcelo@it.uc3m.es
   URI:   <a href="http://www.it.uc3m.es/">http://www.it.uc3m.es/</a>


   Alberto Garcia-Martinez
   U. Carlos III de Madrid
   Av. Universidad 30
   Leganes, Madrid  28911
   Spain

   Phone: +34 91 6248782
   EMail: alberto@it.uc3m.es
   URI:   <a href="http://www.it.uc3m.es/">http://www.it.uc3m.es/</a>


















Abley, et al.                 Informational                    [Page 28]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc6629 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:27 GMT --></html>