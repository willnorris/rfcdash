<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7773 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:20 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:7773" name="DC.Identifier"/>
<meta content="This document defines an extension to X.509 certificates. The
extension defined in this document holds data about how the
certificate subject was authenticated by the Certification Authority
that issued the certificate in which this extension appears.  This
document also defines one data structure for inclusion in this
extension. The data structure is designed to hold information when the
subject is authenticated using a Security Assertion Markup Language
(SAML) assertion." name="DC.Description.Abstract"/>
<meta content="Stefan Santesson &lt;sts@aaa-sec.com&gt;" name="DC.Creator"/>
<meta content="March, 2016" name="DC.Date.Issued"/>
<meta content="Authentication Context Certificate Extension" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7773 - Authentication Context Certificate Extension</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7773.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7773" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-santesson-auth-context-extension" title="draft-santesson-auth-context-extension">draft-santesson...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7773" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7773" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7773" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                      S. Santesson
Request for Comments: 7773                                  3xA Security
Category: Standards Track                                     March 2016
ISSN: 2070-1721


              <span class="h1">Authentication Context Certificate Extension</span>

Abstract

   This document defines an extension to X.509 certificates.  The
   extension defined in this document holds data about how the
   certificate subject was authenticated by the Certification Authority
   that issued the certificate in which this extension appears.

   This document also defines one data structure for inclusion in this
   extension.  The data structure is designed to hold information when
   the subject is authenticated using a Security Assertion Markup
   Language (SAML) assertion.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7773">http://www.rfc-editor.org/info/rfc7773</a>.

Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



<span class="grey">Santesson                    Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7773.html">RFC 7773</a>            Authentication Context Extension          March 2016</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
      <a href="#section-1.1">1.1</a>. Terminology ................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Authentication Context Extension Syntax .........................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. SAML Authentication Context Information .........................<a href="#page-4">4</a>
      <a href="#section-3.1">3.1</a>. contextInfo Data Structure .................................<a href="#page-5">5</a>
           <a href="#section-3.1.1">3.1.1</a>. AuthContextInfo Element .............................<a href="#page-5">5</a>
           <a href="#section-3.1.2">3.1.2</a>. IdAttributes Element ................................<a href="#page-6">6</a>
   <a href="#section-4">4</a>. Security Considerations .........................................<a href="#page-8">8</a>
   <a href="#section-5">5</a>. Normative References ............................................<a href="#page-8">8</a>
   <a href="#appendix-A">Appendix A</a>. ASN.1 Modules .........................................<a href="#page-10">10</a>
      <a href="#appendix-A.1">A.1</a>. ASN.1 1988 Syntax .........................................<a href="#page-10">10</a>
      <a href="#appendix-A.2">A.2</a>. ASN.1 2008 Syntax .........................................<a href="#page-11">11</a>
   <a href="#appendix-B">Appendix B</a>. SAML Authentication Context Info XML Schema ...........<a href="#page-12">12</a>
      <a href="#appendix-B.1">B.1</a>. XML Schema ................................................<a href="#page-12">12</a>
   <a href="#appendix-C">Appendix C</a>. SAML Authentication Context Info XML Examples .........<a href="#page-14">14</a>
      <a href="#appendix-C.1">C.1</a>. Complete Context Information and Mappings .................<a href="#page-14">14</a>
      <a href="#appendix-C.2">C.2</a>. Only Mapping Information without SAML Attribute Values ....<a href="#page-15">15</a>
      <a href="#appendix-C.3">C.3</a>. Authentication Context and serialNumber Mapping ...........<a href="#page-16">16</a>
   Author's Address ..................................................<a href="#page-16">16</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The primary purpose of this document is to provide a mechanism that
   allows an application to obtain information that expresses the
   identity of a subject in an X.509 certificate according to [<a href="rfc5280.html" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>].
   The identity is stored either in a subject field attribute, as a
   subject alternative name, or in a subject directory attribute.

   The motivation for this work is to enable mapping of identity data
   between an identity system and a certificate where the identity
   system and the certificate are using different attributes and data
   formats to express the identity of the same entity.  In such a
   scenario, the certificate subject already has an authenticated
   identity composed of a set of attributes, or so-called claims, that
   differ from the set of attributes that are commonly used to express
   the identity of a certificate subject and that may be governed by a
   specific certificate profile limiting that set.

   A typical scenario motivating the definition of this extension arises
   when the source of user authentication and user identity is derived
   from a SAML [<a href="#ref-SAML" title='"Assertions and Protocols for the OASIS Security Assertion Markup Language (SAML) V2.0"'>SAML</a>] federation attribute profile.  In a SAML
   federation, the subject presents a SAML assertion in exchange for a
   certificate that can be uniquely linked to information provided in
   the original SAML assertion, e.g., attributes and/or level of
   assurance indicators.




<span class="grey">Santesson                    Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7773.html">RFC 7773</a>            Authentication Context Extension          March 2016</span>


   Such certificates are sometimes issued in order to provide the user
   with a means to create an electronic signature that ties the user to
   the SAML subject, its attributes, and level of assurance indicators.

   If such a certificate needs to conform to a certificate profile such
   as [<a href="rfc3739.html" title='"Internet X.509 Public Key Infrastructure: Qualified Certificates Profile"'>RFC3739</a>], then this certificate may have to use a separate set of
   attributes to express the subject identity.  The certificate also may
   have to employ a format for attribute values that is different from
   the set of attributes obtained from the SAML assertion.

   The extension defined in the document makes it possible to represent
   information about the authentication context employed when
   authenticating the subject for the purpose of issuing a certificate.
   This may include information such as:

      o  the Identity Provider that authenticated the subject
      o  the level of assurance with which the subject was authenticated
      o  the trust framework where this level of assurance was defined
      o  a unique reference to the authentication instant
      o  a mapping between the subject attributes (obtained from the
         SAML assertion used to authenticate the subject) and the
         subject identity information placed in the issued certificate.

   One scenario where this information may be useful arises when a user
   logs in to a service using SAML credentials, and the same user (at
   some point) is required to sign some information.  The service may
   need to verify that the signature was created by the same user that
   logged on to the service.  Today this is only possible using out-of-
   band knowledge about the Certification Authority (CA) that issued the
   certificate and its practices.  However, this approach does not scale
   to a large number of service providers, identity providers, and CAs.

   The extension defined here provides better scalability since it
   requires only the service provider to maintain a list of trusted CAs.
   All other information about the relationship between the certificate
   subject and the SAML authenticated subject is available in the
   certificate.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Terminology"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].








<span class="grey">Santesson                    Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7773.html">RFC 7773</a>            Authentication Context Extension          March 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Authentication%20Context%20Extension%20Syntax"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Authentication Context Extension Syntax</span>

   The Authentication Context extension has the following syntax:

      AuthenticationContexts ::= SEQUENCE SIZE (1..MAX) OF
                                 AuthenticationContext

      AuthenticationContext ::= SEQUENCE {
          contextType     UTF8String,
          contextInfo     UTF8String OPTIONAL
      }

   This extension holds a sequence of AuthenticationContext information.
   When present, this extension MUST include at least one
   AuthenticationContext.

   The type of authentication context defined in AuthenticationContext
   is identified by the contextType.  The contextType MUST contain a URI
   that identifies the context type as well as the data format and
   encoding of context information provided in contextInfo.

   This extension MAY be marked critical.

   Applications that find an authentication context information type
   they do not understand MUST ignore it if the extension is non-
   critical and MUST reject the certificate if the extension is marked
   critical.  If an application requires that an authentication context
   exist, and either the extension is absent or none of the provided
   authentication contexts can be used, the end-user certificate fails
   validation.

   This document defines one authentication context information type
   (<a href="#section-3">Section 3</a>) that is used to provide information about SAML-based
   authentication of the subject that was utilized in the certificate
   issuance process.  Other documents can define other authentication
   context information types.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20SAML%20Authentication%20Context%20Information"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  SAML Authentication Context Information</span>

   The SAML Authentication context information provides a contextType
   field that can be used to carry information about SAML-based
   authentication of the certified subject as utilized in the
   certificate issuance process.








<span class="grey">Santesson                    Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7773.html">RFC 7773</a>            Authentication Context Extension          March 2016</span>


   The data carried in this authentication context information field is
   identified by the following XML schema ([<a href="#ref-Schema1" title='"XML Schema Part 1: Structures"'>Schema1</a>] [<a href="#ref-Schema2" title='"XML Schema Part 2: Datatypes"'>Schema2</a>]) name
   space:

      <a href="http://id.elegnamnden.se/auth-cont/1.0/saci">http://id.elegnamnden.se/auth-cont/1.0/saci</a>

   When this URI is specified as contextType, the associated XML data
   provided in contextInfo MUST be provided in the form of an XML
   document [<a href="#ref-XML" title='"Extensible Markup Language (XML) 1.0 (Fifth Edition)"'>XML</a>], represented by a string of UTF-8-encoded characters.

   The XML document SHOULD exclude any unnecessary line breaks and white
   space, such as line indentation, to reduce its size as much as
   possible.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20contextInfo%20Data%20Structure"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  contextInfo Data Structure</span>

   The data provided in contextInfo SHALL contain XML that is UTF-8
   encoded in accordance with the XML schema provided in <a href="#appendix-B">Appendix B</a>.
   The XML document string in contextInfo MUST NOT include an XML
   header.  That is, the XML document string contains only the root
   element &lt;SAMLAuthContext&gt; with its child elements &lt;AuthContextInfo&gt;
   and &lt;IdAttributes&gt;.

   The &lt;AuthContextInfo&gt; and &lt;IdAttributes&gt; elements are outlined in the
   following subsections.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.1.%20%20AuthContextInfo%20Element"></a><a class="selflink" href="#section-3.1.1" name="section-3.1.1">3.1.1</a>.  AuthContextInfo Element</span>

   The &lt;AuthContextInfo&gt; element MAY be present.  This element contains
   the following attributes:

      IdentityProvider (required): The SAML EntityID of the Identity
         Provider that authenticated the subject.

      AuthenticationInstant (required): Date and time when the subject
         was authenticated, expressed according to <a href="#appendix-B.1">Appendix B.1</a>.

      AuthnContextClassRef (required): A URI identifying the
         AuthnContextClassRef that is provided in the AuthnStatement of
         the Assertion that was used to authenticate the subject.  This
         URI identifies the context and the level of assurance
         associated with this instance of authentication.

      AssertionRef (optional): A unique reference to the SAML assertion.

      ServiceID (optional): An identifier of the service that verified
         the SAML assertion.




<span class="grey">Santesson                    Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7773.html">RFC 7773</a>            Authentication Context Extension          March 2016</span>


   The &lt;AuthContextInfo&gt; element may hold any number of child elements
   of type any (processContents="lax"), providing additional information
   according to local conventions.  Any such elements SHOULD be ignored
   if not understood.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.2.%20%20IdAttributes%20Element"></a><a class="selflink" href="#section-3.1.2" name="section-3.1.2">3.1.2</a>.  IdAttributes Element</span>

   The &lt;IdAttributes&gt; element MAY be present.  This element holds a
   sequence of one or more &lt;AttributeMapping&gt; elements, where each
   &lt;AttributeMapping&gt; element contains mapping information about one
   certificate subject attribute or name form present in the
   certificate.

   Each &lt;AttributeMapping&gt; element MUST specify the following
   attributes:

      Type: A string containing one of the enumerated values "rdn",
            "san", or "sda", specifying the type of certificate
            attribute or name form for which mapping information is
            provided:

              "rdn": Mapping information is provided for an attribute in
                     a Relative Distinguished Name located in the
                     subject field.
              "san": Mapping information is provided for a name in the
                     Subject Alternative Name extension of the
                     certificate.
              "sda": Mapping information is provided for an attribute in
                     the Subject Directory Attributes extension.

      Ref:  A reference to the specific attribute or name field.  This
            reference is dependent on the value of Type in the following
            way:

              "rdn": Ref holds a string representation of the object
                     identifier (OID) of the relative distinguished name
                     attribute.
              "san": Ref holds a string representation of the explicit
                     tag number of the Subject Alternative Name type
                     (e.g., "1" = email address (rfc822Name) and "2" =
                     dNSName).  If the SubjectAlternative name is an
                     otherName, then Ref holds a string representation
                     of the OID defining the otherName form.
              "sda": Ref holds a string representation of the OID of the
                     subject directory attribute attribute.






<span class="grey">Santesson                    Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7773.html">RFC 7773</a>            Authentication Context Extension          March 2016</span>


            String representations of object identifiers (OID) in the
            Ref attribute MUST be represented by a sequence of integers
            separated by a period, e.g., "2.5.4.32".  This string
            contains only numerals (ASCII 0x30 to 0x39) and periods
            (ASCII 0x2E), and it MUST NOT contain any other characters.

   Each &lt;AttributeMapping&gt; element MUST contain a &lt;saml:Attribute&gt;
   element as defined in [<a href="#ref-SAML" title='"Assertions and Protocols for the OASIS Security Assertion Markup Language (SAML) V2.0"'>SAML</a>].  This SAML attribute element MUST have
   a Name attribute (specifying its type), MAY have other attributes,
   and MAY have zero or more &lt;saml:AttributeValue&gt; child elements.  A
   present SAML attribute with absent attribute value limits mapping to
   the type of SAML attribute that was used to obtain the value stored
   in the referenced certificate subject attribute or name form, without
   duplicating the actual attribute value.

   If an attribute value is present in the SAML attribute, then the
   value stored in the certificate in the referenced attribute or name
   form MAY differ in format and encoding from the present SAML
   attribute value.  For example, a SAML attribute value can specify a
   country expressed as "Sweden", while this country value is stored in
   the certificate in a countryName attribute using the two letter
   country code "SE".

   Several &lt;AttributeMapping&gt; elements MAY be present for the same
   certificate subject attribute or name form if the certificate
   contains multiple instances of this attribute or name form where
   their values were obtained from different SAML attributes.  However,
   in such cases, it is not defined which present subject attribute or
   name form maps to which SAML attribute.  A certificate-using
   application MAY attempt to determine this by comparing attribute
   values stored in this extension with attribute or name values present
   in the certificate, but this specification does not define any
   explicit matching rules that would guarantee an unambiguous result.

   The &lt;AttributeMapping&gt; element may hold any number of child elements
   of type any (processContents="lax"), providing additional information
   according to local conventions.  Any such elements MAY be ignored if
   not understood.

   Note: The &lt;AttributeMapping&gt; element is designed to provide mapping
         between SAML attributes and certificate subject attributes and
         name forms where there is a distinct and clear relationship
         between relevant SAML attributes and corresponding certificate
         attributes and name forms.  This does not cover all aspects of
         complex mapping situations.  If more than one SAML attribute
         maps to the same certificate attribute or if structured
         multivalued attributes are split into a range of other
         attributes and name forms, these situations are not covered.



<span class="grey">Santesson                    Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7773.html">RFC 7773</a>            Authentication Context Extension          March 2016</span>


         Such complex mapping situations MAY be covered by extending
         this XML schema or by defining a more versatile context
         information schema.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Security%20Considerations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Security Considerations</span>

   This extension allows a CA to outsource the process used to identify
   and authenticate a subject to another trust infrastructure in a
   dynamic manner that may differ from certificate to certificate.
   Since the authentication context is explicitly declared in the
   certificate, one certificate may be issued with a lower level of
   assurance than another, even though both have the same Issuer.

   This means that a relying party needs to be aware of the certificate
   policy under which this CA operates in order to understand when the
   certificate provides a level of assurance with regard to subject
   authentication that is higher than the lowest provided level.  A
   relying party that is not capable of understanding the information in
   the authentication context extension MUST assume that the certificate
   is issued using the lowest allowed level of assurance declared by the
   policy.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Normative%20References"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC3739" name="ref-RFC3739">RFC3739</a>]  Santesson, S., Nystrom, M., and T. Polk, "Internet X.509
              Public Key Infrastructure: Qualified Certificates
              Profile", <a href="rfc3739.html">RFC 3739</a>, DOI 10.17487/RFC3739, March 2004,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3739">http://www.rfc-editor.org/info/rfc3739</a>&gt;.

   [<a id="ref-RFC5280" name="ref-RFC5280">RFC5280</a>]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
              Housley, R., and W. Polk, "Internet X.509 Public Key
              Infrastructure Certificate and Certificate Revocation List
              (CRL) Profile", <a href="rfc5280.html">RFC 5280</a>, DOI 10.17487/RFC5280, May 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5280">http://www.rfc-editor.org/info/rfc5280</a>&gt;.

   [<a id="ref-RFC5912" name="ref-RFC5912">RFC5912</a>]  Hoffman, P. and J. Schaad, "New ASN.1 Modules for the
              Public Key Infrastructure Using X.509 (PKIX)", <a href="rfc5912.html">RFC 5912</a>,
              DOI 10.17487/RFC5912, June 2010,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5912">http://www.rfc-editor.org/info/rfc5912</a>&gt;.







<span class="grey">Santesson                    Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7773.html">RFC 7773</a>            Authentication Context Extension          March 2016</span>


   [<a id="ref-SAML" name="ref-SAML">SAML</a>]     Cantor, S., Kemp, J., Philpott, R., and E. Maler,
              "Assertions and Protocols for the OASIS Security Assertion
              Markup Language (SAML) V2.0", OASIS Standard, 15 March
              2005.

   [<a id="ref-XML" name="ref-XML">XML</a>]      Bray, T., Paoli, J., Sperberg-McQueen, C., Maler, E., and
              F. Yergeau, "Extensible Markup Language (XML) 1.0 (Fifth
              Edition)", W3C Recommendation, 26 November 2008,
              &lt;<a href="https://www.w3.org/TR/2008/REC-xml-20081126/">https://www.w3.org/TR/2008/REC-xml-20081126/</a>&gt;.

   [<a id="ref-Schema1" name="ref-Schema1">Schema1</a>]  Thompson, H., Beech, D., Maloney, M., and N. Mendelsohn,
              "XML Schema Part 1: Structures", W3C Recommendation,
              28 October 2004,
              &lt;<a href="http://www.w3.org/TR/2004/REC-xmlschema-1-20041028/">http://www.w3.org/TR/2004/REC-xmlschema-1-20041028/</a>&gt;.

   [<a id="ref-Schema2" name="ref-Schema2">Schema2</a>]  Biron, P. and A. Malhotra, "XML Schema Part 2: Datatypes",
              W3C Recommendation, 28 October 2004,
              &lt;<a href="http://www.w3.org/TR/2004/REC-xmlschema-2-20041028/">http://www.w3.org/TR/2004/REC-xmlschema-2-20041028/</a>&gt;.

































<span class="grey">Santesson                    Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7773.html">RFC 7773</a>            Authentication Context Extension          March 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20ASN.1%20Modules"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  ASN.1 Modules</span>

   This appendix includes the ASN.1 modules for the authentication
   context extension.  <a href="#appendix-B.1">Appendix B.1</a> includes an ASN.1 module that
   conforms to the 1998 version of ASN.1.  <a href="#appendix-B.2">Appendix B.2</a> includes an
   ASN.1 module, corresponding to the module present in <a href="#appendix-B.1">Appendix B.1</a>,
   that conforms to the 2008 version of ASN.1.  Although a 2008 ASN.1
   module is provided, the module in <a href="#appendix-B.1">Appendix B.1</a> remains the normative
   module as per policy adopted by the PKIX working group for
   certificate-related specifications.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.1.%20%20ASN.1%201988%20Syntax"></a><a class="selflink" href="#appendix-A.1" name="appendix-A.1">A.1</a>.  ASN.1 1988 Syntax</span>

 ACE-88
       {iso(1) member-body(2) se(752) e-legnamnden(201)
        id-mod(0) id-mod-auth-context-88(1)}

 DEFINITIONS EXPLICIT TAGS ::=

 BEGIN

 -- EXPORTS ALL --

 -- Authentication Context Extension

 AuthenticationContexts ::= SEQUENCE SIZE (1..MAX) OF
                            AuthenticationContext

 AuthenticationContext ::= SEQUENCE {
     contextType     UTF8String,
     contextInfo     UTF8String OPTIONAL
 }

 e-legnamnden      OBJECT IDENTIFIER ::= { iso(1) member-body(2)
                                           se(752) 201 }
 id-eleg-ce        OBJECT IDENTIFIER ::= { e-legnamnden 5 }
 id-ce-authContext OBJECT IDENTIFIER ::= { id-eleg-ce 1 }

 END












<span class="grey">Santesson                    Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7773.html">RFC 7773</a>            Authentication Context Extension          March 2016</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.2.%20%20ASN.1%202008%20Syntax"></a><a class="selflink" href="#appendix-A.2" name="appendix-A.2">A.2</a>.  ASN.1 2008 Syntax</span>

 ACE-08
       {iso(1) member-body(2) se(752) e-legnamnden(201)
        id-mod(0) id-mod-auth-context-08(2)}

 DEFINITIONS EXPLICIT TAGS ::=
 BEGIN
 EXPORTS ALL;
 IMPORTS

 Extensions{}, EXTENSION
 FROM PKIX-CommonTypes-2009 -- From [<a href="rfc5912.html" title='"New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)"'>RFC5912</a>]
     {iso(1) identified-organization(3) dod(6) internet(1) security(5)
     mechanisms(5) pkix(7) id-mod(0) id-mod-pkixCommon-02(57)};

 -- Authentication Context Extension

 ext-AuthenticationContext EXTENSION ::= { SYNTAX
        AuthenticationContexts IDENTIFIED BY
        id-ce-authContext }

 AuthenticationContexts ::= SEQUENCE SIZE (1..MAX) OF
                            AuthenticationContext

 AuthenticationContext ::= SEQUENCE {
     contextType     UTF8String,
     contextInfo     UTF8String OPTIONAL
 }

 ElegnamndenCertExtensions EXTENSION ::= {
     ext-AuthenticationContext, ... }



 e-legnamnden      OBJECT IDENTIFIER ::= { iso(1) member-body(2)
                                           se(752) 201 }
 id-eleg-ce        OBJECT IDENTIFIER ::= { e-legnamnden 5 }
 id-ce-authContext OBJECT IDENTIFIER ::= { id-eleg-ce 1 }

 END










<span class="grey">Santesson                    Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7773.html">RFC 7773</a>            Authentication Context Extension          March 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20B.%20%20SAML%20Authentication%20Context%20Info%20XML%20Schema"></a><a class="selflink" href="#appendix-B" name="appendix-B">Appendix B</a>.  SAML Authentication Context Info XML Schema</span>

 This appendix contains an XML schema ([<a href="#ref-Schema1" title='"XML Schema Part 1: Structures"'>Schema1</a>] [<a href="#ref-Schema2" title='"XML Schema Part 2: Datatypes"'>Schema2</a>]) for the SAML
 Authentication context information defined in <a href="#section-3">Section 3</a>.

 IMPORTANT NOTE: The XML Schema in <a href="#appendix-B.1">Appendix B.1</a> specifies a URL on rows
                 9 and 10 to the SAML schemaLocation
                 (<a href="http://docs.oasis-open.org/security/saml/v2.0/saml-schema-assertion-2.0.xsd">http://docs.oasis-open.org/security/saml/v2.0/</a>
                 <a href="http://docs.oasis-open.org/security/saml/v2.0/saml-schema-assertion-2.0.xsd">saml-schema-assertion-2.0.xsd</a>), which is too long to
                 fit into one row and therefore contains a line break.
                 This line break has to be removed before this schema
                 can be successfully compiled.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.1.%20%20XML%20Schema"></a><a class="selflink" href="#appendix-B.1" name="appendix-B.1">B.1</a>.  XML Schema</span>

 &lt;?xml version="1.0" encoding="UTF-8"?&gt;
 &lt;xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
            elementFormDefault="qualified"
     targetNamespace="http://id.elegnamnden.se/auth-cont/1.0/saci"
     xmlns:saci="http://id.elegnamnden.se/auth-cont/1.0/saci"
     xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion"&gt;

     &lt;xs:import namespace="urn:oasis:names:tc:SAML:2.0:assertion"
         schemaLocation="http://docs.oasis-open.org/security/saml/v2.0/
 saml-schema-assertion-2.0.xsd"/&gt;

     &lt;xs:element name="SAMLAuthContext"
                 type="saci:SAMLAuthContextType"/&gt;
     &lt;xs:complexType name="SAMLAuthContextType"&gt;
         &lt;xs:sequence&gt;
             &lt;xs:element ref="saci:AuthContextInfo" minOccurs="0"/&gt;
             &lt;xs:element ref="saci:IdAttributes" minOccurs="0"/&gt;
         &lt;/xs:sequence&gt;
     &lt;/xs:complexType&gt;
     &lt;xs:element name="AuthContextInfo"
                 type="saci:AuthContextInfoType"/&gt;
     &lt;xs:complexType name="AuthContextInfoType"&gt;
         &lt;xs:sequence&gt;
             &lt;xs:any processContents="lax"
                 minOccurs="0" maxOccurs="unbounded"/&gt;
         &lt;/xs:sequence&gt;
         &lt;xs:attribute name="IdentityProvider"
                       type="xs:string" use="required"/&gt;
         &lt;xs:attribute name="AuthenticationInstant"
                       type="xs:dateTime" use="required"/&gt;
         &lt;xs:attribute name="AuthnContextClassRef"
                       type="xs:anyURI" use="required"/&gt;
         &lt;xs:attribute name="AssertionRef" type="xs:string"/&gt;



<span class="grey">Santesson                    Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc7773.html">RFC 7773</a>            Authentication Context Extension          March 2016</span>


         &lt;xs:attribute name="ServiceID" type="xs:string"/&gt;
     &lt;/xs:complexType&gt;

     &lt;xs:element name="IdAttributes" type="saci:IdAttributesType"/&gt;
     &lt;xs:complexType name="IdAttributesType"&gt;
         &lt;xs:sequence&gt;
             &lt;xs:element maxOccurs="unbounded" minOccurs="1"
                         ref="saci:AttributeMapping"/&gt;
         &lt;/xs:sequence&gt;
     &lt;/xs:complexType&gt;
     &lt;xs:element name="AttributeMapping"
                 type="saci:AttributeMappingType"/&gt;
     &lt;xs:complexType name="AttributeMappingType"&gt;
         &lt;xs:sequence&gt;
             &lt;xs:element ref="saml:Attribute"/&gt;
             &lt;xs:any processContents="lax"
                 minOccurs="0" maxOccurs="unbounded"/&gt;
         &lt;/xs:sequence&gt;
         &lt;xs:attribute name="Type" use="required"&gt;
             &lt;xs:simpleType&gt;
                 &lt;xs:restriction base="xs:string"&gt;
                     &lt;xs:enumeration value="rdn"/&gt;
                     &lt;xs:enumeration value="san"/&gt;
                     &lt;xs:enumeration value="sda"/&gt;
                 &lt;/xs:restriction&gt;
             &lt;/xs:simpleType&gt;
         &lt;/xs:attribute&gt;
         &lt;xs:attribute name="Ref" type="xs:string" use="required"/&gt;
     &lt;/xs:complexType&gt;
 &lt;/xs:schema&gt;





















<span class="grey">Santesson                    Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc7773.html">RFC 7773</a>            Authentication Context Extension          March 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20C.%20%20SAML%20Authentication%20Context%20Info%20XML%20Examples"></a><a class="selflink" href="#appendix-C" name="appendix-C">Appendix C</a>.  SAML Authentication Context Info XML Examples</span>

   This appendix provides examples of SAML Authentication Context
   information according to the schema in <a href="#appendix-B">Appendix B</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/C.1.%20%20Complete%20Context%20Information%20and%20Mappings"></a><a class="selflink" href="#appendix-C.1" name="appendix-C.1">C.1</a>.  Complete Context Information and Mappings</span>

   The following is a complete example with authentication context
   information as well as mapping information for several subject field
   attributes and a subject alt name.

&lt;saci:SAMLAuthContext
    xmlns:saci="http://id.elegnamnden.se/auth-cont/1.0/saci"
    xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
    &lt;saci:AuthContextInfo
        ServiceID="eid2csig"
        AssertionRef="_71b981ab017eb42869ae4b62b2a63add"
        IdentityProvider="https://idp-test.nordu.net/idp/shibboleth"
        AuthenticationInstant="2013-03-05T22:59:57.000+01:00"
        AuthnContextClassRef="http://id.elegnamnden.se/loa/1.0/loa3"/&gt;
    &lt;saci:IdAttributes&gt;
        &lt;saci:AttributeMapping Type="rdn" Ref="2.5.4.6"&gt;
            &lt;saml:Attribute
                FriendlyName="Country"
                Name="urn:oid:2.5.4.6"&gt;
                &lt;saml:AttributeValue xsi:type="xs:string"
                    &gt;SE&lt;/saml:AttributeValue&gt;
            &lt;/saml:Attribute&gt;
        &lt;/saci:AttributeMapping&gt;
        &lt;saci:AttributeMapping Type="rdn" Ref="2.5.4.5"&gt;
            &lt;saml:Attribute
                FriendlyName="Personal ID Number"
                Name="urn:oid:1.2.752.29.4.13"&gt;
                &lt;saml:AttributeValue xsi:type="xs:string"
                    &gt;200007292386&lt;/saml:AttributeValue&gt;
            &lt;/saml:Attribute&gt;
        &lt;/saci:AttributeMapping&gt;
        &lt;saci:AttributeMapping Type="rdn" Ref="2.5.4.42"&gt;
            &lt;saml:Attribute
                FriendlyName="Given Name"
                Name="urn:oid:2.5.4.42"&gt;
                &lt;saml:AttributeValue xsi:type="xs:string"
                    &gt;John&lt;/saml:AttributeValue&gt;
            &lt;/saml:Attribute&gt;
        &lt;/saci:AttributeMapping&gt;
        &lt;saci:AttributeMapping Type="rdn" Ref="2.5.4.4"&gt;
            &lt;saml:Attribute



<span class="grey">Santesson                    Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc7773.html">RFC 7773</a>            Authentication Context Extension          March 2016</span>


                FriendlyName="Surname"
                Name="urn:oid:2.5.4.4"&gt;
                &lt;saml:AttributeValue xsi:type="xs:string"
                    &gt;Doe&lt;/saml:AttributeValue&gt;
            &lt;/saml:Attribute&gt;
        &lt;/saci:AttributeMapping&gt;
        &lt;saci:AttributeMapping Type="rdn" Ref="2.5.4.3"&gt;
            &lt;saml:Attribute
                FriendlyName="Display Name"
                Name="urn:oid:2.16.840.1.113730.3.1.241"&gt;
                &lt;saml:AttributeValue xsi:type="xs:string"
                    &gt;John Doe&lt;/saml:AttributeValue&gt;
            &lt;/saml:Attribute&gt;
        &lt;/saci:AttributeMapping&gt;
        &lt;saci:AttributeMapping Type="san" Ref="1"&gt;
            &lt;saml:Attribute
                FriendlyName="E-mail"
                Name="urn:oid:0.9.2342.19200300.100.1.3"&gt;
                &lt;saml:AttributeValue xsi:type="xs:string"
                    &gt;john.doe@example.com&lt;/saml:AttributeValue&gt;
            &lt;/saml:Attribute&gt;
        &lt;/saci:AttributeMapping&gt;
    &lt;/saci:IdAttributes&gt;
&lt;/saci:SAMLAuthContext&gt;

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/C.2.%20%20Only%20Mapping%20Information%20without%20SAML%20Attribute%20Values"></a><a class="selflink" href="#appendix-C.2" name="appendix-C.2">C.2</a>.  Only Mapping Information without SAML Attribute Values</span>

   This example shows an instance of the SAML Authentication Context
   information that only provides a mapping table without providing any
   authentication context information or SAML attribute values.

&lt;saci:SAMLAuthContext
    xmlns:saci="http://id.elegnamnden.se/auth-cont/1.0/saci"
    xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion"&gt;
    &lt;saci:IdAttributes&gt;
        &lt;saci:AttributeMapping Type="rdn" Ref="2.5.4.6"&gt;
            &lt;saml:Attribute Name="urn:oid:2.5.4.6"/&gt;
        &lt;/saci:AttributeMapping&gt;
        &lt;saci:AttributeMapping Type="rdn" Ref="2.5.4.5"&gt;
            &lt;saml:Attribute Name="urn:oid:1.2.752.29.4.13"/&gt;
        &lt;/saci:AttributeMapping&gt;
        &lt;saci:AttributeMapping Type="rdn" Ref="2.5.4.42"&gt;
            &lt;saml:Attribute Name="urn:oid:2.5.4.42"/&gt;
        &lt;/saci:AttributeMapping&gt;
        &lt;saci:AttributeMapping Type="rdn" Ref="2.5.4.4"&gt;
            &lt;saml:Attribute Name="urn:oid:2.5.4.4"/&gt;
        &lt;/saci:AttributeMapping&gt;
        &lt;saci:AttributeMapping Type="rdn" Ref="2.5.4.3"&gt;



<span class="grey">Santesson                    Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc7773.html">RFC 7773</a>            Authentication Context Extension          March 2016</span>


            &lt;saml:Attribute Name="urn:oid:2.16.840.1.113730.3.1.241"/&gt;
        &lt;/saci:AttributeMapping&gt;
        &lt;saci:AttributeMapping Type="san" Ref="1"&gt;
            &lt;saml:Attribute Name="urn:oid:0.9.2342.19200300.100.1.3"/&gt;
        &lt;/saci:AttributeMapping&gt;
    &lt;/saci:IdAttributes&gt;
&lt;/saci:SAMLAuthContext&gt;

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/C.3.%20%20Authentication%20Context%20and%20serialNumber%20Mapping"></a><a class="selflink" href="#appendix-C.3" name="appendix-C.3">C.3</a>.  Authentication Context and serialNumber Mapping</span>

   This example shows an instance of the SAML Authentication Context
   information; it provides authentication context information and
   mapping information that specifies the source of the data stored in
   the serialNumber attribute in the subject field.

&lt;saci:SAMLAuthContext
    xmlns:saci="http://id.elegnamnden.se/auth-cont/1.0/saci"
    xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
    &lt;saci:AuthContextInfo
        ServiceID="eid2csig"
        AssertionRef="_71b981ab017eb42869ae4b62b2a63add"
        IdentityProvider="https://idp-test.nordu.net/idp/shibboleth"
        AuthenticationInstant="2013-03-05T22:59:57.000+01:00"
        AuthnContextClassRef="http://id.elegnamnden.se/loa/1.0/loa3"/&gt;
    &lt;saci:IdAttributes&gt;
        &lt;saci:AttributeMapping Type="rdn" Ref="2.5.4.5"&gt;
            &lt;saml:Attribute
                FriendlyName="Personal ID Number"
                Name="urn:oid:1.2.752.29.4.13"&gt;
                &lt;saml:AttributeValue xsi:type="xs:string"
                    &gt;200007292386&lt;/saml:AttributeValue&gt;
            &lt;/saml:Attribute&gt;
        &lt;/saci:AttributeMapping&gt;
    &lt;/saci:IdAttributes&gt;
&lt;/saci:SAMLAuthContext&gt;

Author's Address

   Stefan Santesson
   3xA Security AB
   Scheelev. 17
   223 70 Lund
   Sweden
   Email: sts@aaa-sec.com






Santesson                    Standards Track                   [Page 16]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7773 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:20 GMT --></html>