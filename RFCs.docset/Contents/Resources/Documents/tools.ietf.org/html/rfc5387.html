<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc5387 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:36 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:5387" name="DC.Identifier"/>
<meta content='The Internet network security protocol suite, IPsec, consisting of
IKE, ESP, and AH, generally requires authentication of network layer
entities to bootstrap security. This authentication can be based on
mechanisms such as pre-shared symmetric keys, certificates and
associated asymmetric keys, or the use of Kerberos. The need to deploy
authentication information and its associated identities to network
layer entities can be a significant obstacle to use of network
security. This document explains the rationale for extending the
Internet network security suite to enable use of IPsec security
mechanisms without authentication. These extensions are intended to
protect communication in a "better than nothing" (BTNS) fashion. The
extensions may be used on their own (Stand Alone BTNS, or SAB), or may
be useful in providing network layer security that can be
authenticated by higher layers in the protocol stack, called Channel
Bound BTNS (CBB). This document also explains situations in which use
of SAB and CBB extensions are appropriate.' name="DC.Description.Abstract"/>
<meta content="Wang, Yu-Shun" name="DC.Creator"/>
<meta content="Touch, Joe" name="DC.Creator"/>
<meta content="Black, David" name="DC.Creator"/>
<meta content="November, 2008" name="DC.Date.Issued"/>
<meta content="Problem and Applicability Statement for Better Than Nothing Security (BTNS)" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5387 - Problem and Applicability Statement for Better Than Nothing Security (BTNS)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc5387.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc5387" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-btns-prob-and-applic" title="draft-ietf-btns-prob-and-applic">draft-ietf-btns...</a>] [<a href="https://datatracker.ietf.org/doc/rfc5387" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5387" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc5387" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=5387">Errata</a>]</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Network Working Group                                           J. Touch
Request for Comments: 5387                                       USC/ISI
Category: Informational                                         D. Black
                                                                     EMC
                                                                 Y. Wang
                                                               Microsoft
                                                           November 2008


                 <span class="h1">Problem and Applicability Statement</span>
                <span class="h1">for Better-Than-Nothing Security (BTNS)</span>

Status of This Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Copyright Notice

   Copyright (c) 2008 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.

Abstract

   The Internet network security protocol suite, IPsec, requires
   authentication, usually of network-layer entities, to enable access
   control and provide security services.  This authentication can be
   based on mechanisms such as pre-shared symmetric keys, certificates
   with associated asymmetric keys, or the use of Kerberos (via
   Kerberized Internet Negotiation of Keys (KINK)).  The need to deploy
   authentication information and its associated identities can be a
   significant obstacle to the use of IPsec.

   This document explains the rationale for extending the Internet
   network security protocol suite to enable use of IPsec security
   services without authentication.  These extensions are intended to
   protect communication, providing "better-than-nothing security"
   (BTNS).  The extensions may be used on their own (this use is called
   Stand-Alone BTNS, or SAB) or may be used to provide network-layer
   security that can be authenticated by higher layers in the protocol



<span class="grey">Touch, et al.                Informational                      [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


   stack (this use is called Channel-Bound BTNS, or CBB).  The document
   also explains situations for which use of SAB and/or CBB extensions
   are applicable.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Authentication .............................................<a href="#page-3">3</a>
      <a href="#section-1.2">1.2</a>. IPsec Channels and Channel Binding .........................<a href="#page-4">4</a>
      <a href="#section-1.3">1.3</a>. BTNS Methods ...............................................<a href="#page-6">6</a>
      <a href="#section-1.4">1.4</a>. BTNS Scope .................................................<a href="#page-6">6</a>
      <a href="#section-1.5">1.5</a>. Structure of This Document .................................<a href="#page-7">7</a>
   <a href="#section-2">2</a>. Problem Statement ...............................................<a href="#page-7">7</a>
      <a href="#section-2.1">2.1</a>. Network Layer ..............................................<a href="#page-8">8</a>
           <a href="#section-2.1.1">2.1.1</a>. Authentication Identities ...........................<a href="#page-8">8</a>
           <a href="#section-2.1.2">2.1.2</a>. Authentication Methods ..............................<a href="#page-8">8</a>
           <a href="#section-2.1.3">2.1.3</a>. Current IPsec Limits on Unauthenticated Peers .......<a href="#page-9">9</a>
      <a href="#section-2.2">2.2</a>. Higher Layer Issues ........................................<a href="#page-9">9</a>
           <a href="#section-2.2.1">2.2.1</a>. Transport Protection from Packet Spoofing ...........<a href="#page-9">9</a>
           <a href="#section-2.2.2">2.2.2</a>. Authentication at Multiple Layers ..................<a href="#page-10">10</a>
   <a href="#section-3">3</a>. BTNS Overview and Threat Models ................................<a href="#page-12">12</a>
      <a href="#section-3.1">3.1</a>. BTNS Overview .............................................<a href="#page-12">12</a>
      <a href="#section-3.2">3.2</a>. BTNS and IPsec Security Services ..........................<a href="#page-13">13</a>
      <a href="#section-3.3">3.3</a>. BTNS and IPsec Modes ......................................<a href="#page-14">14</a>
   <a href="#section-4">4</a>. Applicability Statement ........................................<a href="#page-15">15</a>
      <a href="#section-4.1">4.1</a>. Benefits ..................................................<a href="#page-16">16</a>
      <a href="#section-4.2">4.2</a>. Vulnerabilities ...........................................<a href="#page-16">16</a>
      <a href="#section-4.3">4.3</a>. Stand-Alone BTNS (SAB) ....................................<a href="#page-17">17</a>
           <a href="#section-4.3.1">4.3.1</a>. Symmetric SAB ......................................<a href="#page-17">17</a>
           <a href="#section-4.3.2">4.3.2</a>. Asymmetric SAB .....................................<a href="#page-18">18</a>
      <a href="#section-4.4">4.4</a>. Channel-Bound BTNS (CBB) ..................................<a href="#page-18">18</a>
      <a href="#section-4.5">4.5</a>. Summary of Uses, Vulnerabilities, and Benefits ............<a href="#page-19">19</a>
   <a href="#section-5">5</a>. Security Considerations ........................................<a href="#page-20">20</a>
      <a href="#section-5.1">5.1</a>. Threat Models and Evaluation ..............................<a href="#page-20">20</a>
      <a href="#section-5.2">5.2</a>. Interaction with Other Security Services ..................<a href="#page-20">20</a>
      <a href="#section-5.3">5.3</a>. MITM and Masquerader Attacks ..............................<a href="#page-21">21</a>
      5.4. Denial of Service (DoS) Attacks and Resource
           Consumptions ..............................................<a href="#page-22">22</a>
      <a href="#section-5.5">5.5</a>. Exposure to Anonymous Access ..............................<a href="#page-22">22</a>
      <a href="#section-5.6">5.6</a>. ICMP Attacks ..............................................<a href="#page-22">22</a>
      <a href="#section-5.7">5.7</a>. Leap of Faith .............................................<a href="#page-22">22</a>
      <a href="#section-5.8">5.8</a>. Connection Hijacking through Rekeying .....................<a href="#page-24">24</a>
      <a href="#section-5.9">5.9</a>. Configuration Errors ......................................<a href="#page-25">25</a>
   <a href="#section-6">6</a>. Related Efforts ................................................<a href="#page-25">25</a>
   <a href="#section-7">7</a>. Acknowledgments ................................................<a href="#page-25">25</a>
   <a href="#section-8">8</a>. Informative References .........................................<a href="#page-26">26</a>





<span class="grey">Touch, et al.                Informational                      [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   Network security is provided by a variety of protocols at different
   layers in the stack.  At the network layer, the IPsec protocol suite
   (consisting of IKE (Internet Key Exchange protocol), ESP
   (Encapsulating Security Payload), and AH (Authentication Header)) is
   used to secure IP traffic.  IPsec, including IKE, offers high levels
   of security that provide protection from a wide array of possible
   threats, but authentication is required [<a href="#ref-5" title='"The Internet Key Exchange (IKE)"'>5</a>][7][<a href="#ref-8" title='"Security Architecture for the Internet Protocol"'>8</a>].  In turn,
   authentication requires deployment of authentication identities and
   credentials, which can be an obstacle to IPsec usage.  This document
   discusses this dependency and introduces "Better-Than-Nothing
   Security" (BTNS) as one solution, whose goal is to provide a
   generally useful means of applying IPsec security services without
   requiring network-layer authentication.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Authentication"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Authentication</span>

   There are two primary architectural approaches to authentication:
   employing out-of-band communications and using pre-deployed
   information.  Out-of-band authentication can be done via a trusted
   third party, via a separate communication channel to the peer, or via
   the same channel as the communications to be secured but at a higher
   layer.  Out-of-band authentication requires mechanisms and interfaces
   to bind the authenticated identities to the secure communication
   channels, and is out of scope for this document (although it may be
   possible to extend the channel binding mode of BTNS to work with such
   mechanisms).  Pre-deployed information includes identities, pre-
   shared secrets, and credentials that have been authenticated by
   trusted authorities (e.g., a certificate and its corresponding
   private key).

   This form of authentication often requires manual deployment and
   coordination among communicating peers.  Furthermore, obtaining and
   deploying credentials such as certificates signed by certification
   authorities (CA) involves additional protocol and administrative
   actions that may incur significant time and effort to perform.

   These factors increase the work required to use IKE with IPsec for
   peer authentication.  Consequently, some users and applications do
   not use IPsec to protect traffic at the network layer, but rely
   instead on higher-layer security protocols (e.g., TLS [<a href="#ref-4" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>4</a>]) or operate
   without any security.  As <a href="#section-2.2.1">Section 2.2.1</a> describes, higher-layer
   security protocols may not be enough to protect against some
   network-layer attacks.






<span class="grey">Touch, et al.                Informational                      [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


   To improve the situation, one could either reduce the hurdles to
   obtain and configure authentication information or remove the
   requirement for authentication in IPsec.  The latter approach is the
   core idea of BTNS, which provides anonymous (unauthenticated) keying
   for IPsec to create security associations (SAs) with peers that do
   not possess requisite authentication credentials.  This requires
   extensions to the IPsec architecture.  As the new BTNS modes for
   IPsec relax the authentication requirement, the impacts, tradeoffs,
   and risks must be thoroughly understood before applying BTNS to any
   communications.  More specifically, this document addresses the
   issues of whether and when network-layer authentication can be
   omitted, the risks of using BTNS, and finally, the impacts to the
   existing IPsec architecture.

   BTNS employs a weaker notion of authenticated identity by comparison
   to most authentication protocols; this weaker notion is bootstrapped
   from the security association itself.  This notion, called
   "continuity of association", doesn't mean "Bill Smith" or "owner of
   shared secret X2YQ", but means "the entity with which I have been
   communicating on connection #23".  Continuity of association is only
   invariant within a single SA; it is not invariant across SAs, and
   hence can only be used to provide protection during the lifetime of
   an SA.  This is a core notion used by BTNS, particularly in the
   absence of higher-layer authentication.  Continuity of association
   can be viewed as a form of authentication in which an identity is not
   authenticated across separate associations or out-of-band, but does
   not change during the lifetime of the SA.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20IPsec%20Channels%20and%20Channel%20Binding"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  IPsec Channels and Channel Binding</span>

   When IPsec security services are used by higher-layer protocols, it
   is important to bind those services to higher-layer protocol sessions
   in order to ensure that the security services are consistently
   applied to the higher-layer traffic involved.  The result of this
   binding is an "IPsec channel", and the act of creating an IPsec
   channel is an instance of channel binding.  Channel binding is
   discussed in <a href="rfc5056.html">RFC 5056</a> [<a href="#ref-27" title='"On the Use of Channel Bindings to Secure Channels"'>27</a>] and in an associated connection latching
   document [<a href="#ref-26" title='"IPsec Channels: Connection Latching"'>26</a>].  This subsection summarizes the portions of these
   documents that are essential to understanding certain aspects of
   BTNS.

   A secure channel is a packet, datagram, octet stream connection, or
   sequence of connections between two endpoints that affords
   cryptographic integrity and, optionally, confidentiality to data
   exchanged over it [<a href="#ref-27" title='"On the Use of Channel Bindings to Secure Channels"'>27</a>].  Applying this concept to IPsec, an "IPsec
   channel" is a packet flow associated with a higher-layer protocol
   session, such as a TCP connection, where all the packets are
   protected by IPsec SAs such that:



<span class="grey">Touch, et al.                Informational                      [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


   o  the peer's identity is the same for the lifetime of the packet
      flow, and

   o  the quality of IPsec protection used for the packet flow's
      individual packets is the same for all of them for the lifetime of
      the packet flow [<a href="#ref-26" title='"IPsec Channels: Connection Latching"'>26</a>].

   The endpoints of an IPsec channel are the higher-layer protocol
   endpoints, which are beyond the endpoints of the IPsec SAs involved.
   This creates a need to bind each IPsec SA to the higher-layer
   protocol session and its endpoints.  Failure to do this binding
   creates vulnerabilities to man-in-the-middle (MITM) attacks, where
   what appears to be a single IPsec SA for the higher-layer protocol
   traffic is actually two separate SAs concatenated by the attacker
   acting as a traffic-forwarding proxy.

   The combination of connection latching [<a href="#ref-26" title='"IPsec Channels: Connection Latching"'>26</a>] with channel binding [<a href="#ref-27" title='"On the Use of Channel Bindings to Secure Channels"'>27</a>]
   creates IPsec channels and binds IPsec SAs to higher-layer protocols.
   Connection latching creates an IPsec channel by associating IPsec SAs
   to higher-layer protocol sessions, and channel binding enables a
   higher-layer protocol to bind its authentication to the IPsec SAs.
   Caching of this "latch" across higher-layer protocol sessions is
   necessary to counter inter-session spoofing attacks, and the channel
   binding authentication should be performed on each higher-layer
   protocol session.  Connection latching and channel binding are useful
   not only for BTNS but also for IPsec SAs whose peers are fully
   authenticated by IKE during creation of the SA.

   Channel binding for IPsec is based on information obtained from the
   SA creation process that uniquely identifies an SA pair.  Channel
   binding can be accomplished by adding this identifying information to
   higher-layer authentication mechanisms based on one-way hashes, key
   exchanges, or (public key) cryptographic signatures; in all three
   cases, the resulting higher-layer authentication resists man-in-the-
   middle attacks on SA creation.  When each IKE peer uses a public-
   private key pair for IKE authentication to create an SA pair, the
   pair of public keys used (one for each peer) suffices for channel
   binding; strong incorporation of this information into higher-layer
   authentication causes that higher-layer authentication to fail when
   an MITM attacker has concatenated separate SAs by acting as a
   traffic-forwarding proxy.










<span class="grey">Touch, et al.                Informational                      [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20BTNS%20Methods"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  BTNS Methods</span>

   There are two classes of scenarios in which BTNS may be used to apply
   IPsec services without network-layer authentication:

   1. Protection of traffic for a higher-layer protocol that does not
      use authentication.  The resulting protection is "better than
      nothing" because once an unauthenticated SA is successfully
      created without an MITM, that SA's IPsec security services resist
      subsequent MITM attacks even though the absence of authentication
      allows the initial creation of the BTNS-based security association
      (SA) to be subverted by an MITM.  This method of using BTNS is
      called Stand-Alone BTNS (SAB) because it does not rely on any
      security services outside of IPsec.

   2. Protection of traffic generated by a higher-layer protocol that
      uses authentication.  The "better-than-nothing" protection in this
      case relies on the strength of the higher-layer protocol's
      authentication and the channel binding of that authentication with
      the BTNS-based SAs.  The level of protection may be comparable to
      the level afforded by the use of network-layer IKE authentication
      when the higher-layer protocol uses strong authentication and
      strong channel binding is employed to associate the BTNS-based SA
      with that higher-layer authentication.  This method of using BTNS
      is called Channel-Bound BTNS (CBB) when the combination of the
      higher-layer authentication and channel binding is sufficient to
      detect an MITM attack on creation of a BTNS-based SA.

   It is possible to combine IKE authentication for one end of an SA
   pair with BTNS's absence of network-layer authentication for the
   other end.  The resulting asymmetric authentication creates
   asymmetric modes of BTNS that are discussed further in <a href="#section-3.2">Section 3.2</a>
   below.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.4.%20%20BTNS%20Scope"></a><a class="selflink" href="#section-1.4" name="section-1.4">1.4</a>.  BTNS Scope</span>

   The scope of BTNS is to provide a generally useful means of applying
   IPsec security services that does not require network-level
   authentication credentials.  The following areas are outside this
   scope of BTNS and hence are not discussed further in this document:

   1. Use of security frameworks other than IPsec to provide security
      services for higher-layer protocols.  There are a variety of
      security service frameworks other than IPsec, such as TLS [<a href="#ref-4" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>4</a>],
      Simple Authentication and Security Layer (SASL) [<a href="#ref-11" title='"Simple Authentication and Security Layer (SASL)"'>11</a>], and Generic
      Security Service Application Program Interface (GSS-API) [<a href="#ref-10" title='"Generic Security Service Application Program Interface Version 2, Update 1"'>10</a>], as
      well as a variety of non-IPsec security mechanisms, such as TCP




<span class="grey">Touch, et al.                Informational                      [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


      MD5 [<a href="#ref-6" title='"Protection of BGP Sessions via the TCP MD5 Signature Option"'>6</a>], that are described in other documents.  BTNS is based on
      IPsec by design; it will not always be the most appropriate
      solution.

   2. Use of the Extensible Authentication Protocol (EAP) for IKE
      authentication.  <a href="rfc3748.html#section-1.3">SectionÂ 1.3 of RFC 3748</a> clearly restricts EAP's
      applicability to network access protocols [<a href="#ref-1" title='"Extensible Authentication Protocol (EAP)"'>1</a>]:

         "EAP was designed for use in network access authentication,
         where IP layer connectivity may not be available.  Use of EAP
         for other purposes, such as bulk data transport, is NOT
         RECOMMENDED."

      Hence, EAP authentication for IKE is only applicable to situations
      where IKE is being used to establish network access (e.g., create
      a Virtual Private Network (VPN) connection).  In contrast, the
      BTNS goal of general applicability encompasses many areas other
      than network access and specifically includes protocols that
      transfer large amounts of data, such as iSCSI [<a href="#ref-19" title='"Internet Small Computer Systems Interface (iSCSI)"'>19</a>] and NFSv4 [<a href="#ref-21" title='"Network File System (NFS) version 4 Protocol"'>21</a>].

   3. Manual keying is not considered for BTNS because manual keying is
      unsafe for protocols that transfer large amounts of data (e.g.,
      <a href="rfc3723.html">RFC 3723</a> forbids use of manual keying with the IP Storage
      protocols, including iSCSI, for this reason [<a href="#ref-2" title='"Securing Block Storage Protocols over IP"'>2</a>]).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.5.%20%20Structure%20of%20This%20Document"></a><a class="selflink" href="#section-1.5" name="section-1.5">1.5</a>.  Structure of This Document</span>

   The next section discusses the motivations for BTNS, primarily based
   on the implications of IKE's requirements for network-layer
   authentication.  <a href="#section-3">Section 3</a> provides a high level overview of BTNS,
   both SAB and CBB.  <a href="#section-3">Section 3</a> also includes descriptions of the
   security services offered and the BTNS modes of operation (based on
   combinations of SAB, CBB, and/or IKE authentication).  <a href="#section-4">Section 4</a>
   explores the applicability of all of the modes of BTNS.  This is
   followed by a discussion of the risks and other security
   considerations in <a href="#section-5">Section 5</a>.  <a href="#section-6">Section 6</a> briefly describes other
   related efforts.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Problem%20Statement"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Problem Statement</span>

   This section describes the problems that motivated the development of
   BTNS.  The primary concern is that IPsec is not widely utilized
   despite rigorous development effort and emphasis on network security
   by users and organizations.  There are also differing viewpoints on
   which layer is best for securing network communications and how
   security protocols at different layers should interact.  The
   following discussion roughly categorizes these issues by layers:
   network layer and higher layers.



<span class="grey">Touch, et al.                Informational                      [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Network%20Layer"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Network Layer</span>

   At the network layer, one of the hurdles is to satisfy the
   authentication requirements of IPsec and IKE.  This section discusses
   some drawbacks of network-layer authentication and the results of
   these requirements.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.1.%20%20Authentication%20Identities"></a><a class="selflink" href="#section-2.1.1" name="section-2.1.1">2.1.1</a>.  Authentication Identities</span>

   Current IPsec authentication supports several types of identities in
   the Peer Authorization Database (PAD): IPv4 addresses, IPv6
   addresses, DNS names, Distinguished Names, <a href="rfc822.html">RFC 822</a> email addresses,
   and Key IDs [<a href="#ref-8" title='"Security Architecture for the Internet Protocol"'>8</a>].  All require either certificates or pre-shared
   secrets to authenticate.  The identities supported by the PAD can be
   roughly categorized as network-layer identifiers or other
   identifiers.

   The first three types of identifiers -- IPv4 addresses, IPv6
   addresses and DNS names -- are network-layer identifiers.  The main
   deficiency of IP addresses as identifiers is that they often do not
   consistently represent the same physical systems due to the
   increasing use of dynamic address assignments (DHCP) and system
   mobility.  The use of DNS names is also affected because the name to
   address mapping is not always up to date as a result.  Stale mapping
   information can cause inconsistencies between the IP address recorded
   in the DNS for a named system and the actual IP address of that
   system, leading to problems if the DNS is used to cross-check the IP
   address from which a DNS name was presented as an identifier.  DNS
   names are also not always under the control of the endpoint owner.

   There are two main drawbacks with the other, non-network-layer
   identifiers defined for the PAD.  The PAD functionality can be overly
   restrictive because there are other forms of identifiers not covered
   by the PAD specification (EAP does not loosen these restrictions in
   general; see <a href="#section-1.4">Section 1.4</a>).  Use of any non-network-layer identifiers
   for IPsec authentication may result in multiple authentications for
   the same or different identifiers at different layers, creating a
   need to associate authentications and new error cases (e.g., one of
   two authentications for the same identifier fails).  These issues are
   also related to channel binding and are further discussed later in
   this document.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.2.%20%20Authentication%20Methods"></a><a class="selflink" href="#section-2.1.2" name="section-2.1.2">2.1.2</a>.  Authentication Methods</span>

   As described earlier, certificates and pre-shared secrets are the
   only methods of authentication accepted by current IPsec and IKE
   specifications.  Pre-shared secrets require manual configuration and
   out-of-band communications.  The verification process for



<span class="grey">Touch, et al.                Informational                      [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


   certificates is cumbersome, plus there are administrative and
   potential monetary costs in obtaining certificates.  These factors
   are among the possible reasons why IPsec is not widely used outside
   of environments with the highest security requirements.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.3.%20%20Current%20IPsec%20Limits%20on%20Unauthenticated%20Peers"></a><a class="selflink" href="#section-2.1.3" name="section-2.1.3">2.1.3</a>.  Current IPsec Limits on Unauthenticated Peers</span>

   Pre-configuration of Security Policy Database (SPD) "bypass" entries
   to enable communication with unauthenticated peers only works if the
   peer IP addresses are known in advance.  The lack of unauthenticated
   IPsec modes often prevents secure communications at the network layer
   with unauthenticated or unknown peers, even when they are
   subsequently authenticated in a higher-layer protocol or application.
   The lack of a channel binding API between IPsec and higher-layer
   protocols may further force such communications to completely bypass
   IPsec, leaving the network layer of such communications unprotected.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Higher-Layer%20Issues"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Higher-Layer Issues</span>

   For higher layers, the next subsection focuses on whether IPsec is
   necessary if transport layer security is already in use.  The use of
   IPsec in the presence of transport security provides further
   motivation for reducing the administrative burdens of using IPsec.
   This is followed by a discussion of the implications of using
   authentication at both the network layer and a higher layer for the
   same connection.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.1.%20%20Transport%20Protection%20from%20Packet%20Spoofing"></a><a class="selflink" href="#section-2.2.1" name="section-2.2.1">2.2.1</a>.  Transport Protection from Packet Spoofing</span>

   Consider the case of transport protocols.  Increases in network
   performance and the use of long-lived connections have resulted in
   increased vulnerability of connection-oriented transport protocols to
   certain forms of attacks.  TCP, like many other protocols, is
   susceptible to off-path third-party attacks, such as injection of a
   TCP RST [<a href="#ref-24" title='"Defending TCP Against Spoofing Attacks"'>24</a>].  The Internet lacks comprehensive ingress filtering to
   discard such spoofed traffic before it can cause damage.  These
   attacks can affect BGP sessions between core Internet routers, and
   are thus of significant concern [<a href="#ref-3" title='"The Border Gateway Protocol relies on persistent TCP sessions without specifying authentication requirements"'>3</a>][12].  As a result, a number of
   proposed solutions have been developed, most of which are at the
   transport layer.

   Some of these solutions augment the transport protocol by improving
   its own security, e.g., TCP MD5 [<a href="#ref-6" title='"Protection of BGP Sessions via the TCP MD5 Signature Option"'>6</a>].  Others modify the core TCP
   processing rules to make it harder for off-path attackers to inject
   meaningful packets either during the initial handshake (e.g., SYN
   cookies) or after a connection is established (e.g., TCPsecure)
   [<a href="#ref-15" title="&quot;Improving TCP's Robustness to Blind In-Window Attacks&quot;">15</a>][23].  Some of these approaches are new to TCP, but have already




<span class="grey">Touch, et al.                Informational                      [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


   been incorporated into other transport protocols (e.g., Stream
   Control Transmission Protocol (SCTP) [<a href="#ref-22" title='"Stream Control Transmission Protocol"'>22</a>]) or intermediate (so-called
   layer 3.5) protocols (e.g., Host Identity Protocol (HIP) [<a href="#ref-14" title='"Host Identity Protocol"'>14</a>]).

   TCP MD5 and its potential successor, TCP Auth [<a href="#ref-25" title='"The TCP Authentication Option"'>25</a>], are based on
   authentication; TCP-specific modifications that lack authentication
   are, at best, temporary patches to the ubiquitous vulnerability to
   spoofing attacks.  The obvious solution to spoofing is end-to-end
   validation of the traffic, either at the transport layer or the
   network layer.  The IPsec suite already provides authentication of a
   network-layer packet and its contents, but the costs of an
   authentication infrastructure required for the use of IPsec can be
   prohibitive.  Similarly, TCP MD5 requires pre-shared keys, which can
   likewise be prohibitive.  TCP Auth is currently under development,
   and may include a BTNS-like mode.

   Protecting systems from spoofed packets is ultimately an issue of
   authentication, ensuring that a receiver's interpretation of the
   source of a packet is accurate.  Authentication validates the
   identity of the source of the packet.  The current IPsec suite
   assumes that identity is validated either by a trusted third party --
   e.g., a certification authority -- or by a pre-deployed shared
   secret.  Such an identity is unique and invariant across associations
   (pair-wise security configuration), and can be used to reject packets
   that are not authentic.

   With regard to BGP in particular, it has been understood that the use
   of appropriate network- or transport-layer authentication is the
   preferred protection from TCP spoofing attacks [<a href="#ref-3" title='"The Border Gateway Protocol relies on persistent TCP sessions without specifying authentication requirements"'>3</a>].  Authentication
   at one router by itself does not provide overall BGP security because
   that router remains at the mercy of all routers it peers with, since
   it depends on them to also support authentication [<a href="#ref-25" title='"The TCP Authentication Option"'>25</a>].  The reality
   is that few Internet routers are configured to support authentication
   at all, and the result is the use of unsecured TCP for sending BGP
   packets.  BTNS allows an individual router to relax the need for
   authentication in order to enable the use of protected sessions that
   are not authenticated.  The latter is "better than nothing" in cases
   where "nothing" is the alternative.  Although the routing community
   has chosen solutions other than BTNS for protection of BGP's TCP
   connections (e.g., TCP MD5), the discussion of BGP remains in this
   document because it was a motivation for the development of BTNS.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.2.%20%20Authentication%20at%20Multiple%20Layers"></a><a class="selflink" href="#section-2.2.2" name="section-2.2.2">2.2.2</a>.  Authentication at Multiple Layers</span>

   Some existing protocols used on the Internet provide authentication
   above the network and transport layers but rely on the IPsec suite
   for packet-by-packet cryptographic integrity and confidentiality
   services.  Examples of such protocols include iSCSI [<a href="#ref-19" title='"Internet Small Computer Systems Interface (iSCSI)"'>19</a>] and the



<span class="grey">Touch, et al.                Informational                     [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


   remote direct data placement (RDDP) protocols [<a href="#ref-16" title='"A Remote Direct Memory Access Protocol Specification"'>16</a>][20].  With the
   current IPsec suite, the result is two authentication operations: one
   at the IPsec layer using an identity for IKE and an associated secret
   or key, and another by the higher-layer protocol using a higher-layer
   identity and secret or key.  With the current IPsec specifications,
   this redundant authentication is necessary because the identity and
   key formats differ between IPsec and the higher-layer protocol and/or
   because there is no standard interface to pass authentication results
   from IPsec up to the higher layer.  End-node software is then
   responsible for ensuring that the identities used for these two
   authentication operations are consistent in some fashion; determining
   whether these identities are consistent is an authorization policy
   decision.

   Failure of the end-node software to enforce appropriate consistency
   across authentication operations at different layers creates man-in-
   the-middle attack opportunities at the network layer.  An attacker
   may exploit this omission by interposing as a proxy; rather than
   impersonate the attacked endpoints, the attacker need only
   authenticate with identities that are acceptable to the attacked
   endpoints.  The resulting success enables the attacker to obtain full
   access to the higher-layer traffic by passing the higher-layer
   authentication operation through without modification.  In the
   complete absence of consistency checks on the identities used at
   different layers, higher-layer traffic may be accessible to any
   entity that can successfully authenticate at the network layer.

   In principle, a single authentication operation should suffice to
   protect the higher-layer traffic, removing the need for:

   o  the second authentication operation,

   o  configuration and management of the identities and secrets or keys
      for the second authentication (even if the identities and secrets
      or keys are the same, the two authentication operations may employ
      different repositories for identities, secrets, and keys), and

   o  determining in some fashion that the two authenticated identities
      are consistent.  As noted above, there are significant potential
      MITM vulnerabilities if this is not done.

   IPsec may not always be present for these higher-layer protocols, and
   even when present, may not always be used.  Hence, if there is a
   choice, the higher-layer protocol authentication is preferable as it
   will always be available for use, independent of IPsec.






<span class="grey">Touch, et al.                Informational                     [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


   A "better-than-nothing" security approach to IPsec can address this
   problem by setting up an IPsec security association without an
   authentication, and then using an extended form of the higher-layer
   authentication to establish that the higher-layer protocol session is
   protected by a single IPsec SA.  This counters man-in-the-middle
   (MITM) attacks on BTNS IPsec session establishment by terminating the
   higher-layer session via an authentication failure when such an
   attack occurs.  The result is that a single authentication operation
   validates not only the higher-layer peer's identity but also
   continuity of the security association to that peer.  This higher-
   layer check for a single IPsec SA is referred in this document as
   "channel binding", thus the name Channel-Bound BTNS (CBB) [<a href="#ref-27" title='"On the Use of Channel Bindings to Secure Channels"'>27</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20BTNS%20Overview%20and%20Threat%20Models"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  BTNS Overview and Threat Models</span>

   This section provides an overview of BTNS and the IPsec security
   services that are offered when BTNS is used.  It also describes the
   multiple operating modes of BTNS.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20BTNS%20Overview"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  BTNS Overview</span>

   This is an overview of what is needed in IPsec to enable BTNS.  The
   detailed specifications of the extensions are addressed by the
   relevant protocol specifications.

   The main update to IPsec is adding extensions to security policy that
   permit secure communications with unauthenticated peers.  These
   extensions are necessary for both IPsec and IKE.  For IPsec, the
   first extension applies to the PAD, which specifies the forms of
   authentication allowed for each IKE peer.  In addition to existing
   forms of authentication, such as X.509 certificates and pre-shared
   secrets, the extension adds an unauthenticated category in which the
   public key presented by the peer serves as its identity (and is
   authenticated by the peer demonstrating knowledge of the
   corresponding private key) [<a href="#ref-28" title='"Better-Than-Nothing Security: An Unauthenticated Mode of IPsec"'>28</a>].  The second extension is that a flag
   is added to each SPD entry to indicate whether BTNS lack of
   authentication is acceptable for that SPD entry.

   The changes to enable channel binding between IPsec and higher-layer
   protocols or applications are more complex than the policy extensions
   above.  They require specifying APIs and interactions between IPsec
   and higher-layer protocols.  This document assumes such provisions
   will be developed, but does not address their details.








<span class="grey">Touch, et al.                Informational                     [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20BTNS%20and%20IPsec%20Security%20Services"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  BTNS and IPsec Security Services</span>

   The changes and extensions of BTNS primarily affect IPsec policy as
   described above.  Other parts of IPsec and IKE specifications are
   unchanged.  BTNS does not require a separate IPsec implementation, as
   BTNS can be integrated with any IPsec implementation in a system.
   The scope of BTNS functionality applies only to the SAs matching the
   policies that explicitly specify or enable BTNS modes in the PAD and
   for which the corresponding SPD entries allow BTNS.  All other non-
   BTNS policy entries, including entries in the SPD and the PAD, and
   non-BTNS SAs are not affected by BTNS.

   In principle, the result of removing the requirement that all SAs be
   authenticated is that BTNS can establish secure IPsec connections in
   a fashion similar to fully authenticated IKE, but BTNS cannot verify
   or authenticate the peer identities of these SAs.  The following is a
   list of security services offered by the IPsec protocol suite with
   notes that address the differences created by the addition of BTNS.

   1. Access Control

      BTNS extends IPsec's access control services to allow
      unauthenticated connections.  These extensions are integrated with
      the IPsec PAD and SPD in a fashion that does not affect the access
      controls associated with entries that do not use the BTNS
      extensions.  For Channel-Bound BTNS, the authentication that
      applies to the SA is performed at a higher layer in a fashion that
      links higher-layer access control policy to IPsec's network-layer
      access control mechanisms.

   2. Data Origin Authentication

      Stand-Alone BTNS weakens data origin authentication to continuity
      of association, namely the assurance that traffic on an SA
      continues to originate from the same unauthenticated source.

      Channel-Bound BTNS relies on higher-layer authentication to
      provide data origin authentication of protected network traffic.

   3. Connectionless Integrity

   4. Anti-Replay Protection

   5. Confidentiality







<span class="grey">Touch, et al.                Informational                     [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


   6. (Limited) Traffic Flow Confidentiality

      For the security services offered by IPsec that are listed in
      items 3 through 6, it is possible to establish secure IPsec
      connections with rogue peers via BTNS because authentication is
      not required.  On the other hand, once a secure connection is
      established, the communication is protected by these security
      services in the same fashion as a connection established by
      conventional IPsec means.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20BTNS%20and%20IPsec%20Modes"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  BTNS and IPsec Modes</span>

   The previous sections have described two ways of using BTNS:  Stand-
   Alone (SAB) and Channel-Bound (CBB).  Both of these can also be used
   either symmetrically, where neither party authenticates at the
   network layer, or asymmetrically, where only one party does not
   authenticate at the network layer.  There are a number of cases to
   consider, based on combinations of the endpoint security capabilities
   of SAB, CBB, and conventional IKE authentication of an identity
   (denoted as AUTH below).  The following tables show all of the
   combinations based on the capabilities of the two security endpoints:

           | AUTH  |  SAB  |                | CB-AUTH |   CBB   |
      -----+-------+-------+         -------+---------+---------+
           |       |       |                |         |         |
      AUTH | AUTH  | A-SAB |         CB-AUTH| CB-AUTH |  A-CBB  |
           |       |       |                |         |         |
      -----+-------+-------+         -------+---------+---------+
           |       |       |                |         |         |
      SAB  | A-SAB | S-SAB |           CBB  |  A-CBB  |  S-CBB  |
           |       |       |                |         |         |
      -----+-------+-------+         -------+---------+---------+

        No Channel Binding               With Channel Binding

   There are six operating modes that result from the combinations.  The
   first three modes consist of network-layer authentication schemes
   used without channel binding to higher-layer authentication:

   1. AUTH: both parties provide and authenticate conventional, IKE-
      supported identities.

   2. Symmetric SAB (S-SAB): neither party authenticates with a
      conventional, IKE-supported identity.

   3. Asymmetric SAB (A-SAB): one party does not authenticate with a
      conventional, IKE-supported identity, but the other side does
      authenticate with such an identity.



<span class="grey">Touch, et al.                Informational                     [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


   The following three modes combine the network-layer behaviors with
   channel binding to higher-layer authentication credentials:

   4. CB-AUTH: channel binding is used and both parties authenticate
      with conventional, IKE-supported identities.

   5. Symmetric CBB (S-CBB): neither party authenticates with a
      conventional, IKE-supported identity, but channel binding is used
      to bind the SAs to higher-layer authentication operations.

   6. Asymmetric CBB (A-CBB): asymmetric SAB (A-SAB) used with channel
      binding; at the network layer, one party does not authenticate
      with a conventional, IKE-supported identity, but the other party
      does authenticate with such an identity.  Channel binding is used
      to bind the SA to higher-layer authentication operations.

   There are three security mechanisms involved in BTNS with channel
   binding:

   1. BTNS and IPsec at the network layer,

   2. higher-layer authentication, and

   3. the connection latching plus channel binding mechanisms that bind
      the higher-layer authentication credentials with the secure IPsec
      channel.

   Authentication at both the network and higher layers can be either
   bidirectional (both peers are authenticated) or unidirectional (one
   of the two peers does not authenticate).  In contrast, when channel
   binding is used, it must be applied at both ends of the communication
   to prevent MITM attacks.  Existing channel binding mechanisms and
   APIs for this purpose (e.g., as defined in GSS-API [<a href="#ref-10" title='"Generic Security Service Application Program Interface Version 2, Update 1"'>10</a>]) mandate the
   exchange and verification of the channel binding values at both ends
   to ensure that correct, non-spoofed channel characteristics are bound
   to the higher-layer authentication.

   Note: When any Stand-Alone BTNS (SAB) or Channel-Bound BTNS (CBB) is
   used without being qualified as symmetric or asymmetric, the
   symmetric mode is the intended default meaning.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Applicability%20Statement"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Applicability Statement</span>

   BTNS is intended for services open to the public but for which
   protected associations are desired, and for services that can be
   authenticated at higher layers in the protocol stack.  BTNS can also
   provide some level of protection for private services when the
   alternative BTNS is no protection at all.



<span class="grey">Touch, et al.                Informational                     [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


   BTNS uses the IPsec protocol suite, and therefore should not be used
   in situations where IPsec and specifically IKE are unsuitable.  IPsec
   and IKE incur additional computation overhead, and IKE further
   requires message exchanges that incur round-trip latency to setup
   security associations.  These may be undesirable in environments with
   limited computational resources and/or high communication latencies.

   This section provides an overview of the types of applications
   suitable for various modes of BTNS.  The next two sections describe
   the overall benefits and vulnerabilities, followed by the
   applicability analysis for each BTNS mode.  The applicability
   statement covers only the four BTNS-specific modes; the AUTH and
   CB-AUTH modes are out of scope for this discussion.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Benefits"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Benefits</span>

   BTNS protects security associations after they are established by
   reducing vulnerability to attacks from parties that are not
   participants in the association.  BTNS-based SAs protect network and
   transport layers without requiring network-layer authentication.
   BTNS can be deployed without pre-deployment of authentication
   material for IPsec or pre-shared information and can protect all
   transport layer protocols using a common mechanism.

   BTNS also helps protect systems from low-effort attacks on higher-
   layer sessions or connections that disrupt valuable services or
   resources.  BTNS raises the level of effort for many types of
   network- and transport-layer attacks.  Simple transport layer packet
   attacks are rejected because the malicious packet or packets are not
   part of an IPsec SA.  The attacker is instead forced to establish an
   unauthenticated IPsec SA and a transport connection for SAB,
   requiring the attacker to perform as much work as a host engaging in
   the higher-layer communication.  SAB thus raises the effort for a
   DDoS (Distributed Denial of Service) attack to that of emulating a
   flash crowd.  For open services, there may be no way to distinguish
   such a DDoS attack from an actual flash crowd.

   BTNS also allows individual security associations to be established
   for protection of higher-layer traffic without requiring pre-deployed
   authentication credentials.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Vulnerabilities"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Vulnerabilities</span>

   BTNS removes the requirement that every IPsec SA be authenticated.
   Hosts connecting to BTNS hosts are vulnerable to communicating with a
   masquerader throughout the association for SAB, or until higher
   layers provide additional authentication for CBB.  As a result,
   authentication data (e.g., passwords) sent to a masquerading peer



<span class="grey">Touch, et al.                Informational                     [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


   could be disclosed to an attacker.  This is a deliberate design
   tradeoff; in BTNS, network- and transport-layer access is no longer
   controlled by the identity presented by the other host, opening hosts
   to potential masquerading and flash crowd attacks.  Conversely, BTNS
   can secure connections to hosts that are unable to authenticate at
   the network layer, so the network and transport layers are more
   protected than can be achieved via higher-layer authentication alone.

   Lacking network-layer authentication information, other means must be
   used to provide access control for local resources.  Traffic
   selectors for the BTNS SPD entries can be used to limit which
   interfaces, address ranges, and port ranges can access BTNS-enabled
   services.  Rate limiting can further restrict resource usage.  For
   SAB, these protections need to be considered throughout associations,
   whereas for CBB they need be present only until higher-layer
   protocols provide the missing authentication.  CBB also relies on the
   effectiveness of the binding of higher-layer authentication to the
   BTNS network association.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Stand-Alone%20BTNS%20%28SAB%29"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Stand-Alone BTNS (SAB)</span>

   SAB is intended for applications that are unable to use IKE-
   compatible authentication credentials and do not employ higher-layer
   authentication or other security protection.  SAB is also suitable
   when the identities of either party are not important or are
   deliberately omitted, but IPsec security services are desired (see
   <a href="#section-3.2">Section 3.2</a>).  SAB is particularly applicable to long-lived
   connections or sessions for which assurance that the entity at the
   other end of the connection has not changed may be a good enough
   substitute for the lack of authentication.  This section discusses
   symmetric and asymmetric SAB.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.3.1.%20%20Symmetric%20SAB"></a><a class="selflink" href="#section-4.3.1" name="section-4.3.1">4.3.1</a>.  Symmetric SAB</span>

   Symmetric SAB (S-SAB) is applicable when both parties lack network-
   layer authentication information and that authentication is not
   available from higher-layer protocols.  S-SAB can still provide some
   forms of protection for network and transport protocols, but does not
   provide authentication beyond continuity of association.  S-SAB is
   useful in situations where transfer of large files or use of other
   long-lived connections would benefit from not being interrupted by
   attacks on the transport connection (e.g., via a false TCP RST), but
   the particular endpoint identities are not important.

   Open services, such as web servers, and peer-to-peer networks could
   utilize S-SAB when their identities need not be authenticated but
   their communication would benefit from protection.  Such services
   might provide files that are either not validated or validated by



<span class="grey">Touch, et al.                Informational                     [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


   other means (e.g., published hashes).  These transmissions present a
   target for off-path attacks that could be mitigated by S-SAB.  S-SAB
   may also be useful for protecting voice-over-IP (VoIP) traffic
   between peers, such as direct calls between VoIP clients.

   S-SAB is also useful in protecting any transport protocol when the
   endpoints do not deploy authentication, for whatever reason.  This is
   the case for BGP TCP connections between core routers, where the
   protection afforded by S-SAB is better than no protection at all,
   even though BGP is not intended as an open service.

   S-SAB can also serve as an intermediate step towards S-CBB.  S-SAB is
   the effective result when an IPsec channel is used (via connection
   latching), but the higher-layer authentication is not bound to the
   IPsec SAs within the channel.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.3.2.%20%20Asymmetric%20SAB"></a><a class="selflink" href="#section-4.3.2" name="section-4.3.2">4.3.2</a>.  Asymmetric SAB</span>

   Asymmetric SAB (A-SAB) allows one party lacking network-layer
   authentication information to establish associations with another
   party that possesses authentication credentials for any applicable
   IKE authentication mechanism.

   Asymmetric SAB is useful for protecting transport connections for
   open services on the Internet, e.g., commercial web servers, etc.  In
   these cases, the server is typically authenticated by a widely known
   CA, as is done with TLS at the application layer, but the clients
   need not be authenticated [<a href="#ref-4" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>4</a>].  Although this may result in IPsec and
   TLS being used on the same connection, this duplication of security
   services at different layers is necessary when protection is required
   from the sorts of spoofing attacks described in <a href="#section-2">Section 2</a> (e.g., TLS
   cannot prevent a spoofed TCP RST, as the RST is processed by TCP
   rather than being passed to TLS).

   A-SAB can also secure transport for streaming media such as would be
   used by webcasts for remote education and entertainment.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.4.%20%20Channel-Bound%20BTNS%20%28CBB%29"></a><a class="selflink" href="#section-4.4" name="section-4.4">4.4</a>.  Channel-Bound BTNS (CBB)</span>

   CBB allows hosts without network-layer authentication information to
   cryptographically bind BTNS-based IPsec SAs to authentication at
   higher layers.  CBB is intended for applications that employ higher-
   layer authentication but that also benefit from additional network-
   layer security.  CBB provides network-layer security services without
   requiring authentication at the network layer.  This enables IPsec
   security services for applications that have IKE-incompatible
   authentication credentials.  CBB allows IPsec to be used with




<span class="grey">Touch, et al.                Informational                     [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


   authentication mechanisms not supported by IKE and frees higher-layer
   applications and protocols from duplicating security services already
   available in IPsec.

   Symmetric CBB integrates channel binding with S-SAB, as does
   asymmetric CBB with A-SAB.  In both cases, the target applications
   have similar characteristics at the network layer to their non-
   channel-binding counterparts.  The only significant difference is the
   binding of authentication credentials at a higher layer to the
   resulting IPsec channels.

   Although the modes of CBB refer to the authentication at the network
   layer, higher-layer authentication can also be either asymmetric
   (one-way) or symmetric (two-way).  Asymmetric CBB can be used to
   complement one-way authentication at a higher layer by providing one-
   way authentication of the opposite direction at the network layer.
   Consider an application with one-way, client-only authentication.
   The client can utilize A-CBB where the server must present IKE-
   authenticated credentials at the network layer.  This form of A-CBB
   achieves mutual authentication, albeit at separate layers.  Many
   remote file system protocols, such as iSCSI and NFS, fit into this
   category and can benefit from channel binding with IPsec for better
   network-layer protection, including prevention of MITM attacks.

   Mechanisms and interfaces for BTNS channel binding with IPsec are
   discussed in further detail in [<a href="#ref-26" title='"IPsec Channels: Connection Latching"'>26</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.5.%20%20Summary%20of%20Uses%2C%20Vulnerabilities%2C%20and%20Benefits"></a><a class="selflink" href="#section-4.5" name="section-4.5">4.5</a>.  Summary of Uses, Vulnerabilities, and Benefits</span>

   The following is a summary of the properties of each type of BTNS,
   based on the previous subsections:

                 SAB                          CBB
     --------------------------------------------------------------
     Uses     Open services                Same as SAB but with
              Peer-to-peer                 higher-layer auth.,
              Zero-config Infrastructure   e.g., iSCSI [<a href="#ref-19" title='"Internet Small Computer Systems Interface (iSCSI)"'>19</a>], NFSv4 [<a href="#ref-21" title='"Network File System (NFS) version 4 Protocol"'>21</a>]

     Vuln.    Masqueraders                 Masqueraders until bound
              Needs data rate limit        Needs data rate limit
              Load on IPsec                Load on IPsec
              Exposure to open access

     Benefit  Protects L3 &amp; L4             Protects L3 &amp; L4
              Avoids all auth. keys        Avoids L3 auth. keys
                                           Full auth. once bound





<span class="grey">Touch, et al.                Informational                     [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


   Most of the potential vulnerabilities in the above table have been
   discussed in previous sections of this document; some of the more
   general issues, such as the increased load on IPsec processing, are
   addressed in the Security Considerations section of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Security%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Security Considerations</span>

   This section describes the threat models for BTNS and discusses other
   security issues based on the threat models for different modes of
   BTNS.  Some of the issues were mentioned previously in the document
   but are listed again for completeness.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Threat%20Models%20and%20Evaluation"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Threat Models and Evaluation</span>

   BTNS is intended to protect sessions from a variety of threats,
   including on-path, man-in-the-middle attacks after key exchange, and
   off-path attacks.  It is intended to protect the contents of a
   session once established, but does not protect session establishment
   itself.  This protection has value because it forces the attacker to
   target connection establishment as opposed to waiting for a more
   convenient time; this is of particular value for long-lived sessions.

   BTNS is not intended to protect the key exchange itself, so this
   presents an opportunity for a man-in-the-middle attack or a well-
   timed attack from other sources.  Furthermore, Stand-Alone BTNS is
   not intended to protect the endpoint from nodes masquerading as
   legitimate clients of a higher-layer protocol or service.  Channel-
   Bound BTNS can protect from such masquerading, though at a later
   point after the security association is established, as a masquerade
   attack causes a client authentication failure at a higher layer.

   BTNS is also not intended to protect from DoS (Denial of Service)
   attacks that seek to overload a CPU performing authentication or
   other security computations, nor is BTNS intended to provide
   protection from configuration mistakes.  These latter two threat
   assumptions are also the case for IPsec.

   The following sections discuss the implications of the threat models
   in more details.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Interaction%20with%20Other%20Security%20Services"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Interaction with Other Security Services</span>

   As with any aspect of network security, the use of BTNS must not
   interfere with other security services.  Within IPsec, the scope of
   BTNS is limited to the SPD and PAD entries that explicitly specify
   BTNS and to the resulting SAD entries.  It is incumbent on system
   administrators to deploy BTNS only where safe, preferably as an
   alternative to the use of "bypass" SPD entries that exempt specified



<span class="grey">Touch, et al.                Informational                     [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


   traffic from IPsec cryptographic protection.  In other words, BTNS
   should be used only as a substitute for no security, rather than as a
   substitute for stronger security.  When the higher-layer
   authentication required for CBB is not available, other methods, such
   as IP address filtering, can help reduce the vulnerability of SAB to
   exposure to anonymous access.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20MITM%20and%20Masquerader%20Attacks"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  MITM and Masquerader Attacks</span>

   Previous sections have described how CBB can counter MITM and
   masquerader attacks, even though BTNS does not protect key exchange
   and does not authenticate peer identities at the network layer.
   Nonetheless, there are some security issues regarding CBB that must
   be carefully evaluated before deploying BTNS.

   For regular IPsec/IKE, a man in the middle cannot subvert IKE
   authentication, and hence an attempt to attack an IPsec SA via use of
   two SAs concatenated by the attacker acting as a traffic-forwarding
   proxy will cause an IKE authentication failure.  On the other hand, a
   man-in-the-middle attack on IPsec with CBB is discovered later.  With
   CBB, the IKE protocol will succeed because it is unauthenticated, and
   the security associations will be set up.  The man in the middle will
   not be discovered until the higher-layer authentication fails.  There
   are two security concerns with this approach: possible exposure of
   sensitive authentication information to the attackers, and resource
   consumption before attacks are detected.

   The exposure of information depends on the higher-layer
   authentication protocols used in applications.  If the higher-layer
   authentication requires exchange of sensitive information (e.g.,
   passwords or password-derived materials) that are directly useful or
   can be attacked offline, an attacker can gain such information even
   though the attack can be detected.  Therefore, CBB must not be used
   with higher-layer protocols that may expose sensitive information
   during authentication exchange.  For example, Kerberos V AP exchanges
   would leak little other than the target's krb5 principal name, while
   Kerberos V AS exchanges using PA-ENC-TIMESTAMP pre-authentication
   would leak material that can then be attacked offline.  The latter
   should not be used with BTNS, even with Channel Binding.  Further,
   the ways in which BTNS is integrated with the higher-layer protocol
   must take into consideration vulnerabilities that could be introduced
   in the APIs between these two systems or in the information that they
   share.

   The resource consumption issue is addressed in the next section on
   DoS attacks.





<span class="grey">Touch, et al.                Informational                     [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20Denial%20of%20Service%20%28DoS%29%20Attacks%20and%20Resource%20Consumptions"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  Denial of Service (DoS) Attacks and Resource Consumptions</span>

   A consequence of BTNS deployment is that more traffic requires
   cryptographic operations; these operations increase the computation
   required in IPsec implementations that receive protected traffic
   and/or verify incoming traffic.  That additional computation raises
   vulnerability to overloading, which may be the result of legitimate
   flash crowds or a DoS or DDoS attack.  Although this may itself
   present a substantial impediment to deployment, it is an issue for
   all cryptographically protected communication systems.  This document
   does not address the impact BTNS has on such increases in required
   computation.

   The effects of the increased resource consumption are twofold.  The
   consumption raises the level of effort for attacks such as MITM, but
   also consumes more resources to detect such attacks and to reject
   spoofed traffic.  At the network layer, proper limits and access
   controls for resources should be set up for all BTNS SAs.  CBB SAs
   may be granted increased resource access after the higher-layer
   authentications succeed.  The same principles apply to the higher-
   layer protocols that use CBB SAs.  Special care must be taken to
   avoid excessive resource usage before authentication is established
   in these applications.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.5.%20%20Exposure%20to%20Anonymous%20Access"></a><a class="selflink" href="#section-5.5" name="section-5.5">5.5</a>.  Exposure to Anonymous Access</span>

   The use of SAB by a service implies that the service is being offered
   for open access, since network-layer authentication is not performed.
   SAB should not be used with services that are not intended to be
   openly available.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.6.%20%20ICMP%20Attacks"></a><a class="selflink" href="#section-5.6" name="section-5.6">5.6</a>.  ICMP Attacks</span>

   This document does not consider ICMP attacks because the use of BTNS
   does not change the existing IPsec guidelines on ICMP traffic
   handling [<a href="#ref-8" title='"Security Architecture for the Internet Protocol"'>8</a>].  BTNS focuses on the authentication part of
   establishing security associations.  BTNS does not alter the IPsec
   traffic processing model and protection boundary.  As a result, the
   entire IPsec packet processing guidelines, including ICMP processing,
   remain applicable when BTNS is added to IPsec.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.7.%20%20Leap%20of%20Faith"></a><a class="selflink" href="#section-5.7" name="section-5.7">5.7</a>.  Leap of Faith</span>

   BTNS allows systems to accept and establish security associations
   with peers without authenticating their identities.  This can enable
   functionality similar to "Leap of Faith" authentication utilized in
   other security protocols and applications such as the Secure Shell
   Protocol (SSH) [<a href="#ref-29" title='"The Secure Shell (SSH) Protocol Architecture"'>29</a>].



<span class="grey">Touch, et al.                Informational                     [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


   SSH implementations are allowed to accept unknown peer credentials
   (host public keys) without authentication, and these unauthenticated
   credentials may be cached in local databases for future
   authentication of the same peers.  Similar to BTNS, such measures are
   allowed due to the lack of "widely deployed key infrastructure" [<a href="#ref-29" title='"The Secure Shell (SSH) Protocol Architecture"'>29</a>]
   and to improve ease of use and end-user acceptance.

   There are subtle differences between SSH and BTNS regarding Leap of
   Faith, as shown in the following table:

                                     |   SSH   |  BTNS   |
      -------------------------------+---------+---------+
       Accept unauthenticated        | Allowed | Allowed |
       credentials                   |         |         |
      -------------------------------+---------+---------+
       Options/Warnings to reject    |   Yes   |   No    |
       unauthenticated credentials   |         |         |
      -------------------------------+---------+---------+
       Cache unauthenticated         |Required | Allowed |
       credential for future refs    |         |         |
      -------------------------------+---------+---------+

   SSH requires proper warnings and options in applications to reject
   unauthenticated credentials, while BTNS accepts such credentials
   automatically when they match the corresponding policy entries.  Once
   SSH accepts a credential for the first time, that credential should
   be cached and can be reused automatically without further warnings.
   BTNS credentials can be cached for future use, but there is no
   security advantage to doing so, as a new unauthenticated credential
   that is allowed by the policy entries will be automatically accepted.

   In addition, BTNS does not require IPsec to reuse credentials in a
   manner similar to SSH.  When IPsec does reuse unauthenticated
   credentials, there may be implementation advantages to caching them.

   SSH-style credential caching for reuse with SAB could be addressed by
   future extension(s) to BTNS; such extension(s) would need to provide
   warnings about unauthenticated credentials and a mechanism for user
   acceptance or rejection of them in order to establish a level of
   authentication assurance comparable to SSH's "Leap of Faith".  Such
   extension(s) would also need to deal with issues caused by the
   absence of identities in BTNS.  At best, a cached BTNS credential
   reauthenticates the network-layer source of traffic when the
   credential is reused -- in contrast, SSH credential reuse
   reauthenticates an identity.






<span class="grey">Touch, et al.                Informational                     [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


   Network-layer reauthentication for SAB is further complicated by:

   o  the ability of NATs to cause multiple independent network-layer
      sources of traffic to appear to be one source (potentially
      requiring acceptance and caching of multiple BTNS credentials),

   o  the ability of multihoming to cause one network-layer source of
      traffic to appear to be multiple sources (potentially triggering
      unexpected warnings and requiring re-acceptance of the same BTNS
      credential), and

   o  interactions with both mobility and address ownership changes
      (potentially requiring controlled BTNS credential reassignment
      and/or invalidation).

   These issues are left to be addressed by possible future work on the
   addition of "Leap of Faith" functionality to BTNS.

   In contrast, for CBB, credential caching and verification are usually
   done at the higher-layer protocols or applications.  Caching
   credentials for CBB at the BTNS level is not as important because the
   channel binding will bind whatever credentials are presented (new or
   cached) to the higher-layer protocol identity.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.8.%20%20Connection%20Hijacking%20through%20Rekeying"></a><a class="selflink" href="#section-5.8" name="section-5.8">5.8</a>.  Connection Hijacking through Rekeying</span>

   Each IPsec SA has a limited lifetime (defined as a time and/or byte
   count) and must be rekeyed or terminated when the lifetime expires.
   Rekeying an SA provides a small window of opportunity where an on-
   path attacker can step in and hijack the new SA created by rekeying
   by spoofing the victim during rekeying.  BTNS, and particularly SAB,
   simplify this attack by removing the need for the attacker to
   authenticate as the victim or via the same non-BTNS PAD entry that
   was used by the victim for the original SA.  CBB, on the other hand,
   can detect such attacks by detecting the changes in the secure
   channel properties.

   This vulnerability is caused by the lack of inter-session binding or
   latching of IKE SAs with the corresponding credentials of the two
   peers.  Connection latching, together with channel binding, enables
   such binding but requires higher-layer protocols or applications to
   verify consistency of identities and authentication across the two
   SAs.








<span class="grey">Touch, et al.                Informational                     [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.9.%20%20Configuration%20Errors"></a><a class="selflink" href="#section-5.9" name="section-5.9">5.9</a>.  Configuration Errors</span>

   BTNS does not address errors of configuration that could result in
   increased vulnerability; such vulnerability is already possible using
   "bypass" SPD entries.  SPD entries that allow BTNS must be explicitly
   flagged, and hence can be kept separate from SPD entries that do not
   allow BTNS, just as "bypass" SPD entries are separate from entries
   that create SAs with more conventional, stronger security.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Related%20Efforts"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Related Efforts</span>

   There have been a number of related efforts in the IETF and elsewhere
   to reduce the configuration effort of deploying the Internet security
   suite.

   The IETF PKI4IPsec effort focused on providing an automatic
   infrastructure for the configuration of Internet security services,
   e.g., to assist in deploying signed certificates and CA information
   [<a href="#ref-9" title='"The Internet IP Security PKI Profile of IKEv1/ISAKMP, IKEv2, and PKIX"'>9</a>].  The IETF KINK effort focused on adapting Kerberos [<a href="#ref-13" title='"The Kerberos Network Authentication Service (V5)"'>13</a>] for IKE,
   enabling IKE to utilize the Kerberos key distribution infrastructure
   rather than requiring certificates or shared private keys [<a href="#ref-18" title='"Kerberized Internet Negotiation of Keys (KINK)"'>18</a>].  KINK
   takes advantage of an existing architecture for automatic key
   management in Kerberos.  Opportunistic Encryption (OE) is a system
   for automatic discovery of hosts willing to do a BTNS-like
   encryption, with authentication being exchanged by leveraging
   existing use of the DNS [<a href="#ref-17" title='"Opportunistic Encryption using the Internet Key Exchange (IKE)"'>17</a>].  BTNS differs from all three in that
   BTNS is intended to avoid the need for such infrastructure
   altogether, rather than to automate it.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Acknowledgments"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Acknowledgments</span>

   This document was inspired by discussions on the IETF TCPM WG about
   the spoofed RST attacks on BGP routers and various solutions, as well
   as discussions in the NFSv4 and IPS WGs about how to better integrate
   with IPsec.  The concept of BTNS was the result of these discussions
   as well as discussions with USC/ISI's T. Faber, A. Falk, and B. Tung,
   and discussions on the IETF SAAG (Security Area open meeting) mailing
   list and IPsec mailing list.  The authors would like to thank the
   members of those WGs and lists, as well as the IETF BTNS BOFs and WG
   and its associated ANONsec mailing list
   (<a href="http://www.postel.org/anonsec">http://www.postel.org/anonsec</a>) for their feedback -- in particular,
   Steve Kent, Sam Hartman, Nicolas Williams, and Pekka Savola.

   This document was prepared using 2-Word-v2.0.template.dot.







<span class="grey">Touch, et al.                Informational                     [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Informative%20References"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Informative References</span>

   [<a id="ref-1" name="ref-1">1</a>]   Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H.
         Levkowetz, Ed., "Extensible Authentication Protocol (EAP)", <a href="rfc3748.html">RFC</a>
         <a href="rfc3748.html">3748</a>, June 2004.

   [<a id="ref-2" name="ref-2">2</a>]   Aboba, B., Tseng, J., Walker, J., Rangan, V., and F.
         Travostino, "Securing Block Storage Protocols over IP", <a href="rfc3723.html">RFC</a>
         <a href="rfc3723.html">3723</a>, April 2004.

   [<a id="ref-3" name="ref-3">3</a>]   CERT Vulnerability Note VU#415294, "The Border Gateway Protocol
         relies on persistent TCP sessions without specifying
         authentication requirements", 4/20/2004.

   [<a id="ref-4" name="ref-4">4</a>]   Dierks, T. and E. Rescorla, "The Transport Layer Security (TLS)
         Protocol Version 1.2", <a href="rfc5246.html">RFC 5246</a>, August 2008.

   [<a id="ref-5" name="ref-5">5</a>]   Harkins, D. and D. Carrel, "The Internet Key Exchange (IKE)",
         <a href="rfc2409.html">RFC 2409</a>, November 1998.

   [<a id="ref-6" name="ref-6">6</a>]   Heffernan, A., "Protection of BGP Sessions via the TCP MD5
         Signature Option", <a href="rfc2385.html">RFC 2385</a>, August 1998.

   [<a id="ref-7" name="ref-7">7</a>]   Kaufman, C., Ed., "Internet Key Exchange (IKEv2) Protocol", <a href="rfc4306.html">RFC</a>
         <a href="rfc4306.html">4306</a>, December 2005.

   [<a id="ref-8" name="ref-8">8</a>]   Kent, S. and K. Seo, "Security Architecture for the Internet
         Protocol", <a href="rfc4301.html">RFC 4301</a>, December 2005.

   [<a id="ref-9" name="ref-9">9</a>]   Korver, B., "The Internet IP Security PKI Profile of
         IKEv1/ISAKMP, IKEv2, and PKIX", <a href="rfc4945.html">RFC 4945</a>, August 2007.

   [<a id="ref-10" name="ref-10">10</a>]  Linn, J., "Generic Security Service Application Program
         Interface Version 2, Update 1", <a href="rfc2743.html">RFC 2743</a>, January 2000.

   [<a id="ref-11" name="ref-11">11</a>]  Melnikov, A., Ed., and K. Zeilenga, Ed., "Simple Authentication
         and Security Layer (SASL)", <a href="rfc4422.html">RFC 4422</a>, June 2006.

   [<a id="ref-12" name="ref-12">12</a>]  Murphy, S., "BGP Security Vulnerabilities Analysis", <a href="rfc4272.html">RFC 4272</a>,
         January 2006.

   [<a id="ref-13" name="ref-13">13</a>]  Neuman, C., Yu, T., Hartman, S., and K. Raeburn, "The Kerberos
         Network Authentication Service (V5)", <a href="rfc4120.html">RFC 4120</a>, July 2005.

   [<a id="ref-14" name="ref-14">14</a>]  Moskowitz, R., Nikander, P., Jokela, P., Ed., and T. Henderson,
         "Host Identity Protocol", <a href="rfc5201.html">RFC 5201</a>, April 2008.





<span class="grey">Touch, et al.                Informational                     [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


   [<a id="ref-15" name="ref-15">15</a>]  Ramaiah, A., R Stewart, M. Dalal, "Improving TCP's Robustness
         to Blind In-Window Attacks", Work in Progress, January 2008.

   [<a id="ref-16" name="ref-16">16</a>]  Recio, R., Metzler, B., Culley, P., Hilland, J., and D. Garcia,
         "A Remote Direct Memory Access Protocol Specification", <a href="rfc5040.html">RFC</a>
         <a href="rfc5040.html">5040</a>, October 2007.

   [<a id="ref-17" name="ref-17">17</a>]  Richardson, M. and D. Redelmeier, "Opportunistic Encryption
         using the Internet Key Exchange (IKE)", <a href="rfc4322.html">RFC 4322</a>, December
         2005.

   [<a id="ref-18" name="ref-18">18</a>]  Sakane, S., Kamada, K., Thomas, M., and J. Vilhuber,
         "Kerberized Internet Negotiation of Keys (KINK)", <a href="rfc4430.html">RFC 4430</a>,
         March 2006.

   [<a id="ref-19" name="ref-19">19</a>]  Satran, J., Meth, K., Sapuntzakis, C., Chadalapaka, M., and E.
         Zeidner, "Internet Small Computer Systems Interface (iSCSI)",
         <a href="rfc3720.html">RFC 3720</a>, April 2004.

   [<a id="ref-20" name="ref-20">20</a>]  Shah, H., Pinkerton, J., Recio, R., and P. Culley, "Direct Data
         Placement over Reliable Transports", <a href="rfc5041.html">RFC 5041</a>, October 2007.

   [<a id="ref-21" name="ref-21">21</a>]  Shepler, S., Callaghan, B., Robinson, D., Thurlow, R., Beame,
         C., Eisler, M., and D. Noveck, "Network File System (NFS)
         version 4 Protocol", <a href="rfc3530.html">RFC 3530</a>, April 2003.

   [<a id="ref-22" name="ref-22">22</a>]  Stewart, R., Ed., "Stream Control Transmission Protocol", <a href="rfc4960.html">RFC</a>
         <a href="rfc4960.html">4960</a>, September 2007.

   [<a id="ref-23" name="ref-23">23</a>]  TCP SYN-cookies, <a href="http://cr.yp.to/syncookies.html">http://cr.yp.to/syncookies.html</a>

   [<a id="ref-24" name="ref-24">24</a>]  Touch, J., "Defending TCP Against Spoofing Attacks", <a href="rfc4953.html">RFC 4953</a>,
         July 2007.

   [<a id="ref-25" name="ref-25">25</a>]  Touch, J., A. Mankin, R. Bonica, "The TCP Authentication
         Option", Work in Progress, November 2007.

   [<a id="ref-26" name="ref-26">26</a>]  Williams, N., <a href="https://www.google.com/search?sitesearch=tools.ietf.org%2Fhtml%2F&amp;q=inurl:draft-+%22IPsec+Channels%3A+Connection+Latching%22" style="text-decoration: none">"IPsec Channels: Connection Latching"</a>, Work in
         Progress, April 2008.

   [<a id="ref-27" name="ref-27">27</a>]  Williams, N., "On the Use of Channel Bindings to Secure
         Channels", <a href="rfc5056.html">RFC 5056</a>, November 2007.

   [<a id="ref-28" name="ref-28">28</a>]  Williams, N. and M. Richardson, "Better-Than-Nothing Security:
         An Unauthenticated Mode of IPsec", <a href="rfc5386.html">RFC 5386</a>, November 2008.

   [<a id="ref-29" name="ref-29">29</a>]  Ylonen, T. and C. Lonvick, Ed., "The Secure Shell (SSH)
         Protocol Architecture", <a href="rfc4251.html">RFC 4251</a>, January 2006.



<span class="grey">Touch, et al.                Informational                     [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc5387.html">RFC 5387</a>             BTNS Problem and Applicability        November 2008</span>


Authors' Addresses

   Joe Touch
   USC/ISI
   4676 Admiralty Way
   Marina del Rey, CA 90292-6695
   U.S.A.

   Phone: +1 (310) 448-9151
   EMail: touch@isi.edu


   David L. Black
   EMC Corporation
   176 South Street
   Hopkinton, MA 01748
   USA

   Phone: +1 (508) 293-7953
   EMail: black_david@emc.com


   Yu-Shun Wang
   Microsoft
   One Microsoft Way
   Redmond, WA 98052
   U.S.A.

   Phone: +1 (425) 722-6980
   EMail: yu-shun.wang@microsoft.com





















Touch, et al.                Informational                     [Page 28]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc5387 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:36 GMT --></html>