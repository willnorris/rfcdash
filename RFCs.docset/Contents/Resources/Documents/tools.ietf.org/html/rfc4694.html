<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc4694 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 28 Apr 2015 16:01:49 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.111" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:4694" name="DC.Identifier"/>
<meta content='This document defines five parameters in the "tel" Uniform Resource
Identifier (URI) to carry the number portability (NP)-related
information. Those parameters can be passed to the next-hop network
node after an NP database dip has been performed. [STANDARDS-TRACK]' name="DC.Description.Abstract"/>
<meta content="James Yu &lt;james.yu@neustar.biz&gt;" name="DC.Creator"/>
<meta content="October, 2006" name="DC.Date.Issued"/>
<meta content='Number Portability Parameters for the "tel" URI' name="DC.Title"/>

    <link href="http://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="http://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 4694 - Number Portability Parameters for the "tel" URI</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc4694.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc4694" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-ietf-iptel-tel-np" title="draft-ietf-iptel-tel-np">draft-ietf-iptel-...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4694" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc4694" title="Side-by-side diff">Diff2</a>]                 </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                              J. Yu
Request for Comments: 4694                                       NeuStar
Category: Standards Track                                   October 2006


            <span class="h1">Number Portability Parameters for the "tel" URI</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2006).

Abstract

   This document defines five parameters in the "tel" Uniform Resource
   Identifier (URI) to carry the number portability (NP)-related
   information.  Those parameters can be passed to the next-hop network
   node after an NP database dip has been performed.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
   <a href="#section-2">2</a>. Conventions .....................................................<a href="#page-3">3</a>
   <a href="#section-3">3</a>. Abbreviations ...................................................<a href="#page-3">3</a>
   <a href="#section-4">4</a>. Formal Syntax ...................................................<a href="#page-3">3</a>
   <a href="#section-5">5</a>. Normative Rules .................................................<a href="#page-5">5</a>
      <a href="#section-5.1">5.1</a>. Handling "tel" URI with NP Parameter or Parameters .........<a href="#page-6">6</a>
      <a href="#section-5.2">5.2</a>. Adding NP Parameter or Parameters to the "tel" URI .........<a href="#page-8">8</a>
           5.2.1. Retrieving NP-related Information for a
                  Geographical Telephone Number .......................<a href="#page-8">8</a>
           5.2.2. Retrieving NP-related Information for a
                  Freephone Number ....................................<a href="#page-9">9</a>
           <a href="#section-5.2.3">5.2.3</a>. Adding Location Information about the Caller .......<a href="#page-10">10</a>
           5.2.4. Adding NP Parameter or Parameters Due to
                  Protocol Conversion ................................<a href="#page-10">10</a>
   <a href="#section-6">6</a>. Examples .......................................................<a href="#page-11">11</a>
   <a href="#section-7">7</a>. Security Considerations ........................................<a href="#page-13">13</a>
   <a href="#section-8">8</a>. Acknowledgements ...............................................<a href="#page-13">13</a>
   <a href="#section-9">9</a>. IANA Considerations ............................................<a href="#page-13">13</a>





<span class="grey">Yu                          Standards Track                     [Page 1]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc4694.html">RFC 4694</a>            NP Parameters for the "tel" URI         October 2006</span>


   <a href="#section-10">10</a>. References ....................................................<a href="#page-14">14</a>
      <a href="#section-10.1">10.1</a>. Normative References .....................................<a href="#page-14">14</a>
      <a href="#section-10.2">10.2</a>. Informative References ...................................<a href="#page-14">14</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   Number portability (NP) [<a href="rfc3482.html" title='"Number Portability in the Global Switched Telephone Network (GSTN): An Overview"'>RFC3482</a>] allows telephony subscribers to
   keep their telephone numbers when they change service provider
   (service provider portability), move to a new location (location
   portability), or change the subscribed services (service
   portability).  The telephone numbers can be the geographical
   telephone numbers, mobile telephone numbers, freephone numbers, or
   other types of non-geographical telephone numbers.  Some mobile
   telephone numbers are like geographical telephone numbers (e.g.,
   those in North America) and others are of non-geographical nature but
   their routing is similar to the routing of geographical telephone
   numbers so they are not specifically mentioned in this document.  The
   freephone numbers are also known as toll-free phone numbers.  The
   called party who is assigned the freephone number pays the call
   charge when the caller dials the freephone number.

   NP impacts call signaling and routing.  One impact is the need to
   carry the NP-related information in the "tel" Uniform Resource
   Identifier (URI) [<a href="rfc3966.html" title='"The tel URI for Telephone Numbers"'>RFC3966</a>] for protocols such as the Session
   Initiation Protocol (SIP) [<a href="rfc3261.html" title='"SIP: Session Initiation Protocol"'>RFC3261</a>] and H.323 [<a href="#ref-H323" title='"Packet-Based Multimedia Communications Systems,"'>H323</a>] after the NP
   database dip has been performed.  Another impact is for a Voice over
   IP (VoIP) server to use the NP-related information in a received
   "tel" URI to determine routing.

   A routing number is associated with a geographical or mobile
   telephone number that has been ported out from a donor carrier to
   another carrier.  A donor carrier is the initial carrier where a
   geographical telephone number was allocated before ever being ported.
   A "non-ported" geographical or mobile telephone number does not have
   any routing number associated with it because the first N digits of
   the geographical or mobile telephone number can be used for routing.
   A routing number can also be used to indicate the switch or network
   node that originates a call or service similar to the Jurisdiction
   Information Parameter in Signaling System Number 7 (SS7) Integrated
   Services Digital Network User Part (ISUP).  The "rn" parameter
   carries the routing number information.  The "rn-context" parameter
   describes how the "rn" parameter value should be interpreted when the
   value is not a "global-rn" as is discussed in <a href="#section-4">Section 4</a>.

   The NP database dip indicator is used to inform the downstream
   servers or switches during call setup that there is no need to
   perform the NP database dip for a geographical telephone number
   again.  The "npdi" parameter carries such an indicator.



<span class="grey">Yu                          Standards Track                     [Page 2]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc4694.html">RFC 4694</a>            NP Parameters for the "tel" URI         October 2006</span>


   A Carrier Identification Code (CIC) identifies the current freephone
   service provider for a freephone number.  This parameter can also be
   used to carry the pre-subscribed or dialed long-distance carrier
   information; however, that is outside the scope of this document.
   The "cic" parameter carries the CIC information.  The "cic-context"
   parameter describes how the "cic" parameter value should be
   interpreted when the value is not a "global-cic" as is discussed in
   <a href="#section-4">Section 4</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Conventions"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Conventions</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Abbreviations"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Abbreviations</span>

   ABNF   Augmented Backus-Naur Form
   ANSI   American National Standards Institute
   CIC    Carrier Identification Code (also cic)
   CIP    Carrier Identification Parameter
   FCI    Forward Call Indicator
   GAP    Generic Address Parameter
   GSTN   Global Switched Telephone Network
   HTML   HyperText Markup Language
   IC     Identification Code
   ISUP   Integrated Services Digital Network User Part
   JIP    Jurisdiction Information Parameter
   NP     Number Portability
   NPDB   Number Portability Database
   npdi   NP Database Dip Indicator
   rn     Routing Number
   PNTI   Ported Number Translation Indicator
   SIP    Session Initiation Protocol
   SS7    Signaling System Number 7
   URI    Uniform Resource Identifier
   VoIP   Voice over IP

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Formal%20Syntax"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Formal Syntax</span>

   The following syntax specification uses the Augmented Backus-Naur
   Form (ABNF) as described in <a href="rfc4234.html">RFC 4234</a> [<a href="rfc4234.html" title='"Augmented BNF for Syntax Specifications: ABNF"'>RFC4234</a>] and defines the five
   parameters, rn, npdi, cic, rn-context and cic-context, by extending
   the "parameter" production rule of the "tel" URI defined in
   [<a href="rfc3966.html" title='"The tel URI for Telephone Numbers"'>RFC3966</a>].






<span class="grey">Yu                          Standards Track                     [Page 3]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc4694.html">RFC 4694</a>            NP Parameters for the "tel" URI         October 2006</span>


   parameter               =/ rn / cic / npdi
   rn                      = ";rn=" (global-rn / local-rn)
   npdi                    = ";npdi"
   cic                     = ";cic=" (global-cic / local-cic)
   global-rn               = global-hex-digits
   local-rn                = 1*hex-phonedigit rn-context
   rn-context              = ";rn-context=" rn-descriptor
   rn-descriptor           = domainname / global-hex-digits
   global-hex-digits       = "+" 1*3(DIGIT) *hex-phonedigit
   hex-phonedigit          = HEXDIG / visual-separator
   visual-separator        = "-" / "." / "(" / ")"
   domainname              = *( domainlabel "." ) toplabel ["."]
   domainlabel             = alphanum
                             / alphanum *( alphanum / "-" ) alphanum
   toplabel                = ALPHA / ALPHA *( alphanum / "-" ) alphanum
   alphanum                = ALPHA / DIGIT
   global-cic              = global-hex-digits
   local-cic               = 1*hex-phonedigit cic-context
   cic-context             = ";cic-context=" rn-descriptor

   The "rn", "npdi", or "cic" parameter each can appear in the "tel" URI
   at most once.

   The first "hex-phonedigit" value in "local-rn" or "local-cic" MUST be
   a hex-decimal digit.

   For a "global-rn", the routing number information after "+" MUST
   begin with a valid E.164 [<a href="#ref-E164" title='"The international public telecommunication numbering plan,"'>E164</a>] country code.  Hexadecimal digit is
   allowed after the country code in the "global-rn".

   For a "local-rn", the routing number in the "rn" parameter MUST be
   interpreted according to the "rn-context".  For example, if a
   national routing number is in the "rn" parameter, the "rn-context"
   MUST contain a valid E.164 country code after "+" if it is in the
   "global-hex-digits" format.  Hexadecimal digit is allowed in the
   "local-rn".

   For a "global-cic", the CIC information after "+" MUST begin with a
   valid E.164 country code.

   For a "local-cic", the CIC value in the "cic" parameter MUST be
   interpreted according to the "cic-context".  For example, if the
   national CIC value is in the "cic" parameter, the "cic-context" MUST
   contain a valid E.164 country code after "+" if it is in the
   "global-hex-digits" format.

   The inclusion of the visual separator in the "rn" or "cic" is
   optional.



<span class="grey">Yu                          Standards Track                     [Page 4]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc4694.html">RFC 4694</a>            NP Parameters for the "tel" URI         October 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Normative%20Rules"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Normative Rules</span>

   There are two distinct uses for the "tel" URI.  In one use, the "tel"
   URI appears in a piece of static content.  For example, it might
   appear in a HyperText Markup Language (HTML) page or a presence
   document.  In another use, the "tel" URI appears in call signaling
   protocols, such as SIP and H.323, where it is used to guide routing
   of the call setup messages.  The "tel" URI extensions defined in this
   document are targeted at call signaling protocols.  When a "tel" URI
   is placed in static content, the parameters defined here SHOULD NOT
   be present, and any entity receiving them SHOULD remove them prior to
   using the tel URI.

   Within the context of signaling protocols, these parameters are meant
   for usage between call signaling entities, called network nodes,
   among which there is a trust relationship.  Since parameters inserted
   by one network node can impact the routing of a request at a
   downstream node, processing of these parameters depends on trusting
   that the upstream element properly followed the rules defined here.
   A call signaling protocol can verify that an upstream element is part
   of its circle of trust through hop-by-hop integrity mechanisms.  See
   <a href="#section-7">Section 7</a>, Security Considerations, for more information.  If a
   network node receives a call signaling message from an element it
   does not trust, it SHOULD ignore the parameters.

   This section discusses how a network node handles a received "tel"
   URI that contains one or more of the parameters defined in this
   document or has accessed an NP database for a freephone number or
   geographical telephone number and needs to add some of the parameters
   defined in this document to a "tel" URI.

   In countries where there is no freephone number portability or
   geographical telephone number portability, the call routing can be
   based on the leading digits of the freephone number or geographical
   telephone number.  This document does not describe those scenarios.

   Please note that two accesses to the freephone databases are normally
   done for routing a call to a freephone number.  The first one is done
   by the originating network that queries a freephone database for the
   CIC information so that the call can be routed to the serving
   freephone service provider of the called freephone number.  When the
   call reaches the serving freephone provider, the second database
   access is performed to map the freephone number to a geographical
   telephone number and/or internal routing information.  This document
   does not address the case where internal routing information is
   returned.





<span class="grey">Yu                          Standards Track                     [Page 5]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc4694.html">RFC 4694</a>            NP Parameters for the "tel" URI         October 2006</span>


   The first freephone database contains the CIC information for all the
   active freephone numbers, whereas the second one usually contains
   mapping information only for those freephone numbers served by a
   freephone service provider.  Because the originating carrier may
   provide freephone service, its freephone database would contain the
   CIC information for all the active freephone numbers plus the mapping
   information for those freephone numbers it serves.  This document
   refers to the two database accesses as "the first freephone database
   access" and "the second freephone database access".

   When handling the "rn" and "cic" parameters and the phone numbers in
   the "tel" URI for purposes such as database access and routing, the
   visual separators in them are removed before using the information in
   them.

   When a network node handles a "tel" URI that contains invalid "rn" or
   "cic" information, it may release the call or drop the invalid
   parameter and access the appropriate NP database or freephone
   database to see whether it can retrieve a valid routing number for a
   geographical telephone number or valid CIC for the freephone number.

   When a "tel" URI is received from an untrusted source, a network node
   MAY redo the NPDB query.

   SIP [<a href="rfc3261.html" title='"SIP: Session Initiation Protocol"'>RFC3261</a>] has mechanisms in place to detect routing loops due to
   URI re-writing, and the new parameters added here work within these
   established contexts.  The "npdi" parameter in the URI that indicates
   a NPDB query has already been done can also prevent routing loop.
   Other protocols considering using these "tel" URI parameters SHOULD
   ensure that they have mechanisms in place to detect loops when re-
   writing the "tel" URI.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Handling%20%22tel%22%20URI%20with%20NP%20Parameter%20or%20Parameters"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Handling "tel" URI with NP Parameter or Parameters</span>

   If the "tel" URI contains the "npdi" parameter, the network node MUST
   NOT retrieve the NP-related information for geographical telephone
   numbers even if it is set to do so.

   If the "tel" URI contains the "cic" parameter whose CIC value is
   different from the one this network node is associated with, this
   network node MUST NOT retrieve the NP-related information for the
   geographical telephone number or perform the first freephone database
   access for the freephone number in the "tel" URI.

   For the "cic" and "rn" parameters and either a freephone number or
   geographical telephone number, the order of processing is to look for
   the "cic" parameter first for call routing.  If the CIC information
   is not useful or the "cic" parameter does not exist, then the next



<span class="grey">Yu                          Standards Track                     [Page 6]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc4694.html">RFC 4694</a>            NP Parameters for the "tel" URI         October 2006</span>


   step is to look for the "rn" parameter.  If the information in the
   "rn" parameter is not useful or the "rn" parameter does not exist,
   then the freephone number or geographical telephone number is used.

   If the network node does not know how to route based on the "cic" or
   "rn" parameter, the local policies MUST decide whether to stop the
   call processing or continue the call processing by ignoring the
   invalid/unknown information.

   When looking for the "cic" parameter and that parameter exists in the
   "tel" URI:

   - The network node MUST ignore the "cic" parameter if the CIC
     identifies a carrier or service provider associated with that node
     and look for the "rn" parameter for making the routing decision.
     It MUST remove the "cic" parameter when it routes the call to the
     next-hop network node that belongs to another carrier or service
     provider.

   - The network node MUST invoke special handling process if the "cic"
     parameter contains a code that requires such a treatment.  For
     example, a CIC value of "0110" in the response to a freephone DB
     query in North America indicates "local, translated geographical
     telephone number provided".  In this particular example, the "cic"
     parameter is ignored.  Please note that this particular CIC value
     of "+1-0110" normally will not appear in the call setup message.
     It is given as an example to show that such special CIC values may
     exist.  The exact code values and the handling of them are outside
     the scope of this document.

   - Otherwise, the network node MUST make the routing decision based on
     the CIC.  The network node MUST NOT remove the "cic" parameter
     unless it is handing over the call to the carrier or service
     provider identified by the CIC and the local policies require it to
     remove the "cic" parameter.  How the call is actually routed based
     on the CIC value in the "cic" parameter is outside the scope of
     this document.

   When looking for the "rn" parameter and that parameter exists in the
   "tel" URI:

   - If the routing number in the "rn" parameter points to this network
     node (e.g., the call has reached the intended network node), this
     network node MUST look for the freephone number or geographical
     telephone number for making the routing decision.  It MUST remove
     the "rn" parameter when setting up the call to the next-hop network
     node regardless if that next-hop network node is in the same or
     different network.



<span class="grey">Yu                          Standards Track                     [Page 7]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc4694.html">RFC 4694</a>            NP Parameters for the "tel" URI         October 2006</span>


   - If the routing number in the "rn" parameter points to a network
     this network node is in (e.g., in some countries the routing number
     gets the call to the serving carrier network where another NP
     database access is required to locate the serving switch), this
     network node MUST look for the freephone number or geographical
     telephone number for making the routing decision.  The network node
     MAY access the NP database for routing information if it is set to
     do so.  It MUST remove the "rn" parameter if the next-hop network
     node belongs to another carrier or service provider.

   - Otherwise, the network node MUST make the routing decision based on
     the routing number in the "rn" parameter.  How the call is actually
     routed based on the routing number in the "rn" parameter is outside
     the scope of this document.

   When the "cic" or "rn" parameter is not used for routing, the network
   node uses the freephone number or geographical telephone number for
   making routing decisions.  It may access the NP database if it is set
   to do so, or it may route the call to a designated network node that
   will access the NP database, or it may route the call based on the
   local routing table.  How the call is handled at this stage is
   outside the scope of this document.  See <a href="#section-5.2">Section 5.2</a> for rules in
   adding the parameter or parameters defined in this document to the
   "tel" URI if the network node is set to access the NP database.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Adding%20NP%20Parameter%20or%20Parameters%20to%20the%20%22tel%22%20URI"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Adding NP Parameter or Parameters to the "tel" URI</span>

   There are two cases in terms of NP database access.  One is for a
   geographical telephone number and the other is for a freephone
   number.  They are discussed in Sections <a href="#section-5.2.1">5.2.1</a> and <a href="#section-5.2.2">5.2.2</a> for a "tel"
   URI that is used for routing.

   <a href="#section-5.2.3">Section 5.2.3</a> discusses a special case where the "rn" parameter is
   added to a "tel" URI that is associated with the first network node
   that handles the call request from the caller.  <a href="#section-5.2.4">Section 5.2.4</a>
   discusses the addition of the parameter or parameters defined in this
   document to the "tel" URI due to protocol conversion.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.1.%20%20Retrieving%20NP-related%20Information%20for%20a%20Geographical%20Telephone"></a><a class="selflink" href="#section-5.2.1" name="section-5.2.1">5.2.1</a>.  Retrieving NP-related Information for a Geographical Telephone</span>
<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/Number"></a>        Number</span>

   When a network node accesses an NP database for a geographical
   telephone number:

   - If the network node retrieves a routing number, it MUST add the
     "rn" parameter to the "tel" URI to carry the routing number
     information in the "global-rn" or "local-rn" format.  It MUST also
     add the "npdi" parameter.



<span class="grey">Yu                          Standards Track                     [Page 8]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc4694.html">RFC 4694</a>            NP Parameters for the "tel" URI         October 2006</span>


   - If the network node does not retrieve a routing number (e.g., for a
     non-ported geographical telephone number), it MUST add the "npdi"
     parameter to the "tel" URI.

   The network node MUST follow the rules described in <a href="#section-5.1">Section 5.1</a> for
   using the information in the "tel" URI to make the routing decision.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.2.%20%20Retrieving%20NP-related%20Information%20for%20a%20Freephone%20Number"></a><a class="selflink" href="#section-5.2.2" name="section-5.2.2">5.2.2</a>.  Retrieving NP-related Information for a Freephone Number</span>

   When a network node performs the first or second freephone database
   access for a freephone number:

   - If the network node retrieves a CIC that identifies a carrier or
     service provider associated with that network node, or indicates
     that a geographic number is supplied (e.g., "+1-0110" means "local,
     translated geographical telephone number provided"), it would have
     retrieved a geographical telephone number.  The network node MUST
     NOT add the "cic" parameter and MUST replace the freephone number
     in the "tel" URI with the retrieved geographical telephone number
     in either the "global-number" or "local-number" format.

     Some freephone databases may not return the geographical telephone
     number but internal routing information in a proprietary format
     (e.g., switch ID and trunk group ID).  That case is outside the
     scope of this document.

   - If the network node retrieves a CIC that belongs to another
     freephone service provider, the network node MUST add the "cic"
     parameter to the "tel" URI that contains the CIC in the "global-
     cic" or "local-cic" format.

     The originating carrier may have business agreements with a
     freephone service provider to return the geographical telephone
     number in addition to the CIC.  When a geographical telephone
     number is returned, the network node MUST replace the freephone
     number in the "tel" URI with the returned geographical telephone
     number in either the "global-number" or "local-number" format.

   - If the network node retrieves a geographical telephone number
     (which is the typical case for the second freephone database
     access), the network node MUST replace the freephone number in the
     "tel" URI with the retrieved geographical telephone number in
     either the "global-number" or "local-number" format.

     When a geographical telephone number is returned in the response,
     it is possible that the NP-related information for that
     geographical telephone number could also be returned.  In that
     case, the network node MUST add the "npdi" parameter and MUST add



<span class="grey">Yu                          Standards Track                     [Page 9]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc4694.html">RFC 4694</a>            NP Parameters for the "tel" URI         October 2006</span>


     the "rn" parameter to contain the routing number in either the
     "global-rn" or "local-rn" format only when the routing number is
     available.

   The network node MUST follow the rules described in <a href="#section-5.1">Section 5.1</a> for
   using the information in the "tel" URI to make the routing decision.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.3.%20%20Adding%20Location%20Information%20about%20the%20Caller"></a><a class="selflink" href="#section-5.2.3" name="section-5.2.3">5.2.3</a>.  Adding Location Information about the Caller</span>

   In SS7 ISUP, the JIP identifies the switch that originates the call,
   and the information in it may be used by the serving carrier to
   determine the call charge to the caller or by the involved carriers
   to determine the settlement amount between them.

   A network node that is the first to handle the call request from the
   caller MAY include the "rn" parameter to the "tel" URI associated
   with the caller, if one exists.  For example, if the network node is
   a Global Switched Telephone Network (GSTN) gateway that receives an
   ISUP message that contains the JIP, the correct location information
   in the JIP can be placed in the "rn" parameter of the "tel" URI that
   is associated with the caller.

   Please note that the information in the "rn" parameter may not be
   authenticated; therefore, the use of the information by the recipient
   of the "tel" URI for anything related to charging is done at its own
   risk.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.4.%20%20Adding%20NP%20Parameter%20or%20Parameters%20Due%20to%20Protocol%20Conversion"></a><a class="selflink" href="#section-5.2.4" name="section-5.2.4">5.2.4</a>.  Adding NP Parameter or Parameters Due to Protocol Conversion</span>

   A GSTN gateway needs to convert between SS7 ISUP and the VoIP
   protocol such as SIP or H.323.  This type of network node MUST map
   between the corresponding ISUP parameters and the parameters defined
   in this document associated with the "tel" URI for routing and MAY
   map between the corresponding ISUP parameters and the parameters
   defined in this document that are in the "tel" URI associated with
   the caller.

   Since ISUP support for NP depends on the individual country, the
   following discussion applies to a situation when a network node is to
   map between the NP information in the American National Standards
   Institute (ANSI) ISUP and the NP-related parameters in the "tel" URI.

   For a ported geographical telephone number, the network node MUST
   convert the routing number in the ISUP Called Party Number parameter
   to a routing number in either the "global-rn" or "local-rn" format
   and carry it in the "rn" parameter for a "tel" URI that is used for
   routing.  The network node MUST convert the phone number that is
   marked as the "ported number" in the ISUP Generic Address Parameter



<span class="grey">Yu                          Standards Track                    [Page 10]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc4694.html">RFC 4694</a>            NP Parameters for the "tel" URI         October 2006</span>


   (GAP) to a phone number in either the "global-number" or "local-
   number" format [<a href="rfc3966.html" title='"The tel URI for Telephone Numbers"'>RFC3966</a>] and put it in the global-number-digits or
   local-number-digits (see [<a href="rfc3966.html" title='"The tel URI for Telephone Numbers"'>RFC3966</a>]) part of the "tel" URI that is
   used for routing.

   For a non-ported geographical telephone number, the network node MUST
   convert the phone number in the ISUP Called Party Number parameter to
   a phone number in either the "global-number" or "local-number" format
   and put it in the global-number-digits or local-number-digits (see
   [<a href="rfc3966.html" title='"The tel URI for Telephone Numbers"'>RFC3966</a>]) part of the "tel" URI that is used for routing.  The "rn"
   parameter MUST NOT appear in the "tel" URI unless the local policies
   require the network node to include it.  It is outside the scope of
   this document how to include the "rn" parameter if the local policies
   require the network node to do so.

   The network node MUST include the "npdi" parameter in the "tel" URI
   that is used for routing when the Ported Number Translation Indicator
   (PNTI) bit in the Forward Call Indicator (FCI) parameter is set to
   "1".

   The network node MUST include the "cic" parameter in either the
   "global-cic" or "local-cic" format in the "tel" URI that is used for
   routing when the ISUP Carrier Identification Parameter (CIP) is
   present.

   The network node MAY include the "rn" parameter in the "tel" URI
   associated with the caller information when the ISUP JIP is present.
   This may be subject to the network node's local policy and/or the
   signaling protocol that carries the "tel" URI.

   Mapping NP-related parameters in a "tel" URI to the NP-related
   information in the ISUP message depends on the national ISUP
   implementation and is outside the scope of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Examples"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Examples</span>

   A. A "tel" URI, tel:+1-800-123-4567, contains a freephone number
      "+1-800-123-4567".  Assume that this freephone number is served by
      a freephone service provider with a CIC "+1-6789".  After
      retrieving the NP-related information, the "tel" URI would be set
      to

         tel:+1-800-123-4567;cic=+1-6789








<span class="grey">Yu                          Standards Track                    [Page 11]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc4694.html">RFC 4694</a>            NP Parameters for the "tel" URI         October 2006</span>


   B. A "tel" URI, tel:+1-800-123-4567;cic=+1-6789, is handled by a
      network node in the serving freephone service provider's network.
      Assume that the freephone number is mapped to a geographical
      telephone number "+1-202-533-1234".  After retrieving the NP-
      related information, the "tel" URI would be set to

         tel:+1-202-533-1234

   C. A "tel" URI, tel:+1-202-533-1234, contains a geographical
      telephone number "+1-202-533-1234".  Assume that this geographical
      telephone number is ported and is associated with a routing number
      "1-202-544-0000".  After retrieving the NP-related information,
      the "tel" URI would be set to

         tel:+1-202-533-1234;npdi;rn=+1-202-544-0000

   D. A "tel" URI, tel:+1-202-533-6789, contains a geographical
      telephone number "+1-202-533-6789".  Assume that this geographical
      telephone number is not ported.  After accessing the NP database,
      the "tel" URI would be set to

         tel:+1-202-533-6789;npdi

   E. A "tel" URI, tel:+1-202-533-1234;npdi;rn=+1-202-000-0000, contains
      an invalid routing number (e.g., no routing information on "+1-
      202-000-0000"); the network node may drop the "rn" parameter and
      access the NP database again.

   F. A "tel" URI, tel:+1-800-123-456, contains a freephone number
      "+1-800-123-456" that is one digit short.  When accessing the
      freephone database, there will not be any "cic" information for
      this freephone number.  The call would be released.

   G. A "tel" URI, tel:+1-800-123-4567;cic=+1-56789, is handled by a
      network node in an originating or a transit network.  The "cic"
      information is invalid.  The network node may drop the "cic"
      parameter and access the freephone database again.  If the same
      wrong CIC information is received, the network node would release
      the call because it does not know how to route the call with an
      invalid CIC.  If valid information is received, the network node
      will use the received CIC in the "cic" and route the call based on
      the "cic".









<span class="grey">Yu                          Standards Track                    [Page 12]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc4694.html">RFC 4694</a>            NP Parameters for the "tel" URI         October 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Security%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Security Considerations</span>

   In addition to those security implications discussed in the revised
   "tel" URI [<a href="rfc3966.html" title='"The tel URI for Telephone Numbers"'>RFC3966</a>], there are new security implications associated
   with the parameters defined in this document.

   If the value of the "rn" or "cic" in the "tel" URI is changed
   illegally when the signaling message carrying the "tel" URI is en
   route to the destination entity, the signaling message or call may be
   routed to the wrong network or network node causing the call setup to
   be rejected.

   If the "npdi" is illegally inserted into the "tel" URI when the
   signaling message carrying the "tel" URI is en route to the
   destination entity, the call may be routed to the wrong network or
   network node causing the call setup to be rejected.  It is less a
   problem if the "npdi" is illegally removed.  An additional NPDB query
   may be performed to retrieve the routing number information and have
   the "npdi" included again.

   If the "rn" in the "tel" URI that is associated with the caller is
   illegally changed or inserted, the call charge based on that "rn"
   would be incorrect.

   Because of these considerations, these "tel" URI extensions are only
   applicable within a set of network nodes among which there is mutual
   trust.  If a node receives a call signaling request from an upstream
   node that it does not trust, it SHOULD remove these parameters.  This
   will generally cause it to redo any DB queries.

   To verify that an upstream neighbor is trusted, and to prevent man-
   in-the-middle attacks whereby an attacker inserts or modifies these
   parameters, call signaling protocols carrying these parameters SHOULD
   provide hop-by-hop message integrity. In the case of SIP, this is
   accomplished with the Session Initiation Protocol Secure (SIPS) URI
   mechanism.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Acknowledgements"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Acknowledgements</span>

   The author would like to thank Penn Pfautz, Jon Peterson, Jonathan
   Rosenberg, Henning Schulzrinne, Antti Vaha-Sipila, Flemming
   Andreasen, and Mike Hammer for their discussions and comments.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  IANA Considerations</span>

   This document defines five parameters for the "tel" URI.  Further
   information on a registry for those parameters is covered in
   [<a href="#ref-TELREG" title='"The Internet Assigned Numbers Authority (IANA) tel Uniform Resource Identifier (URI) Parameter Registry"'>TELREG</a>].  This document requires no IANA actions.



<span class="grey">Yu                          Standards Track                    [Page 13]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc4694.html">RFC 4694</a>            NP Parameters for the "tel" URI         October 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20References"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Normative%20References"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Normative References</span>

   [<a id="ref-E164" name="ref-E164">E164</a>]    ITU-T Recommendation E.164, "The international public
             telecommunication numbering plan," May 1997.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>] Bradner, S., "Key words for use in RFCs to Indicate
             Requirement Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC3966" name="ref-RFC3966">RFC3966</a>] Schulzrinne, H., "The tel URI for Telephone Numbers", <a href="rfc3966.html">RFC</a>
             <a href="rfc3966.html">3966</a>, December 2004.

   [<a id="ref-RFC4234" name="ref-RFC4234">RFC4234</a>] Crocker, D. and P. Overell, "Augmented BNF for Syntax
             Specifications: ABNF", <a href="rfc4234.html">RFC 4234</a>, October 2005.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.2.%20%20Informative%20References"></a><a class="selflink" href="#section-10.2" name="section-10.2">10.2</a>.  Informative References</span>

   [<a id="ref-H323" name="ref-H323">H323</a>]    ITU-T Recommendation H.323, "Packet-Based Multimedia
             Communications Systems," November 2000.

   [<a id="ref-RFC3261" name="ref-RFC3261">RFC3261</a>] Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,
             A., Peterson, J., Sparks, R., Handley, M., and E. Schooler,
             "SIP: Session Initiation Protocol", <a href="rfc3261.html">RFC 3261</a>, June 2002.

   [<a id="ref-RFC3482" name="ref-RFC3482">RFC3482</a>] Foster, M., McGarry, T., and J. Yu, "Number Portability in
             the Global Switched Telephone Network (GSTN): An Overview",
             <a href="rfc3482.html">RFC 3482</a>, February 2003.

   [<a id="ref-TELREG" name="ref-TELREG">TELREG</a>]  Jennings, C. and V. Gurbani, "The Internet Assigned Numbers
             Authority (IANA) tel Uniform Resource Identifier (URI)
             Parameter Registry", Work in Progress, May 2006.

Author's Address

   James Yu
   NeuStar, Inc.
   46000 Center Oak Plaza
   Sterling, VA 20166
   U.S.A.

   Phone: +1-571-434-5572
   EMail: james.yu@neustar.biz








<span class="grey">Yu                          Standards Track                    [Page 14]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc4694.html">RFC 4694</a>            NP Parameters for the "tel" URI         October 2006</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="http://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="http://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).







Yu                          Standards Track                    [Page 15]

</pre><br/>
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.111, available from
<a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>



</body><!-- Mirrored from tools.ietf.org/html/rfc4694 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 28 Apr 2015 16:01:49 GMT --></html>