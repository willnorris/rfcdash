<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from tools.ietf.org/html/rfc7315 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:30:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.129c" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Relation.Replaces" content="rfc3455" />
<meta name="DC.Identifier" content="urn:ietf:rfc:7315" />
<meta name="DC.Date.Issued" content="July, 2014" />
<meta name="DC.Creator" content="Drage, Keith" />
<meta name="DC.Creator" content="Jesske, Roland" />
<meta name="DC.Creator" content="Holmberg, Christer" />
<meta name="DC.Description.Abstract" content="This document describes a set of private header (P-header) Session
Initiation Protocol (SIP) fields used by the 3GPP, along with their
applicability, which is limited to particular environments. The
P-header fields are used for a variety of purposes within the networks
that the partners implement, including charging and information about
the networks a call traverses. This document obsoletes RFC 3455." />
<meta name="DC.Title" content="Private Header (P-Header) Extensions to the Session Initiation Protocol (SIP) for the 3GPP" />

    <link rel="icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 7315 - Private Header (P-Header) Extensions to the Session Initiation Protocol (SIP) for the 3GPP</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgorange"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7315.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7315" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-drage-sipping-rfc3455bis" title="draft-drage-sipping-rfc3455bis">draft-drage-sip...</a>] [<a href='https://datatracker.ietf.org/doc/rfc7315' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7315" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7315" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=7315">Errata</a>]</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">Updated by: <a href="rfc7913.html">7913</a>, <a href="rfc7976.html">7976</a>                                     INFORMATIONAL</span><br />
<span class="pre noprint docinfo">                                                            <span style='color: #C00;'>Errata Exist</span></span><br />
<pre>
Internet Engineering Task Force (IETF)                         R. Jesske
Request for Comments: 7315                              Deutsche Telekom
Obsoletes: <a href="rfc3455.html">3455</a>                                                 K. Drage
Category: Informational                                   Alcatel-Lucent
ISSN: 2070-1721                                              C. Holmberg
                                                                Ericsson
                                                               July 2014


                  <span class="h1">Private Header (P-Header) Extensions</span>
         <span class="h1">to the Session Initiation Protocol (SIP) for the 3GPP</span>

Abstract

   This document describes a set of private header (P-header) Session
   Initiation Protocol (SIP) fields used by the 3GPP, along with their
   applicability, which is limited to particular environments.  The
   P-header fields are used for a variety of purposes within the
   networks that the partners implement, including charging and
   information about the networks a call traverses.  This document
   obsoletes <a href="rfc3455.html">RFC 3455</a>.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">Section&nbsp;2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7315">http://www.rfc-editor.org/info/rfc7315</a>.














<span class="grey">Jesske, et al.                Informational                     [Page 1]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>. Overall Applicability ...........................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Conventions .....................................................<a href="#page-3">3</a>
   <a href="#section-3">3</a>. Overview ........................................................<a href="#page-3">3</a>
   <a href="#section-4">4</a>. SIP Private Header Fields .......................................<a href="#page-4">4</a>
      <a href="#section-4.1">4.1</a>. The P-Associated-URI Header Field ..........................<a href="#page-4">4</a>
           4.1.1. Applicability Statement for the
                  P-Associated-URI Header Field .......................<a href="#page-5">5</a>
           <a href="#section-4.1.2">4.1.2</a>. Usage of the P-Associated-URI Header Field ..........<a href="#page-5">5</a>
      <a href="#section-4.2">4.2</a>. The P-Called-Party-ID Header Field .........................<a href="#page-6">6</a>
           4.2.1. Applicability Statement for the
                  P-Called-Party-ID Header Field .....................<a href="#page-10">10</a>
           <a href="#section-4.2.2">4.2.2</a>. Usage of the P-Called-Party-ID Header Field ........<a href="#page-11">11</a>
      <a href="#section-4.3">4.3</a>. The P-Visited-Network-ID Header Field .....................<a href="#page-12">12</a>
           4.3.1. Applicability Statement for the
                  P-Visited-Network-ID Header Field ..................<a href="#page-12">12</a>
           <a href="#section-4.3.2">4.3.2</a>. Usage of the P-Visited-Network-ID Header Field .....<a href="#page-13">13</a>
      <a href="#section-4.4">4.4</a>. The P-Access-Network-Info Header Field ....................<a href="#page-17">17</a>
           4.4.1. Applicability Statement for the
                  P-Access-Network-Info Header Field .................<a href="#page-18">18</a>
           <a href="#section-4.4.2">4.4.2</a>. Usage of the P-Access-Network-Info Header ..........<a href="#page-18">18</a>
      <a href="#section-4.5">4.5</a>. The P-Charging-Function-Addresses Header Field ............<a href="#page-19">19</a>
           4.5.1. Applicability Statement for the
                  P-Charging-Function-Addresses Header Field .........<a href="#page-20">20</a>
           4.5.2. Usage of the P-Charging-Function-Addresses
                  Header Field .......................................<a href="#page-21">21</a>
      <a href="#section-4.6">4.6</a>. The P-Charging-Vector Header Field ........................<a href="#page-23">23</a>
           4.6.1. Applicability Statement for the
                  P-Charging-Vector Header Field .....................<a href="#page-25">25</a>
           <a href="#section-4.6.2">4.6.2</a>. Usage of the P-Charging-Vector Header Field ........<a href="#page-25">25</a>
           <a href="#section-4.6.3">4.6.3</a>. Usage of the transit-ioi ...........................<a href="#page-27">27</a>
           <a href="#section-4.6.4">4.6.4</a>. Usage of the related-icid ..........................<a href="#page-28">28</a>



<span class="grey">Jesske, et al.                Informational                     [Page 2]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   <a href="#section-5">5</a>. Formal Syntax ..................................................<a href="#page-28">28</a>
      <a href="#section-5.1">5.1</a>. P-Associated-URI Header Syntax ............................<a href="#page-29">29</a>
      <a href="#section-5.2">5.2</a>. P-Called-Party-ID Header Syntax ...........................<a href="#page-29">29</a>
      <a href="#section-5.3">5.3</a>. P-Visited-Network-ID Header Syntax ........................<a href="#page-29">29</a>
      <a href="#section-5.4">5.4</a>. P-Access-Network-Info Header Syntax .......................<a href="#page-29">29</a>
      <a href="#section-5.5">5.5</a>. P-Charging-Function-Addresses Header Syntax ...............<a href="#page-31">31</a>
      <a href="#section-5.6">5.6</a>. P-Charging-Vector Header Syntax ...........................<a href="#page-32">32</a>
      <a href="#section-5.7">5.7</a>. New Headers ...............................................<a href="#page-33">33</a>
   <a href="#section-6">6</a>. Security Considerations ........................................<a href="#page-33">33</a>
      <a href="#section-6.1">6.1</a>. P-Associated-URI Header Field .............................<a href="#page-33">33</a>
      <a href="#section-6.2">6.2</a>. P-Called-Party-ID Header Field ............................<a href="#page-34">34</a>
      <a href="#section-6.3">6.3</a>. P-Visited-Network-ID Header Field .........................<a href="#page-34">34</a>
      <a href="#section-6.4">6.4</a>. P-Access-Network-Info Header Field ........................<a href="#page-35">35</a>
      <a href="#section-6.5">6.5</a>. P-Charging-Function-Addresses Header Field ................<a href="#page-36">36</a>
      <a href="#section-6.6">6.6</a>. P-Charging-Vector Header Field ............................<a href="#page-36">36</a>
   <a href="#section-7">7</a>. IANA Considerations ............................................<a href="#page-37">37</a>
   <a href="#section-8">8</a>. Contributors and Acknowledgements ..............................<a href="#page-38">38</a>
   <a href="#section-9">9</a>. References .....................................................<a href="#page-39">39</a>
      <a href="#section-9.1">9.1</a>. Normative References ......................................<a href="#page-39">39</a>
      <a href="#section-9.2">9.2</a>. Informative References ....................................<a href="#page-39">39</a>
   <a href="#appendix-A">Appendix A</a>. Changes from <a href="rfc3455.html">RFC 3455</a> .................................<a href="#page-41">41</a>

<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Overall Applicability</span>

   The SIP extensions specified in this document make certain
   assumptions regarding network topology, linkage between SIP and lower
   layers, and the availability of transitive trust.  These assumptions
   apply only to private networks and are not appropriate for use in an
   Internet environment.  The mechanisms specified here were designed to
   satisfy the requirements specified in the 3GPP Release 5 requirements
   on SIP [<a href="rfc4083.html" title="&quot;Input 3rd-Generation Partnership Project (3GPP) Release 5 Requirements on the Session Initiation Protocol (SIP)&quot;">RFC4083</a>] for which either no general-purpose solution was
   planned (where insufficient operational experience was available to
   understand if a general solution would be needed) or for which a more
   general solution is not yet mature.  For more details about the
   assumptions made about these extensions, consult the Applicability
   subsection for each extension.

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Conventions</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Overview</span>

   The 3GPP uses SIP as the protocol to establish and tear down
   multimedia sessions in the context of its IP Multimedia Subsystem
   (IMS), as described in the 3GPP TS 23.228 [<a href="#ref-TS23.228" title="&quot;P Multimedia Subsystem (IMS); Stage 2&quot;">TS23.228</a>] and 3GPP TS



<span class="grey">Jesske, et al.                Informational                     [Page 3]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   24.229 [<a href="#ref-TS24.229" title="&quot;IP multimedia call control protocol based on Session Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3&quot;">TS24.229</a>].  <a href="rfc3455.html">RFC 3455</a> [<a href="rfc3455.html" title="&quot;Private Header (P-Header) Extensions to the Session Initiation Protocol (SIP) for the 3rd-Generation Partnership Project (3GPP)&quot;">RFC3455</a>] defines SIP private header
   extensions (referred to as P-headers) that are required by the 3GPP
   specification.  Note that the requirements for these extensions are
   documented in <a href="rfc4083.html">RFC 4083</a> [<a href="rfc4083.html" title="&quot;Input 3rd-Generation Partnership Project (3GPP) Release 5 Requirements on the Session Initiation Protocol (SIP)&quot;">RFC4083</a>].  This document obsoletes <a href="rfc3455.html">RFC 3455</a>
   [<a href="rfc3455.html" title="&quot;Private Header (P-Header) Extensions to the Session Initiation Protocol (SIP) for the 3rd-Generation Partnership Project (3GPP)&quot;">RFC3455</a>].  This document updates existing P-header descriptions to
   address additional requirements that are needed for 3GPP Release 11.
   Each of the P-headers is described in the sections below.

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  SIP Private Header Fields</span>

<span class="h3"><a class="selflink" name="section-4.1" href="#section-4.1">4.1</a>.  The P-Associated-URI Header Field</span>

   This extension allows a registrar to return a set of associated URIs
   for a registered SIP address-of-record.  We define the P-Associated-
   URI header field, used in the 200 (OK) response to a REGISTER
   request.  The P-Associated-URI header field contains the set of
   associated URIs that are associated with the registered address-of-
   record.

   In addition to the address-of-record, an associated URI is a URI that
   the service provider has allocated to a user.  A registrar contains
   information that allows zero or more URIs to be associated with an
   address-of-record.  Usually, all these URIs (the address-of-record
   and the associated URIs) are allocated for the usage of a particular
   user.  This extension to SIP allows the User Agent Client (UAC) to
   know, upon a successful authenticated registration, which other URIs,
   if any, the service provider has associated with an address-of-record
   URI.

   Note that, in standard SIP usage [<a href="rfc3261.html" title="&quot;SIP: Session Initiation Protocol&quot;">RFC3261</a>], the registrar does not
   register the associated URIs on behalf of the user.  Only the
   address-of-record that is present in the To header field of the
   REGISTER is registered and bound to the contact address.  The only
   information conveyed is that the registrar is aware of other URIs
   that can be used by the same user.

   A situation may be possible, however, in which an application server
   (or even the registrar itself) registers any of the associated URIs
   on behalf of the user by means of a third-party registration.
   However, this third-party registration is out of the scope of this
   document.  A UAC MUST NOT assume that the associated URIs are
   registered.

   If a UAC wants to check whether any of the associated URIs is
   registered, it can do so by mechanisms specified outside this
   document, e.g., the UA MAY send a REGISTER request with the To header
   field value set to any of the associated URIs and without a Contact
   header field.  The 200 (OK) response will include a Contact header



<span class="grey">Jesske, et al.                Informational                     [Page 4]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   field with the list of addresses-of-record that have been registered
   with contact addresses.  If the associated URI is not registered, the
   UA MAY register it prior to its utilization.

<span class="h4"><a class="selflink" name="section-4.1.1" href="#section-4.1.1">4.1.1</a>.  Applicability Statement for the P-Associated-URI Header Field</span>

   The P-Associated-URI header field is applicable in SIP networks where
   the SIP provider allows a set of identities that a user can claim (in
   header fields like the From header field) in requests that the UA
   generates.  Furthermore, it assumes that the provider knows the
   entire set of identities that a user can legitimately claim and that
   the user is willing to restrict its claimed identities to that set.
   This is in contrast to normal SIP usage, where the From header field
   is explicitly an end-user-specified field.

<span class="h4"><a class="selflink" name="section-4.1.2" href="#section-4.1.2">4.1.2</a>.  Usage of the P-Associated-URI Header Field</span>

   The registrar inserts the P-Associated-URI header field into the 200
   (OK) response to a REGISTER request.  The header field value is
   populated with a list of URIs that are associated to the address-of-
   record.

   If the registrar supports the P-Associated-URI header field extension
   and there is at least one associated URI, then the registrar MUST
   insert the P-Associated-URI header field in all the 200 (OK)
   responses to a REGISTER request.  The absence of a P-Associated-URI
   header field indicates that there are no associated URIs for the
   registered address-of-record.

<span class="h5"><a class="selflink" name="section-4.1.2.1" href="#section-4.1.2.1">4.1.2.1</a>.  Procedures at the UA</span>

   A UAC may receive a P-Associated-URI header field in the 200 (OK)
   response for a REGISTER request.  The presence of a header field in
   the 200 (OK) response for a REGISTER request implies that the
   extension is supported at the registrar.

   The header field value contains a list of one or more associated URIs
   to the address-of-record.  The UAC MAY use any of the associated URIs
   to populate the From header field value, or any other SIP header
   field value that provides information of the identity of the calling
   party, in a subsequent request.

   The UAC MAY check whether or not the associated URI is registered.
   This check can be done, e.g., by populating the To header field value
   in a REGISTER request sent to the registrar and without a Contact
   header field.  The 200 (OK) response will include a Contact header
   field with the list of address-of-record that have been registered




<span class="grey">Jesske, et al.                Informational                     [Page 5]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   with contact addresses.  As described in SIP [<a href="rfc3261.html" title="&quot;SIP: Session Initiation Protocol&quot;">RFC3261</a>], the 200 (OK)
   response may contain a Contact header field with zero or more values
   (zero meaning the address-of-record is not registered).

<span class="h5"><a class="selflink" name="section-4.1.2.2" href="#section-4.1.2.2">4.1.2.2</a>.  Procedures at the Registrar</span>

   A registrar that receives and authorizes a REGISTER request MAY
   associate zero or more URIs with the registered address-of-record.

   If the address-of-record under registration does not have any
   associated URIs, the P-Associated-URI header field SHALL NOT be
   included.

   Otherwise, a registrar that supports this specification MUST include
   a P-Associated-URI header field in the 200 (OK) response to a
   REGISTER request that contains a contact header.  The header field
   MUST be populated with a comma-separated list of URIs that are
   associated to the address-of-record under registration.

<span class="h5"><a class="selflink" name="section-4.1.2.3" href="#section-4.1.2.3">4.1.2.3</a>.  Procedures at the Proxy</span>

   This header is not intended to be used by proxies -- a proxy does not
   add, read, modify, or delete the header field; therefore, any proxy
   MUST relay this header field unchanged.

<span class="h3"><a class="selflink" name="section-4.2" href="#section-4.2">4.2</a>.  The P-Called-Party-ID Header Field</span>

   A proxy server inserts a P-Called-Party-ID header field, typically in
   an INVITE request, en route to its destination.  The header is
   populated with the Request-URI received by the proxy in the request.
   The User Agent Server (UAS) identifies to which address-of-record,
   out of several registered addresses-of-record, the invitation was
   sent (for example, the user may be simultaneously using one personal
   SIP URI and one business SIP URI to receive invitation to sessions).
   The UAS can use the information to render different distinctive
   audiovisual alerting tones, depending on the URI used to receive the
   invitation to the session.

   Users in the 3GPP IP Multimedia Subsystem (IMS) may get one or
   several SIP URIs (address-of-record) to identify the user.  For
   example, a user may get one business SIP URI and one personal SIP
   URI.  As an example of utilization, the user may make available the
   business SIP URI to coworkers and may make available the personal SIP
   URI to members of the family.







<span class="grey">Jesske, et al.                Informational                     [Page 6]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   At a certain point in time, both the business SIP URI and the
   personal SIP URI are registered in the SIP registrar, so both URIs
   can receive invitations to new sessions.  When the user receives an
   invitation to join a session, he/she should be aware of which of the
   registered SIP URIs this session was sent to.

   This requirement is stated in the 3GPP Release 5 requirements on SIP
   [<a href="rfc4083.html" title="&quot;Input 3rd-Generation Partnership Project (3GPP) Release 5 Requirements on the Session Initiation Protocol (SIP)&quot;">RFC4083</a>].

   The problem arises during the terminating side of a session
   establishment.  At that time, the SIP proxy that is serving a UA gets
   an INVITE request, and the SIP server retargets the SIP URI that is
   present in the Request-URI, and replaces that SIP URI with the SIP
   URI published by the user in the Contact header field of the REGISTER
   request at registration time.

   One can argue that the To header field conveys the semantics of the
   called user, and therefore, this extension to SIP is not needed.
   Although the To header field in SIP may convey the called party ID in
   most situations, there are two particular cases when the above
   assumption is not correct:

   1.  The session has been forwarded, redirected, etc., by previous SIP
       proxies, before arriving to the proxy that is serving the called
       user.

   2.  The UAC builds an INVITE request and the To header field is not
       the same as the Request-URI.

   The problem of using the To header field is that this field is
   populated by the UAC and not modified by proxies in the path.  If the
   UAC, for any reason, did not populate the To header field with the
   address-of-record of the destination user, then the destination user
   is not able to distinguish to which address-of-record the session was
   destined.

   Another possible solution to the problem is built upon the
   differentiation of the Contact header field value between different
   address-of-record at registration time.  The UA can differentiate
   each address-of-record it registers by assigning a different Contact
   header field value.  For example, when the UA registers the address-
   of-record sip:id1, the Contact header field value can be sip:id1@ua,
   while the registration of the address-of-record sip:id2 can be bound
   to the Contact header field value sip:id2@ua.

   The solution described above assumes that the UA explicitly registers
   each of its addresses-of-record, and therefore, it has full control
   over the contact address values assigned to each registration.



<span class="grey">Jesske, et al.                Informational                     [Page 7]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   However, if the UA does not have full control of its registered
   addresses-of-record, because of, e.g., a third-party registration,
   the solution does not work.  This may be the case of the 3GPP
   registration, where the UA may have previously indicated to the
   network, by means outside of SIP, that some other addresses-of-record
   may be automatically registered when the UA registers a particular
   address-of-record.  The requirement is covered in the 3GPP Release 5
   requirements on SIP [<a href="rfc4083.html" title="&quot;Input 3rd-Generation Partnership Project (3GPP) Release 5 Requirements on the Session Initiation Protocol (SIP)&quot;">RFC4083</a>].

   In the next paragraphs, we show an example of the problem, in the
   case in which there has been some sort of call forwarding in the
   session, so that the UAC is not aware of the intended destination URI
   in the current INVITE request.

   We assume that a UA is registering to its proxy (P1).

     Scenario                      UA --- P1

         F1 Register UA -&gt; P1
              REGISTER sip:example.com SIP/2.0
              Via: SIP/2.0/UDP 192.0.2.4:5060;branch=z9hG4bKnashds7
              To: sip:user1-business@example.com
              From: sip:user1-business@example.com;tag=456248
              Call-ID: 843817637684230998sdasdh09
              CSeq: 1826 REGISTER
              Contact: &lt;sip:user1@192.0.2.4&gt;

   The user also registers his personal URI to his/her registrar.

         F2 Register UA -&gt; P1
              REGISTER sip:example.com SIP/2.0
              Via: SIP/2.0/UDP 192.0.2.4:5060;branch=z9hG4bKnashdt8
              To: sip:user1-personal@example.com
              From: sip:user1-personal@example.com;tag=346249
              Call-ID: 2Q3817637684230998sdasdh10
              CSeq: 1827 REGISTER
              Contact: &lt;sip:user1@192.0.2.4&gt;

   Later, the proxy/registrar (P1) receives an INVITE request from
   another proxy (P2) destined to the user's business SIP address-of-
   record.  We assume that this INVITE request has undergone some sort
   of forwarding in the past, and as such, the To header field is not
   populated with the SIP URI of the user.  In this case, we assume that
   the session was initially addressed to
   sip:other-user@othernetwork.com.  The SIP server at othernetwork.com
   has forwarded this session to sip:user1-business@example.com.





<span class="grey">Jesske, et al.                Informational                     [Page 8]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


            Scenario                      UA --- P1 --- P2

         F3 Invite P2 -&gt; P1
              INVITE sip:user1-business@example.com SIP/2.0
              Via: SIP/2.0/UDP 192.0.2.20:5060;branch=z9hG4bK03djaoe1
              To: sip:other-user@othernetwork.com
              From: sip:another-user@anothernetwork.com;tag=938s0
              Call-ID: 843817637684230998sdasdh09
              CSeq: 101 INVITE

   The proxy P1 retargets the user and replaces the Request-URI with the
   SIP URI published during registration time in the Contact header
   field value.

         F4 Invite P1 -&gt; UA
              INVITE sip:user1@192.0.2.4 SIP/2.0
              Via: SIP/2.0/UDP 192.0.2.10:5060;branch=z9hG4bKg48sh128
              Via: SIP/2.0/UDP 192.0.2.20:5060;branch=z9hG4bK03djaoe1
              To: sip:other-user@othernetwork.com
              From: sip:another-user@anothernetwork.com;tag=938s0
              Call-ID: 843817637684230998sdasdh09
              CSeq: 101 INVITE

   When the UAS receives the INVITE request, it cannot determine whether
   it got the session invitation due to his registration of the business
   or the personal address-of-record.  Neither the UAS nor proxies /
   application servers can provide this user a service based on the
   destination address-of-record of the session.

   We solve this problem by allowing the proxy that is responsible for
   the home domain (as defined in SIP) of the user to insert a P-Called-
   Party-ID header field that identifies the address-of-record to which
   this session is destined.

   If this SIP extension is used, the proxy serving the called user will
   get the message flow F5, it will populate the P-Called-Party-ID
   header field in message flow F6 with the contents of the Request-URI
   in F4.  This is show in flows F5 and F6 below:













<span class="grey">Jesske, et al.                Informational                     [Page 9]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


         F5 Invite P2 -&gt; P1
              INVITE sip:user1-business@example.com SIP/2.0
              Via: SIP/2.0/UDP 192.0.2.20:5060;branch=z9hG4bK03djaoe1
              To: sip:other-user@othernetwork.com
              From: sip:another-user@anothernetwork.com;tag=938s0
              Call-ID: 843817637684230998sdasdh09
              CSeq: 101 INVITE

         F6 Invite P1 -&gt; UA
              INVITE sip:user1@192.0.2.4 SIP/2.0
              Via: SIP/2.0/UDP 192.0.2.10:5060;branch=z9hG4bKg48sh128
              Via: SIP/2.0/UDP 192.0.2.20:5060;branch=z9hG4bK03djaoe1
              To: sip:other-user@othernetwork.com
              From: sip:another-user@anothernetwork.com;tag=938s0
              Call-ID: 843817637684230998sdasdh09
              P-Called-Party-ID: &lt;sip:user1-business@example.com&gt;
              CSeq: 101 INVITE

   When the UA receives the INVITE request F6, it can determine the
   intended address-of-record of the session and apply whatever service
   is needed for that address-of-record.

<span class="h4"><a class="selflink" name="section-4.2.1" href="#section-4.2.1">4.2.1</a>.  Applicability Statement for the P-Called-Party-ID Header Field</span>

   The P-Called-Party-ID header field is applicable when the UAS needs
   to be aware of the intended address-of-record that was present in the
   Request-URI of the request, before the proxy retargets to the contact
   address.  The UAS may be interested in applying different audiovisual
   alerting effects or other filtering services, depending on the
   intended destination of the request.  It is especially valuable when
   the UAS has registered several addresses-of-record to his registrar,
   and therefore, the UAS is not aware of the address-of-record that was
   present in the INVITE request when it hit his proxy/registrar, unless
   this extension is used.

   P-Called-Party-ID header field and the History-Info header field: At
   the time <a href="rfc3455.html">RFC 3455</a> [<a href="rfc3455.html" title="&quot;Private Header (P-Header) Extensions to the Session Initiation Protocol (SIP) for the 3rd-Generation Partnership Project (3GPP)&quot;">RFC3455</a>] was written, the History-Info header
   field was a long way from specification.  This header has now been
   specified and approved in <a href="rfc7044.html">RFC 7044</a> [<a href="rfc7044.html" title="&quot;An Extension to the Session Initiation Protocol (SIP) for Request History Information&quot;">RFC7044</a>].  It is acknowledged
   that the History-Info header field will provide equivalent coverage
   to that of the P-Called-Party-ID header field.  However, the
   P-Called-Party-ID header field is used entirely within the 3GPP
   system and does not appear to SIP entities outside that of a single
   3GPP operator.







<span class="grey">Jesske, et al.                Informational                    [Page 10]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


<span class="h4"><a class="selflink" name="section-4.2.2" href="#section-4.2.2">4.2.2</a>.  Usage of the P-Called-Party-ID Header Field</span>

   The P-Called-Party-ID header field provides proxies and the UAS with
   the address-of-record that was present in the Request-URI of the
   request, before a proxy retargets the request.  This information is
   intended to be used by subsequent proxies in the path or by the UAS.

   Typically, a SIP proxy inserts the P-Called-Party-ID header field
   prior to retargetting the Request-URI in the SIP request.  The header
   field value is populated with the contents of the Request-URI, prior
   to replacing it with the contact address.

<span class="h5"><a class="selflink" name="section-4.2.2.1" href="#section-4.2.2.1">4.2.2.1</a>.  Procedures at the UA</span>

   A UAC MUST NOT insert a P-Called-Party-ID header field in any SIP
   request or response.

   A UAS may receive a SIP request that contains a P-Called-Party-ID
   header field.  The header field will be populated with the address-
   of-record received by the proxy in the Request-URI of the request,
   prior to its forwarding to the UAS.

   The UAS MAY use the value in the P-Called-Party-ID header field to
   provide services based on the called party URI, such as, e.g.,
   filtering of calls depending on the date and time, distinctive
   presentation services, distinctive alerting tones, etc.

<span class="h5"><a class="selflink" name="section-4.2.2.2" href="#section-4.2.2.2">4.2.2.2</a>.  Procedures at the Proxy</span>

   A proxy that has access to the contact information of the user can
   insert a P-Called-Party-ID header field in any of the requests
   indicated in <a href="#section-5.7">Section 5.7</a>.  When included, the proxy MUST populate the
   header field value with the contents of the Request-URI present in
   the SIP request that the proxy received.

   It is necessary that the proxy that inserts the P-Called-Party-ID
   header field has information about the user, in order to prevent a
   wrong delivery of the called party ID.  This information may, for
   example, have been learned through a registration process.

   A proxy or application server that receives a request containing a
   P-Called-Party-ID header field MAY use the contents of the header
   field to provide a service to the user based on the URI of that
   header field value.

   A SIP proxy MUST NOT insert a P-Called-Party-ID header field in
   REGISTER requests.




<span class="grey">Jesske, et al.                Informational                    [Page 11]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


<span class="h3"><a class="selflink" name="section-4.3" href="#section-4.3">4.3</a>.  The P-Visited-Network-ID Header Field</span>

   3GPP networks are composed of a collection of so-called home
   networks, visited networks, and subscribers.  A particular home
   network may have roaming agreements with one or more visited
   networks.  The effect of this is that when a mobile terminal is
   roaming, it can use resources provided by the visited network in a
   transparent fashion.

   One of the conditions for a home network to accept the registration
   of a UA roaming to a particular visited network, is the existence of
   a roaming agreement between the home and the visited network.  There
   is a need to indicate to the home network which network is the
   visited network that is providing services to the roaming UA.

   3GPP user agents always register to the home network.  The REGISTER
   request is proxied by one or more proxies located in the visited
   network towards the home network.  For the sake of a simple approach,
   it seems sensible that the visited network includes an identification
   that is known to the home network.  This identification should be
   globally unique, and it takes the form of a quoted-text string or a
   token.  The home network may use this identification to verify the
   existence of a roaming agreement with the visited network, and to
   authorize the registration through that visited network.

   Note that P-Visited-Network-ID information reveals the location of
   the user, to the level of the coverage area of the visited network.
   For a national network, for example, P-Visited-Network-ID would
   reveal that the user is in the country in question.

<span class="h4"><a class="selflink" name="section-4.3.1" href="#section-4.3.1">4.3.1</a>.  Applicability Statement for the P-Visited-Network-ID Header</span>
<span class="h4">        Field</span>

   The P-Visited-Network-ID header field is applicable whenever the
   following circumstances are met:

   1.  There is transitive trust in intermediate proxies between the UA
       and the home network proxy via established relationships between
       the home network and the visited network, supported by the use of
       standard security mechanisms, e.g., IPsec, Authentication and Key
       Agreement (AKA), or Transport Layer Security (TLS).

   2.  An endpoint is using resources provided by one or more visited
       networks (a network to which the user does not have a direct
       business relationship).

   3.  A proxy that is located in one of the visited networks wants to
       be identified at the user's home network.



<span class="grey">Jesske, et al.                Informational                    [Page 12]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   4.  There is no requirement that every visited network need be
       identified at the home network.  Those networks that want to be
       identified make use of this extension.  Those networks that do
       not want to be identified do nothing.

   5.  A commonly pre-agreed text string or token identifies the visited
       network at the home network.

   6.  The UAC sends a REGISTER request or dialog-initiating request
       (e.g., INVITE request) or a standalone request outside a dialog
       (e.g., OPTIONS request) to a proxy in a visited network.

   7.  The request traverses, en route to its destination, a first proxy
       located in the visited network and a second proxy located in the
       home network or its destination is the registrar in the home
       network.

   8.  The registrar or home proxy verifies and authorizes the usage of
       resources (e.g., proxies) in the visited network.

   The P-Visited-Network-ID header field assumes that there is trust
   relationship between a home network and one or more transited visited
   networks.  It is possible for other proxies between the proxy in the
   visited network that inserts the header, and the registrar or the
   home proxy, to modify the value of P-Visited-Network-ID header field.
   Therefore, intermediaries participating in this mechanism MUST apply
   a hop-by-hop integrity-protection mechanism such as IPsec or other
   available mechanisms in order to prevent such attacks.

<span class="h4"><a class="selflink" name="section-4.3.2" href="#section-4.3.2">4.3.2</a>.  Usage of the P-Visited-Network-ID Header Field</span>

   The P-Visited-Network-ID header field is used to convey to the
   registrar or home proxy in the home network the identifier of a
   visited network.  The identifier is a text string or token that is
   known by both the registrar or the home proxy at the home network and
   the proxies in the visited network.

   Typically, the home network authorizes the UA to roam to a particular
   visited network.  This action requires an existing roaming agreement
   between the home and the visited network.

   While it is possible for a home network to identify one or more
   visited networks by inspecting the domain name in the Via header
   fields, this approach has a heavy dependency on DNS.  It is an option
   for a proxy to populate the Via header field with an IP address, for
   example, and in the absence of a reverse DNS entry, the IP address
   will not convey the desired information.




<span class="grey">Jesske, et al.                Informational                    [Page 13]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   Any SIP proxy in the visited network that receives any of the
   requests indicated in <a href="#section-5.7">Section 5.7</a> MAY insert a P-Visited-Network-ID
   header field when it forwards the request.  In case a REGISTER
   request or other request is traversing different administrative
   domains (e.g., different visited networks), a SIP proxy MAY insert a
   new P-Visited-Network-ID header field if the request does not contain
   a P-Visited-Network-ID header field with the same network identifier
   as its own network identifier (e.g., if the request has traversed
   other different administrative domains).

   Note also that, there is no requirement for this header field value
   to be readable in the proxies.  Therefore, a first proxy MAY insert
   an encrypted header field that only the registrar can decrypt.  If
   the request traverses a second proxy located in the same
   administrative domain as the first proxy, the second proxy may not be
   able to read the contents of the P-Visited-Network-ID header field.
   In this situation, the second proxy will consider that its visited
   network identifier is not already present in the value of the header
   field, and therefore, it will insert a new P-Visited-Network-ID
   header field value (hopefully with the same identifier that the first
   proxy inserted, although perhaps, not encrypted).  When the request
   arrives at the registrar or proxy in the home network, it will notice
   that the header field value is repeated (both the first and the
   second proxy inserted it).  The decrypted values should be the same,
   because both proxies where part of the same administrative domain.
   While this situation is not desirable, it does not create any harm at
   the registrar or proxy in the home network.

   The P-Visited-Network-ID header field is normally used at
   registration.  However, this extension does not preclude other
   usages.  For example, a proxy located in a visited network that does
   not maintain registration state MAY insert a P-Visited-Network-ID
   header field into any standalone request outside a dialog or a
   request that creates a dialog.  At the time of writing this document,
   the only requests that create dialogs are INVITE requests [<a href="rfc3261.html" title="&quot;SIP: Session Initiation Protocol&quot;">RFC3261</a>],
   SUBSCRIBE requests [<a href="rfc6665.html" title="&quot;SIP-Specific Event Notification&quot;">RFC6665</a>], and REFER requests [<a href="rfc3515.html" title="&quot;The Session Initiation Protocol (SIP) Refer Method&quot;">RFC3515</a>].

   In order to avoid conflicts with identifiers, especially when the
   number of roaming agreements between networks increase, care must be
   taken when selecting the value of the P-Visited-Network-ID header
   field.  The identifier MUST be globally unique to avoid duplications.
   Although there are many mechanisms to create globally unique
   identifiers across networks, one such mechanism is already in
   operation, and that is DNS.  The P-Visited-Network-ID header field
   does not have any connection to DNS, but the values in the header
   field can be chosen from the DNS entry representing the domain name
   of the network.  This guarantees the uniqueness of the value.




<span class="grey">Jesske, et al.                Informational                    [Page 14]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-15" id="page-15" href="#page-15" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


<span class="h5"><a class="selflink" name="section-4.3.2.1" href="#section-4.3.2.1">4.3.2.1</a>.  Procedures at the UA</span>

   In the context of the network to which the header fields defined in
   this document apply, a User Agent has no knowledge of the P-Visited-
   Network-ID when sending the REGISTER request.  Therefore, UACs MUST
   NOT insert a P-Visited-Network-ID header field in any SIP message.

<span class="h5"><a class="selflink" name="section-4.3.2.2" href="#section-4.3.2.2">4.3.2.2</a>.  Procedures at the Registrar and Proxy</span>

   A SIP proxy that is located in a visited network MAY insert a
   P-Visited-Network-ID header field in any of the requests indicated in
   <a href="#section-5.7">Section 5.7</a>.  The header field MUST be populated with the contents of
   a text string or a token that identifies the administrative domain of
   the network where the proxy is operating towards the user's home
   network.

   A SIP proxy or registrar which is located in the home network can use
   the contents of the P-Visited-Network-ID header field as an
   identifier of one or more visited networks that the request
   traversed.  The proxy or registrar in the home network may take
   local-policy-driven actions based on the existence (or nonexistence)
   of a roaming agreement between the home and the visited networks.
   This means, for instance, the authorization of the actions of the
   request is based on the contents of the P-Visited-Network-ID header
   field.

   A SIP proxy that is located in the home network MUST delete this
   header field when forwarding the message outside the home network
   administrative domain, in order to retain the user's privacy.

   A SIP proxy that is located in the home network SHOULD delete this
   header field when the home proxy has used the contents of the header
   field or the request is routed based on the called party's
   identification, even when the request is not forwarded outside the
   home network administrative domain.

   Note that a received P-Visited-Network-ID from a UA is not allowed
   and MUST be deleted when the request is forwarded.

<span class="h5"><a class="selflink" name="section-4.3.2.3" href="#section-4.3.2.3">4.3.2.3</a>.  Examples of Usage</span>

   We present an example in the context of the scenario shown in the
   following network diagram:

     Scenario            UA --- P1 --- P2 --- REGISTRAR






<span class="grey">Jesske, et al.                Informational                    [Page 15]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-16" id="page-16" href="#page-16" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   This example shows the message sequence for a REGISTER transaction
   originating from UA eventually arriving at the REGISTRAR.  P1 is an
   outbound proxy in the visited network for UA.  In this case, P1
   inserts the P-Visited-Network-ID header field.  Then, P1 routes the
   REGISTER request to REGISTRAR via P2.

   Message sequence for REGISTER using P-Visited-Network-ID header
   field:

         F1 Register UA -&gt; P1
              REGISTER sip:example.com SIP/2.0
              Via: SIP/2.0/UDP 192.0.2.4:5060;branch=z9hG4bKnashds7
              To: sip:user1-business@example.com
              From: sip:user1-business@example.com;tag=456248
              Call-ID: 843817637684230998sdasdh09
              CSeq: 1826 REGISTER
              Contact: &lt;sip:user1@192.0.2.4&gt;

   In flow F2, proxy P1 adds its own identifier in a quoted string to
   the P-Visited-Network-ID header field.

         F2 Register P1 -&gt; P2
              REGISTER sip:example.com SIP/2.0
              Via: SIP/2.0/UDP p1@visited.net;branch=z9hG4bK203igld
              Via: SIP/2.0/UDP 192.0.2.4:5060;branch=z9hG4bKnashd8
              To: sip:user1-personal@example.com
              From: sip:user1-personal@example.com;tag=346249
              Call-ID: 2Q3817637684230998sdasdh10
              CSeq: 1826 REGISTER
              Contact: &lt;sip:user1@192.0.2.4&gt;
              P-Visited-Network-ID: "Visited network number 1"

   Finally, in flow F3, proxy P2 decides to insert its own identifier,
   derived from its own domain name to the P-Visited-Network-ID header
   field.

         F3 Register P2 -&gt; REGISTRAR
              REGISTER sip:example.com SIP/2.0
              Via: SIP/2.0/UDP p2@other.net;branch=z9hG4bK2bndnvk
              Via: SIP/2.0/UDP p1@visited.net;branch=z9hG4bK203igld
              Via: SIP/2.0/UDP 192.0.2.4:5060;branch=z9hG4bKnashd8
              To: sip:user1-personal@example.com
              From: sip:user1-personal@example.com;tag=346249
              Call-ID: 2Q3817637684230998sdasdh10
              CSeq: 1826 REGISTER
              Contact: &lt;sip:user1@192.0.2.4&gt;
              P-Visited-Network-ID: other.net,"Visited network number 1"




<span class="grey">Jesske, et al.                Informational                    [Page 16]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-17" id="page-17" href="#page-17" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


<span class="h3"><a class="selflink" name="section-4.4" href="#section-4.4">4.4</a>.  The P-Access-Network-Info Header Field</span>

   This section describes the P-Access-Network-Info header field.  This
   header field is useful in SIP-based networks that also provide Layer
   2 (L2) / Layer 3 (L3) connectivity through different access
   technologies.  SIP UAs may use this header field to relay information
   about the access technology to proxies that are providing services.
   The serving proxy may then use this information to optimize services
   for the UA.  For example, a 3GPP UA may use this header field to pass
   information about the access network such as radio access technology
   and radio cell identity to its home service provider.

   For the purpose of this extension, we define an access network as the
   network providing the L2/L3 IP connectivity, which, in turn, provides
   a user with access to the SIP capabilities and services provided.

   In some cases, the SIP server that provides the user with services
   may wish to know information about the type of access network that
   the UA is currently using.  Some services are more suitable or less
   suitable depending on the access type, and some services are of more
   value to subscribers if the access network details are known by the
   SIP proxy that provides the user with services.

   In other cases, the SIP server that provides the user with services
   may simply wish to know crude location information in order to
   provide certain services to the user.  For example, many of the
   location-based services available in wireless networks today require
   the home network to know the identity of the cell the user is being
   served by.

   Some regulatory requirements exist mandating that for cellular radio
   systems, the identity of the cell where an emergency call is
   established is made available to the emergency authorities.

   The SIP server that provides services to the user may desire to have
   knowledge about the access network.  This is achieved by defining a
   new private SIP extension header field, P-Access-Network-Info header
   field.  This header field carries information relating to the access
   network between the UAC and its serving proxy in the home network.

   A proxy providing services based on the P-Access-Network-Info header
   field must consider the trust relationship to the UA or outbound
   proxy including the P-Access-Network-Info header field.








<span class="grey">Jesske, et al.                Informational                    [Page 17]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-18" id="page-18" href="#page-18" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


<span class="h4"><a class="selflink" name="section-4.4.1" href="#section-4.4.1">4.4.1</a>.  Applicability Statement for the P-Access-Network-Info Header</span>
<span class="h4">        Field</span>

   This mechanism is appropriate in environments where SIP services are
   dependent on SIP elements knowing details about the IP and lower-
   layer technologies used by a UA to connect to the SIP network.
   Specifically, the extension requires that the UA know the access
   technology it is using, and that a proxy desires such information to
   provide services.  Generally, SIP is built on the everything over IP
   and IP over everything principle, where the access technology is not
   relevant for the operation of SIP.  Since SIP systems generally
   should not care or even know about the access technology, this SIP
   extension is not for general SIP usage.

   The information revealed in the P-Access-Network-Info header field is
   potentially very sensitive.  Proper protection of this information
   depends on the existence of specific business and security
   relationships amongst the proxies that will see SIP messages
   containing this header field.  It also depends on explicit knowledge
   of the UA of the existence of those relationships.  Therefore, this
   mechanism is only suitable in environments where the appropriate
   relationships are in place, and the UA has explicit knowledge that
   they exist.

<span class="h4"><a class="selflink" name="section-4.4.2" href="#section-4.4.2">4.4.2</a>.  Usage of the P-Access-Network-Info Header</span>

   When a UA generates a SIP request or response that it knows is going
   to be securely sent to its SIP proxy that is providing services, the
   UA inserts a P-Access-Network-Info header field into field the SIP
   message.  This header contains information on the access network that
   the UA is using to get IP connectivity.  The header is typically
   ignored by intermediate proxies between the UA and the SIP proxy that
   is providing services.  The proxy providing services can inspect the
   header and make use of the information contained there to provide
   appropriate services, depending on the value of the header.  Before
   proxying the request onwards to an untrusted administrative network
   domain, this proxy strips the header from the message.

   Additionally, the first outbound proxy, if in possession of
   appropriate information, can also add a P-Access-Network-Info header
   field with its own information.

<span class="h5"><a class="selflink" name="section-4.4.2.1" href="#section-4.4.2.1">4.4.2.1</a>.  UA Behavior</span>

   A UA that supports this extension and is willing to disclose the
   related parameters MAY insert the P-Access-Network-Info header field
   in any SIP request or response.




<span class="grey">Jesske, et al.                Informational                    [Page 18]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-19" id="page-19" href="#page-19" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   The UA inserting this information MUST have a trust relationship with
   the proxy that is providing services to protect its privacy by
   deleting the header before forwarding the message outside of the
   proxy's domain.  This proxy is typically located in the home network.

   In order to avoid the deletion of the header, there MUST also be a
   transitive trust in intermediate proxies between the UA and the proxy
   that provides the services.  This trust is established by business
   agreements between the home network and the access network, and
   generally supported by the use of standard security mechanisms, e.g.,
   IPsec, AKA, and TLS.

<span class="h5"><a class="selflink" name="section-4.4.2.2" href="#section-4.4.2.2">4.4.2.2</a>.  Proxy Behavior</span>

   A proxy MUST NOT modify the value of the P-Access-Network-Info header
   field.

   A proxy in possession of appropriate information about the access
   technology MAY insert a P-Access-Network-Info header field with its
   own values.  A proxy sending towards an untrusted entity MUST remove
   any P-Access-Network-Info header field containing a "network-
   provided" value.

   A proxy that is providing services to the UA, can act upon any
   information present in the P-Access-Network-Info header field value,
   if is present, to provide a different service depending on the
   network or the location through which the UA is accessing the server.
   For example, for cellular radio access networks, the SIP proxy
   located in the home network MAY use the cell ID to provide basic
   localized services.

   A proxy that provides services to the user is typically located in
   the home network and is therefore trusted.  It MUST delete the header
   when the SIP signaling is forwarded to a SIP server located in an
   untrusted administrative network domain.  The SIP server providing
   services to the UA uses the access network information that is of no
   interest to other proxies located in different administrative
   domains.

<span class="h3"><a class="selflink" name="section-4.5" href="#section-4.5">4.5</a>.  The P-Charging-Function-Addresses Header Field</span>

   3GPP has defined a distributed architecture that results in multiple
   network entities becoming involved in providing access and services.
   There is a need to inform each SIP proxy involved in a transaction
   about the common charging functional entities to receive the
   generated charging records or charging events.





<span class="grey">Jesske, et al.                Informational                    [Page 19]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-20" id="page-20" href="#page-20" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   The solution provided by 3GPP is to define two types of charging
   functional entities: Charging Collection Function (CCF) and Event
   Charging Function (ECF).  CCF is used for offline charging (e.g., for
   postpaid account charging).  ECF is used for online charging (e.g.,
   for pre-paid account charging).  There may be more than a single
   instance of CCF and ECF in a network, in order to provide redundancy
   in the network.  In case there are more than a single instance of
   either the CCF or the ECF addresses, implementations SHOULD attempt
   sending the charging data to the ECF or CCF address, starting with
   the first address of the sequence (if any) in the P-Charging-
   Function-Addresses header field.  If the first address of the
   sequence is not available, then the next address (ccf-2 or ecf-2)
   MUST be used if available.  The CCF and ECF addresses MAY be passed
   during the establishment of a dialog or in a standalone transaction.
   More detailed information about charging can be found in 3GPP TS
   32.240 [<a href="#ref-TS32.240" title="&quot;Telecommunication management; Charging management; Charging architecture and principles&quot;">TS32.240</a>] and 3GPP TS 32.260 [<a href="#ref-TS32.260" title="&quot;Telecommunication management; Charging management; IP Multimedia Subsystem (IMS) charging&quot;">TS32.260</a>].

   We define the SIP private header field P-Charging-Function-Addresses
   header field.  A proxy MAY include this header field, if not already
   present, in either the initial request or response for a dialog or in
   the request and response of a standalone transaction outside a
   dialog.  When present, only one instance of the header MUST be
   present in a particular request or response.

   The mechanisms by which a SIP proxy collects the values to populate
   the P-Charging-Function-Addresses header field values are outside the
   scope of this document.  However, as an example, a SIP proxy may have
   preconfigured these addresses or may obtain them from a subscriber
   database.

<span class="h4"><a class="selflink" name="section-4.5.1" href="#section-4.5.1">4.5.1</a>.  Applicability Statement for the P-Charging-Function-Addresses</span>
<span class="h4">        Header Field</span>

   The P-Charging-Function-Addresses header field is applicable within a
   single private administrative domain where coordination of charging
   is required, for example, according to the architecture specified in
   3GPP TS 32.240 [<a href="#ref-TS32.240" title="&quot;Telecommunication management; Charging management; Charging architecture and principles&quot;">TS32.240</a>].

   The P-Charging-Function-Addresses header field is not included in a
   SIP message sent outside of the own administrative domain.  The
   header is not applicable if the administrative domain does not
   provide a charging function.









<span class="grey">Jesske, et al.                Informational                    [Page 20]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-21" id="page-21" href="#page-21" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   The P-Charging-Function-Addresses header field is applicable whenever
   the following circumstances are met:

   1.  A UA sends a REGISTER or dialog-initiating request (e.g., INVITE
       request) or a standalone transaction request outside a dialog to
       a proxy located in the administrative domain of a private
       network.

   2.  A registrar, proxy, or UA that is located in the administrative
       domain of the private network wants to generate charging records.

   3.  A registrar, proxy, or UA that is located in the private network
       has access to the addresses of the charging function entities for
       that network.

   4.  There are other proxies that are located in the same
       administrative domain of the private network and that generate
       charging records or charging events.  The proxies want to send,
       by means outside SIP, the charging information to the same
       charging collecting entities than the first proxy.

<span class="h4"><a class="selflink" name="section-4.5.2" href="#section-4.5.2">4.5.2</a>.  Usage of the P-Charging-Function-Addresses Header Field</span>

   A SIP proxy that receives a SIP request MAY insert a P-Charging-
   Function-Addresses header field prior to forwarding the request, if
   the header was not already present in the SIP request.  The header
   filed contains one or more parameters that contain the hostnames or
   IP addresses of the nodes that are willing to receive charging
   information.

   A SIP proxy that receives a SIP request that includes a P-Charging-
   Function-Addresses header field can use the hostnames or IP addresses
   included in the value, as the destination of charging information or
   charging events.  The means to send those charging information or
   events are outside the scope of this document, and usually, do not
   use SIP for that purpose.

<span class="h5"><a class="selflink" name="section-4.5.2.1" href="#section-4.5.2.1">4.5.2.1</a>.  Procedures at the UA</span>

   This document does not specify any procedure at the UA located
   outside the administrative domain of a private network, with regard
   to the P-Charging-Function-Addresses header field.  Such UAs need not
   understand this header.

   However, it might be possible that a UA is located within the
   administrative domain of a private network (e.g., a Public Switched
   Telephone Network (PSTN) gateway, or conference mixer), and it may
   have access to the addresses of the charging entities.  In this case,



<span class="grey">Jesske, et al.                Informational                    [Page 21]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-22" id="page-22" href="#page-22" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   a UA MAY insert the P-Charging-Function-Addresses header field in a
   SIP request or response when the next hop for the message is a proxy
   or UA located in the same administrative domain.  Similarly, such a
   UA MAY use the contents of the P-Charging-Function-Addresses header
   field in communicating with the charging entities.

<span class="h5"><a class="selflink" name="section-4.5.2.2" href="#section-4.5.2.2">4.5.2.2</a>.  Procedures at the Proxy</span>

   A SIP proxy that supports this extension and receives a request or
   response without the P-Charging-Function-Addresses header field MAY
   insert a P-Charging-Function-Addresses header field prior to
   forwarding the message.  The header is populated with a list of the
   addresses of one or more charging entities where the proxy should
   send charging-related information.

   If a proxy that supports this extension receives a request or
   response with the P-Charging-Function-Addresses header field, it MAY
   retrieve the information from the header field to use with
   application-specific logic, i.e., charging.  If the next hop for the
   message is within the administrative domain of the proxy, then the
   proxy SHOULD include the P-Charging-Function-Addresses header field
   in the outbound message.  However, if the next hop for the message is
   outside the administrative domain of the proxy, then the proxy MUST
   remove the P-Charging-Function-Addresses header field.

<span class="h5"><a class="selflink" name="section-4.5.2.3" href="#section-4.5.2.3">4.5.2.3</a>.  Examples of Usage</span>

   We present an example in the context of the scenario shown in the
   following network diagram:

         Scenario                   UA1 --- P1 --- P2 --- UA2

   In this scenario, we assume that P1 and P2 belong to the same
   administrative domain.

   The example below shows the message sequence for an INVITE
   transaction originating from UA1 and eventually arriving at UA2.  P1
   is an outbound proxy for UA1.  In this case, P1 inserts charging
   information.  Then, P1 routes the request via P2 to UA2.












<span class="grey">Jesske, et al.                Informational                    [Page 22]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-23" id="page-23" href="#page-23" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   Message sequence for INVITE using P-Charging-Function-Addresses
   header field:

         F1 Invite UA1 -&gt; P1
            INVITE sip:ua2@home1.net SIP/2.0
            Via: SIP/2.0/UDP 192.0.2.4:5060;branch=z9hG4bKnashds7
            To: sip:ua2@home1.net
            From: sip:ua1@home1.net;tag=456248
            Call-ID: 843817637684230998sdasdh09
            CSeq: 18 INVITE
            Contact: sip:ua1@192.0.2.4

         F2 Invite P1 -&gt; P2
            INVITE sip:ua2@home1.net SIP/2.0
            Via: SIP/2.0/UDP p1@home1.net:5060;branch=z9hG4bK34ghi7ab04
            Via: SIP/2.0/UDP 192.0.2.4:5060;branch=z9hG4bKnashds7
            To: sip:ua2@home1.net
            From: sip:ua1@home1.net;tag=456248
            Call-ID: 843817637684230998sdasdh09
            CSeq: 18 INVITE
            Contact: sip:ua1@192.0.2.4
            P-Charging-Function-Addresses:
                                     ccf=192.0.8.1; ecf=192.0.8.3,
                                     ccf-2=192.0.8.2; ecf-2=192.0.8.4

   Now both P1 and P2 are aware of the IP addresses of the entities that
   collect charging record or charging events.  Both proxies can send
   the charging information to the same entities.

<span class="h3"><a class="selflink" name="section-4.6" href="#section-4.6">4.6</a>.  The P-Charging-Vector Header Field</span>

   3GPP has defined a distributed architecture that results in multiple
   network entities becoming involved in providing access and services.
   Operators need the ability and flexibility to charge for the access
   and services as they see fit.  This requires coordination among the
   network entities (e.g., SIP proxies), which includes correlating
   charging records generated from different entities that are related
   to the same session.

   The correlation information includes, but is not limited to, a
   globally unique charging identifier that makes the billing effort
   easy.

   A charging vector is defined as a collection of charging information.
   The charging vector MAY be filled in during the establishment of a
   dialog or standalone transaction outside a dialog.  The information
   inside the charging vector MAY be filled in by multiple network
   entities (including SIP proxies) and retrieved by multiple network



<span class="grey">Jesske, et al.                Informational                    [Page 23]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-24" id="page-24" href="#page-24" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   entities.  There are three types of correlation information to be
   transferred: the IMS Charging Identity (ICID) value, the address of
   the SIP proxy that creates the ICID value, and the Inter Operator
   Identifier (IOI).

   ICID is a charging value that identifies a dialog or a transaction
   outside a dialog.  It is used to correlate charging records.  ICID
   MUST be a globally unique value.  One way to achieve globally
   uniqueness is to generate the ICID using two components: a locally
   unique value and the hostname or IP address of the SIP proxy that
   generated the locally unique value.

   The IOI identifies both the originating and terminating networks
   involved in a SIP dialog or transaction outside a dialog.  There MAY
   be an IOI generated from each side of the dialog to identify the
   network associated with each side.

   Additionally, in a multi-network environment, one or more transit IOI
   identifiers MAY be included along the path of the SIP dialog or
   transaction outside a dialog.  Due to network policy, a void value
   MAY be included instead of the transit network name.  The void value
   is used to indicate that a transit network appeared but due to
   operator policy the network name is not shown.

   Furthermore, in a multi-service provider environment, one or more
   transit IOIs MAY be included along the path of the SIP dialog or
   transaction outside a dialog.  Due to service provider policy, a void
   value MAY be included instead of the transit service provider.  The
   void value is used to indicate that a transit appeared but due to
   service provider policy the service provider name is not shown.

   There is also expected to be access network charging information,
   which consists of network-specific identifiers for the access level
   (e.g., Universal Mobile Telecommunications System (UMTS) radio access
   network or IEEE 802.11b).  The details of the information for each
   type of network are not described in this memo.

   We define the SIP private header P-Charging-Vector header field.  A
   proxy MAY include this header, if not already present, in either the
   initial request or response for a dialog, or in the request and
   response of a standalone transaction outside a dialog.  When present,
   only one instance of the header MUST be present in a particular
   request or response.

   The mechanisms by which a SIP proxy collects the values to populate
   the P-Charging-Vector header field are outside the scope of this
   document.




<span class="grey">Jesske, et al.                Informational                    [Page 24]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-25" id="page-25" href="#page-25" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


<span class="h4"><a class="selflink" name="section-4.6.1" href="#section-4.6.1">4.6.1</a>.  Applicability Statement for the P-Charging-Vector Header Field</span>

   The P-Charging-Vector header field is applicable within a single
   private administrative domain or between different administrative
   domains where there is a trust relationship between the domains.

   The P-Charging-Vector header field is not included in a SIP message
   sent to another network if there is no trust relationship.  The
   header is not applicable if the administrative domain manages
   charging in a way that does not require correlation of records from
   multiple network entities (e.g., SIP proxies).

   The P-Charging-Vector header field is applicable whenever the
   following circumstances are met:

   1.  A UA sends a REGISTER or dialog-initiating request (e.g., INVITE)
       or mid-dialog request (e.g., UPDATE) or a standalone transaction
       request outside a dialog to a proxy located in the administrative
       domain of a private network.

   2.  A registrar, proxy, or UA that is located in the administrative
       domain of the private network wants to generate charging records.

   3.  A proxy or UA that is located in the administrative domain of the
       private network has access to the charging correlation
       information for that network.

   4.  Optionally, a registrar, proxy, or UA that is part of a second
       administrative domain in another private network, whose SIP
       requests and responses are traversed through, en route to/from
       the first private network, wants to generate charging records and
       correlate those records with those of the first private network.
       This assumes that there is a trust relationship between both
       private networks.

<span class="h4"><a class="selflink" name="section-4.6.2" href="#section-4.6.2">4.6.2</a>.  Usage of the P-Charging-Vector Header Field</span>

   The P-Charging-Vector header field is used to convey charging-related
   information, such as the globally unique IMS Charging Identity (ICID)
   value.

   Typically, a SIP proxy that receives a SIP request that does not
   contain a P-Charging-Vector header field MAY insert it, with those
   parameters that are available at the SIP proxy.

   A SIP proxy that receives a SIP request that contains a P-Charging-
   Vector header field can use the values, such as the globally unique
   ICID, to produce charging records.



<span class="grey">Jesske, et al.                Informational                    [Page 25]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-26" id="page-26" href="#page-26" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


<span class="h5"><a class="selflink" name="section-4.6.2.1" href="#section-4.6.2.1">4.6.2.1</a>.  Procedures at the UA</span>

   This document does not specify any procedure at a UA located outside
   the administrative domain of a private network (e.g., PSTN gateway or
   conference mixer), with regard to the P-Charging-Vector header field.
   UAs need not understand this header.

   However, it might be possible that a UA be located within the
   administrative domain of a private network (e.g., a PSTN gateway, or
   conference mixer), and it may interact with the charging entities.
   In this case, a UA MAY insert the P-Charging-Vector header field in a
   SIP request or response when the next hop for the message is a proxy
   or UA located in the same administrative domain.  Similarly, such a
   UA MAY use the contents of the P-Charging-Vector header field in
   communicating with the charging entities.

<span class="h5"><a class="selflink" name="section-4.6.2.2" href="#section-4.6.2.2">4.6.2.2</a>.  Procedures at the Proxy</span>

   A SIP proxy that supports this extension and receives a request or
   response without the P-Charging-Vector header field MAY insert a
   P-Charging-Vector header field prior to forwarding the message.  The
   header is populated with one or more parameters, as described in the
   syntax, including but not limited to, a globally unique charging
   identifier.

   If a proxy that supports this extension receives a request or
   response with the P-Charging-Vector header field, it MAY retrieve the
   information from the header value to use with application-specific
   logic, i.e., charging.  If the next hop for the message is within the
   trusted domain, then the proxy SHOULD include the P-Charging-Vector
   header field in the outbound message.  If the next hop for the
   message is outside the trusted domain, then the proxy MAY remove the
   P-Charging-Function-Addresses header field.

   Per local application-specific logic, the proxy MAY modify the
   contents of the P-Charging-Vector header field prior to sending the
   message.

<span class="h5"><a class="selflink" name="section-4.6.2.3" href="#section-4.6.2.3">4.6.2.3</a>.  Examples of Usage</span>

   We present an example in the context of the scenario shown in the
   following network diagram:

    Scenario                      UA1 --- P1 --- P2 --- UA2







<span class="grey">Jesske, et al.                Informational                    [Page 26]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-27" id="page-27" href="#page-27" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   This example shows the message sequence for an INVITE transaction
   originating from UA1 and eventually arriving at UA2.  P1 is an
   outbound proxy for UA1.  In this case, P1 inserts charging
   information.  Then, P1 routes the call via P2 to UA2.

   Message sequence for INVITE using P-Charging-Vector header field:

         F1 Invite UA1 -&gt; P1
              INVITE sip:joe@example.com SIP/2.0
              Via: SIP/2.0/UDP 192.0.2.4:5060;branch=z9hG4bKnashds7
              To: sip:joe@example.com
              From: sip:ua1@home1.net;tag=456248
              Call-ID: 843817637684230998sdasdh09
              CSeq: 18 INVITE
              Contact: sip:ua1@192.0.2.4

         F2 Invite P1 -&gt; P2
              INVITE sip:joe@example.com SIP/2.0
              Via: SIP/2.0/UDP P1@home1.net:5060;branch=z9hG4bK34ghi7a
              Via: SIP/2.0/UDP 192.0.2.4:5060;branch=z9hG4bKnashds7
              To: sip:joe@example.com
              From: sip:ua1@home1.net;tag=456248
              Call-ID: 843817637684230998sdasdh09
              CSeq: 18 INVITE
              Contact: sip:ua1@192.0.2.4
              P-Charging-Vector: icid-value=1234bc9876e;
                                 icid-generated-at=192.0.6.8;
                                 orig-ioi=home1.net

<span class="h4"><a class="selflink" name="section-4.6.3" href="#section-4.6.3">4.6.3</a>.  Usage of the transit-ioi</span>

   The transit-ioi is added to the P-Charging-Vector header field when
   traversing transit networks.  It is allowed to have multiple
   transit-ioi values within one SIP message or response.  The values
   within the response are independent from the values set up within the
   request.

   The element could be added either by a transit network itself or by
   the succeeding network at the entry point where the preceding network
   is known.  Based on network policy, a void value can be used.

   Depending on the call scenario, each transit network can add either a
   transit network name or a void value.  However, it cannot be
   guaranteed that all the values that are added will appear within the
   P-Charging-Vector header field.






<span class="grey">Jesske, et al.                Informational                    [Page 27]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-28" id="page-28" href="#page-28" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   Some networks can screen the P-Charging-Vector header field and
   delete transit-ioi values, e.g., networks not supporting this value.
   There are scenarios where the appearance of the transit-ioi values of
   all networks is needed to have a correct end-to-end view.

   The policies of adding, modifying, and deleting transit-ioi values
   are out of the scope of this document.

   The transit-ioi contains an indexed value that MUST be incremented
   with each value added to the P-Charging-Vector header field.

   A void value has no index.  By adding the next value, the index has
   to be incremented by the number of void entries +1.

<span class="h5"><a class="selflink" name="section-4.6.3.1" href="#section-4.6.3.1">4.6.3.1</a>.  Procedures at the Proxy</span>

   Procedures described within <a href="#section-4.5.2.2">Section 4.5.2.2</a> apply.  A transit-ioi MAY
   be added or modified by a proxy.  A deletion of the transit-ioi or a
   entry within the tranist-ioi could appear depending on the network
   policy and trust rules.  This is also valid by replacing the
   transit-ioi with a void value.

<span class="h4"><a class="selflink" name="section-4.6.4" href="#section-4.6.4">4.6.4</a>.  Usage of the related-icid</span>

<span class="h5"><a class="selflink" name="section-4.6.4.1" href="#section-4.6.4.1">4.6.4.1</a>.  Procedures at the UA</span>

   The UAS acting as a B2BUA MAY add the related-icid into the
   P-Charging-Vector header field into SIP request or SIP responses.
   For example, the UAS can include the related-icid in a response to an
   INVITE request when the received INVITE request creates a new call
   leg towards the same remote end.  The value of the related-icid is
   the icid value of the original dialog towards the remote end.

<span class="h5"><a class="selflink" name="section-4.6.4.2" href="#section-4.6.4.2">4.6.4.2</a>.  Procedures at the Proxy</span>

   Procedures described within <a href="#section-4.5.2.2">Section 4.5.2.2</a> apply.  A related-icid
   and "related-icid-generated-at" MAY be added or modified by a proxy.
   A deletion of the elements could appear depending on the network
   policy and trust rules.

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  Formal Syntax</span>

   All of the mechanisms specified in this document are described in
   both prose and an augmented Backus-Naur Form (BNF) defined in <a href="rfc5234.html">RFC</a>
   <a href="rfc5234.html">5234</a> [<a href="rfc5234.html" title="&quot;Augmented BNF for Syntax Specifications: ABNF&quot;">RFC5234</a>].  Further, several BNF definitions are inherited from
   SIP and are not repeated here.  Implementors need to be familiar with
   the notation and contents of SIP [<a href="rfc3261.html" title="&quot;SIP: Session Initiation Protocol&quot;">RFC3261</a>] and [<a href="rfc5234.html" title="&quot;Augmented BNF for Syntax Specifications: ABNF&quot;">RFC5234</a>] to
   understand this document.



<span class="grey">Jesske, et al.                Informational                    [Page 28]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-29" id="page-29" href="#page-29" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


<span class="h3"><a class="selflink" name="section-5.1" href="#section-5.1">5.1</a>.  P-Associated-URI Header Syntax</span>

   The syntax of the P-Associated-URI header field is described as
   follows:

         P-Associated-URI       = "P-Associated-URI" HCOLON
                                  [p-aso-uri-spec]
                                  *(COMMA p-aso-uri-spec)
         p-aso-uri-spec         = name-addr *(SEMI ai-param)
         ai-param               = generic-param

<span class="h3"><a class="selflink" name="section-5.2" href="#section-5.2">5.2</a>.  P-Called-Party-ID Header Syntax</span>

   The syntax of the P-Called-Party-ID header field is described as
   follows:

         P-Called-Party-ID      = "P-Called-Party-ID" HCOLON
                                  called-pty-id-spec
         called-pty-id-spec     = name-addr *(SEMI cpid-param)
         cpid-param             = generic-param

<span class="h3"><a class="selflink" name="section-5.3" href="#section-5.3">5.3</a>.  P-Visited-Network-ID Header Syntax</span>

   The syntax of the P-Visited-Network-ID header field is described as
   follows:

         P-Visited-Network-ID   = "P-Visited-Network-ID" HCOLON
                                   vnetwork-spec
                                   *(COMMA vnetwork-spec)
         vnetwork-spec          = (token / quoted-string)
                                   *(SEMI vnetwork-param)
         vnetwork-param         = generic-param

<span class="h3"><a class="selflink" name="section-5.4" href="#section-5.4">5.4</a>.  P-Access-Network-Info Header Syntax</span>

   The syntax of the P-Access-Network-Info header field is described as
   follows:

      P-Access-Network-Info  = "P-Access-Network-Info" HCOLON
                                access-net-spec *(COMMA access-net-spec)
      access-net-spec        = (access-type / access-class)
                               *(SEMI access-info)
      access-type            = "IEEE-802.11" / "IEEE-802.11a" /
                               "IEEE-802.11b" / "IEEE-802.11g" /
                               "IEEE-802.11n" /
                               "IEEE-802.3" / "IEEE-802.3a" /
                               "IEEE-802.3ab" / "IEEE-802.3ae" /
                               "IEEE-802.3ak" / "IEEE-802.3ah" /



<span class="grey">Jesske, et al.                Informational                    [Page 29]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-30" id="page-30" href="#page-30" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


                               "IEEE-802.3aq" / "IEEE-802.3an" /
                               "IEEE-802.3e" / "IEEE-802.3i" /
                               "IEEE-802.3j" / "IEEE-802.3u" /
                               "IEEE-802.3y" / "IEEE-802.3z" /
                               "3GPP-GERAN" /
                               "3GPP-UTRAN-FDD" / "3GPP-UTRAN-TDD" /
                               "3GPP-E-UTRAN-FDD" / "3GPP-E-UTRAN-TDD" /
                               "3GPP2-1X-Femto" / "3GPP2-UMB" /
                               "3GPP2-1X-HRPD" / "3GPP2-1X" /
                               "ADSL" / "ADSL2" / "ADSL2+" / "RADSL" /
                               "SDSL" / "HDSL" / "HDSL2" / "G.SHDSL" /
                               "VDSL" / "IDSL" /
                               "DOCSIS" / "GSTN" / "GPON" / " XGPON1" /
                               "DVB-RCS2" / token
      access-class           = "3GPP-GERAN" /  "3GPP-UTRAN" /
                               "3GPP-E-UTRAN" / "3GPP-WLAN" /
                               "3GPP-GAN" / "3GPP-HSPA" /
                               "3GPP2" / token
      access-info            = cgi-3gpp / utran-cell-id-3gpp /
                               dsl-location / i-wlan-node-id /
                               ci-3gpp2 / eth-location /
                               ci-3gpp2-femto / fiber-location /
                               np / gstn-location /local-time-zone /
                               dvb-rcs2-node-id / extension-access-info
      np                     = "network-provided"
      extension-access-info  = gen-value
      cgi-3gpp               = "cgi-3gpp" EQUAL
                                   (token / quoted-string)
      utran-cell-id-3gpp     = "utran-cell-id-3gpp" EQUAL
                                   (token / quoted-string)
      i-wlan-node-id         = "i-wlan-node-id" EQUAL
                                   (token / quoted-string)
      dsl-location           = "dsl-location" EQUAL
                                   (token / quoted-string)
      eth-location           = "eth-location" EQUAL
                                   (token / quoted-string)
      fiber-location         = "fiber-location" EQUAL
                                   (token / quoted-string)
      ci-3gpp2               = "ci-3gpp2" EQUAL
                                   (token / quoted-string)
      ci-3gpp2-femto         = "ci-3gpp2-femto" EQUAL
                                    (token / quoted-string)
      gstn-location          = "gstn-location" EQUAL
                                    (token / quoted-string)
      dvb-rcs2-node-id       = "dvb-rcs2-node-id" EQUAL
                                     quoted-string
      local-time-zone        = "local-time-zone"  EQUAL
                                    quoted-string



<span class="grey">Jesske, et al.                Informational                    [Page 30]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-31" id="page-31" href="#page-31" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


      operator-specific-GI   = "operator-specific-GI" EQUAL
                                    (token / quoted-string)
      utran-sai-3gpp         = "utran-sai-3gpp" EQUAL
                                    (token / quoted-string)

   The access-info MAY contain additional information relating to the
   access network.  The values for "cgi-3gpp", "utran-cell-id-3gpp",
   "i-wlan-node-id", "dsl-location", "ci-3gpp2", "ci-3gpp2-femto", and
   "gstn-location" are defined in 3GPP TS 24.229 [<a href="#ref-TS24.229" title="&quot;IP multimedia call control protocol based on Session Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3&quot;">TS24.229</a>].

<span class="h3"><a class="selflink" name="section-5.5" href="#section-5.5">5.5</a>.  P-Charging-Function-Addresses Header Syntax</span>

   The syntax for the P-Charging-Function-Addresses header field is
   described as follows:

  P-Charging-Addresses = "P-Charging-Function-Addresses" HCOLON
                          charge-addr-params *(COMMA charge-addr-params)
  charge-addr-params   = charge-addr-param *(SEMI charge-addr-param)
  charge-addr-param    = ccf / ecf / ccf-2 /ecf-2 / generic-param
  ccf                  = "ccf" EQUAL gen-value
  ecf                  = "ecf" EQUAL gen-value
  ccf-2                = "ccf-2" EQUAL gen-value
  ecf-2                = "ecf-2" EQUAL gen-value

   The P-Charging-Function-Addresses header field contains one or two
   addresses of the ECF (ecf and ecf-2) or CCF (ccf and ccf-2).  The
   first address of the sequence is ccf or ecf.  If the first address of
   the sequence is not available, then the next address (ccf-2 or ecf-2)
   MUST be used if available.






















<span class="grey">Jesske, et al.                Informational                    [Page 31]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-32" id="page-32" href="#page-32" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


<span class="h3"><a class="selflink" name="section-5.6" href="#section-5.6">5.6</a>.  P-Charging-Vector Header Syntax</span>

   The syntax for the P-Charging-Vector header field is described as
   follows:

      P-Charging-Vector  = "P-Charging-Vector" HCOLON icid-value
                                  *(SEMI charge-params)
      charge-params      = icid-gen-addr / orig-ioi / term-ioi /
                           transit-ioi / related-icid /
                           related-icid-gen-addr / generic-param
      icid-value                = "icid-value" EQUAL gen-value
      icid-gen-addr             = "icid-generated-at" EQUAL host
      orig-ioi                  = "orig-ioi" EQUAL gen-value
      term-ioi                  = "term-ioi" EQUAL gen-value
      transit-ioi               = "transit-ioi" EQUAL transit-ioi-list
      transit-ioi-list          = DQUOTE transit-ioi-param
                                     *(COMMA transit-ioi-param) DQUOTE
      transit-ioi-param         = transit-ioi-indexed-value /
                                  transit-ioi-void-value
      transit-ioi-indexed-value = transit-ioi-name "."
                                                transit-ioi-index
      transit-ioi-name          = ALPHA *(ALPHA / DIGIT)
      transit-ioi-index         = 1*DIGIT
      transit-ioi-void-value    = "void"
      related-icid              = "related-icid" EQUAL gen-value
      related-icid-gen-addr     = "related-icid-generated-at" EQUAL host

   The P-Charging-Vector header field contains icid-value as a mandatory
   parameter.  The icid-value represents the IMS charging ID, and
   contains an identifier used for correlating charging records and
   events.  The first proxy that receives the request generates this
   value.

   The icid-gen-addr parameter contains the hostname or IP address of
   the proxy that generated the icid-value.

   The orig-ioi and term-ioi parameters contain originating and
   terminating interoperator identifiers.  They are used to correlate
   charging records between different operators.  The originating IOI
   represents the network responsible for the charging records in the
   originating part of the session or standalone request.  Similarly,
   the terminating IOI represents the network responsible for the
   charging records in the terminating part of the session or standalone
   request.







<span class="grey">Jesske, et al.                Informational                    [Page 32]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-33" id="page-33" href="#page-33" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   The transit-ioi parameter contains values with each of them,
   respectively, representing a transit interoperator identifier.  It is
   used to correlate charging records between different networks.  The
   transit-ioi represents the network responsible for the records in the
   transit part of the session or standalone request.

   The related-icid parameter contains the icid-value of a related
   charging record when more than one call leg is associated with one
   session.  This optional parameter is used for correlation of charging
   information between two or more call legs related to the same remote-
   end dialog.

   The related-icid-gen-addr parameter contains the hostname or IP
   address of the proxy that generated the related-icid.

   Applications using the P-Charging-Vector header field within their
   own applicability are allowed to define generic-param extensions
   without further reference to the IETF specification process.

<span class="h3"><a class="selflink" name="section-5.7" href="#section-5.7">5.7</a>.  New Headers</span>

   The P-Associated-URI header field can appear in SIP REGISTER method
   and 2xx resonses.  The P-Called-Party-ID header field can appear in
   SIP INVITE, OPTIONS, PUBLISH, SUBSCRIBE, and MESSAGE methods and all
   responses.  The P-Visited-Network-ID header field can appear in all
   SIP methods except ACK, BYE, and CANCEL and all responses.  The
   P-Access-Network-Info header field can appear in all SIP methods
   except ACK and CANCEL.  The P-Charging-Vector header field can appear
   in all SIP methods except CANCEL.  The P-Charging-Function-Addresses
   header field can appear in all SIP methods except ACK and CANCEL.

<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Security Considerations</span>

<span class="h3"><a class="selflink" name="section-6.1" href="#section-6.1">6.1</a>.  P-Associated-URI Header Field</span>

   The information returned in the P-Associated-URI header field is not
   viewed as particularly sensitive.  Rather, it is simply informational
   in nature, providing openness to the UAC with regard to the automatic
   association performed by the registrar.  If end-to-end protection is
   not used at the SIP layer, it is possible for proxies between the
   registrar and the UA to modify the contents of the header value.

   The lack of encryption, either end-to-end or hop-by-hop, may lead to
   leak some privacy regarding the list of authorized identities.  For
   instance, a user who registers an address-of-record of
   sip:user1@example.com may get another SIP URI associated as
   sip:first.last@example.com returned in the P-Associated-URI header
   field value.



<span class="grey">Jesske, et al.                Informational                    [Page 33]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-34" id="page-34" href="#page-34" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   An eavesdropper could possibly collect the list of identities a user
   is registered.  This can have privacy implications.  To mitigate this
   problem, this extension SHOULD only be used in a secured environment,
   where encryption of SIP messages is provided either end-to-end or
   hop-by-hop and where a trust relationship equivalent with that
   defined in <a href="rfc3325.html">RFC 3325</a> [<a href="rfc3325.html" title="&quot;Private Extensions to the Session Initiation Protocol (SIP) for Asserted Identity within Trusted Networks&quot;">RFC3325</a>] between entities exists.  That is, the
   privacy of the user relies on the other entities in the session not
   disclosing information that they have learned about the user.

   While the P-Associated-URI header field value allows the implicit
   registration of a bundle of URIs with one REGISTER Message, the
   impact of security using the P-Associated-URI header field is no
   higher than using separate REGISTER messages for each of the URIs.

<span class="h3"><a class="selflink" name="section-6.2" href="#section-6.2">6.2</a>.  P-Called-Party-ID Header Field</span>

   Due to the nature of the P-Called-Party-ID header field, this header
   does not introduce any significant security concern.  It is possible
   for an attacker to modify the contents of the header.  However, this
   modification will not cause any harm to the session establishment.

   An eavesdropper could possibly collect the list of identities a user
   has registered.  This can have privacy implications.  To mitigate
   this problem, this extension SHOULD only be used in a secured
   environment, where encryption of SIP messages is provided either end-
   to-end or hop-by-hop.

   Normally, within a 3GPP environment, the P-Called-Party-ID is not
   sent towards end users but may be exchanged between carriers where
   other security mechanisms than SIP encryption are used.

<span class="h3"><a class="selflink" name="section-6.3" href="#section-6.3">6.3</a>.  P-Visited-Network-ID Header Field</span>

   The P-Visited-Network-ID header field assumes that there is trust
   relationship between a home network and one or more transited visited
   networks.  It is possible for other proxies between the proxy in the
   visited network that inserts the header, and the registrar or the
   home proxy, to modify the value of P-Visited-Network-ID header field.
   Therefore, intermediaries participating in this mechanism MUST apply
   a hop-by-hop integrity-protection mechanism such as IPsec or other
   available mechanisms in order to prevent such attacks.










<span class="grey">Jesske, et al.                Informational                    [Page 34]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-35" id="page-35" href="#page-35" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


<span class="h3"><a class="selflink" name="section-6.4" href="#section-6.4">6.4</a>.  P-Access-Network-Info Header Field</span>

   A Trust Domain is formally defined in <a href="rfc3324.html">RFC 3324</a> [<a href="rfc3324.html" title="&quot;Short Term Requirements for Network Asserted Identity&quot;">RFC3324</a>].  For the
   purposes of this document, we refer to the 3GPP trust domain as the
   collection of SIP proxies and application servers that are operated
   by a 3GPP network operator and are compliant with the requirements
   expressed in 3GPP TS 24.229 [<a href="#ref-TS24.229" title="&quot;IP multimedia call control protocol based on Session Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3&quot;">TS24.229</a>].

   This extension assumes that the access network is trusted by the UA
   (because the UA's home network has a trust relationship with the
   access network), as described earlier in this document.

   This extension assumes that the information added to the header by
   the UAC should be sent only to trusted entities and MUST NOT be used
   outside of the trusted administrative network domain.

   The SIP proxy that provides services to the user, utilizes the
   information contained in this header to provide additional services
   and UAs are expected to provide correct information.  However, there
   are no security problems resulting from a UA inserting incorrect
   information.  Networks providing services based on the information
   carried in the P-Access-Network-Info header field will therefore need
   to trust the UA sending the information.  A rogue UA sending false
   access network information will do no more harm than to restrict the
   user from using certain services.

   The mechanism provided in this document is designed primarily for
   private systems like 3GPP.  Most security requirements are met by way
   of private standardized solutions.

   For instance, 3GPP will use the P-Access-Network-Info header field to
   carry relatively sensitive information like the cell ID.  Therefore,
   the information MUST NOT be sent outside of the 3GPP domain.

   The UA is aware -- if it is a 3GPP UA -- that it is operating within
   a trusted domain.

   The 3GPP UA is aware of whether or not a secure association to the
   home network domain for transporting SIP signaling is currently
   available, and, as such, the sensitive information carried in the
   P-Access-Network-Info header field MUST NOT be sent in any initial
   unauthenticated and unprotected requests (e.g., REGISTER).

   Any UA that is using this extension and is not part of a private
   trusted domain should not consider the mechanism as secure, and, as
   such, MUST NOT send sensitive information in the P-Access-Network-
   Info header field.




<span class="grey">Jesske, et al.                Informational                    [Page 35]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-36" id="page-36" href="#page-36" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   Any proxy that is operating in a private trust domain where the
   P-Access-Network-Info header field is supported is REQUIRED to delete
   the header, if it is present, from any message prior to forwarding it
   outside of the trusted domain.

   A proxy receiving a message containing the P-Access-Network-Info
   header field from an untrusted entity is not able to guarantee the
   validity of the contents.  Thus, this content SHOULD be deleted based
   on local policy.

<span class="h3"><a class="selflink" name="section-6.5" href="#section-6.5">6.5</a>.  P-Charging-Function-Addresses Header Field</span>

   It is expected as normal behavior that proxies within a closed
   network will modify the values of the P-Charging-Function-Addresses
   header field and insert it into a SIP request or response.  However,
   the proxies that share this information MUST have a trust
   relationship.

   If an untrusted entity were inserted between trusted entities, it
   could potentially substitute a different charging function address.
   Therefore, an integrity-protection mechanism such as IPsec or other
   available mechanisms MUST be applied in order to prevent such
   attacks.  Since each trusted proxy MAY need to view or modify the
   values in the P-Charging-Function-Addresses header field, the
   protection should be applied on a hop-by-hop basis.

<span class="h3"><a class="selflink" name="section-6.6" href="#section-6.6">6.6</a>.  P-Charging-Vector Header Field</span>

   It is expected as normal behavior that proxies within a closed
   network will modify the values of the P-Charging-Vector header field
   and insert it into a SIP request or response.  However, these proxies
   that share this information MUST have a trust relationship.

   If an untrusted entity were inserted between trusted entities, it
   could potentially interfere with the charging correlation mechanism.
   Therefore, an integrity-protection mechanism such as IPsec or other
   available mechanisms MUST be applied in order to prevent such
   attacks.  Since each trusted proxy MAY need to view or modify the
   values in the P-Charging-Vector header field, the protection should
   be applied on a hop-by-hop basis.











<span class="grey">Jesske, et al.                Informational                    [Page 36]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-37" id="page-37" href="#page-37" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  IANA Considerations</span>

   This document defines several private SIP extension header fields
   (beginning with the prefix "P-" ).

   This document obsoletes [<a href="rfc3455.html" title="&quot;Private Header (P-Header) Extensions to the Session Initiation Protocol (SIP) for the 3rd-Generation Partnership Project (3GPP)&quot;">RFC3455</a>] but uses the same SIP header field
   names.  The references in the "Header Fields" registry and "Header
   Field Parameters and Parameter Values" registry have been updated to
   [<a href="rfc3455.html" title="&quot;Private Header (P-Header) Extensions to the Session Initiation Protocol (SIP) for the 3rd-Generation Partnership Project (3GPP)&quot;">RFC3455</a>] to this document.

   The following extensions are registered as private extension header
   fields:

      Header Field Name:  P-Associated-URI
      Compact Form:       none
      Reference:          <a href="rfc7315.html">RFC 7315</a>

      Header Field Name:  P-Called-Party-ID
      Compact Form:       none
      Reference:          <a href="rfc7315.html">RFC 7315</a>

      Header Field Name:  P-Visited-Network-ID
      Compact Form:       none
      Reference:          <a href="rfc7315.html">RFC 7315</a>

      Header Field Name:  P-Access-Network-Info
      Parameter Name:     ci-3gpp
      Parameter Name:     ci-3gpp2
      Parameter Name:     ci-3gpp2-femto
      Parameter Name:     dsl-location
      Parameter Name:     dvb-rcs2-node-id
      Parameter Name:     eth-location
      Parameter Name:     fiber-location
      Parameter Name:     gstn-location
      Parameter Name:     i-wlan-node-id
      Parameter Name:     local-time-zone
      Parameter Name:     operator-specific-GI
      Parameter Name:     utran-cell-id-3gpp
      Parameter Name:     utran-sai-3gpp
      Compact Form:       none
      Reference:          <a href="rfc7315.html">RFC 7315</a>










<span class="grey">Jesske, et al.                Informational                    [Page 37]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-38" id="page-38" href="#page-38" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


      Header Field Name:  P-Charging-Function-Addresses
      Parameter Name:     ccf
      Parameter Name:     ccf-2
      Parameter Name:     ecf
      Parameter Name:     ecf-2
      Compact Form:       none
      Reference:          <a href="rfc7315.html">RFC 7315</a>

      Header Field Name:  P-Charging-Vector
      Parameter Name:     icid-value
      Parameter Name:     icid-generated-at
      Parameter Name:     orig-ioi
      Parameter Name:     related-icid
      Parameter Name:     related-icid-generated-at
      Parameter Name:     term-ioi
      Parameter Name:     transit-ioi
      Compact Form:       none
      Reference:          <a href="rfc7315.html">RFC 7315</a>

<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  Contributors and Acknowledgements</span>

   The authors would like to thank James Yu and Atle Monrad for their
   extensive review, Dean Willis for his expert review, and Mary Barnes
   for the proto review.  The authors would like to acknowledge the
   constructive feedback and contributions provided by Peter Leis,
   Joergen Axell, and Jan Holm.

   The extensions described in [<a href="rfc3455.html" title="&quot;Private Header (P-Header) Extensions to the Session Initiation Protocol (SIP) for the 3rd-Generation Partnership Project (3GPP)&quot;">RFC3455</a>] were originally specified in
   several documents.  Miguel Garcia-Martin authored the P-Associated-
   URI, P-Called-Party-ID, and P-Visited-Network-ID header fields.
   Duncan Mills authored the P-Access-Network-Info header.  Eric
   Henrikson authored the P-Charging-Function-Addresses and P-Charging-
   Vector headers.  Rohan Mahy assisted in the incorporation of these
   extensions into a single document.

   The listed authors of [<a href="rfc3455.html" title="&quot;Private Header (P-Header) Extensions to the Session Initiation Protocol (SIP) for the 3rd-Generation Partnership Project (3GPP)&quot;">RFC3455</a>] were Miguel Garcia-Martin, Eric
   Henrikson and Duncan Mills.

   The [<a href="rfc3455.html" title="&quot;Private Header (P-Header) Extensions to the Session Initiation Protocol (SIP) for the 3rd-Generation Partnership Project (3GPP)&quot;">RFC3455</a>] authors thanked Andrew Allen, Gabor Bajko, Gonzalo
   Camarillo, Keith Drage, Georg Mayer, Dean Willis, Rohan Mahy,
   Jonathan Rosenberg, Ya-Ching Tan, and the 3GPP CN1 WG members for
   their comments on [<a href="rfc3455.html" title="&quot;Private Header (P-Header) Extensions to the Session Initiation Protocol (SIP) for the 3rd-Generation Partnership Project (3GPP)&quot;">RFC3455</a>].









<span class="grey">Jesske, et al.                Informational                    [Page 38]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-39" id="page-39" href="#page-39" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  References</span>

<span class="h3"><a class="selflink" name="section-9.1" href="#section-9.1">9.1</a>.  Normative References</span>

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]    Bradner, S., "Key words for use in RFCs to Indicate
                Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a name="ref-RFC3261" id="ref-RFC3261">RFC3261</a>]    Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,
                A., Peterson, J., Sparks, R., Handley, M., and E.
                Schooler, "SIP: Session Initiation Protocol", <a href="rfc3261.html">RFC 3261</a>,
                June 2002.

   [<a name="ref-RFC5234" id="ref-RFC5234">RFC5234</a>]    Crocker, D. and P. Overell, "Augmented BNF for Syntax
                Specifications: ABNF", STD 68, <a href="rfc5234.html">RFC 5234</a>, January 2008.

   [<a name="ref-TS24.229" id="ref-TS24.229">TS24.229</a>]   3GPP, "IP multimedia call control protocol based on
                Session Initiation Protocol (SIP) and Session
                Description Protocol (SDP); Stage 3", 3GPP TS 24.229
                12.4.0, March 2014.

<span class="h3"><a class="selflink" name="section-9.2" href="#section-9.2">9.2</a>.  Informative References</span>

   [<a name="ref-RFC3324" id="ref-RFC3324">RFC3324</a>]    Watson, M., "Short Term Requirements for Network
                Asserted Identity", <a href="rfc3324.html">RFC 3324</a>, November 2002.

   [<a name="ref-RFC3325" id="ref-RFC3325">RFC3325</a>]    Jennings, C., Peterson, J., and M. Watson, "Private
                Extensions to the Session Initiation Protocol (SIP) for
                Asserted Identity within Trusted Networks", <a href="rfc3325.html">RFC 3325</a>,
                November 2002.

   [<a name="ref-RFC3455" id="ref-RFC3455">RFC3455</a>]    Garcia-Martin, M., Henrikson, E., and D. Mills, "Private
                Header (P-Header) Extensions to the Session Initiation
                Protocol (SIP) for the 3rd-Generation Partnership
                Project (3GPP)", <a href="rfc3455.html">RFC 3455</a>, January 2003.

   [<a name="ref-RFC3515" id="ref-RFC3515">RFC3515</a>]    Sparks, R., "The Session Initiation Protocol (SIP) Refer
                Method", <a href="rfc3515.html">RFC 3515</a>, April 2003.

   [<a name="ref-RFC4083" id="ref-RFC4083">RFC4083</a>]    Garcia-Martin, M., "Input 3rd-Generation Partnership
                Project (3GPP) Release 5 Requirements on the Session
                Initiation Protocol (SIP)", <a href="rfc4083.html">RFC 4083</a>, May 2005.

   [<a name="ref-RFC6665" id="ref-RFC6665">RFC6665</a>]    Roach, A., "SIP-Specific Event Notification", <a href="rfc6665.html">RFC 6665</a>,
                July 2012.







<span class="grey">Jesske, et al.                Informational                    [Page 39]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-40" id="page-40" href="#page-40" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   [<a name="ref-RFC7044" id="ref-RFC7044">RFC7044</a>]    Barnes, M., Audet, F., Schubert, S., van Elburg, J., and
                C. Holmberg, "An Extension to the Session Initiation
                Protocol (SIP) for Request History Information", <a href="rfc7044.html">RFC</a>
                <a href="rfc7044.html">7044</a>, February 2014.

   [<a name="ref-TS23.228" id="ref-TS23.228">TS23.228</a>]   3GPP, "P Multimedia Subsystem (IMS); Stage 2", 3GPP TS
                23.228 12.4.0, March 2014.

   [<a name="ref-TS32.240" id="ref-TS32.240">TS32.240</a>]   3GPP, "Telecommunication management; Charging
                management; Charging architecture and principles", 3GPP
                TS 32.240 12.3.0, March 2013.

   [<a name="ref-TS32.260" id="ref-TS32.260">TS32.260</a>]   3GPP, "Telecommunication management; Charging
                management; IP Multimedia Subsystem (IMS) charging",
                3GPP TS 32.260 10.3.0, April 2011.




































<span class="grey">Jesske, et al.                Informational                    [Page 40]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-41" id="page-41" href="#page-41" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


<span class="h2"><a class="selflink" name="appendix-A" href="#appendix-A">Appendix A</a>.  Changes from <a href="rfc3455.html">RFC 3455</a></span>

   1.   Procedures for the P-Associated-URI header field at a proxy.
        <a href="rfc3455.html">RFC 3455</a> indicates that it defines no procedures for the
        P-Associated-URI header field at a proxy.  What is implicitly
        meant here is that the proxy does not add, read, modify, or
        delete the header; therefore, <a href="rfc3261.html">RFC 3261</a> proxy procedures only
        apply to the header.

   2.   P-Called-Party-ID header field and the History-Info header
        field: At the time <a href="rfc3455.html">RFC 3455</a> was written, the History-Info header
        field was a long way from specification.  This header has now
        been specified and approved in <a href="rfc7044.html">RFC 7044</a>.  It is acknowledged
        that the History-Info header field will provide equivalent
        coverage to that of the P-Called-Party-ID header field.
        However, the P-Called-Party-ID header field is used entirely
        within the 3GPP system and does not appear to SIP entities
        outside that of a single 3GPP operator.

   3.   Procedures at the UA for the P-Charging-Function Addresses
        header field: The text in <a href="rfc3455.html#section-4.5.2.1">Section&nbsp;4.5.2.1 of RFC 3455</a> does not
        adequately take into account procedures for UAs located inside
        the private network, e.g., as gateways and such that may play a
        full part in network charging procedures.  <a href="#section-4.5.2.1">Section 4.5.2.1</a> is
        replaced with new text.

   4.   The text in <a href="rfc3455.html#section-4.6.2.1">Section&nbsp;4.6.2.1 of RFC 3455</a> does not adequately take
        into account procedures for UAs located inside the private
        network, e.g., as gateways and such that may play a full part in
        network charging procedures.  <a href="#section-4.6.2.1">Section 4.6.2.1</a> is now replaced
        with new text.

   5.   Recognition of additional values of access technology in the
        P-Access-Network-Info header field (<a href="#section-4.4">Section 4.4</a>): A number of
        new access technologies are contemplated in 3GPP, and the reuse
        of IMS to support Next Generation Networks (NGN) is also
        resulting in new access technologies.  Values for access
        technologies are defined explicitly in <a href="rfc3455.html">RFC 3455</a>, and no IANA
        procedures are defined to maintain a separate registry.  In
        particular, the new values: "IEEE 802.11", "IEEE-802.11g",
        "IEEE-802.11n", "ADSL" / "ADSL2", "ADSL2+", "RADSL", "SDSL",
        "HDSL", "HDSL2", "G.SHDSL", "VDSL", "IDSL", "IEEE-802.3",
        "IEEE-802.3a", "IEEE-802.3e", "IEEE-802.3i", "IEEE-802.3j",
        "IEEE-802.3u", "IEEE-802.3ab", "IEEE-802.3ae", "IEEE-802.3ak",
        "IEEE-802.3aq", "IEEE-802.3an", "IEEE-802.3y", "IEEE-802.3z",
        and "IEEE-802.3y" are defined.





<span class="grey">Jesske, et al.                Informational                    [Page 41]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-42" id="page-42" href="#page-42" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   6.   Replacement of existing value of access technology in the
        P-Access-Network-Info header field (<a href="#section-4.4">Section 4.4</a>): The value of
        "3GPP-CDMA2000" was replaced long ago in 3GPP2 by three new
        values: "3GPP2-1X", "3GPP2-1X-HRPD", and "3GPP2-UMB".  It is not
        believed that there was any deployment of the "3GPP-CDMA2000"
        value.

   7.   Network-provided P-Access-Network-Info header field: The
        P-Access-Network-Info header field may additionally be provided
        by proxies within the network.  This does not impact the values
        provided by a UA; rather, the header is repeated.  Such values
        are identified by the string "network-provided".  A special
        class of values are defined for use here, as the same
        granularity of values may not be possible as for those available
        from the UA: "3GPP-GERAN", "3GPP-UTRAN", "3GPP-WLAN",
        "3GPP-GAN", and "3GPP-HSPA".  Outbound proxies remove P-Access-
        Network-Info header fields containing the "network-provided"
        value.

   8.   Definition of additional parameters to the P-Charging-Vector
        header field: <a href="rfc3455.html#section-5.6">Section&nbsp;5.6 of RFC 3455</a> defines the syntax of the
        P-Charging-Vector header field.  Additional parameters were
        considered too application specific for specification in <a href="rfc3455.html">RFC</a>
        <a href="rfc3455.html">3455</a>, but it was acknowledged that they would exist, and indeed
        additional specification of such parameters, relating to
        specific access technologies, has occurred in 3GPP.  Therefore,
        this update states that applications using the P-Charging-Vector
        header field within their own applicability are allowed to
        define generic-param extensions without further reference to the
        IETF specification process.

   9.   In <a href="#section-5.7">Section 5.7</a>, it was added that the P-Called-Party-ID can
        appear in the PUBLISH method.

   10.  Referencing: <a href="rfc3427.html">RFC 3427</a> was deleted from the References section as
        it was not used within the document.  Various informative
        references have now been published as RFCs and have been updated
        to include the appropriate RFC number.  References to 3GPP TS
        32.200 were replaced by references to 3GPP TS 32.240 [<a href="#ref-TS32.240" title="&quot;Telecommunication management; Charging management; Charging architecture and principles&quot;">TS32.240</a>],
        which is the successor specification.  References to 3GPP TS
        32.225 were replaced by references to 3GPP TS 32.260 [<a href="#ref-TS32.260" title="&quot;Telecommunication management; Charging management; IP Multimedia Subsystem (IMS) charging&quot;">TS32.260</a>],
        which is the successor specification.  The referencing style was
        changed to symbolic references.  Dates have been removed from
        all 3GPP references (i.e., latest version applies).







<span class="grey">Jesske, et al.                Informational                    [Page 42]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-43" id="page-43" href="#page-43" class="invisible"> </a>
<span class="grey"><a href="rfc7315.html">RFC 7315</a>              3GPP SIP P-Header Extensions             July 2014</span>


   11.  Various editorial changes in alignment with style used in <a href="rfc3261.html">RFC</a>
        <a href="rfc3261.html">3261</a> such as placing response code text in parentheses and using
        words "request" and "response" in association with method names
        have been applied.

Authors' Addresses

   Roland Jesske
   Deutsche Telekom
   Heinrich-Hertz-Strasse 3-7
   Darmstadt  64307
   Germany

   Phone: +4961515812766
   EMail: r.jesske@telekom.de


   Keith Drage
   Alcatel-Lucent
   Quadrant, StoneHill Green, Westlea
   Swindon, Wilts
   UK

   EMail: drage@alcatel-lucent.com


   Christer Holmberg
   Ericsson
   Hirsalantie 11
   Jorvas  02420
   Finland

   EMail: christer.holmberg@ericsson.com


















Jesske, et al.                Informational                    [Page 43]

</pre><br />
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.129c, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>
</body>

<!-- Mirrored from tools.ietf.org/html/rfc7315 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:30:32 GMT -->
</html>
