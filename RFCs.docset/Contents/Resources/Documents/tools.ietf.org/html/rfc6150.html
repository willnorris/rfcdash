<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6150 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Aug 2018 14:22:42 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.127" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="rfc1320" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:6150" name="DC.Identifier"/>
<meta content="March, 2011" name="DC.Date.Issued"/>
<meta content="Turner, Sean" name="DC.Creator"/>
<meta content="Chen, Lily" name="DC.Creator"/>
<meta content="This document recommends the retirement of MD4 and discusses the
reasons for doing so. This document recommends RFC 1320 be moved to
Historic status." name="DC.Description.Abstract"/>
<meta content="MD4 to Historic Status" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6150 - MD4 to Historic Status</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6150.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6150" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-turner-md4-to-historic" title="draft-turner-md4-to-historic">draft-turner-md...</a>] [<a href="https://datatracker.ietf.org/doc/rfc6150" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6150" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6150" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=6150">Errata</a>]</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Internet Engineering Task Force (IETF)                         S. Turner
Request for Comments: 6150                                          IECA
Obsoletes: <a href="rfc1320.html">1320</a>                                                  L. Chen
Category: Informational                                             NIST
ISSN: 2070-1721                                               March 2011


                         <span class="h1">MD4 to Historic Status</span>

Abstract

   This document retires <a href="rfc1320.html">RFC 1320</a>, which documents the MD4 algorithm,
   and discusses the reasons for doing so.  This document moves <a href="rfc1320.html">RFC 1320</a>
   to Historic status.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">SectionÂ 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6150">http://www.rfc-editor.org/info/rfc6150</a>.

Copyright Notice

   Copyright (c) 2011 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.






<span class="grey">Turner &amp; Chen                 Informational                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6150.html">RFC 6150</a>                 MD2 to Historic Status               March 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   MD4 [<a href="#ref-MD4" title='"The MD4 Message-Digest Algorithm"'>MD4</a>] is a message digest algorithm that takes as input a message
   of arbitrary length and produces as output a 128-bit "fingerprint" or
   "message digest" of the input.  This document retires [<a href="#ref-MD4" title='"The MD4 Message-Digest Algorithm"'>MD4</a>].
   Specifically, this document moves <a href="rfc1320.html">RFC 1320</a> [<a href="#ref-MD4" title='"The MD4 Message-Digest Algorithm"'>MD4</a>] to Historic status.
   The reasons for taking this action are discussed.

   [<a id="ref-HASH-Attack" name="ref-HASH-Attack">HASH-Attack</a>] summarizes the use of hashes in many protocols and
   discusses how attacks against a message digest algorithm's one-way
   and collision-free properties affect and do not affect Internet
   protocols.  Familiarity with [<a href="#ref-HASH-Attack" title='"Attacks on Cryptographic Hashes in Internet Protocols"'>HASH-Attack</a>] is assumed.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Rationale"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Rationale</span>

   MD4 was published in 1992 as an Informational RFC.  Since its
   publication, MD4 has been under attack [<a href="#ref-denBORBOS1992" title="Springer-Verlag">denBORBOS1992</a>] [<a href="#ref-DOBB1995" title="1(3): 5">DOBB1995</a>]
   [<a href="#ref-DOBB1996" title="pages 53-70">DOBB1996</a>] [<a href="#ref-GLRW2010" title='"Advanced Meet-in-the-Middle Preimage Attacks: First Results on Full Tiger, and Improved Results on MD4 and SHA-2"'>GLRW2010</a>] [<a href="#ref-WLDCY2005" title=" Cryptanalysis of Hash Functions MD4 and RIPEMD">WLDCY2005</a>] [<a href="#ref-LUER2008" title="LNCS 5086. Springer">LUER2008</a>].  In fact, RSA, in 1996,
   suggested that MD4 should not be used [<a href="#ref-RSA-AdviceOnMD4" title='"On Recent Results for MD2, MD4 and MD5"'>RSA-AdviceOnMD4</a>].  Microsoft
   also made similar statements [<a href="#ref-MS-AdviceOnMD4" title='"Secure Habits: 8 Simple Rules For Developing More Secure Code"'>MS-AdviceOnMD4</a>].

   In <a href="#section-6">Section 6</a>, this document discusses attacks against MD4 that
   indicate use of MD4 is no longer appropriate when collision
   resistance is required.  <a href="#section-6">Section 6</a> also discusses attacks against
   MD4's pre-image and second pre-image resistance.  Additionally,
   attacks against MD4 used in message authentication with a shared
   secret (i.e., HMAC-MD4) are discussed.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Documents%20that%20Reference%20RFC%201320"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Documents that Reference <a href="rfc1320.html">RFC 1320</a></span>

   Use of MD4 has been specified in the following RFCs:

   Internet Standard (IS):

     o [<a href="rfc2289.html" title='"A One- Time Password System"'>RFC2289</a>] A One-Time Password System.

   Draft Standard (DS):

     o [<a href="rfc1629.html" title='"Guidelines for OSI NSAP Allocation in the Internet"'>RFC1629</a>] Guidelines for OSI NSAP Allocation in the Internet.

   Proposed Standard (PS):

     o [<a href="rfc3961.html" title='"Encryption and Checksum Specifications for Kerberos 5"'>RFC3961</a>] Encryption and Checksum Specifications for Kerberos 5.

   Best Current Practice (BCP):

     o [<a href="rfc4086.html" title='"Randomness Requirements for Security"'>RFC4086</a>] Randomness Requirements for Security.




<span class="grey">Turner &amp; Chen                 Informational                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6150.html">RFC 6150</a>                 MD2 to Historic Status               March 2011</span>


   Informational:

     o [<a href="rfc1760.html" title='"The S/KEY One-Time Password System"'>RFC1760</a>] The S/KEY One-Time Password System.

     o [<a href="rfc1983.html" title="&quot;Internet Users' Glossary&quot;">RFC1983</a>] Internet Users' Glossary.

     o [<a href="rfc2433.html" title='"Microsoft PPP CHAP Extensions"'>RFC2433</a>] Microsoft PPP CHAP Extensions.

     o [<a href="rfc2759.html" title='"Microsoft PPP CHAP Extensions, Version 2"'>RFC2759</a>] Microsoft PPP CHAP Extensions, Version 2.

     o [<a href="rfc3174.html" title='"US Secure Hash Algorithm 1 (SHA1)"'>RFC3174</a>] US Secure Hash Algorithm 1 (SHA1).

     o [<a href="rfc4757.html" title='"The RC4-HMAC Kerberos Encryption Types Used by Microsoft Windows"'>RFC4757</a>] The RC4-HMAC Kerberos Encryption Types Used by
                 Microsoft Windows.

     o [<a href="rfc5126.html" title='"CMS Advanced Electronic Signatures (CAdES)"'>RFC5126</a>] CMS Advanced Electronic Signatures (CAdES).

   There are other RFCs that refer to MD2, but they have been either
   moved to Historic status or obsoleted by a later RFC.  References and
   discussions about these RFCs are omitted.  The notable exceptions
   are:

     o [<a href="rfc2313.html" title='"PKCS #1: RSA Encryption Version 1.5"'>RFC2313</a>] PKCS #1: RSA Encryption Version 1.5.

     o [<a href="rfc2437.html" title='"PKCS #1: RSA Cryptography Specifications Version 2.0"'>RFC2437</a>] PKCS #1: RSA Cryptography Specifications Version 2.0.

     o [<a href="rfc3447.html" title='"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1"'>RFC3447</a>] Public-Key Cryptography Standards (PKCS) #1: RSA
               Cryptography Specifications Version 2.1.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Impact%20of%20Moving%20MD4%20to%20Historic"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Impact of Moving MD4 to Historic</span>

   The impact of moving MD4 to Historic is minimal with the one
   exception of Microsoft's use of MD4 as part of RC4-HMAC in Windows,
   as described below.

   Regarding DS, PS, and BCP RFCs:

   o The initial One-Time Password systems, based on [<a href="rfc2289.html" title='"A One- Time Password System"'>RFC2289</a>], have
     ostensibly been replaced by HMAC-based mechanism, as specified in
     "HOTP: An HMAC-Based One-Time Password Algorithm" [<a href="rfc4226.html" title='"HOTP: An HMAC-Based One-Time Password Algorithm"'>RFC4226</a>].
     [<a href="rfc4226.html" title='"HOTP: An HMAC-Based One-Time Password Algorithm"'>RFC4226</a>] suggests following recommendations in [<a href="rfc4086.html" title='"Randomness Requirements for Security"'>RFC4086</a>] for
     random input, and in [<a href="rfc4086.html" title='"Randomness Requirements for Security"'>RFC4086</a>] weaknesses of MD4 are discussed.

   o MD4 was used in the Inter-Domain Routing Protocol (IDRP); each IDRP
     message carries a 16-octet hash that is computed by applying the
     MD-4 algorithm (<a href="rfc1320.html">RFC 1320</a>) to the context of the message itself.
     Over time, IDRP was replaced by BGP-4 [<a href="rfc4271.html" title='"A Border Gateway Protocol 4 (BGP-4)"'>RFC4271</a>], which required at
     least [<a href="#ref-MD5" title='"The MD5 Message-Digest Algorithm"'>MD5</a>].



<span class="grey">Turner &amp; Chen                 Informational                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6150.html">RFC 6150</a>                 MD2 to Historic Status               March 2011</span>


   o Kerberos Version 5 [<a href="rfc3961.html" title='"Encryption and Checksum Specifications for Kerberos 5"'>RFC3961</a>] specifies the use of MD4 for DES
     encryption types and checksum types.  They were specified, never
     really used, and are in the process of being deprecated by
     [<a href="#ref-DES-DIE" title='"Deprecate DES support for Kerberos"'>DES-DIE</a>].  Further, the mandatory-to-implement encrypted types and
     checksum types specified by Kerberos are based on AES-256 and HMAC-
     SHA1 [<a href="rfc3962.html" title='"Advanced Encryption Standard (AES) Encryption for Kerberos 5"'>RFC3962</a>].

   Regarding Informational RFCs:

   o PKCS#1 v1.5 [<a href="rfc2313.html" title='"PKCS #1: RSA Encryption Version 1.5"'>RFC2313</a>] indicated that there was no reason to not use
     MD4.  PKCS#1 v2.0 [<a href="rfc2437.html" title='"PKCS #1: RSA Cryptography Specifications Version 2.0"'>RFC2437</a>] and v2.1 [<a href="rfc3447.html" title='"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1"'>RFC3447</a>] recommend against
     MD4 due to cryptoanalytic progress having uncovered weaknesses in
     the collision resistance of MD4.

   o Randomness Requirements [<a href="rfc4086.html" title='"Randomness Requirements for Security"'>RFC4086</a>] does mention MD4, but not in a
     good way; it explains how the algorithm works and that there have
     been a number of attacks found against it.

   o The "Internet Users' Glossary" [<a href="rfc1983.html" title="&quot;Internet Users' Glossary&quot;">RFC1983</a>] provided a definition for
     Message Digest and listed MD4 as one example.

   o The IETF OTP specification [<a href="rfc2289.html" title='"A One- Time Password System"'>RFC2289</a>] was based on S/KEY technology.
     So S/KEY was replaced by OTP, at least in theory.  Additionally,
     the S/KEY implementations in the wild have started to use MD5 in
     lieu of MD4.

   o The CAdES document [<a href="rfc5126.html" title='"CMS Advanced Electronic Signatures (CAdES)"'>RFC5126</a>] lists MD4 as a hash algorithm,
     disparages it, and then does not mention it again.

   o The SHA-1 document [<a href="rfc3174.html" title='"US Secure Hash Algorithm 1 (SHA1)"'>RFC3174</a>] mentions MD4 in the acknowledgements
     section.

   o The three RFCs describing Microsoft protocols, [<a href="rfc2433.html" title='"Microsoft PPP CHAP Extensions"'>RFC2433</a>],
     [<a href="rfc2759.html" title='"Microsoft PPP CHAP Extensions, Version 2"'>RFC2759</a>], and [<a href="rfc4757.html" title='"The RC4-HMAC Kerberos Encryption Types Used by Microsoft Windows"'>RFC4757</a>], are very widely deployed as MS-CHAP v1,
     MS-CHAP v2, and RC4-HMAC, respectively.

      o MS-CHAP Version 1 is supported in Microsoft's Windows XP, 2000,
        98, 95, NT 4.0, NT 3.51, and NT 3.5, but support has been
        dropped in Vista.  MS-CHAP Version 2 is supported in Microsoft's
        Windows 7, Vista, XP, 2000, 98, 95, and NT 4.0.  Both versions
        of MS-CHAP are also supported by RADIUS [<a href="rfc2548.html" title='"Microsoft Vendor-specific RADIUS Attributes"'>RFC2548</a>] and the
        Extensible Authentication Protocol (EAP) [<a href="rfc5281.html" title='"Extensible Authentication Protocol Tunneled Transport Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0)"'>RFC5281</a>].  In 2007,
        [<a href="rfc4962.html" title='"Guidance for Authentication, Authorization, and Accounting (AAA) Key Management"'>RFC4962</a>] listed MS-CHAP v1 and v2 as flawed and recommended
        against their use; these incidents were presented as a strong
        indication for the necessity of built-in crypto-algorithm
        agility in Authentication, Authorization, and Accounting (AAA)
        protocols.




<span class="grey">Turner &amp; Chen                 Informational                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6150.html">RFC 6150</a>                 MD2 to Historic Status               March 2011</span>


      o The RC4-HMAC is supported in Microsoft's Windows 2000 and later
        versions of Windows for backwards compatibility with Windows
        2000.  As [<a href="rfc4757.html" title='"The RC4-HMAC Kerberos Encryption Types Used by Microsoft Windows"'>RFC4757</a>] stated, RC4-HMAC doesn't rely on the
        collision resistance property of MD4, but uses it to generate a
        key from a password, which is then used as input to HMAC-MD5.
        For an attacker to recover the password from RC4-HMAC, the
        attacker first needs to recover the key that is used with HMAC-
        MD5.  As noted in [<a href="rfc6151.html" title='"Updated Security Considerations for the MD5 Message-Digest and the HMAC-MD5 Algorithms"'>RFC6151</a>], key recovery attacks on HMAC-MD5
        are not yet practical.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Other%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Other Considerations</span>

   rsync [<a href="#ref-RSYNC">RSYNC</a>], a non-IETF protocol, once specified the use of MD4,
   but as of version 3.0.0 published in 2008, it has adopted MD5 [<a href="#ref-MD5" title='"The MD5 Message-Digest Algorithm"'>MD5</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Security Considerations</span>

   This section addresses attacks against MD4's collisions, pre-image,
   and second pre-image resistance.  Additionally, attacks against HMAC-
   MD4 are discussed.

   Some may find the guidance for key lengths and algorithm strengths in
   [<a href="#ref-SP800-57" title=" Special Publication 800-57: Recommendation for Key Management - Part 1 (Revised)">SP800-57</a>] and [<a href="#ref-SP800-131" title=" Special Publication 800-131: DRAFT Recommendation for the Transitioning of Cryptographic Algorithms and Key Sizes">SP800-131</a>] useful.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Collision%20Resistance"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Collision Resistance</span>

   A practical attack on MD4 was shown by Dobbertin in 1996 with
   complexity 2^20 of MD4 hash computations [<a href="#ref-DOBB1996" title="pages 53-70">DOBB1996</a>].  In 2004, a more
   devastating result presented by Xiaoyun Wang showed that the
   complexity can be reduced to 2^8 of MD4 hash operations.  At the Rump
   Session of Crypto 2004, Wang said that as a matter of fact, finding a
   collision of MD4 can be accomplished with a pen on a piece of paper.
   The formal result was presented at EUROCRYPT 2005 in [<a href="#ref-WLDCY2005" title=" Cryptanalysis of Hash Functions MD4 and RIPEMD">WLDCY2005</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Pre-Image%20and%20Second%20Pre-Image%20Resistance"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Pre-Image and Second Pre-Image Resistance</span>

   The first pre-image attack on full MD4 was accomplished in [<a href="#ref-LUER2008" title="LNCS 5086. Springer">LUER2008</a>]
   with complexity 2^100.  Some improvements are shown on pre-image
   attacks and second pre-image attacks of MD4 with certain pre-
   computations [<a href="#ref-GLRW2010" title='"Advanced Meet-in-the-Middle Preimage Attacks: First Results on Full Tiger, and Improved Results on MD4 and SHA-2"'>GLRW2010</a>], where complexity is reduced to 2^78.4 and
   2^69.4 for pre-image and second pre-image, respectively.  The pre-
   image attacks on MD4 are practical.  It cannot be used as a one-way
   function.  For example, it must not be used to hash a cryptographic
   key of 80 bits or longer.







<span class="grey">Turner &amp; Chen                 Informational                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6150.html">RFC 6150</a>                 MD2 to Historic Status               March 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20HMAC"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  HMAC</span>

   The attacks on Hash-based Message Authentication Code (HMAC)
   algorithms [<a href="rfc2104.html" title='"HMAC: Keyed- Hashing for Message Authentication"'>RFC2104</a>] presented so far can be classified in three
   types: distinguishing attacks, existential forgery attacks, and key
   recovery attacks.  Of course, among all these attacks, key recovery
   attacks are the most severe attacks.

   The best results on key recovery attacks on HMAC-MD4 were published
   at EUROCRYPT 2008 with 2^72 queries and 2^77 MD4 computations
   [<a href="#ref-WOK2008" title="and N. Kunihiro">WOK2008</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Recommendation"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Recommendation</span>

   Despite MD4 seeing some deployment on the Internet, this
   specification obsoletes [<a href="#ref-MD4" title='"The MD4 Message-Digest Algorithm"'>MD4</a>] because MD4 is not a reasonable
   candidate for further standardization and should be deprecated in
   favor of one or more existing hash algorithms (e.g., SHA-256 [<a href="#ref-SHS" title=" FIPS Publication 180-3: Secure Hash Standard">SHS</a>]).

   RSA Security considers it appropriate to move the MD4 algorithm to
   Historic status.

   It takes a number of years to deploy crypto and it also takes a
   number of years to withdraw it.  Algorithms need to be withdrawn
   before a catastrophic break is discovered.  MD4 is clearly showing
   signs of weakness, and implementations should strongly consider
   removing support and migrating to another hash algorithm.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Acknowledgements"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Acknowledgements</span>

   We'd like to thank RSA for publishing MD4.  Obviously, we have to
   thank all the cryptographers who produced the results we refer to in
   this document.  We'd also like to thank Ran Atkinson, Sue Hares, Sam
   Hartman, Alfred Hoenes, John Linn, Catherine Meadows, Magnus Nystrom,
   and Martin Rex for their input.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Informative%20References"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Informative References</span>

   [<a id="ref-denBORBOS1992" name="ref-denBORBOS1992">denBORBOS1992</a>]
               B. den Boer and A. Bosselaers.  An attack on the last two
               rounds of MD4.  In Advances in Cryptology - Crypto '91,
               pages 194-203, Springer-Verlag, 1992.

   [<a id="ref-DES-DIE" name="ref-DES-DIE">DES-DIE</a>]   Astrand, L., <a href="https://www.google.com/search?sitesearch=tools.ietf.org%2Fhtml%2F&amp;q=inurl:draft-+%22Deprecate+DES+support+for+Kerberos%22" style="text-decoration: none">"Deprecate DES support for Kerberos"</a>, Work
               in Progress, July 2010.

   [<a id="ref-DOBB1995" name="ref-DOBB1995">DOBB1995</a>]  H. Dobbertin.  Alf swindles Ann.  CryptoBytes, 1(3): 5,
               1995.



<span class="grey">Turner &amp; Chen                 Informational                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6150.html">RFC 6150</a>                 MD2 to Historic Status               March 2011</span>


   [<a id="ref-DOBB1996" name="ref-DOBB1996">DOBB1996</a>]  H. Dobbertin.  Cryptanalysis of MD4.  In Proceedings of
               the 3rd Workshop on Fast Software Encryption, Cambridge,
               U.K., pages 53-70, Lecture Notes in Computer Science
               1039, Springer-Verlag, 1996.

   [<a id="ref-GLRW2010" name="ref-GLRW2010">GLRW2010</a>]  Guo, J., Ling, S., Rechberger, C., and H. Wang, "Advanced
               Meet-in-the-Middle Preimage Attacks: First Results on
               Full Tiger, and Improved Results on MD4 and SHA-2",
               <a href="http://eprint.iacr.org/2010/016.pdf">http://eprint.iacr.org/2010/016.pdf</a>.

   [<a id="ref-HASH-Attack" name="ref-HASH-Attack">HASH-Attack</a>]
               Hoffman, P. and B. Schneier, "Attacks on Cryptographic
               Hashes in Internet Protocols", <a href="rfc4270.html">RFC 4270</a>, November 2005.

   [<a id="ref-LUER2008" name="ref-LUER2008">LUER2008</a>]  G. Leurent.  MD4 is Not One-Way.  Fast Software
               Encryption 2008, Lausanne, Switzerland, February 10-13,
               2008, LNCS 5086.  Springer, 2008.

   [<a id="ref-MD4" name="ref-MD4">MD4</a>]       Rivest, R., "The MD4 Message-Digest Algorithm", <a href="rfc1320.html">RFC 1320</a>,
               April 1992.

   [<a id="ref-MD5" name="ref-MD5">MD5</a>]       Rivest, R., "The MD5 Message-Digest Algorithm", <a href="rfc1321.html">RFC 1321</a>,
               April 1992.

   [<a id="ref-MS-AdviceOnMD4" name="ref-MS-AdviceOnMD4">MS-AdviceOnMD4</a>]
               Howard, M., "Secure Habits: 8 Simple Rules For Developing
               More Secure Code", <a href="http://msdn.microsoft.com/en-us/magazine/cc163518.aspx#S6">http://msdn.microsoft.com/</a>
               <a href="http://msdn.microsoft.com/en-us/magazine/cc163518.aspx#S6">en-us/magazine/cc163518.aspx#S6</a>.

   [<a id="ref-RFC1629" name="ref-RFC1629">RFC1629</a>]   Colella, R., Callon, R., Gardner, E., and Y. Rekhter,
               "Guidelines for OSI NSAP Allocation in the Internet", <a href="rfc1629.html">RFC</a>
               <a href="rfc1629.html">1629</a>, May 1994.

   [<a id="ref-RFC1760" name="ref-RFC1760">RFC1760</a>]   Haller, N., "The S/KEY One-Time Password System", <a href="rfc1760.html">RFC</a>
               <a href="rfc1760.html">1760</a>, February 1995.

   [<a id="ref-RFC1983" name="ref-RFC1983">RFC1983</a>]   Malkin, G., Ed., "Internet Users' Glossary", FYI 18, <a href="rfc1983.html">RFC</a>
               <a href="rfc1983.html">1983</a>, August 1996.

   [<a id="ref-RFC2104" name="ref-RFC2104">RFC2104</a>]   Krawczyk, H., Bellare, M., and R. Canetti, "HMAC: Keyed-
               Hashing for Message Authentication", <a href="rfc2104.html">RFC 2104</a>, February
               1997.

   [<a id="ref-RFC2289" name="ref-RFC2289">RFC2289</a>]   Haller, N., Metz, C., Nesser, P., and M. Straw, "A One-
               Time Password System", STD 61, <a href="rfc2289.html">RFC 2289</a>, February 1998.

   [<a id="ref-RFC2313" name="ref-RFC2313">RFC2313</a>]   Kaliski, B., "PKCS #1: RSA Encryption Version 1.5", <a href="rfc2313.html">RFC</a>
               <a href="rfc2313.html">2313</a>, March 1998.



<span class="grey">Turner &amp; Chen                 Informational                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6150.html">RFC 6150</a>                 MD2 to Historic Status               March 2011</span>


   [<a id="ref-RFC2433" name="ref-RFC2433">RFC2433</a>]   Zorn, G. and S. Cobb, "Microsoft PPP CHAP Extensions",
               <a href="rfc2433.html">RFC 2433</a>, October 1998.

   [<a id="ref-RFC2437" name="ref-RFC2437">RFC2437</a>]   Kaliski, B., and J. Staddon, "PKCS #1: RSA  Cryptography
               Specifications Version 2.0", <a href="rfc2437.html">RFC 2437</a>, October 1998.

   [<a id="ref-RFC2548" name="ref-RFC2548">RFC2548</a>]   Zorn, G., "Microsoft Vendor-specific RADIUS Attributes",
               <a href="rfc2548.html">RFC 2548</a>, March 1999.

   [<a id="ref-RFC2759" name="ref-RFC2759">RFC2759</a>]   Zorn, G., "Microsoft PPP CHAP Extensions, Version 2", <a href="rfc2759.html">RFC</a>
               <a href="rfc2759.html">2759</a>, January 2000.

   [<a id="ref-RFC3174" name="ref-RFC3174">RFC3174</a>]   Eastlake 3rd, D. and P. Jones, "US Secure Hash Algorithm
               1 (SHA1)", <a href="rfc3174.html">RFC 3174</a>, September 2001.

   [<a id="ref-RFC3447" name="ref-RFC3447">RFC3447</a>]   Jonsson, J. and B. Kaliski, "Public-Key Cryptography
               Standards (PKCS) #1: RSA Cryptography Specifications
               Version 2.1", <a href="rfc3447.html">RFC 3447</a>, February 2003.

   [<a id="ref-RFC3961" name="ref-RFC3961">RFC3961</a>]   Raeburn, K., "Encryption and Checksum Specifications for
               Kerberos 5", <a href="rfc3961.html">RFC 3961</a>, February 2005.

   [<a id="ref-RFC3962" name="ref-RFC3962">RFC3962</a>]   Raeburn, K., "Advanced Encryption Standard (AES)
               Encryption for Kerberos 5", <a href="rfc3962.html">RFC 3962</a>, February 2005.

   [<a id="ref-RFC4086" name="ref-RFC4086">RFC4086</a>]   Eastlake 3rd, D., Schiller, J., and S. Crocker,
               "Randomness Requirements for Security", <a href="https://tools.ietf.org/html/bcp106">BCP 106</a>, <a href="rfc4086.html">RFC</a>
               <a href="rfc4086.html">4086</a>, June 2005.

   [<a id="ref-RFC4226" name="ref-RFC4226">RFC4226</a>]   M'Raihi, D., Bellare, M., Hoornaert, F., Naccache, D.,
               and O. Ranen, "HOTP: An HMAC-Based One-Time Password
               Algorithm", <a href="rfc4226.html">RFC 4226</a>, December 2005.

   [<a id="ref-RFC4271" name="ref-RFC4271">RFC4271</a>]   Rekhter, Y., Ed., Li, T., Ed., and S. Hares, Ed., "A
               Border Gateway Protocol 4 (BGP-4)", <a href="rfc4271.html">RFC 4271</a>, January
               2006.

   [<a id="ref-RFC4757" name="ref-RFC4757">RFC4757</a>]   Jaganathan, K., Zhu, L., and J. Brezak, "The RC4-HMAC
               Kerberos Encryption Types Used by Microsoft Windows", <a href="rfc4757.html">RFC</a>
               <a href="rfc4757.html">4757</a>, December 2006.

   [<a id="ref-RFC4962" name="ref-RFC4962">RFC4962</a>]   Housley, R. and B. Aboba, "Guidance for Authentication,
               Authorization, and Accounting (AAA) Key Management", <a href="https://tools.ietf.org/html/bcp132">BCP</a>
               <a href="https://tools.ietf.org/html/bcp132">132</a>, <a href="rfc4962.html">RFC 4962</a>, July 2007.

   [<a id="ref-RFC5126" name="ref-RFC5126">RFC5126</a>]   Pinkas, D., Pope, N., and J. Ross, "CMS Advanced
               Electronic Signatures (CAdES)", <a href="rfc5126.html">RFC 5126</a>, March 2008.




<span class="grey">Turner &amp; Chen                 Informational                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6150.html">RFC 6150</a>                 MD2 to Historic Status               March 2011</span>


   [<a id="ref-RFC5281" name="ref-RFC5281">RFC5281</a>]   Funk, P. and S. Blake-Wilson, "Extensible Authentication
               Protocol Tunneled Transport Layer Security Authenticated
               Protocol Version 0 (EAP-TTLSv0)", <a href="rfc5281.html">RFC 5281</a>, August 2008.

   [<a id="ref-RFC6151" name="ref-RFC6151">RFC6151</a>]   Turner, S. and L. Chen, "Updated Security Considerations
               for the MD5 Message-Digest and the HMAC-MD5 Algorithms",
               <a href="rfc6151.html">RFC 6151</a>, March 2011.

   [<a id="ref-RSA-AdviceOnMD4" name="ref-RSA-AdviceOnMD4">RSA-AdviceOnMD4</a>]
               Robshaw, M.J.B., "On Recent Results for MD2, MD4 and
               MD5", November 1996,
               <a href="ftp://ftp.rsasecurity.com/pub/pdfs/bulletn4.pdf">ftp://ftp.rsasecurity.com/pub/pdfs/bulletn4.pdf</a>.

   [<a id="ref-RSYNC" name="ref-RSYNC">RSYNC</a>]     rsync web pages, <a href="http://www.samba.org/rsync/">http://www.samba.org/rsync/</a>.

   [<a id="ref-SHS" name="ref-SHS">SHS</a>]       National Institute of Standards and Technology (NIST),
               FIPS Publication 180-3: Secure Hash Standard, October
               2008.

   [<a id="ref-SP800-57" name="ref-SP800-57">SP800-57</a>]  National Institute of Standards and Technology (NIST),
               Special Publication 800-57: Recommendation for Key
               Management - Part 1 (Revised), March 2007.

   [<a id="ref-SP800-131" name="ref-SP800-131">SP800-131</a>] National Institute of Standards and Technology (NIST),
               Special Publication 800-131: DRAFT Recommendation for the
               Transitioning of Cryptographic Algorithms and Key Sizes,
               June 2010.

   [<a id="ref-WLDCY2005" name="ref-WLDCY2005">WLDCY2005</a>] X. Wang, X. Lai, D. Feng, H. Chen, and X. Yu,
               Cryptanalysis of Hash Functions MD4 and RIPEMD, LNCS
               3944, Advances in Cryptology - EUROCRYPT2005, Springer,
               2005.

   [<a id="ref-WOK2008" name="ref-WOK2008">WOK2008</a>]   L. Wang, K. Ohta, and N. Kunihiro, New Key-recovery
               Attacks on HMAC/NMAC-MD4 and NMAC-MD5, EUROCRYPT 2008,
               LNCS 4965, Springer, 2008.















<span class="grey">Turner &amp; Chen                 Informational                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6150.html">RFC 6150</a>                 MD2 to Historic Status               March 2011</span>


Authors' Addresses

   Sean Turner
   IECA, Inc.
   3057 Nutley Street, Suite 106
   Fairfax, VA 22031
   USA

   EMail: turners@ieca.com

   Lily Chen
   National Institute of Standards and Technology
   100 Bureau Drive, Mail Stop 8930
   Gaithersburg, MD 20899-8930
   USA

   EMail: lily.chen@nist.gov


































Turner &amp; Chen                 Informational                    [Page 10]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.127, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc6150 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Aug 2018 14:22:42 GMT --></html>