<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc5448 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Aug 2018 14:27:34 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.127" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:5448" name="DC.Identifier"/>
<meta content="This specification defines a new EAP method, EAP-AKA', a small
revision of the EAP-AKA method. The change is a new key derivation
function that binds the name of the access network to the keys derived
within the method. The new key derivation mechanism has been defined
in 3GPP. This specification allows its use in EAP in an interoperable
manner. In addition, EAP-AKA' employs a new hash function, SHA256.
This specification also updates RFC 4187 EAP-AKA to add support for
preventing bidding down attacks between itself and EAP-AKA'." name="DC.Description.Abstract"/>
<meta content="Arkko, Jari" name="DC.Creator"/>
<meta content="Lehtovirta, Vesa" name="DC.Creator"/>
<meta content="Eronen, Pasi" name="DC.Creator"/>
<meta content="May, 2009" name="DC.Date.Issued"/>
<meta content="Improved Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA')" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5448 - Improved Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA')</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc5448.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc5448" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-arkko-eap-aka-kdf" title="draft-arkko-eap-aka-kdf">draft-arkko-eap...</a>] [<a href="https://datatracker.ietf.org/doc/rfc5448" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5448" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc5448" title="Side-by-side diff">Diff2</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=5448&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>]   </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                           J. Arkko
Request for Comments: 5448                                 V. Lehtovirta
Updates: <a href="rfc4187.html">4187</a>                                                   Ericsson
Category: Informational                                        P. Eronen
                                                                   Nokia
                                                                May 2009


        <span class="h1">Improved Extensible Authentication Protocol Method for</span>
       <span class="h1">3rd Generation Authentication and Key Agreement (EAP-AKA')</span>

Status of This Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Copyright Notice

   Copyright (c) 2009 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents in effect on the date of
   publication of this document (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>).
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.

Abstract

   This specification defines a new EAP method, EAP-AKA', which is a
   small revision of the EAP-AKA (Extensible Authentication Protocol
   Method for 3rd Generation Authentication and Key Agreement) method.
   The change is a new key derivation function that binds the keys
   derived within the method to the name of the access network.  The new
   key derivation mechanism has been defined in the 3rd Generation
   Partnership Project (3GPP).  This specification allows its use in EAP
   in an interoperable manner.  In addition, EAP-AKA' employs SHA-256
   instead of SHA-1.

   This specification also updates <a href="rfc4187.html">RFC 4187</a>, EAP-AKA, to prevent bidding
   down attacks from EAP-AKA'.









<span class="grey">Arkko, et al.                Informational                      [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-2">2</a>
   <a href="#section-2">2</a>.  Requirements Language  . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  EAP-AKA' . . . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-3.1">3.1</a>.  AT_KDF_INPUT . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-3.2">3.2</a>.  AT_KDF . . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
     <a href="#section-3.3">3.3</a>.  Key Generation . . . . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
     <a href="#section-3.4">3.4</a>.  Hash Functions . . . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
       <a href="#section-3.4.1">3.4.1</a>.  PRF' . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
       <a href="#section-3.4.2">3.4.2</a>.  AT_MAC . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
       <a href="#section-3.4.3">3.4.3</a>.  AT_CHECKCODE . . . . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
   <a href="#section-4">4</a>.  Bidding Down Prevention for EAP-AKA  . . . . . . . . . . . . . <a href="#page-14">14</a>
   <a href="#section-5">5</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
     <a href="#section-5.1">5.1</a>.  Security Properties of Binding Network Names . . . . . . . <a href="#page-18">18</a>
   <a href="#section-6">6</a>.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . <a href="#page-19">19</a>
     <a href="#section-6.1">6.1</a>.  Type Value . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-19">19</a>
     <a href="#section-6.2">6.2</a>.  Attribute Type Values  . . . . . . . . . . . . . . . . . . <a href="#page-19">19</a>
     <a href="#section-6.3">6.3</a>.  Key Derivation Function Namespace  . . . . . . . . . . . . <a href="#page-19">19</a>
   <a href="#section-7">7</a>.  Contributors . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
   <a href="#section-8">8</a>.  Acknowledgments  . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
   <a href="#section-9">9</a>.  References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
     <a href="#section-9.1">9.1</a>.  Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
     <a href="#section-9.2">9.2</a>.  Informative References . . . . . . . . . . . . . . . . . . <a href="#page-21">21</a>
   <a href="#appendix-A">Appendix A</a>.  Changes from <a href="rfc4187.html">RFC 4187</a> . . . . . . . . . . . . . . . . <a href="#page-23">23</a>
   <a href="#appendix-B">Appendix B</a>.  Importance of Explicit Negotiation  . . . . . . . . . <a href="#page-23">23</a>
   <a href="#appendix-C">Appendix C</a>.  Test Vectors  . . . . . . . . . . . . . . . . . . . . <a href="#page-24">24</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   This specification defines a new Extensible Authentication Protocol
   (EAP)[<a href="rfc3748.html" title='"Extensible Authentication Protocol (EAP)"'>RFC3748</a>] method, EAP-AKA', which is a small revision of the
   EAP-AKA method originally defined in [<a href="rfc4187.html" title='"Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)"'>RFC4187</a>].  What is new in EAP-
   AKA' is that it has a new key derivation function, specified in
   [<a href="#ref-3GPP.33.402" title='"3GPP System Architecture Evolution (SAE); Security aspects of non-3GPP accesses; Release 8"'>3GPP.33.402</a>].  This function binds the keys derived within the
   method to the name of the access network.  This limits the effects of
   compromised access network nodes and keys.  This specification
   defines the EAP encapsulation for AKA when the new key derivation
   mechanism is in use.

   3GPP has defined a number of applications for the revised AKA
   mechanism, some based on native encapsulation of AKA over 3GPP radio
   access networks and others based on the use of EAP.

   For making the new key derivation mechanisms usable in EAP-AKA,
   additional protocol mechanisms are necessary.  Given that <a href="rfc4187.html">RFC 4187</a>
   calls for the use of CK (the encryption key) and IK (the integrity
   key) from AKA, existing implementations continue to use these.  Any



<span class="grey">Arkko, et al.                Informational                      [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   change of the key derivation must be unambiguous to both sides in the
   protocol.  That is, it must not be possible to accidentally connect
   old equipment to new equipment and get the key derivation wrong or
   attempt to use wrong keys without getting a proper error message.
   The change must also be secure against bidding down attacks that
   attempt to force the participants to use the least secure mechanism.

   This specification therefore introduces a variant of the EAP-AKA
   method, called EAP-AKA'.  This method can employ the derived keys CK'
   and IK' from the 3GPP specification and updates the used hash
   function to SHA-256 [<a href="#ref-FIPS.180-2.2002" title='"Secure Hash Standard"'>FIPS.180-2.2002</a>].  But it is otherwise
   equivalent to <a href="rfc4187.html">RFC 4187</a>.  Given that a different EAP method type value
   is used for EAP-AKA and EAP-AKA', a mutually supported method may be
   negotiated using the standard mechanisms in EAP [<a href="rfc3748.html" title='"Extensible Authentication Protocol (EAP)"'>RFC3748</a>].

      Note: <a href="#appendix-B">Appendix B</a> explains why it is important to be explicit about
      the change of semantics for the keys, and why other approaches
      would lead to severe interoperability problems.

   The rest of this specification is structured as follows.  <a href="#section-3">Section 3</a>
   defines the EAP-AKA' method.  <a href="#section-4">Section 4</a> adds support to EAP-AKA to
   prevent bidding down attacks from EAP-AKA'.  <a href="#section-5">Section 5</a> explains the
   security differences between EAP-AKA and EAP-AKA'.  <a href="#section-6">Section 6</a>
   describes the IANA considerations and <a href="#appendix-A">Appendix A</a> explains what
   updates to <a href="rfc4187.html">RFC 4187</a> EAP-AKA have been made in this specification.
   <a href="#appendix-B">Appendix B</a> explains some of the design rationale for creating EAP-
   AKA'.  Finally, <a href="#appendix-C">Appendix C</a> provides test vectors.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Requirements%20Language"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Requirements Language</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20EAP-AKA%27"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  EAP-AKA'</span>

   EAP-AKA' is a new EAP method that follows the EAP-AKA specification
   [<a href="rfc4187.html" title='"Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)"'>RFC4187</a>] in all respects except the following:

   o  It uses the Type code 50, not 23 (which is used by EAP-AKA).

   o  It carries the AT_KDF_INPUT attribute, as defined in <a href="#section-3.1">Section 3.1</a>,
      to ensure that both the peer and server know the name of the
      access network.

   o  It supports key derivation function negotiation via the AT_KDF
      attribute (<a href="#section-3.2">Section 3.2</a>) to allow for future extensions.




<span class="grey">Arkko, et al.                Informational                      [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   o  It calculates keys as defined in <a href="#section-3.3">Section 3.3</a>, not as defined in
      EAP-AKA.

   o  It employs SHA-256 [<a href="#ref-FIPS.180-2.2002" title='"Secure Hash Standard"'>FIPS.180-2.2002</a>], not SHA-1 [<a href="#ref-FIPS.180-1.1995" title='"Secure Hash Standard"'>FIPS.180-1.1995</a>]
      (<a href="#section-3.4">Section 3.4</a>).

   Figure 1 shows an example of the authentication process.  Each
   message AKA'-Challenge and so on represents the corresponding message
   from EAP-AKA, but with EAP-AKA' Type code.  The definition of these
   messages, along with the definition of attributes AT_RAND, AT_AUTN,
   AT_MAC, and AT_RES can be found in [<a href="rfc4187.html" title='"Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)"'>RFC4187</a>].








































<span class="grey">Arkko, et al.                Informational                      [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


    Peer                                                    Server
       |                       EAP-Request/Identity             |
       |&lt;-------------------------------------------------------|
       |                                                        |
       |  EAP-Response/Identity                                 |
       |  (Includes user's Network Access Identifier, NAI)      |
       |-------------------------------------------------------&gt;|
       |         +--------------------------------------------------+
       |         | Server determines the network name and ensures   |
       |         | that the given access network is authorized to   |
       |         | use the claimed name.  The server then runs the  |
       |         | AKA' algorithms generating RAND and AUTN, and    |
       |         | derives session keys from CK' and IK'.  RAND and |
       |         | AUTN are sent as AT_RAND and AT_AUTN attributes, |
       |         | whereas the network name is transported in the   |
       |         | AT_KDF_INPUT attribute.  AT_KDF signals the used |
       |         | key derivation function.  The session keys are   |
       |         | used in creating the AT_MAC attribute.           |
       |         +--------------------------------------------------+
       |                         EAP-Request/AKA'-Challenge     |
       |        (AT_RAND, AT_AUTN, AT_KDF, AT_KDF_INPUT, AT_MAC)|
       |&lt;-------------------------------------------------------|
   +------------------------------------------------------+     |
   | The peer determines what the network name should be, |     |
   | based on, e.g., what access technology it is using.  |     |
   | The peer also retrieves the network name sent by     |     |
   | the network from the AT_KDF_INPUT attribute.  The    |     |
   | two names are compared for discrepancies, and if     |     |
   | necessary, the authentication is aborted.  Otherwise,|     |
   | the network name from AT_KDF_INPUT attribute is      |     |
   | used in running the AKA' algorithms, verifying AUTN  |     |
   | from AT_AUTN and MAC from AT_MAC attributes.  The    |     |
   | peer then generates RES.  The peer also derives      |     |
   | session keys from CK'/IK'.  The AT_RES and AT_MAC    |     |
   | attributes are constructed.                          |     |
   +------------------------------------------------------+     |
       | EAP-Response/AKA'-Challenge                            |
       | (AT_RES, AT_MAC)                                       |
       |-------------------------------------------------------&gt;|
       |         +-------------------------------------------------+
       |         | Server checks the RES and MAC values received    |
       |         | in AT_RES and AT_MAC, respectively.  Success     |
       |         | requires both to be found correct.               |
       |         +-------------------------------------------------+
       |                                           EAP-Success  |
       |&lt;-------------------------------------------------------|

              Figure 1: EAP-AKA' Authentication Process



<span class="grey">Arkko, et al.                Informational                      [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   EAP-AKA' can operate on the same credentials as EAP-AKA and employ
   the same identities.  However, EAP-AKA' employs different leading
   characters than EAP-AKA for the conventions given in <a href="rfc4187.html#section-4.1.1">Section 4.1.1 of
   [RFC4187]</a> for International Mobile Subscriber Identifier (IMSI) based
   usernames.  EAP-AKA' MUST use the leading character "6" (ASCII 36
   hexadecimal) instead of "0" for IMSI-based permanent usernames.  All
   other usage and processing of the leading characters, usernames, and
   identities is as defined by EAP-AKA [<a href="rfc4187.html" title='"Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)"'>RFC4187</a>].  For instance, the
   pseudonym and fast re-authentication usernames need to be constructed
   so that the server can recognize them.  As an example, a pseudonym
   could begin with a leading "7" character (ASCII 37 hexadecimal) and a
   fast re-authentication username could begin with "8" (ASCII 38
   hexadecimal).  Note that a server that implements only EAP-AKA may
   not recognize these leading characters.  According to <a href="rfc4187.html#section-4.1.4">Section 4.1.4
   of [RFC4187]</a>, such a server will re-request the identity via the EAP-
   Request/AKA-Identity message, making obvious to the peer that EAP-AKA
   and associated identity are expected.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20AT_KDF_INPUT"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  AT_KDF_INPUT</span>

   The format of the AT_KDF_INPUT attribute is shown below.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | AT_KDF_INPUT  | Length        | Actual Network Name Length    |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      .                        Network Name                           .
      .                                                               .
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The fields are as follows:

   AT_KDF_INPUT

      This is set to 23.

   Length

      The length of the attribute, calculated as defined in <a href="rfc4187.html#section-8.1">[RFC4187],
      Section 8.1</a>.








<span class="grey">Arkko, et al.                Informational                      [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   Actual Network Name Length

      This is a 2 byte actual length field, needed due to the
      requirement that the previous field is expressed in multiples of 4
      bytes per the usual EAP-AKA rules.  The Actual Network Name Length
      field provides the length of the network name in bytes.

   Network Name

      This field contains the network name of the access network for
      which the authentication is being performed.  The name does not
      include any terminating null characters.  Because the length of
      the entire attribute must be a multiple of 4 bytes, the sender
      pads the name with 1, 2, or 3 bytes of all zero bits when
      necessary.

   Only the server sends the AT_KDF_INPUT attribute.  Per [<a href="#ref-3GPP.33.402" title='"3GPP System Architecture Evolution (SAE); Security aspects of non-3GPP accesses; Release 8"'>3GPP.33.402</a>],
   the server always verifies the authorization of a given access
   network to use a particular name before sending it to the peer over
   EAP-AKA'.  The value of the AT_KDF_INPUT attribute from the server
   MUST be non-empty.  If it is empty, the peer behaves as if AUTN had
   been incorrect and authentication fails.  See <a href="#section-3">Section 3</a> and Figure 3
   of [<a href="rfc4187.html" title='"Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)"'>RFC4187</a>] for an overview of how authentication failures are
   handled.

   In addition, the peer MAY check the received value against its own
   understanding of the network name.  Upon detecting a discrepancy, the
   peer either warns the user and continues, or fails the authentication
   process.  More specifically, the peer SHOULD have a configurable
   policy that it can follow under these circumstances.  If the policy
   indicates that it can continue, the peer SHOULD log a warning message
   or display it to the user.  If the peer chooses to proceed, it MUST
   use the network name as received in the AT_KDF_INPUT attribute.  If
   the policy indicates that the authentication should fail, the peer
   behaves as if AUTN had been incorrect and authentication fails.

   The Network Name field contains a UTF-8 string.  This string MUST be
   constructed as specified in [<a href="#ref-3GPP.24.302" title='"3rd Generation Partnership Project; Technical Specification Group Core Network and Terminals; Access to the 3GPP Evolved Packet Core (EPC) via non-3GPP access networks; Stage 3; (Release 8)"'>3GPP.24.302</a>] for "Access Network
   Identity".  The string is structured as fields separated by colons
   (:).  The algorithms and mechanisms to construct the identity string
   depend on the used access technology.

   On the network side, the network name construction is a configuration
   issue in an access network and an authorization check in the
   authentication server.  On the peer, the network name is constructed
   based on the local observations.  For instance, the peer knows which
   access technology it is using on the link, it can see information in
   a link-layer beacon, and so on.  The construction rules specify how



<span class="grey">Arkko, et al.                Informational                      [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   this information maps to an access network name.  Typically, the
   network name consists of the name of the access technology, or the
   name of the access technology followed by some operator identifier
   that was advertised in a link-layer beacon.  In all cases,
   [<a href="#ref-3GPP.24.302" title='"3rd Generation Partnership Project; Technical Specification Group Core Network and Terminals; Access to the 3GPP Evolved Packet Core (EPC) via non-3GPP access networks; Stage 3; (Release 8)"'>3GPP.24.302</a>] is the normative specification for the construction in
   both the network and peer side.  If the peer policy allows running
   EAP-AKA' over an access technology for which that specification does
   not provide network name construction rules, the peer SHOULD rely
   only on the information from the AT_KDF_INPUT attribute and not
   perform a comparison.

   If a comparison of the locally determined network name and the one
   received over EAP-AKA' is performed on the peer, it MUST be done as
   follows.  First, each name is broken down to the fields separated by
   colons.  If one of the names has more colons and fields than the
   other one, the additional fields are ignored.  The remaining
   sequences of fields are compared, and they match only if they are
   equal character by character.  This algorithm allows a prefix match
   where the peer would be able to match "", "FOO", and "FOO:BAR"
   against the value "FOO:BAR" received from the server.  This
   capability is important in order to allow possible updates to the
   specifications that dictate how the network names are constructed.
   For instance, if a peer knows that it is running on access technology
   "FOO", it can use the string "FOO" even if the server uses an
   additional, more accurate description, e.g., "FOO:BAR", that contains
   more information.

   The allocation procedures in [<a href="#ref-3GPP.24.302" title='"3rd Generation Partnership Project; Technical Specification Group Core Network and Terminals; Access to the 3GPP Evolved Packet Core (EPC) via non-3GPP access networks; Stage 3; (Release 8)"'>3GPP.24.302</a>] ensure that conflicts
   potentially arising from using the same name in different types of
   networks are avoided.  The specification also has detailed rules
   about how a client can determine these based on information available
   to the client, such as the type of protocol used to attach to the
   network, beacons sent out by the network, and so on.  Information
   that the client cannot directly observe (such as the type or version
   of the home network) is not used by this algorithm.

   The AT_KDF_INPUT attribute MUST be sent and processed as explained
   above when AT_KDF attribute has the value 1.  Future definitions of
   new AT_KDF values MUST define how this attribute is sent and
   processed.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20AT_KDF"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  AT_KDF</span>

   AT_KDF is an attribute that the server uses to reference a specific
   key derivation function.  It offers a negotiation capability that can
   be useful for future evolution of the key derivation functions.





<span class="grey">Arkko, et al.                Informational                      [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   The format of the AT_KDF attribute is shown below.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | AT_KDF        | Length        |    Key Derivation Function    |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The fields are as follows:

   AT_KDF

      This is set to 24.

   Length

      The length of the attribute, MUST be set to 1.

   Key Derivation Function

      An enumerated value representing the key derivation function that
      the server (or peer) wishes to use.  Value 1 represents the
      default key derivation function for EAP-AKA', i.e., employing CK'
      and IK' as defined in <a href="#section-3.3">Section 3.3</a>.

   Servers MUST send one or more AT_KDF attributes in the EAP-Request/
   AKA'-Challenge message.  These attributes represent the desired
   functions ordered by preference, the most preferred function being
   the first attribute.

   Upon receiving a set of these attributes, if the peer supports and is
   willing to use the key derivation function indicated by the first
   attribute, the function is taken into use without any further
   negotiation.  However, if the peer does not support this function or
   is unwilling to use it, it does not process the received EAP-Request/
   AKA'-Challenge in any way except by responding with the EAP-Response/
   AKA'-Challenge message that contains only one attribute, AT_KDF with
   the value set to the selected alternative.  If there is no suitable
   alternative, the peer behaves as if AUTN had been incorrect and
   authentication fails (see Figure 3 of [<a href="rfc4187.html" title='"Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)"'>RFC4187</a>]).  The peer fails the
   authentication also if there are any duplicate values within the list
   of AT_KDF attributes (except where the duplication is due to a
   request to change the key derivation function; see below for further
   information).

   Upon receiving an EAP-Response/AKA'-Challenge with AT_KDF from the
   peer, the server checks that the suggested AT_KDF value was one of
   the alternatives in its offer.  The first AT_KDF value in the message



<span class="grey">Arkko, et al.                Informational                      [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   from the server is not a valid alternative.  If the peer has replied
   with the first AT_KDF value, the server behaves as if AT_MAC of the
   response had been incorrect and fails the authentication.  For an
   overview of the failed authentication process in the server side, see
   <a href="#section-3">Section 3</a> and Figure 2 of [<a href="rfc4187.html" title='"Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)"'>RFC4187</a>].  Otherwise, the server re-sends
   the EAP-Response/AKA'-Challenge message, but adds the selected
   alternative to the beginning of the list of AT_KDF attributes and
   retains the entire list following it.  Note that this means that the
   selected alternative appears twice in the set of AT_KDF values.
   Responding to the peer's request to change the key derivation
   function is the only legal situation where such duplication may
   occur.

   When the peer receives the new EAP-Request/AKA'-Challenge message, it
   MUST check that the requested change, and only the requested change,
   occurred in the list of AT_KDF attributes.  If so, it continues with
   processing the received EAP-Request/AKA'-Challenge as specified in
   [<a href="rfc4187.html" title='"Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)"'>RFC4187</a>] and <a href="#section-3.1">Section 3.1</a> of this document.  If not, it behaves as if
   AT_MAC had been incorrect and fails the authentication.  If the peer
   receives multiple EAP-Request/AKA'-Challenge messages with differing
   AT_KDF attributes without having requested negotiation, the peer MUST
   behave as if AT_MAC had been incorrect and fail the authentication.

   Note that the peer may also request sequence number resynchronization
   [<a href="rfc4187.html" title='"Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)"'>RFC4187</a>].  This happens after AT_KDF negotiation has already
   completed.  An AKA'-Synchronization-Failure message is sent as a
   response to the newly received EAP-Request/AKA'-Challenge (the last
   message of the AT_KDF negotiation).  The AKA'-Synchronization-Failure
   message MUST contain the AUTS parameter as specified in [<a href="rfc4187.html" title='"Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)"'>RFC4187</a>] and
   a copy the AT_KDF attributes as they appeared in the last message of
   the AT_KDF negotiation.  If the AT_KDF attributes are found to differ
   from their earlier values, the peer and server MUST behave as if
   AT_MAC had been incorrect and fail the authentication.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Key%20Generation"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Key Generation</span>

   Both the peer and server MUST derive the keys as follows.

   AT_KDF set to 1

      In this case, MK is derived and used as follows:

       MK = PRF'(IK'|CK',"EAP-AKA'"|Identity)
       K_encr = MK[0..127]
       K_aut  = MK[128..383]
       K_re   = MK[384..639]
       MSK    = MK[640..1151]
       EMSK   = MK[1152..1663]



<span class="grey">Arkko, et al.                Informational                     [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   Here [n..m] denotes the substring from bit n to m.  PRF' is a new
   pseudo-random function specified in <a href="#section-3.4">Section 3.4</a>.  The first 1664 bits
   from its output are used for K_encr (encryption key, 128 bits), K_aut
   (authentication key, 256 bits), K_re (re-authentication key, 256
   bits), MSK (Master Session Key, 512 bits), and EMSK (Extended Master
   Session Key, 512 bits).  These keys are used by the subsequent
   EAP-AKA' process.  K_encr is used by the AT_ENCR_DATA attribute, and
   K_aut by the AT_MAC attribute.  K_re is used later in this section.
   MSK and EMSK are outputs from a successful EAP method run [<a href="rfc3748.html" title='"Extensible Authentication Protocol (EAP)"'>RFC3748</a>].

   IK' and CK' are derived as specified in [<a href="#ref-3GPP.33.402" title='"3GPP System Architecture Evolution (SAE); Security aspects of non-3GPP accesses; Release 8"'>3GPP.33.402</a>].  The functions
   that derive IK' and CK' take the following parameters:  CK and IK
   produced by the AKA algorithm, and value of the Network Name field
   comes from the AT_KDF_INPUT attribute (without length or padding) .

   The value "EAP-AKA'" is an eight-characters-long ASCII string.  It is
   used as is, without any trailing NUL characters.

   Identity is the peer identity as specified in <a href="rfc4187.html#section-7">Section 7 of [RFC4187]</a>.

   When the server creates an AKA challenge and corresponding AUTN, CK,
   CK', IK, and IK' values, it MUST set the Authentication Management
   Field (AMF) separation bit to 1 in the AKA algorithm [<a href="#ref-3GPP.33.102" title='"3rd Generation Partnership Project; Technical Specification Group Services and System Aspects; 3G Security; Security architecture (Release 8)"'>3GPP.33.102</a>].
   Similarly, the peer MUST check that the AMF separation bit is set to
   1.  If the bit is not set to 1, the peer behaves as if the AUTN had
   been incorrect and fails the authentication.

   On fast re-authentication, the following keys are calculated:

       MK = PRF'(K_re,"EAP-AKA' re-auth"|Identity|counter|NONCE_S)
       MSK  = MK[0..511]
       EMSK = MK[512..1023]

   MSK and EMSK are the resulting 512-bit keys, taking the first 1024
   bits from the result of PRF'.  Note that K_encr and K_aut are not
   re-derived on fast re-authentication.  K_re is the re-authentication
   key from the preceding full authentication and stays unchanged over
   any fast re-authentication(s) that may happen based on it.  The value
   "EAP-AKA' re-auth" is a sixteen- characters-long ASCII string, again
   represented without any trailing NUL characters.  Identity is the
   fast re-authentication identity, counter is the value from the
   AT_COUNTER attribute,









<span class="grey">Arkko, et al.                Informational                     [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   NONCE_S is the nonce value from the AT_NONCE_S attribute, all as
   specified in <a href="rfc4187.html#section-7">Section 7 of [RFC4187]</a>.  To prevent the use of
   compromised keys in other places, it is forbidden to change the
   network name when going from the full to the fast re-authentication
   process.  The peer SHOULD NOT attempt fast re-authentication when it
   knows that the network name in the current access network is
   different from the one in the initial, full authentication.  Upon
   seeing a re-authentication request with a changed network name, the
   server SHOULD behave as if the re-authentication identifier had been
   unrecognized, and fall back to full authentication.  The server
   observes the change in the name by comparing where the fast
   re-authentication and full authentication EAP transactions were
   received at the Authentication, Authorization, and Accounting (AAA)
   protocol level.

   AT_KDF has any other value

      Future variations of key derivation functions may be defined, and
      they will be represented by new values of AT_KDF.  If the peer
      does not recognize the value, it cannot calculate the keys and
      behaves as explained in <a href="#section-3.2">Section 3.2</a>.

   AT_KDF is missing

      The peer behaves as if the AUTN had been incorrect and MUST fail
      the authentication.

   If the peer supports a given key derivation function but is unwilling
   to perform it for policy reasons, it refuses to calculate the keys
   and behaves as explained in <a href="#section-3.2">Section 3.2</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Hash%20Functions"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Hash Functions</span>

   EAP-AKA' uses SHA-256 [<a href="#ref-FIPS.180-2.2002" title='"Secure Hash Standard"'>FIPS.180-2.2002</a>], not SHA-1 [<a href="#ref-FIPS.180-1.1995" title='"Secure Hash Standard"'>FIPS.180-1.1995</a>]
   as in EAP-AKA.  This requires a change to the pseudo-random function
   (PRF) as well as the AT_MAC and AT_CHECKCODE attributes.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.1.%20%20PRF%27"></a><a class="selflink" href="#section-3.4.1" name="section-3.4.1">3.4.1</a>.  PRF'</span>

   The PRF' construction is the same one IKEv2 uses (see <a href="rfc4306.html#section-2.13">Section 2.13 of
   [RFC4306]</a>).  The function takes two arguments.  K is a 256-bit value
   and S is an octet string of arbitrary length.  PRF' is defined as
   follows:








<span class="grey">Arkko, et al.                Informational                     [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   PRF'(K,S) = T1 | T2 | T3 | T4 | ...

      where:
      T1 = HMAC-SHA-256 (K, S | 0x01)
      T2 = HMAC-SHA-256 (K, T1 | S | 0x02)
      T3 = HMAC-SHA-256 (K, T2 | S | 0x03)
      T4 = HMAC-SHA-256 (K, T3 | S | 0x04)
      ...

   PRF' produces as many bits of output as is needed.  HMAC-SHA-256 is
   the application of HMAC [<a href="rfc2104.html" title='"HMAC: Keyed-Hashing for Message Authentication"'>RFC2104</a>] to SHA-256.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.2.%20%20AT_MAC"></a><a class="selflink" href="#section-3.4.2" name="section-3.4.2">3.4.2</a>.  AT_MAC</span>

   When used within EAP-AKA', the AT_MAC attribute is changed as
   follows.  The MAC algorithm is HMAC-SHA-256-128, a keyed hash value.
   The HMAC-SHA-256-128 value is obtained from the 32-byte HMAC-SHA-256
   value by truncating the output to the first 16 bytes.  Hence, the
   length of the MAC is 16 bytes.

   Otherwise, the use of AT_MAC in EAP-AKA' follows <a href="rfc4187.html#section-10.15">Section 10.15 of
   [RFC4187]</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.3.%20%20AT_CHECKCODE"></a><a class="selflink" href="#section-3.4.3" name="section-3.4.3">3.4.3</a>.  AT_CHECKCODE</span>

   When used within EAP-AKA', the AT_CHECKCODE attribute is changed as
   follows.  First, a 32-byte value is needed to accommodate a 256-bit
   hash output:

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | AT_CHECKCODE  | Length        |           Reserved            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                     Checkcode (0 or 32 bytes)                 |
   |                                                               |
   |                                                               |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Second, the checkcode is a hash value, calculated with SHA-256
   [<a href="#ref-FIPS.180-2.2002" title='"Secure Hash Standard"'>FIPS.180-2.2002</a>], over the data specified in <a href="rfc4187.html#section-10.13">Section 10.13 of
   [RFC4187]</a>.







<span class="grey">Arkko, et al.                Informational                     [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Bidding%20Down%20Prevention%20for%20EAP-AKA"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Bidding Down Prevention for EAP-AKA</span>

   As discussed in [<a href="rfc3748.html" title='"Extensible Authentication Protocol (EAP)"'>RFC3748</a>], negotiation of methods within EAP is
   insecure.  That is, a man-in-the-middle attacker may force the
   endpoints to use a method that is not the strongest that they both
   support.  This is a problem, as we expect EAP-AKA and EAP-AKA' to be
   negotiated via EAP.

   In order to prevent such attacks, this RFC specifies a new mechanism
   for EAP-AKA that allows the endpoints to securely discover the
   capabilities of each other.  This mechanism comes in the form of the
   AT_BIDDING attribute.  This allows both endpoints to communicate
   their desire and support for EAP-AKA' when exchanging EAP-AKA
   messages.  This attribute is not included in EAP-AKA' messages as
   defined in this RFC.  It is only included in EAP-AKA messages.  This
   is based on the assumption that EAP-AKA' is always preferable (see
   <a href="#section-5">Section 5</a>).  If during the EAP-AKA authentication process it is
   discovered that both endpoints would have been able to use EAP-AKA',
   the authentication process SHOULD be aborted, as a bidding down
   attack may have happened.

   The format of the AT_BIDDING attribute is shown below.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | AT_BIDDING    | Length        |D|          Reserved           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The fields are as follows:

   AT_BIDDING

      This is set to 136.

   Length

      The length of the attribute, MUST be set to 1.

   D

      This bit is set to 1 if the sender supports EAP-AKA', is willing
      to use it, and prefers it over EAP-AKA.  Otherwise, it should be
      set to zero.







<span class="grey">Arkko, et al.                Informational                     [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   Reserved

      This field MUST be set to zero when sent and ignored on receipt.

   The server sends this attribute in the EAP-Request/AKA-Challenge
   message.  If the peer supports EAP-AKA', it compares the received
   value to its own capabilities.  If it turns out that both the server
   and peer would have been able to use EAP-AKA' and preferred it over
   EAP-AKA, the peer behaves as if AUTN had been incorrect and fails the
   authentication (see Figure 3 of [<a href="rfc4187.html" title='"Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)"'>RFC4187</a>]).  A peer not supporting
   EAP-AKA' will simply ignore this attribute.  In all cases, the
   attribute is protected by the integrity mechanisms of EAP-AKA, so it
   cannot be removed by a man-in-the-middle attacker.

   Note that we assume (<a href="#section-5">Section 5</a>) that EAP-AKA' is always stronger than
   EAP-AKA.  As a result, there is no need to prevent bidding "down"
   attacks in the other direction, i.e., attackers forcing the endpoints
   to use EAP-AKA'.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Security%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Security Considerations</span>

   A summary of the security properties of EAP-AKA' follows.  These
   properties are very similar to those in EAP-AKA.  We assume that SHA-
   256 is at least as secure as SHA-1.  This is called the SHA-256
   assumption in the remainder of this section.  Under this assumption,
   EAP-AKA' is at least as secure as EAP-AKA.

   If the AT_KDF attribute has value 1, then the security properties of
   EAP-AKA' are as follows:

   Protected ciphersuite negotiation

      EAP-AKA' has no ciphersuite negotiation mechanisms.  It does have
      a negotiation mechanism for selecting the key derivation
      functions.  This mechanism is secure against bidding down attacks.
      The negotiation mechanism allows changing the offered key
      derivation function, but the change is visible in the final EAP-
      Request/AKA'-Challenge message that the server sends to the peer.
      This message is authenticated via the AT_MAC attribute, and
      carries both the chosen alternative and the initially offered
      list.  The peer refuses to accept a change it did not initiate.
      As a result, both parties are aware that a change is being made
      and what the original offer was.








<span class="grey">Arkko, et al.                Informational                     [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   Mutual authentication

      Under the SHA-256 assumption, the properties of EAP-AKA' are at
      least as good as those of EAP-AKA in this respect.  Refer to
      <a href="rfc4187.html#section-12">[RFC4187], Section 12</a> for further details.

   Integrity protection

      Under the SHA-256 assumption, the properties of EAP-AKA' are at
      least as good (most likely better) as those of EAP-AKA in this
      respect.  Refer to <a href="rfc4187.html#section-12">[RFC4187], Section 12</a> for further details.  The
      only difference is that a stronger hash algorithm, SHA-256, is
      used instead of SHA-1.

   Replay protection

      Under the SHA-256 assumption, the properties of EAP-AKA' are at
      least as good as those of EAP-AKA in this respect.  Refer to
      <a href="rfc4187.html#section-12">[RFC4187], Section 12</a> for further details.

   Confidentiality

      The properties of EAP-AKA' are exactly the same as those of EAP-
      AKA in this respect.  Refer to <a href="rfc4187.html#section-12">[RFC4187], Section 12</a> for further
      details.

   Key derivation

      EAP-AKA' supports key derivation with an effective key strength
      against brute force attacks equal to the minimum of the length of
      the derived keys and the length of the AKA base key, i.e., 128
      bits or more.  The key hierarchy is specified in <a href="#section-3.3">Section 3.3</a>.

      The Transient EAP Keys used to protect EAP-AKA packets (K_encr,
      K_aut, K_re), the MSK, and the EMSK are cryptographically
      separate.  If we make the assumption that SHA-256 behaves as a
      pseudo-random function, an attacker is incapable of deriving any
      non-trivial information about any of these keys based on the other
      keys.  An attacker also cannot calculate the pre-shared secret
      from IK, CK, IK', CK', K_encr, K_aut, K_re, MSK, or EMSK by any
      practically feasible means.

      EAP-AKA' adds an additional layer of key derivation functions
      within itself to protect against the use of compromised keys.
      This is discussed further in <a href="#section-5.1">Section 5.1</a>.

      EAP-AKA' uses a pseudo-random function modeled after the one used
      in IKEv2 [<a href="rfc4306.html" title='"Internet Key Exchange (IKEv2) Protocol"'>RFC4306</a>] together with SHA-256.



<span class="grey">Arkko, et al.                Informational                     [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   Key strength

      See above.

   Dictionary attack resistance

      Under the SHA-256 assumption, the properties of EAP-AKA' are at
      least as good as those of EAP-AKA in this respect.  Refer to
      <a href="rfc4187.html#section-12">[RFC4187], Section 12</a> for further details.

   Fast reconnect

      Under the SHA-256 assumption, the properties of EAP-AKA' are at
      least as good as those of EAP-AKA in this respect.  Refer to
      <a href="rfc4187.html#section-12">[RFC4187], Section 12</a> for further details.  Note that
      implementations MUST prevent performing a fast reconnect across
      method types.

   Cryptographic binding

      Note that this term refers to a very specific form of binding,
      something that is performed between two layers of authentication.
      It is not the same as the binding to a particular network name.
      The properties of EAP-AKA' are exactly the same as those of EAP-
      AKA in this respect, i.e., as it is not a tunnel method, this
      property is not applicable to it.  Refer to <a href="rfc4187.html#section-12">[RFC4187], Section 12</a>
      for further details.

   Session independence

      The properties of EAP-AKA' are exactly the same as those of EAP-
      AKA in this respect.  Refer to <a href="rfc4187.html#section-12">[RFC4187], Section 12</a> for further
      details.

   Fragmentation

      The properties of EAP-AKA' are exactly the same as those of EAP-
      AKA in this respect.  Refer to <a href="rfc4187.html#section-12">[RFC4187], Section 12</a> for further
      details.

   Channel binding

      EAP-AKA', like EAP-AKA, does not provide channel bindings as
      they're defined in [<a href="rfc3748.html" title='"Extensible Authentication Protocol (EAP)"'>RFC3748</a>] and [<a href="rfc5247.html" title='"Extensible Authentication Protocol (EAP) Key Management Framework"'>RFC5247</a>].  New skippable
      attributes can be used to add channel binding support in the
      future, if required.





<span class="grey">Arkko, et al.                Informational                     [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


      However, including the Network Name field in the AKA' algorithms
      (which are also used for other purposes than EAP-AKA') provides a
      form of cryptographic separation between different network names,
      which resembles channel bindings.  However, the network name does
      not typically identify the EAP (pass-through) authenticator.  See
      the following section for more discussion.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Security%20Properties%20of%20Binding%20Network%20Names"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Security Properties of Binding Network Names</span>

   The ability of EAP-AKA' to bind the network name into the used keys
   provides some additional protection against key leakage to
   inappropriate parties.  The keys used in the protocol are specific to
   a particular network name.  If key leakage occurs due to an accident,
   access node compromise, or another attack, the leaked keys are only
   useful when providing access with that name.  For instance, a
   malicious access point cannot claim to be network Y if it has stolen
   keys from network X.  Obviously, if an access point is compromised,
   the malicious node can still represent the compromised node.  As a
   result, neither EAP-AKA' nor any other extension can prevent such
   attacks; however, the binding to a particular name limits the
   attacker's choices, allows better tracking of attacks, makes it
   possible to identify compromised networks, and applies good
   cryptographic hygiene.

   The server receives the EAP transaction from a given access network
   and verifies that the claim from the access network corresponds to
   the name that this access network should be using.  It becomes
   impossible for an access network to claim over AAA that it is another
   access network.  In addition, if the peer checks that the information
   it has received locally over the network-access link layer matches
   with the information the server has given it via EAP-AKA', it becomes
   impossible for the access network to tell one story to the AAA
   network and another one to the peer.  These checks prevent some
   "lying NAS" (Network Access Server) attacks.  For instance, a roaming
   partner, R, might claim that it is the home network H in an effort to
   lure peers to connect to itself.  Such an attack would be beneficial
   for the roaming partner if it can attract more users, and damaging
   for the users if their access costs in R are higher than those in
   other alternative networks, such as H.

   Any attacker who gets hold of the keys CK and IK, produced by the AKA
   algorithm, can compute the keys CK' and IK' and, hence, the Master
   Key (MK) according to the rules in <a href="#section-3.3">Section 3.3</a>.  The attacker could
   then act as a lying NAS.  In 3GPP systems in general, the keys CK and
   IK have been distributed to, for instance, nodes in a visited access
   network where they may be vulnerable.  In order to reduce this risk,
   the AKA algorithm MUST be computed with the AMF separation bit set to
   1, and the peer MUST check that this is indeed the case whenever it



<span class="grey">Arkko, et al.                Informational                     [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   runs EAP-AKA'.  Furthermore, [<a href="#ref-3GPP.33.402" title='"3GPP System Architecture Evolution (SAE); Security aspects of non-3GPP accesses; Release 8"'>3GPP.33.402</a>] requires that no CK or IK
   keys computed in this way ever leave the home subscriber system.

   The additional security benefits obtained from the binding depend
   obviously on the way names are assigned to different access networks.
   This is specified in [<a href="#ref-3GPP.24.302" title='"3rd Generation Partnership Project; Technical Specification Group Core Network and Terminals; Access to the 3GPP Evolved Packet Core (EPC) via non-3GPP access networks; Stage 3; (Release 8)"'>3GPP.24.302</a>].  See also [<a href="#ref-3GPP.23.003" title='"3rd Generation Partnership Project; Technical Specification Group Core Network and Terminals; Numbering, addressing and identification (Release 8)"'>3GPP.23.003</a>].
   Ideally, the names allow separating each different access technology,
   each different access network, and each different NAS within a
   domain.  If this is not possible, the full benefits may not be
   achieved.  For instance, if the names identify just an access
   technology, use of compromised keys in a different technology can be
   prevented, but it is not possible to prevent their use by other
   domains or devices using the same technology.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  IANA Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Type%20Value"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Type Value</span>

   EAP-AKA' has the EAP Type value 50 in the Extensible Authentication
   Protocol (EAP) Registry under Method Types.  Per <a href="rfc3748.html#section-6.2">Section 6.2 of
   [RFC3748]</a>, this allocation can be made with Designated Expert and
   Specification Required.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Attribute%20Type%20Values"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Attribute Type Values</span>

   EAP-AKA' shares its attribute space and subtypes with EAP-SIM
   [<a href="rfc4186.html" title='"Extensible Authentication Protocol Method for Global System for Mobile Communications (GSM) Subscriber Identity Modules (EAP-SIM)"'>RFC4186</a>] and EAP-AKA [<a href="rfc4187.html" title='"Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)"'>RFC4187</a>].  No new registries are needed.

   However, a new Attribute Type value (23) in the non-skippable range
   has been assigned for AT_KDF_INPUT (<a href="#section-3.1">Section 3.1</a>) in the EAP-AKA and
   EAP-SIM Parameters registry under Attribute Types.

   Also, a new Attribute Type value (24) in the non-skippable range has
   been assigned for AT_KDF (<a href="#section-3.2">Section 3.2</a>).

   Finally, a new Attribute Type value (136) in the skippable range has
   been assigned for AT_BIDDING (<a href="#section-4">Section 4</a>).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20Key%20Derivation%20Function%20Namespace"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  Key Derivation Function Namespace</span>

   IANA has also created a new namespace for EAP-AKA' AT_KDF Key
   Derivation Function Values.  This namespace exists under the EAP-AKA
   and EAP-SIM Parameters registry.  The initial contents of this
   namespace are given below; new values can be created through the
   Specification Required policy [<a href="rfc5226.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC5226</a>].






<span class="grey">Arkko, et al.                Informational                     [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   Value      Description              Reference
   ---------  ----------------------   ---------------
   0          Reserved                 [<a href="rfc5448.html">RFC5448</a>]
   1          EAP-AKA' with CK'/IK'    [<a href="rfc5448.html">RFC5448</a>]
   2-65535    Unassigned

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Contributors"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Contributors</span>

   The test vectors in <a href="#appendix-C">Appendix C</a> were provided by Yogendra Pal and
   Jouni Malinen, based on two independent implementations of this
   specification.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Acknowledgments"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Acknowledgments</span>

   The authors would like to thank Guenther Horn, Joe Salowey, Mats
   Naslund, Adrian Escott, Brian Rosenberg, Laksminath Dondeti, Ahmad
   Muhanna, Stefan Rommer, Miguel Garcia, Jan Kall, Ankur Agarwal, Jouni
   Malinen, Brian Weis, Russ Housley, and Alfred Hoenes for their in-
   depth reviews and interesting discussions in this problem space.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20References"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20Normative%20References"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  Normative References</span>

   [<a id="ref-3GPP.24.302" name="ref-3GPP.24.302">3GPP.24.302</a>]      3GPP, "3rd Generation Partnership Project;
                      Technical Specification Group Core Network and
                      Terminals; Access to the 3GPP Evolved Packet Core
                      (EPC) via non-3GPP access networks; Stage 3;
                      (Release 8)", 3GPP Technical Specification 24.302,
                      December 2008.

   [<a id="ref-3GPP.33.102" name="ref-3GPP.33.102">3GPP.33.102</a>]      3GPP, "3rd Generation Partnership Project;
                      Technical Specification Group Services and System
                      Aspects; 3G Security; Security architecture
                      (Release 8)", 3GPP Technical Specification 33.102,
                      December 2008.

   [<a id="ref-3GPP.33.402" name="ref-3GPP.33.402">3GPP.33.402</a>]      3GPP, "3GPP System Architecture Evolution (SAE);
                      Security aspects of non-3GPP accesses; Release 8",
                      3GPP Technical Specification 33.402,
                      December 2008.

   [<a id="ref-FIPS.180-2.2002" name="ref-FIPS.180-2.2002">FIPS.180-2.2002</a>]  National Institute of Standards and Technology,
                      "Secure Hash Standard", FIPS PUB 180-2,
                      August 2002, &lt;<a href="http://csrc.nist.gov/publications/fips/fips180-2/fips180-2.pdf">http://csrc.nist.gov/publications/</a>
                      <a href="http://csrc.nist.gov/publications/fips/fips180-2/fips180-2.pdf">fips/fips180-2/fips180-2.pdf</a>&gt;.





<span class="grey">Arkko, et al.                Informational                     [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   [<a id="ref-RFC2104" name="ref-RFC2104">RFC2104</a>]          Krawczyk, H., Bellare, M., and R. Canetti, "HMAC:
                      Keyed-Hashing for Message Authentication",
                      <a href="rfc2104.html">RFC 2104</a>, February 1997.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]          Bradner, S., "Key words for use in RFCs to
                      Indicate Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>,
                      March 1997.

   [<a id="ref-RFC3748" name="ref-RFC3748">RFC3748</a>]          Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J.,
                      and H. Levkowetz, "Extensible Authentication
                      Protocol (EAP)", <a href="rfc3748.html">RFC 3748</a>, June 2004.

   [<a id="ref-RFC4187" name="ref-RFC4187">RFC4187</a>]          Arkko, J. and H. Haverinen, "Extensible
                      Authentication Protocol Method for 3rd Generation
                      Authentication and Key Agreement (EAP-AKA)",
                      <a href="rfc4187.html">RFC 4187</a>, January 2006.

   [<a id="ref-RFC5226" name="ref-RFC5226">RFC5226</a>]          Narten, T. and H. Alvestrand, "Guidelines for
                      Writing an IANA Considerations Section in RFCs",
                      <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc5226.html">RFC 5226</a>, May 2008.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20Informative%20References"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  Informative References</span>

   [<a id="ref-3GPP.23.003" name="ref-3GPP.23.003">3GPP.23.003</a>]      3GPP, "3rd Generation Partnership Project;
                      Technical Specification Group Core Network and
                      Terminals; Numbering, addressing and
                      identification (Release 8)", 3GPP Draft Technical
                      Specification 23.003, December 2008.

   [<a id="ref-3GPP.35.208" name="ref-3GPP.35.208">3GPP.35.208</a>]      3GPP, "3rd Generation Partnership Project;
                      Technical Specification Group Services and System
                      Aspects; 3G Security; Specification of the
                      MILENAGE Algorithm Set: An example algorithm set
                      for the 3GPP authentication and key generation
                      functions f1, f1*, f2, f3, f4, f5 and f5*;
                      Document 4: Design Conformance Test Data (Release
                      8)", 3GPP Technical Specification 35.208,
                      December 2008.

   [<a id="ref-FIPS.180-1.1995" name="ref-FIPS.180-1.1995">FIPS.180-1.1995</a>]  National Institute of Standards and Technology,
                      "Secure Hash Standard", FIPS PUB 180-1,
                      April 1995,
                      &lt;<a href="http://www.itl.nist.gov/fipspubs/fip180-1.htm">http://www.itl.nist.gov/fipspubs/fip180-1.htm</a>&gt;.








<span class="grey">Arkko, et al.                Informational                     [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   [<a id="ref-RFC4186" name="ref-RFC4186">RFC4186</a>]          Haverinen, H. and J. Salowey, "Extensible
                      Authentication Protocol Method for Global System
                      for Mobile Communications (GSM) Subscriber
                      Identity Modules (EAP-SIM)", <a href="rfc4186.html">RFC 4186</a>,
                      January 2006.

   [<a id="ref-RFC4284" name="ref-RFC4284">RFC4284</a>]          Adrangi, F., Lortz, V., Bari, F., and P. Eronen,
                      "Identity Selection Hints for the Extensible
                      Authentication Protocol (EAP)", <a href="rfc4284.html">RFC 4284</a>,
                      January 2006.

   [<a id="ref-RFC4306" name="ref-RFC4306">RFC4306</a>]          Kaufman, C., "Internet Key Exchange (IKEv2)
                      Protocol", <a href="rfc4306.html">RFC 4306</a>, December 2005.

   [<a id="ref-RFC5113" name="ref-RFC5113">RFC5113</a>]          Arkko, J., Aboba, B., Korhonen, J., and F. Bari,
                      "Network Discovery and Selection Problem",
                      <a href="rfc5113.html">RFC 5113</a>, January 2008.

   [<a id="ref-RFC5247" name="ref-RFC5247">RFC5247</a>]          Aboba, B., Simon, D., and P. Eronen, "Extensible
                      Authentication Protocol (EAP) Key Management
                      Framework", <a href="rfc5247.html">RFC 5247</a>, August 2008.






























<span class="grey">Arkko, et al.                Informational                     [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Changes%20from%20RFC%204187"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Changes from <a href="rfc4187.html">RFC 4187</a></span>

   The changes to <a href="rfc4187.html">RFC 4187</a> relate only to the bidding down prevention
   support defined in <a href="#section-4">Section 4</a>.  In particular, this document does not
   change how the Master Key (MK) is calculated in <a href="rfc4187.html">RFC 4187</a> (it uses CK
   and IK, not CK' and IK'); neither is any processing of the AMF bit
   added to <a href="rfc4187.html">RFC 4187</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20B.%20%20Importance%20of%20Explicit%20Negotiation"></a><a class="selflink" href="#appendix-B" name="appendix-B">Appendix B</a>.  Importance of Explicit Negotiation</span>

   Choosing between the traditional and revised AKA key derivation
   functions is easy when their use is unambiguously tied to a
   particular radio access network, e.g., Long Term Evolution (LTE) as
   defined by 3GPP or evolved High Rate Packet Data (eHRPD) as defined
   by 3GPP2.  There is no possibility for interoperability problems if
   this radio access network is always used in conjunction with new
   protocols that cannot be mixed with the old ones; clients will always
   know whether they are connecting to the old or new system.

   However, using the new key derivation functions over EAP introduces
   several degrees of separation, making the choice of the correct key
   derivation functions much harder.  Many different types of networks
   employ EAP.  Most of these networks have no means to carry any
   information about what is expected from the authentication process.
   EAP itself is severely limited in carrying any additional
   information, as noted in [<a href="rfc4284.html" title='"Identity Selection Hints for the Extensible Authentication Protocol (EAP)"'>RFC4284</a>] and [<a href="rfc5113.html" title='"Network Discovery and Selection Problem"'>RFC5113</a>].  Even if these
   networks or EAP were extended to carry additional information, it
   would not affect millions of deployed access networks and clients
   attaching to them.

   Simply changing the key derivation functions that EAP-AKA [<a href="rfc4187.html" title='"Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)"'>RFC4187</a>]
   uses would cause interoperability problems with all of the existing
   implementations.  Perhaps it would be possible to employ strict
   separation into domain names that should be used by the new clients
   and networks.  Only these new devices would then employ the new key
   derivation mechanism.  While this can be made to work for specific
   cases, it would be an extremely brittle mechanism, ripe to result in
   problems whenever client configuration, routing of authentication
   requests, or server configuration does not match expectations.  It
   also does not help to assume that the EAP client and server are
   running a particular release of 3GPP network specifications.  Network
   vendors often provide features from future releases early or do not
   provide all features of the current release.  And obviously, there
   are many EAP and even some EAP-AKA implementations that are not
   bundled with the 3GPP network offerings.  In general, these
   approaches are expected to lead to hard-to-diagnose problems and
   increased support calls.




<span class="grey">Arkko, et al.                Informational                     [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20C.%20%20Test%20Vectors"></a><a class="selflink" href="#appendix-C" name="appendix-C">Appendix C</a>.  Test Vectors</span>

   Test vectors are provided below for four different cases.  The test
   vectors may be useful for testing implementations.  In the first two
   cases, we employ the Milenage algorithm and the algorithm
   configuration parameters (the subscriber key K and operator algorithm
   variant configuration value OP) from test set 19 in [<a href="#ref-3GPP.35.208" title='"3rd Generation Partnership Project; Technical Specification Group Services and System Aspects; 3G Security; Specification of the MILENAGE Algorithm Set: An example algorithm set for the 3GPP authentication and key generation functions f1, f1*, f2, f3, f4, f5 and f5*; Document 4: Design Conformance Test Data (Release 8)"'>3GPP.35.208</a>].

   The last two cases use artificial values as the output of AKA, and is
   useful only for testing the computation of values within EAP-AKA',
   not AKA itself.








































<span class="grey">Arkko, et al.                Informational                     [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   Case 1

      The parameters for the AKA run are as follows:

         Identity: "0555444333222111"

         Network name: "WLAN"

         RAND: 81e9 2b6c 0ee0 e12e bceb a8d9 2a99 dfa5

         AUTN: bb52 e91c 747a c3ab 2a5c 23d1 5ee3 51d5

         IK: 9744 871a d32b f9bb d1dd 5ce5 4e3e 2e5a

         CK: 5349 fbe0 9864 9f94 8f5d 2e97 3a81 c00f

         RES: 28d7 b0f2 a2ec 3de5

      Then the derived keys are generated as follows:

         CK': 0093 962d 0dd8 4aa5 684b 045c 9edf fa04

         IK': ccfc 230c a74f cc96 c0a5 d611 64f5 a76c

         K_encr: 766f a0a6 c317 174b 812d 52fb cd11 a179

         K_aut: 0842 ea72 2ff6 835b fa20 3249 9fc3 ec23
         c2f0 e388 b4f0 7543 ffc6 77f1 696d 71ea

         K_re: cf83 aa8b c7e0 aced 892a cc98 e76a 9b20
         95b5 58c7 795c 7094 715c b339 3aa7 d17a

         MSK: 67c4 2d9a a56c 1b79 e295 e345 9fc3 d187
         d42b e0bf 818d 3070 e362 c5e9 67a4 d544
         e8ec fe19 358a b303 9aff 03b7 c930 588c
         055b abee 58a0 2650 b067 ec4e 9347 c75a

         EMSK: f861 703c d775 590e 16c7 679e a387 4ada
         8663 11de 2907 64d7 60cf 76df 647e a01c
         313f 6992 4bdd 7650 ca9b ac14 1ea0 75c4
         ef9e 8029 c0e2 90cd bad5 638b 63bc 23fb










<span class="grey">Arkko, et al.                Informational                     [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   Case 2

      The parameters for the AKA run are as follows:

         Identity: "0555444333222111"

         Network name: "HRPD"

         RAND: 81e9 2b6c 0ee0 e12e bceb a8d9 2a99 dfa5

         AUTN: bb52 e91c 747a c3ab 2a5c 23d1 5ee3 51d5

         IK: 9744 871a d32b f9bb d1dd 5ce5 4e3e 2e5a

         CK: 5349 fbe0 9864 9f94 8f5d 2e97 3a81 c00f

         RES: 28d7 b0f2 a2ec 3de5

      Then the derived keys are generated as follows:

         CK': 3820 f027 7fa5 f777 32b1 fb1d 90c1 a0da

         IK': db94 a0ab 557e f6c9 ab48 619c a05b 9a9f

         K_encr: 05ad 73ac 915f ce89 ac77 e152 0d82 187b

         K_aut: 5b4a caef 62c6 ebb8 882b 2f3d 534c 4b35
         2773 37a0 0184 f20f f25d 224c 04be 2afd

         K_re: 3f90 bf5c 6e5e f325 ff04 eb5e f653 9fa8
         cca8 3981 94fb d00b e425 b3f4 0dba 10ac

         MSK: 87b3 2157 0117 cd6c 95ab 6c43 6fb5 073f
         f15c f855 05d2 bc5b b735 5fc2 1ea8 a757
         57e8 f86a 2b13 8002 e057 5291 3bb4 3b82
         f868 a961 17e9 1a2d 95f5 2667 7d57 2900

         EMSK: c891 d5f2 0f14 8a10 0755 3e2d ea55 5c9c
         b672 e967 5f4a 66b4 bafa 0273 79f9 3aee
         539a 5979 d0a0 042b 9d2a e28b ed3b 17a3
         1dc8 ab75 072b 80bd 0c1d a612 466e 402c










<span class="grey">Arkko, et al.                Informational                     [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   Case 3

      The parameters for the AKA run are as follows:

           Identity:     "0555444333222111"

           Network name: "WLAN"

           RAND:         e0e0 e0e0 e0e0 e0e0 e0e0 e0e0 e0e0 e0e0

           AUTN:         a0a0 a0a0 a0a0 a0a0 a0a0 a0a0 a0a0 a0a0

           IK:           b0b0 b0b0 b0b0 b0b0 b0b0 b0b0 b0b0 b0b0

           CK:           c0c0 c0c0 c0c0 c0c0 c0c0 c0c0 c0c0 c0c0

           RES:          d0d0 d0d0 d0d0 d0d0 d0d0 d0d0 d0d0 d0d0

        Then the derived keys are generated as follows:

           CK':          cd4c 8e5c 68f5 7dd1 d7d7 dfd0 c538 e577

           IK':          3ece 6b70 5dbb f7df c459 a112 80c6 5524

           K_encr:       897d 302f a284 7416 488c 28e2 0dcb 7be4

           K_aut:        c407 00e7 7224 83ae 3dc7 139e b0b8 8bb5
                         58cb 3081 eccd 057f 9207 d128 6ee7 dd53

           K_re:         0a59 1a22 dd8b 5b1c f29e 3d50 8c91 dbbd
                         b4ae e230 5189 2c42 b6a2 de66 ea50 4473

           MSK:          9f7d ca9e 37bb 2202 9ed9 86e7 cd09 d4a7
                         0d1a c76d 9553 5c5c ac40 a750 4699 bb89
                         61a2 9ef6 f3e9 0f18 3de5 861a d1be dc81
                         ce99 1639 1b40 1aa0 06c9 8785 a575 6df7

           EMSK:         724d e00b db9e 5681 87be 3fe7 4611 4557
                         d501 8779 537e e37f 4d3c 6c73 8cb9 7b9d
                         c651 bc19 bfad c344 ffe2 b52c a78b d831
                         6b51 dacc 5f2b 1440 cb95 1552 1cc7 ba23










<span class="grey">Arkko, et al.                Informational                     [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


   Case 4

      The parameters for the AKA run are as follows:

           Identity:     "0555444333222111"

           Network name: "HRPD"

           RAND:         e0e0 e0e0 e0e0 e0e0 e0e0 e0e0 e0e0 e0e0

           AUTN:         a0a0 a0a0 a0a0 a0a0 a0a0 a0a0 a0a0 a0a0

           IK:           b0b0 b0b0 b0b0 b0b0 b0b0 b0b0 b0b0 b0b0

           CK:           c0c0 c0c0 c0c0 c0c0 c0c0 c0c0 c0c0 c0c0

           RES:          d0d0 d0d0 d0d0 d0d0 d0d0 d0d0 d0d0 d0d0

        Then the derived keys are generated as follows:

           CK':          8310 a71c e6f7 5488 9613 da8f 64d5 fb46

           IK':          5adf 1436 0ae8 3819 2db2 3f6f cb7f 8c76

           K_encr:       745e 7439 ba23 8f50 fcac 4d15 d47c d1d9

           K_aut:        3e1d 2aa4 e677 025c fd86 2a4b e183 61a1
                         3a64 5765 5714 63df 833a 9759 e809 9879

           K_re:         99da 835e 2ae8 2462 576f e651 6fad 1f80
                         2f0f a119 1655 dd0a 273d a96d 04e0 fcd3

           MSK:          c6d3 a6e0 ceea 951e b20d 74f3 2c30 61d0
                         680a 04b0 b086 ee87 00ac e3e0 b95f a026
                         83c2 87be ee44 4322 94ff 98af 26d2 cc78
                         3bac e75c 4b0a f7fd feb5 511b a8e4 cbd0

           EMSK:         7fb5 6813 838a dafa 99d1 40c2 f198 f6da
                         cebf b6af ee44 4961 1054 02b5 08c7 f363
                         352c b291 9644 b504 63e6 a693 5415 0147
                         ae09 cbc5 4b8a 651d 8787 a689 3ed8 536d










<span class="grey">Arkko, et al.                Informational                     [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc5448.html">RFC 5448</a>                        EAP-AKA'                        May 2009</span>


Authors' Addresses

   Jari Arkko
   Ericsson
   Jorvas  02420
   Finland

   EMail: jari.arkko@piuha.net


   Vesa Lehtovirta
   Ericsson
   Jorvas  02420
   Finland

   EMail: vesa.lehtovirta@ericsson.com


   Pasi Eronen
   Nokia Research Center
   P.O. Box 407
   FIN-00045 Nokia Group
   Finland

   EMail: pasi.eronen@nokia.com


























Arkko, et al.                Informational                     [Page 29]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.127, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc5448 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Aug 2018 14:27:34 GMT --></html>