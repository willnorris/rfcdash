<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6398 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:30 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-rahman-rtg-router-alert-considerations" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:6398" name="DC.Identifier"/>
<meta content="October, 2011" name="DC.Date.Issued"/>
<meta content="Francois Le Faucheur &lt;flefauch@cisco.com&gt;" name="DC.Creator"/>
<meta content="The IP Router Alert Option is an IP option that alerts transit routers
to more closely examine the contents of an IP packet. RSVP, PGM,
IGMP/MLD, MRD and GIST are some of the protocols that make use of the
IP Router Alert option. This document discusses security aspects and
usage guidelines around the use of the current IP Router Alert option.
Specifically, it provides recommendation against using the Router
Alert in the end-to-end open Internet as well as identify controlled
environments where protocols depending on Router Alert can be used
safely. It also provides recommendation about protection approaches
for Service Providers. Finally it provides brief guidelines for Router
Alert implementation on routers." name="DC.Description.Abstract"/>
<meta content="IP Router Alert Considerations and Usage" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6398 - IP Router Alert Considerations and Usage</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgmagenta" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6398.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6398" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-intarea-router-alert-considerations" title="draft-ietf-intarea-router-alert-considerations">draft-ietf-inta...</a>] [<a href="https://datatracker.ietf.org/doc/rfc6398" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6398" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6398" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                   BEST CURRENT PRACTICE</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)               F. Le Faucheur, Ed.
Request for Comments: 6398                                         Cisco
BCP: 168                                                    October 2011
Updates: <a href="rfc2113.html">2113</a>, <a href="rfc2711.html">2711</a>
Category: Best Current Practice
ISSN: 2070-1721


                <span class="h1">IP Router Alert Considerations and Usage</span>

Abstract

   The IP Router Alert Option is an IP option that alerts transit
   routers to more closely examine the contents of an IP packet.  The
   Resource reSerVation Protocol (RSVP), Pragmatic General Multicast
   (PGM), the Internet Group Management Protocol (IGMP), Multicast
   Listener Discovery (MLD), Multicast Router Discovery (MRD), and
   General Internet Signaling Transport (GIST) are some of the protocols
   that make use of the IP Router Alert Option.  This document discusses
   security aspects and usage guidelines around the use of the current
   IP Router Alert Option, thereby updating <a href="rfc2113.html">RFC 2113</a> and <a href="rfc2711.html">RFC 2711</a>.
   Specifically, it provides recommendations against using the Router
   Alert in the end-to-end open Internet and identifies controlled
   environments where protocols depending on Router Alert can be used
   safely.  It also provides recommendations about protection approaches
   for service providers.  Finally, it provides brief guidelines for
   Router Alert implementation on routers.

Status of This Memo

   This memo documents an Internet Best Current Practice.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   BCPs is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6398">http://www.rfc-editor.org/info/rfc6398</a>.










<span class="grey">Le Faucheur               Best Current Practice                 [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6398.html">RFC 6398</a>               Router Alert Considerations          October 2011</span>


Copyright Notice

   Copyright (c) 2011 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Terminology .....................................................<a href="#page-4">4</a>
      <a href="#section-2.1">2.1</a>. Conventions Used in This Document ..........................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. Security Concerns of Router Alert ...............................<a href="#page-5">5</a>
   <a href="#section-4">4</a>. Guidelines for Use of Router Alert ..............................<a href="#page-7">7</a>
      4.1. Use of Router Alert End to End in the Internet
           (Router Alert in Peer Model) ...............................<a href="#page-7">7</a>
      <a href="#section-4.2">4.2</a>. Use of Router Alert in Controlled Environments .............<a href="#page-9">9</a>
           4.2.1. Use of Router Alert within an Administrative
                  Domain ..............................................<a href="#page-9">9</a>
           <a href="#section-4.2.2">4.2.2</a>. Use of Router Alert in Overlay Model ...............<a href="#page-11">11</a>
      <a href="#section-4.3">4.3</a>. Router Alert Protection Approaches for Service Providers ..13
   <a href="#section-5">5</a>. Guidelines for Router Alert Implementation .....................<a href="#page-15">15</a>
   <a href="#section-6">6</a>. Security Considerations ........................................<a href="#page-16">16</a>
   <a href="#section-7">7</a>. Contributors ...................................................<a href="#page-16">16</a>
   <a href="#section-8">8</a>. Acknowledgments ................................................<a href="#page-16">16</a>
   <a href="#section-9">9</a>. References .....................................................<a href="#page-17">17</a>
      <a href="#section-9.1">9.1</a>. Normative References ......................................<a href="#page-17">17</a>
      <a href="#section-9.2">9.2</a>. Informative References ....................................<a href="#page-17">17</a>















<span class="grey">Le Faucheur               Best Current Practice                 [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6398.html">RFC 6398</a>               Router Alert Considerations          October 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   [<a id="ref-RFC2113" name="ref-RFC2113">RFC2113</a>] and [<a href="rfc2711.html" title='"IPv6 Router Alert Option"'>RFC2711</a>] define the IPv4 and IPv6 Router Alert Options
   (RAOs), respectively.  In this document, we collectively refer to
   those options as the IP Router Alert.  The IP Router Alert Option is
   an IP option that alerts transit routers to more closely examine the
   contents of an IP packet.

   Some of the protocols that make use of the IP Router Alert are the
   Resource reSerVation Protocol (RSVP) ([<a href="rfc2205.html" title='"Resource ReSerVation Protocol (RSVP) -- Version 1 Functional Specification"'>RFC2205</a>], [<a href="rfc3175.html" title='"Aggregation of RSVP for IPv4 and IPv6 Reservations"'>RFC3175</a>],
   [<a href="rfc3209.html" title='"RSVP-TE: Extensions to RSVP for LSP Tunnels"'>RFC3209</a>]), Pragmatic General Multicast (PGM) ([<a href="rfc3208.html" title='"PGM Reliable Transport Protocol Specification"'>RFC3208</a>]), the
   Internet Group Management Protocol (IGMP) ([<a href="rfc3376.html" title='"Internet Group Management Protocol, Version 3"'>RFC3376</a>]), Multicast
   Listener Discovery (MLD) ([<a href="rfc2710.html" title='"Multicast Listener Discovery (MLD) for IPv6"'>RFC2710</a>], [<a href="rfc3810.html" title='"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"'>RFC3810</a>]), Multicast Router
   Discovery (MRD) ([<a href="rfc4286.html" title='"Multicast Router Discovery"'>RFC4286</a>]), and Next Steps in Signaling (NSIS)
   General Internet Signaling Transport (GIST) ([<a href="rfc5971.html" title='"GIST: General Internet Signalling Transport"'>RFC5971</a>]).

   <a href="#section-3">Section 3</a> describes the security concerns associated with the use of
   the Router Alert Option.

   <a href="#section-4">Section 4</a> provides guidelines for the use of Router Alert.  More
   specifically, <a href="#section-4.1">Section 4.1</a> recommends that Router Alert not be used
   for end-to-end applications over the Internet, while <a href="#section-4.2">Section 4.2</a>
   presents controlled environments where applications/protocols relying
   on IP Router Alert can be deployed effectively and safely.
   <a href="#section-4.3">Section 4.3</a> provides recommendations on protection approaches to be
   used by service providers in order to protect their network from
   Router-Alert-based attacks.

   Finally, <a href="#section-5">Section 5</a> provides generic recommendations for router
   implementation of Router Alert, aiming at increasing protection
   against attacks.

   This document discusses considerations and practices based on the
   current specifications of IP Router Alert ([<a href="rfc2113.html" title='"IP Router Alert Option"'>RFC2113</a>], [<a href="rfc2711.html" title='"IPv6 Router Alert Option"'>RFC2711</a>]).
   Possible future enhancements to the specifications of IP Router Alert
   (in view of reducing the security risks associated with the use of IP
   Router Alert) are outside the scope of this document.  One such
   proposal is discussed in [<a href="#ref-RAO-EXT" title='"IP Router Alert Option Extension"'>RAO-EXT</a>], but at the time of this writing,
   the IETF has not adopted any extensions for this purpose.

   The IPv6 base specification [<a href="rfc2460.html" title='"Internet Protocol, Version 6 (IPv6) Specification"'>RFC2460</a>] defines the hop-by-hop options
   extension header.  The hop-by-hop options header is used to carry
   optional information that must be examined by every node along a
   packet's delivery path.  The IPv6 Router Alert Option is one
   particular hop-by-hop option.  Similar security concerns to those
   discussed in this document for the IPv6 Router Alert apply more
   generically to the concept of the IPv6 hop-by-hop options extension
   header.  However, thoroughly addressing the broader concept of the



<span class="grey">Le Faucheur               Best Current Practice                 [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6398.html">RFC 6398</a>               Router Alert Considerations          October 2011</span>


   IPv6 hop-by-hop option would require additional material so as to
   cover additional considerations associated with it (e.g., the
   effectiveness of the attack could depend on how many options are
   included and on the range to which the option-type value belongs), so
   this is kept outside the scope of this document.  A detailed
   discussion about security risks and proposed remedies associated with
   the IPv6 hop-by-hop option can be found in [<a href="#ref-IPv6-HOPBYHOP">IPv6-HOPBYHOP</a>].

   The IPv4 base specification [<a href="https://tools.ietf.org/html/rfc0791" title='"Internet Protocol"'>RFC0791</a>] defines a general notion of
   IPv4 options that can be included in the IPv4 header (without
   distinguishing between the hop-by-hop and end-to-end options).  The
   IPv4 Router Alert Option is one particular IPv4 option.  Security
   concerns similar to those discussed in this document for the IPv4
   Router Alert apply more generically to the concept of the IPv4
   option.  However, thoroughly addressing the security concerns of the
   broader concept of the IPv4 option is kept outside the scope of this
   document, because it would require additional material so as to cover
   additional considerations associated with it (such as lack of option
   ordering, etc.), and because other IPv4 options are often blocked in
   firewalls and not very widely used, so the practical risks they
   present are largely nonexistent.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   For readability, this document uses the following loosely defined
   terms:

   o  Fast path: Hardware or Application-Specific Integrated Circuit
      (ASIC) processing path for packets.  This is the nominal
      processing path within a router for IP datagrams.

   o  Slow path: Software processing path for packets.  This is a sub-
      nominal processing path for packets that require special
      processing or differ from assumptions made in fast-path
      heuristics.

   o  Next level protocol: The protocol transported in the IP datagram.
      In IPv4 [<a href="https://tools.ietf.org/html/rfc0791" title='"Internet Protocol"'>RFC0791</a>], the next level protocol is identified by the
      IANA protocol number conveyed in the 8-bit "Protocol" field in the
      IPv4 header.  In IPv6 [<a href="rfc2460.html" title='"Internet Protocol, Version 6 (IPv6) Specification"'>RFC2460</a>], the next level protocol is
      identified by the IANA protocol number conveyed in the 8-bit "Next
      Header" field in the IPv6 header.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].



<span class="grey">Le Faucheur               Best Current Practice                 [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6398.html">RFC 6398</a>               Router Alert Considerations          October 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Security%20Concerns%20of%20Router%20Alert"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Security Concerns of Router Alert</span>

   The IP Router Alert Option is defined ([<a href="rfc2113.html" title='"IP Router Alert Option"'>RFC2113</a>], [<a href="rfc2711.html" title='"IPv6 Router Alert Option"'>RFC2711</a>]) as a
   mechanism that alerts transit routers to more closely examine the
   contents of an IP packet.  [<a href="rfc4081.html" title='"Security Threats for Next Steps in Signaling (NSIS)"'>RFC4081</a>] and [<a href="rfc2711.html" title='"IPv6 Router Alert Option"'>RFC2711</a>] mention the
   security risks associated with the use of the IP Router Alert:
   flooding a router with bogus (or simply undesired) IP datagrams that
   contain the IP Router Alert could impact operation of the router in
   undesirable ways.  For example, if the router punts the datagrams
   containing the IP Router Alert Option to the slow path, such an
   attack could consume a significant share of the router's slow path
   and could also lead to packet drops in the slow path (affecting
   operation of all other applications and protocols operating in the
   slow path), thereby resulting in a denial of service (DoS)
   ([<a href="rfc4732.html" title='"Internet Denial-of-Service Considerations"'>RFC4732</a>]).

   Furthermore, [<a href="rfc2113.html" title='"IP Router Alert Option"'>RFC2113</a>] specifies no (and [<a href="rfc2711.html" title='"IPv6 Router Alert Option"'>RFC2711</a>] specifies a very
   limited) mechanism for identifying different users of IP Router
   Alert.  As a result, many fast switching implementations of IP Router
   Alert punt most/all packets marked with IP Router Alert into the slow
   path (unless configured to systematically ignore or drop all Router
   Alert packets).  However, some existing deployed IP routers can and
   do process IP packets containing the Router Alert Option inside the
   fast path.

   Some IP Router Alert implementations are able to take into account
   the next level protocol as a discriminator for the punting decision
   for different protocols using IP Router Alert.  However, this still
   only allows very coarse triage among various protocols using IP
   Router Alert, for two reasons.  First, the next level protocol is the
   same when IP Router Alert is used for different applications of the
   same protocol (e.g., RSVP vs. RSVP - Traffic Engineering (RSVP-TE)),
   or when IP Router Alert is used for different contexts of the same
   application (e.g., different levels of RSVP aggregation [<a href="rfc3175.html" title='"Aggregation of RSVP for IPv4 and IPv6 Reservations"'>RFC3175</a>]).
   Thus, it is not always possible to achieve the necessary triage in
   the fast path across IP Router Alert packets from different
   applications or from different contexts of an application.  Secondly,
   some protocols requiring punting might be carried over a transport
   protocol (e.g., TCP or UDP), possibly because (1) they require the
   services of that transport protocol, (2) the protocol does not
   justify allocation of a scarce next level protocol value, or (3) not
   relying on a very widely deployed transport protocol is likely to
   result in deployment issues due to common middlebox behaviors (e.g.,
   firewalls or NATs discarding packets of "unknown" protocols).  Thus,
   considering the next level protocol alone in the fast path is not
   sufficient to allow triage in the fast path of IP Router Alert





<span class="grey">Le Faucheur               Best Current Practice                 [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6398.html">RFC 6398</a>               Router Alert Considerations          October 2011</span>


   packets from different protocols sharing the same transport protocol.
   Therefore, it is generally not possible to ensure that only the IP
   Router Alert packets for next level protocols of interest are punted
   to the slow path while other IP Router Alert packets are efficiently
   forwarded (i.e., in the fast path).

   Some IP Router Alert implementations are able to take into account
   the Value field inside the Router Alert Option.  However, only one
   value (zero) was defined in [<a href="rfc2113.html" title='"IP Router Alert Option"'>RFC2113</a>], and no IANA registry for IPv4
   Router Alert values was available until recently ([<a href="rfc5350.html" title='"IANA Considerations for the IPv4 and IPv6 Router Alert Options"'>RFC5350</a>]).  So
   this did not allow most IPv4 Router Alert implementations to support
   useful classification based on the Value field in the fast path.
   Also, while [<a href="rfc2113.html" title='"IP Router Alert Option"'>RFC2113</a>] states that unknown values should be ignored
   (i.e., the packets should be forwarded as normal IP traffic), it has
   been reported that some existing implementations simply ignore the
   Value field completely (i.e., process any packet with an IPv4 Router
   Alert regardless of its option value).  An IANA registry for further
   allocation of IPv4 Router Alert values has been introduced recently
   ([<a href="rfc5350.html" title='"IANA Considerations for the IPv4 and IPv6 Router Alert Options"'>RFC5350</a>]), but this would only allow coarse-grain classification,
   if supported by implementations.  For IPv6, [<a href="rfc2711.html" title='"IPv6 Router Alert Option"'>RFC2711</a>] states that
   "the Value field can be used by an implementation to speed processing
   of the datagram within the transit router" and defines an IANA
   registry for these values.  But again, this only allows coarse-grain
   classification.  Besides, some existing IPv6 Router Alert
   implementations are reported to depart from that behavior.

   [<a id="ref-RFC2711" name="ref-RFC2711">RFC2711</a>] mentions that limiting, by rate or some other means, the
   use of the IP Router Alert Option is a way of protecting against a
   potential attack.  However, if rate limiting is used as a protection
   mechanism, but if the granularity of the rate limiting is not fine
   enough to distinguish IP Router Alert packets of interest from
   unwanted IP Router Alert packets, an IP Router Alert attack could
   still severely degrade operation of protocols of interest that depend
   on the use of IP Router Alert.

   In a nutshell, the IP Router Alert Option does not provide a
   convenient universal mechanism to accurately and reliably distinguish
   between IP Router Alert packets of interest and unwanted IP Router
   Alert packets.  This, in turn, creates a security concern when the IP
   Router Alert Option is used, because, short of appropriate router-
   implementation-specific mechanisms, the router slow path is at risk
   of being flooded by unwanted traffic.









<span class="grey">Le Faucheur               Best Current Practice                 [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6398.html">RFC 6398</a>               Router Alert Considerations          October 2011</span>


   Note that service providers commonly allow external parties to
   communicate with a control plane application in their routers, such
   as with BGP peering.  Depending on the actual environment and BGP
   security practices, with BGP peering, the resulting DoS attack vector
   is similar to or somewhat less serious than it would be with the
   Router Alert Option for a number of reasons, including the following:

   o  With BGP, edge routers only exchange control plane information
      with pre-identified peers and can easily filter out any control
      plane traffic coming from other peers or non-authenticated peers,
      while the Router Alert Option can be received in a datagram with
      any source address and any destination address.  However, we note
      that the effectiveness of such BGP filtering is dependent on
      proper security practices; poor BGP security practices (such as
      infrequent or nonexistent update of BGP peers' authentication
      keys) create vulnerabilities through which the BGP authentication
      mechanisms can be compromised.

   o  With BGP peering, the control plane hole is only open on the edge
      routers, and core routers are completely isolated from any direct
      control plane exchange with entities outside the administrative
      domain.  Thus, with BGP, a DoS attack would only affect the edge
      routers, while with the Router Alert Option, the attack could
      propagate to core routers.  However, in some BGP environments, the
      distinction between edge and core routers is not strict, and many/
      most/all routers act as both edge and core routers; in such BGP
      environments, a large part of the network is exposed to direct
      control plane exchanges with entities outside the administrative
      domain (as it would be with Router Alert).

   o  With BGP, the BGP policy control would typically prevent re-
      injection of undesirable information out of the attacked device,
      while with the Router Alert Option, the non-filtered attacking
      messages would typically be forwarded downstream.  However, we
      note that there have been real-life occurrences of situations
      where incorrect information was propagated through the BGP system,
      causing widespread problems.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Guidelines%20for%20Use%20of%20Router%20Alert"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Guidelines for Use of Router Alert</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Use%20of%20Router%20Alert%20End%20to%20End%20in%20the%20Internet%20%28Router%20Alert%20in"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Use of Router Alert End to End in the Internet (Router Alert in</span>
<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/Peer%20Model%29"></a>      Peer Model)</span>

   Because of the security concerns associated with Router Alert
   discussed in <a href="#section-3">Section 3</a>, network operators SHOULD actively protect
   themselves against externally generated IP Router Alert packets.
   Because there are no convenient universal mechanisms to triage
   between desired and undesired Router Alert packets, network operators



<span class="grey">Le Faucheur               Best Current Practice                 [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6398.html">RFC 6398</a>               Router Alert Considerations          October 2011</span>


   currently often protect themselves in ways that isolate them from
   externally generated IP Router Alert packets.  This might be achieved
   by tunneling IP Router Alert packets [<a href="rfc6178.html" title='"Label Edge Router Forwarding of IPv4 Option Packets"'>RFC6178</a>] so that the IP Router
   Alert Option is hidden through that network, or it might be achieved
   via mechanisms resulting in occasional (e.g., rate limiting) or
   systematic drop of IP Router Alert packets.

   Thus, applications and protocols SHOULD NOT be deployed with a
   dependency on processing of the Router Alert Option (as currently
   specified) across independent administrative domains in the Internet.
   Figure 1 illustrates such a hypothetical use of Router Alert end to
   end in the Internet.  We refer to such a model of Router Alert Option
   use as a "Peer Model" Router Alert Option use, since core routers in
   different administrative domains would partake in processing of
   Router Alert Option datagrams associated with the same signaling
   flow.

       --------         --------          --------          --------
      /   A    \       /   B    \        /   C    \        /   D    \
      | (*)    |       | (*)    |        | (*)    |        | (*)    |
      | | |&lt;============&gt;| |&lt;=============&gt;| |&lt;=============&gt;| |    |
      |  -     |       |  -     |        |  -     |        |  -     |
      \        /       \        /        \        /        \        /
       --------         --------          --------          --------

       (*) closer examination of Router Alert Option datagrams

       &lt;==&gt;  flow of Router Alert Option datagrams

       Figure 1: Use of Router Alert End to End in the Open Internet
                       (Router Alert in Peer Model)

   While this recommendation is framed here specifically in the context
   of Router Alert, the fundamental security risk that network operators
   want to preclude is to allow devices/protocols that are outside of
   their administrative domain (and therefore not controlled) to tap
   into the control plane of their core routers.  Similar security
   concerns would probably result whether this control plane access is
   provided through the Router Alert Option or provided by any other
   mechanism (e.g., deep packet inspection).  In other words, the
   fundamental security concern is associated with the notion of end-to-
   end signaling in a Peer Model across domains in the Internet.  As a
   result, it is expected that network operators would typically not
   want to have their core routers partake in end-to-end signaling with
   external uncontrolled devices through the open Internet, and
   therefore prevent deployment of end-to-end signaling in a Peer Model
   through their network (regardless of whether that signaling uses
   Router Alert or not).



<span class="grey">Le Faucheur               Best Current Practice                 [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6398.html">RFC 6398</a>               Router Alert Considerations          October 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Use%20of%20Router%20Alert%20in%20Controlled%20Environments"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Use of Router Alert in Controlled Environments</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.1.%20%20Use%20of%20Router%20Alert%20within%20an%20Administrative%20Domain"></a><a class="selflink" href="#section-4.2.1" name="section-4.2.1">4.2.1</a>.  Use of Router Alert within an Administrative Domain</span>

   In some controlled environments, such as within a given
   administrative domain, the network administrator can determine that
   IP Router Alert packets will only be received from trusted well-
   behaved devices or can establish that specific protection mechanisms
   (e.g., RAO filtering and rate limiting) against the plausible RAO-
   based DoS attacks are sufficient.  In that case, an application
   relying on exchange and handling of RAO packets (e.g., RSVP) can be
   safely deployed within the controlled network.  A private enterprise
   network firewalled from the Internet and using RSVP reservations for
   voice and video flows might be an example of such a controlled
   environment.  Such an environment is illustrated in Figure 2.

      -------------------------          --------          --------
     /            A            \        /   B    \        /   C    \
     | (*)              (*)    |   --   |        |        |        |
     | | |&lt;============&gt;| |    |--|FW|--|        |--------|        |
     |  -                -     |   --   |        |        |        |
     \                         /        \        /        \        /
      -------------------------          --------          --------

      (*) closer examination of Router Alert Option datagrams

      &lt;==&gt;  flow of Router Alert Option datagrams

      FW: Firewall

      Figure 2: Use of Router Alert within an Administrative Domain -
          Private Enterprise Network Firewalled from the Internet
                        and Using RSVP Reservations

   In some controlled environments, several administrative domains have
   a special relationship whereby they cooperate very tightly and
   effectively operate as a single trust domain.  In that case, one
   domain is willing to trust another with respect to the traffic
   injected across the boundary.  In other words, a downstream domain is
   willing to trust that the traffic injected at the boundary has been
   properly validated/filtered by the upstream domain.  Where it has
   been established that such trust can be applied to Router Alert
   Option packets, an application relying on exchange and handling of
   RAO packets (e.g., RSVP) can be safely deployed within such a
   controlled environment.  The entity within a company responsible for
   operating multimedia endpoints and the entity within the same company





<span class="grey">Le Faucheur               Best Current Practice                 [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6398.html">RFC 6398</a>               Router Alert Considerations          October 2011</span>


   responsible for operating the network might be an example of such a
   controlled environment.  For example, they might collaborate so that
   RSVP reservations can be used for video flows from endpoints to
   endpoints through the network.

   In some environments, the network administrator can reliably ensure
   that Router Alert packets from any untrusted device (e.g., from
   external routers) are prevented from entering a trusted area (e.g.,
   the internal routers).  For example, this might be achieved by
   ensuring that routers straddling the trust boundary (e.g., edge
   routers) always encapsulate those packets (without setting IP Router
   Alert -or equivalent- in the encapsulating header) through the
   trusted area (as discussed in [<a href="rfc6178.html" title='"Label Edge Router Forwarding of IPv4 Option Packets"'>RFC6178</a>]).  In such environments, the
   risks of DoS attacks through the IP Router Alert vector are removed
   (or greatly reduced) in the trusted area even if IP Router Alert is
   used inside the trusted area (say, for RSVP-TE).  Thus, an
   application relying on IP Router Alert can be safely deployed within
   the trusted area.  A service provider running RSVP-TE within its
   network might be an example of such a protected environment.  Such an
   environment is illustrated in Figure 3.

      --------         --------------------------          --------
     /   A    \       /             B            \        /   C    \
     |        |       |  (*)               (*)   |        |        |
     |        |-------TT | |&lt;=============&gt;| |  TT------- |        |
     |        |       |   -                 -    |        |        |
     \        /       \                          /        \        /
      --------         --------------------------          --------

      (*) closer examination of Router Alert Option datagrams

      &lt;==&gt;  flow of Router Alert Option datagrams

      TT: Tunneling of Router Alert Option datagrams

      Figure 3: Use of Router Alert within an Administrative Domain -
            Service Provider Running RSVP-TE within Its Network














<span class="grey">Le Faucheur               Best Current Practice                [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc6398.html">RFC 6398</a>               Router Alert Considerations          October 2011</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.2.%20%20Use%20of%20Router%20Alert%20in%20Overlay%20Model"></a><a class="selflink" href="#section-4.2.2" name="section-4.2.2">4.2.2</a>.  Use of Router Alert in Overlay Model</span>

   In some controlled environment:

   o  The sites of a network A are interconnected through a service
      provider network B.

   o  The service provider network B protects itself from IP Router
      Alert messages without dropping those messages when they transit
      over the network (for example, using mechanisms discussed in
      [<a href="rfc6178.html" title='"Label Edge Router Forwarding of IPv4 Option Packets"'>RFC6178</a>]).

   In such a controlled environment, an application relying on exchange
   and handling of RAO packets (e.g., RSVP) in the network A sites (but
   not inside network B) can be safely deployed.  We refer to such a
   deployment as a use of Router Alert in a Water-Tight Overlay --
   "Overlay", because Router Alert Option datagrams are used in network
   A on top of, and completely transparently to, network B; and
   "Water-Tight", because Router Alert Option datagrams from network A
   cannot leak inside network B.  A private enterprise intranet realized
   as a Virtual Private Network (VPN) over a service provider network
   and using RSVP to perform reservations within the enterprise sites
   for voice and video flows might be an example of such a controlled
   environment.  Such an environment is illustrated in Figure 4.

          --------                                --------
         /   A    \                              /   A    \
         | (*)    |                              |   (*)  |
         | | |&lt;=====================================&gt;| |  |
         |  -     |                              |    -   |
         \        /                              \        /
          --------                                --------
                \                                 /
                 \   -------------------------   /
                  \ /           B             \ /
                   \|                         |/
                    TT                       TT
                    |                         |
                    \                         /
                     -------------------------

        (*) closer examination of Router Alert Option datagrams

        &lt;==&gt;  flow of Router Alert Option datagrams

        TT: Tunneling of Router Alert Option datagrams

           Figure 4: Use of Router Alert in Water-Tight Overlay



<span class="grey">Le Faucheur               Best Current Practice                [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc6398.html">RFC 6398</a>               Router Alert Considerations          October 2011</span>


   In the controlled environment described above, an application relying
   on exchange and handling of RAO packets (e.g., RSVP-TE) in the
   service provider network B (but not in network A) can also be safely
   deployed simultaneously.  Such an environment with independent,
   isolated deployment of Router Alert in overlay at two levels is
   illustrated in Figure 5.

          --------                                --------
         /   A    \                              /   A    \
         | (*)    |                              |   (*)  |
         | | |&lt;=====================================&gt;| |  |
         |  -     |                              |    -   |
         \        /                              \        /
          --------                                --------
                \                                 /
                 \   -------------------------   /
                  \ /           B             \ /
                   \|  (*)              (*)   |/
                    TT | |&lt;============&gt;| | TT
                    |   -                -    |
                    \                         /
                     -------------------------

      (*) closer examination of Router Alert Option datagrams

      &lt;==&gt;  flow of Router Alert Option datagrams

      TT: Tunneling of Router Alert Option datagrams

    Figure 5: Use of Router Alert in Water-Tight Overlay at Two Levels

   In some controlled environment:

   o  The sites of a network A are interconnected through a service
      provider network B.

   o  The service provider B processes Router Alert packets on the edge
      routers and protects these edge routers against RAO-based attacks
      using mechanisms such as (possibly per port) RAO rate limiting and
      filtering.

   o  The service provider network B protects its core routers from
      Router Alert messages without dropping those messages when they
      transit over the network (for example, using mechanisms discussed
      in [<a href="rfc6178.html" title='"Label Edge Router Forwarding of IPv4 Option Packets"'>RFC6178</a>]).






<span class="grey">Le Faucheur               Best Current Practice                [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc6398.html">RFC 6398</a>               Router Alert Considerations          October 2011</span>


   In such a controlled environment, an application relying on exchange
   and handling of RAO packets (e.g., RSVP) in the network A sites and
   in network B's edges (but not in the core of network B) can be safely
   deployed.  We refer to such a deployment as a use of Router Alert in
   a Leak-Controlled Overlay -- "Overlay", because Router Alert Option
   datagrams are used in network A on top of, and completely
   transparently to, network B's core; and "Leak-Controlled", because
   Router Alert Option datagrams from network A leak inside network B's
   edges but not inside network B's core.  A private enterprise
   intranet, whose sites are interconnected through a service provider
   network, using RSVP for voice and video within network A sites as
   well as on network B's edge to extend the reservation onto the
   attachment links between networks A and B (as specified in
   [<a href="rfc6016.html" title='"Support for the Resource Reservation Protocol (RSVP) in Layer 3 VPNs"'>RFC6016</a>]), might be an example of such a controlled environment.
   Such an environment is illustrated in Figure 6.

          --------                                --------
         /   A    \                              /   A    \
         |        |                              |        |
         |        |   ------------------------   |        |
         | (*)    |  /(*)              (*)    \  |   (*)  |
         | | |&lt;======&gt;| |&lt;============&gt;| |&lt;=========&gt;| |  |
         |  -     |  | -                -     |  |    -   |
         \        /  |  \    -     -   /      |  \        /
          --------   |   TT-| |   | |-TT      |   --------
                     |       -     -          |
                     \                        /
                      ------------------------

        (*) closer examination of Router Alert Option datagrams

        &lt;==&gt;  flow of Router Alert Option datagrams

        TT: Tunneling of Router Alert Option datagrams

         Figure 6: Use of Router Alert in Leak-Controlled Overlay

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Router%20Alert%20Protection%20Approaches%20for%20Service%20Providers"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Router Alert Protection Approaches for Service Providers</span>

   <a href="#section-3">Section 3</a> discusses the security risks associated with the use of the
   IP Router Alert and how it opens up a DoS vector in the router
   control plane.  Thus, a service provider MUST implement strong
   protection of its network against attacks based on IP Router Alert.

   As discussed in <a href="#section-4.2.2">Section 4.2.2</a>, some applications can benefit from the
   use of IP Router Alert packets in an Overlay Model (i.e., where
   Router Alert packets are exchanged transparently on top of a service
   provider).  Thus, a service provider protecting its network from



<span class="grey">Le Faucheur               Best Current Practice                [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc6398.html">RFC 6398</a>               Router Alert Considerations          October 2011</span>


   attacks based on IP Router Alert SHOULD use mechanisms that avoid (or
   at least minimize) the dropping of end-to-end IP Router Alert packets
   (other than those involved in an attack).

   For example, if the service provider does not run any protocol
   depending on IP Router Alert within its network, it might elect to
   simply turn off punting/processing of IP Router Alert packets on its
   routers; this will ensure that end-to-end IP Router Alert packets
   transit transparently and safely through its network.

   As another example, using protection mechanisms such as selective
   filtering and rate limiting (which <a href="#section-5">Section 5</a> suggests be supported by
   IP Router Alert implementations), a service provider can protect the
   operation of a protocol depending on IP Router Alert within its
   network (e.g., RSVP-TE) while at the same time transporting IP Router
   Alert packets carrying another protocol that might be used end to
   end.  Note that the service provider might additionally use protocol-
   specific mechanisms that reduce the dependency on Router Alert for
   operation of this protocol inside the service provider environment;
   use of RSVP refresh reduction mechanisms ([<a href="rfc2961.html" title='"RSVP Refresh Overhead Reduction Extensions"'>RFC2961</a>]) would be an
   example of such mechanisms in the case where the service provider is
   running RSVP-TE within its network, since this allows the refresh of
   existing Path and Resv states without the use of the IP Router Alert
   Option.

   As yet another example, using mechanisms such as those discussed in
   [<a href="rfc6178.html" title='"Label Edge Router Forwarding of IPv4 Option Packets"'>RFC6178</a>], a service provider can safely protect the operation of a
   protocol depending on IP Router Alert within its network (e.g.,
   RSVP-TE) while at the same time safely transporting IP Router Alert
   packets carrying another protocol that might be used end to end
   (e.g., IPv4/IPv6 RSVP).  We observe that while tunneling of Router
   Alert Option datagrams over an MPLS backbone as discussed in
   [<a href="rfc6178.html" title='"Label Edge Router Forwarding of IPv4 Option Packets"'>RFC6178</a>] is well understood, tunneling Router Alert Option datagrams
   over a non-MPLS IP backbone presents a number of issues (in
   particular, for determining where to forward the encapsulated
   datagram) and is not common practice at the time of writing this
   document.

   As a last resort, if the service provider does not have any means to
   safely transport end-to-end IP Router Alert Option packets over its
   network, the service provider can drop those packets.  It must be
   noted that this has the undesirable consequence of preventing the use
   of the Router Alert Option in the Overlay Model on top of that
   network, and therefore prevents users of that network from deploying
   a number of valid applications/protocols in their environment.






<span class="grey">Le Faucheur               Best Current Practice                [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc6398.html">RFC 6398</a>               Router Alert Considerations          October 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Guidelines%20for%20Router%20Alert%20Implementation"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Guidelines for Router Alert Implementation</span>

   A router implementation of the IP Router Alert Option SHOULD include
   protection mechanisms against Router-Alert-based DoS attacks as
   appropriate for their targeted deployment environments.  For example,
   this can include the ability of an edge router to "tunnel" received
   IP Router Alert Option packets when forwarding those packets over the
   core, as discussed in [<a href="rfc6178.html" title='"Label Edge Router Forwarding of IPv4 Option Packets"'>RFC6178</a>].  As another example, although not
   always available from current implementations, new implementations
   MAY include protection mechanisms such as selective (possibly
   dynamic) filtering and rate limiting of IP Router Alert Option
   packets.

   In particular, router implementations of the IP Router Alert Option
   SHOULD offer the configuration option to simply ignore the presence
   of "IP Router Alert" in IPv4 and IPv6 packets.  As discussed in
   <a href="#section-4.3">Section 4.3</a>, that permits IP Router Alert packets to transit a
   network segment without presenting an adverse operational security
   risk to that particular network segment, provided the operator of
   that network segment does not ever use the IP Router Alert messages
   for any purpose.

   If an IP packet contains the IP Router Alert Option, but the next
   level protocol is not explicitly identified as a protocol of interest
   by the router examining the packet, the behavior is not explicitly
   defined by [<a href="rfc2113.html" title='"IP Router Alert Option"'>RFC2113</a>].  However, the behavior is implied, and, for
   example, the definition of RSVP in [<a href="rfc2205.html" title='"Resource ReSerVation Protocol (RSVP) -- Version 1 Functional Specification"'>RFC2205</a>] assumes that the packet
   will be forwarded using normal forwarding based on the destination IP
   address.  Thus, a router implementation SHOULD forward within the
   "fast path" (subject to all normal policies and forwarding rules) a
   packet carrying the IP Router Alert Option containing a next level
   protocol that is not a protocol of interest to that router.  The "not
   punting" behavior protects the router from DoS attacks using IP
   Router Alert packets of a protocol unknown to the router.  The
   "forwarding" behavior contributes to transparent end-to-end transport
   of IP Router Alert packets (e.g., to facilitate their use by end-to-
   end applications).

   Similarly, an implementation MAY support selective forwarding within
   the fast path (subject to all normal policies and forwarding rules)
   or punting of a packet with the IP Router Alert Option, based on the
   Value field of the Router Alert Option.  This would allow router
   protection against DoS attacks using IP Router Alert packets with a
   value that is not relevant for that router (e.g., nesting levels of
   aggregated RSVP reservation [<a href="rfc5350.html" title='"IANA Considerations for the IPv4 and IPv6 Router Alert Options"'>RFC5350</a>]).






<span class="grey">Le Faucheur               Best Current Practice                [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc6398.html">RFC 6398</a>               Router Alert Considerations          October 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Security Considerations</span>

   This document expands the security considerations of [<a href="rfc2113.html" title='"IP Router Alert Option"'>RFC2113</a>] and
   [<a href="rfc2711.html" title='"IPv6 Router Alert Option"'>RFC2711</a>], which define the IPv4 and IPv6 RAOs, respectively, by
   discussing security risks associated with usage of the current IP
   Router Alert Option and associated practices.  See [<a href="rfc4081.html" title='"Security Threats for Next Steps in Signaling (NSIS)"'>RFC4081</a>] for
   additional security considerations.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Contributors"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Contributors</span>

   The contributors to this document (in addition to the editor) are:

      Reshad Rahman
      Cisco Systems
      rrahman@cisco.com

      David Ward
      Juniper Networks
      dward@juniper.net

      Ashok Narayanan
      Cisco Systems
      ashokn@cisco.com

      Adrian Farrel
      OldDog Consulting
      adrian@olddog.co.uk

      Tony Li
      Cisco Systems
      tony.li@tony.li

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Acknowledgments"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Acknowledgments</span>

   The editor and contributors would like to thank Dave Oran, Magnus
   Westerlund, John Scudder, Ron Bonica, Ross Callon, Alfred Hines,
   Carlos Pignataro, Roland Bless, Jari Arkko, and Ran Atkinson for
   their comments.  This document also benefited from discussions with
   Jukka Manner and Suresh Krishnan.  The discussion about use of the
   Value field in the IPv4 Router Alert is borrowed from a similar
   discussion in [<a href="rfc5971.html" title='"GIST: General Internet Signalling Transport"'>RFC5971</a>].










<span class="grey">Le Faucheur               Best Current Practice                [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc6398.html">RFC 6398</a>               Router Alert Considerations          October 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20References"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20Normative%20References"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  Normative References</span>

   [<a id="ref-RFC0791" name="ref-RFC0791">RFC0791</a>]  Postel, J., "Internet Protocol", STD 5, <a href="rfc791.html">RFC 791</a>,
              September 1981.

   [<a id="ref-RFC2113" name="ref-RFC2113">RFC2113</a>]  Katz, D., "IP Router Alert Option", <a href="rfc2113.html">RFC 2113</a>,
              February 1997.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC2460" name="ref-RFC2460">RFC2460</a>]  Deering, S. and R. Hinden, "Internet Protocol, Version 6
              (IPv6) Specification", <a href="rfc2460.html">RFC 2460</a>, December 1998.

   [<a id="ref-RFC2711" name="ref-RFC2711">RFC2711</a>]  Partridge, C. and A. Jackson, "IPv6 Router Alert Option",
              <a href="rfc2711.html">RFC 2711</a>, October 1999.

   [<a id="ref-RFC5350" name="ref-RFC5350">RFC5350</a>]  Manner, J. and A. McDonald, "IANA Considerations for the
              IPv4 and IPv6 Router Alert Options", <a href="rfc5350.html">RFC 5350</a>,
              September 2008.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20Informative%20References"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  Informative References</span>

   [<a id="ref-IPv6-HOPBYHOP" name="ref-IPv6-HOPBYHOP">IPv6-HOPBYHOP</a>]
              Krishnan, S., <a href="https://www.google.com/search?sitesearch=tools.ietf.org%2Fhtml%2F&amp;q=inurl:draft-+%22The+case+against+Hop-by-Hop+options%22" style="text-decoration: none">"The case against Hop-by-Hop options"</a>, Work
              in Progress, October 2010.

   [<a id="ref-RAO-EXT" name="ref-RAO-EXT">RAO-EXT</a>]  Narayanan, A., Le Faucheur, F., Ward, D., and R. Rahman,
              "IP Router Alert Option Extension", Work in Progress,
              March 2009.

   [<a id="ref-RFC2205" name="ref-RFC2205">RFC2205</a>]  Braden, R., Ed., Zhang, L., Berson, S., Herzog, S., and S.
              Jamin, "Resource ReSerVation Protocol (RSVP) -- Version 1
              Functional Specification", <a href="rfc2205.html">RFC 2205</a>, September 1997.

   [<a id="ref-RFC2710" name="ref-RFC2710">RFC2710</a>]  Deering, S., Fenner, W., and B. Haberman, "Multicast
              Listener Discovery (MLD) for IPv6", <a href="rfc2710.html">RFC 2710</a>,
              October 1999.

   [<a id="ref-RFC2961" name="ref-RFC2961">RFC2961</a>]  Berger, L., Gan, D., Swallow, G., Pan, P., Tommasi, F.,
              and S. Molendini, "RSVP Refresh Overhead Reduction
              Extensions", <a href="rfc2961.html">RFC 2961</a>, April 2001.

   [<a id="ref-RFC3175" name="ref-RFC3175">RFC3175</a>]  Baker, F., Iturralde, C., Le Faucheur, F., and B. Davie,
              "Aggregation of RSVP for IPv4 and IPv6 Reservations",
              <a href="rfc3175.html">RFC 3175</a>, September 2001.



<span class="grey">Le Faucheur               Best Current Practice                [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc6398.html">RFC 6398</a>               Router Alert Considerations          October 2011</span>


   [<a id="ref-RFC3208" name="ref-RFC3208">RFC3208</a>]  Speakman, T., Crowcroft, J., Gemmell, J., Farinacci, D.,
              Lin, S., Leshchiner, D., Luby, M., Montgomery, T., Rizzo,
              L., Tweedly, A., Bhaskar, N., Edmonstone, R.,
              Sumanasekera, R., and L. Vicisano, "PGM Reliable Transport
              Protocol Specification", <a href="rfc3208.html">RFC 3208</a>, December 2001.

   [<a id="ref-RFC3209" name="ref-RFC3209">RFC3209</a>]  Awduche, D., Berger, L., Gan, D., Li, T., Srinivasan, V.,
              and G. Swallow, "RSVP-TE: Extensions to RSVP for LSP
              Tunnels", <a href="rfc3209.html">RFC 3209</a>, December 2001.

   [<a id="ref-RFC3376" name="ref-RFC3376">RFC3376</a>]  Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A.
              Thyagarajan, "Internet Group Management Protocol,
              Version 3", <a href="rfc3376.html">RFC 3376</a>, October 2002.

   [<a id="ref-RFC3810" name="ref-RFC3810">RFC3810</a>]  Vida, R., Ed., and L. Costa, Ed., "Multicast Listener
              Discovery Version 2 (MLDv2) for IPv6", <a href="rfc3810.html">RFC 3810</a>,
              June 2004.

   [<a id="ref-RFC4081" name="ref-RFC4081">RFC4081</a>]  Tschofenig, H. and D. Kroeselberg, "Security Threats for
              Next Steps in Signaling (NSIS)", <a href="rfc4081.html">RFC 4081</a>, June 2005.

   [<a id="ref-RFC4286" name="ref-RFC4286">RFC4286</a>]  Haberman, B. and J. Martin, "Multicast Router Discovery",
              <a href="rfc4286.html">RFC 4286</a>, December 2005.

   [<a id="ref-RFC4732" name="ref-RFC4732">RFC4732</a>]  Handley, M., Ed., Rescorla, E., Ed., and IAB, "Internet
              Denial-of-Service Considerations", <a href="rfc4732.html">RFC 4732</a>,
              December 2006.

   [<a id="ref-RFC5971" name="ref-RFC5971">RFC5971</a>]  Schulzrinne, H. and R. Hancock, "GIST: General Internet
              Signalling Transport", <a href="rfc5971.html">RFC 5971</a>, October 2010.

   [<a id="ref-RFC6016" name="ref-RFC6016">RFC6016</a>]  Davie, B., Le Faucheur, F., and A. Narayanan, "Support for
              the Resource Reservation Protocol (RSVP) in Layer 3 VPNs",
              <a href="rfc6016.html">RFC 6016</a>, October 2010.

   [<a id="ref-RFC6178" name="ref-RFC6178">RFC6178</a>]  Smith, D., Mullooly, J., Jaeger, W., and T. Scholl, "Label
              Edge Router Forwarding of IPv4 Option Packets", <a href="rfc6178.html">RFC 6178</a>,
              March 2011.













<span class="grey">Le Faucheur               Best Current Practice                [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc6398.html">RFC 6398</a>               Router Alert Considerations          October 2011</span>


Author's Address

   Francois Le Faucheur (editor)
   Cisco Systems
   Greenside, 400 Avenue de Roumanille
   Sophia Antipolis  06410
   France

   Phone: +33 4 97 23 26 19
   EMail: flefauch@cisco.com









































Le Faucheur               Best Current Practice                [Page 19]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc6398 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:30 GMT --></html>