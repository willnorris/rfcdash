<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7314 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:22 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:7314" name="DC.Identifier"/>
<meta content="This document specifies a method for secondary DNS servers to honour
the SOA EXPIRE field as if they were always transferring from the
primary, even when using other secondaries to perform indirect
transfers and refresh queries." name="DC.Description.Abstract"/>
<meta content="Mark Andrews &lt;marka@isc.org&gt;" name="DC.Creator"/>
<meta content="July, 2014" name="DC.Date.Issued"/>
<meta content="Extension Mechanisms for DNS (EDNS) EXPIRE Option" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7314 - Extension Mechanisms for DNS (EDNS) EXPIRE Option</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgyellow" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7314.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7314" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-andrews-dnsext-expire" title="draft-andrews-dnsext-expire">draft-andrews-d...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7314" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7314" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7314" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                            EXPERIMENTAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Independent Submission                                        M. Andrews
Request for Comments: 7314                                           ISC
Category: Experimental                                         July 2014
ISSN: 2070-1721


           <span class="h1">Extension Mechanisms for DNS (EDNS) EXPIRE Option</span>

Abstract

   This document specifies a method for secondary DNS servers to honour
   the SOA EXPIRE field as if they were always transferring from the
   primary, even when using other secondaries to perform indirect
   transfers and refresh queries.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for examination, experimental implementation, and
   evaluation.

   This document defines an Experimental Protocol for the Internet
   community.  This is a contribution to the RFC Series, independently
   of any other RFC stream.  The RFC Editor has chosen to publish this
   document at its discretion and makes no statement about its value for
   implementation or deployment.  Documents approved for publication by
   the RFC Editor are not a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">SectionÂ 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7314">http://www.rfc-editor.org/info/rfc7314</a>.

Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.







<span class="grey">Andrews                       Experimental                      [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7314.html">RFC 7314</a>    Extension Mechanisms for DNS (EDNS) EXPIRE Option  July 2014</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
     <a href="#section-1.1">1.1</a>.  Reserved Words  . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
   <a href="#section-2">2</a>.  Expire EDNS Option (Query)  . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  Expire EDNS Option (Response) . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-3.1">3.1</a>.  Primary Server  . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-3.2">3.2</a>.  Secondary Server  . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-3.3">3.3</a>.  Non-authoritative Server  . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-4">4</a>.  Secondary Behaviour . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-5">5</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-6">6</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-7">7</a>.  Normative References  . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The expire field of a DNS zone's SOA record [<a href="rfc1035.html" title='"Domain names - implementation and specification"'>RFC1035</a>] is supposed to
   indicate when a secondary server shall discard the contents of the
   zone when it has been unable to contact the primary [<a href="rfc1034.html" title='"Domain names - concepts and facilities"'>RFC1034</a>].
   Current practice only works when all the secondaries contact the
   primary directly to perform refresh queries and zone transfers.

   While secondaries are expected to be able to, and often are
   configured to, transfer from other secondaries for robustness reasons
   as well as reachability constraints, there is no mechanism provided
   to preserve the expiry behaviour when using a secondary.  Instead,
   secondaries have to know whether they are talking directly to the
   primary or another secondary and use that to decide whether or not to
   update the expire timer.  This, however, fails to take into account
   delays in transferring from one secondary to another.

   There are also zone-transfer graphs in which the secondary never
   talks to the primary, so the effective expiry period becomes
   multiplied by the length of the zone-transfer graph, which is
   infinite when it contains loops.

   This document provides a mechanism to preserve the expiry behaviour
   regardless of what zone-transfer graph is constructed and whether the
   secondary is talking to the primary or another secondary.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Reserved%20Words"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Reserved Words</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].






<span class="grey">Andrews                       Experimental                      [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7314.html">RFC 7314</a>    Extension Mechanisms for DNS (EDNS) EXPIRE Option  July 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Expire%20EDNS%20Option%20%28Query%29"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Expire EDNS Option (Query)</span>

   The EDNS [<a href="rfc6891.html" title='"Extension Mechanisms for DNS (EDNS(0))"'>RFC6891</a>] EXPIRE option has the value &lt;9&gt;.  The EDNS EXPIRE
   option MAY be included on any QUERY, though usually this is only done
   on SOA, AXFR, and IXFR queries involved in zone maintenance.  This is
   done by adding a zero-length EDNS EXPIRE option to the options field
   of the OPT record when the query is made.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Expire%20EDNS%20Option%20%28Response%29"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Expire EDNS Option (Response)</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Primary%20Server"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Primary Server</span>

   When the query is directed to the primary server for the zone, the
   response will be an EDNS EXPIRE option of length 4 containing the
   value of the SOA EXPIRE field, in seconds and network byte order.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Secondary%20Server"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Secondary Server</span>

   When the query is directed to a secondary server for the zone, then
   the response will be an EDNS EXPIRE option of length 4 containing the
   value of the expire timer on that server, in seconds and network byte
   order.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Non-authoritative%20Server"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Non-authoritative Server</span>

   If an EDNS EXPIRE option is sent to a server that is not
   authoritative for the zone, it MUST NOT add an EDNS EXPIRE option to
   the response.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Secondary%20Behaviour"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Secondary Behaviour</span>

   When a secondary server performs a zone-transfer request or a zone-
   refresh query, it SHALL add an EDNS EXPIRE option to the query
   message.

   If a secondary receives an EDNS EXPIRE option in a response to an SOA
   query, it SHALL update its expire timer to be the maximum of the
   value returned in the EDNS EXPIRE option and the current timer value.
   Similarly, if a secondary receives an EDNS EXPIRE option in its
   response to an IXFR query that indicated the secondary is up to date
   (serial matches current serial), the secondary SHALL update the
   expire timer to be the maximum of the value returned in the EDNS
   EXPIRE option and the current timer value.

   If the zone is transferred or updated as the result of an AXFR or
   IXFR query and there is an EDNS EXPIRE option with the response, then
   the value of the EDNS EXPIRE option SHOULD be used instead of the
   value of the SOA EXPIRE field to initialise the expire timer.



<span class="grey">Andrews                       Experimental                      [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7314.html">RFC 7314</a>    Extension Mechanisms for DNS (EDNS) EXPIRE Option  July 2014</span>


   In all cases, if the value of the SOA EXPIRE field is less than the
   value of the EDNS EXPIRE option, then the value of the SOA EXPIRE
   field MUST be used and MUST be treated as a maximum when updating or
   initialising the expire timer.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  IANA Considerations</span>

   IANA has assigned an EDNS option code point for the EDNS EXPIRE
   option specified in <a href="#section-2">Section 2</a> with "Optional" status in the "DNS
   EDNS0 Option Codes (OPT)" registry.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Security Considerations</span>

   The method described in this document ensures that servers that no
   longer have a connection to the primary server, direct or indirectly,
   cease serving the zone content when SOA EXPIRE timer is reached.
   This prevents stale data from being served indefinitely.

   The EDNS EXPIRE option exposes how long the secondaries have been out
   of communication with the primary server.  This is not believed to be
   a problem and may provide some benefit to monitoring systems.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Normative%20References"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Normative References</span>

   [<a id="ref-RFC1034" name="ref-RFC1034">RFC1034</a>]  Mockapetris, P., "Domain names - concepts and facilities",
              STD 13, <a href="rfc1034.html">RFC 1034</a>, November 1987.

   [<a id="ref-RFC1035" name="ref-RFC1035">RFC1035</a>]  Mockapetris, P., "Domain names - implementation and
              specification", STD 13, <a href="rfc1035.html">RFC 1035</a>, November 1987.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC6891" name="ref-RFC6891">RFC6891</a>]  Damas, J., Graff, M., and P. Vixie, "Extension Mechanisms
              for DNS (EDNS(0))", STD 75, <a href="rfc6891.html">RFC 6891</a>, April 2013.

Author's Address

   Mark P. Andrews
   Internet Systems Consortium
   950 Charter Street
   Redwood City, CA  94063
   US

   EMail: marka@isc.org






Andrews                       Experimental                      [Page 4]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7314 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:22 GMT --></html>