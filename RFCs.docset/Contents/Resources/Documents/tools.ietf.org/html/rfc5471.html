<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc5471 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Aug 2018 14:27:34 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.127" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-schmoll-ipfix-testing" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:5471" name="DC.Identifier"/>
<meta content="March, 2009" name="DC.Date.Issued"/>
<meta content="Aitken, Paul" name="DC.Creator"/>
<meta content="Schmoll, Carsten" name="DC.Creator"/>
<meta content="This document presents a list of tests that implementers of IP Flow
Information Export (IPFIX) compliant Exporting Processes and
Collecting Processes should perform on their IPFIX Exporting Process
and/or Collecting Process. This document has been created to help
implementers test the functionality of their IPFIX Exporting Process
and/or Collecting Process. The goal of these tests is to ensure that
all important functions are covered by tests and thereby to gain a
level of confidence in the Exporting Process and Collecting Process
that allows the implementer to perform interoperability or plug tests
with other IPFIX Exporting Processes and Collecting Processes." name="DC.Description.Abstract"/>
<meta content="IP Flow Information eXport (IPFIX) Testing" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5471 - IP Flow Information eXport (IPFIX) Testing</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc5471.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc5471" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-ipfix-testing" title="draft-ietf-ipfix-testing">draft-ietf-ipfi...</a>] [<a href="https://datatracker.ietf.org/doc/rfc5471" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5471" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc5471" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                         C. Schmoll
Request for Comments: 5471                              Fraunhofer FOKUS
Category: Informational                                        P. Aitken
                                                               B. Claise
                                                     Cisco Systems, Inc.
                                                              March 2009


       <span class="h1">Guidelines for IP Flow Information Export (IPFIX) Testing</span>

Status of This Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Copyright Notice

   Copyright (c) 2009 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents in effect on the date of
   publication of this document (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>).
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.













<span class="grey">Schmoll, et al.              Informational                      [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


Abstract

   This document presents a list of tests for implementers of IP Flow
   Information eXport (IPFIX) compliant Exporting Processes and
   Collecting Processes.  This document specifies guidelines for a
   series of tests that can be run on the IPFIX Exporting Process and
   Collecting Process in order to probe the conformity and robustness of
   the IPFIX protocol implementations.  These tests cover all important
   functions, in order to gain a level of confidence in the IPFIX
   implementation.  Therefore, they allow the implementer to perform
   interoperability or plug tests with other IPFIX Exporting Processes
   and Collecting Processes.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-4">4</a>
      <a href="#section-1.1">1.1</a>. Document Scope .............................................<a href="#page-4">4</a>
      <a href="#section-1.2">1.2</a>. IPFIX Documents Overview ...................................<a href="#page-5">5</a>
   <a href="#section-2">2</a>. Terminology .....................................................<a href="#page-5">5</a>
      <a href="#section-2.1">2.1</a>. Conventions Used in This Document ..........................<a href="#page-5">5</a>
   <a href="#section-3">3</a>. Test Specifications .............................................<a href="#page-5">5</a>
      <a href="#section-3.1">3.1</a>. Exporting Process/Collecting Process Connectivity Tests ....<a href="#page-6">6</a>
           3.1.1. Connectivity Tests between the Exporting
                  Process and Collecting ..............................<a href="#page-6">6</a>
      <a href="#section-3.2">3.2</a>. Template and Data Record Tests .............................<a href="#page-6">6</a>
           3.2.1. Transmission of Template with Fixed-Size
                  Information Elements ................................<a href="#page-7">7</a>
           3.2.2. Transmission of Template with
                  Variable-Length Information Elements ................<a href="#page-7">7</a>
           <a href="#section-3.2.3">3.2.3</a>. Set Padding .........................................<a href="#page-7">7</a>
           <a href="#section-3.2.4">3.2.4</a>. Record Padding ......................................<a href="#page-8">8</a>
           <a href="#section-3.2.5">3.2.5</a>. Template Withdrawal Message .........................<a href="#page-9">9</a>
      <a href="#section-3.3">3.3</a>. Information Element Tests .................................<a href="#page-11">11</a>
           <a href="#section-3.3.1">3.3.1</a>. Enterprise-Specific Information Elements ...........<a href="#page-11">11</a>
           <a href="#section-3.3.2">3.3.2</a>. Reduced Size Encoding of Information Elements ......<a href="#page-11">11</a>
           3.3.3. Multiple Instances of the Same Information
                  Element in One Template.............................<a href="#page-12">12</a>
      <a href="#section-3.4">3.4</a>. Options Template Tests ....................................<a href="#page-12">12</a>
           <a href="#section-3.4.1">3.4.1</a>. Using Any Information Elements as Scope ............<a href="#page-12">12</a>
           <a href="#section-3.4.2">3.4.2</a>. Using Multiple Scopes ..............................<a href="#page-13">13</a>
           <a href="#section-3.4.3">3.4.3</a>. Metering Process Statistics Option Template ........<a href="#page-13">13</a>
           3.4.4. Metering Process Reliability Statistics
                  Option Template ....................................<a href="#page-14">14</a>
           3.4.5. Exporting Process Reliability Statistics
                  Option Template ....................................<a href="#page-14">14</a>
           <a href="#section-3.4.6">3.4.6</a>. Flow Keys Option Template ..........................<a href="#page-14">14</a>





<span class="grey">Schmoll, et al.              Informational                      [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


      <a href="#section-3.5">3.5</a>. Stress/Load Tests .........................................<a href="#page-15">15</a>
           <a href="#section-3.5.1">3.5.1</a>. Large Number of Records for One Template ...........<a href="#page-15">15</a>
           <a href="#section-3.5.2">3.5.2</a>. Excessive Rate of Incoming Data Records ............<a href="#page-15">15</a>
           <a href="#section-3.5.3">3.5.3</a>. Large Templates ....................................<a href="#page-16">16</a>
           3.5.4. Many New Templates within the Data Template
                  Timeout Interval ...................................<a href="#page-16">16</a>
           3.5.5. Multiple Exporting Processes Exporting to
                  One Collecting Process .............................<a href="#page-17">17</a>
           3.5.6. Export from One Exporting Process to
                  Multiple Collecting Processes ......................<a href="#page-17">17</a>
      <a href="#section-3.6">3.6</a>. Error Handling ............................................<a href="#page-17">17</a>
           <a href="#section-3.6.1">3.6.1</a>. Temporary Network Disconnect .......................<a href="#page-17">17</a>
           3.6.2. Exporting Process Termination and Restart
                  during Data Transmission ...........................<a href="#page-18">18</a>
           3.6.3. Collecting Process Termination and Restart
                  during Data Transmission ...........................<a href="#page-18">18</a>
           3.6.4. Incorrect Template Records and Options
                  Template Records ...................................<a href="#page-19">19</a>
           <a href="#section-3.6.5">3.6.5</a>. Incorrect Data Record ..............................<a href="#page-22">22</a>
           <a href="#section-3.6.6">3.6.6</a>. Export of Non-Matching Template and Data Records ...<a href="#page-23">23</a>
           <a href="#section-3.6.7">3.6.7</a>. Unknown Set IDs ....................................<a href="#page-23">23</a>
           <a href="#section-3.6.8">3.6.8</a>. Re-Using Template IDs ..............................<a href="#page-24">24</a>
      <a href="#section-3.7">3.7</a>. TLS Connectivity and Policy Selection .....................<a href="#page-28">28</a>
           <a href="#section-3.7.1">3.7.1</a>. TLS Test Setup .....................................<a href="#page-28">28</a>
           <a href="#section-3.7.2">3.7.2</a>. TLS over TCP Connectivity Test .....................<a href="#page-29">29</a>
           <a href="#section-3.7.3">3.7.3</a>. DTLS over UDP Connectivity Test ....................<a href="#page-29">29</a>
           <a href="#section-3.7.4">3.7.4</a>. DTLS over PR-SCTP Connectivity Test ................<a href="#page-29">29</a>
           <a href="#section-3.7.5">3.7.5</a>. TLS Bidirectional Authentication Policy Test .......<a href="#page-30">30</a>
           3.7.6. Exporting Process Identity Mismatch TLS
                  Policy Test ........................................<a href="#page-30">30</a>
           3.7.7. Collecting Process Identity Mismatch TLS
                  Policy Test ........................................<a href="#page-30">30</a>
   <a href="#section-4">4</a>. Security Considerations ........................................<a href="#page-30">30</a>
   <a href="#section-5">5</a>. Acknowledgments ................................................<a href="#page-31">31</a>
   <a href="#section-6">6</a>. Normative References ...........................................<a href="#page-31">31</a>
















<span class="grey">Schmoll, et al.              Informational                      [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   An IPFIX implementation, whether in software, firmware, or hardware,
   needs to be tested thoroughly in order to check its robustness and
   gain confidence in the conformity to the IPFIX documents on which it
   is based.

   For a testable IPFIX software tool kit, one needs at least one IPFIX
   Exporting Process and one IPFIX Collecting Process.  However, when
   one has, for example, only implemented a Collector, then it can be
   complemented with a third-party Exporter for these tests.

   This document specifies guidelines for a series of tests that can be
   run on the IPFIX Exporting Process and Collecting Process in order to
   probe the conformity and robustness of the IPFIX protocol
   implementations.

   The tests listed here can form a valuable common basis for
   implementers involved in interoperability testing when all of them
   use these tests to check their own Exporting Process and Collecting
   Process implementation first.

   The tests can be executed in a testbed environment or on a live
   network.

   However, care should be taken regarding the "stress/load test" and
   the "temporary network disconnect", as they might impact other
   systems in the network.  We recommend that these specific tests
   should be executed only in a testbed environment.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Document%20Scope"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Document Scope</span>

   This document lists tests intended to be performed between an
   implementation of an IPFIX Exporting Process and an IPFIX Collecting
   Process.  For some tests, multiple instances of each of those
   components (Observation Points, Metering Process, Exporting Process,
   Collecting Process) are involved.  The testing of those different
   IPFIX components complicates the testing as usually one tests his
   software against an existing implementation, which is proven to be
   compliant.  In some cases, two unproven implementations of the
   Exporting Process and Collecting Process must be tested against each
   other.  The tests range from basic transport connectivity to export
   of Template and associated Data Records, high load on the Collecting
   Process, and error condition situations.  This document is not
   intended as a replacement for formal testing software procedures
   based on, e.g., TTCN3 (<a href="http://www.ttcn-3.org/">http://www.ttcn-3.org/</a>) but as a best-
   practices approach to an informal testing of a developer's IPFIX
   implementation.



<span class="grey">Schmoll, et al.              Informational                      [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20IPFIX%20Documents%20Overview"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  IPFIX Documents Overview</span>

   The IPFIX protocol [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>] provides network administrators with
   access to IP Flow information.  The architecture for the export of
   measured IP Flow information out of an IPFIX Exporting Process to a
   Collecting Process is defined in [<a href="rfc5470.html" title='"Architecture for IP Flow Information Export"'>RFC5470</a>], per the requirements
   specified in [<a href="rfc3917.html" title='"Requirements for IP Flow Information Export (IPFIX)"'>RFC3917</a>].

   [<a id="ref-RFC5470" name="ref-RFC5470">RFC5470</a>] specifies how IPFIX Data Records and Templates are carried
   via a congestion-aware transport protocol from IPFIX Exporting
   Processes to IPFIX Collecting Processes.  IPFIX has a formal
   description of IPFIX Information Elements, their name, type, and
   additional semantic information, as specified in [<a href="rfc5102.html" title='"Information Model for IP Flow Information Export"'>RFC5102</a>].  Finally,
   [<a href="rfc5472.html" title='"IP Flow Information Export (IPFIX) Applicability"'>RFC5472</a>] describes what type of applications can use the IPFIX
   protocol and how they can use the information provided.  It
   furthermore shows how the IPFIX framework relates to other
   architectures and frameworks.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   IPFIX-specific terminology used in this document is defined in
   <a href="rfc5101.html#section-2">Section 2 of [RFC5101]</a>.  In this document, as in [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>], the first
   letter of each IPFIX-specific term is capitalized.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Test%20Specifications"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Test Specifications</span>

   The tests described in this section MAY be performed using an IPFIX
   Exporting Process on one host and an IPFIX Collecting Process on a
   different host.  The configuration of the Observation Point, Metering
   Process, Exporting Process, and Collection Process SHOULD be recorded
   for every test along with the test results.

   The successful execution of all tests described in this section will
   give the tester a high confidence that the tested implementation is
   conformant with the IPFIX architecture and protocol.  It does however
   not provide a 100% comprehensive coverage or formal proof of
   conformance.








<span class="grey">Schmoll, et al.              Informational                      [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Exporting%20Process%2FCollecting%20Process%20Connectivity%20Tests"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Exporting Process/Collecting Process Connectivity Tests</span>

   This section lists the basic tests that are preconditions for the
   more complex tests specified in later sections of this document.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.1.%20%20Connectivity%20Tests%20between%20the%20Exporting%20Process%20and%20Collecting"></a><a class="selflink" href="#section-3.1.1" name="section-3.1.1">3.1.1</a>.  Connectivity Tests between the Exporting Process and Collecting</span>
<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/Process"></a>        Process</span>

   The tester must create one Exporting Process and one Collecting
   Process, must configure the Exporting Process to export at least one
   Template Set and associated Data Records to the Collecting Process,
   and must cause the Exporting Process to initiate the export.

   When the Exporting Process and Collecting Process are to be connected
   by a Stream Control Transmission Protocol (SCTP) transport, the
   tester must ensure that an SCTP association is established.

   When the Exporting Process and Collecting Process are to be connected
   by a TCP transport, the tester must ensure that a TCP connection is
   established.

   The tester must ensure that the Transport Session parameters (IP
   addresses and ports) are correct.

   Note that specifying instructions and tools on how to ensure that a
   Transport Session is correctly established and that the parameters
   are correct is out of the scope of this document.

   The tester must ensure that the Data Records are actually exported.
   The transmitted data might be observed online with an appropriate
   packet sniffing tool.  Such a tool is also a viable help to check if
   the initial connection (SCTP, TCP) has been successfully established.

   The tester must record which combinations of IPv4 and IPv6
   transports, and UDP, SCTP, and TCP transmission protocols are
   supported, and should perform the test for all the supported
   combinations.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Template%20and%20Data%20Record%20Tests"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Template and Data Record Tests</span>

   This section lists tests for checking the correct transmission of
   IPFIX Template Sets and associated Data Sets.









<span class="grey">Schmoll, et al.              Informational                      [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.1.%20%20Transmission%20of%20Template%20with%20Fixed-Size%20Information%20Elements"></a><a class="selflink" href="#section-3.2.1" name="section-3.2.1">3.2.1</a>.  Transmission of Template with Fixed-Size Information Elements</span>

   The tester must create a Template with a few fixed-size Information
   Elements where each data type specified in <a href="rfc5101.html#section-6.1">Section 6.1 of [RFC5101]</a>
   (octet, unsigned16, unsigned32 ...) is used at least once, and cause
   the Template and associated Data Records to be exported over all
   applicable combinations of transports and protocols in <a href="#section-3.1">Section 3.1</a>.

   The tester must ensure that the Template and associated Data Records
   were correctly received and decoded by the Collecting Process.  For
   this process, the use of verbose debugging output is suggested in
   order to allow a detailed comparison with the sent (and therefore
   expected) data.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.2.%20%20Transmission%20of%20Template%20with%20Variable-Length%20Information"></a><a class="selflink" href="#section-3.2.2" name="section-3.2.2">3.2.2</a>.  Transmission of Template with Variable-Length Information</span>
<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/Elements"></a>        Elements</span>

   The tester must create a Template with a mixture of fixed-sized and
   variable-length Information Elements, as specified in <a href="rfc5101.html#section-7">Section 7 of
   [RFC5101]</a>, and cause the Template and associated Data Records to be
   exported over all applicable combinations of transports and protocols
   in <a href="#section-3.1">Section 3.1</a>.

   The tester must ensure that the Template contains at least:

      o  a single variable-length Information Element.

      o  a single variable-length Information Element followed by a
         fixed-length Information Element.

      o  a fixed-length Information Element followed by a variable-
         length Information Element.

      o  multiple variable-length Information Elements.

   The tester must ensure that the Template and associated Data Records
   were correctly received and decoded by the Collecting Process.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.3.%20%20Set%20Padding"></a><a class="selflink" href="#section-3.2.3" name="section-3.2.3">3.2.3</a>.  Set Padding</span>

   <a href="rfc5101.html#section-3.3.1">Section 3.3.1 of [RFC5101]</a> specifies IPFIX Set alignment using
   padding.

   The tester must configure a packet generator to generate two Data
   Sets with padding in between consisting of zero valued octets, as
   shown in Figure 1.  They must be exported to the Collecting Process,
   which must correctly decode the Data Sets and all the Data Records.




<span class="grey">Schmoll, et al.              Informational                      [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


      +--------------------------------------------------+
      | Set Header #1                                    |
      +--------------------------------------------------+
      | Data Record                                      |
      +--------------------------------------------------+
      | Data Record                                      |
      +--------------------------------------------------+
         ...
      +--------------------------------------------------+
      | Data Record                                      |
      +--------------------------------------------------+
      | Padding with 0 valued octets                     |
      +--------------------------------------------------+
      | Set Header #2                                    |
      +--------------------------------------------------+
      | Data Record                                      |
      +--------------------------------------------------+

                                   Figure 1

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.4.%20%20Record%20Padding"></a><a class="selflink" href="#section-3.2.4" name="section-3.2.4">3.2.4</a>.  Record Padding</span>

   The tester must configure a packet generator to generate a Template
   that contains the padding Information Element (i.e., paddingOctets).
   The Template and associated Data Records must be exported to the
   Collecting Process, over all applicable combinations of transports
   and protocols in <a href="#section-3.1">Section 3.1</a>.

   The tester must repeat the test with various padding sizes, including
   padding to boundaries other than 4 or 8 octets.

   The tester must ensure the Collecting Process correctly interprets
   cases where the Data Records are so short that the padding is equal
   to or longer than the length of the record, so the padding might
   otherwise be interpreted as another record (e.g., 1 byte TOS plus 3
   bytes of padding).  Refer to the specifications in <a href="rfc5101.html#section-3.3.1">Section 3.3.1 of
   [RFC5101]</a>.  Figure 2 depicts such a Template, while Figure 3 depicts
   a Data Record conforming to that Template.













<span class="grey">Schmoll, et al.              Informational                      [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |         Set ID = 2            |      Length = 16 octets       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |       Template ID 256         |       Field Count = 2         |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |0|  ipDiffServCodePoint = 195  |       Field Length = 1        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |0|      paddingOctets = 210    |       Field Length = 3        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                   Figure 2

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |          Set ID = 256         |          Length = 64          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |       1        |                       0                      |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                   Figure 3

   The tester must test fixed-size padding (e.g., 12 bytes of data plus
   2 bytes of padding) and variable-length padding (e.g., export a
   string and a variable number of padding bytes afterwards to align the
   next Information Element to a 4 byte boundary).

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.5.%20%20Template%20Withdrawal%20Message"></a><a class="selflink" href="#section-3.2.5" name="section-3.2.5">3.2.5</a>.  Template Withdrawal Message</span>

   IPFIX Template management and Template Withdrawal are specified in
   <a href="rfc5101.html#section-8">Section 8 of [RFC5101]</a>.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.2.5.1.%20%20Withdrawal%20of%20a%20Previously%20Sent%20Template"></a><a class="selflink" href="#section-3.2.5.1" name="section-3.2.5.1">3.2.5.1</a>.  Withdrawal of a Previously Sent Template</span>

   The tester must create an IPFIX Template and cause that Template to
   be exported to an IPFIX Collector over a reliable transport.

   The tester must check that the Template will be correctly received
   and decoded by the Collecting Process.

   The tester must cause the Exporting Process to send an IPFIX Template
   Withdrawal Message to the Collector in respect of the Template.  The
   Template Withdrawal Message must be sent over the same Transport
   Session as the Template.





<span class="grey">Schmoll, et al.              Informational                      [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


   The tester must ensure that the Template Withdrawal Message was
   correctly received and decoded by the Collecting Process, and that
   the previously sent Template was discarded by the Collecting Process.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.2.5.2.%20%20Withdrawal%20of%20a%20Previously%20Withdrawn%20Template"></a><a class="selflink" href="#section-3.2.5.2" name="section-3.2.5.2">3.2.5.2</a>.  Withdrawal of a Previously Withdrawn Template</span>

   The tester must create, export, and withdraw an IPFIX Template as
   described in <a href="#section-3.2.5.1">Section 3.2.5.1</a>.

   The tester must cause the Exporting Process to send a second IPFIX
   Template Withdrawal Message to the Collector in respect of the same
   Template.  The Template Withdrawal Message must be sent over the same
   Transport Session as the Template.

   The tester must ensure that the Collecting Process discards the IPFIX
   Message and shuts down the SCTP association or closes the TCP
   connection.  The tester must check that the Collecting Process logged
   the error.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.2.5.3.%20%20Withdrawal%20of%20a%20Previously%20Unsent%20Template"></a><a class="selflink" href="#section-3.2.5.3" name="section-3.2.5.3">3.2.5.3</a>.  Withdrawal of a Previously Unsent Template</span>

   The tester must cause the Exporting Process to send an IPFIX Template
   Withdrawal Message to the Collector in respect of a Template that has
   not yet been exported.  The Template Withdrawal Message must be sent
   over a reliable transport.

   The tester must ensure that the Collecting Process discards the IPFIX
   Message and shuts down the SCTP association or closes the TCP
   connection.  The tester must check that the Collecting Process logged
   the error.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.2.5.4.%20%20Withdrawing%20All%20Data%20Templates"></a><a class="selflink" href="#section-3.2.5.4" name="section-3.2.5.4">3.2.5.4</a>.  Withdrawing All Data Templates</span>

   The tester must create several IPFIX Templates and cause them to be
   exported to an IPFIX Collector over a reliable transport.

   The tester must ensure that the Templates were correctly received and
   decoded by the Collecting Process.

   The tester must cause the Exporting Process to send an IPFIX All Data
   Templates Withdrawal Message to the Collector over the same Transport
   Session as the Templates.

   The tester must ensure that the All Data Templates Withdrawal Message
   was correctly received and decoded by the Collecting Process, and
   that all the previously sent Templates were discarded by the
   Collecting Process.




<span class="grey">Schmoll, et al.              Informational                     [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.2.5.5.%20%20Withdrawing%20All%20Option%20Templates"></a><a class="selflink" href="#section-3.2.5.5" name="section-3.2.5.5">3.2.5.5</a>.  Withdrawing All Option Templates</span>

   The tester must create several IPFIX Option Templates and cause them
   to be exported to an IPFIX Collector over a reliable transport.

   The tester must ensure that the Option Templates were correctly
   received and decoded by the Collecting Process.

   The tester must cause the Exporting Process to send an IPFIX All
   Option Templates Withdrawal Message to the Collector over the same
   Transport Session as the Templates.

   The tester must ensure that the All Option Templates Withdrawal
   Message was correctly received and decoded by the Collecting Process,
   and that all the previously sent Option Templates were discarded by
   the Collecting Process.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Information%20Element%20Tests"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Information Element Tests</span>

   This section lists the tests that cover the use of Information
   Elements.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.1.%20%20Enterprise-Specific%20Information%20Elements"></a><a class="selflink" href="#section-3.3.1" name="section-3.3.1">3.3.1</a>.  Enterprise-Specific Information Elements</span>

   The tester must cause the export of a Template and associated Data
   Record that makes use of Enterprise-specific Information Elements as
   specified in <a href="rfc5101.html#section-3.2">Section 3.2 of [RFC5101]</a>.

   The tester must ensure that the Template and associated Data Record
   are correctly received and decoded by the Collecting Process, and it
   must ensure that Information Elements that are unknown to the
   Collecting Process are not silently discarded.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.2.%20%20Reduced%20Size%20Encoding%20of%20Information%20Elements"></a><a class="selflink" href="#section-3.3.2" name="section-3.3.2">3.3.2</a>.  Reduced Size Encoding of Information Elements</span>

   The tester must cause the export of a Template and associated Data
   Record containing Information Elements using reduced size encoding as
   specified in <a href="rfc5101.html#section-6.2">Section 6.2 of [RFC5101]</a>.

   The tester must ensure that in the case of Information Elements
   transmitted using reduced size encoding, the Collecting Process is
   aware of the real size of each Information Element and not only the
   reduced size used for its transmission.








<span class="grey">Schmoll, et al.              Informational                     [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.3.%20%20Multiple%20Instances%20of%20the%20Same%20Information%20Element%20in%20One"></a><a class="selflink" href="#section-3.3.3" name="section-3.3.3">3.3.3</a>.  Multiple Instances of the Same Information Element in One</span>
<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/Template"></a>        Template</span>

   The tester must cause the export of a Template and associated Data
   Record containing multiple instances of the same Information Element
   consecutively.

   The tester must ensure that the Collecting Process is able to parse
   the IPFIX Message, and that it stores all values received for all the
   Information Elements that appeared multiple times in the Template
   definition.

   The tester must ensure that the Collecting Process reports the
   Information Elements in the same order as they were specified in the
   Template Record, as specified in <a href="rfc5101.html#section-8">Section 8 of [RFC5101]</a>.

   The tester must cause the export of another Template and associated
   Data Record containing multiple instances of the same Information
   Element with other Information Elements in between.

   The tester must ensure that the Collecting Process is able to parse
   the IPFIX Message, and that it stores all values received for all the
   Information Elements that appeared multiple times in the Template
   definition.

   The tester must ensure that the Collecting Process reports the
   Information Elements in the same order as they were specified in the
   Template Record, as specified in <a href="rfc5101.html#section-8">Section 8 of [RFC5101]</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Options%20Template%20Tests"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Options Template Tests</span>

   This section lists the tests that cover the correct transfer of IPFIX
   Options Templates.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.1.%20%20Using%20Any%20Information%20Elements%20as%20Scope"></a><a class="selflink" href="#section-3.4.1" name="section-3.4.1">3.4.1</a>.  Using Any Information Elements as Scope</span>

   Options Templates contain scope fields that give the context of the
   reported Information Elements in the corresponding Data Records.
   Scope fields are an Information Element specified in [<a href="rfc5102.html" title='"Information Model for IP Flow Information Export"'>RFC5102</a>].

   The tester SHOULD perform the export of Options Template Records
   containing various different Information Elements of each of the
   abstract data types specified in <a href="rfc5101.html#section-6.1">Section 6.1 of [RFC5101]</a> (octet,
   unsigned16, unsigned32 ...) in their scope fields, and must export a
   Data Record using each Template.

   The tester must check that the Templates and the associated Data
   Records are correctly received and decoded by the Collecting Process.



<span class="grey">Schmoll, et al.              Informational                     [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


   The tester must ensure that the Collecting Process accepts
   Information Elements in the scope field other than IPFIX Information
   Elements that have been recorded by IANA.

   The tester must ensure that the Collecting Process accepts an
   Enterprise-specific Information Element in the scope field.

   As specified in <a href="rfc5101.html#section-3.4.2.1">Section 3.4.2.1 of [RFC5101]</a>, the Scope Field Count
   must NOT be zero.  The tester must cause the export of an Options
   Template Record containing a Scope Field Count of zero.

   The tester must ensure that the Collecting Process shuts down the
   SCTP association and discards the IPFIX Message.  The tester should
   check that the Collecting Process logged the error.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.2.%20%20Using%20Multiple%20Scopes"></a><a class="selflink" href="#section-3.4.2" name="section-3.4.2">3.4.2</a>.  Using Multiple Scopes</span>

   The tester must cause the export of an Options Template Record
   containing multiple scope fields, and a Data Record conforming to
   that Template.

   The tester must ensure that the Collecting Process reports the
   Information Elements in the same order as they were specified in the
   Options Template Record, as specified in <a href="rfc5101.html#section-3.4.2.1">Section 3.4.2.1 of
   [RFC5101]</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.3.%20%20Metering%20Process%20Statistics%20Option%20Template"></a><a class="selflink" href="#section-3.4.3" name="section-3.4.3">3.4.3</a>.  Metering Process Statistics Option Template</span>

   The tester must create a Metering Process Statistics Option Template,
   as specified in <a href="rfc5101.html#section-4.1">Section 4.1 of [RFC5101]</a>, and cause the Option
   Template and an associated Data Record to be exported.

   The tester must ensure that the Collecting Process correctly receives
   and decodes the Option Template and associated Data Record.

   The tester must also check that the optional meteringProcessId Scope
   Field is supported by the Collecting Process implementation.

   If several Metering Processes are available on the Exporter
   Observation Domain, the tester must create a Metering Process
   Statistics Option Template containing multiple scopes and an
   associated Data Record, must cause the Option Template and associated
   Data Record to be exported, and must ensure that the Collecting
   Process correctly receives and decodes the Option Template and
   associated Data Record.






<span class="grey">Schmoll, et al.              Informational                     [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.4.%20%20Metering%20Process%20Reliability%20Statistics%20Option%20Template"></a><a class="selflink" href="#section-3.4.4" name="section-3.4.4">3.4.4</a>.  Metering Process Reliability Statistics Option Template</span>

   The tester must create a Metering Process Reliability Statistics
   Option Template, as specified in <a href="rfc5101.html#section-4.2">Section 4.2 of [RFC5101]</a>, and must
   cause the Option Template and an associated Data Record to be
   exported.

   The tester must ensure that the Collecting Process correctly receives
   and decodes the Option Template and associated Data Record.

   The tester must also check that the optional meteringProcessId Scope
   Field is supported by the Collecting Process implementation.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.5.%20%20Exporting%20Process%20Reliability%20Statistics%20Option%20Template"></a><a class="selflink" href="#section-3.4.5" name="section-3.4.5">3.4.5</a>.  Exporting Process Reliability Statistics Option Template</span>

   The tester must create an Exporting Process Reliability Statistics
   Option Template, as specified in <a href="rfc5101.html#section-4.3">Section 4.3 of [RFC5101]</a>, and must
   cause the Option Template and an associated Data Record to be
   exported.

   The tester must ensure that the Collecting Process correctly receives
   and decodes the Option Template and associated Data Record.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.6.%20%20Flow%20Keys%20Option%20Template"></a><a class="selflink" href="#section-3.4.6" name="section-3.4.6">3.4.6</a>.  Flow Keys Option Template</span>

   The tester must create a Flow Keys Option Template, as specified in
   <a href="rfc5101.html#section-4.4">Section 4.4 of [RFC5101]</a>, where the templateId refers to an existing
   Template, and must cause the Option Template and an associated Data
   Record to be exported.

   The tester must ensure that the Collecting Process correctly receives
   and decodes the Option Template and associated Data Record, and it
   must ensure that the Collecting Process associates the Flow Keys with
   the right Data Record Information Elements.

   The tester must create another Flow Keys Data Record to be exported
   where the associated templateId has insufficient fields to satisfy
   the flowKeyIndicator.

   The tester must ensure that the Collecting Process discards the IPFIX
   Message and shuts down the SCTP association or closes the TCP
   connection.  The tester must check that the Collecting Process logged
   the error.

   The tester must create another Flow Keys Option Template, where the
   templateId refers to a non-existing Template, and must cause the
   Option Template and an associated Data Record to be exported.




<span class="grey">Schmoll, et al.              Informational                     [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


   The tester must ensure that the Collecting Process shuts down the
   SCTP association and discards the IPFIX Message.  The tester should
   check that the Collecting Process logged the error.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.5.%20%20Stress%2FLoad%20Tests"></a><a class="selflink" href="#section-3.5" name="section-3.5">3.5</a>.  Stress/Load Tests</span>

   Stress tests are used to check correct behavior and robustness of an
   IPFIX Collecting Process implementation when a number of Data Records
   arrive very quickly.  This is especially important when IPFIX over
   UDP is used, since in that case a slow Collecting Process cannot
   block the IPFIX Exporting Processes from exporting because UDP is not
   congestion aware.

   The tests may be dependent upon the hardware and transport technology
   in use.  Therefore, the tests may need to be scaled up or down to
   meet the needs of the particular implementation.  However, the
   implementer must ensure that the implementation is stable under
   excessive traffic conditions, for whatever definition of "excessive"
   applies at their intended installation.

   The implementer must ensure the correct operation of the Exporting
   Process and/or Collecting Process when the Collecting Process is
   incapable of processing records at the rate that they are received.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.5.1.%20%20Large%20Number%20of%20Records%20for%20One%20Template"></a><a class="selflink" href="#section-3.5.1" name="section-3.5.1">3.5.1</a>.  Large Number of Records for One Template</span>

   The tester should export many Data Records to the Collecting Process,
   all conforming to the same Template, in order to put the Collecting
   Process under stress.

   Depending on what the Collecting Process does (save to file, store to
   database, analyze the data) the Collecting Process may use up a lot
   of memory.

   The tester must ensure that, if the Collecting Process runs out of
   memory, it shuts down the specific SCTP association or closes the TCP
   connection but remains available to receive data on other open
   Transport Sessions and also stays available for future Transport
   Sessions.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.5.2.%20%20Excessive%20Rate%20of%20Incoming%20Data%20Records"></a><a class="selflink" href="#section-3.5.2" name="section-3.5.2">3.5.2</a>.  Excessive Rate of Incoming Data Records</span>

   The tester should perform a test where Data Records are exported to
   the Collecting Process with an increasing export rate.

   For TCP or SCTP in reliable mode, the tester must ensure that the
   export stalls the Exporting Process once the Collecting Process
   becomes fully loaded.



<span class="grey">Schmoll, et al.              Informational                     [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


   For UDP export, the tester must ensure that the Collecting Process
   drops records as it becomes overloaded, and must check that the
   Collecting Process logged a warning.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.5.3.%20%20Large%20Templates"></a><a class="selflink" href="#section-3.5.3" name="section-3.5.3">3.5.3</a>.  Large Templates</span>

   The tester must create Templates with the maximum possible number of
   Information Elements and cause these to be exported to the Collecting
   Process.

   The total length field in the IP header is 16 bits, allowing a length
   up to 65535 octets in one application-level datagram.  This limits
   the number of Information Elements one can specify in an IPFIX
   Template when using UDP export.  SCTP and TCP are streaming
   protocols, so they do not impose much restriction on the packet
   level.  UDP requires 20 octets for a minimal IPv4 header, 8 octets
   for the UDP header, 16 octets for the IPFIX header, 4 octets for the
   Set header, and 4 octets for the Template header, so the Template
   definition may be up to (65535 - 20 - 8 - 16 - 4 - 4) = 65483 octets
   long.  The minimum IPFIX Information Element specification requires 4
   octets: two for the Information Element ID and two for the field
   length.  Therefore, the maximum number of IPFIX Information Elements
   in a single Template is 65483 / 4 = 16370.  With this many
   Information Elements, the Template will be 65480 octets long, while
   the entire packet will be 65532 octets long.

   The tester must create Data Records conforming to this Template, and
   cause them to be exported.  Note that, for the implementation, the
   associated Data Records might be smaller or larger than the Template
   Records depending on the length of the Information Elements defined
   by the Template and on the presence of variable-length Information
   Elements.

   The tester must ensure that the Collecting Process correctly receives
   and decodes the Template and associated Data Records.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.5.4.%20%20Many%20New%20Templates%20within%20the%20Data%20Template%20Timeout%20Interval"></a><a class="selflink" href="#section-3.5.4" name="section-3.5.4">3.5.4</a>.  Many New Templates within the Data Template Timeout Interval</span>

   The tester should create a large number of different Templates and
   cause them to be exported to the Collecting Process to stress test
   the Collecting Process's memory consumption.

   The tester must ensure that the Collecting Process gracefully
   discards Templates if it's running out of memory resources, and it
   should check that warnings are logged.






<span class="grey">Schmoll, et al.              Informational                     [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.5.5.%20%20Multiple%20Exporting%20Processes%20Exporting%20to%20One%20Collecting%20Process"></a><a class="selflink" href="#section-3.5.5" name="section-3.5.5">3.5.5</a>.  Multiple Exporting Processes Exporting to One Collecting Process</span>

   The tester must configure multiple Exporting Processes to export
   Templates and associated Data Records to the same Collecting Process
   at the same time.

   The tester must ensure that all the Templates and associated Data
   Records are correctly received and decoded at the Collecting Process,
   and that no Exporting Process stalls or disconnects completely unless
   the Collecting Process runs out of memory.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.5.6.%20%20Export%20from%20One%20Exporting%20Process%20to%20Multiple%20Collecting"></a><a class="selflink" href="#section-3.5.6" name="section-3.5.6">3.5.6</a>.  Export from One Exporting Process to Multiple Collecting</span>
<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/Processes"></a>        Processes</span>

   If the Exporting Process supports multiple simultaneous export
   destinations, the tester must configure the Exporting Process to
   export Data Records in parallel to different Collecting Processes.

   The tester must configure the use of a mixture of simple and complex
   Templates and ensure they are all correctly received and decoded by
   all the Collecting Processes.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.6.%20%20Error%20Handling"></a><a class="selflink" href="#section-3.6" name="section-3.6">3.6</a>.  Error Handling</span>

   This section lists and describes a number of problems that might
   occur in either the network or data transmission or related to wrong
   information encoding, and that the IPFIX Exporting Process and
   Collecting Process must be capable of handling in a graceful way.  It
   is intended to test the robustness and fault tolerance of the IPFIX
   Processes.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.6.1.%20%20Temporary%20Network%20Disconnect"></a><a class="selflink" href="#section-3.6.1" name="section-3.6.1">3.6.1</a>.  Temporary Network Disconnect</span>

   The IPFIX Exporting Process and Collecting Process behavior must be
   checked upon interruptions of data transmission due to network
   failures (whether physical or logical, e.g., defective routing).

   The tester must configure continuous export over all applicable
   combinations of transports and protocols in <a href="#section-3.1">Section 3.1</a>, in turn.

   For SCTP-based associations and TCP-based connections, the tester
   should create a short disconnect between the Exporting Process and
   the Collecting Process (e.g., by momentarily interrupting the network
   connection) and must ensure that export continues after the
   connection is repaired.  The tester must then create a longer
   disconnection between the Exporting Process and Collecting Process,
   and it must ensure that export continues after the connection is
   repaired.



<span class="grey">Schmoll, et al.              Informational                     [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


   For UDP-based data export, there is no noticeable connection loss,
   but data received with non-consecutive sequence numbers indicates
   data loss.  Refer to the sequence number specifications in <a href="rfc5101.html#section-3.1">Section</a>
   <a href="rfc5101.html#section-3.1">3.1 of [RFC5101]</a>.  The tester should create a short disconnect
   between the Exporting Process and Collecting Process, and it must
   ensure that this is recognized and reported by the Collecting Process
   per <a href="rfc5101.html#section-3.1">Section 3.1 of [RFC5101]</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.6.2.%20%20Exporting%20Process%20Termination%20and%20Restart%20during%20Data"></a><a class="selflink" href="#section-3.6.2" name="section-3.6.2">3.6.2</a>.  Exporting Process Termination and Restart during Data</span>
<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/Transmission"></a>        Transmission</span>

   An IPFIX Collecting Process might be confronted with a faulty
   Exporting Process implementation that suddenly crashes, dropping any
   open connections.  The Exporting Process may be restarted again soon
   after the crash.

   Such an event will only be visible to the Collecting Process when the
   IPFIX Messages (Templates and associated Data Records) are carried
   over TCP or SCTP.  For export via UDP, no such test is available due
   to the connection-less nature of the transport.

   The tester must configure continuous export over all applicable
   combinations of SCTP and TCP transports and protocols in <a href="#section-3.1">Section 3.1</a>,
   in turn.  For each combination, the tester must establish export,
   then kill the active Exporting Process.

   The tester must ensure that the associated Collecting Process shuts
   down SCTP associations and closes TCP connections associated with
   that export after a suitable timeout period.

   The tester must Ensure that the Collecting Process discards the
   Template(s) received on the killed transport session.

   The tester must restart the Exporting Process again, and it must
   ensure that the Exporting Process exports the Templates again.

   The tester must ensure that the Collecting Process receives and
   accepts both Templates and associated Data Records from the new
   Exporting Process running at the same source host.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.6.3.%20%20Collecting%20Process%20Termination%20and%20Restart%20during%20Data"></a><a class="selflink" href="#section-3.6.3" name="section-3.6.3">3.6.3</a>.  Collecting Process Termination and Restart during Data</span>
<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/Transmission"></a>        Transmission</span>

   An IPFIX Exporting Process might be confronted with a faulty
   Collecting Process implementation that suddenly crashes, dropping any
   open Transport Sessions.  The Collecting Process may be restarted
   again soon after the crash.




<span class="grey">Schmoll, et al.              Informational                     [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


   The tester must set up an Exporting Process and Collecting Process
   and cause IPFIX Templates and associated Data Records to be exported
   over all applicable combinations of SCTP and TCP transports and
   protocols in <a href="#section-3.1">Section 3.1</a>, in turn.  Via UDP, the restart of the
   Collecting Process will be invisible to the Exporting Process and
   have no effect.

   The tester must terminate the Collecting Process while the export is
   in progress, and must ensure that the Exporting Process shuts down
   SCTP associations and closes TCP connections associated with that
   Collecting Process.

   The tester must restart the Collecting Process and ensure that the
   Exporting Process connects to the Collecting Process again and that
   it exports the IPFIX Templates again.

   The tester must ensure that the new Collecting Process correctly
   receives and decodes the IPFIX Data Records again.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.6.4.%20%20Incorrect%20Template%20Records%20and%20Options%20Template%20Records"></a><a class="selflink" href="#section-3.6.4" name="section-3.6.4">3.6.4</a>.  Incorrect Template Records and Options Template Records</span>

   These tests verify the Collecting Process's operation when it
   receives a Template Record or Options Template Record with an invalid
   message length.  Refer to the specifications in <a href="#section-3.4.1">Section 3.4.1</a> and
   3.4.2 of [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>], respectively.

   Consider the example Template Record shown in Figure 4.  This
   Template record is missing one Information Element ID and one
   Information Element length field.  There is insufficient data in the
   Set for the specified Set length, and the overall record is four
   octets too short for the specified total length.




















<span class="grey">Schmoll, et al.              Informational                     [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |         Version = 10          |       Total Length = 32       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                  Export Time = 1155202151                     |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |               Sequence Number = 0x12345678                    |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |           Observation Domain ID = 0x33334444                  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |          Set ID = 2           |        Set Length = 12        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |       Template ID = 257       |        Field Count = 2        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |0| Info Element Identifier = 8 |     Field Length = 4          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                   Figure 4

   The tester must create and cause the Exporting Process to export the
   following IPFIX Templates, and must ensure the correct Collecting
   Process behavior for each of the transports and protocols in <a href="#section-3.1">Section</a>
   <a href="#section-3.1">3.1</a>.

   The tester must do the following:

   o  For SCTP transport, ensure that the Collecting Process discards
      the IPFIX Message, shuts down the SCTP association, and logs the
      error.

   o  For TCP transport, ensure that the Collecting Process discards the
      IPFIX Message, closes the TCP connection, and logs the error.
      Note that since TCP is a streaming (rather than record-based)
      protocol, template length errors cannot be detected and may cause
      framing to be lost, potentially rendering the remainder of the
      IPFIX stream unintelligible.  Therefore, some of these tests are
      not applicable for TCP transport, as indicated.

   o  For UDP transport, ensure that the Collecting Process discards the
      IPFIX Message and logs the error.

   (a) The tester must create the IPFIX Template shown in Figure 4 and
       cause the Exporting Process to export it.  The tester must ensure
       that the Collecting Process's behavior is as specified above for
       each transport type except for TCP, for which this test is not
       applicable.




<span class="grey">Schmoll, et al.              Informational                     [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


   (b) Consider the IPFIX Template shown in Figure 4, modified with
       total length = 28.  In this case, the IPFIX Message has to be
       rejected because the field count = 2 and there is no second
       Information Element record present in the Set.  The available
       data is exhausted after reading the first Information Element
       record.

       The tester must create the modified Template and cause the
       Exporting Process to export it.  The tester must ensure that the
       Collecting Process's behavior is as specified above for each
       transport type.

   (c) Consider the IPFIX Template shown in Figure 4, modified with
       total length = 26.  In this case, the IPFIX Message has to be
       rejected because the IPFIX Message length is too short.  After
       the first Information Element, the IPFIX Message data is
       exhausted according to the total length information.

       The tester must create the modified Template and cause the
       Exporting Process to export it.  The tester must ensure that the
       Collecting Process's behavior is as specified above for each
       transport type.  The TCP connection used for this test must be
       manually reset after the test.

   (d) Consider the IPFIX Template shown in Figure 4, modified with
       field count = 1.  In this case, the IPFIX Message must be
       rejected because the total length is too large and does not match
       the amount of data available.

       The tester must create the modified Template and cause the
       Exporting Process to export it.  The tester must ensure that the
       Collecting Process's behavior is as specified above for each
       transport type.  This test is not applicable for TCP transport.

   (e) Finally, when the IPFIX Template shown in Figure 4 is extended
       with the data shown in Figure 5, it becomes a correct IPFIX
       Template.

       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |0| Info Element Identifier = 12|        Field Length = 4       |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                   Figure 5

       The tester must create the modified Template and cause the
       Exporting Process to export it.  The tester must ensure that the
       Template is accepted by the Collecting Process for each transport
       type.



<span class="grey">Schmoll, et al.              Informational                     [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


   The example Template record shown in Figure 6 must be dropped because
   the scope field count = 0.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |         Version = 10          |       Total Length = 30       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                  Export Time = 1155202151                     |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |               Sequence Number = 0x12345678                    |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |           Observation Domain ID = 0x33334444                  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |           Set ID = 3          |        Set Length = 14        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |       Template ID = 257       |       Field Count = 1         |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Scope Field Count = 0     |0| Info Element Identifier = 8 |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |       Field Length = 4        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                   Figure 6

   The tester must create the Template shown in Figure 6 and cause the
   Exporting Process to export it.  The tester must ensure that the
   IPFIX Message is discarded by the Collecting Process for each
   transport type, and must check that the Collecting Process logs an
   error.  The tester must ensure that the Collecting Process also shuts
   down the SCTP association or closes the TCP connection.

   The tester must create an IPFIX Options Template where the field
   count is less than the scope field count, and cause the Exporting
   Process to export it.  Use the above IPFIX Options Template with
   scope field count = 2.  The tester must ensure that the Template is
   discarded by the Collecting Process for each transport type, and must
   check that the Collecting Process logs an error.  The tester must
   ensure that the Collecting Process shuts down the SCTP association or
   closes the TCP connection.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.6.5.%20%20Incorrect%20Data%20Record"></a><a class="selflink" href="#section-3.6.5" name="section-3.6.5">3.6.5</a>.  Incorrect Data Record</span>

   The tester must create the following invalid Data Records and cause
   them to be exported to the Collecting Process over all applicable
   combinations of transports and protocols in <a href="#section-3.1">Section 3.1</a>.





<span class="grey">Schmoll, et al.              Informational                     [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


   o  IPFIX Message too short.

   o  Illegal use of reduced size encoding.

   o  Invalid length specification in case of variable-length
      Information Elements.

   The tester must ensure that the Collecting Process discards the IPFIX
   Message and shuts down the SCTP association or closes the TCP
   connection.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.6.6.%20%20Export%20of%20Non-Matching%20Template%20and%20Data%20Records"></a><a class="selflink" href="#section-3.6.6" name="section-3.6.6">3.6.6</a>.  Export of Non-Matching Template and Data Records</span>

   The tester must create Templates and associated Data Records that
   fail to conform to those Templates in the following ways:

   o  too few Information Elements in Data Record

   o  too many Information Elements in Data Record

   The tester must cause the Templates and associated Data Records to be
   exported to the Collecting Process over all applicable combinations
   of transports and protocols in <a href="#section-3.1">Section 3.1</a>.

   The tester must ensure that the Collecting Process discards the IPFIX
   Message and shuts down the SCTP association or closes the TCP
   connection.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.6.7.%20%20Unknown%20Set%20IDs"></a><a class="selflink" href="#section-3.6.7" name="section-3.6.7">3.6.7</a>.  Unknown Set IDs</span>

   The tester must create Template Sets, Option Template Sets, and
   associated Data Sets using Set IDs which are unknown to the
   Collecting Process, and cause these to be exported to the Collecting
   Process over all applicable combinations of transports and protocols
   in <a href="#section-3.1">Section 3.1</a>.

   Per <a href="rfc5101.html#section-3.3.2">Section 3.3.2 of [RFC5101]</a>, only the Set ID values 2 and 3 denote
   valid Sets.

   The tester must ensure that the Collecting Process ignores the
   unknown Sets, logs a warning, and processes the remainder of the
   IPFIX Message.









<span class="grey">Schmoll, et al.              Informational                     [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.6.8.%20%20Re-Using%20Template%20IDs"></a><a class="selflink" href="#section-3.6.8" name="section-3.6.8">3.6.8</a>.  Re-Using Template IDs</span>

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.6.8.1.%20%20Using%20SCTP%20Transport"></a><a class="selflink" href="#section-3.6.8.1" name="section-3.6.8.1">3.6.8.1</a>.  Using SCTP Transport</span>

   Refer to <a href="rfc5101.html#section-9">Section 9 of [RFC5101]</a> for the Collecting Process's SCTP
   Template management specifications.

   The tester must create an IPFIX Template and cause it to be exported
   to a Collecting Process over SCTP transport.

   The tester must ensure that the Template was correctly received and
   decoded by the Collecting Process.

   The tester must cause the same Template to be exported to the same
   Collecting Process over the same SCTP association, and must ensure
   that the Collecting Process resets the SCTP association and discards
   the IPFIX Message.

   The tester must create another IPFIX template and cause it to be
   exported to the Collecting Process over SCTP transport.

   The tester must ensure that the Template was correctly received and
   decoded by the Collecting Process.

   The tester must modify the Template contents while retaining the same
   Template ID.

   The tester must cause the modified Template to be exported to the
   same Collecting Process over the SCTP same association, and must
   ensure that the Collecting Process resets the SCTP association and
   discards the IPFIX Message.

   The tester must check that an error was logged.

   The tester must create another IPFIX Template and cause it to be
   exported to the Collecting Process over SCTP transport.

   The tester must ensure that the Template was correctly received and
   decoded by the Collecting Process.

   The tester must cause a Template Withdrawal Message for the Template
   to be sent to the Collecting Process over the same SCTP association,
   and must ensure that the Template has been discarded by the
   Collecting Process.

   The tester must create Data Records conforming to the Template and
   cause them to be exported to the Collecting Process over the same
   SCTP association.



<span class="grey">Schmoll, et al.              Informational                     [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


   The tester must ensure that the Collecting Process discards the Data
   Records and logs a warning.

   The tester must cause the same Template to be exported to the same
   Collecting Process over the same SCTP association.

   The tester must ensure that the Template was correctly received and
   decoded by the Collecting Process.

   The tester must create Data Records conforming to the Template and
   cause them to be exported to the Collecting Process over the same
   SCTP association.

   The tester must ensure that the Collecting Process correctly receives
   and decodes the Data Records.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.6.8.2.%20%20Using%20TCP%20Transport"></a><a class="selflink" href="#section-3.6.8.2" name="section-3.6.8.2">3.6.8.2</a>.  Using TCP Transport</span>

   Refer to <a href="rfc5101.html#section-10.4.3">Section 10.4.3 of [RFC5101]</a> for the Collecting Process's TCP
   Template management specifications.

   The tester must create an IPFIX Template and cause it to be exported
   to a Collecting Process over TCP transport.

   The tester must ensure that the Template was correctly received and
   decoded by the Collecting Process.

   The tester must cause the same Template to be exported to the same
   Collecting Process over the same TCP connection, and must ensure that
   the Collecting Process resets the TCP connection and discards the
   IPFIX Message.

   The tester must create an IPFIX Template and cause it to be exported
   to the Collecting Process over TCP transport.

   The tester must ensure that the Template was correctly received and
   decoded by the Collecting Process.

   The tester must modify the Template contents while retaining the same
   Template ID.

   The tester must cause the modified Template to be exported to the
   same Collecting Process over the same TCP connection, and must ensure
   that the Collecting Process resets the TCP connection and discards
   the IPFIX Message.

   The tester must check that an error was logged.




<span class="grey">Schmoll, et al.              Informational                     [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


   The tester must create another IPFIX Template and cause it to be
   exported to the Collecting Process over TCP transport.

   The tester must ensure that the Template was correctly received and
   decoded by the Collecting Process.

   The tester must cause a Template Withdrawal Message for the Template
   to be sent to the Collecting Process over the same TCP connection,
   and must ensure that the Template has been discarded by the
   Collecting Process.

   The tester must create Data Records conforming to the same Template
   and cause them to be exported to the same Collecting Process over the
   same TCP connection.

   The tester must ensure that the Collecting Process discards the Data
   Records and logs a warning.

   The tester must cause the same Template to be exported to the same
   Collecting Process over the same TCP connection.

   The tester must ensure that the Template was correctly received and
   decoded by the Collecting Process.

   The tester must create Data Records conforming to the Template and
   cause them to be exported to the same Collecting Process over the
   same TCP connection.

   The tester must ensure that the Collecting Process correctly receives
   and decodes the Data Records.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/3.6.8.3.%20%20Using%20UDP%20Transport"></a><a class="selflink" href="#section-3.6.8.3" name="section-3.6.8.3">3.6.8.3</a>.  Using UDP Transport</span>

   Refer to Sections <a href="#section-10.3.6">10.3.6</a> and <a href="#section-10.3.7">10.3.7</a> of [<a href="rfc5101.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information"'>RFC5101</a>] for the UDP Template
   management specifications.

<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/3.6.8.3.1.%20%20Re-Using%20the%20Same%20Template%20ID%20inside%20the%20Template%20Lifetime"></a><a class="selflink" href="#section-3.6.8.3.1" name="section-3.6.8.3.1">3.6.8.3.1</a>.  Re-Using the Same Template ID inside the Template Lifetime</span>

   The tester must create an IPFIX Template and cause it to be exported
   to a Collecting Process over UDP transport.

   The tester must ensure that the Template was correctly received and
   decoded by the Collecting Process.

   Before the Template lifetime expires on the Collecting Process, the
   tester must cause the same Template to be exported over the same UDP
   connection to the same Collecting Process and must ensure that the
   Collecting Process accepts the Template.



<span class="grey">Schmoll, et al.              Informational                     [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


   The tester must create a different Template with the same ID and must
   cause this to be exported to the same Collecting Process over the
   same UDP connection before the original Template lifetime expires.

   The tester must ensure that the Collecting Process does not reject
   the new Template.

   The tester must create Data Records conforming to the new Template
   and cause them to be exported to the same Collecting Process over the
   same UDP connection.

   The tester must ensure that the Collecting Process correctly receives
   and decodes the Data Records.

<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/3.6.8.3.2.%20%20Re-Using%20the%20Same%20Template%20ID%20after%20the%20Template%20Lifetime"></a><a class="selflink" href="#section-3.6.8.3.2" name="section-3.6.8.3.2">3.6.8.3.2</a>.  Re-Using the Same Template ID after the Template Lifetime</span>

   The tester must create an IPFIX Template and cause it to be exported
   to a Collecting Process over UDP transport.

   The tester must ensure that the Template was correctly received and
   decoded by the Collecting Process.

   The tester must allow the received Template lifetime to expire on the
   Collecting Process.

   The tester must create Data Records conforming to the Template and
   cause them to be exported to the same Collecting Process over the
   same UDP connection.

   The tester must ensure that the Collecting Process discards the Data
   Records.

   The tester must check that the Collecting Process logs a warning.

   The tester must cause the same Template to be exported to the same
   Collecting Process over the same UDP connection.

   The tester must ensure that the Template was correctly received and
   decoded by the Collecting Process.

   The tester must create Data Records conforming to the Template and
   cause them to be exported to the same Collecting Process over the
   same UDP connection.

   The tester must ensure that the Collecting Process correctly receives
   and decodes the Data Records.





<span class="grey">Schmoll, et al.              Informational                     [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.7.%20%20TLS%20Connectivity%20and%20Policy%20Selection"></a><a class="selflink" href="#section-3.7" name="section-3.7">3.7</a>.  TLS Connectivity and Policy Selection</span>

   This section lists tests that verify connectivity over TLS and
   Datagram Transport Layer Security (DTLS) and proper selection of TLS
   policies as specified in the IPFIX Protocol.  It specifically does
   NOT purport to test the security of IPFIX Message transport over TLS
   or DTLS, as evaluating the security of a transport session is really
   a test of the TLS or DTLS implementation over which a given IPFIX
   implementation runs, and as such is out of scope for this document.

   Refer to <a href="rfc5101.html#section-11">Section 11 of [RFC5101]</a> for the security specifications.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.7.1.%20%20TLS%20Test%20Setup"></a><a class="selflink" href="#section-3.7.1" name="section-3.7.1">3.7.1</a>.  TLS Test Setup</span>

   Setting up for TLS connectivity and policy testing requires the
   creation of appropriate X.509 certificates and private keys for a
   test environment and the configuration of a DNS server to answer with
   consistent information for the hosts used in the test.

   The tester must configure the following certificates:

      1.  A Certificate Authority (CA) certificate and associated
          private key for signing the following certificates.

      2.  One certificate and associated private key, with a CN (Common
          Name) or subjectAltName extension of type dNSName containing
          the fully qualified domain name of the host, signed by the CA
          certificate in 1, for each IPFIX Exporting Process in the
          test.

      3.  One certificate and associated private key, with a CN (common
          name) or subjectAltName extension of type dNSName containing
          the fully qualified domain name of the host, signed by the CA
          certificate in 1, for each IPFIX Collecting Process in the
          test.

   The tester must configure consistent forward (A, AAAA) DNS records
   for each host in the test on a DNS server used by the hosts for name
   resolution.  Note that there is no need to configure reverse (PTR)
   DNS records for the hosts, as no part of the protocol uses reverse
   lookups.

   The tester must ensure that the Exporting Process and Collecting
   Process are on different hosts.







<span class="grey">Schmoll, et al.              Informational                     [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.7.2.%20%20TLS%20over%20TCP%20Connectivity%20Test"></a><a class="selflink" href="#section-3.7.2" name="section-3.7.2">3.7.2</a>.  TLS over TCP Connectivity Test</span>

   The tester must set up certificates and DNS as in <a href="#section-3.7.1">Section 3.7.1</a>.

   The tester must configure one Exporting Process and one Collecting
   Process with their appropriate certificates to transfer IPFIX
   Messages over TLS over TCP.

   The tester must create an IPFIX Template and associated Data Record,
   and cause them to be exported over the TCP connection.

   The tester must ensure that a TCP connection and a TLS connection
   were established, must ensure that data was exchanged, and must
   ensure that the data received at the Collecting Process is correct.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.7.3.%20%20DTLS%20over%20UDP%20Connectivity%20Test"></a><a class="selflink" href="#section-3.7.3" name="section-3.7.3">3.7.3</a>.  DTLS over UDP Connectivity Test</span>

   The tester must set up certificates and DNS as in <a href="#section-3.7.1">Section 3.7.1</a>.

   The tester must configure one Exporting Process and one Collecting
   Process with their appropriate certificates to transfer IPFIX
   Messages over DTLS over UDP.

   The tester must create an IPFIX Template and associated Data Record,
   and cause them to be exported over the UDP connection.

   The tester must ensure that UDP packets were sent and a DTLS
   connection was established, must ensure that data was exchanged, and
   must ensure that the data received at the Collecting Process is
   correct.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.7.4.%20%20DTLS%20over%20PR-SCTP%20Connectivity%20Test"></a><a class="selflink" href="#section-3.7.4" name="section-3.7.4">3.7.4</a>.  DTLS over PR-SCTP Connectivity Test</span>

   The tester must set up certificates and DNS as in <a href="#section-3.7.1">Section 3.7.1</a>.

   The tester must configure one Exporting Process and one Collecting
   Process with their appropriate certificates to transfer IPFIX
   Messages over DTLS over the Partially Reliable-Stream Control
   Transmission Protocol (PR-SCTP).

   The tester must create an IPFIX Template and associated Data Record,
   and cause them to be exported over the SCTP association.

   The tester must ensure that an SCTP association and a DTLS connection
   were established, must ensure that data was exchanged, and must
   ensure that the data received at the Collecting Process is correct.





<span class="grey">Schmoll, et al.              Informational                     [Page 29]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.7.5.%20%20TLS%20Bidirectional%20Authentication%20Policy%20Test"></a><a class="selflink" href="#section-3.7.5" name="section-3.7.5">3.7.5</a>.  TLS Bidirectional Authentication Policy Test</span>

   This is an optional test for Collecting Processes only; it requires
   the modification of an Exporting Process to NOT present a
   certificate.

   The tester must modify an Exporting Process to NOT present a
   certificate.

   The tester must perform the connectivity tests in Sections <a href="#section-3.7.2">3.7.2</a>,
   3.7.3, and 3.7.4.

   The tester must ensure that the Collecting Process rejects the TLS or
   DTLS connection establishment.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.7.6.%20%20Exporting%20Process%20Identity%20Mismatch%20TLS%20Policy%20Test"></a><a class="selflink" href="#section-3.7.6" name="section-3.7.6">3.7.6</a>.  Exporting Process Identity Mismatch TLS Policy Test</span>

   The tester must set up certificates and DNS as in <a href="#section-3.7.1">Section 3.7.1</a>.

   The tester must use a certificate for the Exporting Process that does
   NOT match the fully qualified domain name of the host on which the
   Exporting Process runs.

   The tester must Perform the connectivity tests in Sections <a href="#section-3.7.2">3.7.2</a>,
   3.7.3, and 3.7.4.

   The tester must ensure that the Collecting Process rejects the TLS or
   DTLS connection establishment.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.7.7.%20%20Collecting%20Process%20Identity%20Mismatch%20TLS%20Policy%20Test"></a><a class="selflink" href="#section-3.7.7" name="section-3.7.7">3.7.7</a>.  Collecting Process Identity Mismatch TLS Policy Test</span>

   The tester must set up certificates and DNS as in <a href="#section-3.7.1">Section 3.7.1</a>.

   The tester must use a certificate for the Collecting Process that
   does NOT match the fully qualified domain name of the host on which
   the Collecting Process runs.

   The tester must perform the connectivity tests in Sections <a href="#section-3.7.2">3.7.2</a>,
   3.7.3, and 3.7.4.

   The tester must ensure that the Exporting Process rejects the TLS or
   DTLS connection establishment.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Security%20Considerations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Security Considerations</span>

   This memo raises no security issues.





<span class="grey">Schmoll, et al.              Informational                     [Page 30]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Acknowledgments"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Acknowledgments</span>

   The authors wish to thank Brian Trammell for contributing the initial
   text for <a href="#section-3.7">Section 3.7</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Normative%20References"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC3917" name="ref-RFC3917">RFC3917</a>]  Quittek, J., Zseby, T., Claise, B., and S. Zander,
              "Requirements for IP Flow Information Export (IPFIX)", <a href="rfc3917.html">RFC</a>
              <a href="rfc3917.html">3917</a>, October 2004.

   [<a id="ref-RFC5101" name="ref-RFC5101">RFC5101</a>]  Claise, B., Ed., "Specification of the IP Flow Information
              Export (IPFIX) Protocol for the Exchange of IP Traffic
              Flow Information", <a href="rfc5101.html">RFC 5101</a>, January 2008.

   [<a id="ref-RFC5102" name="ref-RFC5102">RFC5102</a>]  Quittek, J., Bryant, S., Claise, B., Aitken, P., and J.
              Meyer, "Information Model for IP Flow Information Export",
              <a href="rfc5102.html">RFC 5102</a>, January 2008.

   [<a id="ref-RFC5470" name="ref-RFC5470">RFC5470</a>]  Sadasivan, G., Brownlee, N., Claise, B., and J. Quittek,
              "Architecture for IP Flow Information Export", <a href="rfc5470.html">RFC 5470</a>,
              March 2009.

   [<a id="ref-RFC5472" name="ref-RFC5472">RFC5472</a>]  Zseby, T., Boschi, E., Brownlee, N., and B. Claise, "IP
              Flow Information Export (IPFIX) Applicability", <a href="rfc5472.html">RFC 5472</a>,
              March 2009.






















<span class="grey">Schmoll, et al.              Informational                     [Page 31]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc5471.html">RFC 5471</a>              Guidelines for IPFIX Testing            March 2009</span>


Authors' Addresses

   Carsten Schmoll
   Fraunhofer FOKUS
   Kaiserin-Augusta-Allee 31
   Berlin  D-10589
   Germany

   Phone: +49 30 3463 7136
   EMail: carsten.schmoll@fokus.fraunhofer.de
   URI:   <a href="http://www.fokus.fraunhofer.de/">http://www.fokus.fraunhofer.de</a>


   Paul Aitken
   Cisco Systems, Inc.
   96 Commercial Quay
   Edinburgh  EH6 6LX
   Scotland

   Phone: +44 131 561 3616
   EMail: paitken@cisco.com
   URI:   <a href="http://www.cisco.com/">http://www.cisco.com</a>


   Benoit Claise
   Cisco Systems, Inc.
   De Kleetlaan 6a b1
   1831 Diegem
   Belgium

   Phone: +32 2 704 5622
   EMail: bclaise@cisco.com
   URI:   <a href="http://www.cisco.com/">http://www.cisco.com</a>


















Schmoll, et al.              Informational                     [Page 32]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.127, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc5471 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Aug 2018 14:27:34 GMT --></html>