<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6651 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:27 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-kucherawy-dkim-reporting" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:6651" name="DC.Identifier"/>
<meta content="June, 2012" name="DC.Date.Issued"/>
<meta content="Murray Kucherawy &lt;msk@cloudmark.com&gt;" name="DC.Creator"/>
<meta content="This document presents extensions to the DomainKeys Identified Mail
(DKIM) specification to allow for detailed reporting of message
authentication failures in an on-demand fashion. [STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="Extensions to DomainKeys Identified Mail (DKIM) for Failure Reporting" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6651 - Extensions to DomainKeys Identified Mail (DKIM) for Failure Reporting</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6651.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6651" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-marf-dkim-reporting" title="draft-ietf-marf-dkim-reporting">draft-ietf-marf...</a>] [<a href="https://datatracker.ietf.org/doc/rfc6651" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6651" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6651" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                      M. Kucherawy
Request for Comments: 6651                                     Cloudmark
Category: Standards Track                                      June 2012
ISSN: 2070-1721


 <span class="h1">Extensions to DomainKeys Identified Mail (DKIM) for Failure Reporting</span>

Abstract

   This document presents extensions to the DomainKeys Identified Mail
   (DKIM) specification to allow for detailed reporting of message
   authentication failures in an on-demand fashion.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">SectionÂ 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6651">http://www.rfc-editor.org/info/rfc6651</a>.

Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.









<span class="grey">Kucherawy                    Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6651.html">RFC 6651</a>                DKIM Reporting Extensions              June 2012</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Definitions .....................................................<a href="#page-3">3</a>
      <a href="#section-2.1">2.1</a>. Key Words ..................................................<a href="#page-3">3</a>
      <a href="#section-2.2">2.2</a>. Notation ...................................................<a href="#page-3">3</a>
      <a href="#section-2.3">2.3</a>. Imported Definitions .......................................<a href="#page-3">3</a>
      <a href="#section-2.4">2.4</a>. Other Definitions ..........................................<a href="#page-3">3</a>
   <a href="#section-3">3</a>. Optional Reporting for DKIM .....................................<a href="#page-4">4</a>
      <a href="#section-3.1">3.1</a>. Extension DKIM Signature Tag ...............................<a href="#page-4">4</a>
      <a href="#section-3.2">3.2</a>. DKIM Reporting TXT Record ..................................<a href="#page-4">4</a>
      <a href="#section-3.3">3.3</a>. DKIM Reporting Algorithm ...................................<a href="#page-6">6</a>
   <a href="#section-4">4</a>. Optional Reporting Address for DKIM ADSP ........................<a href="#page-8">8</a>
   <a href="#section-5">5</a>. Requested Reports ...............................................<a href="#page-9">9</a>
      <a href="#section-5.1">5.1</a>. Requested Reports for DKIM Failures .......................<a href="#page-10">10</a>
      <a href="#section-5.2">5.2</a>. Requested Reports for DKIM ADSP Failures ..................<a href="#page-10">10</a>
   <a href="#section-6">6</a>. Report Generation ..............................................<a href="#page-11">11</a>
      <a href="#section-6.1">6.1</a>. Report Format .............................................<a href="#page-11">11</a>
      <a href="#section-6.2">6.2</a>. Other Guidance ............................................<a href="#page-11">11</a>
   <a href="#section-7">7</a>. IANA Considerations ............................................<a href="#page-11">11</a>
      <a href="#section-7.1">7.1</a>. DKIM Signature Tag Registration ...........................<a href="#page-11">11</a>
      <a href="#section-7.2">7.2</a>. DKIM ADSP Tag Registration ................................<a href="#page-12">12</a>
      <a href="#section-7.3">7.3</a>. DKIM Reporting Tag Registry ...............................<a href="#page-12">12</a>
   <a href="#section-8">8</a>. Security Considerations ........................................<a href="#page-13">13</a>
      <a href="#section-8.1">8.1</a>. Inherited Considerations ..................................<a href="#page-13">13</a>
      <a href="#section-8.2">8.2</a>. Report Volume .............................................<a href="#page-13">13</a>
      <a href="#section-8.3">8.3</a>. Deliberate Misuse .........................................<a href="#page-13">13</a>
      <a href="#section-8.4">8.4</a>. Unreported Fraud ..........................................<a href="#page-14">14</a>
   <a href="#section-9">9</a>. References .....................................................<a href="#page-14">14</a>
      <a href="#section-9.1">9.1</a>. Normative References ......................................<a href="#page-14">14</a>
      <a href="#section-9.2">9.2</a>. Informative References ....................................<a href="#page-15">15</a>
   <a href="#appendix-A">Appendix A</a>. Acknowledgements ......................................<a href="#page-16">16</a>
   <a href="#appendix-B">Appendix B</a>. Examples ..............................................<a href="#page-16">16</a>
      <a href="#appendix-B.1">B.1</a>. Example Use of DKIM Signature Extension Tag ...............<a href="#page-16">16</a>
      <a href="#appendix-B.2">B.2</a>. Example DKIM Reporting TXT Record .........................<a href="#page-17">17</a>
      <a href="#appendix-B.3">B.3</a>. Example Use of DKIM ADSP Extension Tags ...................<a href="#page-17">17</a>















<span class="grey">Kucherawy                    Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6651.html">RFC 6651</a>                DKIM Reporting Extensions              June 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   DomainKeys Identified Mail [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] introduced a mechanism for message
   signing and authentication.  It uses digital signing to associate a
   domain name with a message in a reliable manner.  The verified domain
   name can then be evaluated (e.g., checking advertised sender policy,
   comparison to a known-good list, submission to a reputation service,
   etc.).

   Deployers of message authentication technologies are increasingly
   seeking visibility into DKIM verification failures and conformance
   failures involving the published signing practices (e.g., Author
   Domain Signing Practices [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>]) of an ADministrative Management
   Domain (ADMD; see [<a href="#ref-EMAIL-ARCH">EMAIL-ARCH</a>]).

   This document extends [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] and [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>] to add an optional reporting
   address and some reporting parameters.  Reports are generated using
   the format defined in [<a href="#ref-ARF-AUTHFAIL">ARF-AUTHFAIL</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Definitions"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Definitions</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Key%20Words"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Key Words</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="#ref-KEYWORDS" title='"Key words for use in RFCs to Indicate Requirement Levels"'>KEYWORDS</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Notation"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Notation</span>

   Certain properties of email messages described in this document are
   referenced using notation found in [<a href="#ref-EMAIL-ARCH">EMAIL-ARCH</a>] (e.g.,
   "<a href="rfc5322.html">RFC5322</a>.From").

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20Imported%20Definitions"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  Imported Definitions</span>

   Numerous DKIM-specific terms used here are defined in [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>].
   The definitions of the [<a href="#ref-ABNF" title='"Augmented BNF for Syntax Specifications: ABNF"'>ABNF</a>] tokens "domain-name" and
   "dkim-quoted-printable" can also be found there.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.4.%20%20Other%20Definitions"></a><a class="selflink" href="#section-2.4" name="section-2.4">2.4</a>.  Other Definitions</span>

   report generator:  A report generator is an entity that generates and
      sends reports.  For the scope of this document, the term refers to
      Verifiers, as defined in Section 2.2 of [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>], with the added
      capability to generate authentication failure reports according to
      this specification.





<span class="grey">Kucherawy                    Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6651.html">RFC 6651</a>                DKIM Reporting Extensions              June 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Optional%20Reporting%20for%20DKIM"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Optional Reporting for DKIM</span>

   A domain name owner employing [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] for email signing and
   authentication might want to know when signatures that ought to be
   verifiable are not successfully verifying.  Currently, there is no
   such mechanism defined.

   This section adds optional "tags" (as defined in [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>]) to the
   DKIM-Signature header field and the DKIM key record in the DNS, using
   the formats defined in that specification.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Extension%20DKIM%20Signature%20Tag"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Extension DKIM Signature Tag</span>

   The following tag is added to DKIM-Signature header fields when a
   Signer wishes to request that reports of failed verifications be
   generated by a Verifier:

   r=  Reporting Requested (plain-text; OPTIONAL; no default).  If
       present, this tag indicates that the Signer requests that
       Verifiers generate a report when verification of the DKIM
       signature fails.  At present, the only legal value is the single
       character "y".  A complete description and illustration of how
       this is applied can be found in <a href="#section-3.3">Section 3.3</a>.

      ABNF:

      sig-r-tag = %x72 *WSP "=" *WSP %x79
                ; "r=y" (lower-case only)

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20DKIM%20Reporting%20TXT%20Record"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  DKIM Reporting TXT Record</span>

   When a Signer wishes to advertise that it wants to receive failed
   verification reports, it places in the DNS a TXT Resource Record
   (RR).  The RR contains a sequence of tag-value objects in a format
   similar to DKIM key records (see Section 3.6.1 of [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>]), but it is
   entirely independent of those key records and is found at a different
   name.  The tag-value objects in this case comprise the parameters to
   be used when generating the reports.  A report generator will request
   the content of this record when it sees an "r=" tag in a
   DKIM-Signature header field.

   Section 3.6.2.2 of [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] provides guidance with respect to the
   handling of a TXT RR that comprises multiple distinct strings
   ("character-strings" in the parlance of [<a href="#ref-DNS" title='"Domain names - implementation and specification"'>DNS</a>]).  The same process
   MUST be applied here.






<span class="grey">Kucherawy                    Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6651.html">RFC 6651</a>                DKIM Reporting Extensions              June 2012</span>


   Implementations MUST support all tags defined in this document, and
   any other tag found in the content of the record that is not
   recognized by an implementation MUST be ignored.  See <a href="#section-7.3">Section 7.3</a> for
   details about finding or registering extension tags.

   The initial list of tags supported for the reporting TXT record is as
   follows:

   ra=  Reporting Address (plain-text; OPTIONAL).  A
        dkim-quoted-printable string (see Section 2.11 of [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>])
        containing the local-part of an email address to which a report
        SHOULD be sent when mail fails DKIM verification for one of the
        reasons enumerated below.  The value MUST be interpreted as a
        local-part only.  To construct the actual address to which the
        report is sent, the Verifier simply appends to this value an "@"
        followed by the domain name found in the "d=" tag of the
        DKIM-Signature header field.  Therefore, a Signer making use of
        this specification MUST ensure that an email address thus
        constructed can receive reports generated as described in
        <a href="#section-6">Section 6</a>.

      ABNF:

      rep-ra-tag = %x72.61 *WSP "=" *WSP dkim-quoted-printable
                 ; "ra=..." (lower-case only for the tag name)

   rp=  Requested Report Percentage (plain-text; OPTIONAL; default is
        "100").  The value is an integer from 0 to 100 inclusive that
        indicates what percentage of incidents of signature
        authentication failures, selected at random, are to cause
        reports to be generated.  The report generator SHOULD NOT issue
        reports for more than the requested percentage of incidents.
        Report generators MAY make use of the "Incidents:" field in
        [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>] to indicate that there are more reportable incidents than
        there are reports.

      ABNF:

      rep-rp-tag = %x72.70 *WSP "=" *WSP 1*3DIGIT
                 ; "rp=..." (lower-case only)











<span class="grey">Kucherawy                    Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6651.html">RFC 6651</a>                DKIM Reporting Extensions              June 2012</span>


   rr=  Requested Reports (plain-text; OPTIONAL; default is "all").  The
        value MUST be a colon-separated list of tokens representing
        those conditions under which a report is desired.  See
        <a href="#section-5.1">Section 5.1</a> for a list of valid tokens.

      ABNF:

      rep-rr-type = ( "all" / "d" / "o" / "p" / "s" / "u" / "v" / "x" )
      rep-rr-tag = %x72.72 *WSP "=" *WSP rep-rr-type
                   *WSP *( ":" *WSP rep-rr-type )
                 ; "rr=..." (lower-case only for the tag name)

   rs=  Requested SMTP Error String (plain-text; OPTIONAL; no default).
        The value is a dkim-quoted-printable string that the publishing
        ADMD requests be included in [<a href="#ref-SMTP" title='"Simple Mail Transfer Protocol"'>SMTP</a>] error strings if messages
        are rejected during the delivery SMTP session.

      ABNF:

      rep-rs-tag = %x72.73 *WSP "=" dkim-quoted-printable
                 ; "rs=..." (lower-case only for the tag name)

   In the absence of an "ra=" tag, the "rp=" and "rr=" tags MUST be
   ignored, and the report generator MUST NOT issue a report.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20DKIM%20Reporting%20Algorithm"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  DKIM Reporting Algorithm</span>

   Report generators MUST apply the following algorithm, or one
   semantically equivalent to it, for each DKIM-Signature header field
   whose verification fails for some reason.  Note that this processing
   is done as a reporting extension only; the outcome of the specified
   DKIM evaluation MUST be otherwise unaffected.

   1.  If the DKIM-Signature field did not contain a valid "r=" tag,
       terminate.

   2.  Issue a [<a href="#ref-DNS" title='"Domain names - implementation and specification"'>DNS</a>] TXT query to the name that results from appending
       the value of the "d=" tag in the DKIM-Signature field to the
       string "_report._domainkey.".  For example, if the DKIM-Signature
       header field contains "d=example.com", issue a DNS TXT query to
       "_report._domainkey.example.com".

   3.  If the DNS query returns anything other than RCODE 0 (NOERROR),
       or if multiple TXT records are returned, terminate.

   4.  If the resultant TXT is in several string fragments, concatenate
       them as described in Section 3.6.2.2 of [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>].




<span class="grey">Kucherawy                    Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6651.html">RFC 6651</a>                DKIM Reporting Extensions              June 2012</span>


   5.  If the TXT content is syntactically invalid (see <a href="#section-3.2">Section 3.2</a>),
       terminate.

   6.  If the reason for the signature evaluation failure does not match
       one of the report requests found in the "rr=" tag (or its default
       value), terminate.

   7.  If a report percentage ("rp=") tag was present, select a random
       number between 0 and 99, inclusive; if the selected number is not
       lower than the tag's value, terminate.

   8.  If no "ra=" tag was present, skip this step and the next one.
       Otherwise, determine the reporting address by extracting the
       value of the "ra=" tag and appending to it an "@" followed by the
       domain name found in the "d=" tag of the DKIM-Signature header
       field.

   9.  Construct and send a report in compliance with <a href="#section-6">Section 6</a> of this
       document that includes as its intended recipient the address
       constructed in the previous step.

   10. If the [<a href="#ref-SMTP" title='"Simple Mail Transfer Protocol"'>SMTP</a>] session during which the DKIM signature was
       evaluated is still active and the SMTP server has not already
       given its response to the DATA command that relayed the message,
       and an "rs=" tag was present in the TXT record, the SMTP server
       SHOULD include the decoded string found in the "rs=" tag in its
       SMTP reply to the DATA command.

   In order to thwart attacks that seek to convert report generators
   into unwitting denial-of-service attack participants, a report
   generator SHOULD NOT issue more than one report to any given domain
   as a result of a single message.  Further, a report generator SHOULD
   establish an upper bound on the number of reports a single message
   can generate overall.  For example, a message with three invalid
   signatures, two from example.com and one from example.net, would
   generate at most one report to each of those domains.

   This algorithm has the following advantages over previous
   pre-standardization implementations, such as early versions of
   [<a href="#ref-OPENDKIM" title='"OpenDKIM -- Open Source DKIM Library and Filter"'>OPENDKIM</a>]:

   a.  If the DKIM signature fails to verify, no additional DNS check is
       made to see if reporting is requested; the request is active in
       that it is included in the DKIM-Signature header field.
       (Previous implementations included the reporting address in the
       DKIM key record, which is not queried for certain failure cases.
       This meant, for full reporting, that the key record had to be
       retrieved even when it was not otherwise necessary.)



<span class="grey">Kucherawy                    Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6651.html">RFC 6651</a>                DKIM Reporting Extensions              June 2012</span>


   b.  The request is confirmed by the presence of a corresponding TXT
       record in the DNS, since the Signer thus provides the parameters
       required to construct and send the report.  This means a
       malicious Signer cannot falsely assert that someone else wants
       failure reports and cause unwanted mail to be generated.  It can
       cause additional DNS traffic against the domain listed in the
       "d=" signature tag, but negative caching of the requested DNS
       record will help to mitigate this issue.

   c.  It is not possible for a Signer to direct reports to an email
       address outside of its own domain, preventing distributed email-
       based denial-of-service attacks.

   See <a href="#section-8.4">Section 8.4</a> for some considerations regarding limitations of this
   mechanism.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Optional%20Reporting%20Address%20for%20DKIM%20ADSP"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Optional Reporting Address for DKIM ADSP</span>

   A domain name owner employing Author Domain Signing Practices [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>]
   may also want to know when messages are received without valid author
   domain signatures.  Currently, there is no such mechanism defined.

   This section adds the following optional "tags" (as defined in
   [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>]) to the DKIM ADSP records, using the form defined in that
   specification:

   ra=  Reporting Address (plain-text; OPTIONAL; no default).  The value
        MUST be a dkim-quoted-printable string containing the local-part
        of an email address to which a report SHOULD be sent when mail
        claiming to be from this domain failed the verification
        algorithm described in [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>], in particular because a message
        arrived without a signature that validates, which contradicts
        what the ADSP record claims.  The value MUST be interpreted as a
        local-part only.  To construct the actual address to which the
        report is sent, the Verifier simply appends to this value an "@"
        followed by the domain whose policy was queried in order to
        evaluate the sender's ADSP, i.e., the <a href="rfc5322.html">RFC5322</a>.From domain of the
        message under evaluation.  Therefore, a Signer making use of
        this extension tag MUST ensure that an email address thus
        constructed can receive reports generated as described in
        <a href="#section-6">Section 6</a>.

      ABNF:

      adsp-ra-tag = %x72.61 *WSP "=" dkim-quoted-printable
                  ; "ra=..." (lower-case only for the tag name)





<span class="grey">Kucherawy                    Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6651.html">RFC 6651</a>                DKIM Reporting Extensions              June 2012</span>


   rp=  Requested Report Percentage (plain-text; OPTIONAL; default is
        "100").  The value is a single integer from 0 to 100 inclusive
        that indicates what percentage of incidents of ADSP evaluation
        failures, selected at random, are to cause reports to be
        generated.  The report generator SHOULD NOT issue reports for
        more than the requested percentage of incidents.  An exception
        to this might be some out-of-band arrangement between two
        parties to override it with some mutually agreed value.  Report
        generators MAY make use of the "Incidents:" field in [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>] to
        indicate that there are more reportable incidents than there are
        reports.

      ABNF:

      adsp-rp-tag = %x72.70 *WSP "=" *WSP 1*3DIGIT
                  ; "rp=..." (lower-case only)

   rr=  Requested Reports (plain-text; OPTIONAL; default is "all").  The
        value MUST be a colon-separated list of tokens representing
        those conditions under which a report is desired.  See
        <a href="#section-5.2">Section 5.2</a> for a list of valid tokens.

      ABNF:

      adsp-rr-type = ( "all" / "o" / "p" / "s" / "u" )
      adsp-rr-tag = %x72.72 *WSP "=" *WSP adsp-rr-type
                    *WSP *( ":" *WSP adsp-rr-type )
                  ; "rr=..." (lower-case only for the tag name)

   rs=  Requested SMTP Error String (plain-text; OPTIONAL; no default).
        The value is a string the signing domain requests be included in
        [<a href="#ref-SMTP" title='"Simple Mail Transfer Protocol"'>SMTP</a>] error strings when messages are rejected during a single
        SMTP session.

      ABNF:

      adsp-rs-tag = %x72.73 *WSP "=" dkim-quoted-printable
                  ; "rs=..." (lower-case only for the tag name)

   In the absence of an "ra=" tag, the "rp=" and "rr=" tags MUST be
   ignored, and the report generator MUST NOT issue a report.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Requested%20Reports"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Requested Reports</span>

   The "rr" tags defined above allow a Signer to specify the types of
   errors about which it is interested in receiving reports.  This
   section defines the error types and corresponding token values.




<span class="grey">Kucherawy                    Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6651.html">RFC 6651</a>                DKIM Reporting Extensions              June 2012</span>


   Verifiers MUST NOT generate reports for incidents that do not match a
   requested report and MUST ignore requests for reports not included in
   this list.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Requested%20Reports%20for%20DKIM%20Failures"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Requested Reports for DKIM Failures</span>

   The following report requests are defined for DKIM keys:

   all  All reports are requested.

   d    Reports are requested for signature evaluation errors that
        resulted from DNS issues (e.g., key retrieval problems).

   o    Reports are requested for any reason related to DKIM signature
        evaluation not covered by other report requests listed here.

   p    Reports are requested for signatures that are rejected for local
        policy reasons at the Verifier that are related to DKIM
        signature evaluation.

   s    Reports are requested for signature or key syntax errors.

   u    Reports are requested for signatures that include unknown tags
        in the signature field.

   v    Reports are requested for signature verification failures or
        body hash mismatches.

   x    Reports are requested for signatures rejected by the Verifier
        because the expiration time has passed.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Requested%20Reports%20for%20DKIM%20ADSP%20Failures"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Requested Reports for DKIM ADSP Failures</span>

   The following report requests are defined for ADSP records:

   all  All reports are requested.

   o    Reports are requested for any [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>]-related failure reason not
        covered by other report requests listed here.

   p    Reports are requested for messages that are rejected for local
        policy reasons at the Verifier that are related to [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>].

   s    Reports are requested for messages that have a valid [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>]
        signature but do not match the published [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>] policy.

   u    Reports are requested for messages that have no valid [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>]
        signature and do not match the published [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>] policy.



<span class="grey">Kucherawy                    Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc6651.html">RFC 6651</a>                DKIM Reporting Extensions              June 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Report%20Generation"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Report Generation</span>

   This section describes the process for generating and sending reports
   in accordance with the request of the Signer and/or sender as
   described above.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Report%20Format"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Report Format</span>

   All reports generated as a result of requests contained in these
   extension parameters MUST be generated in compliance with [<a href="#ref-ARF" title='"An Extensible Format for Email Feedback Reports"'>ARF</a>] and
   its extension specific to this work, [<a href="#ref-ARF-AUTHFAIL">ARF-AUTHFAIL</a>].  Moreover,
   because abuse reports from unverified sources might be handled with
   some skepticism, report generators are strongly advised to use [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>]
   to sign reports they generate.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Other%20Guidance"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Other Guidance</span>

   Additional guidance about the generation of these reports can be
   found in [<a href="#ref-ARF-AS" title='"Creation and Use of Email Feedback Reports: An Applicability Statement for the Abuse Reporting Format (ARF)"'>ARF-AS</a>], especially in <a href="#section-6">Section 6</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  IANA Considerations</span>

   As required by [<a href="#ref-IANA-CONS">IANA-CONS</a>], this section contains registry
   information for the new [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] signature tags and for the new [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>]
   tags.  It also creates a DKIM reporting tag registry.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20DKIM%20Signature%20Tag%20Registration"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  DKIM Signature Tag Registration</span>

   IANA has added the following item to the DKIM Signature Tag
   Specifications registry:

                 +------+-----------------+--------+
                 | TYPE | REFERENCE       | STATUS |
                 +------+-----------------+--------+
                 | r    | (this document) | active |
                 +------+-----------------+--------+















<span class="grey">Kucherawy                    Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc6651.html">RFC 6651</a>                DKIM Reporting Extensions              June 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20DKIM%20ADSP%20Tag%20Registration"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  DKIM ADSP Tag Registration</span>

   IANA has added the following items to the DKIM ADSP Specification
   Tags registry:

                 +------+-----------------+
                 | TYPE | REFERENCE       |
                 +------+-----------------+
                 | ra   | (this document) |
                 | rp   | (this document) |
                 | rr   | (this document) |
                 | rs   | (this document) |
                 +------+-----------------+

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.3.%20%20DKIM%20Reporting%20Tag%20Registry"></a><a class="selflink" href="#section-7.3" name="section-7.3">7.3</a>.  DKIM Reporting Tag Registry</span>

   IANA has created a sub-registry of the DKIM Parameters registry
   called "DKIM Reporting Tag Registry".  Additions to this registry
   follow the "Specification Required" rules, with the following columns
   required for all registrations:

   Tag:  The name of the tag being used in reporting records

   Reference:  The document that specifies the tag being defined

   Status:  The status of the tag's current use -- either "active"
      indicating active use, or "historic" indicating discontinued or
      deprecated use

   The initial registry entries are as follows:

                 +-----+-----------------+--------+
                 | TAG | REFERENCE       | STATUS |
                 +-----+-----------------+--------+
                 | ra  | (this document) | active |
                 | rp  | (this document) | active |
                 | rr  | (this document) | active |
                 | rs  | (this document) | active |
                 +-----+-----------------+--------+












<span class="grey">Kucherawy                    Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc6651.html">RFC 6651</a>                DKIM Reporting Extensions              June 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Security%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Security Considerations</span>

   Security issues with respect to these reports are similar to those
   found in [<a href="#ref-DSN" title='"An Extensible Message Format for Delivery Status Notifications"'>DSN</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Inherited%20Considerations"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Inherited Considerations</span>

   Implementers are advised to consider the Security Considerations
   sections of [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>], [<a href="#ref-ADSP" title='"DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)"'>ADSP</a>], [<a href="#ref-ARF-AS" title='"Creation and Use of Email Feedback Reports: An Applicability Statement for the Abuse Reporting Format (ARF)"'>ARF-AS</a>], and [<a href="#ref-ARF-AUTHFAIL">ARF-AUTHFAIL</a>].  Many
   security issues related to this document are already covered in those
   documents.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Report%20Volume"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Report Volume</span>

   It is impossible to predict the volume of reports this facility will
   generate when enabled by a report receiver.  An implementer ought to
   anticipate substantial volume, since the amount of abuse occurring at
   receivers cannot be known ahead of time, and may vary rapidly and
   unpredictably.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.3.%20%20Deliberate%20Misuse"></a><a class="selflink" href="#section-8.3" name="section-8.3">8.3</a>.  Deliberate Misuse</span>

   Some threats caused by deliberate misuse of this error-reporting
   mechanism are discussed in <a href="#section-3.3">Section 3.3</a>, but they warrant further
   discussion here.

   The presence of the DNS record that indicates willingness to accept
   reports opens the recipient to abuse.  In particular, it is possible
   for an attacker to attempt to cause a flood of reports toward the
   domain identified in a signature's "d=" tag in one of these ways:

   1.  Alter existing DKIM-Signature header fields by adding an "r=y"
       tag (and possibly altering the "d=" tag to point at the target
       domain);

   2.  Add a new but bogus signature bearing an "r=y" tag and a "d=" tag
       pointing at the target domain;

   3.  Generate a completely new message bearing an "r=y" tag and a "d="
       tag pointing at the target domain.

   Consider, for example, the situation where an attacker sends out a
   multi-million-message spam run and includes in the messages a fake
   DKIM signature containing "d=example.com; r=y".  It won't matter that
   those signatures couldn't possibly be real: each will fail
   verification, and any implementations that support this specification
   will report those failures, in the millions and in short order, to
   example.com.



<span class="grey">Kucherawy                    Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc6651.html">RFC 6651</a>                DKIM Reporting Extensions              June 2012</span>


   Implementers are therefore strongly advised not to advertise the DNS
   record specified in this document except when failure reports are
   desired.  Upon doing so, unexpected traffic volumes and attacks
   should be anticipated.

   Negative caching offers some protection against this pattern of
   abuse, although it will work only as long as the negative time-to-
   live on the relevant SOA record in the DNS.

   Positive caching of this DNS reply also means that turning off the
   flow of reports by removing the record is not likely to have an
   immediate effect.  A low time-to-live on the record needs to be
   considered.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.4.%20%20Unreported%20Fraud"></a><a class="selflink" href="#section-8.4" name="section-8.4">8.4</a>.  Unreported Fraud</span>

   An attacker can craft fraudulent DKIM-Signature fields on messages,
   without using "r=" tags, and avoid having these reported.  The
   procedure described in <a href="#section-3.3">Section 3.3</a> does not permit the detection and
   reporting of such cases.

   It might be useful to some Signers to receive such reports, but the
   mechanism does not support it.  To offer such support, a Verifier
   would have to violate the first step in the procedure and continue
   even in the absence of an "r=" tag.  Although that would enable the
   desired report, it would also create a possible denial-of-service
   attack: such Verifiers would always look for the reporting TXT
   record, so a generator of fraudulent messages could simply send a
   large volume of messages without an "r=" tag to a number of
   destinations.  To avoid that outcome, reports of fraudulent
   DKIM-Signature header fields are not possible using the published
   mechanism.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20References"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20Normative%20References"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  Normative References</span>

   [<a id="ref-ABNF" name="ref-ABNF">ABNF</a>]     Crocker, D., Ed., and P. Overell, "Augmented BNF for
              Syntax Specifications: ABNF", <a href="rfc5234.html">RFC 5234</a>, January 2008.

   [<a id="ref-ADSP" name="ref-ADSP">ADSP</a>]     Allman, E., Fenton, J., Delany, M., and J. Levine,
              "DomainKeys Identified Mail (DKIM) Author Domain Signing
              Practices (ADSP)", <a href="rfc5617.html">RFC 5617</a>, August 2009.

   [<a id="ref-ARF" name="ref-ARF">ARF</a>]      Shafranovich, Y., Levine, J., and M. Kucherawy, "An
              Extensible Format for Email Feedback Reports", <a href="rfc5965.html">RFC 5965</a>,
              August 2010.




<span class="grey">Kucherawy                    Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc6651.html">RFC 6651</a>                DKIM Reporting Extensions              June 2012</span>


   [<a id="ref-ARF-AS" name="ref-ARF-AS">ARF-AS</a>]   Falk, J. and M. Kucherawy, Ed., "Creation and Use of Email
              Feedback Reports: An Applicability Statement for the Abuse
              Reporting Format (ARF)", <a href="rfc6650.html">RFC 6650</a>, June 2012.

   [<a id="ref-ARF-AUTHFAIL" name="ref-ARF-AUTHFAIL">ARF-AUTHFAIL</a>]
              Fontana, H., "Authentication Failure Reporting Using the
              Abuse Reporting Format", <a href="rfc6591.html">RFC 6591</a>, April 2012.

   [<a id="ref-DKIM" name="ref-DKIM">DKIM</a>]     Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed.,
              "DomainKeys Identified Mail (DKIM) Signatures", <a href="rfc6376.html">RFC 6376</a>,
              September 2011.

   [<a id="ref-DNS" name="ref-DNS">DNS</a>]      Mockapetris, P., "Domain names - implementation and
              specification", STD 13, <a href="rfc1035.html">RFC 1035</a>, November 1987.

   [<a id="ref-EMAIL-ARCH" name="ref-EMAIL-ARCH">EMAIL-ARCH</a>]
              Crocker, D., "Internet Mail Architecture", <a href="rfc5598.html">RFC 5598</a>,
              July 2009.

   [<a id="ref-IANA-CONS" name="ref-IANA-CONS">IANA-CONS</a>]
              Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc5226.html">RFC 5226</a>,
              May 2008.

   [<a id="ref-KEYWORDS" name="ref-KEYWORDS">KEYWORDS</a>] Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-SMTP" name="ref-SMTP">SMTP</a>]     Klensin, J., "Simple Mail Transfer Protocol", <a href="rfc5321.html">RFC 5321</a>,
              October 2008.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20Informative%20References"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  Informative References</span>

   [<a id="ref-DSN" name="ref-DSN">DSN</a>]      Moore, K. and G. Vaudreuil, "An Extensible Message Format
              for Delivery Status Notifications", <a href="rfc3464.html">RFC 3464</a>,
              January 2003.

   [<a id="ref-OPENDKIM" name="ref-OPENDKIM">OPENDKIM</a>] Kucherawy, M., "OpenDKIM -- Open Source DKIM Library and
              Filter", August 2009, &lt;<a href="http://www.opendkim.org/">http://www.opendkim.org</a>&gt;.













<span class="grey">Kucherawy                    Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc6651.html">RFC 6651</a>                DKIM Reporting Extensions              June 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Acknowledgements"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Acknowledgements</span>

   The author wishes to acknowledge the following for their review and
   constructive criticism of this proposal: Steve Atkins, Monica Chew,
   Dave Crocker, Tim Draegen, Frank Ellermann, J.D. Falk, John Levine,
   Scott Kitterman, and Andrew Sullivan.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20B.%20%20Examples"></a><a class="selflink" href="#appendix-B" name="appendix-B">Appendix B</a>.  Examples</span>

   This section contains examples of the use of each of the extensions
   defined by this document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.1.%20%20Example%20Use%20of%20DKIM%20Signature%20Extension%20Tag"></a><a class="selflink" href="#appendix-B.1" name="appendix-B.1">B.1</a>.  Example Use of DKIM Signature Extension Tag</span>

   This example shows a DKIM-Signature field using the extension tag
   defined by this document:

       DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
               d=example.com; s=jan2012; r=y;
               h=from:to:subject:date:message-id;
               bh=YJAYwiNdc3wMh6TD8FjVhtmxaHYHo7Z/06kHQYvQ4tQ=;
               b=jHF3tpgqr6nH/icHKIqFK2IJPtCLF0CRJaz2Hj1Y8yNwTJ
                 IMYIZtLccho3ymGF2GYqvTl2nP/cn4dH+55rH5pqkWNnuJ
                 R9z54CFcanoKKcl9wOZzK9i5KxM0DTzfs0r8

           Example 1: DKIM-Signature Field Using This Extension

   This example DKIM-Signature field contains the "r=" tag that
   indicates reports are requested on verification failure.

   Assuming the public key retrieved from the DNS and processed
   according to [<a href="#ref-DKIM" title='"DomainKeys Identified Mail (DKIM) Signatures"'>DKIM</a>] would determine that the signature is invalid, a
   TXT query will be sent to "_report._domainkey.example.com" to
   retrieve a reporting address and other report parameters as described
   in <a href="#section-3.3">Section 3.3</a>.
















<span class="grey">Kucherawy                    Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc6651.html">RFC 6651</a>                DKIM Reporting Extensions              June 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.2.%20%20Example%20DKIM%20Reporting%20TXT%20Record"></a><a class="selflink" href="#appendix-B.2" name="appendix-B.2">B.2</a>.  Example DKIM Reporting TXT Record</span>

   An example DKIM Reporting TXT record as defined by this document is
   as follows:

       ra=dkim-errors; rp=100; rr=v:x

              Example 2: Example DKIM Reporting TXT Record

   This example, continuing from the previous one, shows a message that
   might be found at "_report._domainkey.example.com" in a TXT record.
   It makes the following requests:

   o  Reports about signature evaluation failures should be sent to the
      address "dkim-errors" at the Signer's domain;

   o  All incidents (100%) should be reported;

   o  Only reports about signature verification failures and expired
      signatures should be generated.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.3.%20%20Example%20Use%20of%20DKIM%20ADSP%20Extension%20Tags"></a><a class="selflink" href="#appendix-B.3" name="appendix-B.3">B.3</a>.  Example Use of DKIM ADSP Extension Tags</span>

   This example shows a DKIM ADSP record using the extensions defined by
   this document:

       dkim=all; ra=dkim-adsp-errors; rr=u

            Example 3: DKIM ADSP Record Using These Extensions

   This example ADSP record makes the following assertions:

   o  The sending domain (i.e., the one that is advertising this policy)
      signs all mail it sends;

   o  Reports about ADSP evaluation failures should be sent to the
      address "dkim-adsp-errors" at the Author's domain;

   o  Only reports about unsigned messages should be generated.












<span class="grey">Kucherawy                    Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc6651.html">RFC 6651</a>                DKIM Reporting Extensions              June 2012</span>


Author's Address

   Murray S. Kucherawy
   Cloudmark
   128 King St., 2nd Floor
   San Francisco, CA  94107
   US

   Phone: +1 415 946 3800
   EMail: superuser@gmail.com









































Kucherawy                    Standards Track                   [Page 18]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc6651 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:27 GMT --></html>