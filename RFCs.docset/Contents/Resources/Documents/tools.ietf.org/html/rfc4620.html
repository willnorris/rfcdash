<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc4620 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 23 Aug 2016 18:44:02 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.119" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:4620" name="DC.Identifier"/>
<meta content="This document describes a protocol for asking an IPv6 node to supply
certain network information, such as its hostname or fully-qualified
domain name. IPv6 implementation experience has shown that direct
queries for a hostname are useful, and a direct query mechanism for
other information has been found useful in serverless environments and
for debugging. This memo defines an Experimental Protocol for the
Internet community." name="DC.Description.Abstract"/>
<meta content="Crawford, Matt" name="DC.Creator"/>
<meta content="Haberman, Brian" name="DC.Creator"/>
<meta content="August, 2006" name="DC.Date.Issued"/>
<meta content="IPv6 Node Information Queries" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 4620 - IPv6 Node Information Queries</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgyellow" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc4620.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc4620" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-ipngwg-icmp-name-lookups" title="draft-ietf-ipngwg-icmp-name-lookups">draft-ietf-ipngwg...</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4620" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc4620" title="Side-by-side diff">Diff2</a>]                 </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                            EXPERIMENTAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                        M. Crawford
Request for Comments: 4620                                      Fermilab
Category: Experimental                                  B. Haberman, Ed.
                                                                 JHU APL
                                                             August 2006


                     <span class="h1">IPv6 Node Information Queries</span>

Status of This Memo

   This memo defines an Experimental Protocol for the Internet
   community.  It does not specify an Internet standard of any kind.
   Discussion and suggestions for improvement are requested.
   Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2006).

Abstract

   This document describes a protocol for asking an IPv6 node to supply
   certain network information, such as its hostname or fully-qualified
   domain name.  IPv6 implementation experience has shown that direct
   queries for a hostname are useful, and a direct query mechanism for
   other information has been found useful in serverless environments
   and for debugging.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
   <a href="#section-2">2</a>. Applicability Statement .........................................<a href="#page-2">2</a>
   <a href="#section-3">3</a>. Terminology .....................................................<a href="#page-2">2</a>
   <a href="#section-4">4</a>. Node Information Messages .......................................<a href="#page-3">3</a>
   <a href="#section-5">5</a>. Message Processing ..............................................<a href="#page-5">5</a>
   <a href="#section-6">6</a>. Defined Qtypes ..................................................<a href="#page-6">6</a>
      <a href="#section-6.1">6.1</a>. NOOP .......................................................<a href="#page-7">7</a>
      <a href="#section-6.2">6.2</a>. Node Name ..................................................<a href="#page-7">7</a>
      <a href="#section-6.3">6.3</a>. Node Addresses .............................................<a href="#page-8">8</a>
      <a href="#section-6.4">6.4</a>. IPv4 Addresses .............................................<a href="#page-9">9</a>
           <a href="#section-6.4.1">6.4.1</a>. Discussion ..........................................<a href="#page-9">9</a>
   <a href="#section-7">7</a>. IANA Considerations ............................................<a href="#page-10">10</a>
   <a href="#section-8">8</a>. Security Considerations ........................................<a href="#page-10">10</a>
   <a href="#section-9">9</a>. Acknowledgements ...............................................<a href="#page-11">11</a>
   <a href="#section-10">10</a>. References ....................................................<a href="#page-11">11</a>
      <a href="#section-10.1">10.1</a>. Normative References .....................................<a href="#page-11">11</a>
      <a href="#section-10.2">10.2</a>. Informative References ...................................<a href="#page-12">12</a>



<span class="grey">Crawford &amp; Haberman           Experimental                      [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc4620.html">RFC 4620</a>             IPv6 Node Information Queries           August 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   This document specifies a mechanism for discovering information about
   names and addresses.  The applicability of these mechanisms is
   currently limited to diagnostic and debugging tools and network
   management (e.g., node discovery).  In the global internet, the
   Domain Name System (DNS) [<a href="#ref-1" title='"Domain names - concepts and facilities"'>1</a>][2] is the authoritative source of such
   information and this specification is not intended to supplant or
   supersede it.  In fact, in a well-supported network, the names and
   addresses dealt with by this mechanism will be the same ones, with
   the same relationships, as those listed in the DNS.

   This new Node Information protocol provides facilities that are not
   found in the DNS, for example, discovering relationships between
   addresses without reference to names.  The functions that do overlap
   with the DNS may be useful in serverless environments, for debugging,
   or in regard to link-local and unique-local addresses [<a href="#ref-3" title='"IP Version 6 Addressing Architecture"'>3</a>] that often
   will not be listed in the DNS.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Applicability%20Statement"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Applicability Statement</span>

   IPv6 Node Information Queries include the capability to provide
   forward and reverse name lookups independent of the DNS by sending
   packets directly to IPv6 nodes or groups of nodes.

   The applicability of these mechanisms is currently limited to
   diagnostic and debugging tools and network management (e.g., node
   discovery).  These mechanisms can be used to learn the addresses and
   names for nodes on the other end of a point-to-point link or nodes on
   a shared-medium link such as an Ethernet.  This is very useful when
   debugging problems or when bringing up IPv6 service where there is no
   global routing or DNS name services available.  IPv6's large auto-
   configured addresses make debugging network problems and bringing up
   IPv6 service difficult without these mechanisms.  An example of an
   IPv6 debugging tool using IPv6 Node Information Queries is the ping6
   program in the KAME (<a href="http://www.kame.net/">http://www.kame.net</a>), USAGI, and other IPv6
   implementations.

   The mechanisms defined in this document may have wider applicability
   in the future, but any use beyond debugging and diagnostic tools is
   left for further study and is beyond the scope of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Terminology"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Terminology</span>

   A "Node Information Query" (or "NI Query") message is sent by a
   "Querier" node to a "Responder" node in an ICMPv6 packet addressed to
   the "Queried Address".  The Query contains a "Subject Address" (which
   may differ from the Queried Address and may be an IPv6 or IPv4



<span class="grey">Crawford &amp; Haberman           Experimental                      [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc4620.html">RFC 4620</a>             IPv6 Node Information Queries           August 2006</span>


   address) or a "Subject Name".  The Responder sends a "Node
   Information Reply" to the Querier, containing information associated
   with the node at the Queried Address.  A node receiving an NI Query
   will be termed a Responder even if it does not send a reply.

   The word "name" in this document refers to a hostname with or without
   the domain.  Where necessary, the cases of fully-qualified and
   single-label names will be distinguished.

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="#ref-4" title='"Key words for use in RFCs to Indicate Requirement Levels"'>4</a>].

   Packet fields marked "unused" must be zero on transmission and, aside
   from inclusion in checksums or message integrity checks, ignored on
   reception.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Node%20Information%20Messages"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Node Information Messages</span>

   Two types of Node Information messages, the NI Query and the NI
   Reply, are carried in ICMPv6 [<a href="#ref-5" title='"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification"'>5</a>] packets.  They have the same format.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |     Code      |           Checksum            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |             Qtype             |             Flags             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                             Nonce                             +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   /                             Data                              /
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                    Figure 1: Node Information Messages

   Fields:

   o  Type

      *  139 - NI Query

      *  140 - NI Reply




<span class="grey">Crawford &amp; Haberman           Experimental                      [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc4620.html">RFC 4620</a>             IPv6 Node Information Queries           August 2006</span>


   o  Code

      *  For NI Query

         +  0 - Indicates that the Data field contains an IPv6 address
            that is the Subject of this Query.

         +  1 - Indicates that the Data field contains a name that is
            the Subject of this Query, or is empty, as in the case of a
            NOOP.

         +  2 - Indicates that the Data field contains an IPv4 address
            that is the Subject of this Query.

      *  For NI Reply

         +  0 - Indicates a successful reply.  The Reply Data field may
            or may not be empty.

         +  1 - Indicates that the Responder refuses to supply the
            answer.  The Reply Data field will be empty.

         +  2 - Indicates that the Qtype of the Query is unknown to the
            Responder.  The Reply Data field will be empty.

   o  Checksum - The ICMPv6 checksum.

   o  Qtype - A 16-bit field that designates the type of information
      requested in a Query or supplied in a Reply.  Its value in a Reply
      is always copied from the corresponding Query by the Responder.
      Five values of Qtype are specified in this document.

   o  Flags - Qtype-specific flags that may be defined for certain Query
      types and their Replies.  Flags not defined for a given Qtype must
      be zero on transmission and ignored on reception, and must not be
      copied from a Query to a Reply unless so specified in the
      definition of the Qtype.

   o  Nonce - An opaque 64-bit field to help avoid spoofing and/or to
      aid in matching Replies with Queries.  Its value in a Query is
      chosen by the Querier.  Its value in a Reply is always copied from
      the corresponding Request by the Responder.

   o  Data - In a Query, the Subject Address or Name.  In a Reply,
      Qtype-specific data is present only when the ICMPv6 Code field is
      zero.  The length of the Data may be inferred from the IPv6
      header's Payload Length field [<a href="#ref-6" title='"Internet Protocol, Version 6 (IPv6) Specification"'>6</a>], the length of the fixed portion




<span class="grey">Crawford &amp; Haberman           Experimental                      [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc4620.html">RFC 4620</a>             IPv6 Node Information Queries           August 2006</span>


      of the NI packet, and the lengths of the ICMPv6 header and
      intervening extension headers.

   Note that the type of information present in the Data field of a
   Query is declared by the ICMP Code, whereas the type of information,
   if any, in the Data field of a Reply is determined by the Qtype.

   When the Subject of a Query is a name, the name MUST be in DNS wire
   format [<a href="#ref-2" title='"Domain names - implementation and specification"'>2</a>].  The name may be either a fully-qualified domain name,
   including the terminating zero-length label, or a single DNS label
   followed by two zero-length labels.  Since a Query contains at most
   one name, DNS name compression MUST NOT be used.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Message%20Processing"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Message Processing</span>

   The Querier constructs an ICMP NI Query and sends it to the address
   from which information is wanted.  When the Subject of the Query is
   an IPv6 address, that address will normally be used as the IPv6
   destination address of the Query, but need not be if the Querier has
   useful a priori information about the addresses of the target node.
   An NI Query may also be sent to a multicast address of link-local
   scope [<a href="#ref-3" title='"IP Version 6 Addressing Architecture"'>3</a>].

   When the Subject is a name, either fully-qualified or single-
   component, and the Querier does not have a unicast address for the
   target node, the query MUST be sent to a link-scope multicast address
   formed in the following way.  The Subject Name is converted to the
   canonical form defined by DNS Security [<a href="#ref-7" title='"Resource Records for the DNS Security Extensions"'>7</a>], which is uncompressed
   with all alphabetic characters in lowercase.  (If additional DNS
   label types or character sets for hostnames are defined, the rules
   for canonicalizing those labels will be found in their defining
   specification.)  Compute the MD5 hash [<a href="#ref-8" title='"The MD5 Message-Digest Algorithm"'>8</a>] of the first label of the
   Subject Name--the portion beginning with the first one-octet length
   field and up to, but excluding, any subsequent length field.  Append
   the first 24 bits of that 128-bit hash to the prefix
   FF02:0:0:0:0:2:FF00::/104.  The resulting multicast address will be
   termed the "NI Group Address" for the name.  A node will support an
   "NI Group Address" for each unique single-label name.

   The Nonce MUST be a random or good pseudo-random value to foil
   spoofed replies.  An implementation that allows multiple independent
   processes to send NI Queries MAY use the Nonce value to deliver
   Replies to the correct process.  Nonetheless, such processes MUST
   check the received Nonce and ignore extraneous Replies.

   If true communication security is required, IP Security (IPsec) [<a href="#ref-14" title='"Security Architecture for the Internet Protocol"'>14</a>]
   should be used.  Providing the infrastructure to authenticate NI




<span class="grey">Crawford &amp; Haberman           Experimental                      [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc4620.html">RFC 4620</a>             IPv6 Node Information Queries           August 2006</span>


   Queries and Replies may be quite difficult outside of a well-defined
   community.

   Upon receiving an NI Query, the Responder must check the Query's IPv6
   destination address and discard the Query without further processing
   unless it is one of the Responder's unicast or anycast addresses, or
   a link-local scope multicast address that the Responder has joined.
   Typically, the latter will be an NI Group Address for a name
   belonging to the Responder.  A node MAY be configured to discard NI
   Queries to multicast addresses other than its NI Group Address(es),
   but if so, the default configuration SHOULD be not to discard them.

   A Responder must also silently discard a Query whose Subject Address
   or Name (in the Data field) does not belong to that node.  A single-
   component Subject Name matches any fully-qualified name whose first
   label matches the Subject.  All name matching is done in a case-
   independent manner consistent with DNS Security (DNSSEC) name
   canonicalization [<a href="#ref-7" title='"Resource Records for the DNS Security Extensions"'>7</a>].

   Next, if Qtype is unknown to the Responder, it must return an NI
   Reply with ICMPv6 Code = 2 and no Reply Data.  The Responder should
   rate-limit such replies as it would ICMPv6 error replies [<a href="#ref-5" title='"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification"'>5</a>].

   Next, the Responder should decide whether to refuse an answer, based
   on local policy.  (See the "Security Considerations" section for
   recommended default behavior.)  If an answer is refused, depending on
   local policy the Responder can elect to silently discard the query or
   send an NI Reply with ICMPv6 Code = 1 and no Reply Data.  Again, the
   Responder should rate-limit such replies as it would ICMPv6 error
   replies [<a href="#ref-5" title='"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification"'>5</a>].

   Finally, if the Qtype is known and the response is allowed by local
   policy, the Responder MUST fill in the Flags and Reply Data of the NI
   Reply in accordance with the definition of the Qtype and transmit the
   NI Reply.  The source address of the NI Reply SHOULD be selected
   using the rules defined in [<a href="#ref-9" title='"Default Address Selection for Internet Protocol version 6 (IPv6)"'>9</a>].

   If the Query was sent to a multicast address, transmission of the
   Reply MUST be delayed by a random interval between zero and [Query
   Response Interval], as defined by Multicast Listener Discovery
   Version 2 [<a href="#ref-10" title='"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"'>10</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Defined%20Qtypes"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Defined Qtypes</span>

   The following Qtypes are defined.  Qtypes 0, 2, and 3 MUST be
   supported by any implementation of this protocol.  Qtype 4 SHOULD be
   supported by any implementation of this protocol on an IPv4/IPv6
   dual-stack node and MAY be supported on an IPv6-only node.



<span class="grey">Crawford &amp; Haberman           Experimental                      [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc4620.html">RFC 4620</a>             IPv6 Node Information Queries           August 2006</span>


                     +-------------+----------------+
                     | Qtype Value |   Qtype Name   |
                     +-------------+----------------+
                     |      0      |      NOOP      |
                     |      1      |     unused     |
                     |      2      |    Node Name   |
                     |      3      | Node Addresses |
                     |      4      | IPv4 Addresses |
                     +-------------+----------------+

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20NOOP"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  NOOP</span>

   This NI type has no defined flags and never has a Data field.  A
   Reply to an NI NOOP Query tells the Querier that a node with the
   Queried Address is up and reachable and implements the Node
   Information protocol.  On transmission, the ICMPv6 Code in a NOOP
   Query must be set to 1 and the Code in a NOOP Reply must be 0.  On
   reception of a NOOP Query or Reply, the Code must be ignored.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Node%20Name"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Node Name</span>

   The NI Node Name Query requests the fully-qualified or single-
   component name corresponding to the Subject Address or Name.  The
   Reply Data has the following format.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                              TTL                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Node Names ...                       |
   +                                                               +
   /                                                               /
   +                                                               +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                 Figure 2: Node Information Reply Message

   o  TTL (Time to Live) - MUST be zero.  Any non-zero value received
      MUST be treated as zero.  This field is no longer used but is
      present to preserve backward compatibility with older
      implementations.

   o  Node Names - The fully-qualified or single-component name or names
      of the Responder that correspond(s) to the Subject Address or
      Name, in DNS wire format, Section 3.1 of [<a href="#ref-2" title='"Domain names - implementation and specification"'>2</a>].  Each name MUST be
      fully-qualified if the responder knows the domain suffix;



<span class="grey">Crawford &amp; Haberman           Experimental                      [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc4620.html">RFC 4620</a>             IPv6 Node Information Queries           August 2006</span>


      otherwise, each name MUST be a single DNS label followed by two
      zero-length labels.  When multiple node names are returned and
      more than one of them is fully-qualified, DNS name compression,
      Section 4.1.4 of [<a href="#ref-2" title='"Domain names - implementation and specification"'>2</a>], SHOULD be used, and the offsets are counted
      from the first octet of the Data field.  An offset of 4, for
      example, will point to the beginning of the first name.

   The Responder must fill in the TTL field of the Reply with zero.

   Only one TTL is included in the Reply.

   If the Responder does not know its name at all, it MUST send a Reply
   with TTL=0 and no Node Names (or a Reply with Code=1 indicating
   refusal to answer).  The Querier will be able to determine from the
   packet length that the Data field contains no names.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20Node%20Addresses"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  Node Addresses</span>

   The NI Node Addresses Query requests some set of the Responder's IPv6
   unicast addresses.  The Reply Data is a sequence of 128-bit IPv6
   addresses, with each address preceded by a separate 32-bit TTL value,
   with Preferred addresses listed before Deprecated addresses [<a href="#ref-11" title='"Neighbor Discovery for IP Version 6 (IPv6)"'>11</a>];
   otherwise, they are in no special order.  Five flag bits are defined
   in the Query and six in the Reply.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |            Qtype=3            |       unused      |G|S|L|C|A|T|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                 Figure 3: Node Information Address Query

   o  G - If set to 1, Global-scope addresses [<a href="#ref-12" title='"IPv6 Global Unicast Address Format"'>12</a>] are requested.

   o  S - If set to 1, Site-local addresses [<a href="#ref-12" title='"IPv6 Global Unicast Address Format"'>12</a>] are requested.
      However, Site-local addresses are now deprecated [<a href="#ref-15" title='"Deprecating Site Local Addresses"'>15</a>] and this
      flag is for backward compatibility.

   o  L - If set to 1, Link-local addresses [<a href="#ref-12" title='"IPv6 Global Unicast Address Format"'>12</a>] are requested.

   o  C - If set to 1, IPv4-compatible (now deprecated) and IPv4-mapped
      addresses [<a href="#ref-3" title='"IP Version 6 Addressing Architecture"'>3</a>] are requested.  Responses SHOULD include IPv4
      addresses in IPv4-mapped form.

   o  A - If set to 1, all the Responder's unicast addresses (of the
      specified scope(s)) are requested.  If 0, only those addresses are
      requested that belong to the interface (or any one interface) that



<span class="grey">Crawford &amp; Haberman           Experimental                      [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc4620.html">RFC 4620</a>             IPv6 Node Information Queries           August 2006</span>


      has the Subject Address or that are associated with the Subject
      Name.

   o  T - Defined in a Reply only, indicates that the set of addresses
      is incomplete for space reasons.

   Flags G, S, L, C, and A are copied from a Query to the corresponding
   Reply.

   The TTL associated with each address MUST be zero.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.4.%20%20IPv4%20Addresses"></a><a class="selflink" href="#section-6.4" name="section-6.4">6.4</a>.  IPv4 Addresses</span>

   The NI IPv4 Addresses Query requests some set of the Responder's IPv4
   unicast addresses.  The Reply Data is a sequence of 32-bit IPv4
   addresses, each address preceded by a 32-bit TTL value.  One flag bit
   is defined in the Query and two in the Reply.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |            Qtype=4            |       unused              |A|T|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

               Figure 4: Node Information IPv4 Address Query

   o  A - If set to 1, all the Responder's unicast addresses are
      requested.  If 0, only those addresses are requested that belong
      to the interface (or any one interface) that has the Subject
      Address.

   o  T - Defined in a Reply only, indicates that the set of addresses
      is incomplete for space reasons.

   Flag A is copied from a Query to the corresponding Reply.

   The TTL associated with each address MUST be zero.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.4.1.%20%20Discussion"></a><a class="selflink" href="#section-6.4.1" name="section-6.4.1">6.4.1</a>.  Discussion</span>

   It is possible that a node may treat IPv4 interfaces and IPv6
   interfaces as distinct, even though they are associated with the same
   hardware.  When such a node is responding to an NI Query having a
   Subject Address of one type requesting the other type, and the Query
   has the A flag set to 0, it SHOULD consider IP interfaces, other than
   tunnels, associated with the same hardware as being the same
   interface.




<span class="grey">Crawford &amp; Haberman           Experimental                      [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc4620.html">RFC 4620</a>             IPv6 Node Information Queries           August 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  IANA Considerations</span>

   ICMPv6 type values 139 and 140 were previously assigned by IANA for
   this protocol.  This document defines three values of the ICMPv6 Code
   field for each of these ICMPv6 Type values.  Additional Code values
   may be defined using the "Specification Required" criteria from [<a href="#ref-16" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>16</a>].
   IANA has established and will maintain a registry for the Code fields
   associated with the Node Information Query ICMPv6 Types as a part of
   its ICMPv6 Registry updated in [<a href="#ref-13" title='"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification"'>13</a>].

   This document defines five values of Qtype, numbers 0 through 4.
   Following the policies outlined in [<a href="#ref-16" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>16</a>], new values, and their
   associated Flags and Reply Data, are to be defined by IETF Consensus.

   The IANA has assigned the IPv6 multicast prefix
   FF02:0:0:0:0:2:FF00::/104 for use in Node Information Queries as
   defined in <a href="#section-5">Section 5</a>.  It should be noted that this assignment does
   conform with the requirements defined in [<a href="#ref-17" title='"Allocation Guidelines for IPv6 Multicast Addresses"'>17</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Security%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Security Considerations</span>

   This protocol shares the security issues of ICMPv6 that are
   documented in the "Security Considerations" section of [<a href="#ref-5" title='"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification"'>5</a>].

   This protocol has the potential of revealing information useful to a
   would-be attacker.  An implementation of this protocol MUST have a
   default configuration that refuses to answer queries from global-
   scope [<a href="#ref-3" title='"IP Version 6 Addressing Architecture"'>3</a>] addresses.

   Implementations SHOULD apply rate-limiting to NI responses to avoid
   being used in a denial-of-service attack.

   The anti-spoofing Nonce does not give any protection from spoofers
   who can eavesdrop the Query or the Reply.

   The information learned via this protocol SHOULD NOT be trusted for
   making security-relevant decisions unless some other mechanisms
   beyond the scope of this document are used to authenticate this
   information.

   An implementation of this protocol SHOULD provide the ability to
   control the dissemination of information related to IPv6 Privacy
   Addresses [<a href="#ref-18" title='"Privacy Extensions for Stateless Address Autoconfiguration in IPv6"'>18</a>].  The default action of this policy SHOULD NOT provide
   a response to a Query that contains a node's Privacy Addresses.

   A node MUST NOT include Privacy Addresses in any Node Addresses
   response that includes a public address, or for which the source
   address of the response, the destination address of the request, or



<span class="grey">Crawford &amp; Haberman           Experimental                     [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc4620.html">RFC 4620</a>             IPv6 Node Information Queries           August 2006</span>


   the Subject Address of the request is a public address.  Similarly, a
   node MUST NOT include any address other than the (single) Privacy
   Address in any Node Addresses response that includes the Privacy
   Address, or for which the source address of the response, the
   destination address of the request, or the Subject Address of the
   request is the Privacy Address.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Acknowledgements"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Acknowledgements</span>

   Alain Durand contributed to this specification, and valuable feedback
   and implementation experience were provided by Jun-Ichiro Hagino and
   Tatuya Jinmei.  Other useful comments were received from Robert Elz,
   Keith Moore, Elwyn Davies, Pekka Savola, and Dave Thaler.  Bob Hinden
   and Brian Haberman have acted as document editors during the IETF
   advancement process.

   This document is not the first proposal of a direct query mechanism
   for address-to-name translation.  The idea had been discussed briefly
   in the IPng working group, and <a href="rfc1788.html">RFC 1788</a> [<a href="#ref-19" title='"ICMP Domain Name Messages"'>19</a>] describes such a
   mechanism for IPv4.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20References"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Normative%20References"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Normative References</span>

   [<a id="ref-1" name="ref-1">1</a>]   Mockapetris, P., "Domain names - concepts and facilities", STD
         13, <a href="rfc1034.html">RFC 1034</a>, November 1987.

   [<a id="ref-2" name="ref-2">2</a>]   Mockapetris, P., "Domain names - implementation and
         specification", STD 13, <a href="rfc1035.html">RFC 1035</a>, November 1987.

   [<a id="ref-3" name="ref-3">3</a>]   Hinden, R. and S. Deering, "IP Version 6 Addressing
         Architecture", <a href="rfc4291.html">RFC 4291</a>, February 2006.

   [<a id="ref-4" name="ref-4">4</a>]   Bradner, S., "Key words for use in RFCs to Indicate Requirement
         Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-5" name="ref-5">5</a>]   Conta, A. and S. Deering, "Internet Control Message Protocol
         (ICMPv6) for the Internet Protocol Version 6 (IPv6)
         Specification", <a href="rfc2463.html">RFC 2463</a>, December 1998.

   [<a id="ref-6" name="ref-6">6</a>]   Deering, S. and R. Hinden, "Internet Protocol, Version 6 (IPv6)
         Specification", <a href="rfc2460.html">RFC 2460</a>, December 1998.

   [<a id="ref-7" name="ref-7">7</a>]   Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose,
         "Resource Records for the DNS Security Extensions", <a href="rfc4034.html">RFC 4034</a>,
         March 2005.




<span class="grey">Crawford &amp; Haberman           Experimental                     [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc4620.html">RFC 4620</a>             IPv6 Node Information Queries           August 2006</span>


   [<a id="ref-8" name="ref-8">8</a>]   Rivest, R., "The MD5 Message-Digest Algorithm", <a href="rfc1321.html">RFC 1321</a>, April
         1992.

   [<a id="ref-9" name="ref-9">9</a>]   Draves, R., "Default Address Selection for Internet Protocol
         version 6 (IPv6)", <a href="rfc3484.html">RFC 3484</a>, February 2003.

   [<a id="ref-10" name="ref-10">10</a>]  Vida, R. and L. Costa, "Multicast Listener Discovery Version 2
         (MLDv2) for IPv6", <a href="rfc3810.html">RFC 3810</a>, June 2004.

   [<a id="ref-11" name="ref-11">11</a>]  Narten, T., Nordmark, E., and W. Simpson, "Neighbor Discovery
         for IP Version 6 (IPv6)", <a href="rfc2461.html">RFC 2461</a>, December 1998.

   [<a id="ref-12" name="ref-12">12</a>]  Hinden, R., Deering, S., and E. Nordmark, "IPv6 Global Unicast
         Address Format", <a href="rfc3587.html">RFC 3587</a>, August 2003.

   [<a id="ref-13" name="ref-13">13</a>]  Conta, A., Deering, S., and M. Gupta, "Internet Control Message
         Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6)
         Specification", <a href="rfc4443.html">RFC 4443</a>, March 2006.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.2.%20%20Informative%20References"></a><a class="selflink" href="#section-10.2" name="section-10.2">10.2</a>.  Informative References</span>

   [<a id="ref-14" name="ref-14">14</a>]  Kent, S. and K. Seo, "Security Architecture for the Internet
         Protocol", <a href="rfc4301.html">RFC 4301</a>, December 2005.

   [<a id="ref-15" name="ref-15">15</a>]  Huitema, C. and B. Carpenter, "Deprecating Site Local
         Addresses", <a href="rfc3879.html">RFC 3879</a>, September 2004.

   [<a id="ref-16" name="ref-16">16</a>]  Narten, T. and H. Alvestrand, "Guidelines for Writing an IANA
         Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc2434.html">RFC 2434</a>, October
         1998.

   [<a id="ref-17" name="ref-17">17</a>]  Haberman, B., "Allocation Guidelines for IPv6 Multicast
         Addresses", <a href="rfc3307.html">RFC 3307</a>, August 2002.

   [<a id="ref-18" name="ref-18">18</a>]  Narten, T. and R. Draves, "Privacy Extensions for Stateless
         Address Autoconfiguration in IPv6", <a href="rfc3041.html">RFC 3041</a>, January 2001.

   [<a id="ref-19" name="ref-19">19</a>]  Simpson, W., "ICMP Domain Name Messages", <a href="rfc1788.html">RFC 1788</a>, April 1995.













<span class="grey">Crawford &amp; Haberman           Experimental                     [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc4620.html">RFC 4620</a>             IPv6 Node Information Queries           August 2006</span>


Authors' Addresses

   Matt Crawford
   Fermilab
   PO Box 500
   Batavia, IL  60510
   US

   Phone: +1 630 840 3461
   EMail: crawdad@fnal.gov


   Brian Haberman (editor)
   Johns Hopkins University Applied Physics Lab
   11100 Johns Hopkins Road
   Laurel, MD  20723-6099
   US

   Phone: +1 443 778 1319
   EMail: brian@innovationslab.net































<span class="grey">Crawford &amp; Haberman           Experimental                     [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc4620.html">RFC 4620</a>             IPv6 Node Information Queries           August 2006</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).







Crawford &amp; Haberman           Experimental                     [Page 14]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.119, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc4620 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 23 Aug 2016 18:44:02 GMT --></html>